[{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\AccessibilityProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\AppProviders.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\AppSidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":308,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":308,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7703,7706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7703,7706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { NavigationItem } from '@/types/common-interfaces';\r\nimport {\r\n  Sidebar,\r\n  SidebarContent,\r\n  SidebarFooter,\r\n  SidebarGroup,\r\n  SidebarGroupContent,\r\n  SidebarGroupLabel,\r\n  SidebarHeader,\r\n  SidebarMenu,\r\n  SidebarMenuButton,\r\n  SidebarMenuItem,\r\n} from \"@/components/ui/sidebar\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { \r\n  Home, \r\n  Book, \r\n  BarChart, \r\n  Users, \r\n  Award, \r\n  StickyNote, \r\n  Settings, \r\n  HelpCircle,\r\n  BookUser,\r\n  Compass,\r\n  GraduationCap,\r\n  Shield,\r\n  BookOpen,\r\n  ExternalLink,\r\n  CreditCard,\r\n  Target,\r\n  MessageSquare,\r\n  Package,\r\n  FolderOpen,\r\n  Building2,\r\n  FileText\r\n} from \"lucide-react\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\nimport { useUserProfile } from \"@/hooks/useUserProfile\";\r\nimport { useAppUser } from \"@/hooks/useAppUser\";\r\nimport { useUserRole } from \"@/hooks/useUserRole\";\r\nimport { useGlobalTranslation } from \"@/hooks/useGlobalTranslation\";\r\nimport DualLanguageText from \"@/components/DualLanguageText\";\r\nimport { useOrgContext } from \"@/components/organizations/OrgContext\";\r\nimport { navPersonal, navOrgStudent, navOrgInstructor, injectOrgId } from \"@/config/nav\";\r\n\r\nexport function AppSidebar() {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { user, signOut } = useAuth();\r\n  const { profile } = useUserProfile();\r\n  const { isAdmin } = useAppUser();\r\n  const { isInstructor, isLearner } = useUserRole();\r\n  const { t, tString } = useGlobalTranslation();\r\n  const { activeOrgId, getNavigationContext, isPersonalMode } = useOrgContext();\r\n\r\n  const learnerMenuItems = [\r\n    {\r\n      title: 'Home',\r\n      url: \"/dashboard/learner\",\r\n      icon: Home,\r\n    },\r\n    {\r\n      title: 'Organizations',\r\n      url: \"/org\",\r\n      icon: Building2,\r\n    },\r\n    {\r\n      title: 'Courses',\r\n      url: \"/dashboard/learner/courses\",\r\n      icon: Book,\r\n    },\r\n    {\r\n      title: 'Library',\r\n      url: \"/dashboard/learner/library\",\r\n      icon: BookOpen,\r\n    },\r\n    {\r\n      title: 'Analytics',\r\n      url: \"/dashboard/learner/analytics\",\r\n      icon: BarChart,\r\n    },\r\n    {\r\n      title: 'Live Hub',\r\n      url: \"/dashboard/learner/live-hub\",\r\n      icon: Compass,\r\n    },\r\n    {\r\n      title: 'AI Study Coach',\r\n      url: \"/dashboard/learner/ai-coach\",\r\n      icon: BookUser,\r\n    },\r\n    {\r\n      title: 'Goals',\r\n      url: \"/dashboard/learner/goals\",\r\n      icon: Target,\r\n    },\r\n    {\r\n      title: 'Achievements & XP',\r\n      url: \"/dashboard/learner/gamification\",\r\n      icon: Award,\r\n    },\r\n    {\r\n      title: 'Notes',\r\n      url: \"/dashboard/learner/notes\",\r\n      icon: StickyNote,\r\n    },\r\n  ];\r\n\r\n  const instructorMenuItems = [\r\n    {\r\n      title: 'Students',\r\n      url: \"/dashboard/instructor#students\",\r\n      icon: Users,\r\n    },\r\n    {\r\n      title: 'Courses',\r\n      url: \"/dashboard/instructor#courses\",\r\n      icon: Book,\r\n    },\r\n    {\r\n      title: 'Goals',\r\n      url: \"/dashboard/instructor#goals\",\r\n      icon: Target,\r\n    },\r\n    {\r\n      title: 'Notes',\r\n      url: \"/dashboard/instructor#notes\",\r\n      icon: StickyNote,\r\n    },\r\n    {\r\n      title: 'Analytics',\r\n      url: \"/dashboard/instructor#analytics\",\r\n      icon: BarChart,\r\n    },\r\n  ];\r\n\r\n  const adminMenuItems = [\r\n    {\r\n      title: 'Admin Dashboard',\r\n      url: \"/dashboard/admin\",\r\n      icon: Shield,\r\n    },\r\n    {\r\n      title: 'User Management',\r\n      url: \"/dashboard/admin/users\",\r\n      icon: Users,\r\n    },\r\n    {\r\n      title: 'Organization Management',\r\n      url: \"/dashboard/admin/organizations\",\r\n      icon: Building2,\r\n    },\r\n    {\r\n      title: 'Instructor Console',\r\n      url: \"/dashboard/admin/instructors\",\r\n      icon: GraduationCap,\r\n    },\r\n    {\r\n      title: 'Course Manager',\r\n      url: \"/dashboard/admin/courses\",\r\n      icon: Book,\r\n    },\r\n    {\r\n      title: 'Module Manager',\r\n      url: \"/dashboard/admin/modules\",\r\n      icon: BookOpen,\r\n    },\r\n    {\r\n      title: 'SCORM Packages',\r\n      url: \"/dashboard/admin/scorm\",\r\n      icon: Package,\r\n    },\r\n    {\r\n      title: 'Analytics',\r\n      url: \"/dashboard/admin/analytics\",\r\n      icon: BarChart,\r\n    },\r\n    {\r\n      title: 'Threshold Management',\r\n      url: \"/dashboard/admin/thresholds\",\r\n      icon: Settings,\r\n    },\r\n    {\r\n      title: 'Beta Management',\r\n      url: \"/dashboard/admin/beta\",\r\n      icon: MessageSquare,\r\n    },\r\n    {\r\n      title: 'Course Builder',\r\n      url: \"https://themed-course-compass.lovable.app/dashboard/admin/course-builder\",\r\n      icon: Book,\r\n      isExternal: true,\r\n    },\r\n    {\r\n      title: 'Audit Logs',\r\n      url: \"/dashboard/admin/audit\",\r\n      icon: FileText,\r\n    },\r\n  ];\r\n\r\n  const scormMenuItems = [\r\n    {\r\n      title: 'SCORM Studio',\r\n      url: \"/dashboard/scorm/studio\",\r\n      icon: Package,\r\n    },\r\n    {\r\n      title: 'Packages',\r\n      url: \"/dashboard/scorm/packages\",\r\n      icon: FolderOpen,\r\n    },\r\n  ];\r\n\r\n  const footerItems = [\r\n    {\r\n      title: 'Subscription',\r\n      url: \"/dashboard/subscription\",\r\n      icon: CreditCard,\r\n    },\r\n    {\r\n      title: 'Settings',\r\n      url: \"/dashboard/learner/settings\",\r\n      icon: Settings,\r\n    },\r\n  ];\r\n\r\n  const getDisplayName = () => {\r\n    if (profile?.display_name) return profile.display_name;\r\n    if (profile?.full_name) return profile.full_name;\r\n    if (user?.email) return user.email.split('@')[0];\r\n    return 'User';\r\n  };\r\n\r\n  const getUserEmail = () => {\r\n    return user?.email || 'user@fpk.edu';\r\n  };\r\n\r\n  const getInitials = () => {\r\n    const displayName = getDisplayName();\r\n    return displayName.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await signOut();\r\n      navigate('/login');\r\n    } catch (error) {\r\n      console.error('Error signing out:', error);\r\n    }\r\n  };\r\n\r\n  const isActive = (url: string) => {\r\n    if (url.startsWith('http')) {\r\n      // For external URLs, check if current location matches the path\r\n      return location.pathname === '/dashboard/admin/course-builder';\r\n    }\r\n    // Handle SCORM routes specifically for better matching\r\n    if (url.includes('/scorm/')) {\r\n      return location.pathname.startsWith(url);\r\n    }\r\n    // Handle org-specific routes by checking both path and query params\r\n    if (url.includes('?org=')) {\r\n      const [path, query] = url.split('?');\r\n      const currentParams = new URLSearchParams(location.search);\r\n      const urlParams = new URLSearchParams(query);\r\n      \r\n      return location.pathname === path && \r\n             currentParams.get('org') === urlParams.get('org');\r\n    }\r\n    return location.pathname === url;\r\n  };\r\n\r\n  const handleNavigation = (item: NavigationItem) => {\r\n    if (item.isExternal) {\r\n      window.location.href = item.url;\r\n    } else {\r\n      navigate(item.url);\r\n    }\r\n  };\r\n\r\n  // Get contextual navigation items based on org context\r\n  const getContextualNavItems = () => {\r\n    const context = getNavigationContext();\r\n    \r\n    let navItems;\r\n    switch (context) {\r\n      case 'org-instructor':\r\n        navItems = navOrgInstructor;\r\n        break;\r\n      case 'org-student':\r\n        navItems = navOrgStudent;\r\n        break;\r\n      default:\r\n        navItems = navPersonal;\r\n    }\r\n    \r\n    return injectOrgId(navItems, activeOrgId);\r\n  };\r\n\r\n  // Helper to extract icon component from React.createElement\r\n  const renderIcon = (iconElement: React.ReactNode) => {\r\n    if (React.isValidElement(iconElement)) {\r\n      return React.cloneElement(iconElement as React.ReactElement<any>, { \r\n        className: \"h-4 w-4 flex-shrink-0\" \r\n      });\r\n    }\r\n    return iconElement;\r\n  };\r\n\r\n  return (\r\n    <Sidebar className=\"border-r border-sidebar-border\">\r\n      <SidebarHeader className=\"p-4\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"w-8 h-8 fpk-gradient rounded-lg flex items-center justify-center\">\r\n            <span className=\"text-white font-bold text-sm\">FPK</span>\r\n          </div>\r\n          <div>\r\n            <h2 className=\"font-bold text-sidebar-foreground\">FPK University</h2>\r\n            <p className=\"text-xs text-sidebar-foreground/70\">\r\n              {isAdmin ? 'Admin Portal' : isInstructor ? 'Instructor Portal' : 'Learner Portal'}\r\n              {isAdmin && <span className=\"ml-1 text-amber-500\">(Admin)</span>}\r\n              {isInstructor && !isAdmin && <span className=\"ml-1 text-blue-500\">(Instructor)</span>}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </SidebarHeader>\r\n\r\n      <SidebarContent className=\"px-2\">\r\n        {isAdmin && (\r\n          <SidebarGroup>\r\n            <SidebarGroupLabel className=\"text-sidebar-foreground/70 font-medium mb-2\">\r\n              Administration\r\n            </SidebarGroupLabel>\r\n            <SidebarGroupContent>\r\n              <SidebarMenu>\r\n                {adminMenuItems.map((item) => (\r\n                  <SidebarMenuItem key={item.title}>\r\n                    <SidebarMenuButton \r\n                      asChild \r\n                      className={`w-full transition-colors ${\r\n                        isActive(item.url) \r\n                          ? 'bg-sidebar-accent text-sidebar-accent-foreground' \r\n                          : 'text-sidebar-foreground hover:bg-sidebar-accent/50'\r\n                      }`}\r\n                    >\r\n                      <button\r\n                        onClick={() => handleNavigation(item)}\r\n                        className=\"flex items-center gap-3 w-full text-left\"\r\n                      >\r\n                        <item.icon className=\"h-4 w-4 flex-shrink-0\" />\r\n                        <span>{item.title}</span>\r\n                      </button>\r\n                    </SidebarMenuButton>\r\n                  </SidebarMenuItem>\r\n                ))}\r\n              </SidebarMenu>\r\n            </SidebarGroupContent>\r\n          </SidebarGroup>\r\n        )}\r\n\r\n        {/* SCORM - Admin only */}\r\n        {isAdmin && (\r\n          <SidebarGroup>\r\n            <SidebarGroupLabel className=\"text-sidebar-foreground/70 font-medium mb-2\">\r\n              SCORM\r\n            </SidebarGroupLabel>\r\n            <SidebarGroupContent>\r\n              <SidebarMenu>\r\n                {scormMenuItems.map((item) => (\r\n                  <SidebarMenuItem key={item.title}>\r\n                    <SidebarMenuButton \r\n                      asChild \r\n                      className={`w-full transition-colors ${\r\n                        isActive(item.url) \r\n                          ? 'bg-sidebar-accent text-sidebar-accent-foreground' \r\n                          : 'text-sidebar-foreground hover:bg-sidebar-accent/50'\r\n                      }`}\r\n                    >\r\n                      <button\r\n                        onClick={() => handleNavigation(item)}\r\n                        className=\"flex items-center gap-3 w-full text-left\"\r\n                      >\r\n                        <item.icon className=\"h-4 w-4 flex-shrink-0\" />\r\n                        <span>{item.title}</span>\r\n                      </button>\r\n                    </SidebarMenuButton>\r\n                  </SidebarMenuItem>\r\n                ))}\r\n              </SidebarMenu>\r\n            </SidebarGroupContent>\r\n          </SidebarGroup>\r\n        )}\r\n\r\n        {/* Instructor Menu */}\r\n        {isInstructor && (\r\n          <SidebarGroup>\r\n            <SidebarGroupLabel className=\"text-sidebar-foreground/70 font-medium mb-2\">\r\n              Organization Management\r\n            </SidebarGroupLabel>\r\n            <SidebarGroupContent>\r\n              <SidebarMenu>\r\n                {instructorMenuItems.map((item) => (\r\n                  <SidebarMenuItem key={item.title}>\r\n                    <SidebarMenuButton \r\n                      asChild \r\n                      className={`w-full transition-colors ${\r\n                        isActive(item.url) \r\n                          ? 'bg-sidebar-accent text-sidebar-accent-foreground' \r\n                          : 'text-sidebar-foreground hover:bg-sidebar-accent/50'\r\n                      }`}\r\n                    >\r\n                      <button\r\n                        onClick={() => handleNavigation(item)}\r\n                        className=\"flex items-center gap-3 w-full text-left\"\r\n                      >\r\n                        <item.icon className=\"h-4 w-4 flex-shrink-0\" />\r\n                        <span>{item.title}</span>\r\n                      </button>\r\n                    </SidebarMenuButton>\r\n                  </SidebarMenuItem>\r\n                ))}\r\n              </SidebarMenu>\r\n            </SidebarGroupContent>\r\n          </SidebarGroup>\r\n        )}\r\n\r\n        {/* Context-based Navigation */}\r\n        <SidebarGroup>\r\n          <SidebarGroupLabel className=\"text-sidebar-foreground/70 font-medium mb-2\">\r\n            {isPersonalMode ? 'Learning Dashboard' : 'Organization Dashboard'}\r\n          </SidebarGroupLabel>\r\n          <SidebarGroupContent>\r\n            <SidebarMenu>\r\n              {getContextualNavItems().map((item) => (\r\n                <SidebarMenuItem key={item.label}>\r\n                  <SidebarMenuButton \r\n                    asChild \r\n                    className={`w-full transition-colors ${\r\n                      isActive(item.to) \r\n                        ? 'bg-sidebar-accent text-sidebar-accent-foreground' \r\n                        : 'text-sidebar-foreground hover:bg-sidebar-accent/50'\r\n                    }`}\r\n                  >\r\n                    <button\r\n                      onClick={() => navigate(item.to)}\r\n                      className=\"flex items-center gap-3 w-full text-left\"\r\n                    >\r\n                      {renderIcon(item.icon)}\r\n                      <span>{item.label}</span>\r\n                    </button>\r\n                  </SidebarMenuButton>\r\n                </SidebarMenuItem>\r\n              ))}\r\n            </SidebarMenu>\r\n          </SidebarGroupContent>\r\n        </SidebarGroup>\r\n\r\n        <SidebarGroup className=\"mt-8\">\r\n          <SidebarGroupLabel className=\"text-sidebar-foreground/70 font-medium mb-2\">\r\n            Support\r\n          </SidebarGroupLabel>\r\n          <SidebarGroupContent>\r\n            <SidebarMenu>\r\n              {footerItems.map((item) => (\r\n                <SidebarMenuItem key={item.title}>\r\n                  <SidebarMenuButton \r\n                    asChild \r\n                    className={`w-full transition-colors ${\r\n                      isActive(item.url) \r\n                        ? 'bg-sidebar-accent text-sidebar-accent-foreground' \r\n                        : 'text-sidebar-foreground hover:bg-sidebar-accent/50'\r\n                    }`}\r\n                  >\r\n                    <button\r\n                      onClick={() => handleNavigation(item)}\r\n                      className=\"flex items-center gap-3 w-full text-left\"\r\n                    >\r\n                      <item.icon className=\"h-4 w-4 flex-shrink-0\" />\r\n                      <span>{item.title}</span>\r\n                    </button>\r\n                  </SidebarMenuButton>\r\n                </SidebarMenuItem>\r\n              ))}\r\n            </SidebarMenu>\r\n          </SidebarGroupContent>\r\n        </SidebarGroup>\r\n      </SidebarContent>\r\n\r\n      <SidebarFooter className=\"p-4 border-t border-sidebar-border\">\r\n        <div className=\"flex items-center gap-3 mb-3\">\r\n          <Avatar className=\"h-8 w-8\">\r\n            <AvatarImage src={profile?.avatar_url || \"\"} alt={getDisplayName()} />\r\n            <AvatarFallback className=\"fpk-gradient text-white text-sm font-semibold\">\r\n              {getInitials()}\r\n            </AvatarFallback>\r\n          </Avatar>\r\n          <div className=\"flex-1 min-w-0\">\r\n            <p className=\"text-sm font-medium text-sidebar-foreground truncate\">{getDisplayName()}</p>\r\n            <p className=\"text-xs text-sidebar-foreground/70 truncate\">{getUserEmail()}</p>\r\n          </div>\r\n        </div>\r\n        <Button \r\n          onClick={handleLogout}\r\n          variant=\"ghost\"\r\n          size=\"sm\" \r\n          className=\"w-full text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\"\r\n        >\r\n          Sign Out\r\n        </Button>\r\n        <div className=\"flex gap-4 justify-center text-xs text-sidebar-foreground/60 mt-2\">\r\n          <a href=\"/privacy-policy\" className=\"hover:text-sidebar-foreground/80 underline\">\r\n            Privacy\r\n          </a>\r\n          <a href=\"/terms-of-service\" className=\"hover:text-sidebar-foreground/80 underline\">\r\n            Terms\r\n          </a>\r\n        </div>\r\n      </SidebarFooter>\r\n    </Sidebar>\r\n  );\r\n};\r\n\r\nexport default AppSidebar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\CookieConsent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\CourseCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\DashboardLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\DataManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\DualLanguageText.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ErrorBoundaryUnified.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\GlobalChatWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\GlobalHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\LanguageSwitcher.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":70,"column":6,"nodeType":"ArrayExpression","endLine":70,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup]","fix":{"range":[2538,2540],"text":"[cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Label } from '@/components/ui/label';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n  DropdownMenuSeparator,\r\n} from '@/components/ui/dropdown-menu';\r\nimport { Globe, Check } from 'lucide-react';\r\nimport { supportedLanguages } from '@/i18n';\r\nimport { useUserProfile } from '@/hooks/useUserProfile';\r\nimport { useGlobalTranslation } from '@/hooks/useGlobalTranslation';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { logger } from '@/utils/logger';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\nconst LanguageSwitcher = () => {\r\n  const cleanup = useCleanup('LanguageSwitcher');\r\n  const { i18n, tString } = useGlobalTranslation('settings');\r\n  const { profile, updateProfile } = useUserProfile();\r\n  const [dualLanguageEnabled, setDualLanguageEnabled] = useState(false);\r\n\r\n  const currentLanguage = supportedLanguages.find(\r\n    (lang) => lang.code === i18n.language\r\n  ) || supportedLanguages[0];\r\n\r\n  // Sync state with profile when it loads\r\n  useEffect(() => {\r\n    if (profile) {\r\n      setDualLanguageEnabled(profile.dual_language_enabled || false);\r\n    } else {\r\n      // Fallback to localStorage if profile isn't loaded yet (safe)\r\n      const savedDualLanguage = safeLocalStorage.getItem<string>('fpk-dual-language', {\r\n        fallbackValue: 'false',\r\n        logErrors: false\r\n      });\r\n      if (savedDualLanguage) {\r\n        setDualLanguageEnabled(savedDualLanguage === 'true');\r\n      }\r\n    }\r\n  }, [profile]);\r\n\r\n  // Listen for changes from settings page\r\n  useEffect(() => {\r\n    const handleStorageChange = (e: StorageEvent) => {\r\n      if (e.key === 'fpk-dual-language') {\r\n        const newValue = e.newValue === 'true';\r\n        setDualLanguageEnabled(newValue);\r\n      }\r\n    };\r\n\r\n    const handleCustomStorageChange = (e: CustomEvent) => {\r\n      if (e.detail.key === 'fpk-dual-language') {\r\n        const newValue = e.detail.newValue === 'true';\r\n        setDualLanguageEnabled(newValue);\r\n      }\r\n    };\r\n\r\n    const storageListenerId = cleanup.addEventListener(window, 'storage', handleStorageChange);\r\n    const customListenerId = cleanup.addEventListener(window, 'dual-language-change', handleCustomStorageChange as EventListener);\r\n    \r\n    return () => {\r\n      cleanup.cleanup(storageListenerId);\r\n      cleanup.cleanup(customListenerId);\r\n    };\r\n  }, []);\r\n\r\n  const handleLanguageChange = async (languageCode: string) => {\r\n    logger.info('Changing language to:', 'LANGUAGE', { languageCode });\r\n    \r\n    // Update i18n\r\n    await i18n.changeLanguage(languageCode);\r\n    \r\n    // Save to localStorage for persistence (safe)\r\n    safeLocalStorage.setItem('fpk-language', languageCode);\r\n    \r\n    // Update user profile if available\r\n    if (profile) {\r\n      const languageName = supportedLanguages.find(\r\n        (lang) => lang.code === languageCode\r\n      )?.name || 'English';\r\n      \r\n      await updateProfile(\r\n        { \r\n          primary_language: languageName \r\n        },\r\n        true // silent update\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleDualLanguageToggle = async (enabled: boolean) => {\r\n    setDualLanguageEnabled(enabled);\r\n    \r\n    // Save to localStorage immediately (safe)\r\n    safeLocalStorage.setItem('fpk-dual-language', enabled.toString());\r\n    \r\n    // Trigger events for better component sync\r\n    window.dispatchEvent(new StorageEvent('storage', {\r\n      key: 'fpk-dual-language',\r\n      newValue: enabled.toString(),\r\n      oldValue: safeLocalStorage.getItem<string>('fpk-dual-language', { logErrors: false })\r\n    }));\r\n\r\n    window.dispatchEvent(new CustomEvent('dual-language-change', {\r\n      detail: {\r\n        key: 'fpk-dual-language',\r\n        newValue: enabled.toString()\r\n      }\r\n    }));\r\n    \r\n    // Update user profile if available\r\n    if (profile) {\r\n      try {\r\n        await updateProfile(\r\n          { \r\n            dual_language_enabled: enabled \r\n          },\r\n          true // silent update\r\n        );\r\n      } catch (error) {\r\n        logger.error('Failed to update dual language setting', 'LANGUAGE', error);\r\n        // Revert local state if update fails\r\n        setDualLanguageEnabled(!enabled);\r\n        safeLocalStorage.setItem('fpk-dual-language', (!enabled).toString());\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <DropdownMenu>\r\n      <DropdownMenuTrigger asChild>\r\n        <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\">\r\n          <Globe className=\"h-4 w-4\" />\r\n          <span className=\"hidden sm:inline\">{currentLanguage.native}</span>\r\n        </Button>\r\n      </DropdownMenuTrigger>\r\n      <DropdownMenuContent align=\"end\" className=\"w-64 bg-white border shadow-lg\">\r\n        <div className=\"px-3 py-2\">\r\n          <h4 className=\"font-medium text-sm\">{tString('language.primaryLanguage', 'Primary Language')}</h4>\r\n        </div>\r\n        {supportedLanguages.map((language) => (\r\n          <DropdownMenuItem\r\n            key={language.code}\r\n            onClick={() => handleLanguageChange(language.code)}\r\n            className=\"cursor-pointer hover:bg-gray-100\"\r\n          >\r\n            <div className=\"flex items-center justify-between w-full\">\r\n              <div className=\"flex flex-col\">\r\n                <span className=\"font-medium\">{language.native}</span>\r\n                <span className=\"text-xs text-gray-500\">{language.name}</span>\r\n              </div>\r\n              {i18n.language === language.code && (\r\n                <Check className=\"h-4 w-4 text-green-600\" />\r\n              )}\r\n            </div>\r\n          </DropdownMenuItem>\r\n        ))}\r\n        \r\n        <DropdownMenuSeparator />\r\n        \r\n        <div className=\"px-3 py-2\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"space-y-0.5\">\r\n              <Label htmlFor=\"dual-language-switcher\" className=\"text-sm font-medium\">\r\n                {tString('language.dualLanguageMode', 'Dual Language Mode')}\r\n              </Label>\r\n              <p className=\"text-xs text-gray-500\">\r\n                {tString('language.dualLanguageDescription', 'Show English alongside your language')}\r\n              </p>\r\n            </div>\r\n            <Switch\r\n              id=\"dual-language-switcher\"\r\n              checked={dualLanguageEnabled}\r\n              onCheckedChange={handleDualLanguageToggle}\r\n            />\r\n          </div>\r\n        </div>\r\n      </DropdownMenuContent>\r\n    </DropdownMenu>\r\n  );\r\n};\r\n\r\nexport default LanguageSwitcher;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\OnboardingFlowManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2095,2098],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2095,2098],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cleanup' and 'navigateToStep'. Either include them or remove the dependency array.","line":83,"column":6,"nodeType":"ArrayExpression","endLine":83,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, currentStep, isLoading, location.pathname, navigateToStep, navigationLock]","fix":{"range":[3154,3213],"text":"[cleanup, currentStep, isLoading, location.pathname, navigateToStep, navigationLock]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { useOnboardingFlow } from '@/hooks/useOnboardingFlow';\r\nimport BetaOnboarding from '@/components/beta/BetaOnboarding';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface OnboardingFlowManagerProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const OnboardingFlowManager: React.FC<OnboardingFlowManagerProps> = ({ children }) => {\r\n  const cleanup = useCleanup('OnboardingFlowManager');\r\n  const { \r\n    currentStep, \r\n    isLoading, \r\n    shouldShowBetaOnboarding,\r\n    navigateToStep,\r\n    completeOnboarding \r\n  } = useOnboardingFlow();\r\n  const location = useLocation();\r\n\r\n  // Store intended route for restoration after auth loading\r\n  const [navigationLock, setNavigationLock] = React.useState(false);\r\n  const lastValidRoute = React.useRef<string | null>(null);\r\n\r\n  // Handle automatic navigation based on flow state - with debouncing and conflict prevention\r\n  useEffect(() => {\r\n    if (isLoading || !currentStep || navigationLock) return;\r\n\r\n    const currentPath = location.pathname;\r\n    \r\n    // Store the last valid route for restoration\r\n    if (!isLoading && currentStep === 'dashboard') {\r\n      lastValidRoute.current = currentPath;\r\n    }\r\n    \r\n    // Removed excessive logging for performance\r\n\r\n    // Check route types\r\n    const isDashboardRoute = currentPath.startsWith('/dashboard');\r\n    const isProtectedRoute = isDashboardRoute || currentPath.startsWith('/profile') || currentPath.startsWith('/settings');\r\n    const isPublicRoute = currentPath === '/' || currentPath === '/login' || \r\n                         currentPath.startsWith('/privacy') || currentPath.startsWith('/terms');\r\n    const isPlanRoute = currentPath.startsWith('/choose-plan') || currentPath.startsWith('/subscription');\r\n    \r\n    // Debounced navigation with lock to prevent conflicts\r\n    const performNavigation = (step: string) => {\r\n      if (navigationLock) return;\r\n      \r\n      setNavigationLock(true);\r\n      cleanup.setTimeout(() => {\r\n        navigateToStep(step as any);\r\n        cleanup.setTimeout(() => setNavigationLock(false), 100);\r\n      }, 50);\r\n    };\r\n\r\n    // Only navigate when there's a clear mismatch (not during transitions)\r\n    switch (currentStep) {\r\n      case 'unauthenticated':\r\n        // Only redirect if trying to access protected routes\r\n        if (isProtectedRoute) {\r\n          performNavigation('unauthenticated');\r\n        }\r\n        break;\r\n      \r\n      case 'choose-plan':\r\n        // Only redirect if trying to access dashboard\r\n        if (isDashboardRoute) {\r\n          performNavigation('choose-plan');\r\n        }\r\n        break;\r\n        \r\n      case 'dashboard':\r\n        // Only redirect from auth/plan pages, restore intended route if possible\r\n        if (currentPath === '/login' || currentPath === '/choose-plan') {\r\n          const targetRoute = lastValidRoute.current && lastValidRoute.current.startsWith('/dashboard') \r\n            ? lastValidRoute.current \r\n            : '/dashboard/learner';\r\n          performNavigation('dashboard');\r\n        }\r\n        break;\r\n    }\r\n  }, [currentStep, isLoading, location.pathname, navigationLock]);\r\n\r\n  // Loading state\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary to-accent\">\r\n        <div className=\"text-center text-white\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4\"></div>\r\n          <p className=\"text-lg\">Initializing your learning experience...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {children}\r\n      {shouldShowBetaOnboarding && (\r\n        <BetaOnboarding \r\n          autoShow={true}\r\n          onComplete={completeOnboarding}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\RouteProtector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\StandaloneAIStudyCoachChat.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1474,1477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1474,1477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":321,"column":6,"nodeType":"ArrayExpression","endLine":321,"endColumn":90,"suggestions":[{"desc":"Update the dependencies array to be: [messages, autoPlayEnabled, settings.enabled, lastSpokenMessageId, isLoading, speak, cleanup]","fix":{"range":[11082,11166],"text":"[messages, autoPlayEnabled, settings.enabled, lastSpokenMessageId, isLoading, speak, cleanup]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Send, Brain, User, Bot, Mic, MicOff, Volume2, VolumeX, Play, History, MessageCircle, Trash2 } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useTextToSpeech } from '@/hooks/useTextToSpeech';\r\nimport { useEnhancedVoiceInput } from '@/hooks/useEnhancedVoiceInput';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { useVoiceSettings } from '@/contexts/VoiceSettingsContext';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { cn } from '@/lib/utils';\r\nimport { useWidgetChatStorage } from '@/hooks/useWidgetChatStorage';\r\nimport { useConversationState, ChatMessage as ConversationMessage } from '@/hooks/useConversationState';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport VoiceInputButton from '@/components/notes/VoiceInputButton';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport { logger } from '@/utils/logger';\r\n\r\ninterface ChatMessage {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\n// Helper to prevent hanging requests with cleanup manager\r\nconst withTimeout = <T,>(promise: Promise<T>, cleanup: any, ms = 18000, timeoutMessage = 'AI response timed out'): Promise<T> => {\r\n  return new Promise((resolve, reject) => {\r\n    const timerId = cleanup.setTimeout(() => reject(new Error(timeoutMessage)), ms);\r\n    promise.then((value) => {\r\n      cleanup.cleanup(timerId);\r\n      resolve(value);\r\n    }).catch((err) => {\r\n      cleanup.cleanup(timerId);\r\n      reject(err);\r\n    });\r\n  });\r\n};\r\n\r\nconst StandaloneAIStudyCoachChat: React.FC = () => {\r\n  const cleanup = useCleanup('StandaloneAIStudyCoachChat');\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  // Use anonymous ID for non-authenticated users\r\n  const anonymousId = useState(() => `anonymous_${Date.now()}`)[0];\r\n  const { messages, addMessage, clearAllMessages } = useWidgetChatStorage(user?.id || anonymousId);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [input, setInput] = useState('');\r\n  const [sessionId] = useState(() => uuidv4());\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const [lastSpokenMessageId, setLastSpokenMessageId] = useState<string | null>(null);\r\n  const [hasPlayedIntro, setHasPlayedIntro] = useState(false);\r\n  const [autoPlayEnabled, setAutoPlayEnabled] = useState(() => \r\n    safeLocalStorage.getItem<string>('aistudycoach_voice_autoplay', {\r\n      fallbackValue: 'false',\r\n      logErrors: false\r\n    }) === 'true'\r\n  );\r\n  \r\n  const { speak, stop, isSpeaking } = useTextToSpeech();\r\n  const { settings, toggle } = useVoiceSettings();\r\n  const voiceInput = useEnhancedVoiceInput();\r\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Auto scroll when messages change\r\n  useEffect(() => {\r\n    if (messages.length > 0) {\r\n      cleanup.setTimeout(() => {\r\n        messagesEndRef.current?.scrollIntoView({ \r\n          behavior: 'smooth',\r\n          block: 'end',\r\n          inline: 'nearest'\r\n        });\r\n      }, 100);\r\n    }\r\n  }, [messages, cleanup]);\r\n\r\n  // Add welcome message if no messages exist\r\n  useEffect(() => {\r\n    if (messages.length === 0) {\r\n      const welcomeMessage = {\r\n        role: 'assistant' as const,\r\n        content: `Hello! I'm your AI Learning Coach in demo mode. I can help you with:\r\n\r\nðŸŒ **General Knowledge** - Any subject, research, or educational topics\r\nðŸ“– **Study Techniques** - Learning strategies and academic methods  \r\nðŸ’¡ **Learning Guidance** - Study tips and educational advice\r\nðŸ” **How-To Guides** - General learning and study methods\r\n\r\nNote: This is a demo version with limited features. For full personalized features with your study data, please log in to the main platform.\r\n\r\nWhat would you like to learn about today?`\r\n      };\r\n      \r\n      addMessage(welcomeMessage);\r\n    }\r\n  }, [messages.length, addMessage]);\r\n\r\n  // Enhanced prompt type detection using conversation state analysis\r\n  const { state: conversationState, analyzeConversation, updateState } = useConversationState();\r\n\r\n  const sendMessage = async (messageText: string) => {\r\n    if (!messageText.trim() || isLoading) return;\r\n\r\n    const userMessage = {\r\n      role: 'user' as const,\r\n      content: messageText.trim()\r\n    };\r\n\r\n    addMessage(userMessage);\r\n    setInput('');\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      // Convert messages to conversation format for analysis\r\n      const conversationHistory: ConversationMessage[] = messages.map(msg => ({\r\n        role: msg.role,\r\n        content: msg.content,\r\n        timestamp: msg.timestamp\r\n      }));\r\n      \r\n      // Analyze conversation to determine proper context and prompt type\r\n      const analyzedState = analyzeConversation(conversationHistory, messageText);\r\n      updateState(analyzedState);\r\n      \r\n      // Build contextData from conversation state\r\n      const contextData = {\r\n        quizTopic: analyzedState.currentTopic,\r\n        teachingHistory: analyzedState.teachingMethods.join(', '),\r\n        incorrectCount: analyzedState.incorrectAnswersCount,\r\n        isInQuiz: analyzedState.isInQuiz,\r\n        inRefresherMode: analyzedState.inRefresherMode\r\n      };\r\n\r\n      // Build lightweight client history (last 6 messages)\r\n      const clientHistory = messages.slice(-6).map(m => ({\r\n        role: m.role,\r\n        content: m.content,\r\n        timestamp: m.timestamp\r\n      }));\r\n      \r\n      // Call AI function with enhanced context\r\n      const { data, error } = await withTimeout(\r\n        supabase.functions.invoke('ai-study-chat', {\r\n          body: {\r\n            message: messageText,\r\n            userId: user?.id || anonymousId,\r\n            sessionId,\r\n            promptType: analyzedState.promptType,\r\n            chatMode: 'general',\r\n            voiceActive: false,\r\n            contextData,\r\n            clientHistory\r\n          }\r\n        }),\r\n        cleanup,\r\n        18000\r\n      );\r\n      \r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (!data?.response) {\r\n        throw new Error('No response received from AI');\r\n      }\r\n\r\n      const aiResponse = {\r\n        role: 'assistant' as const,\r\n        content: data.response\r\n      };\r\n\r\n      addMessage(aiResponse);\r\n\r\n      // Update conversation state based on AI response\r\n      if (data.metadata?.promptType) {\r\n        updateState({ \r\n          promptType: data.metadata.promptType,\r\n          lastAIQuestion: data.response.includes('?') ? data.response : null\r\n        });\r\n      }\r\n\r\n    } catch (error) {\r\n      logger.error('Chat error details', 'CHAT', {\r\n        error: error instanceof Error ? error.message : error,\r\n        messageText: messageText.substring(0, 50) + '...',\r\n        timestamp: new Date().toISOString(),\r\n        conversationState: conversationState\r\n      });\r\n      \r\n      const fallbackResponse = {\r\n        role: 'assistant' as const,\r\n        content: generateFallbackResponse(messageText)\r\n      };\r\n\r\n      addMessage(fallbackResponse);\r\n      \r\n      // Show more specific error message\r\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n      const isValidationError = errorMessage.includes('promptType') || errorMessage.includes('required');\r\n      \r\n      toast({\r\n        title: isValidationError ? \"Configuration Issue\" : \"Connection Issue\",\r\n        description: isValidationError ? \"Please refresh and try again\" : \"Using offline mode\",\r\n        variant: isValidationError ? \"destructive\" : \"default\",\r\n        duration: 3000\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const generateFallbackResponse = (userMsg: string): string => {\r\n    return `I'm experiencing a connection issue, but I can still help with \"${userMsg}\":\r\n\r\nðŸŽ¯ **Study Recommendations:**\r\n- Try active recall: test yourself without looking at answers\r\n- Use spaced repetition: review material at increasing intervals\r\n- Break complex topics into smaller, manageable chunks\r\n\r\nðŸ“š **Study Techniques:**\r\n- **Pomodoro Method**: 25-min focused sessions with 5-min breaks\r\n- **Feynman Technique**: Explain concepts in simple terms\r\n- **Active Learning**: Engage with material through questions and discussions\r\n\r\nðŸ’¡ **Next Steps:**\r\n- Create flashcards for key concepts\r\n- Practice with quiz sessions when available\r\n- Set up a regular study schedule\r\n\r\nWhat specific topic would you like to focus on?`;\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      sendMessage(input);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    sendMessage(input);\r\n  };\r\n\r\n  const handleVoiceInput = (transcription: string) => {\r\n    if (transcription.trim()) {\r\n      setInput(transcription);\r\n      // Auto-send voice input\r\n      cleanup.setTimeout(() => sendMessage(transcription), 100);\r\n    }\r\n  };\r\n\r\n  const handleTTSToggle = () => {\r\n    if (isSpeaking) {\r\n      stop();\r\n    } else {\r\n      // Find the last AI message and speak it\r\n      const lastAIMessage = messages.filter(m => m.role === 'assistant').pop();\r\n      if (lastAIMessage) {\r\n        speak(lastAIMessage.content);\r\n        setLastSpokenMessageId(lastAIMessage.id);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleAutoPlayToggle = () => {\r\n    const newAutoPlay = !autoPlayEnabled;\r\n    setAutoPlayEnabled(newAutoPlay);\r\n    safeLocalStorage.setItem('aistudycoach_voice_autoplay', newAutoPlay.toString());\r\n    \r\n    // Shorter, less intrusive toast\r\n    toast({\r\n      title: newAutoPlay ? \"Auto-play on\" : \"Auto-play off\",\r\n      duration: 1500\r\n    });\r\n  };\r\n\r\n  const handleClearChat = () => {\r\n    clearAllMessages();\r\n    stop(); // Stop any current speech\r\n    setLastSpokenMessageId(null);\r\n    // Reset conversation state\r\n    updateState({\r\n      promptType: 'initiate_session',\r\n      isInQuiz: false,\r\n      inRefresherMode: false,\r\n      lastAIQuestion: null,\r\n      currentTopic: null,\r\n      incorrectAnswersCount: 0,\r\n      teachingMethods: []\r\n    });\r\n    \r\n    toast({\r\n      title: \"Chat cleared\",\r\n      description: \"Starting fresh conversation\",\r\n      duration: 2000\r\n    });\r\n  };\r\n\r\n  // Auto-play AI responses if enabled\r\n  useEffect(() => {\r\n    if (!autoPlayEnabled || !settings.enabled) return;\r\n    \r\n    const lastMessage = messages[messages.length - 1];\r\n    if (lastMessage && \r\n        lastMessage.role === 'assistant' && \r\n        lastMessage.id !== lastSpokenMessageId &&\r\n        !isLoading) {\r\n      \r\n      // Small delay to ensure message is rendered\r\n      cleanup.setTimeout(() => {\r\n        speak(lastMessage.content);\r\n        setLastSpokenMessageId(lastMessage.id);\r\n      }, 500);\r\n    }\r\n  }, [messages, autoPlayEnabled, settings.enabled, lastSpokenMessageId, isLoading, speak]);\r\n\r\n  return (\r\n    <div className=\"h-screen flex flex-col bg-background\">\r\n      {/* Demo Badge */}\r\n      <div className=\"flex-shrink-0 bg-primary/10 border-b border-border p-2 flex items-center justify-between\">\r\n        <span className=\"text-sm text-muted-foreground\">\r\n          ðŸ¤– AI Study Coach Demo - No login required\r\n        </span>\r\n        {messages.length >= 1 && (\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={handleClearChat}\r\n            className=\"h-6 px-2 text-xs text-muted-foreground hover:text-foreground\"\r\n          >\r\n            <Trash2 className=\"w-3 h-3 mr-1\" />\r\n            Clear\r\n          </Button>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Main Content Container - Single scrollable area for messages only */}\r\n      <div className=\"flex-1 overflow-y-auto p-4 max-w-4xl mx-auto w-full scrollbar-thin scrollbar-thumb-muted scrollbar-track-transparent\">\r\n        {/* Messages Area */}\r\n        <div className=\"space-y-4\">\r\n          {messages.length === 0 ? (\r\n            <div className=\"flex items-center justify-center h-full\">\r\n              <div className=\"text-center text-muted-foreground\">\r\n                <MessageCircle className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\r\n                <p className=\"text-lg font-medium mb-2\">AI Study Coach</p>\r\n                <p className=\"text-sm\">Start a conversation to get personalized learning assistance</p>\r\n                <p className=\"text-xs mt-2 opacity-75\">This is a demo version - try asking study-related questions!</p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {messages.map((msg) => (\r\n                <div\r\n                  key={msg.id}\r\n                  className={cn(\r\n                    \"flex gap-3 p-4 rounded-lg max-w-[85%]\",\r\n                    msg.role === 'user'\r\n                      ? \"ml-auto bg-primary text-primary-foreground\"\r\n                      : \"mr-auto bg-muted\"\r\n                  )}\r\n                >\r\n                  <div className=\"flex-shrink-0\">\r\n                    {msg.role === 'user' ? (\r\n                      <User className=\"w-6 h-6\" />\r\n                    ) : (\r\n                      <Bot className=\"w-6 h-6 text-purple-600\" />\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex-1 space-y-2\">\r\n                    <div className=\"prose prose-sm dark:prose-invert max-w-none\">\r\n                      <div className=\"whitespace-pre-wrap break-words\">\r\n                        {msg.content}\r\n                      </div>\r\n                    </div>\r\n                    {msg.role === 'assistant' && settings.enabled && (\r\n                      <div className=\"flex items-center gap-2 mt-2\">\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => {\r\n                            if (isSpeaking && lastSpokenMessageId === msg.id) {\r\n                              stop();\r\n                            } else {\r\n                              speak(msg.content);\r\n                              setLastSpokenMessageId(msg.id);\r\n                            }\r\n                          }}\r\n                          disabled={!settings.enabled}\r\n                          className=\"h-6 px-2 text-xs\"\r\n                        >\r\n                          {isSpeaking && lastSpokenMessageId === msg.id ? (\r\n                            <VolumeX className=\"w-3 h-3\" />\r\n                          ) : (\r\n                            <Volume2 className=\"w-3 h-3\" />\r\n                          )}\r\n                        </Button>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n              {isLoading && (\r\n                <div className=\"flex gap-3 p-4 rounded-lg max-w-[85%] mr-auto bg-muted\">\r\n                  <div className=\"flex-shrink-0\">\r\n                    <Bot className=\"w-6 h-6 text-purple-600\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n                      <div className=\"flex space-x-1\">\r\n                        <div className=\"w-2 h-2 bg-current rounded-full animate-bounce\" style={{ animationDelay: '0ms' }}></div>\r\n                        <div className=\"w-2 h-2 bg-current rounded-full animate-bounce\" style={{ animationDelay: '150ms' }}></div>\r\n                        <div className=\"w-2 h-2 bg-current rounded-full animate-bounce\" style={{ animationDelay: '300ms' }}></div>\r\n                      </div>\r\n                      <span className=\"text-sm\">AI is thinking...</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <div ref={messagesEndRef} />\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Fixed Bottom Controls Container */}\r\n      <div className=\"flex-shrink-0 p-4 max-w-4xl mx-auto w-full\">\r\n        {/* Voice Controls Row */}\r\n        {settings.enabled && (\r\n          <div className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg mb-4\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={handleTTSToggle}\r\n                  disabled={!settings.enabled}\r\n                >\r\n                  {isSpeaking ? <VolumeX className=\"w-4 h-4\" /> : <Volume2 className=\"w-4 h-4\" />}\r\n                  {isSpeaking ? 'Stop' : 'Read'}\r\n                </Button>\r\n                <Button\r\n                  variant={autoPlayEnabled ? \"default\" : \"outline\"}\r\n                  size=\"sm\"\r\n                  onClick={handleAutoPlayToggle}\r\n                  disabled={!settings.enabled}\r\n                >\r\n                  <Play className=\"w-4 h-4 mr-1\" />\r\n                  Auto-play\r\n                </Button>\r\n                {messages.length >= 1 && (\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={handleClearChat}\r\n                    className=\"text-muted-foreground hover:text-foreground\"\r\n                  >\r\n                    <Trash2 className=\"w-4 h-4 mr-1\" />\r\n                    Clear\r\n                  </Button>\r\n                )}\r\n              </div>\r\n              {isSpeaking && (\r\n                <div className=\"text-sm text-muted-foreground flex items-center gap-1\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n                  Speaking...\r\n                </div>\r\n              )}\r\n            </div>\r\n            {voiceInput.isRecording && (\r\n              <div className=\"text-sm text-muted-foreground flex items-center gap-1\">\r\n                <div className=\"w-2 h-2 bg-red-500 rounded-full animate-pulse\"></div>\r\n                Recording...\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Input Form */}\r\n        <form onSubmit={handleSubmit} className=\"flex gap-2 items-end\">\r\n          <div className=\"flex-1 relative\">\r\n            <Input\r\n              ref={inputRef}\r\n              value={input}\r\n              onChange={(e) => setInput(e.target.value)}\r\n              onKeyPress={handleKeyPress}\r\n              placeholder=\"Ask me anything about learning...\"\r\n              disabled={isLoading}\r\n              className=\"min-h-[44px] pr-12\"\r\n            />\r\n            {settings.enabled && (\r\n              <div className=\"absolute right-2 top-1/2 -translate-y-1/2\">\r\n                <VoiceInputButton\r\n                  onTranscription={handleVoiceInput}\r\n                  placeholder=\"voice input\"\r\n                  disabled={isLoading}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n          <Button \r\n            type=\"submit\" \r\n            size=\"icon\"\r\n            disabled={!input.trim() || isLoading}\r\n            className=\"flex-shrink-0\"\r\n          >\r\n            <Send className=\"w-4 h-4\" />\r\n          </Button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StandaloneAIStudyCoachChat;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\SubscriptionGate.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\accessibility\\AccessibilityErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\accessibility\\AccessibilityTester.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\AdminOrgCreationModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ChangeSubscriptionDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\CommunityBooksApproval.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\DeleteOrganizationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\EPUBIngestionManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\EPUBStorageManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\EditOrganizationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\EnhancedModuleViewer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\EnhancedUsersTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ExportDataDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\FeedbackCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\FeedbackMetadata.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\GutenbergBulkIngestion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\LessonManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ManageInstructorsDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2445,2448],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2445,2448],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { \r\n  Dialog, \r\n  DialogContent, \r\n  DialogDescription, \r\n  DialogHeader, \r\n  DialogTitle \r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { \r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\nimport { \r\n  Search, \r\n  UserMinus, \r\n  MoreHorizontal,\r\n  Plus,\r\n  Users\r\n} from 'lucide-react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { format } from 'date-fns';\r\nimport type { Organization, OrgMember } from '@/types/organization';\r\n\r\n// Explicit interface to avoid deep type instantiation\r\ninterface InstructorRow {\r\n  id: string;\r\n  org_id: string;\r\n  user_id: string;\r\n  role: string;\r\n  status: string;\r\n  created_at: string;\r\n  joined_at: string | null;\r\n  access_revoked_at: string | null;\r\n  access_revoked_reason: string | null;\r\n  invitation_link: string | null;\r\n  profiles: {\r\n    full_name: string | null;\r\n    display_name: string | null;\r\n  } | null;\r\n}\r\n\r\ninterface ManageInstructorsDialogProps {\r\n  organization: Organization;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n}\r\n\r\nexport function ManageInstructorsDialog({ \r\n  organization, \r\n  open, \r\n  onOpenChange \r\n}: ManageInstructorsDialogProps) {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  // Fetch instructors for this organization\r\n  const { data: instructors, isLoading } = useQuery({\r\n    queryKey: ['org-instructors', organization.id],\r\n    queryFn: async (): Promise<InstructorRow[]> => {\r\n      const { data, error } = await supabase\r\n        .from('org_members')\r\n        .select(`\r\n          *,\r\n          profiles:user_id (\r\n            full_name,\r\n            display_name\r\n          )\r\n        `)\r\n        .eq('org_id', organization.id)\r\n        .eq('role', 'instructor')\r\n        .eq('status', 'active')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return (data || []) as any[];\r\n    },\r\n    enabled: open,\r\n  });\r\n\r\n  // Remove instructor mutation\r\n  const removeInstructorMutation = useMutation({\r\n    mutationFn: async (memberId: string) => {\r\n      const { error } = await supabase\r\n        .from('org_members')\r\n        .update({ \r\n          status: 'removed',\r\n          removed_at: new Date().toISOString()\r\n        })\r\n        .eq('id', memberId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-instructors', organization.id] });\r\n      queryClient.invalidateQueries({ queryKey: ['organization', organization.id] });\r\n      toast({\r\n        title: 'Instructor removed',\r\n        description: 'The instructor has been removed from the organization.',\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      toast({\r\n        title: 'Error removing instructor',\r\n        description: error.message,\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n\r\n  const filteredInstructors = instructors?.filter(instructor =>\r\n    instructor.profiles?.full_name?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n    instructor.profiles?.display_name?.toLowerCase().includes(searchQuery.toLowerCase())\r\n  ) || [];\r\n\r\n  const getStatusVariant = (status: string) => {\r\n    switch (status) {\r\n      case 'active': return 'default';\r\n      case 'paused': return 'secondary';\r\n      case 'removed': return 'destructive';\r\n      default: return 'outline';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-hidden flex flex-col\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Users className=\"h-5 w-5\" />\r\n            Manage Instructors - {organization.name}\r\n          </DialogTitle>\r\n        <DialogDescription>\r\n          Manage instructors for this organization. Current usage: {organization.instructors_used || 0}/{organization.instructor_limit || 1}\r\n        </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"flex items-center space-x-2 py-4\">\r\n          <div className=\"relative flex-1\">\r\n            <Search className=\"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder=\"Search instructors...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-8\"\r\n            />\r\n          </div>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            disabled={(organization.instructors_used || 0) >= (organization.instructor_limit || 1)}\r\n          >\r\n            <Plus className=\"h-4 w-4 mr-2\" />\r\n            Add Instructor\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"flex-1 overflow-auto\">\r\n          {isLoading ? (\r\n            <div className=\"text-center py-8\">Loading instructors...</div>\r\n          ) : filteredInstructors.length === 0 ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              {searchQuery ? 'No instructors found matching your search.' : 'No instructors found.'}\r\n            </div>\r\n          ) : (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Name</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead>Joined</TableHead>\r\n                  <TableHead className=\"w-[50px]\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {filteredInstructors.map((instructor) => (\r\n                  <TableRow key={instructor.id}>\r\n                    <TableCell>\r\n                      <div>\r\n                        <div className=\"font-medium\">\r\n                          {instructor.profiles?.full_name || instructor.profiles?.display_name || 'Unknown'}\r\n                        </div>\r\n                        <div className=\"text-sm text-muted-foreground\">\r\n                          Instructor\r\n                        </div>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Badge variant={getStatusVariant(instructor.status)}>\r\n                        {instructor.status}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {instructor.joined_at \r\n                        ? format(new Date(instructor.joined_at), 'MMM d, yyyy')\r\n                        : 'Unknown'\r\n                      }\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                          <Button variant=\"ghost\" size=\"sm\">\r\n                            <MoreHorizontal className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                          <DropdownMenuItem\r\n                            onClick={() => removeInstructorMutation.mutate(instructor.id)}\r\n                            className=\"text-destructive\"\r\n                          >\r\n                            <UserMinus className=\"h-4 w-4 mr-2\" />\r\n                            Remove instructor\r\n                          </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                      </DropdownMenu>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex items-center justify-between pt-4 border-t\">\r\n          <div className=\"text-sm text-muted-foreground\">\r\n            Showing {filteredInstructors.length} instructor(s)\r\n          </div>\r\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n            Close\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ManageMembersDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ModuleManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\OrganizationActionsDropdown.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\PopulateApprovedBooks.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ScormUploader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\SendBetaUpdate.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\SendNotificationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\SuspendOrganizationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\SystemHealthDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":349,"column":102,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":349,"endColumn":105,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13492,13495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13492,13495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { \r\n  Activity, \r\n  AlertTriangle, \r\n  CheckCircle, \r\n  Clock, \r\n  Cpu, \r\n  HardDrive, \r\n  Network, \r\n  Zap,\r\n  RefreshCw,\r\n  TrendingUp,\r\n  TrendingDown\r\n} from 'lucide-react';\r\nimport { systemDiagnostics } from '@/utils/systemDiagnostics';\r\nimport { memoryManager } from '@/utils/memoryManager';\r\nimport { useMonitoring } from '@/hooks/useMonitoring';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport { logger } from '@/utils/logger';\r\n\r\ninterface SystemHealthData {\r\n  overallScore: number;\r\n  issues: Array<{\r\n    category: string;\r\n    issue: string;\r\n    severity: 'low' | 'medium' | 'high' | 'critical';\r\n    status: 'detected' | 'fixed' | 'monitoring';\r\n    details: string;\r\n    recommendation?: string;\r\n  }>;\r\n  memoryUsage: number;\r\n  performanceScore: number;\r\n  networkHealth: number;\r\n  recommendations: string[];\r\n}\r\n\r\nconst SystemHealthDashboard: React.FC = () => {\r\n  const cleanup = useCleanup('SystemHealthDashboard');\r\n  const [healthData, setHealthData] = useState<SystemHealthData | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [lastUpdate, setLastUpdate] = useState<Date | null>(null);\r\n  const [autoRefresh, setAutoRefresh] = useState(true);\r\n  const { dashboardData } = useMonitoring();\r\n\r\n  const runDiagnostics = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const results = await systemDiagnostics.runFullDiagnostics();\r\n      setHealthData(results);\r\n      setLastUpdate(new Date());\r\n    } catch (error) {\r\n      logger.error('Failed to run diagnostics', 'SYSTEM_HEALTH', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    runDiagnostics();\r\n\r\n    // Auto-refresh every 2 minutes if enabled using cleanupManager\r\n    if (autoRefresh) {\r\n      import('../../utils/cleanupManager').then(({ cleanupManager }) => {\r\n        const intervalId = cleanupManager.setInterval(runDiagnostics, 120000, 'system-health-dashboard');\r\n        return () => cleanupManager.cleanup(intervalId);\r\n      });\r\n    }\r\n  }, [autoRefresh]);\r\n\r\n  // Listen for system health alerts\r\n  useEffect(() => {\r\n    const handleHealthAlert = (event: CustomEvent) => {\r\n      setHealthData(event.detail);\r\n      setLastUpdate(new Date());\r\n    };\r\n\r\n    const healthAlertListenerId = cleanup.addEventListener(window, 'system-health-alert', handleHealthAlert as EventListener);\r\n    return () => {\r\n      cleanup.cleanup(healthAlertListenerId);\r\n    };\r\n  }, [cleanup]);\r\n\r\n  const getScoreColor = (score: number) => {\r\n    if (score >= 90) return 'text-green-600';\r\n    if (score >= 70) return 'text-yellow-600';\r\n    if (score >= 50) return 'text-orange-600';\r\n    return 'text-red-600';\r\n  };\r\n\r\n  const getScoreIcon = (score: number) => {\r\n    if (score >= 90) return <CheckCircle className=\"h-5 w-5 text-green-600\" />;\r\n    if (score >= 70) return <AlertTriangle className=\"h-5 w-5 text-yellow-600\" />;\r\n    return <AlertTriangle className=\"h-5 w-5 text-red-600\" />;\r\n  };\r\n\r\n  const getSeverityBadge = (severity: string) => {\r\n    const colors = {\r\n      low: 'bg-blue-100 text-blue-800',\r\n      medium: 'bg-yellow-100 text-yellow-800',\r\n      high: 'bg-orange-100 text-orange-800',\r\n      critical: 'bg-red-100 text-red-800'\r\n    };\r\n    return (\r\n      <Badge className={colors[severity as keyof typeof colors] || colors.medium}>\r\n        {severity.toUpperCase()}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'fixed': return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\r\n      case 'monitoring': return <Activity className=\"h-4 w-4 text-blue-600\" />;\r\n      default: return <AlertTriangle className=\"h-4 w-4 text-orange-600\" />;\r\n    }\r\n  };\r\n\r\n  const forceMemoryCleanup = () => {\r\n    memoryManager.forceGC();\r\n    // Trigger a re-diagnostic after cleanup\r\n    cleanup.setTimeout(runDiagnostics, 1000);\r\n  };\r\n\r\n  if (!healthData && !isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Activity className=\"h-5 w-5\" />\r\n            System Health Dashboard\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Button onClick={runDiagnostics} className=\"w-full\">\r\n            Run System Diagnostics\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with controls */}\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Activity className=\"h-5 w-5\" />\r\n              System Health Dashboard\r\n            </CardTitle>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setAutoRefresh(!autoRefresh)}\r\n              >\r\n                {autoRefresh ? 'Disable' : 'Enable'} Auto-refresh\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={runDiagnostics}\r\n                disabled={isLoading}\r\n              >\r\n                <RefreshCw className={`h-4 w-4 mr-2 ${isLoading ? 'animate-spin' : ''}`} />\r\n                Refresh\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={forceMemoryCleanup}\r\n              >\r\n                <HardDrive className=\"h-4 w-4 mr-2\" />\r\n                Clean Memory\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          {lastUpdate && (\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Last updated: {lastUpdate.toLocaleTimeString()}\r\n            </p>\r\n          )}\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      {isLoading && (\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <RefreshCw className=\"h-5 w-5 animate-spin\" />\r\n              <span>Running comprehensive system diagnostics...</span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {healthData && (\r\n        <>\r\n          {/* Overall health score */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <Card>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-muted-foreground\">Overall Health</p>\r\n                    <p className={`text-2xl font-bold ${getScoreColor(healthData.overallScore)}`}>\r\n                      {healthData.overallScore}%\r\n                    </p>\r\n                  </div>\r\n                  {getScoreIcon(healthData.overallScore)}\r\n                </div>\r\n                <Progress value={healthData.overallScore} className=\"mt-2\" />\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-muted-foreground\">Memory Usage</p>\r\n                    <p className={`text-2xl font-bold ${getScoreColor(100 - healthData.memoryUsage)}`}>\r\n                      {healthData.memoryUsage.toFixed(1)}%\r\n                    </p>\r\n                  </div>\r\n                  <HardDrive className=\"h-5 w-5\" />\r\n                </div>\r\n                <Progress value={healthData.memoryUsage} className=\"mt-2\" />\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-muted-foreground\">Performance</p>\r\n                    <p className={`text-2xl font-bold ${getScoreColor(healthData.performanceScore)}`}>\r\n                      {healthData.performanceScore.toFixed(0)}\r\n                    </p>\r\n                  </div>\r\n                  <Zap className=\"h-5 w-5\" />\r\n                </div>\r\n                <Progress value={healthData.performanceScore} className=\"mt-2\" />\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-muted-foreground\">Network Health</p>\r\n                    <p className={`text-2xl font-bold ${getScoreColor(healthData.networkHealth)}`}>\r\n                      {healthData.networkHealth}%\r\n                    </p>\r\n                  </div>\r\n                  <Network className=\"h-5 w-5\" />\r\n                </div>\r\n                <Progress value={healthData.networkHealth} className=\"mt-2\" />\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <Tabs defaultValue=\"issues\" className=\"space-y-4\">\r\n            <TabsList>\r\n              <TabsTrigger value=\"issues\">Issues ({healthData.issues.length})</TabsTrigger>\r\n              <TabsTrigger value=\"recommendations\">Recommendations</TabsTrigger>\r\n              <TabsTrigger value=\"monitoring\">Live Monitoring</TabsTrigger>\r\n            </TabsList>\r\n\r\n            <TabsContent value=\"issues\" className=\"space-y-4\">\r\n              {healthData.issues.length === 0 ? (\r\n                <Card>\r\n                  <CardContent className=\"p-6 text-center\">\r\n                    <CheckCircle className=\"h-12 w-12 text-green-600 mx-auto mb-2\" />\r\n                    <p className=\"text-lg font-semibold text-green-600\">No Issues Detected!</p>\r\n                    <p className=\"text-muted-foreground\">Your system is running optimally.</p>\r\n                  </CardContent>\r\n                </Card>\r\n              ) : (\r\n                healthData.issues.map((issue, index) => (\r\n                  <Card key={index}>\r\n                    <CardContent className=\"p-6\">\r\n                      <div className=\"flex items-start justify-between\">\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"flex items-center gap-3 mb-2\">\r\n                            {getStatusIcon(issue.status)}\r\n                            <h3 className=\"font-semibold\">{issue.issue}</h3>\r\n                            {getSeverityBadge(issue.severity)}\r\n                          </div>\r\n                          <p className=\"text-sm text-muted-foreground mb-2\">\r\n                            Category: <span className=\"font-medium\">{issue.category}</span>\r\n                          </p>\r\n                          <p className=\"text-sm mb-3\">{issue.details}</p>\r\n                          {issue.recommendation && (\r\n                            <Alert>\r\n                              <AlertDescription>{issue.recommendation}</AlertDescription>\r\n                            </Alert>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))\r\n              )}\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"recommendations\" className=\"space-y-4\">\r\n              {healthData.recommendations.length === 0 ? (\r\n                <Card>\r\n                  <CardContent className=\"p-6 text-center\">\r\n                    <CheckCircle className=\"h-12 w-12 text-green-600 mx-auto mb-2\" />\r\n                    <p className=\"text-lg font-semibold\">No Recommendations</p>\r\n                    <p className=\"text-muted-foreground\">Your system is well-optimized.</p>\r\n                  </CardContent>\r\n                </Card>\r\n              ) : (\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle>System Optimization Recommendations</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <ul className=\"space-y-3\">\r\n                      {healthData.recommendations.map((rec, index) => (\r\n                        <li key={index} className=\"flex items-start gap-3\">\r\n                          <TrendingUp className=\"h-4 w-4 text-blue-600 mt-1 flex-shrink-0\" />\r\n                          <span>{rec}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </CardContent>\r\n                </Card>\r\n              )}\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"monitoring\" className=\"space-y-4\">\r\n              {dashboardData && (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <Card>\r\n                    <CardHeader>\r\n                      <CardTitle className=\"text-lg\">SLO Status</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                      {Object.entries(dashboardData.sloStatus || {}).map(([metric, status]: [string, any]) => (\r\n                        <div key={metric} className=\"flex items-center justify-between py-2\">\r\n                          <span className=\"capitalize\">{metric.replace(/_/g, ' ')}</span>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-sm text-muted-foreground\">\r\n                              {status.value?.toFixed(1) || '0.0'}\r\n                            </span>\r\n                            <Badge variant={status.status === 'passing' ? 'default' : 'destructive'}>\r\n                              {status.status}\r\n                            </Badge>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </CardContent>\r\n                  </Card>\r\n\r\n                  <Card>\r\n                    <CardHeader>\r\n                      <CardTitle className=\"text-lg\">Recent Alerts</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                      {dashboardData.alerts?.length > 0 ? (\r\n                        dashboardData.alerts.slice(0, 5).map((alert, index) => (\r\n                          <div key={index} className=\"flex items-center gap-3 py-2\">\r\n                            <AlertTriangle className=\"h-4 w-4 text-orange-500\" />\r\n                            <div className=\"flex-1\">\r\n                              <p className=\"text-sm font-medium\">{alert.metric}</p>\r\n                              <p className=\"text-xs text-muted-foreground\">\r\n                                {new Date(alert.timestamp).toLocaleTimeString()}\r\n                              </p>\r\n                            </div>\r\n                            <Badge variant=\"outline\">{alert.severity}</Badge>\r\n                          </div>\r\n                        ))\r\n                      ) : (\r\n                        <p className=\"text-sm text-muted-foreground\">No recent alerts</p>\r\n                      )}\r\n                    </CardContent>\r\n                  </Card>\r\n                </div>\r\n              )}\r\n            </TabsContent>\r\n          </Tabs>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SystemHealthDashboard;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\TestFeedbackSystem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ThresholdAuditLog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[578,581],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[578,581],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1509,1512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1509,1512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":78,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":78,"endColumn":77,"suggestions":[{"messageId":"addBrackets","fix":{"range":[2681,2787],"text":"{ const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n          return entryDate >= weekAgo; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":81,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":81,"endColumn":79,"suggestions":[{"messageId":"addBrackets","fix":{"range":[2822,2931],"text":"{ const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n          return entryDate >= monthAgo; }"},"desc":"Add {} brackets around the case block."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { History, Search, Filter, Download } from 'lucide-react';\r\n\r\ninterface AuditLogEntry {\r\n  id: string;\r\n  action: string;\r\n  threshold_id: string;\r\n  user_id: string;\r\n  changes: Record<string, any>;\r\n  timestamp: string;\r\n  user_email?: string;\r\n}\r\n\r\ninterface ThresholdAuditLogProps {\r\n  auditLog: AuditLogEntry[];\r\n}\r\n\r\nconst ThresholdAuditLog: React.FC<ThresholdAuditLogProps> = ({ auditLog }) => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [actionFilter, setActionFilter] = useState('all');\r\n  const [dateFilter, setDateFilter] = useState('all');\r\n\r\n  const getActionColor = (action: string) => {\r\n    switch (action.toLowerCase()) {\r\n      case 'create':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'update':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'delete':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'enable':\r\n        return 'bg-purple-100 text-purple-800';\r\n      case 'disable':\r\n        return 'bg-gray-100 text-gray-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const formatChanges = (changes: Record<string, any>) => {\r\n    if (!changes || Object.keys(changes).length === 0) {\r\n      return 'No specific changes recorded';\r\n    }\r\n\r\n    return Object.entries(changes)\r\n      .map(([key, value]) => {\r\n        if (typeof value === 'object' && value.from !== undefined && value.to !== undefined) {\r\n          return `${key}: ${value.from} â†’ ${value.to}`;\r\n        }\r\n        return `${key}: ${JSON.stringify(value)}`;\r\n      })\r\n      .join(', ');\r\n  };\r\n\r\n  const filteredAuditLog = auditLog.filter(entry => {\r\n    const matchesSearch = searchTerm === '' || \r\n      entry.user_email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      entry.action.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      entry.threshold_id.includes(searchTerm);\r\n\r\n    const matchesAction = actionFilter === 'all' || \r\n      entry.action.toLowerCase() === actionFilter.toLowerCase();\r\n\r\n    const matchesDate = dateFilter === 'all' || (() => {\r\n      const entryDate = new Date(entry.timestamp);\r\n      const now = new Date();\r\n      \r\n      switch (dateFilter) {\r\n        case 'today':\r\n          return entryDate.toDateString() === now.toDateString();\r\n        case 'week':\r\n          const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n          return entryDate >= weekAgo;\r\n        case 'month':\r\n          const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n          return entryDate >= monthAgo;\r\n        default:\r\n          return true;\r\n      }\r\n    })();\r\n\r\n    return matchesSearch && matchesAction && matchesDate;\r\n  });\r\n\r\n  const exportAuditLog = () => {\r\n    const csvContent = [\r\n      ['Timestamp', 'Action', 'User', 'Threshold ID', 'Changes'].join(','),\r\n      ...filteredAuditLog.map(entry => [\r\n        entry.timestamp,\r\n        entry.action,\r\n        entry.user_email || 'Unknown',\r\n        entry.threshold_id,\r\n        formatChanges(entry.changes).replace(/,/g, ';')\r\n      ].join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `threshold-audit-log-${new Date().toISOString().split('T')[0]}.csv`;\r\n    a.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <h2 className=\"text-xl font-semibold\">Audit Log</h2>\r\n        <Button onClick={exportAuditLog} variant=\"outline\">\r\n          <Download className=\"h-4 w-4 mr-2\" />\r\n          Export Log\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card className=\"border-0 shadow-lg\">\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium\">Search</label>\r\n              <div className=\"relative\">\r\n                <Search className=\"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\r\n                <Input\r\n                  placeholder=\"Search users, actions...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium\">Action</label>\r\n              <Select value={actionFilter} onValueChange={setActionFilter}>\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Actions</SelectItem>\r\n                  <SelectItem value=\"create\">Create</SelectItem>\r\n                  <SelectItem value=\"update\">Update</SelectItem>\r\n                  <SelectItem value=\"delete\">Delete</SelectItem>\r\n                  <SelectItem value=\"enable\">Enable</SelectItem>\r\n                  <SelectItem value=\"disable\">Disable</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium\">Date Range</label>\r\n              <Select value={dateFilter} onValueChange={setDateFilter}>\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Time</SelectItem>\r\n                  <SelectItem value=\"today\">Today</SelectItem>\r\n                  <SelectItem value=\"week\">Last Week</SelectItem>\r\n                  <SelectItem value=\"month\">Last Month</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium\">Results</label>\r\n              <div className=\"px-3 py-2 bg-gray-50 rounded-md text-sm\">\r\n                {filteredAuditLog.length} entries\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Audit Log Entries */}\r\n      <div className=\"space-y-4\">\r\n        {filteredAuditLog.map((entry) => (\r\n          <Card key={entry.id} className=\"border-0 shadow-lg\">\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <History className=\"h-5 w-5 text-gray-400\" />\r\n                  <div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge className={getActionColor(entry.action)}>\r\n                        {entry.action}\r\n                      </Badge>\r\n                      <span className=\"text-sm text-gray-500\">\r\n                        by {entry.user_email || 'Unknown User'}\r\n                      </span>\r\n                    </div>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">\r\n                      {new Date(entry.timestamp).toLocaleString()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">\r\n                  ID: {entry.threshold_id.slice(0, 8)}...\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                <h4 className=\"font-medium text-sm mb-2\">Changes Made:</h4>\r\n                <p className=\"text-sm text-gray-700\">\r\n                  {formatChanges(entry.changes)}\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n\r\n        {filteredAuditLog.length === 0 && (\r\n          <Card className=\"border-0 shadow-lg\">\r\n            <CardContent className=\"p-12 text-center\">\r\n              <History className=\"h-12 w-12 mx-auto text-gray-300 mb-4\" />\r\n              <h3 className=\"font-medium text-gray-900 mb-2\">No audit entries found</h3>\r\n              <p className=\"text-gray-500\">\r\n                {searchTerm || actionFilter !== 'all' || dateFilter !== 'all'\r\n                  ? 'Try adjusting your filters to see more results.'\r\n                  : 'Audit log entries will appear here as threshold configurations are modified.'\r\n                }\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ThresholdAuditLog;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ThresholdConfigEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\ThresholdManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\UserRowCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\UserSegmentManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\UsersTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\admin\\XPBackfillAdmin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\AICoachEngagementCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\AICoachPerformanceCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\ChatModeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\FileUploadCard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":104,"column":6,"nodeType":"ArrayExpression","endLine":104,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, processingTimeouts, stopPolling, toast]","fix":{"range":[4288,4328],"text":"[cleanup, processingTimeouts, stopPolling, toast]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cleanup', 'handleFileUploadUpdate', and 'processingTimeouts'. Either include them or remove the dependency array.","line":141,"column":6,"nodeType":"ArrayExpression","endLine":141,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [user?.id, subscribe, unsubscribe, handleFileUploadUpdate, processingTimeouts, cleanup]","fix":{"range":[5495,5529],"text":"[user?.id, subscribe, unsubscribe, handleFileUploadUpdate, processingTimeouts, cleanup]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleFiles'. Either include it or remove the dependency array.","line":409,"column":6,"nodeType":"ArrayExpression","endLine":409,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [handleFiles]","fix":{"range":[14386,14388],"text":"[handleFiles]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useEffect, useRef } from 'react';\r\nimport { FileUploadPayload } from '@/types/common-interfaces';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useFileUploads, FileUpload } from '@/hooks/useFileUploads';\r\nimport { useFileUploadSubscription } from '@/hooks/useFileUploadSubscription';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { Upload, FileText, CheckCircle, AlertCircle, X, RefreshCw, Brain } from 'lucide-react';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport { logger } from '@/utils/logger';\r\n\r\nconst FileUploadCard: React.FC = () => {\r\n  const cleanup = useCleanup('FileUploadCard');\r\n  const { user } = useAuth();\r\n  const { uploads, createUpload, updateUpload, deleteUpload } = useFileUploads();\r\n  const { subscribe, unsubscribe, isConnected, startPolling, stopPolling } = useFileUploadSubscription();\r\n  const { toast } = useToast();\r\n  const [dragActive, setDragActive] = useState(false);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [processingProgress, setProcessingProgress] = useState<Record<string, number>>({});\r\n  const [processingTimeouts, setProcessingTimeouts] = useState<Record<string, string>>({});\r\n  const subscriptionIdRef = useRef<string>(`ai-coach-upload-${Date.now()}`);\r\n  const [subscriptionError, setSubscriptionError] = useState<string | null>(null);\r\n\r\n  // Enhanced file type support\r\n  const allowedTypes = [\r\n    'application/pdf',\r\n    'text/plain',\r\n    'application/msword',\r\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n    'application/vnd.ms-powerpoint',\r\n    'application/vnd.openxmlformats-officedocument.presentationml.presentation',\r\n    'text/markdown',\r\n    'text/csv',\r\n    'application/rtf'\r\n  ];\r\n\r\n  const maxFileSize = 100 * 1024 * 1024; // 100MB\r\n\r\n  // Define the handler function in the component scope with error handling\r\n  const handleFileUploadUpdate = useCallback((payload: FileUploadPayload) => {\r\n    try {\r\n      \r\n      if (payload.new.processing_status === 'completed') {\r\n        // Clear timeout and progress\r\n        if (processingTimeouts[payload.new.id]) {\r\n          cleanup.cleanup(processingTimeouts[payload.new.id]);\r\n        }\r\n        \r\n        setProcessingProgress(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id];\r\n          return newState;\r\n        });\r\n        \r\n        setProcessingTimeouts(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id];\r\n          return newState;\r\n        });\r\n\r\n        // Stop polling if it was running\r\n        stopPolling(payload.new.id);\r\n        \r\n        toast({\r\n          title: \"ðŸ§  AI Coach Ready!\",\r\n          description: `Generated ${payload.new.generated_flashcards_count} flashcards from ${payload.new.file_name}. Your AI coach can now provide guidance based on this content!`,\r\n        });\r\n      } else if (payload.new.processing_status === 'failed') {\r\n        // Clear timeout and progress\r\n        if (processingTimeouts[payload.new.id]) {\r\n          cleanup.cleanup(processingTimeouts[payload.new.id]);\r\n        }\r\n        \r\n        setProcessingProgress(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id];\r\n          return newState;\r\n        });\r\n        \r\n        setProcessingTimeouts(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id];\r\n          return newState;\r\n        });\r\n\r\n        // Stop polling if it was running\r\n        stopPolling(payload.new.id);\r\n        \r\n        toast({\r\n          title: \"âŒ Processing failed\",\r\n          description: payload.new.error_message || \"Failed to process your study material\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    } catch (error) {\r\n      logger.error('Error handling file upload update', 'FILE_UPLOAD', error);\r\n      setSubscriptionError('Error processing upload update');\r\n    }\r\n  }, [processingTimeouts, stopPolling, toast]);\r\n\r\n  // Set up centralized subscription with improved error handling\r\n  useEffect(() => {\r\n    if (!user?.id) return;\r\n\r\n    const subscriptionId = subscriptionIdRef.current;\r\n\r\n    try {\r\n      subscribe(subscriptionId, handleFileUploadUpdate);\r\n      setSubscriptionError(null);\r\n    } catch (error) {\r\n      logger.error('Error setting up subscription', 'FILE_UPLOAD', error);\r\n      setSubscriptionError('Failed to set up real-time updates');\r\n      // Continue without real-time updates instead of crashing\r\n      return;\r\n    }\r\n\r\n    return () => {\r\n      try {\r\n        unsubscribe(subscriptionId);\r\n      } catch (error) {\r\n        logger.error('Error cleaning up subscription', 'FILE_UPLOAD', error);\r\n      }\r\n      \r\n      // Clean up timeouts via cleanup manager\r\n      Object.keys(processingTimeouts).forEach(uploadId => {\r\n        const timeoutId = processingTimeouts[uploadId];\r\n        if (timeoutId) {\r\n          try {\r\n            cleanup.cleanup(timeoutId);\r\n          } catch (error) {\r\n            logger.warn('Error clearing timeout via cleanup manager', 'FILE_UPLOAD', { error, uploadId });\r\n          }\r\n        }\r\n      });\r\n    };\r\n  }, [user?.id, subscribe, unsubscribe]); // Added missing dependencies\r\n\r\n  const handleDrag = useCallback((e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\r\n      setDragActive(true);\r\n    } else if (e.type === \"dragleave\") {\r\n      setDragActive(false);\r\n    }\r\n  }, []);\r\n\r\n  const processFileForFlashcards = async (file: File, uploadId: string, filePath: string) => {\r\n    if (!user) return 0;\r\n\r\n    try {\r\n      \r\n      const { data, error } = await supabase.functions.invoke('process-file-flashcards', {\r\n        body: {\r\n          uploadId,\r\n          filePath,\r\n          fileName: file.name,\r\n          fileType: file.type,\r\n          userId: user.id\r\n        }\r\n      });\r\n\r\n      if (error) {\r\n        console.error('Edge function error:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data.flashcardsGenerated || 0;\r\n\r\n    } catch (error) {\r\n      console.error('Error processing file for AI coach:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const simulateProgress = (uploadId: string, duration: number = 4000) => { // Reduced from 6000ms\r\n    const steps = 30; // Reduced from 40\r\n    const interval = duration / steps;\r\n    let currentStep = 0;\r\n\r\n    const progressIntervalId = cleanup.setInterval(() => {\r\n      currentStep++;\r\n      const progress = Math.min((currentStep / steps) * 85, 85);\r\n      \r\n      setProcessingProgress(prev => ({\r\n        ...prev,\r\n        [uploadId]: progress\r\n      }));\r\n\r\n      if (currentStep >= steps) {\r\n        cleanup.cleanup(progressIntervalId);\r\n      }\r\n    }, interval);\r\n\r\n    // Auto-cleanup after duration + buffer\r\n    cleanup.setTimeout(() => {\r\n      cleanup.cleanup(progressIntervalId);\r\n    }, duration + 1000);\r\n\r\n    return progressIntervalId;\r\n  };\r\n\r\n  const getFileTypeLabel = (fileType: string) => {\r\n    const typeMap: Record<string, string> = {\r\n      'application/pdf': 'PDF',\r\n      'text/plain': 'TXT',\r\n      'application/msword': 'DOC',\r\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'DOCX',\r\n      'application/vnd.ms-powerpoint': 'PPT',\r\n      'application/vnd.openxmlformats-officedocument.presentationml.presentation': 'PPTX',\r\n      'text/markdown': 'MD',\r\n      'text/csv': 'CSV',\r\n      'application/rtf': 'RTF'\r\n    };\r\n    return typeMap[fileType] || 'FILE';\r\n  };\r\n\r\n  const formatFileSize = (bytes: number) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  };\r\n\r\n  const handleFiles = async (files: FileList) => {\r\n    if (!user || files.length === 0) return;\r\n\r\n    setUploading(true);\r\n    \r\n    for (const file of Array.from(files)) {\r\n      // Enhanced file validation\r\n      if (!allowedTypes.includes(file.type)) {\r\n        toast({\r\n          title: \"âŒ File type not supported\",\r\n          description: `${getFileTypeLabel(file.type)} files are not supported for AI coaching. Please upload PDF, DOC, PPT, TXT, MD, CSV, or RTF files.`,\r\n          variant: \"destructive\"\r\n        });\r\n        continue;\r\n      }\r\n\r\n      if (file.size > maxFileSize) {\r\n        toast({\r\n          title: \"âŒ File too large\",\r\n          description: `File size must be less than ${formatFileSize(maxFileSize)}. Your file is ${formatFileSize(file.size)}.`,\r\n          variant: \"destructive\"\r\n        });\r\n        continue;\r\n      }\r\n\r\n      try {\r\n        // Upload file to Supabase Storage\r\n        const fileName = `${Date.now()}-${file.name}`;\r\n        const filePath = `${user.id}/${fileName}`;\r\n\r\n        const { error: uploadError } = await supabase.storage\r\n          .from('study-files')\r\n          .upload(filePath, file);\r\n\r\n        if (uploadError) {\r\n          console.error('Upload error:', uploadError);\r\n          toast({\r\n            title: \"âŒ Upload failed\",\r\n            description: \"Failed to upload file to storage.\",\r\n            variant: \"destructive\"\r\n          });\r\n          continue;\r\n        }\r\n\r\n        // Record upload in database\r\n        createUpload({\r\n          file_name: file.name,\r\n          file_size: file.size,\r\n          file_type: file.type,\r\n          storage_path: filePath\r\n        });\r\n\r\n        toast({\r\n          title: \"âœ… File uploaded for AI coaching\",\r\n          description: `${file.name} uploaded successfully. AI is now analyzing your study material...`,\r\n        });\r\n\r\n        // Process with AI after upload\r\n        cleanup.setTimeout(async () => {\r\n          try {\r\n            const { data: uploadRecord } = await supabase\r\n              .from('file_uploads')\r\n              .select('*')\r\n              .eq('user_id', user.id)\r\n              .eq('storage_path', filePath)\r\n              .single();\r\n\r\n            if (!uploadRecord) {\r\n              throw new Error('Upload record not found');\r\n            }\r\n\r\n            // Start progress animation\r\n            simulateProgress(uploadRecord.id, 7000);\r\n\r\n            // Set timeout for AI processing - reduced max timeout\r\n            const baseTimeout = 120000; // 2 minutes base (reduced from 3)\r\n            const sizeMultiplier = Math.min(file.size / (10 * 1024 * 1024), 1.5); // Reduced multiplier\r\n            const timeoutDuration = Math.min(baseTimeout * (1 + sizeMultiplier), 300000); // Max 5 minutes (reduced from 8)\r\n\r\n            const timeoutId = cleanup.setTimeout(() => {\r\n              updateUpload({\r\n                id: uploadRecord.id,\r\n                processing_status: 'failed',\r\n                error_message: 'AI processing timeout - try breaking your content into smaller sections.'\r\n              });\r\n\r\n              setProcessingProgress(prev => {\r\n                const newState = { ...prev };\r\n                delete newState[uploadRecord.id];\r\n                return newState;\r\n              });\r\n\r\n              toast({\r\n                title: \"â±ï¸ AI processing timeout\",\r\n                description: \"Content processing took too long. Try uploading smaller sections.\",\r\n                variant: \"destructive\"\r\n              });\r\n            }, timeoutDuration);\r\n\r\n            setProcessingTimeouts(prev => ({\r\n              ...prev,\r\n              [uploadRecord.id]: timeoutId\r\n            }));\r\n\r\n            // Process file with AI\r\n            await processFileForFlashcards(file, uploadRecord.id, filePath);\r\n\r\n            // Start polling as fallback if real-time isn't connected\r\n            if (!isConnected || subscriptionError) {\r\n              startPolling(uploadRecord.id, (updatedUpload) => {\r\n                if (updatedUpload.processing_status === 'completed' || updatedUpload.processing_status === 'failed') {\r\n                  handleFileUploadUpdate({ new: updatedUpload, old: uploadRecord });\r\n                }\r\n              });\r\n            }\r\n\r\n          } catch (error) {\r\n            console.error('AI processing error:', error);\r\n            \r\n            const { data: uploadRecord } = await supabase\r\n              .from('file_uploads')\r\n              .select('*')\r\n              .eq('user_id', user.id)\r\n              .eq('storage_path', filePath)\r\n              .single();\r\n\r\n            if (uploadRecord) {\r\n              updateUpload({\r\n                id: uploadRecord.id,\r\n                processing_status: 'failed',\r\n                error_message: 'Failed to process with AI - please try again'\r\n              });\r\n\r\n              setProcessingProgress(prev => {\r\n                const newState = { ...prev };\r\n                delete newState[uploadRecord.id];\r\n                return newState;\r\n              });\r\n\r\n              if (processingTimeouts[uploadRecord.id]) {\r\n                cleanup.cleanup(processingTimeouts[uploadRecord.id]);\r\n                setProcessingTimeouts(prev => {\r\n                  const newState = { ...prev };\r\n                  delete newState[uploadRecord.id];\r\n                  return newState;\r\n                });\r\n              }\r\n            }\r\n\r\n            toast({\r\n              title: \"âŒ AI processing failed\",\r\n              description: \"Failed to process your study material. Please try again.\",\r\n              variant: \"destructive\"\r\n            });\r\n          }\r\n        }, 1000);\r\n\r\n      } catch (error) {\r\n        console.error('File upload error:', error);\r\n        toast({\r\n          title: \"âŒ Upload error\",\r\n          description: \"An unexpected error occurred during upload.\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    }\r\n    \r\n    setUploading(false);\r\n  };\r\n\r\n  const handleDrop = useCallback((e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n    \r\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\r\n      handleFiles(e.dataTransfer.files);\r\n    }\r\n  }, []);\r\n\r\n  const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      handleFiles(e.target.files);\r\n    }\r\n  };\r\n\r\n  const removeUpload = (id: string) => {\r\n    if (processingTimeouts[id]) {\r\n      cleanup.cleanup(processingTimeouts[id]);\r\n      setProcessingTimeouts(prev => {\r\n        const newState = { ...prev };\r\n        delete newState[id];\r\n        return newState;\r\n      });\r\n    }\r\n    \r\n    setProcessingProgress(prev => {\r\n      const newState = { ...prev };\r\n      delete newState[id];\r\n      return newState;\r\n    });\r\n    \r\n    deleteUpload(id);\r\n  };\r\n\r\n  const retryProcessing = async (upload: FileUpload) => {\r\n    try {\r\n      updateUpload({\r\n        id: upload.id,\r\n        processing_status: 'processing',\r\n        error_message: null\r\n      });\r\n\r\n      simulateProgress(upload.id, 7000);\r\n\r\n      const timeoutId = cleanup.setTimeout(() => {\r\n        updateUpload({\r\n          id: upload.id,\r\n          processing_status: 'failed',\r\n          error_message: 'AI processing timeout - please try a smaller file'\r\n        });\r\n\r\n        setProcessingProgress(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[upload.id];\r\n          return newState;\r\n        });\r\n      }, 300000); // 5 minutes for retry\r\n\r\n      setProcessingTimeouts(prev => ({\r\n        ...prev,\r\n        [upload.id]: timeoutId\r\n      }));\r\n\r\n      await processFileForFlashcards(\r\n        new File([], upload.file_name as string, { type: upload.file_type as string }),\r\n        upload.id,\r\n        upload.storage_path as string\r\n      );\r\n\r\n    } catch (error) {\r\n      console.error('Retry processing error:', error);\r\n      toast({\r\n        title: \"âŒ Retry failed\",\r\n        description: \"Failed to retry AI processing. Please try uploading again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2 text-lg\">\r\n          <Brain className=\"h-5 w-5 text-purple-600\" />\r\n          Upload Study Materials for AI Coaching\r\n          {!isConnected && (\r\n            <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded ml-2\">\r\n              {subscriptionError ? 'Error Mode' : 'Backup Mode'}\r\n            </span>\r\n          )}\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        {subscriptionError && (\r\n          <div className=\"p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n            <div className=\"flex items-center gap-2 text-yellow-700\">\r\n              <AlertCircle className=\"h-4 w-4\" />\r\n              <span className=\"text-sm\">\r\n                Real-time updates temporarily unavailable. Using polling fallback.\r\n              </span>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Upload Area */}\r\n        <div\r\n          className={`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${\r\n            dragActive \r\n              ? 'border-purple-400 bg-purple-50' \r\n              : 'border-muted-foreground/25 hover:border-purple-300'\r\n          }`}\r\n          onDragEnter={handleDrag}\r\n          onDragLeave={handleDrag}\r\n          onDragOver={handleDrag}\r\n          onDrop={handleDrop}\r\n        >\r\n          <Upload className=\"h-8 w-8 mx-auto mb-2 text-purple-600\" />\r\n          <h3 className=\"font-medium mb-2\">\r\n            Upload your homework, notes, or textbooks\r\n          </h3>\r\n          <p className=\"text-sm text-muted-foreground mb-3\">\r\n            AI will analyze your content and generate flashcards for personalized coaching\r\n          </p>\r\n          <div className=\"text-xs text-muted-foreground mb-4 space-y-1\">\r\n            <p><strong>ðŸ“ Supported:</strong> PDF, DOC, DOCX, PPT, PPTX, TXT, MD, CSV, RTF</p>\r\n            <p><strong>ðŸ“ Max size:</strong> {formatFileSize(maxFileSize)}</p>\r\n          </div>\r\n          <input\r\n            type=\"file\"\r\n            id=\"ai-coach-file-upload\"\r\n            className=\"hidden\"\r\n            multiple\r\n            accept=\".pdf,.txt,.doc,.docx,.ppt,.pptx,.md,.csv,.rtf\"\r\n            onChange={handleFileInput}\r\n            disabled={uploading}\r\n          />\r\n          <Button asChild disabled={uploading} size=\"sm\">\r\n            <label htmlFor=\"ai-coach-file-upload\" className=\"cursor-pointer\">\r\n              <FileText className=\"h-4 w-4 mr-2\" />\r\n              {uploading ? 'Processing...' : 'Choose Files'}\r\n            </label>\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Upload Progress */}\r\n        {uploads.length > 0 && (\r\n          <div className=\"space-y-3\">\r\n            <h4 className=\"font-medium text-sm\">AI Processing Status</h4>\r\n            {uploads.slice(0, 3).map((upload) => (\r\n              <div key={upload.id} className=\"p-3 bg-muted/50 rounded-lg\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <div className=\"flex items-center gap-2 min-w-0 flex-1\">\r\n                    <FileText className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\r\n                    <div className=\"min-w-0 flex-1\">\r\n                      <span className=\"font-medium text-sm truncate block\">\r\n                        {upload.file_name}\r\n                      </span>\r\n                      <div className=\"text-xs text-muted-foreground flex items-center gap-2\">\r\n                        <Badge variant=\"outline\" className=\"text-xs\">\r\n                          {getFileTypeLabel(upload.file_type)}\r\n                        </Badge>\r\n                        <span>{formatFileSize(upload.file_size)}</span>\r\n                      </div>\r\n                    </div>\r\n                    <Badge \r\n                      variant={\r\n                        upload.processing_status === 'completed' ? 'default' :\r\n                        upload.processing_status === 'failed' ? 'destructive' : 'secondary'\r\n                      }\r\n                      className=\"text-xs flex-shrink-0\"\r\n                    >\r\n                      {upload.processing_status}\r\n                    </Badge>\r\n                  </div>\r\n                  <div className=\"flex gap-1\">\r\n                    {upload.processing_status === 'failed' && (\r\n                      <Button\r\n                        size=\"sm\"\r\n                        variant=\"outline\"\r\n                        onClick={() => retryProcessing(upload)}\r\n                        className=\"h-8 w-8 p-0\"\r\n                      >\r\n                        <RefreshCw className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    )}\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"ghost\"\r\n                      onClick={() => removeUpload(upload.id)}\r\n                      className=\"h-8 w-8 p-0\"\r\n                    >\r\n                      <X className=\"h-4 w-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n                \r\n                {upload.processing_status === 'processing' && (\r\n                  <div className=\"space-y-2\">\r\n                    <Progress \r\n                      value={processingProgress[upload.id] || 0} \r\n                      className=\"h-2\" \r\n                    />\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {processingProgress[upload.id] >= 70 \r\n                        ? 'ðŸ§  AI is generating flashcards for coaching...' \r\n                        : 'ðŸ“– AI is analyzing your study content...'\r\n                      }\r\n                    </p>\r\n                  </div>\r\n                )}\r\n                \r\n                {upload.processing_status === 'completed' && (\r\n                  <div className=\"flex items-center gap-2 text-green-600\">\r\n                    <CheckCircle className=\"h-4 w-4\" />\r\n                    <span className=\"text-xs\">\r\n                      âœ… Ready for AI coaching! Generated {upload.generated_flashcards_count} flashcards\r\n                    </span>\r\n                  </div>\r\n                )}\r\n                \r\n                {upload.processing_status === 'failed' && (\r\n                  <div className=\"flex items-start gap-2 text-red-600\">\r\n                    <AlertCircle className=\"h-4 w-4 flex-shrink-0 mt-0.5\" />\r\n                    <span className=\"text-xs\">\r\n                      âŒ {upload.error_message || 'AI processing failed'}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n            {uploads.length > 3 && (\r\n              <p className=\"text-xs text-muted-foreground text-center\">\r\n                Showing latest 3 uploads. All processed content is available to your AI coach.\r\n              </p>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {uploads.filter(u => u.processing_status === 'completed').length > 0 && (\r\n          <div className=\"p-3 bg-purple-50 border border-purple-200 rounded-lg\">\r\n            <div className=\"flex items-center gap-2 text-purple-700\">\r\n              <Brain className=\"h-4 w-4\" />\r\n              <span className=\"text-sm font-medium\">\r\n                ðŸŽ¯ Your AI coach can now provide personalized guidance based on your uploaded study materials!\r\n              </span>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default FileUploadCard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\LearningStatsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\MinimalChatInterface.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\QuickChallengesCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\QuizSessionWidget.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'handleStartSession' and 'isInitializing'. Either include them or remove the dependency array.","line":44,"column":6,"nodeType":"ArrayExpression","endLine":44,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [autoStart, handleStartSession, isInitializing, sessionState.isActive]","fix":{"range":[1472,1506],"text":"[autoStart, handleStartSession, isInitializing, sessionState.isActive]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, XCircle, Target, RotateCcw, Trophy } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { useQuizSession, QuizCard } from '@/hooks/useQuizSession';\r\n\r\ninterface QuizSessionWidgetProps {\r\n  onComplete?: (results: Record<string, unknown>) => void;\r\n  onCancel?: () => void;\r\n  autoStart?: boolean;\r\n}\r\n\r\nconst QuizSessionWidget = ({ onComplete, onCancel, autoStart = false }: QuizSessionWidgetProps) => {\r\n  const {\r\n    sessionState,\r\n    startQuizSession,\r\n    submitAnswer,\r\n    nextCard,\r\n    endSession,\r\n    getCurrentCard,\r\n    isSessionComplete,\r\n    progress\r\n  } = useQuizSession();\r\n\r\n  const [selectedAnswer, setSelectedAnswer] = useState<'A' | 'B' | 'C' | 'D' | null>(null);\r\n  const [feedback, setFeedback] = useState<{\r\n    correct: boolean;\r\n    attempts: number;\r\n    explanation?: string;\r\n    correctAnswer?: string;\r\n  } | null>(null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isInitializing, setIsInitializing] = useState(false);\r\n\r\n  // Auto-start session if requested\r\n  useEffect(() => {\r\n    if (autoStart && !sessionState.isActive && !isInitializing) {\r\n      handleStartSession();\r\n    }\r\n  }, [autoStart, sessionState.isActive]);\r\n\r\n  const handleStartSession = async () => {\r\n    setIsInitializing(true);\r\n    try {\r\n      await startQuizSession(undefined, 5); // Start with 5 cards\r\n    } catch (error) {\r\n      console.error('Failed to start quiz session:', error);\r\n    } finally {\r\n      setIsInitializing(false);\r\n    }\r\n  };\r\n\r\n  const currentCard = getCurrentCard();\r\n\r\n  // Show loading state while initializing\r\n  if (isInitializing) {\r\n    return (\r\n      <Card className=\"border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50\">\r\n        <CardContent className=\"p-6 text-center\">\r\n          <div className=\"animate-spin w-6 h-6 border-2 border-purple-600 border-t-transparent rounded-full mx-auto mb-4\"></div>\r\n          <p className=\"text-muted-foreground\">Starting quiz session...</p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // Show start button if session is not active\r\n  if (!sessionState.isActive) {\r\n    return (\r\n      <Card className=\"border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50\">\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg flex items-center gap-2\">\r\n            <Target className=\"h-5 w-5 text-purple-600\" />\r\n            Quiz Session\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-muted-foreground\">\r\n            Ready to test your knowledge? Start a quiz session to practice with your flashcards!\r\n          </p>\r\n          <Button \r\n            onClick={handleStartSession}\r\n            className=\"w-full bg-purple-600 hover:bg-purple-700\"\r\n            disabled={isInitializing}\r\n          >\r\n            Start Quiz Session\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // Show error state if no current card\r\n  if (!currentCard) {\r\n    return (\r\n      <Card className=\"border-2 border-red-200 bg-gradient-to-br from-red-50 to-orange-50\">\r\n        <CardContent className=\"p-6 text-center\">\r\n          <p className=\"text-red-600 mb-4\">No quiz questions available.</p>\r\n          <Button \r\n            onClick={onCancel}\r\n            variant=\"outline\"\r\n          >\r\n            Close Quiz\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  const handleAnswerSelect = (option: 'A' | 'B' | 'C' | 'D') => {\r\n    if (feedback) return; // Already answered\r\n    setSelectedAnswer(option);\r\n  };\r\n\r\n  const handleSubmitAnswer = async () => {\r\n    if (!selectedAnswer || isSubmitting) return;\r\n\r\n    setIsSubmitting(true);\r\n    const result = await submitAnswer(selectedAnswer);\r\n    if (result) {\r\n      setFeedback(result);\r\n    }\r\n    setIsSubmitting(false);\r\n  };\r\n\r\n  const handleNextCard = () => {\r\n    setSelectedAnswer(null);\r\n    setFeedback(null);\r\n    nextCard();\r\n  };\r\n\r\n  const handleEndSession = async () => {\r\n    const results = await endSession();\r\n    onComplete?.(results);\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (feedback) return;\r\n    \r\n    const keyMap: Record<string, 'A' | 'B' | 'C' | 'D'> = {\r\n      '1': 'A', 'a': 'A', 'A': 'A',\r\n      '2': 'B', 'b': 'B', 'B': 'B',\r\n      '3': 'C', 'c': 'C', 'C': 'C',\r\n      '4': 'D', 'd': 'D', 'D': 'D'\r\n    };\r\n\r\n    if (keyMap[e.key]) {\r\n      handleAnswerSelect(keyMap[e.key]);\r\n    } else if (e.key === 'Enter' && selectedAnswer) {\r\n      handleSubmitAnswer();\r\n    }\r\n  };\r\n\r\n  // Check if this is the last card\r\n  const isLastCard = progress.current === progress.total;\r\n\r\n  return (\r\n    <Card className=\"border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50\">\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"text-lg flex items-center gap-2\">\r\n            <Target className=\"h-5 w-5 text-purple-600\" />\r\n            Quiz Session\r\n          </CardTitle>\r\n          <Button \r\n            variant=\"ghost\" \r\n            size=\"sm\" \r\n            onClick={onCancel}\r\n            className=\"text-muted-foreground hover:text-foreground\"\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </div>\r\n        \r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex items-center justify-between text-sm\">\r\n            <span className=\"text-muted-foreground\">\r\n              Card {progress.current} of {progress.total}\r\n            </span>\r\n            <Badge variant=\"secondary\" className=\"bg-purple-100 text-purple-700\">\r\n              Difficulty: {currentCard.difficulty}/5\r\n            </Badge>\r\n          </div>\r\n          <Progress value={progress.percentage} className=\"h-2\" />\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent \r\n        className=\"space-y-4\"\r\n        onKeyDown={handleKeyPress}\r\n        tabIndex={0}\r\n      >\r\n        {/* Question */}\r\n        <div className=\"p-4 bg-white rounded-lg border border-purple-100\">\r\n          <h3 className=\"text-lg font-medium text-foreground mb-2\">\r\n            {currentCard.question}\r\n          </h3>\r\n        </div>\r\n\r\n        {/* Multiple Choice Options */}\r\n        <div className=\"grid gap-2\">\r\n          {currentCard.options.map((option, index) => {\r\n            const optionLetter = ['A', 'B', 'C', 'D'][index] as 'A' | 'B' | 'C' | 'D';\r\n            const isSelected = selectedAnswer === optionLetter;\r\n            const isCorrect = feedback && currentCard.correctOption === optionLetter;\r\n            const isIncorrect = feedback && isSelected && !isCorrect;\r\n\r\n            return (\r\n              <Button\r\n                key={optionLetter}\r\n                variant={isSelected ? \"default\" : \"outline\"}\r\n                className={cn(\r\n                  \"justify-start text-left h-auto p-3 transition-all\",\r\n                  isSelected && !feedback && \"bg-purple-100 border-purple-300\",\r\n                  isCorrect && \"bg-green-100 border-green-300 text-green-800\",\r\n                  isIncorrect && \"bg-red-100 border-red-300 text-red-800\",\r\n                  !feedback && \"hover:bg-purple-50\"\r\n                )}\r\n                onClick={() => handleAnswerSelect(optionLetter)}\r\n                disabled={!!feedback}\r\n              >\r\n                <div className=\"flex items-center gap-3 w-full\">\r\n                  <div className={cn(\r\n                    \"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-sm font-medium\",\r\n                    isSelected && !feedback && \"bg-purple-600 text-white\",\r\n                    isCorrect && \"bg-green-600 text-white\",\r\n                    isIncorrect && \"bg-red-600 text-white\",\r\n                    !isSelected && !feedback && \"bg-muted text-muted-foreground\"\r\n                  )}>\r\n                    {isCorrect ? <CheckCircle className=\"h-3 w-3\" /> : \r\n                     isIncorrect ? <XCircle className=\"h-3 w-3\" /> : \r\n                     optionLetter}\r\n                  </div>\r\n                  <span className=\"flex-1\">{option}</span>\r\n                </div>\r\n              </Button>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Feedback */}\r\n        {feedback && (\r\n          <div className={cn(\r\n            \"p-4 rounded-lg border\",\r\n            feedback.correct \r\n              ? \"bg-green-50 border-green-200 text-green-800\"\r\n              : \"bg-orange-50 border-orange-200 text-orange-800\"\r\n          )}>\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              {feedback.correct ? (\r\n                <>\r\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                  <span className=\"font-medium\">\r\n                    {feedback.attempts === 1 ? \"Perfect! First try! ðŸŽ‰\" : \"Correct! Well done! âœ¨\"}\r\n                  </span>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <XCircle className=\"h-4 w-4 text-orange-600\" />\r\n                  <span className=\"font-medium\">\r\n                    {feedback.attempts < 2 ? \"Not quite - try again! ðŸ¤”\" : \"Let's see the answer ðŸ“š\"}\r\n                  </span>\r\n                </>\r\n              )}\r\n            </div>\r\n            \r\n            {feedback.explanation && (\r\n              <p className=\"text-sm mt-2\">\r\n                {feedback.explanation}\r\n              </p>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex gap-2 pt-2\">\r\n          {!feedback ? (\r\n            <Button\r\n              onClick={handleSubmitAnswer}\r\n              disabled={!selectedAnswer || isSubmitting}\r\n              className=\"flex-1 bg-purple-600 hover:bg-purple-700\"\r\n            >\r\n              {isSubmitting ? \"Checking...\" : \"Submit Answer\"}\r\n            </Button>\r\n          ) : (\r\n            <>\r\n              {!feedback.correct && feedback.attempts < 2 ? (\r\n                <Button\r\n                  onClick={() => {\r\n                    setSelectedAnswer(null);\r\n                    setFeedback(null);\r\n                  }}\r\n                  variant=\"outline\"\r\n                  className=\"flex-1\"\r\n                >\r\n                  <RotateCcw className=\"h-4 w-4 mr-1\" />\r\n                  Try Again\r\n                </Button>\r\n              ) : isLastCard ? (\r\n                <Button\r\n                  onClick={handleEndSession}\r\n                  className=\"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700\"\r\n                >\r\n                  <Trophy className=\"h-4 w-4 mr-1\" />\r\n                  Complete Session\r\n                </Button>\r\n              ) : (\r\n                <Button\r\n                  onClick={handleNextCard}\r\n                  className=\"flex-1 bg-purple-600 hover:bg-purple-700\"\r\n                >\r\n                  Next Card â†’\r\n                </Button>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Keyboard shortcuts hint */}\r\n        {!feedback && (\r\n          <p className=\"text-xs text-muted-foreground text-center\">\r\n            ðŸ’¡ Use keys 1-4 or A-D to select, Enter to submit\r\n          </p>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default QuizSessionWidget;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\RecentSavesMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\SaveBeforeClearDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\SavePreviewFlashcardsButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\SaveToNotesButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\SaveToNotesDialog.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'generateSuggestedTags', 'generateTitle', and 'saveFullResponse'. Either include them or remove the dependency array.","line":63,"column":6,"nodeType":"ArrayExpression","endLine":63,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, content, selectedText, originalQuestion, saveFullResponse, generateTitle, generateSuggestedTags]","fix":{"range":[1971,2020],"text":"[isOpen, content, selectedText, originalQuestion, saveFullResponse, generateTitle, generateSuggestedTags]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'generateTitle'. Either include it or remove the dependency array.","line":72,"column":6,"nodeType":"ArrayExpression","endLine":72,"endColumn":73,"suggestions":[{"desc":"Update the dependencies array to be: [saveFullResponse, content, selectedText, originalQuestion, isOpen, generateTitle]","fix":{"range":[2298,2365],"text":"[saveFullResponse, content, selectedText, originalQuestion, isOpen, generateTitle]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { X, Sparkles, AlertCircle, Loader2, CheckCircle } from 'lucide-react';\r\nimport { useSaveToNotes } from '@/hooks/useSaveToNotes';\r\n\r\ninterface SaveToNotesDialogProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  content: string;\r\n  selectedText?: string;\r\n  originalQuestion?: string;\r\n  aiMode?: string;\r\n}\r\n\r\nconst SaveToNotesDialog: React.FC<SaveToNotesDialogProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  content,\r\n  selectedText,\r\n  originalQuestion,\r\n  aiMode\r\n}) => {\r\n  const { \r\n    saveToNotes, \r\n    isSaving, \r\n    isGeneratingFlashcards, \r\n    flashcardGenerationError,\r\n    retryFlashcardGeneration,\r\n    generateSuggestedTags, \r\n    generateTitle \r\n  } = useSaveToNotes();\r\n  \r\n  const [title, setTitle] = useState('');\r\n  const [noteContent, setNoteContent] = useState('');\r\n  const [tags, setTags] = useState<string[]>([]);\r\n  const [tagInput, setTagInput] = useState('');\r\n  const [generateFlashcards, setGenerateFlashcards] = useState(false);\r\n  const [saveFullResponse, setSaveFullResponse] = useState(true);\r\n\r\n  // Initialize form data when dialog opens\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      const textToSave = selectedText && !saveFullResponse ? selectedText : content;\r\n      setNoteContent(textToSave);\r\n      setTitle(generateTitle(textToSave, originalQuestion));\r\n      setTags(generateSuggestedTags(textToSave, originalQuestion));\r\n      setSaveFullResponse(!selectedText);\r\n    }\r\n  }, [isOpen, content, selectedText, originalQuestion]);\r\n\r\n  // Update content when toggle changes\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      const textToSave = saveFullResponse ? content : (selectedText || content);\r\n      setNoteContent(textToSave);\r\n      setTitle(generateTitle(textToSave, originalQuestion));\r\n    }\r\n  }, [saveFullResponse, content, selectedText, originalQuestion, isOpen]);\r\n\r\n  const handleAddTag = (tagToAdd: string) => {\r\n    const trimmedTag = tagToAdd.trim();\r\n    if (trimmedTag && !tags.includes(trimmedTag)) {\r\n      setTags([...tags, trimmedTag]);\r\n    }\r\n  };\r\n\r\n  const handleRemoveTag = (tagToRemove: string) => {\r\n    setTags(tags.filter(tag => tag !== tagToRemove));\r\n  };\r\n\r\n  const handleTagInputKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' || e.key === ',') {\r\n      e.preventDefault();\r\n      if (tagInput.trim()) {\r\n        handleAddTag(tagInput);\r\n        setTagInput('');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    const saveData = {\r\n      title,\r\n      content: noteContent,\r\n      tags,\r\n      originalQuestion,\r\n      aiMode,\r\n      generateFlashcards\r\n    };\r\n\r\n    await saveToNotes(saveData);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    onClose();\r\n    // Reset form\r\n    setTitle('');\r\n    setNoteContent('');\r\n    setTags([]);\r\n    setTagInput('');\r\n    setGenerateFlashcards(false);\r\n    setSaveFullResponse(true);\r\n  };\r\n\r\n  const handleRetry = () => {\r\n    const saveData = {\r\n      title,\r\n      content: noteContent,\r\n      tags,\r\n      originalQuestion,\r\n      aiMode,\r\n      generateFlashcards: true\r\n    };\r\n    retryFlashcardGeneration(saveData);\r\n  };\r\n\r\n  // Handler functions to properly convert CheckedState to boolean\r\n  const handleSaveFullResponseChange = (checked: boolean | \"indeterminate\") => {\r\n    setSaveFullResponse(checked === true);\r\n  };\r\n\r\n  const handleGenerateFlashcardsChange = (checked: boolean | \"indeterminate\") => {\r\n    setGenerateFlashcards(checked === true);\r\n  };\r\n\r\n  const isProcessing = isSaving || isGeneratingFlashcards;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={handleClose}>\r\n      <DialogContent className=\"sm:max-w-[500px] max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Sparkles className=\"h-5 w-5 text-purple-600\" />\r\n            Save to Notes\r\n            {isProcessing && <Loader2 className=\"h-4 w-4 animate-spin\" />}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* Processing Status */}\r\n          {isGeneratingFlashcards && (\r\n            <Alert>\r\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n              <AlertDescription>\r\n                Generating flashcards from your AI response... This may take a moment.\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n\r\n          {/* Error Display */}\r\n          {flashcardGenerationError && (\r\n            <Alert variant=\"destructive\">\r\n              <AlertCircle className=\"h-4 w-4\" />\r\n              <AlertDescription className=\"flex items-center justify-between\">\r\n                <span>Flashcard generation failed: {flashcardGenerationError}</span>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={handleRetry}\r\n                  disabled={isProcessing}\r\n                >\r\n                  Retry\r\n                </Button>\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n\r\n          {/* Toggle for full response vs selection */}\r\n          {selectedText && (\r\n            <div className=\"flex items-center space-x-2 p-3 bg-purple-50 rounded-lg\">\r\n              <Checkbox\r\n                id=\"save-full\"\r\n                checked={saveFullResponse}\r\n                onCheckedChange={handleSaveFullResponseChange}\r\n                disabled={isProcessing}\r\n              />\r\n              <Label htmlFor=\"save-full\" className=\"text-sm\">\r\n                Save full response (uncheck to save only selected text)\r\n              </Label>\r\n            </div>\r\n          )}\r\n\r\n          {/* Title */}\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"note-title\">Title</Label>\r\n            <Input\r\n              id=\"note-title\"\r\n              value={title}\r\n              onChange={(e) => setTitle(e.target.value)}\r\n              placeholder=\"Enter note title...\"\r\n              className=\"w-full\"\r\n              disabled={isProcessing}\r\n            />\r\n          </div>\r\n\r\n          {/* Content Preview */}\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"note-content\">Content</Label>\r\n            <Textarea\r\n              id=\"note-content\"\r\n              value={noteContent}\r\n              onChange={(e) => setNoteContent(e.target.value)}\r\n              placeholder=\"Note content...\"\r\n              className=\"min-h-[120px] max-h-[200px]\"\r\n              disabled={isProcessing}\r\n            />\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {noteContent.length} characters\r\n              {selectedText && !saveFullResponse && (\r\n                <span className=\"text-purple-600 ml-2\">â€¢ Selected text only</span>\r\n              )}\r\n            </p>\r\n          </div>\r\n\r\n          {/* Tags */}\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"tags\">Tags</Label>\r\n            <div className=\"flex flex-wrap gap-1 mb-2\">\r\n              {tags.map((tag) => (\r\n                <Badge\r\n                  key={tag}\r\n                  variant=\"secondary\"\r\n                  className=\"flex items-center gap-1\"\r\n                >\r\n                  {tag}\r\n                  <button\r\n                    onClick={() => handleRemoveTag(tag)}\r\n                    className=\"ml-1 hover:bg-red-100 rounded-full p-0.5\"\r\n                    aria-label={`Remove ${tag} tag`}\r\n                    disabled={isProcessing}\r\n                  >\r\n                    <X className=\"h-3 w-3\" />\r\n                  </button>\r\n                </Badge>\r\n              ))}\r\n            </div>\r\n            <Input\r\n              id=\"tags\"\r\n              value={tagInput}\r\n              onChange={(e) => setTagInput(e.target.value)}\r\n              onKeyDown={handleTagInputKeyPress}\r\n              placeholder=\"Add tags (press Enter or comma to add)...\"\r\n              className=\"w-full\"\r\n              disabled={isProcessing}\r\n            />\r\n          </div>\r\n\r\n          {/* Generate Flashcards Option */}\r\n          <div className=\"flex items-center space-x-2 p-3 bg-blue-50 rounded-lg\">\r\n            <Checkbox\r\n              id=\"generate-flashcards\"\r\n              checked={generateFlashcards}\r\n              onCheckedChange={handleGenerateFlashcardsChange}\r\n              disabled={isProcessing}\r\n            />\r\n            <Label htmlFor=\"generate-flashcards\" className=\"text-sm\">\r\n              Generate flashcards from this note\r\n              {generateFlashcards && (\r\n                <span className=\"block text-xs text-muted-foreground mt-1\">\r\n                  AI will create study flashcards from the key concepts in your note\r\n                </span>\r\n              )}\r\n            </Label>\r\n          </div>\r\n\r\n          {/* Metadata Preview */}\r\n          {(originalQuestion || aiMode) && (\r\n            <div className=\"p-3 bg-gray-50 rounded-lg text-xs text-muted-foreground\">\r\n              <p className=\"font-medium mb-1\">Will be saved with:</p>\r\n              {originalQuestion && (\r\n                <p>â€¢ Original question: \"{originalQuestion.substring(0, 50)}...\"</p>\r\n              )}\r\n              {aiMode && <p>â€¢ AI mode: {aiMode}</p>}\r\n              <p>â€¢ Source: AI Learning Coach</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <DialogFooter className=\"flex gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={handleClose}\r\n            disabled={isProcessing}\r\n          >\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            onClick={handleSave}\r\n            disabled={isProcessing || !title.trim() || !noteContent.trim()}\r\n            className=\"bg-purple-600 hover:bg-purple-700\"\r\n          >\r\n            {isProcessing ? (\r\n              <>\r\n                <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n                {isSaving ? 'Saving...' : 'Generating...'}\r\n              </>\r\n            ) : (\r\n              'Save to Notes'\r\n            )}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default SaveToNotesDialog;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\SavedCoachChats.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\StudyPlanCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\VoiceSettingsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\challenges\\AccuracyChallenge.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'generateMultipleChoiceOptions'. Either include it or remove the dependency array.","line":61,"column":6,"nodeType":"ArrayExpression","endLine":61,"endColumn":35,"suggestions":[{"desc":"Update the dependencies array to be: [challengeCards, currentCard, generateMultipleChoiceOptions]","fix":{"range":[2760,2789],"text":"[challengeCards, currentCard, generateMultipleChoiceOptions]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Flashcard } from '@/hooks/useFlashcards';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\nimport { Target, Check, X } from 'lucide-react';\r\nimport { useFlashcards } from '@/hooks/useFlashcards';\r\nimport { useChallengeAnalytics } from '@/hooks/useChallengeAnalytics';\r\n\r\ninterface AccuracyChallengeProps {\r\n  flashcards?: Flashcard[];\r\n  customCards?: Flashcard[];\r\n}\r\n\r\nconst AccuracyChallenge: React.FC<AccuracyChallengeProps> = ({ customCards }) => {\r\n  const { flashcards, isLoading, updateFlashcard } = useFlashcards();\r\n  const { trackChallengeStart, trackChallengeComplete } = useChallengeAnalytics();\r\n  const [currentCard, setCurrentCard] = useState(0);\r\n  const [selectedAnswer, setSelectedAnswer] = useState<string | null>(null);\r\n  const [showResult, setShowResult] = useState(false);\r\n  const [score, setScore] = useState({ correct: 0, total: 0 });\r\n  const [completed, setCompleted] = useState(false);\r\n  const [challengeCards, setChallengeCards] = useState<Flashcard[]>([]);\r\n  const [multipleChoiceOptions, setMultipleChoiceOptions] = useState<string[]>([]);\r\n  const [startTime, setStartTime] = useState<number | null>(null);\r\n  const [hasTrackedStart, setHasTrackedStart] = useState(false);\r\n\r\n  const targetAccuracy = 80;\r\n\r\n  useEffect(() => {\r\n    if (customCards && customCards.length > 0) {\r\n      // Use custom cards when provided (limit to 5 for accuracy challenge)\r\n      setChallengeCards(customCards.slice(0, 5));\r\n    } else if (flashcards && flashcards.length > 0) {\r\n      // Filter cards with low accuracy (< 80%) or no review history\r\n      const lowAccuracyCards = flashcards.filter(card => {\r\n        const successRate = card.times_reviewed > 0 \r\n          ? (card.times_correct / card.times_reviewed) * 100 \r\n          : 0;\r\n        return successRate < targetAccuracy || card.times_reviewed === 0;\r\n      });\r\n\r\n      // If we don't have enough low accuracy cards, add some random ones\r\n      let selectedCards = [...lowAccuracyCards];\r\n      if (selectedCards.length < 5) {\r\n        const remainingCards = flashcards.filter(card => !selectedCards.includes(card));\r\n        const shuffled = remainingCards.sort(() => 0.5 - Math.random());\r\n        selectedCards = [...selectedCards, ...shuffled].slice(0, 5);\r\n      } else {\r\n        selectedCards = selectedCards.slice(0, 5);\r\n      }\r\n\r\n      setChallengeCards(selectedCards);\r\n    }\r\n  }, [flashcards, customCards]);\r\n\r\n  useEffect(() => {\r\n    if (challengeCards.length > 0 && currentCard < challengeCards.length) {\r\n      generateMultipleChoiceOptions();\r\n    }\r\n  }, [challengeCards, currentCard]);\r\n\r\n  // Track challenge start when cards are ready and first shown\r\n  useEffect(() => {\r\n    if (challengeCards.length > 0 && !completed && !hasTrackedStart) {\r\n      // const mode = customCards && customCards.length > 0 ? 'custom' : 'random';\r\n      // trackChallengeStart('accuracy_challenge', mode, challengeCards.length);\r\n      setStartTime(Date.now());\r\n      setHasTrackedStart(true);\r\n    }\r\n  }, [challengeCards, completed, hasTrackedStart, customCards]);\r\n\r\n  const generateMultipleChoiceOptions = () => {\r\n    if (!challengeCards[currentCard] || !flashcards) return;\r\n\r\n    const correctAnswer = challengeCards[currentCard].back_content;\r\n    const otherAnswers = flashcards\r\n      .filter(card => card.id !== challengeCards[currentCard].id)\r\n      .map(card => card.back_content)\r\n      .sort(() => 0.5 - Math.random())\r\n      .slice(0, 3);\r\n\r\n    const allOptions = [correctAnswer, ...otherAnswers].sort(() => 0.5 - Math.random());\r\n    setMultipleChoiceOptions(allOptions);\r\n  };\r\n\r\n  const handleAnswerSelect = async (answer: string) => {\r\n    setSelectedAnswer(answer);\r\n    setShowResult(true);\r\n\r\n    const currentCardData = challengeCards[currentCard];\r\n    const isCorrect = answer === currentCardData.back_content;\r\n\r\n    // Update score\r\n    setScore(prev => ({\r\n      correct: prev.correct + (isCorrect ? 1 : 0),\r\n      total: prev.total + 1\r\n    }));\r\n\r\n    // Update card stats\r\n    await updateFlashcard({\r\n      id: currentCardData.id,\r\n      times_reviewed: currentCardData.times_reviewed + 1,\r\n      times_correct: currentCardData.times_correct + (isCorrect ? 1 : 0),\r\n      last_reviewed_at: new Date().toISOString()\r\n    });\r\n  };\r\n\r\n  const handleNext = async () => {\r\n    if (currentCard < challengeCards.length - 1) {\r\n      setCurrentCard(currentCard + 1);\r\n      setSelectedAnswer(null);\r\n      setShowResult(false);\r\n    } else {\r\n      setCompleted(true);\r\n      \r\n      // Track completion with final score - temporarily disabled\r\n      // const mode = customCards && customCards.length > 0 ? 'custom' : 'random';\r\n      // const timeTaken = startTime ? Math.floor((Date.now() - startTime) / 1000) : 120;\r\n      // const finalCorrect = score.correct + (selectedAnswer === challengeCards[currentCard].back_content ? 1 : 0);\r\n      \r\n      // await trackChallengeComplete(\r\n      //   'accuracy_challenge',\r\n      //   mode,\r\n      //   challengeCards.length,\r\n      //   finalCorrect,\r\n      //   timeTaken,\r\n      //   startTime\r\n      // );\r\n    }\r\n  };\r\n\r\n  const handleRestart = () => {\r\n    setCurrentCard(0);\r\n    setSelectedAnswer(null);\r\n    setShowResult(false);\r\n    setScore({ correct: 0, total: 0 });\r\n    setCompleted(false);\r\n    setHasTrackedStart(false);\r\n    setStartTime(null);\r\n    \r\n    // Regenerate challenge cards based on mode\r\n    if (customCards && customCards.length > 0) {\r\n      setChallengeCards(customCards.slice(0, 5));\r\n    } else if (flashcards && flashcards.length > 0) {\r\n      const lowAccuracyCards = flashcards.filter(card => {\r\n        const successRate = card.times_reviewed > 0 \r\n          ? (card.times_correct / card.times_reviewed) * 100 \r\n          : 0;\r\n        return successRate < targetAccuracy || card.times_reviewed === 0;\r\n      });\r\n\r\n      let selectedCards = [...lowAccuracyCards];\r\n      if (selectedCards.length < 5) {\r\n        const remainingCards = flashcards.filter(card => !selectedCards.includes(card));\r\n        const shuffled = remainingCards.sort(() => 0.5 - Math.random());\r\n        selectedCards = [...selectedCards, ...shuffled].slice(0, 5);\r\n      } else {\r\n        selectedCards = selectedCards.slice(0, 5);\r\n      }\r\n\r\n      setChallengeCards(selectedCards);\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card className=\"h-full\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Target className=\"h-5 w-5\" />\r\n            Accuracy Challenge\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <Skeleton className=\"h-20 w-full\" />\r\n          <Skeleton className=\"h-10 w-full\" />\r\n          <Skeleton className=\"h-10 w-full\" />\r\n          <Skeleton className=\"h-10 w-full\" />\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (!flashcards || flashcards.length === 0) {\r\n    return (\r\n      <Card className=\"h-full\">\r\n        <CardContent className=\"p-6 text-center\">\r\n          <Target className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n          <h3 className=\"text-lg font-semibold mb-2\">No Flashcards Found</h3>\r\n          <p className=\"text-muted-foreground\">Create some flashcards first to start the accuracy challenge!</p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (challengeCards.length === 0) {\r\n    return (\r\n      <Card className=\"h-full\">\r\n        <CardContent className=\"p-6 text-center\">\r\n          <Target className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n          <p className=\"text-muted-foreground\">Loading challenge cards...</p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (completed) {\r\n    const accuracy = Math.round((score.correct / score.total) * 100);\r\n    const isSuccess = accuracy >= targetAccuracy;\r\n\r\n    return (\r\n      <Card className={`h-full ${isSuccess ? 'bg-green-50 border-green-200' : 'bg-orange-50 border-orange-200'}`}>\r\n        <CardContent className=\"p-6 text-center\">\r\n          {isSuccess ? (\r\n            <Check className=\"h-12 w-12 mx-auto text-green-600 mb-4\" />\r\n          ) : (\r\n            <Target className=\"h-12 w-12 mx-auto text-orange-600 mb-4\" />\r\n          )}\r\n          <h3 className={`text-lg font-semibold mb-2 ${isSuccess ? 'text-green-800' : 'text-orange-800'}`}>\r\n            {isSuccess ? 'Challenge Complete!' : 'Keep Practicing!'}\r\n          </h3>\r\n          <p className={`mb-4 ${isSuccess ? 'text-green-700' : 'text-orange-700'}`}>\r\n            Accuracy: {accuracy}% ({score.correct}/{score.total})\r\n          </p>\r\n          <p className=\"text-sm text-muted-foreground mb-4\">\r\n            Target: {targetAccuracy}%+\r\n          </p>\r\n          <Button onClick={handleRestart} variant=\"outline\">\r\n            Try Again\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  const card = challengeCards[currentCard];\r\n  const currentAccuracy = score.total > 0 ? Math.round((score.correct / score.total) * 100) : 0;\r\n\r\n  return (\r\n    <Card className=\"h-full\">\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center justify-between\">\r\n          <span className=\"flex items-center gap-2\">\r\n            <Target className=\"h-5 w-5\" />\r\n            Accuracy Challenge\r\n            {customCards && customCards.length > 0 && (\r\n              <span className=\"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded\">Custom Set</span>\r\n            )}\r\n          </span>\r\n          <span className=\"text-sm font-normal text-muted-foreground\">\r\n            {currentCard + 1} of {challengeCards.length}\r\n          </span>\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        <div className=\"bg-blue-50 p-3 rounded-lg border border-blue-200\">\r\n          <div className=\"flex justify-between text-sm\">\r\n            <span>Current Accuracy: {currentAccuracy}%</span>\r\n            <span>Target: {targetAccuracy}%+</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-muted p-4 rounded-lg\">\r\n          <h4 className=\"font-medium mb-2\">Question</h4>\r\n          <p>{card.front_content}</p>\r\n        </div>\r\n\r\n        {!showResult && (\r\n          <div className=\"space-y-2\">\r\n            <h4 className=\"font-medium mb-2\">Choose the correct answer:</h4>\r\n            {multipleChoiceOptions.map((option, index) => (\r\n              <Button\r\n                key={index}\r\n                variant=\"outline\"\r\n                className=\"w-full text-left h-auto p-3 justify-start\"\r\n                onClick={() => handleAnswerSelect(option)}\r\n                disabled={selectedAnswer !== null}\r\n              >\r\n                {option}\r\n              </Button>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {showResult && (\r\n          <div className={`p-4 rounded-lg border ${\r\n            selectedAnswer === card.back_content \r\n              ? 'bg-green-50 border-green-200' \r\n              : 'bg-red-50 border-red-200'\r\n          }`}>\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              {selectedAnswer === card.back_content ? (\r\n                <Check className=\"h-5 w-5 text-green-600\" />\r\n              ) : (\r\n                <X className=\"h-5 w-5 text-red-600\" />\r\n              )}\r\n              <h4 className={`font-medium ${\r\n                selectedAnswer === card.back_content ? 'text-green-800' : 'text-red-800'\r\n              }`}>\r\n                {selectedAnswer === card.back_content ? 'Correct!' : 'Incorrect'}\r\n              </h4>\r\n            </div>\r\n            <p className={`mb-4 ${\r\n              selectedAnswer === card.back_content ? 'text-green-700' : 'text-red-700'\r\n            }`}>\r\n              Correct answer: {card.back_content}\r\n            </p>\r\n            <Button onClick={handleNext} className=\"w-full\">\r\n              {currentCard < challengeCards.length - 1 ? 'Next Question' : 'Complete Challenge'}\r\n            </Button>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default AccuracyChallenge;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\challenges\\CustomPractice.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\challenges\\QuickReview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai-coach\\challenges\\SpeedTest.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ai\\AIFeatureExample.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\algebra\\lessons\\AlgebraLesson1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\algebra\\lessons\\AlgebraLesson2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\algebra\\lessons\\AlgebraLesson3.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\algebra\\lessons\\AlgebraLesson4.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\algebra\\lessons\\AlgebraLesson5.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\algebra\\lessons\\AlgebraLesson6.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\algebra\\lessons\\AlgebraLesson7.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AICoachAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AICoachEngagementCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AdminAICoachAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AdminGoalsAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AdminReadingAnalytics.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1177,1180],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1177,1180],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { BookOpen, Clock, Users, TrendingUp } from 'lucide-react';\r\n\r\ninterface BookStats {\r\n  bookId: string;\r\n  sessions: number;\r\n  totalTime: number;\r\n  users: Set<string>;\r\n  uniqueUsers?: number;\r\n}\r\n\r\nconst AdminReadingAnalytics = () => {\r\n  const { data: readingStats, isLoading } = useQuery({\r\n    queryKey: ['admin-reading-analytics'],\r\n    queryFn: async () => {\r\n      const { data: sessions, error } = await supabase\r\n        .from('reading_sessions')\r\n        .select('*');\r\n\r\n      if (error) throw error;\r\n\r\n      const totalSessions = sessions?.length || 0;\r\n      const totalTimeMinutes = sessions?.reduce((sum, s) => sum + (s.duration_seconds || 0), 0) / 60 || 0;\r\n      const uniqueUsers = new Set(sessions?.map(s => s.user_id) || []).size;\r\n      const averageSessionTime = totalSessions > 0 ? totalTimeMinutes / totalSessions : 0;\r\n\r\n      // Group by book for top books\r\n      const bookStats = sessions?.reduce((acc: Record<string, any>, session) => {\r\n        const bookId = session.book_id || 'unknown';\r\n        if (!acc[bookId]) {\r\n          acc[bookId] = { bookId, sessions: 0, totalTime: 0, users: new Set() };\r\n        }\r\n        acc[bookId].sessions++;\r\n        acc[bookId].totalTime += (session.duration_seconds || 0) / 60;\r\n        acc[bookId].users.add(session.user_id);\r\n        return acc;\r\n      }, {}) || {};\r\n\r\n      const topBooks = Object.values(bookStats)\r\n        .sort((a: BookStats, b: BookStats) => b.sessions - a.sessions)\r\n        .slice(0, 5)\r\n        .map((book: BookStats) => ({\r\n          ...book,\r\n          uniqueUsers: book.users.size\r\n        }));\r\n\r\n      return {\r\n        totalSessions,\r\n        totalTimeHours: Math.round(totalTimeMinutes / 60),\r\n        uniqueUsers,\r\n        averageSessionMinutes: Math.round(averageSessionTime),\r\n        topBooks\r\n      };\r\n    }\r\n  });\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          {[...Array(4)].map((_, i) => (\r\n            <Card key={i}>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"animate-pulse space-y-3\">\r\n                  <div className=\"h-4 bg-muted rounded w-3/4\"></div>\r\n                  <div className=\"h-8 bg-muted rounded w-1/2\"></div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <h2 className=\"text-2xl font-bold\">Platform Reading Analytics</h2>\r\n\r\n      {/* Overview Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <BookOpen className=\"h-8 w-8 text-blue-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Sessions</p>\r\n                <p className=\"text-2xl font-bold\">{readingStats?.totalSessions || 0}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Clock className=\"h-8 w-8 text-green-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Hours</p>\r\n                <p className=\"text-2xl font-bold\">{readingStats?.totalTimeHours || 0}h</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Users className=\"h-8 w-8 text-purple-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Active Readers</p>\r\n                <p className=\"text-2xl font-bold\">{readingStats?.uniqueUsers || 0}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <TrendingUp className=\"h-8 w-8 text-orange-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Avg Session</p>\r\n                <p className=\"text-2xl font-bold\">{readingStats?.averageSessionMinutes || 0}m</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Top Books */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Most Popular Books</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {readingStats?.topBooks?.map((book: BookStats, index: number) => (\r\n              <div key={book.bookId} className=\"flex items-center justify-between p-4 border rounded-lg\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <div className=\"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-sm font-bold\">\r\n                    {index + 1}\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-semibold\">{book.bookId}</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      {book.sessions} sessions â€¢ {book.uniqueUsers} readers\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <p className=\"font-semibold\">{Math.round(book.totalTime)}m</p>\r\n                  <p className=\"text-sm text-muted-foreground\">total time</p>\r\n                </div>\r\n              </div>\r\n            )) || (\r\n              <p className=\"text-center text-muted-foreground py-8\">\r\n                No reading data available yet\r\n              </p>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminReadingAnalytics;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AnalyticsCard.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"React.useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":45,"column":3,"nodeType":"MemberExpression","endLine":45,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { LucideIcon } from 'lucide-react';\r\nimport { featureFlagService } from '@/services/FeatureFlagService';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\nexport interface AnalyticsCardProps {\r\n  id: string;\r\n  title: string;\r\n  description?: string;\r\n  icon?: LucideIcon;\r\n  iconColor?: string;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  loading?: boolean;\r\n  error?: string | null;\r\n  featureFlag?: string;\r\n  refreshInterval?: number;\r\n  onRefresh?: () => void;\r\n}\r\n\r\nexport const AnalyticsCard: React.FC<AnalyticsCardProps> = ({\r\n  id,\r\n  title,\r\n  description,\r\n  icon: Icon,\r\n  iconColor = 'text-blue-600',\r\n  children,\r\n  className = '',\r\n  loading = false,\r\n  error = null,\r\n  featureFlag,\r\n  refreshInterval,\r\n  onRefresh\r\n}) => {\r\n  const cleanup = useCleanup('analytics-card');\r\n\r\n  // Check feature flag\r\n  if (featureFlag && !featureFlagService.isEnabled(featureFlag)) {\r\n    return null;\r\n  }\r\n\r\n  // Auto-refresh logic with cleanupManager\r\n  React.useEffect(() => {\r\n    if (refreshInterval && onRefresh) {\r\n      cleanup.setInterval(onRefresh, refreshInterval * 1000);\r\n    }\r\n  }, [refreshInterval, onRefresh, cleanup]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <Card className={`border-0 shadow-lg ${className}`} data-analytics-card={id}>\r\n        <CardHeader className=\"p-4 sm:p-6\">\r\n          <CardTitle className=\"flex items-center gap-2 text-lg\">\r\n            {Icon && <Icon className={`h-5 w-5 ${iconColor} flex-shrink-0`} />}\r\n            {title}\r\n            <div className=\"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full ml-auto\"></div>\r\n          </CardTitle>\r\n          {description && (\r\n            <p className=\"text-sm text-gray-500\">{description}</p>\r\n          )}\r\n        </CardHeader>\r\n        <CardContent className=\"p-4 sm:p-6 pt-0\">\r\n          <div className=\"animate-pulse space-y-4\">\r\n            <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\r\n            <div className=\"h-32 bg-gray-200 rounded\"></div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Card className={`border-0 shadow-lg border-red-200 ${className}`} data-analytics-card={id}>\r\n        <CardHeader className=\"p-4 sm:p-6\">\r\n          <CardTitle className=\"flex items-center gap-2 text-lg text-red-600\">\r\n            {Icon && <Icon className=\"h-5 w-5 flex-shrink-0\" />}\r\n            {title}\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"p-4 sm:p-6 pt-0\">\r\n          <div className=\"text-center py-6\">\r\n            <p className=\"text-red-600 font-medium\">Error loading data</p>\r\n            <p className=\"text-sm text-gray-500 mt-1\">{error}</p>\r\n            {onRefresh && (\r\n              <button\r\n                onClick={onRefresh}\r\n                className=\"mt-3 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors\"\r\n              >\r\n                Retry\r\n              </button>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card className={`border-0 shadow-lg ${className}`} data-analytics-card={id}>\r\n      <CardHeader className=\"p-4 sm:p-6\">\r\n        <CardTitle className=\"flex items-center gap-2 text-lg\">\r\n          {Icon && <Icon className={`h-5 w-5 ${iconColor} flex-shrink-0`} />}\r\n          {title}\r\n          {onRefresh && (\r\n            <button\r\n              onClick={onRefresh}\r\n              className=\"ml-auto p-1 hover:bg-gray-100 rounded transition-colors\"\r\n              title=\"Refresh data\"\r\n            >\r\n              <svg className=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n              </svg>\r\n            </button>\r\n          )}\r\n        </CardTitle>\r\n        {description && (\r\n          <p className=\"text-sm text-gray-500\">{description}</p>\r\n        )}\r\n      </CardHeader>\r\n      <CardContent className=\"p-4 sm:p-6 pt-0\">\r\n        {children}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AnalyticsCardContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AnalyticsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\AnomalyDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\ContentCreationAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\CoursePerformanceAnalytics.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAnalyticsData'. Either include it or remove the dependency array.","line":47,"column":6,"nodeType":"ArrayExpression","endLine":47,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [loadAnalyticsData, selectedTimeRange]","fix":{"range":[1460,1479],"text":"[loadAnalyticsData, selectedTimeRange]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2440,2443],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2440,2443],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4895,4898],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4895,4898],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { \r\n  BookOpen, \r\n  Clock, \r\n  TrendingUp, \r\n  Users, \r\n  Award, \r\n  BarChart3,\r\n  Brain,\r\n  Activity\r\n} from 'lucide-react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { analyticsDataSync } from '@/utils/analyticsDataSync';\r\nimport { EnrollmentData, LessonData } from '@/types/analytics-data';\r\n\r\ninterface CourseAnalytics {\r\n  courseId: string;\r\n  courseTitle: string;\r\n  totalEnrollments: number;\r\n  averageCompletion: number;\r\n  averageTimeSpent: number;\r\n  totalLessons: number;\r\n  averageEngagement: number;\r\n  completionRate: number;\r\n}\r\n\r\ninterface LearningTrend {\r\n  date: string;\r\n  completions: number;\r\n  enrollments: number;\r\n  averageTime: number;\r\n}\r\n\r\nexport const CoursePerformanceAnalytics: React.FC = () => {\r\n  const [courseAnalytics, setCourseAnalytics] = useState<CourseAnalytics[]>([]);\r\n  const [learningTrends, setLearningTrends] = useState<LearningTrend[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [selectedTimeRange, setSelectedTimeRange] = useState<'7d' | '30d' | '90d'>('30d');\r\n\r\n  // Load analytics data for all users (admin view)\r\n  useEffect(() => {\r\n    loadAnalyticsData();\r\n  }, [selectedTimeRange]);\r\n\r\n  const loadAnalyticsData = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      console.log('ðŸ”„ Loading admin course analytics data');\r\n      \r\n      // Load all enrollments from both tables (admin view)\r\n      const { data: newEnrollmentData, error: newEnrollmentError } = await supabase\r\n        .from('interactive_course_enrollments')\r\n        .select('*');\r\n\r\n      const { data: oldEnrollmentData, error: oldEnrollmentError } = await supabase\r\n        .from('enrollments')\r\n        .select('course_id, enrolled_at, user_id, progress');\r\n\r\n      if (newEnrollmentError) {\r\n        console.error('Error loading new enrollments:', newEnrollmentError);\r\n      }\r\n      if (oldEnrollmentError) {\r\n        console.error('Error loading old enrollments:', oldEnrollmentError);\r\n      }\r\n\r\n      // Convert old enrollments to new format\r\n      const convertedEnrollments = (oldEnrollmentData || []).map(old => {\r\n        const progress = old.progress as any;\r\n        const completionPercentage = progress?.completion_percentage || 0;\r\n        \r\n        return {\r\n          id: `old-${old.course_id}-${old.user_id}`,\r\n          user_id: old.user_id,\r\n          course_id: old.course_id,\r\n          course_title: getCourseTitle(old.course_id),\r\n          enrolled_at: old.enrolled_at,\r\n          last_accessed_at: new Date().toISOString(),\r\n          completion_percentage: completionPercentage,\r\n          completed_at: completionPercentage >= 100 ? new Date().toISOString() : null,\r\n          total_time_spent_minutes: 0\r\n        };\r\n      });\r\n\r\n      // Combine all enrollment data\r\n      const allEnrollments = [...(newEnrollmentData || []), ...convertedEnrollments];\r\n      console.log('ðŸ“ˆ Total admin enrollments:', allEnrollments.length);\r\n\r\n      // Load all lesson analytics\r\n      const { data: lessonData, error: lessonError } = await supabase\r\n        .from('interactive_lesson_analytics')\r\n        .select('*');\r\n\r\n      if (lessonError) {\r\n        console.error('Error loading lesson data:', lessonError);\r\n      }\r\n\r\n      // Process course analytics with all data\r\n      const courseStats = processCourseAnalytics(allEnrollments, lessonData || []);\r\n      setCourseAnalytics(courseStats);\r\n\r\n      // Load learning trends for all users\r\n      const trends = await loadLearningTrends(selectedTimeRange);\r\n      setLearningTrends(trends);\r\n      \r\n    } catch (error) {\r\n      console.error('Error loading admin analytics data:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getCourseTitle = (courseId: string): string => {\r\n    const titles: Record<string, string> = {\r\n      'introduction-modern-economics': 'Introduction to Modern Economics',\r\n      'interactive-linear-equations': 'Linear Equations Mastery', \r\n      'interactive-algebra': 'Algebra Fundamentals',\r\n      'interactive-trigonometry': 'Trigonometry Fundamentals',\r\n      'logic-critical-thinking': 'Logic & Critical Thinking',\r\n      'interactive-science': 'Interactive Science',\r\n      'neurodiversity-strengths-based-approach': 'Neurodiversity Strengths-Based Approach',\r\n      'el-spelling-reading': 'EL Spelling & Reading'\r\n    };\r\n    return titles[courseId] || courseId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n  };\r\n\r\n  const processCourseAnalytics = (enrollments: EnrollmentData[], lessons: LessonData[]): CourseAnalytics[] => {\r\n    const courseMap = new Map<string, any>();\r\n\r\n    // Process enrollments\r\n    enrollments.forEach(enrollment => {\r\n      if (!courseMap.has(enrollment.course_id)) {\r\n        courseMap.set(enrollment.course_id, {\r\n          courseId: enrollment.course_id,\r\n          courseTitle: enrollment.course_title || getCourseTitle(enrollment.course_id),\r\n          totalEnrollments: 0,\r\n          completions: 0,\r\n          totalTime: 0,\r\n          totalLessons: 0,\r\n          engagementScores: [],\r\n          hasActivity: false\r\n        });\r\n      }\r\n      \r\n      const course = courseMap.get(enrollment.course_id);\r\n      course.totalEnrollments++;\r\n      course.totalTime += enrollment.total_time_spent_minutes || 0;\r\n      \r\n      if (enrollment.completed_at || enrollment.completion_percentage >= 100) {\r\n        course.completions++;\r\n      }\r\n      \r\n      if (enrollment.total_time_spent_minutes > 0 || enrollment.completion_percentage > 0) {\r\n        course.hasActivity = true;\r\n      }\r\n    });\r\n\r\n    // Process lesson analytics\r\n    lessons.forEach(lesson => {\r\n      const course = courseMap.get(lesson.course_id);\r\n      if (course) {\r\n        course.engagementScores.push(lesson.engagement_score || 0);\r\n        course.hasActivity = true;\r\n        \r\n        const lessonSet = course.lessonSet || new Set();\r\n        lessonSet.add(lesson.lesson_id);\r\n        course.lessonSet = lessonSet;\r\n        course.totalLessons = lessonSet.size;\r\n        \r\n        if (lesson.time_spent_seconds > 0) {\r\n          course.totalTime += Math.round(lesson.time_spent_seconds / 60);\r\n        }\r\n      }\r\n    });\r\n\r\n    // Estimate metrics for courses without detailed analytics\r\n    courseMap.forEach(course => {\r\n      if (!course.hasActivity && course.totalEnrollments > 0) {\r\n        course.totalLessons = 5;\r\n        course.engagementScores = [25];\r\n      }\r\n    });\r\n\r\n    return Array.from(courseMap.values()).map(course => ({\r\n      courseId: course.courseId,\r\n      courseTitle: course.courseTitle,\r\n      totalEnrollments: course.totalEnrollments,\r\n      averageCompletion: course.totalEnrollments > 0 ? \r\n        Math.round((course.completions / course.totalEnrollments) * 100) : 0,\r\n      averageTimeSpent: course.totalEnrollments > 0 ? \r\n        Math.round(course.totalTime / course.totalEnrollments) : 0,\r\n      totalLessons: course.totalLessons,\r\n      averageEngagement: course.engagementScores.length > 0 ?\r\n        Math.round(course.engagementScores.reduce((a: number, b: number) => a + b, 0) / course.engagementScores.length) : 0,\r\n      completionRate: course.totalEnrollments > 0 ? \r\n        Math.round((course.completions / course.totalEnrollments) * 100) : 0\r\n    }));\r\n  };\r\n\r\n  const loadLearningTrends = async (timeRange: string): Promise<LearningTrend[]> => {\r\n    const days = timeRange === '7d' ? 7 : timeRange === '30d' ? 30 : 90;\r\n    const startDate = new Date();\r\n    startDate.setDate(startDate.getDate() - days);\r\n\r\n    const { data: trendData } = await supabase\r\n      .from('interactive_course_enrollments')\r\n      .select('enrolled_at, completed_at, total_time_spent_minutes')\r\n      .gte('enrolled_at', startDate.toISOString());\r\n\r\n    const trendMap = new Map<string, { enrollments: number; completions: number; totalTime: number }>();\r\n    \r\n    (trendData || []).forEach(item => {\r\n      const date = item.enrolled_at.split('T')[0];\r\n      if (!trendMap.has(date)) {\r\n        trendMap.set(date, { enrollments: 0, completions: 0, totalTime: 0 });\r\n      }\r\n      \r\n      const trend = trendMap.get(date)!;\r\n      trend.enrollments++;\r\n      trend.totalTime += item.total_time_spent_minutes || 0;\r\n      \r\n      if (item.completed_at) {\r\n        trend.completions++;\r\n      }\r\n    });\r\n\r\n    return Array.from(trendMap.entries()).map(([date, data]) => ({\r\n      date,\r\n      completions: data.completions,\r\n      enrollments: data.enrollments,\r\n      averageTime: data.enrollments > 0 ? Math.round(data.totalTime / data.enrollments) : 0\r\n    })).sort((a, b) => a.date.localeCompare(b.date));\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          {[...Array(4)].map((_, i) => (\r\n            <Card key={i}>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"animate-pulse space-y-3\">\r\n                  <div className=\"h-4 bg-muted rounded w-3/4\"></div>\r\n                  <div className=\"h-8 bg-muted rounded w-1/2\"></div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const totalEnrollments = courseAnalytics.reduce((sum, course) => sum + course.totalEnrollments, 0);\r\n  const totalCompletions = courseAnalytics.reduce((sum, course) => \r\n    sum + Math.round((course.averageCompletion / 100) * course.totalEnrollments), 0);\r\n  const averageEngagement = courseAnalytics.length > 0 ? \r\n    Math.round(courseAnalytics.reduce((sum, course) => sum + course.averageEngagement, 0) / courseAnalytics.length) : 0;\r\n  const totalTimeSpent = courseAnalytics.reduce((sum, course) => \r\n    sum + (course.averageTimeSpent * course.totalEnrollments), 0);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Time Range Selector */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <h2 className=\"text-2xl font-bold\">Course Performance Analytics</h2>\r\n        <div className=\"flex space-x-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={async () => {\r\n              setIsLoading(true);\r\n              try {\r\n                await loadAnalyticsData();\r\n              } catch (error) {\r\n                console.error('Sync failed:', error);\r\n              } finally {\r\n                setIsLoading(false);\r\n              }\r\n            }}\r\n            disabled={isLoading}\r\n          >\r\n            ðŸ”„ Sync Data\r\n          </Button>\r\n          {(['7d', '30d', '90d'] as const).map(range => (\r\n            <Button\r\n              key={range}\r\n              variant={selectedTimeRange === range ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setSelectedTimeRange(range)}\r\n            >\r\n              {range === '7d' ? '7 Days' : range === '30d' ? '30 Days' : '90 Days'}\r\n            </Button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overview Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Users className=\"h-8 w-8 text-blue-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Enrollments</p>\r\n                <p className=\"text-2xl font-bold\">{totalEnrollments.toLocaleString()}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Award className=\"h-8 w-8 text-green-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Completions</p>\r\n                <p className=\"text-2xl font-bold\">{totalCompletions.toLocaleString()}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Brain className=\"h-8 w-8 text-purple-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Avg Engagement</p>\r\n                <p className=\"text-2xl font-bold\">{averageEngagement}%</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Clock className=\"h-8 w-8 text-orange-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Time</p>\r\n                <p className=\"text-2xl font-bold\">{Math.round(totalTimeSpent / 60)}h</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Course Performance Details */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <BarChart3 className=\"h-5 w-5 mr-2\" />\r\n            Course Performance Details\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {courseAnalytics.map((course) => (\r\n              <div key={course.courseId} className=\"border rounded-lg p-4\">\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <h3 className=\"font-semibold\">{course.courseTitle}</h3>\r\n                  <Badge variant=\"outline\">\r\n                    {course.totalEnrollments} enrolled\r\n                  </Badge>\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-3\">\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Completion Rate</p>\r\n                    <p className=\"text-lg font-semibold\">{course.completionRate}%</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Avg Time</p>\r\n                    <p className=\"text-lg font-semibold\">{course.averageTimeSpent}m</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Engagement</p>\r\n                    <p className=\"text-lg font-semibold\">{course.averageEngagement}%</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Lessons</p>\r\n                    <p className=\"text-lg font-semibold\">{course.totalLessons}</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span>Completion Progress</span>\r\n                    <span>{course.completionRate}%</span>\r\n                  </div>\r\n                  <Progress value={course.completionRate} className=\"h-2\" />\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Platform Learning Trends */}\r\n      {learningTrends.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Activity className=\"h-5 w-5 mr-2\" />\r\n              Platform Learning Trends\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-7 gap-2\">\r\n              {learningTrends.slice(-7).map((trend, index) => (\r\n                <div key={trend.date} className=\"text-center p-3 bg-muted/50 rounded-lg\">\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    {new Date(trend.date).toLocaleDateString('en-US', { weekday: 'short' })}\r\n                  </p>\r\n                  <p className=\"text-lg font-semibold text-green-600\">{trend.completions}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">completions</p>\r\n                  <p className=\"text-sm text-blue-600\">{trend.enrollments}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">enrolled</p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CoursePerformanceAnalytics;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\CoursesModulesAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\DeclarativeChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":155,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5190,5193],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5190,5193],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useMemo } from 'react';\r\nimport { ResponsiveContainer, BarChart, LineChart, AreaChart, PieChart, ScatterChart, Bar, Line, Area, Pie, Cell, Scatter, XAxis, YAxis, CartesianGrid, Tooltip, Legend } from 'recharts';\r\nimport { ChartContainer, ChartTooltip, ChartTooltipContent } from '@/components/ui/chart';\r\nimport { ChartDefinition } from '@/config/chartDefinitions';\r\nimport { ChartDataPoint } from '@/types/analytics-data';\r\n\r\ninterface DeclarativeChartProps {\r\n  definition: ChartDefinition;\r\n  data: ChartDataPoint[];\r\n  filters?: Record<string, unknown>;\r\n  className?: string;\r\n}\r\n\r\nexport const DeclarativeChart: React.FC<DeclarativeChartProps> = ({\r\n  definition,\r\n  data,\r\n  filters = {},\r\n  className = 'h-[300px]'\r\n}) => {\r\n  const chartConfig = useMemo(() => {\r\n    return definition.config.series.reduce((acc, series) => {\r\n      acc[series.dataKey] = {\r\n        label: series.name,\r\n        color: series.color\r\n      };\r\n      return acc;\r\n    }, {} as Record<string, { label: string; color: string }>);\r\n  }, [definition.config.series]);\r\n\r\n  const filteredData = useMemo(() => {\r\n    if (!filters || Object.keys(filters).length === 0) return data;\r\n    \r\n    return data.filter(item => {\r\n      return Object.entries(filters).every(([key, value]) => {\r\n        if (!value) return true;\r\n        return item[key] === value || item[key]?.toString().includes(value.toString());\r\n      });\r\n    });\r\n  }, [data, filters]);\r\n\r\n  const renderChart = () => {\r\n    const commonProps = {\r\n      data: filteredData,\r\n      margin: { top: 10, right: 10, left: 10, bottom: 10 }\r\n    };\r\n\r\n    switch (definition.type) {\r\n      case 'bar':\r\n        return (\r\n          <BarChart {...commonProps}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            {definition.config.xAxis && (\r\n              <XAxis \r\n                dataKey={definition.config.xAxis.dataKey}\r\n                fontSize={10}\r\n              />\r\n            )}\r\n            {definition.config.yAxis && (\r\n              <YAxis \r\n                fontSize={10}\r\n                domain={definition.config.yAxis.domain}\r\n              />\r\n            )}\r\n            <ChartTooltip content={<ChartTooltipContent />} />\r\n            {definition.config.legend?.show && <Legend />}\r\n            {definition.config.series.map((series, index) => (\r\n              <Bar\r\n                key={series.dataKey}\r\n                dataKey={series.dataKey}\r\n                fill={series.color}\r\n                name={series.name}\r\n                radius={[2, 2, 0, 0]}\r\n              />\r\n            ))}\r\n          </BarChart>\r\n        );\r\n\r\n      case 'line':\r\n        return (\r\n          <LineChart {...commonProps}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            {definition.config.xAxis && (\r\n              <XAxis \r\n                dataKey={definition.config.xAxis.dataKey}\r\n                fontSize={10}\r\n              />\r\n            )}\r\n            {definition.config.yAxis && (\r\n              <YAxis \r\n                fontSize={10}\r\n                domain={definition.config.yAxis.domain}\r\n              />\r\n            )}\r\n            <ChartTooltip content={<ChartTooltipContent />} />\r\n            {definition.config.legend?.show && <Legend />}\r\n            {definition.config.series.map((series, index) => (\r\n              <Line\r\n                key={series.dataKey}\r\n                type={series.type || 'monotone'}\r\n                dataKey={series.dataKey}\r\n                stroke={series.color}\r\n                name={series.name}\r\n                strokeWidth={2}\r\n                dot={{ r: 3 }}\r\n              />\r\n            ))}\r\n          </LineChart>\r\n        );\r\n\r\n      case 'area':\r\n        return (\r\n          <AreaChart {...commonProps}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            {definition.config.xAxis && (\r\n              <XAxis \r\n                dataKey={definition.config.xAxis.dataKey}\r\n                fontSize={10}\r\n              />\r\n            )}\r\n            {definition.config.yAxis && (\r\n              <YAxis \r\n                fontSize={10}\r\n                domain={definition.config.yAxis.domain}\r\n              />\r\n            )}\r\n            <ChartTooltip content={<ChartTooltipContent />} />\r\n            {definition.config.legend?.show && <Legend />}\r\n            {definition.config.series.map((series, index) => (\r\n              <Area\r\n                key={series.dataKey}\r\n                type={series.type || 'monotone'}\r\n                dataKey={series.dataKey}\r\n                stroke={series.color}\r\n                fill={series.color}\r\n                fillOpacity={0.6}\r\n                name={series.name}\r\n              />\r\n            ))}\r\n          </AreaChart>\r\n        );\r\n\r\n      case 'pie':\r\n        return (\r\n          <PieChart {...commonProps}>\r\n            <Pie\r\n              data={filteredData}\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              outerRadius={80}\r\n              dataKey={definition.config.series[0]?.dataKey || 'value'}\r\n              nameKey=\"name\"\r\n            >\r\n              {filteredData.map((entry, index) => (\r\n                <Cell key={`cell-${index}`} fill={(entry as any).color || definition.config.series[0]?.color} />\r\n              ))}\r\n            </Pie>\r\n            <ChartTooltip content={<ChartTooltipContent />} />\r\n            {definition.config.legend?.show && <Legend />}\r\n          </PieChart>\r\n        );\r\n\r\n      default:\r\n        return (\r\n          <div className=\"flex items-center justify-center h-full text-gray-500\">\r\n            <p>Unsupported chart type: {definition.type}</p>\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ChartContainer config={chartConfig} className={className}>\r\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n        {renderChart()}\r\n      </ResponsiveContainer>\r\n    </ChartContainer>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\EngagementAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\EnhancedAnalyticsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\GoalsGamificationAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\InteractiveCourseAnalyticsDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAnalyticsData'. Either include it or remove the dependency array.","line":63,"column":6,"nodeType":"ArrayExpression","endLine":63,"endColumn":31,"suggestions":[{"desc":"Update the dependencies array to be: [user, selectedTimeRange, loadAnalyticsData]","fix":{"range":[1872,1897],"text":"[user, selectedTimeRange, loadAnalyticsData]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":115,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3884,3887],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3884,3887],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":191,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7150,7153],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7150,7153],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { \r\n  BookOpen, \r\n  Clock, \r\n  TrendingUp, \r\n  Users, \r\n  Award, \r\n  BarChart3,\r\n  Calendar,\r\n  Target,\r\n  Activity,\r\n  Brain\r\n} from 'lucide-react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { analyticsDataSync } from '@/utils/analyticsDataSync';\r\nimport { EnrollmentData, LessonData } from '@/types/analytics-data';\r\n\r\ninterface CourseAnalytics {\r\n  courseId: string;\r\n  courseTitle: string;\r\n  totalEnrollments: number;\r\n  averageCompletion: number;\r\n  averageTimeSpent: number;\r\n  totalLessons: number;\r\n  averageEngagement: number;\r\n  completionRate: number;\r\n}\r\n\r\ninterface LearningTrend {\r\n  date: string;\r\n  completions: number;\r\n  enrollments: number;\r\n  averageTime: number;\r\n}\r\n\r\ninterface UserProgress {\r\n  userId: string;\r\n  courseId: string;\r\n  courseTitle: string;\r\n  completionPercentage: number;\r\n  totalTimeSpent: number;\r\n  averageEngagement: number;\r\n  lastAccessed: string;\r\n  status: 'active' | 'completed' | 'inactive';\r\n}\r\n\r\nexport const InteractiveCourseAnalyticsDashboard: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [courseAnalytics, setCourseAnalytics] = useState<CourseAnalytics[]>([]);\r\n  const [learningTrends, setLearningTrends] = useState<LearningTrend[]>([]);\r\n  const [userProgress, setUserProgress] = useState<UserProgress[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [selectedTimeRange, setSelectedTimeRange] = useState<'7d' | '30d' | '90d'>('30d');\r\n\r\n  // Load analytics data\r\n  useEffect(() => {\r\n    loadAnalyticsData();\r\n  }, [user, selectedTimeRange]);\r\n\r\n  const loadAnalyticsData = async () => {\r\n    if (!user) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      console.log('ðŸ”„ Loading analytics data for user:', user.id);\r\n      \r\n      // Run analytics data sync to fix missing data\r\n      await analyticsDataSync.runCompleteSync(user.id);\r\n      \r\n      // Load course-level analytics for current user from new system\r\n      const { data: enrollmentData, error: enrollmentError } = await supabase\r\n        .from('interactive_course_enrollments')\r\n        .select('*')\r\n        .eq('user_id', user.id);\r\n\r\n      if (enrollmentError) {\r\n        console.error('Error loading enrollments:', enrollmentError);\r\n      } else {\r\n        console.log('ðŸ“Š Found new enrollments:', enrollmentData?.length || 0);\r\n      }\r\n\r\n      // Also load reading sessions and study sessions for comprehensive analytics\r\n      const { data: readingSessions } = await supabase\r\n        .from('reading_sessions')\r\n        .select('*')\r\n        .eq('user_id', user.id);\r\n\r\n      const { data: studySessions } = await supabase\r\n        .from('study_sessions')\r\n        .select('*')\r\n        .eq('user_id', user.id);\r\n\r\n      console.log('ðŸ“š Found reading sessions:', readingSessions?.length || 0);\r\n      console.log('ðŸ§  Found study sessions:', studySessions?.length || 0);\r\n\r\n      // Load from old enrollments table as fallback (ALL enrollments)\r\n      const { data: oldEnrollmentData, error: oldEnrollmentError } = await supabase\r\n        .from('enrollments')\r\n        .select('course_id, enrolled_at, progress')\r\n        .eq('user_id', user.id);\r\n\r\n      if (oldEnrollmentError) {\r\n        console.error('Error loading old enrollments:', oldEnrollmentError);\r\n      } else {\r\n        console.log('ðŸ“š Found old enrollments:', oldEnrollmentData?.length || 0);\r\n      }\r\n\r\n      // Convert old enrollments to new format with enhanced data\r\n      const convertedEnrollments = (oldEnrollmentData || []).map(old => {\r\n        const progress = old.progress as any;\r\n        const completionPercentage = progress?.completion_percentage || 0;\r\n        \r\n        // Calculate time spent from study/reading sessions\r\n        const courseStudyTime = (studySessions || [])\r\n          .filter(session => session.completed_at)\r\n          .reduce((total, session) => total + (session.session_duration_seconds || 0), 0);\r\n        \r\n        const courseReadingTime = (readingSessions || [])\r\n          .reduce((total, session) => total + (session.duration_seconds || 0), 0);\r\n        \r\n        const totalTimeMinutes = Math.round((courseStudyTime + courseReadingTime) / 60);\r\n        \r\n        return {\r\n          id: `old-${old.course_id}`,\r\n          user_id: user.id,\r\n          course_id: old.course_id,\r\n          course_title: getCourseTitle(old.course_id),\r\n          enrolled_at: old.enrolled_at,\r\n          last_accessed_at: new Date().toISOString(),\r\n          completion_percentage: completionPercentage,\r\n          completed_at: completionPercentage >= 100 ? new Date().toISOString() : null,\r\n          total_time_spent_minutes: totalTimeMinutes\r\n        };\r\n      });\r\n\r\n      // Combine new and old enrollment data\r\n      const allEnrollments = [...(enrollmentData || []), ...convertedEnrollments];\r\n      console.log('ðŸ“ˆ Total enrollments combined:', allEnrollments.length);\r\n\r\n      const { data: lessonData, error: lessonError } = await supabase\r\n        .from('interactive_lesson_analytics')\r\n        .select('*')\r\n        .eq('user_id', user.id);\r\n\r\n      if (lessonError) {\r\n        console.error('Error loading lesson data:', lessonError);\r\n      } else {\r\n        console.log('ðŸ“š Found lesson analytics:', lessonData?.length || 0);\r\n      }\r\n\r\n      // Process course analytics with combined data\r\n      const courseStats = processCourseAnalytics(allEnrollments, lessonData || []);\r\n      setCourseAnalytics(courseStats);\r\n      console.log('ðŸ“ˆ Processed course stats:', courseStats.length);\r\n\r\n      // Load learning trends\r\n      const trends = await loadLearningTrends(selectedTimeRange);\r\n      setLearningTrends(trends);\r\n\r\n      // Load user progress (for current user only)\r\n      const progress = await loadUserProgress();\r\n      setUserProgress(progress);\r\n      \r\n    } catch (error) {\r\n      console.error('Error loading analytics data:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getCourseTitle = (courseId: string): string => {\r\n    const titles: Record<string, string> = {\r\n      'introduction-modern-economics': 'Introduction to Modern Economics',\r\n      'interactive-linear-equations': 'Linear Equations Mastery', \r\n      'interactive-algebra': 'Algebra Fundamentals',\r\n      'interactive-trigonometry': 'Trigonometry Fundamentals',\r\n      'logic-critical-thinking': 'Logic & Critical Thinking',\r\n      'interactive-science': 'Interactive Science',\r\n      'neurodiversity-strengths-based-approach': 'Neurodiversity Strengths-Based Approach',\r\n      'el-spelling-reading': 'EL Spelling & Reading'\r\n    };\r\n    return titles[courseId] || courseId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n  };\r\n\r\n  const processCourseAnalytics = (enrollments: EnrollmentData[], lessons: LessonData[]): CourseAnalytics[] => {\r\n    const courseMap = new Map<string, any>();\r\n\r\n    // Process enrollments\r\n    enrollments.forEach(enrollment => {\r\n      if (!courseMap.has(enrollment.course_id)) {\r\n        courseMap.set(enrollment.course_id, {\r\n          courseId: enrollment.course_id,\r\n          courseTitle: enrollment.course_title || getCourseTitle(enrollment.course_id),\r\n          totalEnrollments: 0,\r\n          completions: 0,\r\n          totalTime: 0,\r\n          totalLessons: 0,\r\n          engagementScores: [],\r\n          hasActivity: false\r\n        });\r\n      }\r\n      \r\n      const course = courseMap.get(enrollment.course_id);\r\n      course.totalEnrollments++;\r\n      course.totalTime += enrollment.total_time_spent_minutes || 0;\r\n      \r\n      if (enrollment.completed_at || enrollment.completion_percentage >= 100) {\r\n        course.completions++;\r\n      }\r\n      \r\n      // Mark as having activity if there's any time spent or completion progress\r\n      if (enrollment.total_time_spent_minutes > 0 || enrollment.completion_percentage > 0) {\r\n        course.hasActivity = true;\r\n      }\r\n    });\r\n\r\n    // Process lesson analytics\r\n    lessons.forEach(lesson => {\r\n      const course = courseMap.get(lesson.course_id);\r\n      if (course) {\r\n        course.engagementScores.push(lesson.engagement_score || 0);\r\n        course.hasActivity = true;\r\n        \r\n        // Count unique lessons\r\n        const lessonSet = course.lessonSet || new Set();\r\n        lessonSet.add(lesson.lesson_id);\r\n        course.lessonSet = lessonSet;\r\n        course.totalLessons = lessonSet.size;\r\n        \r\n        // Add time from lesson analytics if available\r\n        if (lesson.time_spent_seconds > 0) {\r\n          course.totalTime += Math.round(lesson.time_spent_seconds / 60);\r\n        }\r\n      }\r\n    });\r\n\r\n    // For courses without lesson analytics, estimate engagement and lessons\r\n    courseMap.forEach(course => {\r\n      if (!course.hasActivity && course.totalEnrollments > 0) {\r\n        // Estimate some basic metrics for enrolled courses without detailed analytics\r\n        course.totalLessons = 5; // Default lesson count\r\n        course.engagementScores = [25]; // Default low engagement for inactive courses\r\n      }\r\n    });\r\n\r\n    // Convert to analytics format\r\n    return Array.from(courseMap.values()).map(course => ({\r\n      courseId: course.courseId,\r\n      courseTitle: course.courseTitle,\r\n      totalEnrollments: course.totalEnrollments,\r\n      averageCompletion: course.totalEnrollments > 0 ? \r\n        Math.round((course.completions / course.totalEnrollments) * 100) : 0,\r\n      averageTimeSpent: course.totalEnrollments > 0 ? \r\n        Math.round(course.totalTime / course.totalEnrollments) : 0,\r\n      totalLessons: course.totalLessons,\r\n      averageEngagement: course.engagementScores.length > 0 ?\r\n        Math.round(course.engagementScores.reduce((a: number, b: number) => a + b, 0) / course.engagementScores.length) : 0,\r\n      completionRate: course.totalEnrollments > 0 ? \r\n        Math.round((course.completions / course.totalEnrollments) * 100) : 0\r\n    }));\r\n  };\r\n\r\n  const loadLearningTrends = async (timeRange: string): Promise<LearningTrend[]> => {\r\n    const days = timeRange === '7d' ? 7 : timeRange === '30d' ? 30 : 90;\r\n    const startDate = new Date();\r\n    startDate.setDate(startDate.getDate() - days);\r\n\r\n    const { data: trendData } = await supabase\r\n      .from('interactive_course_enrollments')\r\n      .select('enrolled_at, completed_at, total_time_spent_minutes')\r\n      .eq('user_id', user?.id)\r\n      .gte('enrolled_at', startDate.toISOString());\r\n\r\n    // Process trends by day\r\n    const trendMap = new Map<string, { enrollments: number; completions: number; totalTime: number }>();\r\n    \r\n    (trendData || []).forEach(item => {\r\n      const date = item.enrolled_at.split('T')[0];\r\n      if (!trendMap.has(date)) {\r\n        trendMap.set(date, { enrollments: 0, completions: 0, totalTime: 0 });\r\n      }\r\n      \r\n      const trend = trendMap.get(date)!;\r\n      trend.enrollments++;\r\n      trend.totalTime += item.total_time_spent_minutes || 0;\r\n      \r\n      if (item.completed_at) {\r\n        trend.completions++;\r\n      }\r\n    });\r\n\r\n    return Array.from(trendMap.entries()).map(([date, data]) => ({\r\n      date,\r\n      completions: data.completions,\r\n      enrollments: data.enrollments,\r\n      averageTime: data.enrollments > 0 ? Math.round(data.totalTime / data.enrollments) : 0\r\n    })).sort((a, b) => a.date.localeCompare(b.date));\r\n  };\r\n\r\n  const loadUserProgress = async (): Promise<UserProgress[]> => {\r\n    const { data } = await supabase\r\n      .from('interactive_course_enrollments')\r\n      .select('*')\r\n      .eq('user_id', user?.id);\r\n\r\n    return (data || []).map(enrollment => {\r\n      const daysSinceAccess = enrollment.last_accessed_at ? \r\n        Math.floor((new Date().getTime() - new Date(enrollment.last_accessed_at).getTime()) / (1000 * 60 * 60 * 24)) : 999;\r\n      \r\n      let status: 'active' | 'completed' | 'inactive' = 'inactive';\r\n      if (enrollment.completed_at) {\r\n        status = 'completed';\r\n      } else if (daysSinceAccess <= 7) {\r\n        status = 'active';\r\n      }\r\n\r\n      return {\r\n        userId: enrollment.user_id,\r\n        courseId: enrollment.course_id,\r\n        courseTitle: enrollment.course_title,\r\n        completionPercentage: enrollment.completion_percentage,\r\n        totalTimeSpent: enrollment.total_time_spent_minutes,\r\n        averageEngagement: 0, // Could be calculated from lesson analytics\r\n        lastAccessed: enrollment.last_accessed_at,\r\n        status\r\n      };\r\n    });\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'completed': return 'bg-green-100 text-green-800';\r\n      case 'active': return 'bg-blue-100 text-blue-800';\r\n      case 'inactive': return 'bg-gray-100 text-gray-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          {[...Array(4)].map((_, i) => (\r\n            <Card key={i}>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"animate-pulse space-y-3\">\r\n                  <div className=\"h-4 bg-muted rounded w-3/4\"></div>\r\n                  <div className=\"h-8 bg-muted rounded w-1/2\"></div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const totalEnrollments = courseAnalytics.reduce((sum, course) => sum + course.totalEnrollments, 0);\r\n  const totalCompletions = courseAnalytics.reduce((sum, course) => \r\n    sum + Math.round((course.averageCompletion / 100) * course.totalEnrollments), 0);\r\n  const averageEngagement = courseAnalytics.length > 0 ? \r\n    Math.round(courseAnalytics.reduce((sum, course) => sum + course.averageEngagement, 0) / courseAnalytics.length) : 0;\r\n  const totalTimeSpent = courseAnalytics.reduce((sum, course) => \r\n    sum + (course.averageTimeSpent * course.totalEnrollments), 0);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Time Range Selector */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <h2 className=\"text-2xl font-bold\">Interactive Course Analytics</h2>\r\n        <div className=\"flex space-x-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={async () => {\r\n              if (user) {\r\n                setIsLoading(true);\r\n                try {\r\n                  await analyticsDataSync.runCompleteSync(user.id);\r\n                  await loadAnalyticsData(); // Reload data after sync\r\n                } catch (error) {\r\n                  console.error('Sync failed:', error);\r\n                } finally {\r\n                  setIsLoading(false);\r\n                }\r\n              }\r\n            }}\r\n            disabled={isLoading}\r\n          >\r\n            ðŸ”„ Sync Data\r\n          </Button>\r\n          {(['7d', '30d', '90d'] as const).map(range => (\r\n            <Button\r\n              key={range}\r\n              variant={selectedTimeRange === range ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setSelectedTimeRange(range)}\r\n            >\r\n              {range === '7d' ? '7 Days' : range === '30d' ? '30 Days' : '90 Days'}\r\n            </Button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overview Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Users className=\"h-8 w-8 text-blue-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Enrollments</p>\r\n                <p className=\"text-2xl font-bold\">{totalEnrollments.toLocaleString()}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Award className=\"h-8 w-8 text-green-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Completions</p>\r\n                <p className=\"text-2xl font-bold\">{totalCompletions.toLocaleString()}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Brain className=\"h-8 w-8 text-purple-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Avg Engagement</p>\r\n                <p className=\"text-2xl font-bold\">{averageEngagement}%</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center\">\r\n              <Clock className=\"h-8 w-8 text-orange-600\" />\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Time</p>\r\n                <p className=\"text-2xl font-bold\">{Math.round(totalTimeSpent / 60)}h</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Course Performance */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <BarChart3 className=\"h-5 w-5 mr-2\" />\r\n            Course Performance\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {courseAnalytics.map((course) => (\r\n              <div key={course.courseId} className=\"border rounded-lg p-4\">\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <h3 className=\"font-semibold\">{course.courseTitle}</h3>\r\n                  <Badge variant=\"outline\">\r\n                    {course.totalEnrollments} enrolled\r\n                  </Badge>\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-3\">\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Completion Rate</p>\r\n                    <p className=\"text-lg font-semibold\">{course.completionRate}%</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Avg Time</p>\r\n                    <p className=\"text-lg font-semibold\">{course.averageTimeSpent}m</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Engagement</p>\r\n                    <p className=\"text-lg font-semibold\">{course.averageEngagement}%</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-muted-foreground\">Lessons</p>\r\n                    <p className=\"text-lg font-semibold\">{course.totalLessons}</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span>Completion Progress</span>\r\n                    <span>{course.completionRate}%</span>\r\n                  </div>\r\n                  <Progress value={course.completionRate} className=\"h-2\" />\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* User Progress (Personal View) */}\r\n      {userProgress.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Target className=\"h-5 w-5 mr-2\" />\r\n              My Learning Progress\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {userProgress.map((progress) => (\r\n                <div key={progress.courseId} className=\"border rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between mb-3\">\r\n                    <h3 className=\"font-semibold\">{progress.courseTitle}</h3>\r\n                    <Badge className={getStatusColor(progress.status)}>\r\n                      {progress.status}\r\n                    </Badge>\r\n                  </div>\r\n                  \r\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 mb-3\">\r\n                    <div>\r\n                      <p className=\"text-xs text-muted-foreground\">Progress</p>\r\n                      <p className=\"text-lg font-semibold\">{progress.completionPercentage}%</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-muted-foreground\">Time Spent</p>\r\n                      <p className=\"text-lg font-semibold\">{Math.round(progress.totalTimeSpent / 60)}h {progress.totalTimeSpent % 60}m</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-muted-foreground\">Last Accessed</p>\r\n                      <p className=\"text-sm\">{new Date(progress.lastAccessed).toLocaleDateString()}</p>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex justify-between text-sm\">\r\n                      <span>Course Progress</span>\r\n                      <span>{progress.completionPercentage}%</span>\r\n                    </div>\r\n                    <Progress value={progress.completionPercentage} className=\"h-2\" />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Learning Trends */}\r\n      {learningTrends.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Activity className=\"h-5 w-5 mr-2\" />\r\n              Learning Trends\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-7 gap-2\">\r\n              {learningTrends.slice(-7).map((trend, index) => (\r\n                <div key={trend.date} className=\"text-center p-3 bg-muted/50 rounded-lg\">\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    {new Date(trend.date).toLocaleDateString('en-US', { weekday: 'short' })}\r\n                  </p>\r\n                  <p className=\"text-lg font-semibold text-green-600\">{trend.completions}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">completions</p>\r\n                  <p className=\"text-sm text-blue-600\">{trend.enrollments}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">enrolled</p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InteractiveCourseAnalyticsDashboard;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\LibraryReadingAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\NotificationsAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\ReadingAnalyticsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\StudyPerformanceCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\UserLearningProgress.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadUserData'. Either include it or remove the dependency array.","line":43,"column":6,"nodeType":"ArrayExpression","endLine":43,"endColumn":31,"suggestions":[{"desc":"Update the dependencies array to be: [user, selectedTimeRange, loadUserData]","fix":{"range":[1350,1375],"text":"[user, selectedTimeRange, loadUserData]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2738,2741],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2738,2741],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { \r\n  Target,\r\n  Activity,\r\n  Clock,\r\n  TrendingUp\r\n} from 'lucide-react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { analyticsDataSync } from '@/utils/analyticsDataSync';\r\n\r\ninterface UserProgress {\r\n  userId: string;\r\n  courseId: string;\r\n  courseTitle: string;\r\n  completionPercentage: number;\r\n  totalTimeSpent: number;\r\n  averageEngagement: number;\r\n  lastAccessed: string;\r\n  status: 'active' | 'completed' | 'inactive';\r\n}\r\n\r\ninterface LearningTrend {\r\n  date: string;\r\n  completions: number;\r\n  enrollments: number;\r\n  averageTime: number;\r\n}\r\n\r\nexport const UserLearningProgress: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [userProgress, setUserProgress] = useState<UserProgress[]>([]);\r\n  const [learningTrends, setLearningTrends] = useState<LearningTrend[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [selectedTimeRange, setSelectedTimeRange] = useState<'7d' | '30d' | '90d'>('30d');\r\n\r\n  useEffect(() => {\r\n    loadUserData();\r\n  }, [user, selectedTimeRange]);\r\n\r\n  const loadUserData = async () => {\r\n    if (!user) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      console.log('ðŸ”„ Loading user learning progress for:', user.id);\r\n      \r\n      // Run analytics data sync to ensure we have the latest data\r\n      await analyticsDataSync.runCompleteSync(user.id);\r\n      \r\n      // Load user progress\r\n      const progress = await loadUserProgress();\r\n      setUserProgress(progress);\r\n\r\n      // Load learning trends for current user\r\n      const trends = await loadLearningTrends(selectedTimeRange);\r\n      setLearningTrends(trends);\r\n      \r\n    } catch (error) {\r\n      console.error('Error loading user learning data:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadUserProgress = async (): Promise<UserProgress[]> => {\r\n    // Load from new interactive course enrollments\r\n    const { data: newData } = await supabase\r\n      .from('interactive_course_enrollments')\r\n      .select('*')\r\n      .eq('user_id', user?.id);\r\n\r\n    // Load from old enrollments table as fallback\r\n    const { data: oldData } = await supabase\r\n      .from('enrollments')\r\n      .select('course_id, enrolled_at, progress')\r\n      .eq('user_id', user?.id);\r\n\r\n    // Convert old enrollments to new format\r\n    const convertedOldData = (oldData || []).map(old => {\r\n      const progress = old.progress as any;\r\n      const completionPercentage = progress?.completion_percentage || 0;\r\n      \r\n      return {\r\n        user_id: user?.id,\r\n        course_id: old.course_id,\r\n        course_title: getCourseTitle(old.course_id),\r\n        enrolled_at: old.enrolled_at,\r\n        last_accessed_at: new Date().toISOString(),\r\n        completion_percentage: completionPercentage,\r\n        completed_at: completionPercentage >= 100 ? new Date().toISOString() : null,\r\n        total_time_spent_minutes: 0\r\n      };\r\n    });\r\n\r\n    // Combine both data sources\r\n    const allEnrollments = [...(newData || []), ...convertedOldData];\r\n\r\n    return allEnrollments.map(enrollment => {\r\n      const daysSinceAccess = enrollment.last_accessed_at ? \r\n        Math.floor((new Date().getTime() - new Date(enrollment.last_accessed_at).getTime()) / (1000 * 60 * 60 * 24)) : 999;\r\n      \r\n      let status: 'active' | 'completed' | 'inactive' = 'inactive';\r\n      if (enrollment.completed_at) {\r\n        status = 'completed';\r\n      } else if (daysSinceAccess <= 7) {\r\n        status = 'active';\r\n      }\r\n\r\n      return {\r\n        userId: enrollment.user_id,\r\n        courseId: enrollment.course_id,\r\n        courseTitle: enrollment.course_title || getCourseTitle(enrollment.course_id),\r\n        completionPercentage: enrollment.completion_percentage,\r\n        totalTimeSpent: enrollment.total_time_spent_minutes || 0,\r\n        averageEngagement: 0, // Could be calculated from lesson analytics\r\n        lastAccessed: enrollment.last_accessed_at,\r\n        status\r\n      };\r\n    });\r\n  };\r\n\r\n  const loadLearningTrends = async (timeRange: string): Promise<LearningTrend[]> => {\r\n    const days = timeRange === '7d' ? 7 : timeRange === '30d' ? 30 : 90;\r\n    const startDate = new Date();\r\n    startDate.setDate(startDate.getDate() - days);\r\n\r\n    const { data: trendData } = await supabase\r\n      .from('interactive_course_enrollments')\r\n      .select('enrolled_at, completed_at, total_time_spent_minutes')\r\n      .eq('user_id', user?.id)\r\n      .gte('enrolled_at', startDate.toISOString());\r\n\r\n    // Process trends by day\r\n    const trendMap = new Map<string, { enrollments: number; completions: number; totalTime: number }>();\r\n    \r\n    (trendData || []).forEach(item => {\r\n      const date = item.enrolled_at.split('T')[0];\r\n      if (!trendMap.has(date)) {\r\n        trendMap.set(date, { enrollments: 0, completions: 0, totalTime: 0 });\r\n      }\r\n      \r\n      const trend = trendMap.get(date)!;\r\n      trend.enrollments++;\r\n      trend.totalTime += item.total_time_spent_minutes || 0;\r\n      \r\n      if (item.completed_at) {\r\n        trend.completions++;\r\n      }\r\n    });\r\n\r\n    return Array.from(trendMap.entries()).map(([date, data]) => ({\r\n      date,\r\n      completions: data.completions,\r\n      enrollments: data.enrollments,\r\n      averageTime: data.enrollments > 0 ? Math.round(data.totalTime / data.enrollments) : 0\r\n    })).sort((a, b) => a.date.localeCompare(b.date));\r\n  };\r\n\r\n  const getCourseTitle = (courseId: string): string => {\r\n    const titles: Record<string, string> = {\r\n      'introduction-modern-economics': 'Introduction to Modern Economics',\r\n      'interactive-linear-equations': 'Linear Equations Mastery', \r\n      'interactive-algebra': 'Algebra Fundamentals',\r\n      'interactive-trigonometry': 'Trigonometry Fundamentals',\r\n      'logic-critical-thinking': 'Logic & Critical Thinking',\r\n      'interactive-science': 'Interactive Science',\r\n      'neurodiversity-strengths-based-approach': 'Neurodiversity Strengths-Based Approach',\r\n      'el-spelling-reading': 'EL Spelling & Reading'\r\n    };\r\n    return titles[courseId] || courseId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'completed': return 'bg-green-100 text-green-800';\r\n      case 'active': return 'bg-blue-100 text-blue-800';\r\n      case 'inactive': return 'bg-gray-100 text-gray-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"grid grid-cols-1 gap-6\">\r\n          {[...Array(3)].map((_, i) => (\r\n            <Card key={i}>\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"animate-pulse space-y-3\">\r\n                  <div className=\"h-4 bg-muted rounded w-3/4\"></div>\r\n                  <div className=\"h-8 bg-muted rounded w-1/2\"></div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Time Range Selector */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <h2 className=\"text-2xl font-bold\">My Learning Progress</h2>\r\n        <div className=\"flex space-x-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={async () => {\r\n              if (user) {\r\n                setIsLoading(true);\r\n                try {\r\n                  await analyticsDataSync.runCompleteSync(user.id);\r\n                  await loadUserData();\r\n                } catch (error) {\r\n                  console.error('Sync failed:', error);\r\n                } finally {\r\n                  setIsLoading(false);\r\n                }\r\n              }\r\n            }}\r\n            disabled={isLoading}\r\n          >\r\n            ðŸ”„ Sync Data\r\n          </Button>\r\n          {(['7d', '30d', '90d'] as const).map(range => (\r\n            <Button\r\n              key={range}\r\n              variant={selectedTimeRange === range ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setSelectedTimeRange(range)}\r\n            >\r\n              {range === '7d' ? '7 Days' : range === '30d' ? '30 Days' : '90 Days'}\r\n            </Button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* User Progress Details */}\r\n      {userProgress.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Target className=\"h-5 w-5 mr-2\" />\r\n              My Course Progress\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {userProgress.map((progress) => (\r\n                <div key={progress.courseId} className=\"border rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between mb-3\">\r\n                    <h3 className=\"font-semibold\">{progress.courseTitle}</h3>\r\n                    <Badge className={getStatusColor(progress.status)}>\r\n                      {progress.status}\r\n                    </Badge>\r\n                  </div>\r\n                  \r\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 mb-3\">\r\n                    <div>\r\n                      <p className=\"text-xs text-muted-foreground\">Progress</p>\r\n                      <p className=\"text-lg font-semibold\">{progress.completionPercentage}%</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-muted-foreground\">Time Spent</p>\r\n                      <p className=\"text-lg font-semibold\">{Math.floor(progress.totalTimeSpent / 60)}h {progress.totalTimeSpent % 60}m</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-muted-foreground\">Last Accessed</p>\r\n                      <p className=\"text-sm\">{new Date(progress.lastAccessed).toLocaleDateString()}</p>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex justify-between text-sm\">\r\n                      <span>Course Progress</span>\r\n                      <span>{progress.completionPercentage}%</span>\r\n                    </div>\r\n                    <Progress value={progress.completionPercentage} className=\"h-2\" />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Learning Activity Summary */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <TrendingUp className=\"h-5 w-5 mr-2\" />\r\n            Learning Summary\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-3xl font-bold text-blue-600 mb-2\">\r\n                {userProgress.length}\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground\">Enrolled Courses</p>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-3xl font-bold text-green-600 mb-2\">\r\n                {userProgress.filter(p => p.status === 'completed').length}\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground\">Completed Courses</p>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-3xl font-bold text-purple-600 mb-2\">\r\n                {Math.round(userProgress.reduce((sum, p) => sum + p.totalTimeSpent, 0) / 60)}h\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground\">Total Study Time</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* My Learning Trends */}\r\n      {learningTrends.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Activity className=\"h-5 w-5 mr-2\" />\r\n              My Learning Trends\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-7 gap-2\">\r\n              {learningTrends.slice(-7).map((trend, index) => (\r\n                <div key={trend.date} className=\"text-center p-3 bg-muted/50 rounded-lg\">\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    {new Date(trend.date).toLocaleDateString('en-US', { weekday: 'short' })}\r\n                  </p>\r\n                  <p className=\"text-lg font-semibold text-green-600\">{trend.completions}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">completions</p>\r\n                  <p className=\"text-sm text-blue-600\">{trend.enrollments}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">enrolled</p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Empty State */}\r\n      {userProgress.length === 0 && (\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <Target className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n            <h3 className=\"text-lg font-semibold mb-2\">No Learning Progress Yet</h3>\r\n            <p className=\"text-muted-foreground mb-4\">\r\n              Start taking courses to see your learning progress and analytics here.\r\n            </p>\r\n            <Button>Browse Courses</Button>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserLearningProgress;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\analytics\\XPBreakdownCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\auth\\EmailVerificationGate.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\auth\\ForgotPasswordModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\auth\\ResetPasswordModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\beta\\BetaAccessGate.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkBetaAccess'. Either include it or remove the dependency array.","line":42,"column":6,"nodeType":"ArrayExpression","endLine":42,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [checkBetaAccess, user]","fix":{"range":[1410,1416],"text":"[checkBetaAccess, user]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2121,2124],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2121,2124],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":94,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2743,2746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2743,2746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Lock, UserCheck, Mail } from 'lucide-react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\ninterface BetaAccessGateProps {\r\n  children: React.ReactNode;\r\n  allowedEmails?: string[];\r\n}\r\n\r\n// Beta access configuration\r\nconst BETA_CONFIG = {\r\n  // Hardcoded beta emails for immediate deployment\r\n  allowedEmails: [\r\n    'jashon@fpkuniversity.com',\r\n    'beta@fpkuniversity.com',\r\n    'demo@fpkuniversity.com',\r\n    'admin@fpkuniversity.com'\r\n  ],\r\n  // Alternative: invite code system\r\n  validInviteCodes: ['BETA2024', 'EARLYACCESS', 'FPKBETA'],\r\n  // Feature flag for beta mode\r\n  isBetaModeEnabled: true\r\n};\r\n\r\nconst BetaAccessGate: React.FC<BetaAccessGateProps> = ({ \r\n  children, \r\n  allowedEmails = BETA_CONFIG.allowedEmails \r\n}) => {\r\n  const { user } = useAuth();\r\n  const [hasAccess, setHasAccess] = useState(false);\r\n  const [inviteCode, setInviteCode] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [showInviteForm, setShowInviteForm] = useState(false);\r\n\r\n  useEffect(() => {\r\n    checkBetaAccess();\r\n  }, [user]);\r\n\r\n  const checkBetaAccess = async () => {\r\n    if (!user) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Check if beta mode is disabled (bypass gate)\r\n    if (!BETA_CONFIG.isBetaModeEnabled) {\r\n      setHasAccess(true);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Method 1: Check email allowlist\r\n      if (allowedEmails.includes(user.email)) {\r\n        setHasAccess(true);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Method 2: Check database for beta access flag\r\n      const { data, error } = await supabase\r\n        .from('profiles')\r\n        .select('*')\r\n        .eq('id', user.id)\r\n        .single();\r\n\r\n      if (!error && (data as any)?.beta_access) {\r\n        setHasAccess(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('Beta access check failed:', error);\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleInviteCode = async () => {\r\n    if (!user || !inviteCode.trim()) return;\r\n\r\n    if (BETA_CONFIG.validInviteCodes.includes(inviteCode.trim().toUpperCase())) {\r\n      try {\r\n        // Store beta access in database\r\n        await supabase\r\n          .from('profiles')\r\n          .upsert({ \r\n            id: user.id, \r\n            beta_access: true,\r\n            beta_invite_code: inviteCode.trim().toUpperCase()\r\n          } as any);\r\n        \r\n        setHasAccess(true);\r\n      } catch (error) {\r\n        console.error('Failed to grant beta access:', error);\r\n      }\r\n    } else {\r\n      // Invalid code feedback\r\n      setInviteCode('');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-muted-foreground\">Checking access permissions...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5\">\r\n        <Card className=\"w-full max-w-md mx-4\">\r\n          <CardHeader className=\"text-center\">\r\n            <Lock className=\"w-12 h-12 mx-auto mb-4 text-primary\" />\r\n            <CardTitle>Authentication Required</CardTitle>\r\n            <CardDescription>\r\n              Please log in to access the beta platform\r\n            </CardDescription>\r\n          </CardHeader>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!hasAccess) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5 p-4\">\r\n        <Card className=\"w-full max-w-lg\">\r\n          <CardHeader className=\"text-center\">\r\n            <Lock className=\"w-16 h-16 mx-auto mb-4 text-primary\" />\r\n            <CardTitle className=\"text-2xl\">Beta Access Required</CardTitle>\r\n            <CardDescription className=\"text-lg\">\r\n              FPK University Learning Platform is currently in closed beta\r\n            </CardDescription>\r\n          </CardHeader>\r\n          \r\n          <CardContent className=\"space-y-6\">\r\n            <div className=\"text-center\">\r\n              <Badge variant=\"secondary\" className=\"text-sm\">\r\n                <Mail className=\"w-4 h-4 mr-2\" />\r\n                {user.email}\r\n              </Badge>\r\n            </div>\r\n\r\n            {!showInviteForm ? (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"text-center text-muted-foreground\">\r\n                  <p>This account doesn't have beta access yet.</p>\r\n                  <p className=\"text-sm mt-2\">\r\n                    If you have an invite code, click below to enter it.\r\n                  </p>\r\n                </div>\r\n                \r\n                <Button \r\n                  onClick={() => setShowInviteForm(true)}\r\n                  className=\"w-full\"\r\n                  variant=\"outline\"\r\n                >\r\n                  I have an invite code\r\n                </Button>\r\n\r\n                <div className=\"text-center text-sm text-muted-foreground\">\r\n                  <p>Don't have access?</p>\r\n                  <p>Contact <strong>jashon@fpkuniversity.com</strong> for beta invitation.</p>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Enter Invite Code</label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    placeholder=\"BETA2024\"\r\n                    value={inviteCode}\r\n                    onChange={(e) => setInviteCode(e.target.value.toUpperCase())}\r\n                    className=\"text-center text-lg tracking-wider\"\r\n                  />\r\n                </div>\r\n                \r\n                <div className=\"flex space-x-2\">\r\n                  <Button \r\n                    onClick={handleInviteCode}\r\n                    className=\"flex-1\"\r\n                    disabled={!inviteCode.trim()}\r\n                  >\r\n                    <UserCheck className=\"w-4 h-4 mr-2\" />\r\n                    Verify Access\r\n                  </Button>\r\n                  <Button \r\n                    onClick={() => setShowInviteForm(false)}\r\n                    variant=\"outline\"\r\n                  >\r\n                    Cancel\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // User has access - render the app\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default BetaAccessGate;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\beta\\BetaOnboarding.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkOnboardingStatus'. Either include it or remove the dependency array.","line":93,"column":6,"nodeType":"ArrayExpression","endLine":93,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [user, forceShow, checkOnboardingStatus]","fix":{"range":[3016,3033],"text":"[user, forceShow, checkOnboardingStatus]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":105,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3294,3297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3294,3297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":128,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3846,3849],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3846,3849],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { CheckCircle, Play, BookOpen, MessageSquare, BarChart3, Settings, ArrowRight, Sparkles } from 'lucide-react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\ninterface OnboardingStep {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  icon: React.ComponentType<{ className?: string }>;\r\n  action?: string;\r\n  link?: string;\r\n}\r\n\r\nconst ONBOARDING_STEPS: OnboardingStep[] = [\r\n  {\r\n    id: 'welcome',\r\n    title: 'Welcome to FPK University Beta!',\r\n    description: 'You\\'re among the first to experience our revolutionary learning platform.',\r\n    icon: Sparkles\r\n  },\r\n  {\r\n    id: 'modules',\r\n    title: 'Explore Learning Modules',\r\n    description: 'Navigate through video, audio, and interactive content designed for optimal learning.',\r\n    icon: BookOpen,\r\n    action: 'Try a Module',\r\n    link: 'https://course-start-kit-react.lovable.app/course/module/1a'\r\n  },\r\n  {\r\n    id: 'progress',\r\n    title: 'Track Your Progress',\r\n    description: 'Monitor your learning journey with detailed analytics and insights.',\r\n    icon: BarChart3,\r\n    action: 'View Analytics',\r\n    link: '/dashboard/learner/analytics'\r\n  },\r\n  {\r\n    id: 'ai-coach',\r\n    title: 'Meet Your AI Study Coach',\r\n    description: 'Get personalized guidance and support throughout your learning journey.',\r\n    icon: MessageSquare,\r\n    action: 'Chat with AI',\r\n    link: '/dashboard/learner/ai-coach'\r\n  },\r\n  {\r\n    id: 'feedback',\r\n    title: 'Share Your Experience',\r\n    description: 'Your feedback helps us build the best learning platform possible.',\r\n    icon: MessageSquare,\r\n    action: 'Give Feedback',\r\n    link: 'feedback'\r\n  },\r\n  {\r\n    id: 'settings',\r\n    title: 'Customize Your Experience',\r\n    description: 'Adjust accessibility, notifications, and learning preferences.',\r\n    icon: Settings,\r\n    action: 'Open Settings',\r\n    link: '/dashboard/learner/settings'\r\n  }\r\n];\r\n\r\ninterface BetaOnboardingProps {\r\n  autoShow?: boolean;\r\n  onComplete?: () => void;\r\n  forceShow?: boolean;\r\n}\r\n\r\nconst BetaOnboarding: React.FC<BetaOnboardingProps> = ({ \r\n  autoShow = true, \r\n  onComplete,\r\n  forceShow = false \r\n}) => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [hasSeenOnboarding, setHasSeenOnboarding] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (forceShow) {\r\n      setIsOpen(true);\r\n    } else {\r\n      checkOnboardingStatus();\r\n    }\r\n  }, [user, forceShow]);\r\n\r\n  const checkOnboardingStatus = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { data } = await supabase\r\n        .from('profiles')\r\n        .select('*')\r\n        .eq('id', user.id)\r\n        .single();\r\n\r\n      const completed = (data as any)?.onboarding_completed || false;\r\n      setHasSeenOnboarding(completed);\r\n      \r\n      if (autoShow && !completed) {\r\n        setIsOpen(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to check onboarding status:', error);\r\n      if (autoShow) {\r\n        setIsOpen(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  const markOnboardingComplete = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      await supabase\r\n        .from('profiles')\r\n        .upsert({ \r\n          id: user.id, \r\n          onboarding_completed: true \r\n        } as any);\r\n      \r\n      setHasSeenOnboarding(true);\r\n    } catch (error) {\r\n      console.error('Failed to mark onboarding complete:', error);\r\n    }\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (currentStep < ONBOARDING_STEPS.length - 1) {\r\n      setCurrentStep(currentStep + 1);\r\n    } else {\r\n      handleComplete();\r\n    }\r\n  };\r\n\r\n  const handleComplete = async () => {\r\n    await markOnboardingComplete();\r\n    setIsOpen(false);\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleStepAction = (step: OnboardingStep) => {\r\n    if (step.id === 'feedback') {\r\n      // Trigger the existing feedback system by clicking the feedback button\r\n      const feedbackButton = document.querySelector('[data-feedback-trigger]') as HTMLElement;\r\n      if (feedbackButton) {\r\n        feedbackButton.click();\r\n      } else {\r\n        // Fallback: dispatch a custom event to trigger feedback modal\r\n        window.dispatchEvent(new CustomEvent('triggerFeedback'));\r\n      }\r\n      return;\r\n    }\r\n    \r\n    if (step.link) {\r\n      // Open all action links in new tabs/windows\r\n      if (step.link.startsWith('http')) {\r\n        window.open(step.link, '_blank');\r\n      } else {\r\n        // For internal routes, open in new tab with full URL\r\n        const fullUrl = `${window.location.origin}${step.link}`;\r\n        window.open(fullUrl, '_blank');\r\n      }\r\n    }\r\n  };\r\n\r\n  const currentStepData = ONBOARDING_STEPS[currentStep];\r\n  const progress = ((currentStep + 1) / ONBOARDING_STEPS.length) * 100;\r\n  const IconComponent = currentStepData?.icon;\r\n\r\n  return (\r\n    <>\r\n      {/* Trigger button for reopening onboarding */}\r\n      {hasSeenOnboarding && (\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          onClick={() => setIsOpen(true)}\r\n          className=\"text-foreground hover:text-primary\"\r\n        >\r\n          <Play className=\"w-4 h-4 mr-2\" />\r\n          Beta Tour\r\n        </Button>\r\n      )}\r\n\r\n      <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <DialogTitle className=\"flex items-center\">\r\n                  <Badge variant=\"secondary\" className=\"mr-3\">BETA</Badge>\r\n                  FPK University Platform Tour\r\n                </DialogTitle>\r\n                <DialogDescription>\r\n                  Step {currentStep + 1} of {ONBOARDING_STEPS.length}\r\n                </DialogDescription>\r\n              </div>\r\n              <Button variant=\"ghost\" size=\"sm\" onClick={handleComplete}>\r\n                Skip Tour\r\n              </Button>\r\n            </div>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-6\">\r\n            {/* Progress */}\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm text-muted-foreground\">\r\n                <span>Progress</span>\r\n                <span>{Math.round(progress)}%</span>\r\n              </div>\r\n              <Progress value={progress} className=\"h-2\" />\r\n            </div>\r\n\r\n            {/* Current Step */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardHeader className=\"text-center\">\r\n                <div className=\"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4\">\r\n                  {IconComponent && <IconComponent className=\"w-8 h-8 text-primary\" />}\r\n                </div>\r\n                <CardTitle className=\"text-xl\">{currentStepData?.title}</CardTitle>\r\n                <CardDescription className=\"text-base\">\r\n                  {currentStepData?.description}\r\n                </CardDescription>\r\n              </CardHeader>\r\n              \r\n              {currentStepData?.action && (\r\n                <CardContent className=\"text-center\">\r\n                  <Button \r\n                    onClick={() => handleStepAction(currentStepData)}\r\n                    variant=\"outline\"\r\n                    className=\"mb-4\"\r\n                  >\r\n                    {currentStepData.action}\r\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                </CardContent>\r\n              )}\r\n            </Card>\r\n\r\n            {/* Step Overview */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\r\n              {ONBOARDING_STEPS.map((step, index) => (\r\n                <div\r\n                  key={step.id}\r\n                  className={`flex items-center space-x-2 p-2 rounded-lg text-sm ${\r\n                    index === currentStep \r\n                      ? 'bg-primary/10 text-primary' \r\n                      : index < currentStep \r\n                      ? 'bg-green-50 text-green-700'\r\n                      : 'bg-muted/50 text-muted-foreground'\r\n                  }`}\r\n                >\r\n                  {index < currentStep ? (\r\n                    <CheckCircle className=\"w-4 h-4\" />\r\n                  ) : (\r\n                    <step.icon className=\"w-4 h-4\" />\r\n                  )}\r\n                  <span className=\"truncate\">{step.title.replace('FPK University', '').trim()}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Navigation */}\r\n            <div className=\"flex justify-between pt-4\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => setCurrentStep(Math.max(0, currentStep - 1))}\r\n                disabled={currentStep === 0}\r\n              >\r\n                Previous\r\n              </Button>\r\n              \r\n              <Button onClick={handleNext}>\r\n                {currentStep === ONBOARDING_STEPS.length - 1 ? 'Complete Tour' : 'Next'}\r\n                <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default BetaOnboarding;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\beta\\FeedbackSystem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\beta\\QATestRunner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\beta\\StructuredQuestions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\cards\\InteractiveScienceCourseCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\chat\\AIStudyChatInterface.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2418,2421],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2418,2421],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\+.","line":218,"column":42,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":218,"endColumn":43,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7898,7899],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7898,7898],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\*.","line":218,"column":46,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":218,"endColumn":47,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7902,7903],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7902,7902],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":218,"column":48,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":218,"endColumn":49,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7904,7905],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7904,7904],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":497,"column":6,"nodeType":"ArrayExpression","endLine":497,"endColumn":90,"suggestions":[{"desc":"Update the dependencies array to be: [messages, autoPlayEnabled, settings.enabled, lastSpokenMessageId, isLoading, speak, cleanup]","fix":{"range":[17222,17306],"text":"[messages, autoPlayEnabled, settings.enabled, lastSpokenMessageId, isLoading, speak, cleanup]"}}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Send, Brain, User, Bot, Mic, MicOff, Volume2, VolumeX, Play, Trash2, History } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useTextToSpeech } from '@/hooks/useTextToSpeech';\r\nimport { useEnhancedVoiceInput } from '@/hooks/useEnhancedVoiceInput';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { useVoiceSettings } from '@/contexts/VoiceSettingsContext';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { cn } from '@/lib/utils';\r\nimport { useWidgetChatStorage } from '@/hooks/useWidgetChatStorage';\r\nimport { useConversationState, ChatMessage as ConversationMessage } from '@/hooks/useConversationState';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport VoiceInputButton from '@/components/notes/VoiceInputButton';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport ChatModeToggle from '@/components/ai-coach/ChatModeToggle';\r\nimport { SaveBeforeClearDialog } from '@/components/ai-coach/SaveBeforeClearDialog';\r\nimport { useSavedCoachChats } from '@/hooks/useSavedCoachChats';\r\n\r\ninterface ChatMessage {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\ninterface User {\r\n  id: string;\r\n  email?: string;\r\n  name?: string;\r\n}\r\n\r\ninterface SessionData {\r\n  id: string;\r\n  course_id?: string;\r\n  completed_at?: string;\r\n}\r\n\r\ninterface FlashcardData {\r\n  id: string;\r\n  front_content: string;\r\n  back_content: string;\r\n  difficulty_level?: number;\r\n}\r\n\r\ninterface InsightData {\r\n  type: 'performance' | 'pattern' | 'recommendation' | 'motivation';\r\n  title: string;\r\n  message: string;\r\n  priority: 'high' | 'medium' | 'low';\r\n}\r\n\r\ninterface AIStudyChatInterfaceProps {\r\n  chatMode?: 'personal' | 'general';\r\n  showHeader?: boolean;\r\n  placeholder?: string;\r\n  // Dashboard-specific props\r\n  user?: User;\r\n  completedSessions?: SessionData[];\r\n  flashcards?: FlashcardData[];\r\n  insights?: InsightData[];\r\n  fixedHeight?: boolean;\r\n}\r\n\r\nconst withProgressiveTimeout = <T,>(\r\n  promise: Promise<T>, \r\n  onProgress: (message: string) => void,\r\n  cleanup: any,\r\n  ms = 18000\r\n): Promise<T> => {\r\n  return new Promise((resolve, reject) => {\r\n    let progressTimer: NodeJS.Timeout;\r\n    \r\n    // Show \"Still thinking...\" after 8 seconds  \r\n    const progressTimeout = cleanup.setTimeout(() => {\r\n      onProgress(\"Still thinking... This might take a moment.\");\r\n    }, 8000);\r\n    \r\n    // Final timeout after 18 seconds\r\n    const finalTimeout = cleanup.setTimeout(() => {\r\n      cleanup.cleanup(progressTimeout);\r\n      reject(new Error('Request timed out - please try again'));\r\n    }, ms);\r\n    \r\n    promise.then((value) => {\r\n      clearTimeout(progressTimeout);\r\n      clearTimeout(finalTimeout);\r\n      resolve(value);\r\n    }).catch((err) => {\r\n      clearTimeout(progressTimeout);\r\n      clearTimeout(finalTimeout);\r\n      reject(err);\r\n    });\r\n  });\r\n};\r\n\r\nexport const AIStudyChatInterface: React.FC<AIStudyChatInterfaceProps> = ({\r\n  chatMode: initialChatMode = 'general',\r\n  showHeader = true,\r\n  placeholder = \"Ask me anything about your studies...\",\r\n  user,\r\n  completedSessions = [],\r\n  flashcards = [],\r\n  insights,\r\n  fixedHeight = false\r\n}) => {\r\n  const { user: authUser } = useAuth();\r\n  const currentUser = user || authUser;\r\n  const [chatMode, setChatMode] = useState(initialChatMode);\r\n  const { toast } = useToast();\r\n  const anonymousId = useState(() => `anonymous_${Date.now()}`)[0];\r\n  const { messages, addMessage, clearAllMessages } = useWidgetChatStorage(currentUser?.id || anonymousId);\r\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\r\n  const { state: conversationState, analyzeConversation, updateState } = useConversationState();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [input, setInput] = useState('');\r\n  const [sessionId] = useState(() => uuidv4());\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const [lastSpokenMessageId, setLastSpokenMessageId] = useState<string | null>(null);\r\n  const [autoPlayEnabled, setAutoPlayEnabled] = useState(() => \r\n    safeLocalStorage.getItem<string>('aistudycoach_voice_autoplay', {\r\n      fallbackValue: 'false',\r\n      logErrors: false\r\n    }) === 'true'\r\n  );\r\n  \r\n  const { speak, stop, isSpeaking } = useTextToSpeech();\r\n  const { settings, toggle } = useVoiceSettings();\r\n  const voiceInput = useEnhancedVoiceInput();\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n  const cleanup = useCleanup('AIStudyChatInterface');\r\n\r\n  // Auto scroll when messages change\r\n  useEffect(() => {\r\n    if (messages.length > 0) {\r\n      cleanup.setTimeout(() => {\r\n        messagesEndRef.current?.scrollIntoView({ \r\n          behavior: 'smooth',\r\n          block: 'end',\r\n          inline: 'nearest'\r\n        });\r\n      }, 100);\r\n    }\r\n  }, [messages, cleanup]);\r\n\r\n  // Add welcome message with dashboard data\r\n  useEffect(() => {\r\n    if (messages.length === 0) {\r\n      const welcomeContent = chatMode === 'personal' \r\n        ? `Hello! I'm your personalized AI Learning Coach. I have access to your study data and can help you with:\r\n\r\nðŸŽ¯ **Personalized Guidance** - Based on your uploaded materials and progress\r\nðŸ“š **Study Sessions** - Using your flashcards and notes for targeted practice\r\nðŸ§  **Socratic Teaching** - I'll guide you to discover answers through questions\r\nðŸŽ® **Interactive Quizzes** - Practice with your flashcards by saying \"quiz me\"\r\nðŸ’¡ **Smart Insights** - Tailored advice based on your learning patterns\r\n\r\nI can see you have ${completedSessions?.length || 0} completed study sessions and ${flashcards?.length || 0} flashcards ready for practice.\r\n\r\nWhat would you like to focus on in today's learning session?`\r\n        : `Hello! I'm your AI Learning Coach in general knowledge mode. I can help you with:\r\n\r\nðŸŒ **General Knowledge** - Any subject, research, or educational topics\r\nðŸ“– **Study Techniques** - Learning strategies and academic methods  \r\nðŸ’¡ **Learning Guidance** - Study tips and educational advice\r\nðŸ” **Research Help** - Information gathering and analysis\r\n\r\nFor personalized features with your study materials, you can switch to Personal mode using the toggle above.\r\n\r\nWhat would you like to learn about today?`;\r\n\r\n      const welcomeMessage = {\r\n        role: 'assistant' as const,\r\n        content: welcomeContent\r\n      };\r\n      \r\n      addMessage(welcomeMessage);\r\n    }\r\n  }, [messages.length, addMessage, chatMode, completedSessions?.length, flashcards?.length]);\r\n\r\n  // Convert widget messages to conversation format for analysis\r\n  const convertToConversationHistory = useCallback((widgetMessages: typeof messages): ConversationMessage[] => {\r\n    return widgetMessages.map(msg => ({\r\n      role: msg.role,\r\n      content: msg.content,\r\n      timestamp: msg.timestamp\r\n    }));\r\n  }, []);\r\n\r\n  const [progressMessage, setProgressMessage] = useState<string | null>(null);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  const sendMessage = async (messageText: string) => {\r\n    if (!messageText.trim() || isLoading) return;\r\n\r\n    // Cancel any existing request\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n    abortControllerRef.current = new AbortController();\r\n\r\n    const userMessage = {\r\n      role: 'user' as const,\r\n      content: messageText.trim()\r\n    };\r\n\r\n    addMessage(userMessage);\r\n    setInput('');\r\n    setIsLoading(true);\r\n    setProgressMessage(null);\r\n\r\n    try {\r\n      // Optimize for simple math questions - skip heavy analysis\r\n      const isMathQuestion = /^\\s*\\d+\\s*[\\+\\-\\*\\/]\\s*\\d+\\s*[?]?\\s*$/.test(messageText.trim());\r\n      \r\n      let analyzedState;\r\n      let contextData = {};\r\n      \r\n      if (isMathQuestion) {\r\n        // Fast path for simple math\r\n        analyzedState = {\r\n          promptType: 'direct_answer',\r\n          isInQuiz: false,\r\n          inRefresherMode: false,\r\n          currentTopic: 'mathematics',\r\n          teachingMethods: [],\r\n          incorrectAnswersCount: 0\r\n        };\r\n        console.log('ðŸš€ Fast path: Simple math question detected');\r\n      } else {\r\n        // Full analysis for complex questions\r\n        const conversationHistory = convertToConversationHistory(messages);\r\n        analyzedState = analyzeConversation(conversationHistory, messageText);\r\n        \r\n        contextData = {\r\n          quizTopic: analyzedState.currentTopic,\r\n          teachingHistory: analyzedState.teachingMethods.join(', '),\r\n          incorrectCount: analyzedState.incorrectAnswersCount,\r\n          isInQuiz: analyzedState.isInQuiz,\r\n          inRefresherMode: analyzedState.inRefresherMode\r\n        };\r\n      }\r\n      \r\n      updateState(analyzedState);\r\n\r\n      // Build lightweight client history (last 6 messages)\r\n      const clientHistory = messages.slice(-6).map(m => ({\r\n        role: m.role,\r\n        content: m.content,\r\n        timestamp: m.timestamp\r\n      }));\r\n      \r\n      console.log('ðŸŽ¯ Sending AI Study Chat request (Optimized):', {\r\n        messageLength: messageText.length,\r\n        promptType: analyzedState.promptType,\r\n        sessionId: sessionId.substring(0, 8) + '...',\r\n        historyLength: clientHistory.length,\r\n        isMathQuestion,\r\n        conversationState: {\r\n          isInQuiz: analyzedState.isInQuiz,\r\n          currentTopic: analyzedState.currentTopic,\r\n          incorrectCount: analyzedState.incorrectAnswersCount\r\n        }\r\n      });\r\n\r\n      // Call AI function with progressive timeout and cancellation\r\n      const { data, error } = await withProgressiveTimeout(\r\n        supabase.functions.invoke('ai-study-chat', {\r\n          body: {\r\n            message: messageText,\r\n            userId: currentUser?.id || anonymousId,\r\n            sessionId,\r\n            promptType: analyzedState.promptType,\r\n            chatMode,\r\n            voiceActive: false,\r\n            contextData,\r\n            clientHistory\r\n          }\r\n        }),\r\n        (progress) => setProgressMessage(progress),\r\n        cleanup,\r\n        18000\r\n      );\r\n      \r\n      if (error) {\r\n        console.error('âŒ AI Study Chat API error:', {\r\n          error: error.message,\r\n          details: error,\r\n          promptType: analyzedState.promptType,\r\n          messageText: messageText.substring(0, 50) + '...'\r\n        });\r\n        throw error;\r\n      }\r\n\r\n      if (!data?.response) {\r\n        console.warn('âš ï¸ AI Study Chat: No response data received');\r\n        throw new Error('No response received from AI');\r\n      }\r\n\r\n      console.log('âœ… AI Study Chat response received:', {\r\n        source: data.source,\r\n        blueprintVersion: data.blueprintVersion,\r\n        promptType: data.metadata?.promptType\r\n      });\r\n\r\n      const aiResponse = {\r\n        role: 'assistant' as const,\r\n        content: data.response\r\n      };\r\n\r\n      addMessage(aiResponse);\r\n\r\n      // Update conversation state based on AI response\r\n      if (data.metadata?.promptType) {\r\n        updateState({ \r\n          promptType: data.metadata.promptType,\r\n          lastAIQuestion: data.response.includes('?') ? data.response : null\r\n        });\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('âŒ Chat error details:', {\r\n        error: error instanceof Error ? error.message : error,\r\n        messageText: messageText.substring(0, 50) + '...',\r\n        timestamp: new Date().toISOString(),\r\n        conversationState: conversationState,\r\n        isAborted: abortControllerRef.current?.signal.aborted\r\n      });\r\n      \r\n      // Don't show error if request was cancelled by user\r\n      if (abortControllerRef.current?.signal.aborted) {\r\n        console.log('ðŸš« Request cancelled by user');\r\n        return;\r\n      }\r\n      \r\n      const fallbackResponse = {\r\n        role: 'assistant' as const,\r\n        content: generateFallbackResponse(messageText, chatMode)\r\n      };\r\n\r\n      addMessage(fallbackResponse);\r\n      \r\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n      const isTimeoutError = errorMessage.includes('timed out') || errorMessage.includes('timeout');\r\n      const isValidationError = errorMessage.includes('promptType') || errorMessage.includes('required');\r\n      \r\n      toast({\r\n        title: isTimeoutError ? \"Request Timed Out\" : isValidationError ? \"Configuration Issue\" : \"Connection Issue\",\r\n        description: isTimeoutError ? \r\n          \"The request took too long. Please try a simpler question.\" :\r\n          isValidationError ? \"Please refresh and try again\" : \"Using offline mode\",\r\n        variant: isTimeoutError || isValidationError ? \"destructive\" : \"default\",\r\n        duration: isTimeoutError ? 5000 : 3000\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n      setProgressMessage(null);\r\n      abortControllerRef.current = null;\r\n    }\r\n  };\r\n\r\n  const generateFallbackResponse = (userMsg: string, mode: string): string => {\r\n    if (mode === 'personal') {\r\n      return `I'm experiencing a connection issue, but let's use this as a learning opportunity! ðŸ¤” About \"${userMsg}\" - what do you already know or think about this topic? What questions does it raise for you?`;\r\n    }\r\n    \r\n    return `I'm having a temporary connection issue, but I can still guide your learning about \"${userMsg}\":\r\n\r\nðŸŽ¯ **Study Recommendations:**\r\n- Try active recall: test yourself without looking at answers\r\n- Use spaced repetition: review material at increasing intervals\r\n- Break complex topics into smaller, manageable chunks\r\n\r\nðŸ“š **Study Techniques:**\r\n- **Pomodoro Method**: 25-min focused sessions with 5-min breaks\r\n- **Feynman Technique**: Explain concepts in simple terms\r\n- **Active Learning**: Engage with material through questions and discussions\r\n\r\nðŸ’¡ **Next Steps:**\r\n- Create flashcards for key concepts\r\n- Practice with quiz sessions when available\r\n- Set up a regular study schedule\r\n\r\nWhat specific aspect would you like to focus on?`;\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      sendMessage(input);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    sendMessage(input);\r\n  };\r\n\r\n  const handleVoiceInput = (transcription: string) => {\r\n    if (transcription.trim()) {\r\n      setInput(transcription);\r\n      cleanup.setTimeout(() => sendMessage(transcription), 100);\r\n    }\r\n  };\r\n\r\n  const handleTTSToggle = () => {\r\n    if (isSpeaking) {\r\n      stop();\r\n    } else {\r\n      const lastAIMessage = messages.filter(m => m.role === 'assistant').pop();\r\n      if (lastAIMessage) {\r\n        speak(lastAIMessage.content);\r\n        setLastSpokenMessageId(lastAIMessage.id);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleAutoPlayToggle = () => {\r\n    const newAutoPlay = !autoPlayEnabled;\r\n    setAutoPlayEnabled(newAutoPlay);\r\n    safeLocalStorage.setItem('aistudycoach_voice_autoplay', newAutoPlay.toString());\r\n    \r\n    toast({\r\n      title: newAutoPlay ? \"Auto-play on\" : \"Auto-play off\",\r\n      duration: 1500\r\n    });\r\n  };\r\n\r\n  const [showSaveDialog, setShowSaveDialog] = useState(false);\r\n  const { saveCurrentChat } = useSavedCoachChats();\r\n\r\n  const handleClearChatClick = () => {\r\n    if (messages.length > 1) { // Only show dialog if there are actual messages (beyond welcome)\r\n      setShowSaveDialog(true);\r\n    } else {\r\n      handleClearChat();\r\n    }\r\n  };\r\n\r\n  const handleClearChat = () => {\r\n    clearAllMessages();\r\n    stop();\r\n    setLastSpokenMessageId(null);\r\n    // Reset conversation state\r\n    updateState({\r\n      promptType: 'initiate_session',\r\n      isInQuiz: false,\r\n      inRefresherMode: false,\r\n      lastAIQuestion: null,\r\n      currentTopic: null,\r\n      incorrectAnswersCount: 0,\r\n      teachingMethods: []\r\n    });\r\n    \r\n    toast({\r\n      title: \"Chat cleared\",\r\n      description: \"Starting fresh conversation\",\r\n      duration: 2000\r\n    });\r\n  };\r\n\r\n  const handleSaveAndClear = async (title?: string) => {\r\n    if (currentUser && messages.length > 0) {\r\n      await saveCurrentChat(messages, title);\r\n    }\r\n    handleClearChat();\r\n  };\r\n\r\n  // Generate suggested title for save dialog\r\n  const generateSuggestedTitle = () => {\r\n    const firstUserMessage = messages.find(m => m.role === 'user')?.content;\r\n    if (!firstUserMessage) return '';\r\n    \r\n    const words = firstUserMessage.split(' ').slice(0, 4).join(' ');\r\n    return words.length > 30 ? words.substring(0, 30) + '...' : words;\r\n  };\r\n\r\n  // Auto-play AI responses if enabled\r\n  useEffect(() => {\r\n    if (!autoPlayEnabled || !settings.enabled) return;\r\n    \r\n    const lastMessage = messages[messages.length - 1];\r\n    if (lastMessage && \r\n        lastMessage.role === 'assistant' && \r\n        lastMessage.id !== lastSpokenMessageId &&\r\n        !isLoading) {\r\n      \r\n      cleanup.setTimeout(() => {\r\n        speak(lastMessage.content);\r\n        setLastSpokenMessageId(lastMessage.id);\r\n      }, 500);\r\n    }\r\n  }, [messages, autoPlayEnabled, settings.enabled, lastSpokenMessageId, isLoading, speak]);\r\n\r\n  return (\r\n    <Card className={cn(\"w-full h-full flex flex-col bg-white/35 backdrop-blur-sm border-white/20\", fixedHeight ? \"h-full\" : \"min-h-[600px]\")}>\r\n      {showHeader && (\r\n        <CardHeader className=\"flex-shrink-0 pb-4\">\r\n          <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\r\n            <div className=\"flex items-center gap-2 flex-wrap\">\r\n              <Brain className=\"h-6 w-6 text-purple-600\" />\r\n              <h2 className=\"font-semibold text-lg\">AI Learning Coach</h2>\r\n              {(completedSessions?.length > 0 || flashcards?.length > 0) && (\r\n                <Badge variant=\"outline\" className=\"text-xs\">\r\n                  {completedSessions?.length || 0} Sessions â€¢ {flashcards?.length || 0} Cards\r\n                </Badge>\r\n              )}\r\n            </div>\r\n            \r\n            <div className=\"flex items-center gap-2 w-full sm:w-auto flex-wrap sm:flex-nowrap\">\r\n              <ChatModeToggle \r\n                mode={chatMode} \r\n                onModeChange={setChatMode}\r\n                className=\"scale-90 w-full sm:w-auto max-w-full min-w-0\"\r\n              />\r\n              \r\n              <div className=\"flex items-center gap-1\">\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={toggle}\r\n                  className={cn(\r\n                    \"h-8 w-8 p-0\",\r\n                    settings.enabled ? \"text-green-600 bg-green-50\" : \"text-gray-500\"\r\n                  )}\r\n                  title={settings.enabled ? \"Disable text-to-speech\" : \"Enable text-to-speech\"}\r\n                >\r\n                  {settings.enabled ? <Volume2 className=\"h-4 w-4\" /> : <VolumeX className=\"h-4 w-4\" />}\r\n                </Button>\r\n                \r\n                {isSpeaking && (\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    onClick={stop}\r\n                    className=\"h-8 w-8 p-0 text-red-600 bg-red-50\"\r\n                    title=\"Stop speaking\"\r\n                  >\r\n                    <VolumeX className=\"h-4 w-4\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n              \r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={handleClearChatClick}\r\n                title=\"Clear chat\"\r\n                className=\"h-8 w-8 p-0\"\r\n              >\r\n                <History className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n      )}\r\n\r\n      <CardContent className={cn(\"flex-1 flex flex-col overflow-hidden p-0\", fixedHeight ? \"min-h-0\" : \"\")}>\r\n        {/* Messages Area */}\r\n        <div \r\n          ref={messagesContainerRef}\r\n          className={cn(\r\n            \"flex-1 overflow-y-auto px-6 py-4 space-y-4\",\r\n            fixedHeight ? \"min-h-0\" : \"min-h-[400px] max-h-[400px]\"\r\n          )}\r\n        >\r\n          {/* Progress Message */}\r\n          {isLoading && progressMessage && (\r\n            <div className=\"flex gap-3 p-3 rounded-lg bg-blue-50 mr-8\">\r\n              <Bot className=\"h-5 w-5 text-blue-600 animate-pulse\" />\r\n              <div className=\"flex-1\">\r\n                <p className=\"text-sm text-blue-700\">{progressMessage}</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {messages.map((msg) => (\r\n            <div\r\n              key={msg.id}\r\n              className={cn(\r\n                \"flex gap-3 p-3 rounded-lg group\",\r\n                msg.role === 'user'\r\n                  ? \"bg-purple-50 ml-8\"\r\n                  : \"bg-gray-50 mr-8\"\r\n              )}\r\n            >\r\n              <div className=\"flex-shrink-0\">\r\n                {msg.role === 'user' ? (\r\n                  <User className=\"h-5 w-5 text-purple-600\" />\r\n                ) : (\r\n                  <Bot className=\"h-5 w-5 text-gray-600\" />\r\n                )}\r\n              </div>\r\n              <div className=\"flex-1 space-y-2\">\r\n                <p className=\"text-sm text-gray-900 whitespace-pre-wrap leading-relaxed\">\r\n                  {msg.content}\r\n                </p>\r\n                \r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-xs text-gray-500\">\r\n                    {new Date(msg.timestamp).toLocaleTimeString()}\r\n                  </span>\r\n                  \r\n                  {msg.role === 'assistant' && settings.enabled && (\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => {\r\n                        if (isSpeaking && lastSpokenMessageId === msg.id) {\r\n                          stop();\r\n                        } else {\r\n                          speak(msg.content);\r\n                          setLastSpokenMessageId(msg.id);\r\n                        }\r\n                      }}\r\n                      className=\"opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 p-0\"\r\n                      title=\"Speak this message\"\r\n                    >\r\n                      {isSpeaking && lastSpokenMessageId === msg.id ? (\r\n                        <VolumeX className=\"h-3 w-3\" />\r\n                      ) : (\r\n                        <Volume2 className=\"h-3 w-3\" />\r\n                      )}\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n          \r\n          {isLoading && (\r\n            <div className=\"flex gap-3 p-3 rounded-lg bg-gray-50 mr-8\">\r\n              <Bot className=\"h-5 w-5 text-gray-600\" />\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"flex space-x-1\">\r\n                  <div className=\"w-2 h-2 bg-purple-400 rounded-full animate-bounce\" style={{animationDelay: '0ms'}}></div>\r\n                  <div className=\"w-2 h-2 bg-purple-400 rounded-full animate-bounce\" style={{animationDelay: '150ms'}}></div>\r\n                  <div className=\"w-2 h-2 bg-purple-400 rounded-full animate-bounce\" style={{animationDelay: '300ms'}}></div>\r\n                </div>\r\n                <span className=\"text-sm text-gray-600\">AI is thinking...</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n\r\n        {/* Input Form */}\r\n        <div className=\"flex-shrink-0 p-6 border-t border-border\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-3\">\r\n            <div className=\"flex gap-2\">\r\n              <Input\r\n                ref={inputRef}\r\n                value={input}\r\n                onChange={(e) => setInput(e.target.value)}\r\n                onKeyDown={handleKeyPress}\r\n                placeholder={placeholder}\r\n                disabled={isLoading}\r\n                className=\"flex-1\"\r\n              />\r\n              <VoiceInputButton\r\n                onTranscription={handleVoiceInput}\r\n                disabled={isLoading}\r\n              />\r\n              \r\n              {/* Cancel button when loading */}\r\n              {isLoading && (\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => {\r\n                    if (abortControllerRef.current) {\r\n                      abortControllerRef.current.abort();\r\n                      setIsLoading(false);\r\n                      setProgressMessage(null);\r\n                      toast({\r\n                        title: \"Request cancelled\",\r\n                        description: \"You can try asking again\",\r\n                        duration: 2000\r\n                      });\r\n                    }\r\n                  }}\r\n                  className=\"px-3 text-red-600 border-red-300 hover:bg-red-50\"\r\n                >\r\n                  Cancel\r\n                </Button>\r\n              )}\r\n              \r\n              <Button \r\n                type=\"submit\" \r\n                disabled={isLoading || !input.trim()}\r\n                size=\"icon\"\r\n              >\r\n                {isLoading ? (\r\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\" />\r\n                ) : (\r\n                  <Send className=\"h-4 w-4\" />\r\n                )}\r\n              </Button>\r\n            </div>\r\n            \r\n            {/* Progress indicator */}\r\n            {isLoading && (\r\n              <div className=\"text-xs text-gray-500\">\r\n                {progressMessage || \"Processing your request...\"}\r\n              </div>\r\n            )}\r\n          </form>\r\n        </div>\r\n      </CardContent>\r\n\r\n      {/* Save Before Clear Dialog */}\r\n      <SaveBeforeClearDialog\r\n        isOpen={showSaveDialog}\r\n        onClose={() => setShowSaveDialog(false)}\r\n        onSaveAndClear={handleSaveAndClear}\r\n        onClearWithoutSaving={handleClearChat}\r\n        messageCount={messages.length}\r\n        suggestedTitle={generateSuggestedTitle()}\r\n      />\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default AIStudyChatInterface;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\chat\\ChatMessagesPane.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cleanup' and 'messagesEndRef'. Either include them or remove the dependency array.","line":102,"column":6,"nodeType":"ArrayExpression","endLine":102,"endColumn":39,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, messages.length, messagesEndRef, scrollToBottom]","fix":{"range":[3526,3559],"text":"[cleanup, messages.length, messagesEndRef, scrollToBottom]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cleanup' and 'messagesEndRef'. Either include them or remove the dependency array.","line":117,"column":6,"nodeType":"ArrayExpression","endLine":117,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [isSending, isLoading, scrollToBottom, messagesEndRef, cleanup]","fix":{"range":[4054,4092],"text":"[isSending, isLoading, scrollToBottom, messagesEndRef, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useEffect, useCallback, useRef } from 'react';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Brain, Volume2, VolumeX, User, Bot, Trash2 } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { useTextToSpeech } from '@/hooks/useTextToSpeech';\r\nimport { useVoiceSettings } from '@/contexts/VoiceSettingsContext';\r\nimport { useTextSelection } from '@/hooks/useTextSelection';\r\nimport { featureFlagService } from '@/services/FeatureFlagService';\r\nimport SaveToNotesButton from '@/components/ai-coach/SaveToNotesButton';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface ChatMessage {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\ninterface ChatMessagesPaneProps {\r\n  messages: ChatMessage[];\r\n  isLoading: boolean;\r\n  isSending: boolean;\r\n  messagesEndRef: React.RefObject<HTMLDivElement>;\r\n  isWidget?: boolean;\r\n  onDeleteMessage?: (messageId: string) => void;\r\n  showDeleteButtons?: boolean;\r\n  fixedHeight?: boolean;\r\n}\r\n\r\nconst ChatMessagesPane = ({ \r\n  messages, \r\n  isLoading, \r\n  isSending, \r\n  messagesEndRef,\r\n  isWidget = false,\r\n  onDeleteMessage,\r\n  showDeleteButtons = false,\r\n  fixedHeight = false\r\n}: ChatMessagesPaneProps) => {\r\n  const cleanup = useCleanup('ChatMessagesPane');\r\n  const { speak, stop, isSpeaking, isSupported: ttsSupported } = useTextToSpeech();\r\n  const { settings } = useVoiceSettings();\r\n  const voicePlayButtonEnabled = featureFlagService.isEnabled('voicePlayButton');\r\n\r\n  // Text selection for the entire messages container\r\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\r\n  const { selectedText, hasSelection, clearSelection } = useTextSelection(messagesContainerRef);\r\n\r\n  const formatTime = (timestamp: string) => {\r\n    return new Date(timestamp).toLocaleTimeString([], { \r\n      hour: '2-digit', \r\n      minute: '2-digit' \r\n    });\r\n  };\r\n\r\n  const handleSpeakMessage = (content: string) => {\r\n    if (ttsSupported && settings.enabled) {\r\n      speak(content, { interrupt: true });\r\n    }\r\n  };\r\n\r\n  const handlePlayVoice = useCallback((messageId: string, content: string) => {\r\n    if (ttsSupported) {\r\n      // Stop any current speech\r\n      stop();\r\n      // Start speaking the specific message\r\n      speak(content, { interrupt: true });\r\n    }\r\n  }, [speak, stop, ttsSupported]);\r\n\r\n  // Improved auto-scroll logic that respects user scroll position\r\n  const scrollToBottom = useCallback(() => {\r\n    if (messagesEndRef.current) {\r\n      // Use requestAnimationFrame to ensure DOM has updated\r\n      requestAnimationFrame(() => {\r\n        messagesEndRef.current?.scrollIntoView({ \r\n          behavior: 'smooth',\r\n          block: 'end',\r\n          inline: 'nearest'\r\n        });\r\n      });\r\n    }\r\n  }, [messagesEndRef]);\r\n\r\n  // Only auto-scroll when new messages arrive and user is near bottom\r\n  useEffect(() => {\r\n    if (messages.length > 0) {\r\n      // Check if user is near the bottom before auto-scrolling\r\n      const scrollArea = messagesEndRef.current?.parentElement?.parentElement;\r\n      if (scrollArea) {\r\n        const { scrollTop, scrollHeight, clientHeight } = scrollArea;\r\n        const isNearBottom = scrollHeight - scrollTop - clientHeight < 100;\r\n        \r\n        // Only auto-scroll if user is near bottom or this is the first message\r\n        if (isNearBottom || messages.length === 1) {\r\n          cleanup.setTimeout(scrollToBottom, 100);\r\n        }\r\n      }\r\n    }\r\n  }, [messages.length, scrollToBottom]);\r\n\r\n  // Auto-scroll for loading states only if user is at bottom\r\n  useEffect(() => {\r\n    if (isSending || isLoading) {\r\n      const scrollArea = messagesEndRef.current?.parentElement?.parentElement;\r\n      if (scrollArea) {\r\n        const { scrollTop, scrollHeight, clientHeight } = scrollArea;\r\n        const isAtBottom = scrollHeight - scrollTop - clientHeight < 50;\r\n        \r\n        if (isAtBottom) {\r\n          cleanup.setTimeout(scrollToBottom, 50);\r\n        }\r\n      }\r\n    }\r\n  }, [isSending, isLoading, scrollToBottom]);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex-1 flex items-center justify-center p-4\">\r\n        <div className=\"text-center text-muted-foreground\">\r\n          <div className=\"animate-spin w-6 h-6 border border-purple-600 border-t-transparent rounded-full mx-auto mb-2\"></div>\r\n          <p className=\"text-sm\">Loading messages...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (messages.length === 0) {\r\n    return (\r\n      <div className=\"flex-1 flex items-center justify-center p-4 sm:p-6 lg:p-8\">\r\n        <div className=\"text-center max-w-md\">\r\n          <div className=\"w-12 h-12 sm:w-16 sm:h-16 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4\">\r\n            <Brain className=\"h-6 w-6 sm:h-8 sm:w-8 text-white\" />\r\n          </div>\r\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\r\n            {isWidget ? 'Quick Chat Assistant' : 'Welcome to AI Learning Coach'}\r\n          </h3>\r\n          <p className=\"text-muted-foreground text-xs sm:text-sm break-words leading-relaxed\">\r\n            {isWidget \r\n              ? \"I'm here for quick questions and assistance. How can I help you today?\"\r\n              : \"I'm here to help you with your studies, provide learning strategies, and answer questions about the platform. How can I assist you today?\"\r\n            }\r\n          </p>\r\n          {settings.enabled && (\r\n            <p className=\"text-purple-600 text-xs mt-2 break-words\">\r\n              ðŸ”Š Voice responses are enabled - I'll read my replies aloud!\r\n            </p>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ScrollArea className={cn(\r\n      \"p-2 sm:p-3 md:p-4\",\r\n      fixedHeight ? \"h-full\" : \"flex-1\"\r\n    )}>\r\n      <div ref={messagesContainerRef} className=\"space-y-2 sm:space-y-3 md:space-y-4\">\r\n        {messages.map((message) => {\r\n          // Find the corresponding user question for context\r\n          const messageIndex = messages.findIndex(msg => msg.id === message.id);\r\n          const previousMessage = messageIndex > 0 ? messages[messageIndex - 1] : null;\r\n          const originalQuestion = previousMessage?.role === 'user' ? previousMessage.content : undefined;\r\n\r\n          return (\r\n            <div \r\n              key={message.id} \r\n              className={cn(\r\n                \"flex gap-3 group\",\r\n                message.role === 'user' ? \"justify-end\" : \"justify-start\"\r\n              )}\r\n            >\r\n              {message.role === 'assistant' && (\r\n                <div className=\"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0\">\r\n                  <Bot className=\"h-4 w-4 text-purple-600\" />\r\n                </div>\r\n              )}\r\n              \r\n              <div className={cn(\r\n                \"rounded-lg p-2 sm:p-3 max-w-[85%] sm:max-w-[75%] relative safe-text\",\r\n                message.role === 'user' \r\n                  ? \"bg-gradient-to-r from-purple-600 to-pink-600 text-white ml-auto\" \r\n                  : \"bg-muted/50 border text-foreground mr-auto\"\r\n              )}>\r\n                {message.role === 'assistant' && (\r\n                  <div className=\"flex items-center gap-1 sm:gap-2 mb-1 sm:mb-2 flex-wrap\">\r\n                    <Brain className=\"h-3 w-3 sm:h-4 sm:w-4 text-purple-600 flex-shrink-0\" />\r\n                    <span className=\"text-xs font-medium text-purple-600 truncate\">\r\n                      {isWidget ? 'Assistant' : 'AI Coach'}\r\n                    </span>\r\n                    \r\n                    {/* Action buttons for AI messages */}\r\n                    <div className=\"flex items-center gap-1 ml-auto\">\r\n                      {/* Voice Play Button - Feature Flagged */}\r\n                      {voicePlayButtonEnabled && ttsSupported && message.role === 'assistant' && (\r\n                        <Button\r\n                          size=\"icon\"\r\n                          variant=\"ghost\"\r\n                          className=\"h-4 w-4 sm:h-5 sm:w-5 opacity-0 group-hover:opacity-100 transition-opacity touch-target p-0\"\r\n                          onClick={() => handlePlayVoice(message.id, message.content)}\r\n                          aria-label=\"Play voice response\"\r\n                          title=\"Play voice response\"\r\n                        >\r\n                          {isSpeaking ? (\r\n                            <VolumeX className=\"h-2 w-2 sm:h-3 sm:w-3\" />\r\n                          ) : (\r\n                            <Volume2 className=\"h-2 w-2 sm:h-3 sm:w-3\" />\r\n                          )}\r\n                        </Button>\r\n                      )}\r\n\r\n                      {/* Legacy TTS button when feature flag is disabled */}\r\n                      {!voicePlayButtonEnabled && ttsSupported && settings.enabled && (\r\n                        <Button\r\n                          size=\"icon\"\r\n                          variant=\"ghost\"\r\n                          className=\"h-4 w-4 sm:h-5 sm:w-5 opacity-0 group-hover:opacity-100 transition-opacity touch-target\"\r\n                          onClick={() => handleSpeakMessage(message.content)}\r\n                          title=\"Read aloud\"\r\n                        >\r\n                          <Volume2 className=\"h-2 w-2 sm:h-3 sm:w-3\" />\r\n                        </Button>\r\n                      )}\r\n                      \r\n                      {/* Save to Notes button - only for non-widget */}\r\n                      {!isWidget && (\r\n                        <SaveToNotesButton\r\n                          content={message.content}\r\n                          selectedText={hasSelection ? selectedText : undefined}\r\n                          originalQuestion={originalQuestion}\r\n                          aiMode=\"AI Learning Coach\"\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          className=\"h-4 w-4 sm:h-5 sm:w-5 opacity-0 group-hover:opacity-100 transition-opacity touch-target p-0\"\r\n                        />\r\n                      )}\r\n\r\n                      {/* Delete button for widget messages */}\r\n                      {showDeleteButtons && onDeleteMessage && (\r\n                        <Button\r\n                          size=\"icon\"\r\n                          variant=\"ghost\"\r\n                          className=\"h-4 w-4 sm:h-5 sm:w-5 opacity-0 group-hover:opacity-100 transition-opacity touch-target p-0 text-red-500 hover:text-red-700\"\r\n                          onClick={() => onDeleteMessage(message.id)}\r\n                          aria-label=\"Delete message\"\r\n                          title=\"Delete message\"\r\n                        >\r\n                          <Trash2 className=\"h-2 w-2 sm:h-3 sm:w-3\" />\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                {/* User message delete button */}\r\n                {showDeleteButtons && onDeleteMessage && message.role === 'user' && (\r\n                  <Button\r\n                    size=\"icon\"\r\n                    variant=\"ghost\"\r\n                    className=\"absolute top-1 right-1 h-4 w-4 opacity-0 group-hover:opacity-100 transition-opacity touch-target p-0 text-white/70 hover:text-white\"\r\n                    onClick={() => onDeleteMessage(message.id)}\r\n                    aria-label=\"Delete message\"\r\n                    title=\"Delete message\"\r\n                  >\r\n                    <Trash2 className=\"h-2 w-2 sm:h-3 sm:w-3\" />\r\n                  </Button>\r\n                )}\r\n                \r\n                <div className=\"break-words leading-relaxed\">\r\n                  {message.content}\r\n                </div>\r\n                \r\n                <div className={cn(\r\n                  \"text-xs mt-1 sm:mt-2 opacity-70\",\r\n                  message.role === 'user' ? 'text-right' : 'text-left'\r\n                )}>\r\n                  {formatTime(message.timestamp)}\r\n                </div>\r\n              </div>\r\n              \r\n              {message.role === 'user' && (\r\n                <div className=\"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center flex-shrink-0\">\r\n                  <User className=\"h-4 w-4 text-white\" />\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n        \r\n        {isSending && (\r\n          <div className=\"flex justify-start\">\r\n            <div className=\"bg-muted text-foreground p-2 sm:p-3 rounded-lg max-w-[90%] sm:max-w-[85%] md:max-w-[80%]\">\r\n              <div className=\"flex items-center gap-1 sm:gap-2 mb-1 sm:mb-2\">\r\n                <Brain className=\"h-3 w-3 sm:h-4 sm:w-4 text-purple-600\" />\r\n                <span className=\"text-xs font-medium text-purple-600\">\r\n                  {isWidget ? 'Assistant' : 'AI Coach'}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"animate-pulse flex space-x-1\">\r\n                  <div className=\"w-1.5 h-1.5 bg-purple-600 rounded-full animate-bounce\"></div>\r\n                  <div className=\"w-1.5 h-1.5 bg-purple-600 rounded-full animate-bounce\" style={{animationDelay: '0.1s'}}></div>\r\n                  <div className=\"w-1.5 h-1.5 bg-purple-600 rounded-full animate-bounce\" style={{animationDelay: '0.2s'}}></div>\r\n                </div>\r\n                <span className=\"text-xs text-muted-foreground\">Thinking...</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n    </ScrollArea>\r\n  );\r\n};\r\n\r\nexport default ChatMessagesPane;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\chat\\ChatSessionsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\chat\\ChatSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\common\\ErrorBoundary.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1181,1184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1181,1184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { AlertCircle, RefreshCw } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { NavigationButton } from '@/components/common/NavigationButton';\r\n\r\ninterface ErrorBoundaryState {\r\n  hasError: boolean;\r\n  error?: Error;\r\n  errorInfo?: React.ErrorInfo;\r\n}\r\n\r\ninterface ErrorBoundaryProps {\r\n  children: React.ReactNode;\r\n  fallback?: React.ComponentType<{ error: Error; retry: () => void }>;\r\n}\r\n\r\nexport class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\r\n  constructor(props: ErrorBoundaryProps) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\r\n    return {\r\n      hasError: true,\r\n      error\r\n    };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n    console.error('ðŸš¨ ErrorBoundary caught an error:', error, errorInfo);\r\n    \r\n    this.setState({\r\n      error,\r\n      errorInfo\r\n    });\r\n\r\n    // Track error for debugging\r\n    if (typeof window !== 'undefined') {\r\n      (window as any).__LOVABLE_ERROR__ = { error, errorInfo, timestamp: new Date().toISOString() };\r\n    }\r\n  }\r\n\r\n  handleRetry = () => {\r\n    this.setState({ hasError: false, error: undefined, errorInfo: undefined });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      if (this.props.fallback) {\r\n        const FallbackComponent = this.props.fallback;\r\n        return <FallbackComponent error={this.state.error!} retry={this.handleRetry} />;\r\n      }\r\n\r\n      return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\r\n          <Card className=\"max-w-md w-full\">\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2 text-destructive\">\r\n                <AlertCircle className=\"w-5 h-5\" />\r\n                Something went wrong\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <p className=\"text-muted-foreground\">\r\n                The course encountered an unexpected error. This might be due to a temporary issue.\r\n              </p>\r\n              \r\n              {this.state.error && (\r\n                <details className=\"text-xs bg-muted p-2 rounded\">\r\n                  <summary className=\"cursor-pointer font-medium\">Error Details</summary>\r\n                  <pre className=\"mt-2 overflow-auto\">\r\n                    {this.state.error.message}\r\n                  </pre>\r\n                </details>\r\n              )}\r\n\r\n              <div className=\"flex gap-2\">\r\n                <Button onClick={this.handleRetry} className=\"flex-1\">\r\n                  <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n                  Try Again\r\n                </Button>\r\n                <NavigationButton \r\n                  to=\"/dashboard/learner/courses\"\r\n                  variant=\"outline\" \r\n                  className=\"flex-1\"\r\n                >\r\n                  Back to Courses\r\n                </NavigationButton>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\n// Functional fallback component for specific errors\r\nexport const CourseFallback: React.FC<{ error: Error; retry: () => void }> = ({ error, retry }) => (\r\n  <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\r\n    <Card className=\"max-w-lg w-full\">\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2 text-destructive\">\r\n          <AlertCircle className=\"w-5 h-5\" />\r\n          Course Loading Error\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        <p className=\"text-muted-foreground\">\r\n          The course failed to load properly. This could be due to:\r\n        </p>\r\n        <ul className=\"text-sm text-muted-foreground list-disc list-inside space-y-1\">\r\n          <li>Network connectivity issues</li>\r\n          <li>Temporary server problems</li>\r\n          <li>Browser compatibility issues</li>\r\n        </ul>\r\n        \r\n        <div className=\"flex gap-2\">\r\n          <Button onClick={retry} className=\"flex-1\">\r\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n            Retry Loading\r\n          </Button>\r\n          <Button \r\n            variant=\"outline\" \r\n            onClick={() => window.location.reload()}\r\n            className=\"flex-1\"\r\n          >\r\n            Refresh Page\r\n          </Button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  </div>\r\n);","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\common\\FirstVisitVideoModal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":41,"column":6,"nodeType":"ArrayExpression","endLine":41,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, isOpen, onClose]","fix":{"range":[1151,1168],"text":"[cleanup, isOpen, onClose]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from 'react';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport DOMPurify from 'isomorphic-dompurify';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { HelpCircle } from 'lucide-react';\r\n\r\ninterface FirstVisitVideoModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  title: string;\r\n  videoUrl?: string;\r\n  contentHtml?: string;\r\n}\r\n\r\nexport function FirstVisitVideoModal({ isOpen, onClose, title, videoUrl, contentHtml }: FirstVisitVideoModalProps) {\r\n  const cleanup = useCleanup('FirstVisitVideoModal');\r\n  \r\n  // Handle ESC key press\r\n  useEffect(() => {\r\n    const handleEscapeKey = (event: KeyboardEvent) => {\r\n      if (event.key === 'Escape' && isOpen) {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      cleanup.addEventListener(document, 'keydown', handleEscapeKey);\r\n      // Prevent body scroll when modal is open\r\n      document.body.style.overflow = 'hidden';\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleEscapeKey);\r\n      document.body.style.overflow = 'unset';\r\n    };\r\n  }, [isOpen, onClose]);\r\n\r\n  const handleOverlayClick = (e: React.MouseEvent) => {\r\n    // Close modal when clicking on the overlay (outside the video)\r\n    if (e.target === e.currentTarget) {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const handleVideoClick = (e: React.MouseEvent) => {\r\n    // Prevent modal from closing when clicking on the video itself\r\n    e.stopPropagation();\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onClose}>\r\n      <DialogContent \r\n        className=\"helpModal helpModal-top max-w-[min(1100px,90vw)] w-full border-0 p-4 bg-white rounded-2xl shadow-[0_10px_30px_rgba(0,0,0,0.25)]\"\r\n        onClick={handleOverlayClick}\r\n      >\r\n        <DialogHeader className=\"p-0 mb-3\">\r\n          <DialogTitle className=\"modalTitle flex items-center justify-center gap-2 text-xl font-semibold text-center\">\r\n            <HelpCircle className=\"h-5 w-5 text-primary\" />\r\n            {title}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        <div className=\"video-modal-content p-0\">\r\n          {videoUrl ? (\r\n            <div className=\"videoWrap mb-3\">\r\n              <iframe \r\n                src={videoUrl}\r\n                title=\"YouTube video player\" \r\n                frameBorder=\"0\" \r\n                allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" \r\n                referrerPolicy=\"strict-origin-when-cross-origin\" \r\n                allowFullScreen\r\n                onClick={handleVideoClick}\r\n              />\r\n            </div>\r\n          ) : contentHtml ? (\r\n            <div\r\n              className=\"w-full\"\r\n              dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(contentHtml) }}\r\n              onClick={handleVideoClick}\r\n            />\r\n          ) : null}\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\common\\NavigationButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\common\\PageHelpTrigger.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\common\\StyledCourseCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\common\\SystemHealthIndicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\common\\UIPolishProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\AdminComplianceCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\ComplianceDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadComplianceData'. Either include it or remove the dependency array.","line":58,"column":6,"nodeType":"ArrayExpression","endLine":58,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadComplianceData]","fix":{"range":[1551,1553],"text":"[loadComplianceData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { \r\n  Shield, \r\n  Users, \r\n  FileText, \r\n  AlertTriangle, \r\n  CheckCircle, \r\n  Clock, \r\n  Database,\r\n  Download,\r\n  Trash2\r\n} from 'lucide-react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface ComplianceMetrics {\r\n  totalUsers: number;\r\n  activeConsents: number;\r\n  withdrawnConsents: number;\r\n  pendingRequests: number;\r\n  completedRequests: number;\r\n  overdue: number;\r\n  recentBreaches: number;\r\n}\r\n\r\ninterface DataSubjectRequest {\r\n  id: string;\r\n  request_type: string;\r\n  status: string;\r\n  description: string;\r\n  due_date: string;\r\n  created_at: string;\r\n  user_id: string;\r\n}\r\n\r\nexport function ComplianceDashboard() {\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const [metrics, setMetrics] = useState<ComplianceMetrics>({\r\n    totalUsers: 0,\r\n    activeConsents: 0,\r\n    withdrawnConsents: 0,\r\n    pendingRequests: 0,\r\n    completedRequests: 0,\r\n    overdue: 0,\r\n    recentBreaches: 0\r\n  });\r\n  const [requests, setRequests] = useState<DataSubjectRequest[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadComplianceData();\r\n  }, []);\r\n\r\n  const loadComplianceData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Load compliance metrics\r\n      const [\r\n        { count: totalUsers },\r\n        { count: activeConsents },\r\n        { count: withdrawnConsents },\r\n        { count: pendingRequests },\r\n        { count: completedRequests },\r\n        { count: overdueRequests },\r\n        { count: recentBreaches },\r\n        { data: requestsData }\r\n      ] = await Promise.all([\r\n        supabase.from('profiles').select('*', { count: 'exact', head: true }),\r\n        supabase.from('user_consent').select('*', { count: 'exact', head: true }).eq('is_granted', true).is('withdrawn_at', null),\r\n        supabase.from('user_consent').select('*', { count: 'exact', head: true }).not('withdrawn_at', 'is', null),\r\n        supabase.from('data_subject_requests').select('*', { count: 'exact', head: true }).eq('status', 'pending'),\r\n        supabase.from('data_subject_requests').select('*', { count: 'exact', head: true }).eq('status', 'completed'),\r\n        supabase.from('data_subject_requests').select('*', { count: 'exact', head: true }).lt('due_date', new Date().toISOString()).neq('status', 'completed'),\r\n        supabase.from('data_breach_incidents').select('*', { count: 'exact', head: true }).gte('created_at', new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString()),\r\n        supabase.from('data_subject_requests').select('*').order('created_at', { ascending: false }).limit(10)\r\n      ]);\r\n\r\n      setMetrics({\r\n        totalUsers: totalUsers || 0,\r\n        activeConsents: activeConsents || 0,\r\n        withdrawnConsents: withdrawnConsents || 0,\r\n        pendingRequests: pendingRequests || 0,\r\n        completedRequests: completedRequests || 0,\r\n        overdue: overdueRequests || 0,\r\n        recentBreaches: recentBreaches || 0\r\n      });\r\n\r\n      setRequests(requestsData || []);\r\n    } catch (error) {\r\n      console.error('Error loading compliance data:', error);\r\n      toast({\r\n        title: \"Error loading data\",\r\n        description: \"Failed to load compliance dashboard data.\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const runDataCleanup = async () => {\r\n    try {\r\n      const { data, error } = await supabase.rpc('cleanup_expired_data');\r\n      \r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"Data cleanup completed\",\r\n        description: `Cleaned up data from ${data?.length || 0} tables.`,\r\n      });\r\n\r\n      loadComplianceData(); // Refresh metrics\r\n    } catch (error) {\r\n      console.error('Error running cleanup:', error);\r\n      toast({\r\n        title: \"Cleanup failed\",\r\n        description: \"Failed to run data cleanup.\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'completed': return 'bg-green-100 text-green-800';\r\n      case 'pending': return 'bg-yellow-100 text-yellow-800';\r\n      case 'in_progress': return 'bg-blue-100 text-blue-800';\r\n      case 'rejected': return 'bg-red-100 text-red-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getRequestTypeIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'access': return <FileText className=\"h-4 w-4\" />;\r\n      case 'erasure': return <Trash2 className=\"h-4 w-4\" />;\r\n      case 'portability': return <Download className=\"h-4 w-4\" />;\r\n      default: return <Shield className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-8\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold\">Compliance Dashboard</h2>\r\n          <p className=\"text-muted-foreground\">Monitor GDPR compliance and data governance</p>\r\n        </div>\r\n        <Button onClick={runDataCleanup} variant=\"outline\">\r\n          <Database className=\"mr-2 h-4 w-4\" />\r\n          Run Data Cleanup\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Compliance Metrics */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Users</CardTitle>\r\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{metrics.totalUsers}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Registered users</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Active Consents</CardTitle>\r\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{metrics.activeConsents}</div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {metrics.withdrawnConsents} withdrawn\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Pending Requests</CardTitle>\r\n            <Clock className=\"h-4 w-4 text-yellow-600\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{metrics.pendingRequests}</div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {metrics.overdue} overdue\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Security Status</CardTitle>\r\n            <AlertTriangle className={`h-4 w-4 ${metrics.recentBreaches > 0 ? 'text-red-600' : 'text-green-600'}`} />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{metrics.recentBreaches}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Breaches (30 days)</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Tabs defaultValue=\"requests\" className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"requests\">Data Subject Requests</TabsTrigger>\r\n          <TabsTrigger value=\"processing\">Processing Activities</TabsTrigger>\r\n          <TabsTrigger value=\"retention\">Data Retention</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"requests\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Recent Data Subject Requests</CardTitle>\r\n              <CardDescription>\r\n                GDPR requests from users (Articles 15-22)\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {requests.length === 0 ? (\r\n                  <p className=\"text-muted-foreground text-center py-4\">No recent requests</p>\r\n                ) : (\r\n                  requests.map((request) => (\r\n                    <div key={request.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        {getRequestTypeIcon(request.request_type)}\r\n                        <div>\r\n                          <p className=\"font-medium\">{request.request_type.charAt(0).toUpperCase() + request.request_type.slice(1)} Request</p>\r\n                          <p className=\"text-sm text-muted-foreground\">{request.description || 'No description'}</p>\r\n                          <p className=\"text-xs text-muted-foreground\">\r\n                            Due: {new Date(request.due_date).toLocaleDateString()}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <Badge className={getStatusColor(request.status)}>\r\n                        {request.status}\r\n                      </Badge>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"processing\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Data Processing Activities</CardTitle>\r\n              <CardDescription>\r\n                Legal basis documentation (GDPR Article 30)\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-center py-8 text-muted-foreground\">\r\n                Processing activities management coming soon...\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"retention\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Data Retention Policies</CardTitle>\r\n              <CardDescription>\r\n                Automated data cleanup and retention management\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-center py-8 text-muted-foreground\">\r\n                Retention policy management coming soon...\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\ComplianceTrainingCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\ConsentManagementCenter.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadConsentHistory'. Either include it or remove the dependency array.","line":34,"column":6,"nodeType":"ArrayExpression","endLine":34,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [loadConsentHistory, user]","fix":{"range":[1193,1199],"text":"[loadConsentHistory, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useConsent } from '@/hooks/useConsent';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { Shield, AlertTriangle, CheckCircle, Clock, X } from 'lucide-react';\r\n\r\ninterface ConsentRecord {\r\n  id: string;\r\n  consent_type: string;\r\n  is_granted: boolean;\r\n  granted_at: string | null;\r\n  withdrawn_at: string | null;\r\n  legal_basis: string;\r\n  purpose: string;\r\n  created_at: string;\r\n}\r\n\r\nexport function ConsentManagementCenter() {\r\n  const { user } = useAuth();\r\n  const { preferences, withdrawConsent, updateConsent } = useConsent();\r\n  const { toast } = useToast();\r\n  const [consentHistory, setConsentHistory] = useState<ConsentRecord[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadConsentHistory();\r\n    }\r\n  }, [user]);\r\n\r\n  const loadConsentHistory = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('user_consent')\r\n        .select('*')\r\n        .eq('user_id', user?.id)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      setConsentHistory(data || []);\r\n    } catch (error) {\r\n      console.error('Error loading consent history:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleWithdraw = async (consentType: keyof typeof preferences) => {\r\n    try {\r\n      await withdrawConsent(consentType);\r\n      await loadConsentHistory(); // Refresh history\r\n      toast({\r\n        title: \"Consent withdrawn\",\r\n        description: `Your ${consentType} consent has been withdrawn and related data cleaned up.`,\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to withdraw consent. Please try again.\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const getConsentIcon = (granted: boolean, withdrawn: boolean) => {\r\n    if (withdrawn) return <X className=\"h-4 w-4 text-red-600\" />;\r\n    if (granted) return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\r\n    return <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />;\r\n  };\r\n\r\n  const getConsentStatus = (granted: boolean, withdrawn: boolean) => {\r\n    if (withdrawn) return { label: 'Withdrawn', color: 'bg-red-100 text-red-800' };\r\n    if (granted) return { label: 'Active', color: 'bg-green-100 text-green-800' };\r\n    return { label: 'Denied', color: 'bg-yellow-100 text-yellow-800' };\r\n  };\r\n\r\n  const calculateComplianceScore = () => {\r\n    const totalConsents = Object.keys(preferences).length;\r\n    const activeConsents = Object.values(preferences).filter(Boolean).length;\r\n    return Math.round((activeConsents / totalConsents) * 100);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-8\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const complianceScore = calculateComplianceScore();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold mb-2\">Consent Management Center</h2>\r\n        <p className=\"text-muted-foreground\">\r\n          Manage your privacy preferences and view your consent history\r\n        </p>\r\n      </div>\r\n\r\n      {/* Compliance Overview */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Shield className=\"h-5 w-5\" />\r\n            Privacy Compliance Overview\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Your current privacy settings and compliance status\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-sm font-medium\">Consent Coverage</span>\r\n              <span className=\"text-sm text-muted-foreground\">{complianceScore}%</span>\r\n            </div>\r\n            <Progress value={complianceScore} className=\"h-2\" />\r\n          </div>\r\n          \r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n            {Object.entries(preferences).map(([type, granted]) => (\r\n              <div key={type} className=\"text-center\">\r\n                <div className=\"flex items-center justify-center mb-1\">\r\n                  {getConsentIcon(granted, false)}\r\n                </div>\r\n                <p className=\"text-xs font-medium capitalize\">{type}</p>\r\n                <Badge \r\n                  variant=\"secondary\" \r\n                  className={`text-xs ${getConsentStatus(granted, false).color}`}\r\n                >\r\n                  {getConsentStatus(granted, false).label}\r\n                </Badge>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Current Consent Settings */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Current Consent Settings</CardTitle>\r\n          <CardDescription>\r\n            Manage your current privacy preferences\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {Object.entries(preferences).map(([type, granted]) => (\r\n            <div key={type} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n              <div className=\"flex items-center gap-3\">\r\n                {getConsentIcon(granted, false)}\r\n                <div>\r\n                  <p className=\"font-medium capitalize\">{type} Cookies</p>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {granted ? 'You have granted consent' : 'Consent not granted'}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Badge className={getConsentStatus(granted, false).color}>\r\n                  {getConsentStatus(granted, false).label}\r\n                </Badge>\r\n                {granted && type !== 'essential' && (\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    size=\"sm\"\r\n                    onClick={() => handleWithdraw(type as keyof typeof preferences)}\r\n                  >\r\n                    Withdraw\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Consent History */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Consent History</CardTitle>\r\n          <CardDescription>\r\n            Complete audit trail of your consent decisions\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-3\">\r\n            {consentHistory.length === 0 ? (\r\n              <p className=\"text-muted-foreground text-center py-4\">No consent history available</p>\r\n            ) : (\r\n              consentHistory.slice(0, 10).map((record) => (\r\n                <div key={record.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    {getConsentIcon(record.is_granted, !!record.withdrawn_at)}\r\n                    <div>\r\n                      <p className=\"font-medium capitalize\">{record.consent_type} Consent</p>\r\n                      <p className=\"text-sm text-muted-foreground\">{record.purpose}</p>\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {record.withdrawn_at \r\n                          ? `Withdrawn: ${new Date(record.withdrawn_at).toLocaleString()}`\r\n                          : `Granted: ${new Date(record.granted_at || record.created_at).toLocaleString()}`\r\n                        }\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <Badge className={getConsentStatus(record.is_granted, !!record.withdrawn_at).color}>\r\n                      {getConsentStatus(record.is_granted, !!record.withdrawn_at).label}\r\n                    </Badge>\r\n                    <p className=\"text-xs text-muted-foreground mt-1\">\r\n                      {record.legal_basis}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\ConsentManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\DataRetentionNotice.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\DataSubjectRequestForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\HIPAAAccessControl.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\compliance\\SecurityIncidentManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CourseAIStudyCoach.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CourseHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CourseOutline.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CourseOverview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CourseOverviewTTS.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CourseOverviewVideo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CoursePlayer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":115,"column":6,"nodeType":"ArrayExpression","endLine":115,"endColumn":73,"suggestions":[{"desc":"Update the dependencies array to be: [updateProgress, user.id, currentProgress, onProgress, onComplete, cleanup]","fix":{"range":[4174,4241],"text":"[updateProgress, user.id, currentProgress, onProgress, onComplete, cleanup]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":163,"column":6,"nodeType":"ArrayExpression","endLine":163,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, currentProgress, isLoading, cleanup]","fix":{"range":[6000,6038],"text":"[user.id, currentProgress, isLoading, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useRef, useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useProgressTracking } from '@/hooks/useProgressTracking';\r\nimport { useAnalytics } from '@/hooks/useAnalytics';\r\nimport { useLanguageConsistency } from '@/hooks/useLanguageConsistency';\r\nimport { iframeAnalytics } from '@/utils/iframeAnalytics';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport { logger } from '@/utils/logger';\r\n\r\nimport { Loader2 } from 'lucide-react';\r\n\r\ninterface CoursePlayerProps {\r\n  onProgress?: (progress: number) => void;\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst CoursePlayer: React.FC<CoursePlayerProps> = ({ onProgress, onComplete }) => {\r\n  const cleanup = useCleanup('CoursePlayer');\r\n  const { t } = useTranslation();\r\n  const isMobile = useIsMobile();\r\n  const iframeRef = useRef<HTMLIFrameElement>(null);\r\n  const { user } = useAuth();\r\n  const { updateProgress, currentProgress } = useProgressTracking('empowering-learning-state');\r\n  const { trackPageView } = useAnalytics({ courseId: 'empowering-learning-state' });\r\n  const { safeT, getCurrentLanguageInfo } = useLanguageConsistency({\r\n    maintainRouteOnLanguageChange: true,\r\n    logMissingKeys: true\r\n  });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // Track page view on mount\r\n  useEffect(() => {\r\n    trackPageView('course_player', {\r\n      course_id: 'empowering-learning-state',\r\n      is_mobile: isMobile\r\n    });\r\n  }, [trackPageView, isMobile]);\r\n\r\n  useEffect(() => {\r\n    const handleMessage = async (event: MessageEvent) => {\r\n      // Validate origin for security\r\n      if (event.origin !== 'https://preview--course-start-kit-react.lovable.app') {\r\n        return;\r\n      }\r\n\r\n      const { type, ...data } = event.data;\r\n      logger.info('CoursePlayer received message', 'COURSE_PLAYER', { type, data });\r\n\r\n      try {\r\n        switch (type) {\r\n          case 'MODULE_COMPLETE':\r\n            logger.info('Module completed', 'COURSE_PLAYER', { moduleId: data.moduleId });\r\n            await updateProgress({\r\n              type: 'module_complete',\r\n              moduleId: data.moduleId,\r\n              timestamp: new Date().toISOString()\r\n            });\r\n            onComplete?.();\r\n            break;\r\n\r\n          case 'COURSE_COMPLETE':\r\n            logger.info('Course completed', 'COURSE_PLAYER');\r\n            await updateProgress({\r\n              type: 'course_complete',\r\n              completedAt: new Date().toISOString(),\r\n              completed: true\r\n            });\r\n            onComplete?.();\r\n            break;\r\n\r\n          case 'PROGRESS_UPDATE':\r\n            logger.info('Progress updated', 'COURSE_PLAYER', { percent: data.percent });\r\n            await updateProgress({\r\n              type: 'progress_update',\r\n              completionPercentage: data.percent\r\n            });\r\n            onProgress?.(data.percent);\r\n            break;\r\n\r\n          case 'READY':\r\n            logger.info('Course player is ready', 'COURSE_PLAYER');\r\n            setIsLoading(false);\r\n            setError(null);\r\n            // Send initialization data to the iframe\r\n            if (iframeRef.current?.contentWindow && user?.id) {\r\n              iframeRef.current.contentWindow.postMessage(\r\n                { \r\n                  type: 'INIT', \r\n                  userId: user.id,\r\n                  currentProgress: currentProgress \r\n                }, \r\n                'https://preview--course-start-kit-react.lovable.app'\r\n              );\r\n            }\r\n            break;\r\n\r\n          default:\r\n            logger.warn('Unknown message type', 'COURSE_PLAYER', { type });\r\n        }\r\n      } catch (error) {\r\n        logger.error('Error handling course player message', 'COURSE_PLAYER', error);\r\n        setError('Failed to communicate with course content');\r\n      }\r\n    };\r\n\r\n    const messageListenerId = cleanup.addEventListener(window, 'message', handleMessage);\r\n\r\n    return () => {\r\n      cleanup.cleanup(messageListenerId);\r\n    };\r\n  }, [updateProgress, user?.id, currentProgress, onProgress, onComplete]);\r\n\r\n  // Handle iframe load event\r\n  useEffect(() => {\r\n    const handleIframeLoad = () => {\r\n      logger.info('Iframe loaded successfully', 'COURSE_PLAYER');\r\n      // Give the iframe a moment to initialize before sending messages\r\n      cleanup.setTimeout(() => {\r\n        if (iframeRef.current?.contentWindow && user?.id) {\r\n          logger.info('Sending init handshake to course player', 'COURSE_PLAYER');\r\n          iframeRef.current.contentWindow.postMessage(\r\n            { \r\n              type: 'INIT', \r\n              userId: user.id,\r\n              currentProgress: currentProgress \r\n            }, \r\n            'https://preview--course-start-kit-react.lovable.app'\r\n          );\r\n        }\r\n      }, 1000);\r\n    };\r\n\r\n    const handleIframeError = () => {\r\n      logger.error('Iframe failed to load', 'COURSE_PLAYER');\r\n      setIsLoading(false);\r\n      setError('Failed to load course content. Please check your internet connection and try again.');\r\n    };\r\n\r\n    const iframe = iframeRef.current;\r\n    if (iframe) {\r\n      const loadListenerId = cleanup.addEventListener(iframe, 'load', handleIframeLoad);\r\n      const errorListenerId = cleanup.addEventListener(iframe, 'error', handleIframeError);\r\n      \r\n      // Set a timeout to handle cases where the iframe never loads\r\n      const timeoutId = cleanup.setTimeout(() => {\r\n        if (isLoading) {\r\n          logger.warn('Iframe load timeout', 'COURSE_PLAYER');\r\n          setIsLoading(false);\r\n          setError('Course content is taking too long to load. Please refresh the page.');\r\n        }\r\n      }, 15000);\r\n\r\n      return () => {\r\n        cleanup.cleanup(loadListenerId);\r\n        cleanup.cleanup(errorListenerId);\r\n        cleanup.cleanup(timeoutId);\r\n      };\r\n    }\r\n  }, [user?.id, currentProgress, isLoading]);\r\n\r\n  const minHeight = isMobile ? 'calc(100vh - 48px)' : 'calc(100vh - 48px)';\r\n\r\n  return (\r\n    <div className=\"relative z-20 bg-white\" style={{ minHeight }}>\r\n      {/* Loading overlay */}\r\n      {isLoading && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-white z-10\">\r\n          <div className=\"text-center\">\r\n            <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-4 text-purple-600\" />\r\n            <p className=\"text-gray-600\">Loading course content...</p>\r\n            <p className=\"text-sm text-gray-500 mt-2\">This may take a few moments</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Error overlay */}\r\n      {error && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-white z-10\">\r\n          <div className=\"text-center max-w-md p-6\">\r\n            <div className=\"text-red-500 mb-4\">\r\n              <svg className=\"h-12 w-12 mx-auto\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 15.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Content Loading Error</h3>\r\n            <p className=\"text-gray-600 mb-4\">{error}</p>\r\n            <button \r\n              onClick={() => window.location.reload()} \r\n              className=\"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700\"\r\n            >\r\n              Refresh Page\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <iframe\r\n        ref={iframeRef}\r\n        src=\"https://preview--course-start-kit-react.lovable.app/\"\r\n        title={String(safeT('courses.learningState.playerTitle', 'Course Player'))}\r\n        className=\"w-full h-full border-0 ui-polish-container\"\r\n        style={{ \r\n          minHeight,\r\n          height: '100%'\r\n        }}\r\n        allowFullScreen\r\n        allow=\"clipboard-write; encrypted-media; fullscreen; microphone; camera\"\r\n        sandbox=\"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CoursePlayer;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\CourseProgressSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\InCourseChatBubble.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\InteractiveCourseWrapper.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":59,"column":6,"nodeType":"ArrayExpression","endLine":59,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, courseId, courseTitle, enrollInCourse]","fix":{"range":[1871,1910],"text":"[cleanup, courseId, courseTitle, enrollInCourse]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":105,"column":6,"nodeType":"ArrayExpression","endLine":105,"endColumn":78,"suggestions":[{"desc":"Update the dependencies array to be: [completedLessons, totalLessons, updateCourseProgress, onProgressUpdate, cleanup]","fix":{"range":[3421,3493],"text":"[completedLessons, totalLessons, updateCourseProgress, onProgressUpdate, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef } from 'react';\r\nimport { useInteractiveCourseAnalytics } from '@/hooks/useInteractiveCourseAnalytics';\r\nimport { useInteractiveCourseProgress } from '@/hooks/useInteractiveCourseProgress';\r\nimport { timeoutManager } from '@/utils/performanceOptimizer';\r\nimport { ErrorBoundary } from '@/components/ErrorBoundary';\r\nimport { CourseAIStudyCoach } from '@/components/course/CourseAIStudyCoach';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface InteractiveCourseWrapperProps {\r\n  courseId: string;\r\n  courseTitle: string;\r\n  currentLesson: number | null;\r\n  totalLessons: number;\r\n  children: React.ReactNode;\r\n  onProgressUpdate?: (completedLessons: number, totalLessons: number) => void;\r\n}\r\n\r\nexport const InteractiveCourseWrapper: React.FC<InteractiveCourseWrapperProps> = ({\r\n  courseId,\r\n  courseTitle,\r\n  currentLesson,\r\n  totalLessons,\r\n  children,\r\n  onProgressUpdate\r\n}) => {\r\n  const cleanup = useCleanup('InteractiveCourseWrapper');\r\n  const {\r\n    startCourseSession,\r\n    endCourseSession,\r\n    trackScrollDepth,\r\n    trackInteraction,\r\n    enrollInCourse,\r\n    updateCourseProgress\r\n  } = useInteractiveCourseAnalytics(courseId, courseTitle);\r\n\r\n  const {\r\n    completedLessons,\r\n    saveLessonCompletion,\r\n    loadProgressData\r\n  } = useInteractiveCourseProgress(courseId);\r\n\r\n  const scrollTimeoutRef = useRef<NodeJS.Timeout>();\r\n  const lastScrollPercentage = useRef(0);\r\n\r\n  // Auto-enroll on mount - optimized\r\n  useEffect(() => {\r\n    if (!courseId || !courseTitle) return;\r\n\r\n    // Use requestIdleCallback for better performance\r\n    const enrollWhenIdle = () => {\r\n      if ('requestIdleCallback' in window) {\r\n        requestIdleCallback(() => enrollInCourse(), { timeout: 2000 });\r\n      } else {\r\n        cleanup.setTimeout(enrollInCourse, 1000);\r\n      }\r\n    };\r\n\r\n    enrollWhenIdle();\r\n  }, [courseId, courseTitle, enrollInCourse]);\r\n\r\n  // Cleanup on unmount - enhanced with error handling\r\n  useEffect(() => {\r\n    return () => {\r\n      try {\r\n        endCourseSession();\r\n        // Cleanup all timeouts and intervals\r\n        timeoutManager.cleanup();\r\n      } catch (err) {\r\n        console.warn('Error during course cleanup:', err);\r\n      }\r\n    };\r\n  }, [endCourseSession]);\r\n\r\n  // Track scroll depth - lightweight and optimized\r\n  useEffect(() => {\r\n    // Skip scroll tracking entirely for better performance\r\n    // This was causing major performance issues during navigation\r\n    return;\r\n  }, []);\r\n\r\n  // Track click interactions - disabled for performance\r\n  useEffect(() => {\r\n    // Skip click tracking entirely for better performance\r\n    // This was causing performance issues during navigation\r\n    return;\r\n  }, []);\r\n\r\n  // Update progress when completed lessons change - optimized\r\n  useEffect(() => {\r\n    const completedCount = completedLessons.size;\r\n    \r\n    // Use requestIdleCallback for progress updates to avoid blocking UI\r\n    if ('requestIdleCallback' in window) {\r\n      requestIdleCallback(() => {\r\n        updateCourseProgress(completedCount, totalLessons);\r\n        onProgressUpdate?.(completedCount, totalLessons);\r\n      }, { timeout: 1000 });\r\n    } else {\r\n      // Fallback for browsers without requestIdleCallback\r\n      cleanup.setTimeout(() => {\r\n        updateCourseProgress(completedCount, totalLessons);\r\n        onProgressUpdate?.(completedCount, totalLessons);\r\n      }, 0);\r\n    }\r\n  }, [completedLessons, totalLessons, updateCourseProgress, onProgressUpdate]);\r\n\r\n  // Provide analytics context to children\r\n  const analyticsContext = {\r\n    courseId,\r\n    courseTitle,\r\n    currentLesson,\r\n    totalLessons,\r\n    completedLessons,\r\n    trackInteraction,\r\n    saveLessonCompletion,\r\n    loadProgressData\r\n  };\r\n\r\n  return (\r\n    <ErrorBoundary\r\n      onError={(error) => console.error('Course wrapper error:', error)}\r\n      fallback={\r\n        <div className=\"p-6 text-center\">\r\n          <p className=\"text-muted-foreground\">Unable to load course content. Please refresh the page.</p>\r\n        </div>\r\n      }\r\n    >\r\n      <div className=\"interactive-course-wrapper\" data-course-id={courseId}>\r\n        {React.Children.map(children, child => {\r\n          if (React.isValidElement(child)) {\r\n            return React.cloneElement(child, { ...analyticsContext });\r\n          }\r\n          return child;\r\n        })}\r\n        \r\n        {/* Course-level AI Study Coach */}\r\n        <CourseAIStudyCoach \r\n          courseId={courseId}\r\n          courseTitle={courseTitle}\r\n          className=\"z-40\"\r\n        />\r\n      </div>\r\n    </ErrorBoundary>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\InteractiveLessonWrapper.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cleanup' and 'startLessonAnalytics'. Either include them or remove the dependency array.","line":57,"column":6,"nodeType":"ArrayExpression","endLine":57,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, lessonId, lessonTitle, startLessonAnalytics]","fix":{"range":[1929,1952],"text":"[cleanup, lessonId, lessonTitle, startLessonAnalytics]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef, useState } from 'react';\r\nimport { useInteractiveCourseAnalytics } from '@/hooks/useInteractiveCourseAnalytics';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { CheckCircle, Clock, TrendingUp } from 'lucide-react';\r\nimport LessonTTSControls from '@/components/course/LessonTTSControls';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface InteractiveLessonWrapperProps {\r\n  courseId: string;\r\n  lessonId: number;\r\n  lessonTitle: string;\r\n  children: React.ReactNode;\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  totalLessons?: number;\r\n  suppressWrapperCompletion?: boolean; // Hide wrapper completion UI for micro-lessons\r\n}\r\n\r\nexport const InteractiveLessonWrapper: React.FC<InteractiveLessonWrapperProps> = ({\r\n  courseId,\r\n  lessonId,\r\n  lessonTitle,\r\n  children,\r\n  onComplete,\r\n  onNext,\r\n  hasNext,\r\n  totalLessons = 8,\r\n  suppressWrapperCompletion = false\r\n}) => {\r\n  const cleanup = useCleanup('interactive-lesson-wrapper');\r\n  const {\r\n    startLessonAnalytics,\r\n    completeLessonAnalytics,\r\n    trackInteraction,\r\n    currentLessonAnalytics\r\n  } = useInteractiveCourseAnalytics(courseId, lessonTitle);\r\n\r\n  const [isCompleted, setIsCompleted] = useState(false);\r\n  const [timeSpent, setTimeSpent] = useState(0);\r\n  const startTimeRef = useRef<Date | null>(null);\r\n  const lessonContentRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Start lesson analytics on mount\r\n  useEffect(() => {\r\n    startLessonAnalytics(lessonId, lessonTitle);\r\n    startTimeRef.current = new Date();\r\n\r\n    // Start timer for time tracking using cleanupManager\r\n    cleanup.setInterval(() => {\r\n      if (startTimeRef.current) {\r\n        const elapsed = Math.floor((new Date().getTime() - startTimeRef.current.getTime()) / 1000);\r\n        setTimeSpent(elapsed);\r\n      }\r\n    }, 1000);\r\n  }, [lessonId, lessonTitle]);\r\n\r\n  // Handle lesson completion\r\n  const handleComplete = async () => {\r\n    if (isCompleted) return;\r\n\r\n    setIsCompleted(true);\r\n    \r\n    // Track completion\r\n    await completeLessonAnalytics('manual');\r\n    \r\n    // Track interaction\r\n    trackInteraction('lesson_complete', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      time_spent_seconds: timeSpent,\r\n      completion_method: 'manual'\r\n    });\r\n\r\n    // Call parent completion handler\r\n    onComplete?.();\r\n  };\r\n\r\n  // Format time display\r\n  const formatTime = (seconds: number) => {\r\n    const minutes = Math.floor(seconds / 60);\r\n    const remainingSeconds = seconds % 60;\r\n    return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  // Enhanced children with analytics context\r\n  const enhancedChildren = React.Children.map(children, child => {\r\n    if (React.isValidElement(child)) {\r\n      return React.cloneElement(child as React.ReactElement<Record<string, unknown>>, {\r\n        onComplete: handleComplete,\r\n        onNext,\r\n        hasNext,\r\n        isCompleted,\r\n        trackInteraction,\r\n        lessonId,\r\n        lessonTitle\r\n      });\r\n    }\r\n    return child;\r\n  });\r\n\r\n  return (\r\n    <div className=\"interactive-lesson-wrapper\" data-lesson-id={lessonId}>\r\n      {/* Lesson Progress Header */}\r\n      <Card className=\"mb-6 bg-muted/50\">\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-4\">\r\n              <div className={`p-2 rounded-full ${\r\n                isCompleted \r\n                  ? 'bg-green-100 text-green-600' \r\n                  : 'bg-primary/10 text-primary'\r\n              }`}>\r\n                {isCompleted ? (\r\n                  <CheckCircle className=\"h-5 w-5\" />\r\n                ) : (\r\n                  <Clock className=\"h-5 w-5\" />\r\n                )}\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-semibold\">Lesson {lessonId}: {lessonTitle}</h3>\r\n                <div className=\"flex items-center space-x-4 text-sm text-white font-medium\">\r\n                  <span className=\"flex items-center\">\r\n                    <Clock className=\"h-4 w-4 mr-1\" />\r\n                    {formatTime(timeSpent)}\r\n                  </span>\r\n                  {currentLessonAnalytics && (\r\n                    <span className=\"flex items-center\">\r\n                      <TrendingUp className=\"h-4 w-4 mr-1\" />\r\n                      Engagement: {Math.round(currentLessonAnalytics.engagementScore)}%\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {isCompleted && (\r\n              <div className=\"bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium\">\r\n                Completed\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* TTS Controls */}\r\n      <div className=\"mb-6\">\r\n        <LessonTTSControls\r\n          lessonTitle={lessonTitle}\r\n          lessonNumber={lessonId}\r\n          totalLessons={totalLessons}\r\n          contentRef={lessonContentRef}\r\n        />\r\n      </div>\r\n\r\n      {/* Lesson Content */}\r\n      <div ref={lessonContentRef} className=\"interactive-lesson-content\">\r\n        {enhancedChildren}\r\n      </div>\r\n\r\n      {/* Lesson Completion Footer - Only show for non-micro-lessons */}\r\n      {!suppressWrapperCompletion && !isCompleted && (\r\n        <Card className=\"mt-8 border-2 border-dashed border-primary/30\">\r\n          <CardContent className=\"p-6 text-center\">\r\n            <div className=\"space-y-4\">\r\n              <h3 className=\"text-xl font-semibold\">Ready to Continue?</h3>\r\n              <p className=\"text-white font-medium\">\r\n                Complete this lesson to track your progress and unlock the next lesson.\r\n              </p>\r\n              <Button \r\n                onClick={handleComplete} \r\n                size=\"lg\"\r\n                className=\"interactive\"\r\n              >\r\n                Complete Lesson {lessonId}\r\n              </Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Next Lesson Button - Only show for non-micro-lessons */}\r\n      {!suppressWrapperCompletion && isCompleted && hasNext && onNext && (\r\n        <Card className=\"mt-6 bg-primary/5 border-primary/20\">\r\n          <CardContent className=\"p-6 text-center\">\r\n            <div className=\"space-y-4\">\r\n              <CheckCircle className=\"h-12 w-12 text-green-500 mx-auto\" />\r\n              <h3 className=\"text-xl font-semibold text-green-700\">\r\n                Lesson Completed! ðŸŽ‰\r\n              </h3>\r\n              <p className=\"text-white font-medium\">\r\n                Great job! You've mastered the concepts in this lesson.\r\n              </p>\r\n              <Button \r\n                onClick={onNext} \r\n                size=\"lg\"\r\n                className=\"interactive\"\r\n              >\r\n                Continue to Next Lesson\r\n              </Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\LessonTTSControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\MediaPlayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\MediaPlayerControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\MediaPlayerDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\MediaPlayerProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\MediaPlayerVolume.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\MediaUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\ModuleContent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\NumeracyCourseWrapper.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":81,"suggestions":[{"desc":"Update the dependencies array to be: [currentLesson, courseId, totalLessons, onProgressUpdate, isNumeracyCourse, cleanup]","fix":{"range":[2771,2846],"text":"[currentLesson, courseId, totalLessons, onProgressUpdate, isNumeracyCourse, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef } from 'react';\r\nimport { useSpellingCoursePerformance } from '@/hooks/useSpellingCoursePerformance';\r\nimport empoweringNumeracyBg from '@/assets/empowering-numeracy-bg.jpg';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface NumeracyCourseWrapperProps {\r\n  courseId: string;\r\n  courseTitle: string;\r\n  currentLesson: number | null;\r\n  totalLessons: number;\r\n  children: React.ReactNode;\r\n  onProgressUpdate?: (completedLessons: number, totalLessons: number) => void;\r\n}\r\n\r\n/**\r\n * Wrapper for the numeracy course to provide consistent background\r\n */\r\nexport const NumeracyCourseWrapper: React.FC<NumeracyCourseWrapperProps> = ({\r\n  courseId,\r\n  courseTitle,\r\n  currentLesson,\r\n  totalLessons,\r\n  children,\r\n  onProgressUpdate\r\n}) => {\r\n  const { forceCleanup, registerCleanup, isSpellingCourse } = useSpellingCoursePerformance(courseId, currentLesson);\r\n  const wrapperRef = useRef<HTMLDivElement>(null);\r\n  const cleanup = useCleanup('NumeracyCourseWrapper');\r\n\r\n  // Check if this is the numeracy course\r\n  const isNumeracyCourse = courseId === 'empowering-learning-numeracy';\r\n\r\n  // Minimal analytics - only track basic navigation\r\n  useEffect(() => {\r\n    if (!isNumeracyCourse) return;\r\n\r\n    console.log(`ðŸ“Š Numeracy Course: ${currentLesson ? `Lesson ${currentLesson}` : 'Overview'}`);\r\n    \r\n    // Register cleanup for this effect\r\n    registerCleanup(() => {\r\n      console.log('ðŸ§¹ Cleaning up numeracy course session');\r\n    });\r\n\r\n    // No heavy database operations or complex analytics\r\n    // Just basic logging for debugging\r\n  }, [currentLesson, isNumeracyCourse, registerCleanup]);\r\n\r\n  // Simplified progress tracking - debounced and lightweight\r\n  useEffect(() => {\r\n    if (!onProgressUpdate || !isNumeracyCourse) return;\r\n\r\n    // Simple localStorage-based progress (no database calls)\r\n    const storageKey = `numeracy-progress-${courseId}`;\r\n    \r\n    try {\r\n      const stored = safeLocalStorage.getItem<string>(storageKey, {\r\n        fallbackValue: '{\"completed\": []}',\r\n        logErrors: false\r\n      });\r\n      const progress = stored ? JSON.parse(stored) : { completed: [] };\r\n      \r\n      // Very lightweight progress update\r\n      if (currentLesson && !progress.completed.includes(currentLesson)) {\r\n        progress.completed.push(currentLesson);\r\n        safeLocalStorage.setItem(storageKey, JSON.stringify(progress));\r\n        \r\n        // Delayed callback to prevent blocking using cleanup manager\r\n        cleanup.setTimeout(() => {\r\n          onProgressUpdate?.(progress.completed.length, totalLessons);\r\n        }, 100);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Progress tracking error:', error);\r\n    }\r\n  }, [currentLesson, courseId, totalLessons, onProgressUpdate, isNumeracyCourse]);\r\n\r\n  // Clean up on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (isNumeracyCourse) {\r\n        forceCleanup();\r\n      }\r\n    };\r\n  }, [isNumeracyCourse, forceCleanup]);\r\n\r\n  if (!isNumeracyCourse) {\r\n    // Fall back to regular behavior for other courses\r\n    return <div className=\"course-wrapper\">{children}</div>;\r\n  }\r\n\r\n  return (\r\n    <div \r\n      ref={wrapperRef}\r\n      className=\"numeracy-course-wrapper min-h-screen relative\" \r\n      data-course-id={courseId}\r\n      style={{ \r\n        // Optimize rendering performance\r\n        contain: 'layout style paint',\r\n        willChange: 'auto'\r\n      }}\r\n    >\r\n      {/* Full page background image */}\r\n      <div \r\n        className=\"fixed inset-0 z-0\"\r\n        style={{\r\n          backgroundImage: `url(${empoweringNumeracyBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundRepeat: 'no-repeat',\r\n          backgroundAttachment: 'fixed'\r\n        }}\r\n      />\r\n      \r\n      {/* Content overlay */}\r\n      <div className=\"relative z-10\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\PDFDownloadButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\PDFThumbnailPreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\ReadingCourseWrapper.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":80,"suggestions":[{"desc":"Update the dependencies array to be: [currentLesson, courseId, totalLessons, onProgressUpdate, isReadingCourse, cleanup]","fix":{"range":[2755,2829],"text":"[currentLesson, courseId, totalLessons, onProgressUpdate, isReadingCourse, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef } from 'react';\r\nimport { useSpellingCoursePerformance } from '@/hooks/useSpellingCoursePerformance';\r\nimport empoweringReadingBg from '@/assets/empowering-reading-bg.jpg';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface ReadingCourseWrapperProps {\r\n  courseId: string;\r\n  courseTitle: string;\r\n  currentLesson: number | null;\r\n  totalLessons: number;\r\n  children: React.ReactNode;\r\n  onProgressUpdate?: (completedLessons: number, totalLessons: number) => void;\r\n}\r\n\r\n/**\r\n * Wrapper for the reading course to provide consistent background\r\n */\r\nexport const ReadingCourseWrapper: React.FC<ReadingCourseWrapperProps> = ({\r\n  courseId,\r\n  courseTitle,\r\n  currentLesson,\r\n  totalLessons,\r\n  children,\r\n  onProgressUpdate\r\n}) => {\r\n  const { forceCleanup, registerCleanup, isSpellingCourse } = useSpellingCoursePerformance(courseId, currentLesson);\r\n  const wrapperRef = useRef<HTMLDivElement>(null);\r\n  const cleanup = useCleanup('ReadingCourseWrapper');\r\n\r\n  // Check if this is the reading course\r\n  const isReadingCourse = courseId === 'empowering-learning-reading';\r\n\r\n  // Minimal analytics - only track basic navigation\r\n  useEffect(() => {\r\n    if (!isReadingCourse) return;\r\n\r\n    console.log(`ðŸ“š Reading Course: ${currentLesson ? `Lesson ${currentLesson}` : 'Overview'}`);\r\n    \r\n    // Register cleanup for this effect\r\n    registerCleanup(() => {\r\n      console.log('ðŸ§¹ Cleaning up reading course session');\r\n    });\r\n\r\n    // No heavy database operations or complex analytics\r\n    // Just basic logging for debugging\r\n  }, [currentLesson, isReadingCourse, registerCleanup]);\r\n\r\n  // Simplified progress tracking - debounced and lightweight\r\n  useEffect(() => {\r\n    if (!onProgressUpdate || !isReadingCourse) return;\r\n\r\n    // Simple localStorage-based progress (no database calls)\r\n    const storageKey = `reading-progress-${courseId}`;\r\n    \r\n    try {\r\n      const stored = safeLocalStorage.getItem<string>(storageKey, {\r\n        fallbackValue: '{\"completed\": []}',\r\n        logErrors: false\r\n      });\r\n      const progress = stored ? JSON.parse(stored) : { completed: [] };\r\n      \r\n      // Very lightweight progress update\r\n      if (currentLesson && !progress.completed.includes(currentLesson)) {\r\n        progress.completed.push(currentLesson);\r\n        safeLocalStorage.setItem(storageKey, JSON.stringify(progress));\r\n        \r\n        // Delayed callback to prevent blocking using cleanup manager\r\n        cleanup.setTimeout(() => {\r\n          onProgressUpdate?.(progress.completed.length, totalLessons);\r\n        }, 100);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Progress tracking error:', error);\r\n    }\r\n  }, [currentLesson, courseId, totalLessons, onProgressUpdate, isReadingCourse]);\r\n\r\n  // Clean up on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (isReadingCourse) {\r\n        forceCleanup();\r\n      }\r\n    };\r\n  }, [isReadingCourse, forceCleanup]);\r\n\r\n  if (!isReadingCourse) {\r\n    // Fall back to regular behavior for other courses\r\n    return <div className=\"course-wrapper\">{children}</div>;\r\n  }\r\n\r\n  return (\r\n    <div \r\n      ref={wrapperRef}\r\n      className=\"reading-course-wrapper min-h-screen relative\" \r\n      data-course-id={courseId}\r\n      style={{ \r\n        // Optimize rendering performance\r\n        contain: 'layout style paint',\r\n        willChange: 'auto'\r\n      }}\r\n    >\r\n      {/* Full page background image */}\r\n      <div \r\n        className=\"fixed inset-0 z-0\"\r\n        style={{\r\n          backgroundImage: `url(${empoweringReadingBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundRepeat: 'no-repeat',\r\n          backgroundAttachment: 'fixed'\r\n        }}\r\n      />\r\n      \r\n      {/* Content overlay */}\r\n      <div className=\"relative z-10\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\SpellingCourseWrapper.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":73,"column":6,"nodeType":"ArrayExpression","endLine":73,"endColumn":81,"suggestions":[{"desc":"Update the dependencies array to be: [currentLesson, courseId, totalLessons, onProgressUpdate, isSpellingCourse, cleanup]","fix":{"range":[2672,2747],"text":"[currentLesson, courseId, totalLessons, onProgressUpdate, isSpellingCourse, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef } from 'react';\r\nimport { useSpellingCoursePerformance } from '@/hooks/useSpellingCoursePerformance';\r\nimport empoweringSpellingBg from '@/assets/empowering-spelling-unique-bg.jpg';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface SpellingCourseWrapperProps {\r\n  courseId: string;\r\n  courseTitle: string;\r\n  currentLesson: number | null;\r\n  totalLessons: number;\r\n  children: React.ReactNode;\r\n  onProgressUpdate?: (completedLessons: number, totalLessons: number) => void;\r\n}\r\n\r\n/**\r\n * Lightweight wrapper specifically for the spelling course to prevent freezing\r\n */\r\nexport const SpellingCourseWrapper: React.FC<SpellingCourseWrapperProps> = ({\r\n  courseId,\r\n  courseTitle,\r\n  currentLesson,\r\n  totalLessons,\r\n  children,\r\n  onProgressUpdate\r\n}) => {\r\n  const { forceCleanup, registerCleanup, isSpellingCourse } = useSpellingCoursePerformance(courseId, currentLesson);\r\n  const wrapperRef = useRef<HTMLDivElement>(null);\r\n  const cleanup = useCleanup('SpellingCourseWrapper');\r\n\r\n  // Minimal analytics - only track basic navigation\r\n  useEffect(() => {\r\n    if (!isSpellingCourse) return;\r\n\r\n    console.log(`ðŸ“– Spelling Course: ${currentLesson ? `Lesson ${currentLesson}` : 'Overview'}`);\r\n    \r\n    // Register cleanup for this effect\r\n    registerCleanup(() => {\r\n      console.log('ðŸ§¹ Cleaning up spelling course session');\r\n    });\r\n\r\n    // No heavy database operations or complex analytics\r\n    // Just basic logging for debugging\r\n  }, [currentLesson, isSpellingCourse, registerCleanup]);\r\n\r\n  // Simplified progress tracking - debounced and lightweight\r\n  useEffect(() => {\r\n    if (!onProgressUpdate || !isSpellingCourse) return;\r\n\r\n    // Simple localStorage-based progress (no database calls)\r\n    const storageKey = `spelling-progress-${courseId}`;\r\n    \r\n    try {\r\n      const stored = safeLocalStorage.getItem<string>(storageKey, {\r\n        fallbackValue: '{\"completed\": []}',\r\n        logErrors: false\r\n      });\r\n      const progress = stored ? JSON.parse(stored) : { completed: [] };\r\n      \r\n      // Very lightweight progress update\r\n      if (currentLesson && !progress.completed.includes(currentLesson)) {\r\n        progress.completed.push(currentLesson);\r\n        safeLocalStorage.setItem(storageKey, JSON.stringify(progress));\r\n        \r\n        // Delayed callback to prevent blocking using cleanup manager\r\n        cleanup.setTimeout(() => {\r\n          onProgressUpdate?.(progress.completed.length, totalLessons);\r\n        }, 100);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Progress tracking error:', error);\r\n    }\r\n  }, [currentLesson, courseId, totalLessons, onProgressUpdate, isSpellingCourse]);\r\n\r\n  // Clean up on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (isSpellingCourse) {\r\n        forceCleanup();\r\n      }\r\n    };\r\n  }, [isSpellingCourse, forceCleanup]);\r\n\r\n  if (!isSpellingCourse) {\r\n    // Fall back to regular behavior for other courses\r\n    return <div className=\"course-wrapper\">{children}</div>;\r\n  }\r\n\r\n  return (\r\n    <div \r\n      ref={wrapperRef}\r\n      className=\"spelling-course-wrapper min-h-screen relative\" \r\n      data-course-id={courseId}\r\n      style={{ \r\n        // Optimize rendering performance\r\n        contain: 'layout style paint',\r\n        willChange: 'auto'\r\n      }}\r\n    >\r\n      {/* Full page background image */}\r\n      <div \r\n        className=\"fixed inset-0 z-0\"\r\n        style={{\r\n          backgroundImage: `url(${empoweringSpellingBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundRepeat: 'no-repeat',\r\n          backgroundAttachment: 'fixed'\r\n        }}\r\n      />\r\n      \r\n      {/* Content overlay */}\r\n      <div className=\"relative z-10\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\SpellingLessonWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\StandardCourseAudioSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\StandardLessonAudioButtons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\StudentGuideGallery.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\VideoPlaylist.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\VideoPlaylistTile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\CirclesLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\CoordinateGeometryLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\GeometryCompletionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\GeometryReviewAndRecap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\GeometryReviewLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\PointsLinesPlanes.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\QuadrilateralsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\ThreeDShapesLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\TransformationsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\TrianglesLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\geometry-lessons\\VectorsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingBeyondLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingConclusionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingEmulationLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingFinalTestLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingIntroductionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingOptimalLearningStateLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingOptimalStateLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingQuizLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingScienceLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\handwriting-lessons\\HandwritingTechniqueLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\BigStrongTreeLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\BreathingLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\EnergyBearLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\FiveFourThreeTwoOneLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\IntroductionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\LabyrinthLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\LookingUpLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\PhoenixBreathLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\RaisingBookScreenLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\SandTimerLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\TechniquesLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\UseImaginationLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\learning-state-lessons\\WorkingTimeLimitsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyBeyondLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyConclusionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyFinalTestLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyHistoryLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyIntentionalityLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyIntroductionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyNumberShapesLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyOptimalLearningStateLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyQuizLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyScienceLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyTechniqueLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\numeracy-lessons\\NumeracyTriangleLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingBeyondReadingLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingConclusionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingFinalTestLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingIntentionalityLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingIntroductionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingOptimalLearningStateLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingQuizLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingScienceLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingStorytellingLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\reading-lessons\\ReadingTechniqueLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\resources\\AdditionalResourcesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\resources\\CourseOverviewAccordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\resources\\EnhancedCourseInfoAccordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\resources\\InstructorMaterialsAccordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\resources\\StudentGuidesAccordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\resources\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\AtomsAndMoleculesLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\CellStructureLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\EnergyAndWorkLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\ForcesAndMotionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\FurtherExplorationLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\GeneticsAndDNALesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\ImportanceOfScienceLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\PeriodicTableLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\ReviewAndSummaryLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\ScientificMethodLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\ShortAnswerQuestionsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\science-lessons\\StudyGuideLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\AdvancedTechniquesLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\CelebratingSuccessLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\EmpoweringLearningNounsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\EssayQuestionsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\FinalTipsLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\GlossaryLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\IntroductionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\MindBodyConnectionLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\OptimalLearningStateLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\QuizLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\SpellingTechniqueLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\course\\spelling-lessons\\VisualMemoryLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\VisualAid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson2.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[471,474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[471,474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, TrendingUp, ArrowRight } from 'lucide-react';\r\n\r\ninterface EconomicsLesson2Props {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const EconomicsLesson2: React.FC<EconomicsLesson2Props> = ({ \r\n  onComplete, \r\n  onNext, \r\n  hasNext,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId = 2,\r\n  lessonTitle = \"Supply and Demand\"\r\n}) => {\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_complete_click', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      action: 'complete_button_clicked'\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_interaction', {\r\n      lesson_id: lessonId,\r\n      concept,\r\n      action: 'concept_viewed'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Lesson Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <TrendingUp className=\"w-6 h-6 text-primary\" />\r\n            <CardTitle>Supply and Demand</CardTitle>\r\n            <Badge variant=\"outline\">Lesson 2</Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-lg\">\r\n            Supply and demand are the fundamental forces that drive market economies. \r\n            Understanding these concepts is crucial for grasping how prices are determined and markets function.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Main Content */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>The Law of Demand</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              The law of demand states that as the price of a good increases, the quantity demanded decreases, \r\n              and vice versa, all other factors being equal.\r\n            </p>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">Factors Affecting Demand:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Price:</strong> Primary factor - inverse relationship with demand</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Income:</strong> Higher income typically increases demand for normal goods</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Preferences:</strong> Consumer tastes and preferences affect demand</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Substitutes:</strong> Availability of alternative products</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>The Law of Supply</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              The law of supply states that as the price of a good increases, the quantity supplied increases, \r\n              and vice versa, all other factors being equal.\r\n            </p>\r\n            \r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">Factors Affecting Supply:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Production Costs:</strong> Lower costs increase supply</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Technology:</strong> Better technology can increase supply</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Number of Sellers:</strong> More producers increase market supply</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Expectations:</strong> Future price expectations affect current supply</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Market Equilibrium */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Market Equilibrium</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Market equilibrium occurs where supply and demand curves intersect. \r\n              At this point, the quantity demanded equals the quantity supplied.\r\n            </p>\r\n            \r\n            <div className=\"bg-purple-50 dark:bg-purple-950/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\">\r\n              <p className=\"font-medium text-purple-700 dark:text-purple-300\">Example: Coffee Market</p>\r\n              <p className=\"mt-2\">\r\n                If coffee is priced too high, there will be a surplus (excess supply). \r\n                If priced too low, there will be a shortage (excess demand). \r\n                The market naturally moves toward equilibrium price.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Interactive Example */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Real-World Application</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <p className=\"font-medium\">Case Study: Gasoline Prices</p>\r\n              <p className=\"mt-2\">\r\n                When oil production decreases (supply shift), gasoline prices rise. \r\n                Higher prices cause consumers to drive less or seek alternatives (demand response). \r\n                This demonstrates how supply and demand interact in real markets.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Lesson Completion */}\r\n      <Card className=\"border-2 border-dashed border-primary/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"flex justify-center\">\r\n              {isCompleted ? (\r\n                <CheckCircle className=\"w-12 h-12 text-green-500\" />\r\n              ) : (\r\n                <TrendingUp className=\"w-12 h-12 text-primary\" />\r\n              )}\r\n            </div>\r\n            \r\n            {isCompleted ? (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-green-700 dark:text-green-300\">\r\n                  Lesson Completed! ðŸŽ‰\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Excellent! You now understand how supply and demand determine market prices.\r\n                </p>\r\n                {hasNext && onNext && (\r\n                  <Button onClick={onNext} className=\"mx-auto flex items-center\">\r\n                    Next Lesson: Market Structures\r\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold\">Ready to Continue?</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've learned about supply, demand, and market equilibrium.\r\n                </p>\r\n                <Button onClick={handleComplete} size=\"lg\">\r\n                  Complete Lesson 2\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson3.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[471,474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[471,474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, Calculator, ArrowRight } from 'lucide-react';\r\n\r\ninterface EconomicsLesson3Props {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const EconomicsLesson3: React.FC<EconomicsLesson3Props> = ({ \r\n  onComplete, \r\n  onNext, \r\n  hasNext,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId = 3,\r\n  lessonTitle = \"Market Structures\"\r\n}) => {\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_complete_click', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      action: 'complete_button_clicked'\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_interaction', {\r\n      lesson_id: lessonId,\r\n      concept,\r\n      action: 'concept_viewed'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Lesson Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Calculator className=\"w-6 h-6 text-primary\" />\r\n            <CardTitle>Market Structures</CardTitle>\r\n            <Badge variant=\"outline\">Lesson 3</Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-lg\">\r\n            Markets come in different forms depending on the number of participants, \r\n            barriers to entry, and degree of competition. Understanding market structures \r\n            helps explain pricing strategies and business behavior.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Perfect Competition */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Perfect Competition</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Perfect competition is a theoretical market structure with many buyers and sellers, \r\n              identical products, and no barriers to entry.\r\n            </p>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">Characteristics:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>Many buyers and sellers</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>Homogeneous (identical) products</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>Perfect information</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>No barriers to entry or exit</span>\r\n                </li>\r\n              </ul>\r\n              <p className=\"mt-2 text-sm italic\">Example: Agricultural commodities like wheat or corn</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Monopoly */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Monopoly</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              A monopoly exists when there is only one seller of a product with no close substitutes \r\n              and high barriers to entry.\r\n            </p>\r\n            \r\n            <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n              <h4 className=\"font-semibold mb-2 text-red-700 dark:text-red-300\">Characteristics:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>Single seller</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>Unique product (no close substitutes)</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>High barriers to entry</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span>Price maker (controls price)</span>\r\n                </li>\r\n              </ul>\r\n              <p className=\"mt-2 text-sm italic\">Example: Local utility companies, patented drugs</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Oligopoly and Monopolistic Competition */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg\">Oligopoly</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              <p className=\"text-sm\">\r\n                Few large firms dominate the market, with high barriers to entry.\r\n              </p>\r\n              <div className=\"bg-orange-50 dark:bg-orange-950/20 p-3 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Few sellers</li>\r\n                  <li>â€¢ Interdependent decisions</li>\r\n                  <li>â€¢ High barriers to entry</li>\r\n                  <li>â€¢ May have differentiated products</li>\r\n                </ul>\r\n                <p className=\"mt-2 text-xs italic\">Example: Airlines, telecommunications</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg\">Monopolistic Competition</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              <p className=\"text-sm\">\r\n                Many firms with differentiated products and low barriers to entry.\r\n              </p>\r\n              <div className=\"bg-green-50 dark:bg-green-950/20 p-3 rounded-lg border border-green-200 dark:border-green-800\">\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Many sellers</li>\r\n                  <li>â€¢ Differentiated products</li>\r\n                  <li>â€¢ Low barriers to entry</li>\r\n                  <li>â€¢ Some price control</li>\r\n                </ul>\r\n                <p className=\"mt-2 text-xs italic\">Example: Restaurants, clothing brands</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Comparison Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Market Structure Comparison</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full border-collapse border border-border\">\r\n              <thead>\r\n                <tr className=\"bg-muted/50\">\r\n                  <th className=\"border border-border p-2 text-left\">Structure</th>\r\n                  <th className=\"border border-border p-2 text-left\">Number of Firms</th>\r\n                  <th className=\"border border-border p-2 text-left\">Product Type</th>\r\n                  <th className=\"border border-border p-2 text-left\">Price Control</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr>\r\n                  <td className=\"border border-border p-2 font-medium\">Perfect Competition</td>\r\n                  <td className=\"border border-border p-2\">Many</td>\r\n                  <td className=\"border border-border p-2\">Identical</td>\r\n                  <td className=\"border border-border p-2\">None</td>\r\n                </tr>\r\n                <tr className=\"bg-muted/20\">\r\n                  <td className=\"border border-border p-2 font-medium\">Monopolistic Competition</td>\r\n                  <td className=\"border border-border p-2\">Many</td>\r\n                  <td className=\"border border-border p-2\">Differentiated</td>\r\n                  <td className=\"border border-border p-2\">Some</td>\r\n                </tr>\r\n                <tr>\r\n                  <td className=\"border border-border p-2 font-medium\">Oligopoly</td>\r\n                  <td className=\"border border-border p-2\">Few</td>\r\n                  <td className=\"border border-border p-2\">Identical or Differentiated</td>\r\n                  <td className=\"border border-border p-2\">Significant</td>\r\n                </tr>\r\n                <tr className=\"bg-muted/20\">\r\n                  <td className=\"border border-border p-2 font-medium\">Monopoly</td>\r\n                  <td className=\"border border-border p-2\">One</td>\r\n                  <td className=\"border border-border p-2\">Unique</td>\r\n                  <td className=\"border border-border p-2\">Complete</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Lesson Completion */}\r\n      <Card className=\"border-2 border-dashed border-primary/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"flex justify-center\">\r\n              {isCompleted ? (\r\n                <CheckCircle className=\"w-12 h-12 text-green-500\" />\r\n              ) : (\r\n                <Calculator className=\"w-12 h-12 text-primary\" />\r\n              )}\r\n            </div>\r\n            \r\n            {isCompleted ? (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-green-700 dark:text-green-300\">\r\n                  Lesson Completed! ðŸŽ‰\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Great work! You now understand different market structures and their characteristics.\r\n                </p>\r\n                {hasNext && onNext && (\r\n                  <Button onClick={onNext} className=\"mx-auto flex items-center\">\r\n                    Next Lesson: Economic Indicators\r\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold\">Ready to Continue?</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've learned about different market structures and competition levels.\r\n                </p>\r\n                <Button onClick={handleComplete} size=\"lg\">\r\n                  Complete Lesson 3\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson4.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[497,500],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[497,500],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, PlayCircle, ArrowRight, TrendingUp, TrendingDown } from 'lucide-react';\r\n\r\ninterface EconomicsLesson4Props {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const EconomicsLesson4: React.FC<EconomicsLesson4Props> = ({ \r\n  onComplete, \r\n  onNext, \r\n  hasNext,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId = 4,\r\n  lessonTitle = \"Economic Indicators\"\r\n}) => {\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_complete_click', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      action: 'complete_button_clicked'\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_interaction', {\r\n      lesson_id: lessonId,\r\n      concept,\r\n      action: 'concept_viewed'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Lesson Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <PlayCircle className=\"w-6 h-6 text-primary\" />\r\n            <CardTitle>Economic Indicators</CardTitle>\r\n            <Badge variant=\"outline\">Lesson 4</Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-lg\">\r\n            Economic indicators are statistics that provide information about the overall health and \r\n            performance of an economy. They help policymakers, businesses, and individuals make informed decisions.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* GDP Section */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Gross Domestic Product (GDP)</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              GDP is the total monetary value of all finished goods and services produced within \r\n              a country's borders in a specific time period. It's the most widely used indicator of economic health.\r\n            </p>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">Three Ways to Measure GDP:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Production Approach:</strong> Sum of value added by all producers</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Income Approach:</strong> Sum of all incomes earned in production</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Expenditure Approach:</strong> C + I + G + (X - M)</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n\r\n            <div className=\"bg-gray-50 dark:bg-gray-950/20 p-4 rounded-lg border border-gray-200 dark:border-gray-800\">\r\n              <h4 className=\"font-semibold mb-2\">GDP Formula (Expenditure Approach):</h4>\r\n              <p className=\"font-mono text-lg\">GDP = C + I + G + (X - M)</p>\r\n              <ul className=\"mt-2 space-y-1 text-sm\">\r\n                <li><strong>C</strong> = Consumer spending</li>\r\n                <li><strong>I</strong> = Investment</li>\r\n                <li><strong>G</strong> = Government spending</li>\r\n                <li><strong>X</strong> = Exports</li>\r\n                <li><strong>M</strong> = Imports</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Inflation Section */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Inflation</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Inflation is the general increase in prices of goods and services over time, \r\n              reducing the purchasing power of money.\r\n            </p>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n                <div className=\"flex items-center space-x-2 mb-2\">\r\n                  <TrendingUp className=\"w-5 h-5 text-red-500\" />\r\n                  <h4 className=\"font-semibold text-red-700 dark:text-red-300\">Causes of Inflation</h4>\r\n                </div>\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Demand-pull inflation</li>\r\n                  <li>â€¢ Cost-push inflation</li>\r\n                  <li>â€¢ Monetary inflation</li>\r\n                  <li>â€¢ Built-in inflation</li>\r\n                </ul>\r\n              </div>\r\n\r\n              <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n                <div className=\"flex items-center space-x-2 mb-2\">\r\n                  <TrendingDown className=\"w-5 h-5 text-green-500\" />\r\n                  <h4 className=\"font-semibold text-green-700 dark:text-green-300\">Measuring Inflation</h4>\r\n                </div>\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Consumer Price Index (CPI)</li>\r\n                  <li>â€¢ Producer Price Index (PPI)</li>\r\n                  <li>â€¢ GDP Deflator</li>\r\n                  <li>â€¢ Core inflation</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Unemployment Section */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Unemployment</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Unemployment measures the percentage of the labor force that is actively seeking work \r\n              but unable to find employment.\r\n            </p>\r\n            \r\n            <div className=\"bg-orange-50 dark:bg-orange-950/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n              <h4 className=\"font-semibold mb-2 text-orange-700 dark:text-orange-300\">Types of Unemployment:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Frictional:</strong> Short-term unemployment during job transitions</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Structural:</strong> Mismatch between skills and job requirements</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Cyclical:</strong> Unemployment due to economic downturns</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Seasonal:</strong> Regular unemployment patterns due to seasons</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n\r\n            <div className=\"bg-purple-50 dark:bg-purple-950/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\">\r\n              <h4 className=\"font-semibold mb-2 text-purple-700 dark:text-purple-300\">Key Unemployment Metrics:</h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li><strong>Unemployment Rate:</strong> (Unemployed / Labor Force) Ã— 100</li>\r\n                <li><strong>Labor Force Participation Rate:</strong> (Labor Force / Adult Population) Ã— 100</li>\r\n                <li><strong>Natural Rate of Unemployment:</strong> Frictional + Structural unemployment</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Real-World Application */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Understanding Economic Health</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <p className=\"font-medium\">Economic Indicators in Action:</p>\r\n              <p className=\"mt-2 text-sm\">\r\n                During the 2008 financial crisis, GDP contracted, unemployment rose to over 10%, \r\n                and deflation became a concern. Policymakers used these indicators to implement \r\n                stimulus measures and monetary policy changes.\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4\">\r\n              <div className=\"text-center p-4 bg-card border rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-600 dark:text-green-400\">Healthy Economy</h4>\r\n                <p className=\"text-sm mt-1\">GDP: 2-3% growth</p>\r\n                <p className=\"text-sm\">Inflation: 2% target</p>\r\n                <p className=\"text-sm\">Unemployment: 4-5%</p>\r\n              </div>\r\n              <div className=\"text-center p-4 bg-card border rounded-lg\">\r\n                <h4 className=\"font-semibold text-yellow-600 dark:text-yellow-400\">Moderate Concern</h4>\r\n                <p className=\"text-sm mt-1\">GDP: 0-2% growth</p>\r\n                <p className=\"text-sm\">Inflation: 3-4%</p>\r\n                <p className=\"text-sm\">Unemployment: 6-7%</p>\r\n              </div>\r\n              <div className=\"text-center p-4 bg-card border rounded-lg\">\r\n                <h4 className=\"font-semibold text-red-600 dark:text-red-400\">Economic Stress</h4>\r\n                <p className=\"text-sm mt-1\">GDP: Negative growth</p>\r\n                <p className=\"text-sm\">Inflation: Very high/low</p>\r\n                <p className=\"text-sm\">Unemployment: {'>'}8%</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Lesson Completion */}\r\n      <Card className=\"border-2 border-dashed border-primary/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"flex justify-center\">\r\n              {isCompleted ? (\r\n                <CheckCircle className=\"w-12 h-12 text-green-500\" />\r\n              ) : (\r\n                <PlayCircle className=\"w-12 h-12 text-primary\" />\r\n              )}\r\n            </div>\r\n            \r\n            {isCompleted ? (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-green-700 dark:text-green-300\">\r\n                  Lesson Completed! ðŸŽ‰\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Excellent! You now understand key economic indicators and how to interpret them.\r\n                </p>\r\n                {hasNext && onNext && (\r\n                  <Button onClick={onNext} className=\"mx-auto flex items-center\">\r\n                    Next Lesson: Monetary Policy\r\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold\">Ready to Continue?</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've learned about GDP, inflation, and unemployment indicators.\r\n                </p>\r\n                <Button onClick={handleComplete} size=\"lg\">\r\n                  Complete Lesson 4\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson5.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[494,497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[494,497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, Trophy, ArrowRight, Coins, ArrowUp, ArrowDown } from 'lucide-react';\r\n\r\ninterface EconomicsLesson5Props {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const EconomicsLesson5: React.FC<EconomicsLesson5Props> = ({ \r\n  onComplete, \r\n  onNext, \r\n  hasNext,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId = 5,\r\n  lessonTitle = \"Monetary Policy\"\r\n}) => {\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_complete_click', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      action: 'complete_button_clicked'\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_interaction', {\r\n      lesson_id: lessonId,\r\n      concept,\r\n      action: 'concept_viewed'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Lesson Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Trophy className=\"w-6 h-6 text-primary\" />\r\n            <CardTitle>Monetary Policy</CardTitle>\r\n            <Badge variant=\"outline\">Lesson 5</Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-lg\">\r\n            Monetary policy refers to the actions taken by a nation's central bank to control \r\n            the money supply and achieve macroeconomic goals such as stable prices, full employment, \r\n            and economic growth.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Central Banking */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Central Bank Functions</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Central banks (like the Federal Reserve in the US) are responsible for managing \r\n              the country's money supply and financial system stability.\r\n            </p>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">Key Functions:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Issue Currency:</strong> Control the nation's money supply</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Bank Regulation:</strong> Supervise and regulate banks</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Lender of Last Resort:</strong> Provide emergency funding to banks</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Payment System:</strong> Facilitate interbank payments</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Monetary Policy Tools */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Monetary Policy Tools</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-6\">\r\n            {/* Interest Rates */}\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <div className=\"flex items-center space-x-2 mb-2\">\r\n                <Coins className=\"w-5 h-5 text-green-600\" />\r\n                <h4 className=\"font-semibold text-green-700 dark:text-green-300\">Interest Rate Policy</h4>\r\n              </div>\r\n              <p className=\"text-sm mb-2\">\r\n                The federal funds rate is the primary tool for monetary policy.\r\n              </p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <ArrowDown className=\"w-4 h-4 text-green-500 mt-1 flex-shrink-0\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-sm\">Lower Rates</p>\r\n                    <p className=\"text-xs\">Stimulate borrowing and spending</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <ArrowUp className=\"w-4 h-4 text-red-500 mt-1 flex-shrink-0\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-sm\">Higher Rates</p>\r\n                    <p className=\"text-xs\">Reduce inflation and cool economy</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Reserve Requirements */}\r\n            <div className=\"bg-orange-50 dark:bg-orange-950/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n              <h4 className=\"font-semibold mb-2 text-orange-700 dark:text-orange-300\">Reserve Requirements</h4>\r\n              <p className=\"text-sm mb-2\">\r\n                The percentage of deposits banks must hold as reserves.\r\n              </p>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ Higher reserves = Less money to lend = Contractionary</li>\r\n                <li>â€¢ Lower reserves = More money to lend = Expansionary</li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Open Market Operations */}\r\n            <div className=\"bg-purple-50 dark:bg-purple-950/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\">\r\n              <h4 className=\"font-semibold mb-2 text-purple-700 dark:text-purple-300\">Open Market Operations</h4>\r\n              <p className=\"text-sm mb-2\">\r\n                Buying and selling government securities to control money supply.\r\n              </p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                <div>\r\n                  <p className=\"font-medium\">Buying Securities:</p>\r\n                  <p className=\"text-xs\">Increases money supply (expansionary)</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium\">Selling Securities:</p>\r\n                  <p className=\"text-xs\">Decreases money supply (contractionary)</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Expansionary vs Contractionary */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Types of Monetary Policy</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-3 text-green-700 dark:text-green-300 flex items-center\">\r\n                <ArrowUp className=\"w-5 h-5 mr-2\" />\r\n                Expansionary Policy\r\n              </h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <p><strong>Goal:</strong> Stimulate economic growth</p>\r\n                <p><strong>When Used:</strong> During recessions or slow growth</p>\r\n                <p><strong>Actions:</strong></p>\r\n                <ul className=\"ml-4 space-y-1\">\r\n                  <li>â€¢ Lower interest rates</li>\r\n                  <li>â€¢ Buy government securities</li>\r\n                  <li>â€¢ Reduce reserve requirements</li>\r\n                </ul>\r\n                <p><strong>Effects:</strong> Increased borrowing, spending, and investment</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n              <h4 className=\"font-semibold mb-3 text-red-700 dark:text-red-300 flex items-center\">\r\n                <ArrowDown className=\"w-5 h-5 mr-2\" />\r\n                Contractionary Policy\r\n              </h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <p><strong>Goal:</strong> Control inflation and cool economy</p>\r\n                <p><strong>When Used:</strong> During high inflation periods</p>\r\n                <p><strong>Actions:</strong></p>\r\n                <ul className=\"ml-4 space-y-1\">\r\n                  <li>â€¢ Raise interest rates</li>\r\n                  <li>â€¢ Sell government securities</li>\r\n                  <li>â€¢ Increase reserve requirements</li>\r\n                </ul>\r\n                <p><strong>Effects:</strong> Reduced borrowing, spending, and investment</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Real-World Example */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Case Study: 2008 Financial Crisis</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <p className=\"font-medium mb-2\">Federal Reserve Response:</p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                <div>\r\n                  <p className=\"font-semibold\">Actions Taken:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ Cut interest rates to near zero</li>\r\n                    <li>â€¢ Implemented quantitative easing</li>\r\n                    <li>â€¢ Provided emergency lending</li>\r\n                    <li>â€¢ Purchased mortgage-backed securities</li>\r\n                  </ul>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-semibold\">Objectives:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ Stabilize financial markets</li>\r\n                    <li>â€¢ Encourage lending</li>\r\n                    <li>â€¢ Prevent deflation</li>\r\n                    <li>â€¢ Support economic recovery</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Challenges and Limitations */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Monetary Policy Challenges</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-3\">\r\n            <div className=\"bg-gray-50 dark:bg-gray-950/20 p-3 rounded-lg border border-gray-200 dark:border-gray-800\">\r\n              <h4 className=\"font-semibold mb-2\">Key Challenges:</h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ <strong>Time Lags:</strong> Policy effects take time to materialize</li>\r\n                <li>â€¢ <strong>Zero Lower Bound:</strong> Interest rates can't go below zero</li>\r\n                <li>â€¢ <strong>Global Interconnectedness:</strong> International factors affect domestic policy</li>\r\n                <li>â€¢ <strong>Expectations:</strong> Market expectations can influence policy effectiveness</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Lesson Completion */}\r\n      <Card className=\"border-2 border-dashed border-primary/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"flex justify-center\">\r\n              {isCompleted ? (\r\n                <CheckCircle className=\"w-12 h-12 text-green-500\" />\r\n              ) : (\r\n                <Trophy className=\"w-12 h-12 text-primary\" />\r\n              )}\r\n            </div>\r\n            \r\n            {isCompleted ? (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-green-700 dark:text-green-300\">\r\n                  Lesson Completed! ðŸŽ‰\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Outstanding! You now understand how central banks use monetary policy to manage the economy.\r\n                </p>\r\n                {hasNext && onNext && (\r\n                  <Button onClick={onNext} className=\"mx-auto flex items-center\">\r\n                    Next Lesson: Fiscal Policy\r\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold\">Ready to Continue?</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've learned about monetary policy tools and their economic impacts.\r\n                </p>\r\n                <Button onClick={handleComplete} size=\"lg\">\r\n                  Complete Lesson 5\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson6.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[507,510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[507,510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, BookOpen, ArrowRight, DollarSign, TrendingUp, TrendingDown } from 'lucide-react';\r\n\r\ninterface EconomicsLesson6Props {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const EconomicsLesson6: React.FC<EconomicsLesson6Props> = ({ \r\n  onComplete, \r\n  onNext, \r\n  hasNext,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId = 6,\r\n  lessonTitle = \"Fiscal Policy\"\r\n}) => {\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_complete_click', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      action: 'complete_button_clicked'\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_interaction', {\r\n      lesson_id: lessonId,\r\n      concept,\r\n      action: 'concept_viewed'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Lesson Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <BookOpen className=\"w-6 h-6 text-primary\" />\r\n            <CardTitle>Fiscal Policy</CardTitle>\r\n            <Badge variant=\"outline\">Lesson 6</Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-lg\">\r\n            Fiscal policy refers to the government's use of spending and taxation to influence \r\n            the economy. It works alongside monetary policy to achieve economic stability and growth.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Government Spending */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Government Spending</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Government spending directly affects economic activity by creating demand for \r\n              goods and services, providing jobs, and investing in infrastructure.\r\n            </p>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">Types of Government Spending:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Discretionary Spending:</strong> Defense, education, infrastructure</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Mandatory Spending:</strong> Social Security, Medicare, debt interest</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Transfer Payments:</strong> Unemployment benefits, welfare programs</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Public Investment:</strong> Roads, bridges, research and development</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">Multiplier Effect:</h4>\r\n              <p className=\"text-sm\">\r\n                Government spending has a multiplier effect - every dollar spent by the government \r\n                generates more than one dollar of economic activity as it circulates through the economy.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Taxation */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Taxation Policy</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Taxes fund government operations and can be used as a tool to influence economic behavior \r\n              and redistribute income.\r\n            </p>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n                <h4 className=\"font-semibold mb-2 text-red-700 dark:text-red-300\">Types of Taxes:</h4>\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Income taxes</li>\r\n                  <li>â€¢ Corporate taxes</li>\r\n                  <li>â€¢ Sales taxes</li>\r\n                  <li>â€¢ Property taxes</li>\r\n                  <li>â€¢ Payroll taxes</li>\r\n                  <li>â€¢ Excise taxes</li>\r\n                </ul>\r\n              </div>\r\n\r\n              <div className=\"bg-orange-50 dark:bg-orange-950/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n                <h4 className=\"font-semibold mb-2 text-orange-700 dark:text-orange-300\">Tax Systems:</h4>\r\n                <ul className=\"space-y-2 text-sm\">\r\n                  <li><strong>Progressive:</strong> Higher rates for higher incomes</li>\r\n                  <li><strong>Proportional:</strong> Same rate for all income levels</li>\r\n                  <li><strong>Regressive:</strong> Lower rates for higher incomes</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-purple-50 dark:bg-purple-950/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\">\r\n              <h4 className=\"font-semibold mb-2 text-purple-700 dark:text-purple-300\">Tax Policy Effects:</h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                <div>\r\n                  <p className=\"font-medium\">Lower Taxes:</p>\r\n                  <p>Increase consumer spending and business investment</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium\">Higher Taxes:</p>\r\n                  <p>Reduce spending power but increase government revenue</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Expansionary vs Contractionary Fiscal Policy */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Types of Fiscal Policy</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-3 text-green-700 dark:text-green-300 flex items-center\">\r\n                <TrendingUp className=\"w-5 h-5 mr-2\" />\r\n                Expansionary Fiscal Policy\r\n              </h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <p><strong>Goal:</strong> Stimulate economic growth during recessions</p>\r\n                <p><strong>Methods:</strong></p>\r\n                <ul className=\"ml-4 space-y-1\">\r\n                  <li>â€¢ Increase government spending</li>\r\n                  <li>â€¢ Decrease taxes</li>\r\n                  <li>â€¢ Expand transfer payments</li>\r\n                </ul>\r\n                <p><strong>Effect:</strong> Higher budget deficits but increased GDP</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n              <h4 className=\"font-semibold mb-3 text-red-700 dark:text-red-300 flex items-center\">\r\n                <TrendingDown className=\"w-5 h-5 mr-2\" />\r\n                Contractionary Fiscal Policy\r\n              </h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <p><strong>Goal:</strong> Cool down an overheated economy</p>\r\n                <p><strong>Methods:</strong></p>\r\n                <ul className=\"ml-4 space-y-1\">\r\n                  <li>â€¢ Decrease government spending</li>\r\n                  <li>â€¢ Increase taxes</li>\r\n                  <li>â€¢ Reduce transfer payments</li>\r\n                </ul>\r\n                <p><strong>Effect:</strong> Lower budget deficits but reduced GDP growth</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Budget Balance */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Government Budget</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              The government budget reflects the balance between revenue (taxes) and expenditures (spending).\r\n            </p>\r\n            \r\n            <div className=\"bg-gray-50 dark:bg-gray-950/20 p-4 rounded-lg border border-gray-200 dark:border-gray-800\">\r\n              <h4 className=\"font-semibold mb-2\">Budget Scenarios:</h4>\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <DollarSign className=\"w-5 h-5 text-green-500\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-sm\">Budget Surplus</p>\r\n                    <p className=\"text-xs text-muted-foreground\">Revenue {'>'}  Expenditures</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <DollarSign className=\"w-5 h-5 text-gray-500\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-sm\">Balanced Budget</p>\r\n                    <p className=\"text-xs text-muted-foreground\">Revenue = Expenditures</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <DollarSign className=\"w-5 h-5 text-red-500\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-sm\">Budget Deficit</p>\r\n                    <p className=\"text-xs text-muted-foreground\">Revenue {'<'} Expenditures</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <h4 className=\"font-semibold mb-2\">National Debt:</h4>\r\n              <p className=\"text-sm\">\r\n                The accumulation of budget deficits over time. High debt levels can limit \r\n                future fiscal policy options and require interest payments that crowd out other spending.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Real-World Example */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Case Study: 2009 American Recovery Act</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <p className=\"font-medium mb-2\">Fiscal Stimulus Response to Great Recession:</p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                <div>\r\n                  <p className=\"font-semibold\">Package Components:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ $787 billion total spending</li>\r\n                    <li>â€¢ Tax cuts for individuals</li>\r\n                    <li>â€¢ Infrastructure investments</li>\r\n                    <li>â€¢ Extended unemployment benefits</li>\r\n                    <li>â€¢ Aid to state governments</li>\r\n                  </ul>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-semibold\">Objectives:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ Create jobs quickly</li>\r\n                    <li>â€¢ Boost consumer spending</li>\r\n                    <li>â€¢ Prevent state budget cuts</li>\r\n                    <li>â€¢ Invest in long-term growth</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Challenges and Limitations */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Fiscal Policy Challenges</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-3\">\r\n            <div className=\"bg-gray-50 dark:bg-gray-950/20 p-3 rounded-lg border border-gray-200 dark:border-gray-800\">\r\n              <h4 className=\"font-semibold mb-2\">Key Challenges:</h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ <strong>Time Lags:</strong> Legislative process delays implementation</li>\r\n                <li>â€¢ <strong>Political Constraints:</strong> Disagreements over spending priorities</li>\r\n                <li>â€¢ <strong>Crowding Out:</strong> Government borrowing may reduce private investment</li>\r\n                <li>â€¢ <strong>Debt Sustainability:</strong> Long-term fiscal health concerns</li>\r\n                <li>â€¢ <strong>Automatic Stabilizers:</strong> Programs that adjust automatically to economic conditions</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Lesson Completion */}\r\n      <Card className=\"border-2 border-dashed border-primary/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"flex justify-center\">\r\n              {isCompleted ? (\r\n                <CheckCircle className=\"w-12 h-12 text-green-500\" />\r\n              ) : (\r\n                <BookOpen className=\"w-12 h-12 text-primary\" />\r\n              )}\r\n            </div>\r\n            \r\n            {isCompleted ? (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-green-700 dark:text-green-300\">\r\n                  Lesson Completed! ðŸŽ‰\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Excellent work! You now understand how governments use fiscal policy to manage economic conditions.\r\n                </p>\r\n                {hasNext && onNext && (\r\n                  <Button onClick={onNext} className=\"mx-auto flex items-center\">\r\n                    Next Lesson: International Trade\r\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold\">Ready to Continue?</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've learned about government spending, taxation, and budget policy.\r\n                </p>\r\n                <Button onClick={handleComplete} size=\"lg\">\r\n                  Complete Lesson 6\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson7.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[499,502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[499,502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, TrendingUp, ArrowRight, Globe, ArrowUpDown, Shield } from 'lucide-react';\r\n\r\ninterface EconomicsLesson7Props {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const EconomicsLesson7: React.FC<EconomicsLesson7Props> = ({ \r\n  onComplete, \r\n  onNext, \r\n  hasNext,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId = 7,\r\n  lessonTitle = \"International Trade\"\r\n}) => {\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_complete_click', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      action: 'complete_button_clicked'\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_interaction', {\r\n      lesson_id: lessonId,\r\n      concept,\r\n      action: 'concept_viewed'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Lesson Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <TrendingUp className=\"w-6 h-6 text-primary\" />\r\n            <CardTitle>International Trade</CardTitle>\r\n            <Badge variant=\"outline\">Lesson 7</Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-lg\">\r\n            International trade involves the exchange of goods and services between countries. \r\n            It's driven by comparative advantage and creates economic benefits for all trading partners.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Comparative Advantage */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Comparative Advantage</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Comparative advantage is the ability of a country to produce a good at a lower \r\n              opportunity cost than another country. This principle explains why trade benefits all parties.\r\n            </p>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">Key Concepts:</h4>\r\n              <ul className=\"space-y-2\">\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Absolute Advantage:</strong> Ability to produce more of a good with same resources</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Comparative Advantage:</strong> Lower opportunity cost in production</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Specialization:</strong> Focus on producing goods with comparative advantage</span>\r\n                </li>\r\n                <li className=\"flex items-start space-x-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n                  <span><strong>Gains from Trade:</strong> Both countries benefit from specialization and exchange</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">Simple Example:</h4>\r\n              <p className=\"text-sm mb-2\">\r\n                Even if Country A can produce both cars and computers more efficiently than Country B, \r\n                both countries can benefit if Country A specializes in cars (where it has the greatest advantage) \r\n                and Country B specializes in computers.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Benefits of Trade */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Benefits of International Trade</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300 flex items-center\">\r\n                <Globe className=\"w-5 h-5 mr-2\" />\r\n                Economic Benefits\r\n              </h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ Increased efficiency through specialization</li>\r\n                <li>â€¢ Access to larger markets</li>\r\n                <li>â€¢ Lower prices for consumers</li>\r\n                <li>â€¢ Greater variety of products</li>\r\n                <li>â€¢ Economies of scale</li>\r\n                <li>â€¢ Technology transfer</li>\r\n              </ul>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300 flex items-center\">\r\n                <ArrowUpDown className=\"w-5 h-5 mr-2\" />\r\n                Social Benefits\r\n              </h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ Cultural exchange</li>\r\n                <li>â€¢ Improved living standards</li>\r\n                <li>â€¢ Innovation and competition</li>\r\n                <li>â€¢ Job creation in export industries</li>\r\n                <li>â€¢ Economic development</li>\r\n                <li>â€¢ Peace through interdependence</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Trade Barriers */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Trade Barriers and Protection</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Despite the benefits of free trade, countries sometimes implement trade barriers \r\n              to protect domestic industries or for strategic reasons.\r\n            </p>\r\n            \r\n            <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n              <h4 className=\"font-semibold mb-2 text-red-700 dark:text-red-300 flex items-center\">\r\n                <Shield className=\"w-5 h-5 mr-2\" />\r\n                Types of Trade Barriers\r\n              </h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                <div>\r\n                  <p className=\"font-semibold mb-1\">Tariffs:</p>\r\n                  <p className=\"mb-2\">Taxes on imported goods</p>\r\n                  <p className=\"font-semibold mb-1\">Quotas:</p>\r\n                  <p>Limits on quantity of imports</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-semibold mb-1\">Subsidies:</p>\r\n                  <p className=\"mb-2\">Government support for domestic producers</p>\r\n                  <p className=\"font-semibold mb-1\">Standards:</p>\r\n                  <p>Technical or safety requirements</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-orange-50 dark:bg-orange-950/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n              <h4 className=\"font-semibold mb-2 text-orange-700 dark:text-orange-300\">Arguments for Protection:</h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ Protect domestic jobs</li>\r\n                <li>â€¢ National security concerns</li>\r\n                <li>â€¢ Infant industry support</li>\r\n                <li>â€¢ Unfair foreign competition</li>\r\n                <li>â€¢ Environmental standards</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Exchange Rates */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Exchange Rates and Trade</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Exchange rates determine the relative value of currencies and significantly \r\n              affect international trade flows.\r\n            </p>\r\n            \r\n            <div className=\"bg-purple-50 dark:bg-purple-950/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\">\r\n              <h4 className=\"font-semibold mb-2 text-purple-700 dark:text-purple-300\">Exchange Rate Effects:</h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                <div>\r\n                  <p className=\"font-semibold\">Currency Appreciation:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ Makes exports more expensive</li>\r\n                    <li>â€¢ Makes imports cheaper</li>\r\n                    <li>â€¢ Can hurt export industries</li>\r\n                    <li>â€¢ Benefits consumers buying imports</li>\r\n                  </ul>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-semibold\">Currency Depreciation:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ Makes exports cheaper</li>\r\n                    <li>â€¢ Makes imports more expensive</li>\r\n                    <li>â€¢ Can boost export industries</li>\r\n                    <li>â€¢ May increase inflation</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Trade Organizations */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>International Trade Organizations</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n                <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">World Trade Organization (WTO)</h4>\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Facilitates global trade</li>\r\n                  <li>â€¢ Resolves trade disputes</li>\r\n                  <li>â€¢ Promotes free trade</li>\r\n                  <li>â€¢ Sets international trade rules</li>\r\n                </ul>\r\n              </div>\r\n\r\n              <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n                <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">Regional Trade Agreements</h4>\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ NAFTA/USMCA (North America)</li>\r\n                  <li>â€¢ European Union</li>\r\n                  <li>â€¢ ASEAN (Southeast Asia)</li>\r\n                  <li>â€¢ MERCOSUR (South America)</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Real-World Example */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Case Study: US-China Trade</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <p className=\"font-medium mb-2\">Trade Relationship Dynamics:</p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                <div>\r\n                  <p className=\"font-semibold\">US Exports to China:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ Agricultural products (soybeans, corn)</li>\r\n                    <li>â€¢ Aircraft and machinery</li>\r\n                    <li>â€¢ Technology products</li>\r\n                    <li>â€¢ Services</li>\r\n                  </ul>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-semibold\">Chinese Exports to US:</p>\r\n                  <ul className=\"mt-1 space-y-1\">\r\n                    <li>â€¢ Electronics and computers</li>\r\n                    <li>â€¢ Textiles and clothing</li>\r\n                    <li>â€¢ Toys and games</li>\r\n                    <li>â€¢ Furniture</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n              <p className=\"mt-3 text-sm\">\r\n                Recent trade tensions have highlighted the complex relationship between trade \r\n                policy, domestic politics, and global economic integration.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Trade Balance */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Balance of Trade</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-gray-50 dark:bg-gray-950/20 p-4 rounded-lg border border-gray-200 dark:border-gray-800\">\r\n              <h4 className=\"font-semibold mb-2\">Trade Balance Concepts:</h4>\r\n              <div className=\"space-y-3\">\r\n                <div>\r\n                  <p className=\"font-medium text-green-600 dark:text-green-400\">Trade Surplus:</p>\r\n                  <p className=\"text-sm\">Exports {'>'}  Imports (positive balance)</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium text-red-600 dark:text-red-400\">Trade Deficit:</p>\r\n                  <p className=\"text-sm\">Imports {'>'}  Exports (negative balance)</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium text-gray-600 dark:text-gray-400\">Balanced Trade:</p>\r\n                  <p className=\"text-sm\">Exports = Imports</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Lesson Completion */}\r\n      <Card className=\"border-2 border-dashed border-primary/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"flex justify-center\">\r\n              {isCompleted ? (\r\n                <CheckCircle className=\"w-12 h-12 text-green-500\" />\r\n              ) : (\r\n                <TrendingUp className=\"w-12 h-12 text-primary\" />\r\n              )}\r\n            </div>\r\n            \r\n            {isCompleted ? (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-green-700 dark:text-green-300\">\r\n                  Lesson Completed! ðŸŽ‰\r\n                </h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Outstanding! You now understand international trade principles and their global impact.\r\n                </p>\r\n                {hasNext && onNext && (\r\n                  <Button onClick={onNext} className=\"mx-auto flex items-center\">\r\n                    Next Lesson: Economic Growth & Development\r\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold\">Ready to Continue?</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've learned about comparative advantage, trade barriers, and global economics.\r\n                </p>\r\n                <Button onClick={handleComplete} size=\"lg\">\r\n                  Complete Lesson 7\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\economics\\EconomicsLesson8.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[544,547],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[544,547],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { CheckCircle, ArrowRight, Sprout, TrendingUp, Users, Factory } from 'lucide-react';\r\n\r\ninterface EconomicsLesson8Props {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const EconomicsLesson8: React.FC<EconomicsLesson8Props> = ({ \r\n  onComplete, \r\n  onNext, \r\n  hasNext,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId = 8,\r\n  lessonTitle = \"Economic Growth & Development\"\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_complete_click', {\r\n      lesson_id: lessonId,\r\n      lesson_title: lessonTitle,\r\n      action: 'complete_button_clicked'\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_interaction', {\r\n      lesson_id: lessonId,\r\n      concept,\r\n      action: 'concept_viewed'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Lesson Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <CheckCircle className=\"w-6 h-6 text-primary\" />\r\n            <CardTitle>Economic Growth & Development</CardTitle>\r\n            <Badge variant=\"outline\">Lesson 8</Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-lg\">\r\n            Economic growth and development are fundamental goals for nations worldwide. \r\n            Understanding the factors that drive long-term prosperity helps explain differences \r\n            in living standards between countries.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Economic Growth vs Development */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Growth vs Development</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300 flex items-center\">\r\n                <TrendingUp className=\"w-5 h-5 mr-2\" />\r\n                Economic Growth\r\n              </h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <p><strong>Definition:</strong> Increase in real GDP over time</p>\r\n                <p><strong>Measurement:</strong> GDP growth rate, per capita income</p>\r\n                <p><strong>Focus:</strong> Quantitative expansion of the economy</p>\r\n                <p><strong>Indicators:</strong></p>\r\n                <ul className=\"ml-4 space-y-1\">\r\n                  <li>â€¢ Real GDP growth</li>\r\n                  <li>â€¢ Productivity improvements</li>\r\n                  <li>â€¢ Capital accumulation</li>\r\n                  <li>â€¢ Labor force expansion</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300 flex items-center\">\r\n                <Users className=\"w-5 h-5 mr-2\" />\r\n                Economic Development\r\n              </h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <p><strong>Definition:</strong> Improvement in quality of life and living standards</p>\r\n                <p><strong>Measurement:</strong> HDI, life expectancy, education levels</p>\r\n                <p><strong>Focus:</strong> Qualitative improvements in society</p>\r\n                <p><strong>Indicators:</strong></p>\r\n                <ul className=\"ml-4 space-y-1\">\r\n                  <li>â€¢ Health and education</li>\r\n                  <li>â€¢ Income distribution</li>\r\n                  <li>â€¢ Environmental sustainability</li>\r\n                  <li>â€¢ Social progress</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Factors of Economic Growth */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Drivers of Economic Growth</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Economic growth depends on the efficient use and expansion of key economic resources \r\n              and factors of production.\r\n            </p>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-purple-50 dark:bg-purple-950/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\">\r\n                <h4 className=\"font-semibold mb-2 text-purple-700 dark:text-purple-300 flex items-center\">\r\n                  <Factory className=\"w-5 h-5 mr-2\" />\r\n                  Capital Formation\r\n                </h4>\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Physical capital (machinery, infrastructure)</li>\r\n                  <li>â€¢ Human capital (education, skills)</li>\r\n                  <li>â€¢ Financial capital (savings, investment)</li>\r\n                  <li>â€¢ Technology and innovation</li>\r\n                </ul>\r\n              </div>\r\n\r\n              <div className=\"bg-orange-50 dark:bg-orange-950/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n                <h4 className=\"font-semibold mb-2 text-orange-700 dark:text-orange-300 flex items-center\">\r\n                  <Sprout className=\"w-5 h-5 mr-2\" />\r\n                  Natural Resources\r\n                </h4>\r\n                <ul className=\"space-y-1 text-sm\">\r\n                  <li>â€¢ Land and raw materials</li>\r\n                  <li>â€¢ Energy resources</li>\r\n                  <li>â€¢ Climate and geography</li>\r\n                  <li>â€¢ Sustainable resource management</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <h4 className=\"font-semibold mb-2 text-yellow-700 dark:text-yellow-300\">Institutional Factors:</h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                <ul className=\"space-y-1\">\r\n                  <li>â€¢ Property rights protection</li>\r\n                  <li>â€¢ Rule of law</li>\r\n                  <li>â€¢ Political stability</li>\r\n                  <li>â€¢ Low corruption</li>\r\n                </ul>\r\n                <ul className=\"space-y-1\">\r\n                  <li>â€¢ Efficient government</li>\r\n                  <li>â€¢ Open markets</li>\r\n                  <li>â€¢ Financial system development</li>\r\n                  <li>â€¢ Education system quality</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Development Indicators */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Measuring Development</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              While GDP measures economic output, development requires broader indicators \r\n              that capture human welfare and sustainability.\r\n            </p>\r\n            \r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">Human Development Index (HDI)</h4>\r\n              <p className=\"text-sm mb-2\">\r\n                Composite measure combining three dimensions of human development:\r\n              </p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm\">\r\n                <div className=\"bg-white dark:bg-green-900/20 p-2 rounded\">\r\n                  <p className=\"font-medium\">Health</p>\r\n                  <p className=\"text-xs\">Life expectancy at birth</p>\r\n                </div>\r\n                <div className=\"bg-white dark:bg-green-900/20 p-2 rounded\">\r\n                  <p className=\"font-medium\">Education</p>\r\n                  <p className=\"text-xs\">Years of schooling</p>\r\n                </div>\r\n                <div className=\"bg-white dark:bg-green-900/20 p-2 rounded\">\r\n                  <p className=\"font-medium\">Income</p>\r\n                  <p className=\"text-xs\">GNI per capita</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <h4 className=\"font-semibold mb-2 text-blue-700 dark:text-blue-300\">Other Development Indicators:</h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                <ul className=\"space-y-1\">\r\n                  <li>â€¢ Poverty rates</li>\r\n                  <li>â€¢ Income inequality (Gini coefficient)</li>\r\n                  <li>â€¢ Infant mortality rate</li>\r\n                  <li>â€¢ Literacy rates</li>\r\n                </ul>\r\n                <ul className=\"space-y-1\">\r\n                  <li>â€¢ Access to clean water</li>\r\n                  <li>â€¢ Environmental quality</li>\r\n                  <li>â€¢ Gender equality measures</li>\r\n                  <li>â€¢ Social mobility indices</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Development Stages */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Stages of Economic Development</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <p>\r\n              Countries typically progress through different stages of development, \r\n              each characterized by distinct economic structures and challenges.\r\n            </p>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n                <h4 className=\"font-semibold mb-2 text-red-700 dark:text-red-300\">1. Traditional Economy</h4>\r\n                <p className=\"text-sm\">Agriculture-based, subsistence farming, limited technology, low productivity</p>\r\n              </div>\r\n\r\n              <div className=\"bg-orange-50 dark:bg-orange-950/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n                <h4 className=\"font-semibold mb-2 text-orange-700 dark:text-orange-300\">2. Transitional Stage</h4>\r\n                <p className=\"text-sm\">Infrastructure development, improved agriculture, population growth, early industrialization</p>\r\n              </div>\r\n\r\n              <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n                <h4 className=\"font-semibold mb-2 text-yellow-700 dark:text-yellow-300\">3. Industrial Development</h4>\r\n                <p className=\"text-sm\">Manufacturing growth, urbanization, technology adoption, capital accumulation</p>\r\n              </div>\r\n\r\n              <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n                <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">4. Mature Economy</h4>\r\n                <p className=\"text-sm\">Service sector dominance, high technology, innovation-driven, high living standards</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Challenges and Solutions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Development Challenges</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"bg-red-50 dark:bg-red-950/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n              <h4 className=\"font-semibold mb-2 text-red-700 dark:text-red-300\">Common Challenges:</h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ Poverty and inequality</li>\r\n                <li>â€¢ Lack of infrastructure</li>\r\n                <li>â€¢ Poor governance</li>\r\n                <li>â€¢ Limited access to capital</li>\r\n                <li>â€¢ Brain drain</li>\r\n                <li>â€¢ Environmental degradation</li>\r\n                <li>â€¢ Population pressures</li>\r\n              </ul>\r\n            </div>\r\n\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">Development Strategies:</h4>\r\n              <ul className=\"space-y-1 text-sm\">\r\n                <li>â€¢ Education investment</li>\r\n                <li>â€¢ Infrastructure development</li>\r\n                <li>â€¢ Healthcare improvements</li>\r\n                <li>â€¢ Good governance</li>\r\n                <li>â€¢ Foreign investment attraction</li>\r\n                <li>â€¢ Technology transfer</li>\r\n                <li>â€¢ Sustainable practices</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Real-World Examples */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Success Stories</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-yellow-50 dark:bg-yellow-950/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800\">\r\n              <p className=\"font-medium mb-2\">East Asian Tigers:</p>\r\n              <p className=\"text-sm mb-2\">\r\n                South Korea, Taiwan, Singapore, and Hong Kong achieved rapid economic growth \r\n                from the 1960s-1990s through:\r\n              </p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                <ul className=\"space-y-1\">\r\n                  <li>â€¢ Export-oriented industrialization</li>\r\n                  <li>â€¢ Heavy investment in education</li>\r\n                  <li>â€¢ Strong government planning</li>\r\n                </ul>\r\n                <ul className=\"space-y-1\">\r\n                  <li>â€¢ Technology adoption</li>\r\n                  <li>â€¢ High savings rates</li>\r\n                  <li>â€¢ Political stability</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n              <p className=\"font-medium mb-2\">China and India:</p>\r\n              <p className=\"text-sm\">\r\n                Recent examples of large countries achieving sustained growth through \r\n                market reforms, technology adoption, and integration into global economy.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Sustainable Development */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Sustainable Development Goals</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <p className=\"text-sm\">\r\n              The UN's 17 Sustainable Development Goals provide a framework for balanced \r\n              economic, social, and environmental progress.\r\n            </p>\r\n            \r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n              <h4 className=\"font-semibold mb-2 text-green-700 dark:text-green-300\">Key Principles:</h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm\">\r\n                <div>\r\n                  <p className=\"font-medium\">Economic</p>\r\n                  <p>Growth, innovation, decent work</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium\">Social</p>\r\n                  <p>Equity, health, education</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium\">Environmental</p>\r\n                  <p>Climate action, clean energy</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Course Completion */}\r\n      <Card className=\"border-2 border-dashed border-primary/30 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-950/20 dark:to-blue-950/20\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"flex justify-center\">\r\n              {isCompleted ? (\r\n                <div className=\"relative\">\r\n                  <CheckCircle className=\"w-16 h-16 text-green-500\" />\r\n                  <div className=\"absolute -top-2 -right-2\">\r\n                    ðŸŽ‰\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <CheckCircle className=\"w-12 h-12 text-primary\" />\r\n              )}\r\n            </div>\r\n            \r\n            {isCompleted ? (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-2xl font-bold text-green-700 dark:text-green-300\">\r\n                  ðŸŽ“ Course Completed! ðŸŽ‰\r\n                </h3>\r\n                <p className=\"text-muted-foreground max-w-2xl mx-auto\">\r\n                  Congratulations! You've completed the entire Introduction to Modern Economics course. \r\n                  You now have a solid foundation in economic principles, from basic supply and demand \r\n                  to complex macroeconomic policies and international trade.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-card p-4 rounded-lg border max-w-md mx-auto\">\r\n                  <h4 className=\"font-semibold mb-2\">What You've Learned:</h4>\r\n                  <ul className=\"text-sm space-y-1 text-left\">\r\n                    <li>âœ“ Basic economic principles</li>\r\n                    <li>âœ“ Supply and demand analysis</li>\r\n                    <li>âœ“ Market structures</li>\r\n                    <li>âœ“ Economic indicators</li>\r\n                    <li>âœ“ Monetary and fiscal policy</li>\r\n                    <li>âœ“ International trade</li>\r\n                    <li>âœ“ Economic growth and development</li>\r\n                  </ul>\r\n                </div>\r\n                <Button onClick={() => navigate('/dashboard/learner/courses')} size=\"lg\" className=\"mx-auto\">\r\n                  Return to My Courses\r\n                </Button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold\">Complete Your Economics Journey!</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've learned about economic growth, development indicators, and sustainable development. \r\n                  Ready to complete the course?\r\n                </p>\r\n                <Button onClick={handleComplete} size=\"lg\" className=\"bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700\">\r\n                  Complete Final Lesson\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicCriticalThinkingCoursePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson1_1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson1_2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson2_1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson2_2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson3_1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson3_2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson4_1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson4_2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\logic\\LogicLesson5_1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson1.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[439,442],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[439,442],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Brain, Users, BookOpen } from 'lucide-react';\r\nimport humanBrainForestImage from '@/assets/human-brain-forest.jpg';\r\n\r\ninterface NeurodiversityLesson1Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson1: React.FC<NeurodiversityLesson1Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_click', {\r\n      concept,\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-blue-100 dark:bg-blue-900/30 rounded-full\">\r\n          <Brain className=\"w-5 h-5 mr-2 text-blue-600\" />\r\n          <span className=\"text-blue-800 dark:text-blue-200 font-semibold\">UNIT 1: A NEW WAY OF THINKING</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 1.1: What is Neurodiversity?</h1>\r\n        <p className=\"text-xl text-muted-foreground\">A New Lens for Understanding the Brain</p>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <BookOpen className=\"w-6 h-6 mr-2\" />\r\n            A New Lens for Understanding the Brain\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              Neurodiversity is a concept that challenges the traditional view of neurological differences as disorders. Instead, it proposes that variations in brain functionâ€”from how we learn and socialize to how we pay attentionâ€”are a natural and valuable part of human diversity. Think of it like <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('biodiversity')}\r\n              >biodiversity</strong> in an ecosystem. A healthy, robust ecosystem isn't one with just a single type of tree; it's one with a wide variety of plants and animals that interact in complex ways. In the same way, a diverse society is a more resilient and innovative one.\r\n            </p>\r\n            <p>\r\n              This idea represents a profound shift. For decades, the dominant perspective was the <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('medical_model')}\r\n              >medical model</strong>, which viewed neurological differences as medical problems to be \"cured\" or \"fixed.\" The neurodiversity movement, however, champions a <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('social_model')}\r\n              >social model</strong>, which argues that the real issue isn't the individual's brain, but a society that is not built to accommodate a wide range of minds. It asks, \"What can our environment do to support people?\"\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Case Study */}\r\n      <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n        <CardHeader>\r\n          <CardTitle className=\"text-blue-800 dark:text-blue-200\">Case Study: The Human Brain Forest</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"w-full mb-6\">\r\n            <img \r\n              src={humanBrainForestImage} \r\n              alt=\"The Human Brain Forest - A metaphorical illustration showing different types of thinking as different trees in a diverse forest ecosystem\" \r\n              className=\"w-full max-w-2xl mx-auto rounded-lg shadow-md\"\r\n            />\r\n          </div>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              Imagine a team working on a new app. The lead developer is highly logical and systematic, preferring a clear, step-by-step process. The graphic designer is dyslexic and thinks in creative, non-linear ways, visualizing the entire user experience as a whole. The marketing manager has ADHD and jumps between ideas, connecting unrelated concepts to create a unique campaign. Their neurotypical manager values all of these approaches.\r\n            </p>\r\n            <p>\r\n              Each person's unique way of thinking is like a different \"tree\" in the team's \"forest.\" The systematic thinker is the strong, straight trunk, providing structure. The visual thinker is the broad canopy, providing creative cover. The associative thinker is the vibrant undergrowth, linking everything together in unexpected ways.\r\n            </p>\r\n          </div>\r\n          <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n            <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n            <p className=\"text-muted-foreground\">\r\n              Think about a time you had a group project. Did you notice people approaching the problem differently? Was there a \"tree\" that felt different from yours? How did that difference contribute to the final project, even if it felt confusing at the time?\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Key Terms */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Key Terms and Their History</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"border-l-4 border-l-green-500 pl-4\">\r\n              <h4 className=\"font-semibold\">Neurodiversity:</h4>\r\n              <p className=\"text-muted-foreground\">\r\n                The term was coined in 1998 by Australian sociologist Judy Singer. She used it to advocate for the rights of autistic people and to promote the idea that neurological differences are a form of human biodiversity.\r\n              </p>\r\n            </div>\r\n            <div className=\"border-l-4 border-l-green-500 pl-4\">\r\n              <h4 className=\"font-semibold\">Neurodiverse:</h4>\r\n              <p className=\"text-muted-foreground\">\r\n                An individual whose brain functions in a way that diverges significantly from the neurotypical majority. This term was created to be more empowering and inclusive than older clinical labels.\r\n              </p>\r\n            </div>\r\n            <div className=\"border-l-4 border-l-green-500 pl-4\">\r\n              <h4 className=\"font-semibold\">Neurotypical:</h4>\r\n              <p className=\"text-muted-foreground\">\r\n                An individual whose brain functions in a way that aligns with the societal norm. It is a necessary term to highlight the diversity that exists and to avoid pathologizing differences.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Myth vs Fact */}\r\n      <div className=\"space-y-4\">\r\n        <h3 className=\"text-xl font-bold\">Myth vs. Fact: Unpacking the Misconceptions</h3>\r\n        \r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> Neurodiversity is a new, trendy concept that romanticizes disabilities.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> The concept has existed for over two decades and is supported by a growing body of scientific research and advocacy. It doesn't deny the challenges associated with neurodiversity; instead, it reframes them in a way that promotes dignity and empowers individuals to seek appropriate support without shame.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> It's just a way to avoid getting a diagnosis.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> The neurodiversity movement does not discourage diagnoses. For many people, a formal diagnosis provides access to accommodations and a community of people with similar experiences. The movement simply wants to ensure that a diagnosis is not seen as a label of inferiority.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Conclusion */}\r\n      <Card className=\"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Users className=\"w-6 h-6 mr-2\" />\r\n            The Full Teaching Moment: Building a Foundation of Understanding\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              At its core, this lesson is your first step toward self-discovery. For a long time, the world may have made you feel like you were trying to fit into a box that was too small. This course is about throwing that box away. It's about recognizing that every brain has its own unique architecture. You are not a broken version of a neurotypical person. You are a unique and valuable human being, and by understanding your own mind, you can build a personalized system for success. Your journey starts now. Let's begin.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Lesson\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson2.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[371,374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[371,374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Lightbulb, Eye, Zap, Cog } from 'lucide-react';\r\n\r\ninterface NeurodiversityLesson2Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson2: React.FC<NeurodiversityLesson2Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_click', {\r\n      concept,\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-blue-100 dark:bg-blue-900/30 rounded-full\">\r\n          <Lightbulb className=\"w-5 h-5 mr-2 text-blue-600\" />\r\n          <span className=\"text-blue-800 dark:text-blue-200 font-semibold\">UNIT 1: A NEW WAY OF THINKING</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 1.2: Your Brain's Superpowers</h1>\r\n        <p className=\"text-xl text-muted-foreground\">Reframing Traits as Strengths</p>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Lightbulb className=\"w-6 h-6 mr-2\" />\r\n            Reframing Traits as Strengths\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              In this lesson, we reframe common neurodiverse traits as powerful strengths. Your brain is not a weakness; it's an asset. Your unique wiring is a source of talent that many neurotypical individuals don't possess. The key is to stop viewing your traits through a negative lens and start seeing their potential.\r\n            </p>\r\n            <p>\r\n              Here are some examples of how common neurodiverse traits can be leveraged as superpowers:\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Dyslexia Superpower */}\r\n      <Card className=\"border-l-4 border-l-purple-500\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center text-purple-700 dark:text-purple-300\">\r\n            <Eye className=\"w-6 h-6 mr-2\" />\r\n            Dyslexia: The Creative Visionary\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              While dyslexia can present challenges with decoding text, the brain often develops incredible strengths to compensate. This can lead to a superior ability for <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('pattern_recognition')}\r\n              >pattern recognition</strong>, <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('spatial_reasoning')}\r\n              >spatial reasoning</strong>, and <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('holistic_thinking')}\r\n              >holistic thinking</strong>. Instead of processing information in a slow, linear way, the dyslexic mind can often see the entire system at once, making it a natural for fields like engineering, architecture, and creative arts.\r\n            </p>\r\n          </div>\r\n          \r\n          <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Architect Who Sees in 3D</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <p>\r\n                An architect with dyslexia struggles to read building codes but can walk into a room and instantly visualize it from every angle, understanding its spatial relationships and potential. When asked to solve a design problem, they don't draw a 2D floor plan first; they build a complex mental model and rotate it in their mind. This ability to \"see\" a problem from every side leads to innovative and elegant solutions.\r\n              </p>\r\n              <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                <p className=\"text-muted-foreground\">\r\n                  Can you remember a time when your brain seemed to skip steps and go straight to the answer? Maybe you saw a pattern in a math problem without knowing the formula, or you had a perfect vision of a project's end result before you knew how to get there. What does this tell you about your brain's unique ability?\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* ADHD Superpower */}\r\n      <Card className=\"border-l-4 border-l-orange-500\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center text-orange-700 dark:text-orange-300\">\r\n            <Zap className=\"w-6 h-6 mr-2\" />\r\n            ADHD: The Hyperfocused Innovator\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              The label \"attention deficit\" is a misnomer. A more accurate description is \"attention variability.\" A mind with ADHD can be highly associative, making connections between seemingly unrelated ideas, a key driver of <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('creativity')}\r\n              >creativity</strong> and <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('innovative_thinking')}\r\n              >thinking outside the box</strong>. Your ability for <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('hyperfocus')}\r\n              >hyperfocus</strong> on areas of passion is a superpower for deep, intense work, allowing you to achieve a level of productivity others can only dream of.\r\n            </p>\r\n          </div>\r\n          \r\n          <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Event Planner Who Connects Everything</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <p>\r\n                An event planner with ADHD is tasked with organizing a major conference. While a neurotypical planner might feel overwhelmed by the thousands of tiny details, the ADHD brain can rapidly jump between themâ€”from finding a speaker to arranging catering to securing a venueâ€”seeing how each detail affects the others. Their ability to manage a seemingly chaotic system of moving parts is their greatest asset.\r\n              </p>\r\n              <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                <p className=\"text-muted-foreground\">\r\n                  What is a topic or task that you can lose hours doing? What is it about that subject that allows your mind to enter a state of deep, intense focus? How can you apply that same energy to other parts of your life?\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Autism Superpower */}\r\n      <Card className=\"border-l-4 border-l-green-500\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center text-green-700 dark:text-green-300\">\r\n            <Cog className=\"w-6 h-6 mr-2\" />\r\n            Autism: The Systematic Problem Solver\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              You have a natural advantage in fields that require precision and logic. Strengths often include an exceptional <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('attention_to_detail')}\r\n              >attention to detail</strong>, a highly <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('logical_systematic_approach')}\r\n              >logical and systematic approach</strong> to tasks, and an extraordinary capacity for <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('deep_focus')}\r\n              >deep focus</strong> on specific subjects of interest. This makes you a natural for problem-solving, data analysis, and technical fields.\r\n            </p>\r\n          </div>\r\n          \r\n          <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Software Engineer</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <p>\r\n                A software engineer with autism is tasked with debugging a massive piece of code. While a neurotypical colleague might get frustrated by the complexity, the autistic mind can methodically break the problem down into a logical system. They can spot the tiny, misplaced comma or the flawed line of code that others overlooked, solving a problem that seemed impossible.\r\n              </p>\r\n              <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                <p className=\"text-muted-foreground\">\r\n                  Describe a process you enjoy, like building with blocks, following a recipe, or organizing a collection. What about the methodical, step-by-step nature of it appeals to you? How does it make you feel to see a chaotic system become orderly and predictable?\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Myth vs Fact */}\r\n      <div className=\"space-y-4\">\r\n        <h3 className=\"text-xl font-bold\">Myth vs. Fact: Unpacking the Misconceptions</h3>\r\n        \r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> Having ADHD means you are lazy and unmotivated.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> A person with ADHD is often trying to manage an overactive nervous system and an \"engine with no brakes.\" The feeling of being \"unmotivated\" is often related to a struggle with executive function and working on tasks that are not stimulating. It has nothing to do with a lack of effort or a desire to succeed.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> Autism means you lack empathy or emotion.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> Many people with autism feel emotions intensely, but they may express them differently. Some studies even suggest that autistic individuals can have a heightened sense of empathy for others they relate to, as they can more easily understand different perspectives.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Conclusion */}\r\n      <Card className=\"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Lightbulb className=\"w-6 h-6 mr-2\" />\r\n            The Full Teaching Moment: A Superpower, Not a Deficit\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              The goal of this lesson is to show you how to start seeing your traits not as personal failings, but as superpowers. Your unique wiring is not a flaw; it is a source of strength that society is just beginning to fully appreciate. We live in a world that is increasingly complex, and we need creative thinkers, systematic problem-solvers, and people who can see patterns that others miss. Your brain is a perfect fit for this new world. By understanding your unique strengths, you can choose a path in lifeâ€”and in your educationâ€”that is custom-made for your success. Don't ever forget how truly powerful your mind is.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Lesson\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson3.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[389,392],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[389,392],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Settings, Calendar, Palette, MessageSquare } from 'lucide-react';\r\n\r\ninterface NeurodiversityLesson3Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson3: React.FC<NeurodiversityLesson3Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_click', {\r\n      concept,\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-green-100 dark:bg-green-900/30 rounded-full\">\r\n          <Settings className=\"w-5 h-5 mr-2 text-green-600\" />\r\n          <span className=\"text-green-800 dark:text-green-200 font-semibold\">UNIT 2: STRATEGIES FOR SUCCESS</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 2.1: Foundational Learning Strategies</h1>\r\n        <p className=\"text-xl text-muted-foreground\">Building Your Own Operating System for Learning</p>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Settings className=\"w-6 h-6 mr-2\" />\r\n            Building Your Own Operating System for Learning\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              Just as a computer needs a specific operating system to run programs, your brain needs a set of strategies to learn effectively. The key to academic success is not to force your brain to be something it isn't, but to find the strategies that make it run efficiently.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Myth vs Fact */}\r\n      <div className=\"space-y-4\">\r\n        <h3 className=\"text-xl font-bold\">Myth vs. Fact: Unpacking the Misconceptions</h3>\r\n        \r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> I have to learn like everyone else to be successful.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> There is no single \"correct\" way to learn. Research into <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('universal_design_learning')}\r\n              >Universal Design for Learning (UDL)</strong> shows that what works for one person may not work for another. The most effective approach is to find what works for you and build your own learning system.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> I should force myself to sit still to study.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> Many neurodiverse individuals benefit from <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('movement_learning')}\r\n              >movement</strong> while learning. Research shows that physical activity can help with focus and information retention. Fidget toys, walking while studying, or taking short breaks can be highly effective tools for learning.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Core Strategies */}\r\n      <div className=\"space-y-6\">\r\n        <h3 className=\"text-xl font-bold\">Core Strategies: Your Personal Toolkit</h3>\r\n        \r\n        {/* Strategy 1: Structure and Predictability */}\r\n        <Card className=\"border-l-4 border-l-blue-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-blue-700 dark:text-blue-300\">\r\n              <Calendar className=\"w-6 h-6 mr-2\" />\r\n              Structure and Predictability\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                Neurodiverse brains often thrive on routine. Our platform is designed with clear deadlines and a structured format to reduce anxiety and free up your mental energy for learning.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Visual Scheduler</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A student with ADHD finds it hard to start tasks because they feel overwhelmed. They build a visual schedule using a calendar app, color-coding each subject and breaking down large assignments into smaller, manageable chunks. They also include short, 10-minute breaks to walk around, which helps them stay on track.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                  <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                  <p className=\"text-muted-foreground\">\r\n                    When you have a big task, do you feel overwhelmed? How can you apply the strategy of breaking it down into smaller parts? Try creating a simple schedule for a study session. Does seeing the plan laid out make you feel more in control?\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Strategy 2: Multisensory Learning */}\r\n        <Card className=\"border-l-4 border-l-purple-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-purple-700 dark:text-purple-300\">\r\n              <Palette className=\"w-6 h-6 mr-2\" />\r\n              Multisensory Learning\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                We go beyond text. Your brain may not process a long paragraph the same way. We encourage you to engage multiple senses. Use visual aids, interactive activities, and audio content to improve comprehension and retention.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Kinesthetic Learner</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A student with dyslexia and dyspraxia struggles to understand abstract concepts in economics. Instead of just reading about supply and demand, they use clay to build a physical model of the supply and demand curves. This hands-on, three-dimensional activity helps them internalize the concept in a way that words alone could not.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                  <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                  <p className=\"text-muted-foreground\">\r\n                    What senses help you learn best? Do you remember things by a visual image? By a sound? By doing something with your hands? How can you use that knowledge in your next class?\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Strategy 3: Self-Advocacy */}\r\n        <Card className=\"border-l-4 border-l-green-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-green-700 dark:text-green-300\">\r\n              <MessageSquare className=\"w-6 h-6 mr-2\" />\r\n              Self-Advocacy\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                This is a key skill for success. Learn to understand your own needs and to confidently communicate them. This isn't about asking for special treatment; it's about asking for the specific support you need to do your best work.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Email That Changed Everything</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A student with a processing disorder feels overwhelmed by the fast pace of a lecture. Instead of staying silent, they send a polite email to the professor asking for a PDF of the lecture slides so they can review them at their own pace. The professor agrees, and the student's grades improve dramatically.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                  <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                  <p className=\"text-muted-foreground\">\r\n                    What is one specific thing that you need to be a better student? It could be a quieter space, a longer break, or something else. How would you confidently communicate that need to a teacher, a friend, or a family member?\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Conclusion */}\r\n      <Card className=\"bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Settings className=\"w-6 h-6 mr-2\" />\r\n            The Full Teaching Moment: Building Your System for Success\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              Your brain is unique, and that means you deserve a unique learning system. There is no magic formula, but you are the best person to build one. This lesson is about empowering you with the tools to take control of your academic journey. Don't be afraid to experiment, to try new things, and to discard what doesn't work for you. By embracing who you are and what you need, you can design a path to success that is custom-made for you. You have the power to do this.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Lesson\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson4.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[375,378],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[375,378],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Monitor, Clock, Bot, Palette } from 'lucide-react';\r\n\r\ninterface NeurodiversityLesson4Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson4: React.FC<NeurodiversityLesson4Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_click', {\r\n      concept,\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-green-100 dark:bg-green-900/30 rounded-full\">\r\n          <Monitor className=\"w-5 h-5 mr-2 text-green-600\" />\r\n          <span className=\"text-green-800 dark:text-green-200 font-semibold\">UNIT 2: STRATEGIES FOR SUCCESS</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 2.2: The FPK University Advantage</h1>\r\n        <p className=\"text-xl text-muted-foreground\">A Platform Built for Your Brain</p>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Monitor className=\"w-6 h-6 mr-2\" />\r\n            A Platform Built for Your Brain\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              FPK University was not designed with a neurotypical student in mind. It was built for you. We recognize that one-size-fits-all education doesn't work. We offer the following features to support your learning, allowing you to bypass the friction that traditional learning environments often create.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Myth vs Fact */}\r\n      <div className=\"space-y-4\">\r\n        <h3 className=\"text-xl font-bold\">Myth vs. Fact: Unpacking the Misconceptions</h3>\r\n        \r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> Using technology and tools to learn is cheating.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> Assistive technology is a powerful tool for leveling the playing field. Just as a person with a broken leg uses crutches, a neurodiverse learner can use tools like text-to-speech software, noise-canceling headphones, and AI coaches to access information in a way that works for them. Technology isn't cheating; it's empowering.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> These tools are only for people with a formal diagnosis.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> These tools are for everyone. Our platform is designed using the principles of <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('universal_design_learning')}\r\n              >Universal Design for Learning (UDL)</strong>, which means that the features that help one group of students also benefit everyone. You do not need a diagnosis to use these tools effectively.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Core Platform Features */}\r\n      <div className=\"space-y-6\">\r\n        <h3 className=\"text-xl font-bold\">Core Platform Features:</h3>\r\n        \r\n        {/* Feature 1: Customizable Interface */}\r\n        <Card className=\"border-l-4 border-l-purple-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-purple-700 dark:text-purple-300\">\r\n              <Palette className=\"w-6 h-6 mr-2\" />\r\n              Customizable Interface\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                Our platform allows you to adjust font sizes, colors, and layouts to reduce sensory overload and optimize your focus. You have control over your own learning environment.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Sensory-Sensitive Learner</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A student with high sensory sensitivity finds that bright white screens and small text are overwhelming. They adjust the platform's settings to a dark theme with a larger, more readable font. This simple change drastically reduces their eye strain and allows them to focus on the content, not the screen itself.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                  <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                  <p className=\"text-muted-foreground\">\r\n                    If you were to design the perfect study space, what would it look like? What colors would you choose? What sounds would you filter out? What layout would help you focus? Our platform can help you create that digital space.\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Feature 2: Flexible Pacing */}\r\n        <Card className=\"border-l-4 border-l-orange-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-orange-700 dark:text-orange-300\">\r\n              <Clock className=\"w-6 h-6 mr-2\" />\r\n              Flexible Pacing\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                Our courses are self-paced, allowing you to take breaks and work at a rhythm that suits your energy levels and focus. This is a crucial element for managing your mental energy throughout the day.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Pomodoro Technique</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A student with a fluctuating energy level struggles to stay on task for long periods. They use the Pomodoro Technique, working for 25 minutes with a timer, and then taking a short 5-minute break. This predictable rhythm helps them manage their energy and prevents burnout.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                  <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                  <p className=\"text-muted-foreground\">\r\n                    For a one-hour study session, would you prefer to work for 50 minutes straight or to work in 25-minute sprints with 5-minute breaks? Which plan feels more manageable for you, and why?\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Feature 3: AI Study Coach */}\r\n        <Card className=\"border-l-4 border-l-blue-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-blue-700 dark:text-blue-300\">\r\n              <Bot className=\"w-6 h-6 mr-2\" />\r\n              AI Study Coach\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                Our AI coach uses a <strong \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('socratic_method')}\r\n                >Socratic method</strong> to provide structured, guided learning. It can help you organize thoughts, break down complex topics, and get to the root of a problem. It provides a judgment-free space for you to work through challenges.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Organizational Partner</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A student feels overwhelmed by a long list of research topics for an essay. They use the AI study coach to get started. The AI asks questions like, \"What is your main idea?\" and \"What are three key points that support it?\" This Socratic dialogue helps the student organize their thoughts and build a clear outline without a blank page.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                  <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                  <p className=\"text-muted-foreground\">\r\n                    How might an AI that asks you questions help you to organize a jumbled set of ideas in your head? How is that different from an AI that just gives you a summary?\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Conclusion */}\r\n      <Card className=\"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Monitor className=\"w-6 h-6 mr-2\" />\r\n            The Full Teaching Moment: A Partner in Learning\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              This platform is more than just a place to take coursesâ€”it's your partner in learning. We provide the tools and flexibility you need to succeed, but the real power comes from your willingness to use them. These features are not crutches; they are accelerators. They are designed to help you bypass the obstacles of traditional education and showcase your incredible potential. Embrace these tools, and make this platform your own. We are here to help you every step of the way.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Lesson\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson5.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[378,381],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[378,381],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { TrendingUp, Eye, Target, Search } from 'lucide-react';\r\n\r\ninterface NeurodiversityLesson5Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson5: React.FC<NeurodiversityLesson5Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_click', {\r\n      concept,\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-red-100 dark:bg-red-900/30 rounded-full\">\r\n          <TrendingUp className=\"w-5 h-5 mr-2 text-red-600\" />\r\n          <span className=\"text-red-800 dark:text-red-200 font-semibold\">UNIT 3: APPLYING YOUR STRENGTHS</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 3.1: Thriving in Economics</h1>\r\n        <p className=\"text-xl text-muted-foreground\">Economics: A Science of Patterns and Systems</p>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <TrendingUp className=\"w-6 h-6 mr-2\" />\r\n            Economics: A Science of Patterns and Systems\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              The entire field of economics is built on <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('patterns')}\r\n              >patterns</strong> and <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('relationships')}\r\n              >relationships</strong>. This is where your mind's unique wiring shines. You may not enjoy reading a dense textbook, but you are naturally equipped to understand the underlying logic that makes the economy tick. Don't feel pressured to read every single word; instead, use your visual and systematic strengths.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Myth vs Fact */}\r\n      <div className=\"space-y-4\">\r\n        <h3 className=\"text-xl font-bold\">Myth vs. Fact: Unpacking the Misconceptions</h3>\r\n        \r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> Economics is a subject about memorizing a lot of complicated facts.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> Economics is a science of cause and effect. It's about recognizing patterns and understanding relationships. Your neurodiverse ability to see connections and think in systems gives you a natural advantage in this field. You don't have to memorize; you can <strong>understand</strong> the logic.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> You have to be good at math to be good at economics.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> While math is a tool in economics, the most important skills are logic and reasoning. Many of the most successful economists and business leaders are big-picture thinkers who can see trends, not just numbers. Your ability to think in systems is a far greater asset than rote mathematical skill.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Your Strengths in Action */}\r\n      <div className=\"space-y-6\">\r\n        <h3 className=\"text-xl font-bold\">Your Strengths in Action:</h3>\r\n        \r\n        {/* Strength 1: Pattern Recognition */}\r\n        <Card className=\"border-l-4 border-l-blue-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-blue-700 dark:text-blue-300\">\r\n              <Eye className=\"w-6 h-6 mr-2\" />\r\n              Pattern Recognition\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                Instead of getting bogged down in text, focus on the charts, graphs, and visual aids. Use your ability to see patterns in data to understand concepts like supply and demand. Recreating graphs and models can be a powerful learning tool for you.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Financial Analyst</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A financial analyst with a neurodiverse mind might look at a complex stock market graph and instantly see a patternâ€”a repeating shape or trendâ€”that a neurotypical mind would have to analyze with slow, deliberate steps. This ability to spot patterns can lead to a significant competitive advantage. For example, they might be the first to notice a company's stock price repeating a specific pattern just before a major breakthrough, giving them a heads-up on the market.\r\n                </p>\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border\">\r\n                  <h4 className=\"font-bold text-blue-800 dark:text-blue-200 mb-2\">Moment of Reflection:</h4>\r\n                  <p className=\"text-muted-foreground\">\r\n                    What trends in the real world have you noticed that others don't seem to see? How can you apply this to your studies? Think about your favorite video game: did you notice a pattern in how the game works that gave you an advantage over other players? This is the same skill you'll use in this course.\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Strength 2: Hyperfocus */}\r\n        <Card className=\"border-l-4 border-l-orange-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-orange-700 dark:text-orange-300\">\r\n              <Target className=\"w-6 h-6 mr-2\" />\r\n              Hyperfocus\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                Use your capacity for deep, intense focus to master a single, complex topic. If a subject like the European Central Bank's policy or a company's corporate strategy fascinates you, dive in without distraction. This deep immersion is your path to becoming an expert.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Practical Application:</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <p>\r\n                  Find a news article about a company you find interesting. Set a timer for 15 minutes and dive into it with no distractions. What can you learn in a short amount of time when you are completely focused?\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Strength 3: Attention to Detail */}\r\n        <Card className=\"border-l-4 border-l-green-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-green-700 dark:text-green-300\">\r\n              <Search className=\"w-6 h-6 mr-2\" />\r\n              Attention to Detail\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                This will make you great at analyzing economic policies. You can spot the small details in a government budget or a trade agreement that others might miss. You can also use this strength to carefully check your work and identify small errors.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Real-World Example:</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <p>\r\n                  Think about a new government policy. A neurotypical person might focus on the headline, but your attention to detail could help you read the fine print. What could you learn about a tax cut that others would overlook?\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Conclusion */}\r\n      <Card className=\"bg-gradient-to-r from-blue-50 to-green-50 dark:from-blue-900/20 dark:to-green-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <TrendingUp className=\"w-6 h-6 mr-2\" />\r\n            The Full Teaching Moment: Your Brain's Economic Advantage\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              Economics is not a subject that requires a specific type of brain; it is a subject that rewards clear thinking, logical reasoning, and a systematic approach. Your neurodiverse mind is uniquely equipped to excel at this. Don't be intimidated by the numbers or the jargon. Instead, focus on the relationships and the cause-and-effect patterns. Your brain is wired to see these connections, and this course will give you the language to express what you already intuitively understand.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Lesson\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson6.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[376,379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[376,379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Users, Cog, Search, GitBranch } from 'lucide-react';\r\n\r\ninterface NeurodiversityLesson6Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson6: React.FC<NeurodiversityLesson6Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_click', {\r\n      concept,\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-red-100 dark:bg-red-900/30 rounded-full\">\r\n          <Users className=\"w-5 h-5 mr-2 text-red-600\" />\r\n          <span className=\"text-red-800 dark:text-red-200 font-semibold\">UNIT 3: APPLYING YOUR STRENGTHS</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 3.2: Excelling in Logic & Critical Thinking</h1>\r\n        <p className=\"text-xl text-muted-foreground\">Logic: A System for Thinking Clearly</p>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Users className=\"w-6 h-6 mr-2\" />\r\n            Logic: A System for Thinking Clearly\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              This course is a natural fit for a mind that is <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('logical')}\r\n              >logical</strong>, <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('systematic')}\r\n              >systematic</strong>, and pays <strong \r\n                className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                onClick={() => handleConceptClick('attention_to_detail')}\r\n              >attention to detail</strong>. You can think of logic as a set of rules for making sense of the world. While others may get lost in emotional arguments or fallacies, your brain can cut through the noise and get to the truth.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Myth vs Fact */}\r\n      <div className=\"space-y-4\">\r\n        <h3 className=\"text-xl font-bold\">Myth vs. Fact: Unpacking the Misconceptions</h3>\r\n        \r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> Arguments are just about who is loudest or most persuasive.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> An argument's strength depends on its internal logic, not its emotional appeal. Your logical and systematic mind is naturally equipped to evaluate this. You are less likely to be swayed by rhetoric and more likely to see the truth. This is a crucial skill in a world full of misinformation.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10\">\r\n          <CardContent className=\"pt-6\">\r\n            <p><strong>Myth:</strong> Logic is cold and has no place in human arguments.</p>\r\n            <p className=\"mt-2 text-muted-foreground\">\r\n              <strong>Fact:</strong> Logic is a tool for clarity, not a replacement for empathy. By using logic to ensure our arguments are sound, we can have more productive and honest conversations with people who think differently from us. A clear argument is a compassionate one.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Your Strengths in Action */}\r\n      <div className=\"space-y-6\">\r\n        <h3 className=\"text-xl font-bold\">Your Strengths in Action:</h3>\r\n        \r\n        {/* Strength 1: Systematic Thinking */}\r\n        <Card className=\"border-l-4 border-l-purple-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-purple-700 dark:text-purple-300\">\r\n              <Cog className=\"w-6 h-6 mr-2\" />\r\n              Systematic Thinking\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                You have a natural advantage in this subject. Use <strong \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('argument_mapping')}\r\n                >argument mapping</strong> as a primary study toolâ€”it's a structured and visual way to break down complex ideas that can be more effective than just reading.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Case Study: The Software Engineer</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  A software engineer with a highly logical mind builds programs by breaking down a large, abstract problem into a series of small, solvable steps. They see the code as a logical system. Think about an argument you heard recently. Try to draw a simple map with a main conclusion at the top and arrows pointing to the premises that support it. What does the structure look like to you?\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Strength 2: Attention to Detail */}\r\n        <Card className=\"border-l-4 border-l-green-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-green-700 dark:text-green-300\">\r\n              <Search className=\"w-6 h-6 mr-2\" />\r\n              Attention to Detail\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                This is your superpower for spotting <strong \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('logical_fallacies')}\r\n                >logical fallacies</strong>. You can identify the subtle errors in an argument that others would overlook.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Practical Application:</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  Find a news article or social media post that makes an argument you disagree with. Read it carefully. Can you find a single flaw in the logic, no matter how small? Use your attention to detail to find the weak point that others missed. Your ability to spot these issues will be a valuable skill in every area of your life.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Strength 3: Logical Reasoning */}\r\n        <Card className=\"border-l-4 border-l-blue-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center text-blue-700 dark:text-blue-300\">\r\n              <GitBranch className=\"w-6 h-6 mr-2\" />\r\n              Logical Reasoning\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"prose max-w-none dark:prose-invert\">\r\n              <p>\r\n                The formal rules of <strong \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('deductive_reasoning')}\r\n                >deductive</strong> and <strong \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('inductive_reasoning')}\r\n                >inductive reasoning</strong> will make sense to your logical mind. You'll be great at building strong, well-structured arguments that are impossible to tear down.\r\n              </p>\r\n            </div>\r\n            \r\n            <Card className=\"border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-blue-800 dark:text-blue-200 text-lg\">Build an Argument:</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p>\r\n                  Take a simple statement like, \"All dogs are mammals.\" Add a second premise and a conclusion to create a foolproof argument. What does the logical flow feel like? Practice building these small arguments to train your mind to see the underlying logic in more complex debates.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Conclusion */}\r\n      <Card className=\"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Users className=\"w-6 h-6 mr-2\" />\r\n            The Full Teaching Moment: Your Brain's Logical Superpower\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              Logic and critical thinking are not abstract subjects; they are practical skills that will help you in every area of your life. Your neurodiverse mind is uniquely equipped to excel at this. You can cut through the noise, see the underlying structure of an argument, and build a case that is sound and true. This course will give you the tools and the language to express what you already intuitively understand.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Lesson\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson7.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[397,400],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[397,400],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { CheckCircle, BookOpen, Brain, Settings, TrendingUp } from 'lucide-react';\r\n\r\ninterface NeurodiversityLesson7Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson7: React.FC<NeurodiversityLesson7Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const handleConceptClick = (concept: string) => {\r\n    trackInteraction?.('concept_click', {\r\n      concept,\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-indigo-100 dark:bg-indigo-900/30 rounded-full\">\r\n          <CheckCircle className=\"w-5 h-5 mr-2 text-indigo-600\" />\r\n          <span className=\"text-indigo-800 dark:text-indigo-200 font-semibold\">UNIT 4: INTERACTIVE STUDY GUIDE</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 4.1: Key Concepts Review</h1>\r\n        <p className=\"text-xl text-muted-foreground\">A Quick Review of Core Ideas</p>\r\n      </div>\r\n\r\n      {/* Introduction */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <BookOpen className=\"w-6 h-6 mr-2\" />\r\n            Review Overview\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              This section is designed to help you quickly review the most important ideas from each unit. Read through the key concepts, reflect on them, and then test your knowledge in the next lesson's quiz.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Unit 1 Review */}\r\n      <Card className=\"border-l-4 border-l-blue-500\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center text-blue-700 dark:text-blue-300\">\r\n            <Brain className=\"w-6 h-6 mr-2\" />\r\n            Unit 1: A New Way of Thinking\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4\">\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('neurodiversity')}\r\n                >\r\n                  Neurodiversity:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Challenges traditional views of neurological differences as disorders, positing them as natural, valuable variations in human brain function.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('medical_vs_social_model')}\r\n                >\r\n                  Medical Model vs. Social Model:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                The medical model views neurological differences as problems to be cured, while the social model argues that societal structures are the issue, not the individual's brain.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('reframing_traits')}\r\n                >\r\n                  Reframing Traits as Strengths:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                The central idea that common neurodiverse traits can be seen as powerful assets.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('superpowers')}\r\n                >\r\n                  Superpowers:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Dyslexia (pattern recognition), ADHD (hyperfocus), and Autism (systematic problem-solving).\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Unit 2 Review */}\r\n      <Card className=\"border-l-4 border-l-green-500\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center text-green-700 dark:text-green-300\">\r\n            <Settings className=\"w-6 h-6 mr-2\" />\r\n            Unit 2: Strategies for Success\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4\">\r\n            <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('personal_operating_system')}\r\n                >\r\n                  Personal Operating System:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                The importance of finding and building individual learning strategies rather than conforming to a single \"correct\" way.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('udl')}\r\n                >\r\n                  Universal Design for Learning (UDL):\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                The principle that diverse learning approaches benefit everyone.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('core_strategies')}\r\n                >\r\n                  Core Strategies:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Using structure and predictability, engaging in multisensory learning, and practicing self-advocacy.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('pk_university_advantage')}\r\n                >\r\n                  FPK University Advantage:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                The platform is designed with features like a customizable interface, flexible pacing, and an AI Study Coach to support neurodiverse learners.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Unit 3 Review */}\r\n      <Card className=\"border-l-4 border-l-red-500\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center text-red-700 dark:text-red-300\">\r\n            <TrendingUp className=\"w-6 h-6 mr-2\" />\r\n            Unit 3: Applying Your Strengths\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4\">\r\n            <div className=\"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('economics')}\r\n                >\r\n                  Economics:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                A science of patterns and systems where strengths like pattern recognition, hyperfocus, and attention to detail provide a natural advantage.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('logic_critical_thinking')}\r\n                >\r\n                  Logic & Critical Thinking:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                A field that rewards systematic thinking, attention to detail, and logical reasoning, making it a natural fit for neurodiverse minds.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">\r\n                <span \r\n                  className=\"cursor-pointer hover:bg-yellow-100 dark:hover:bg-yellow-900/30 px-1 rounded\"\r\n                  onClick={() => handleConceptClick('myth_vs_fact')}\r\n                >\r\n                  Myth vs. Fact:\r\n                </span>\r\n              </h4>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Debunks common misconceptions about economics and logic, highlighting that these subjects are about understanding logic, not rote memorization.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Key Takeaways */}\r\n      <Card className=\"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <CheckCircle className=\"w-6 h-6 mr-2\" />\r\n            Key Takeaways\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid gap-4\">\r\n            <div className=\"flex items-start space-x-3\">\r\n              <div className=\"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n              <p className=\"text-sm\">\r\n                <strong>Neurodiversity is a strength:</strong> Your unique brain wiring is an asset, not a deficit.\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-start space-x-3\">\r\n              <div className=\"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n              <p className=\"text-sm\">\r\n                <strong>Build your own system:</strong> There's no one-size-fits-all approach to learning.\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-start space-x-3\">\r\n              <div className=\"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n              <p className=\"text-sm\">\r\n                <strong>Leverage your superpowers:</strong> Pattern recognition, hyperfocus, and systematic thinking are your advantages.\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-start space-x-3\">\r\n              <div className=\"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n              <p className=\"text-sm\">\r\n                <strong>Use the right tools:</strong> Technology and accommodations are accelerators, not crutches.\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-start space-x-3\">\r\n              <div className=\"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0\"></div>\r\n              <p className=\"text-sm\">\r\n                <strong>Apply strategically:</strong> Your strengths align perfectly with subjects like economics and logic.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Lesson\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\courses\\neurodiversity\\NeurodiversityLesson8.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[447,450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[447,450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { ChevronDown, ChevronUp, Trophy, Search } from 'lucide-react';\r\n\r\ninterface NeurodiversityLesson8Props {\r\n  onComplete?: () => void;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (type: string, data: Record<string, any>) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nexport const NeurodiversityLesson8: React.FC<NeurodiversityLesson8Props> = ({\r\n  onComplete,\r\n  isCompleted,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n\r\n  const [expandedQuestions, setExpandedQuestions] = useState<Set<number>>(new Set());\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n\r\n  const handleQuestionClick = (questionId: number) => {\r\n    const newExpanded = new Set(expandedQuestions);\r\n    if (newExpanded.has(questionId)) {\r\n      newExpanded.delete(questionId);\r\n    } else {\r\n      newExpanded.add(questionId);\r\n    }\r\n    setExpandedQuestions(newExpanded);\r\n    \r\n    trackInteraction?.('quiz_interaction', {\r\n      questionId,\r\n      action: newExpanded.has(questionId) ? 'expand' : 'collapse',\r\n      lessonId,\r\n      lessonTitle,\r\n      timestamp: Date.now()\r\n    });\r\n  };\r\n\r\n  const handleComplete = () => {\r\n    trackInteraction?.('lesson_completion', {\r\n      lessonId,\r\n      lessonTitle,\r\n      completionMethod: 'manual',\r\n      timestamp: Date.now()\r\n    });\r\n    onComplete?.();\r\n  };\r\n\r\n  const questions = [\r\n    {\r\n      id: 1,\r\n      question: \"What is the core difference between the medical model and the social model of neurological differences?\",\r\n      answer: \"The medical model views neurological differences as problems within the individual that need to be \\\"cured\\\" or \\\"fixed.\\\" In contrast, the social model argues that the real issue is a society not built to accommodate diverse minds, focusing on environmental support rather than individual pathology.\"\r\n    },\r\n    {\r\n      id: 2,\r\n      question: \"Briefly define \\\"neurodiverse\\\" and explain why this term was coined.\",\r\n      answer: \"\\\"Neurodiverse\\\" refers to an individual whose brain functions in a way that diverges significantly from the neurotypical majority. This term was created to be more empowering and inclusive, moving away from older, often pathologising clinical labels.\"\r\n    },\r\n    {\r\n      id: 3,\r\n      question: \"How can dyslexia be reframed as a \\\"superpower,\\\" and in what fields might this strength be particularly useful?\",\r\n      answer: \"Dyslexia can be reframed as a superpower by highlighting strengths like superior pattern recognition, spatial reasoning, and holistic thinking. These abilities are particularly useful in fields such as engineering, architecture, and the creative arts, where seeing entire systems is an asset.\"\r\n    },\r\n    {\r\n      id: 4,\r\n      question: \"According to the text, what is a more accurate description for ADHD than \\\"attention deficit,\\\" and what strengths does it encompass?\",\r\n      answer: \"A more accurate description for ADHD is \\\"attention variability,\\\" as individuals can often achieve hyperfocus on areas of passion. This encompasses strengths like highly associative thinking, which drives creativity and innovative problem-solving.\"\r\n    },\r\n    {\r\n      id: 5,\r\n      question: \"How does the text suggest individuals with autism can leverage their \\\"attention to detail\\\" in academic or professional settings?\",\r\n      answer: \"Individuals with autism can leverage their \\\"attention to detail\\\" to excel in analysing complex information, such as spotting tiny errors in code or identifying subtle details in government budgets or trade agreements that others might overlook. This precision makes them adept at problem-solving and quality control.\"\r\n    },\r\n    {\r\n      id: 6,\r\n      question: \"What is Universal Design for Learning (UDL), and how does it relate to individual learning strategies?\",\r\n      answer: \"Universal Design for Learning (UDL) is a framework acknowledging that there is no single \\\"correct\\\" way to learn and that what works for one person may not work for another. It promotes the idea that designing learning environments with diverse needs in mind benefits all students, allowing individuals to build their own effective learning systems.\"\r\n    },\r\n    {\r\n      id: 7,\r\n      question: \"Provide an example of how \\\"multisensory learning\\\" might be applied by a student struggling with an abstract concept.\",\r\n      answer: \"A student struggling with an abstract concept like supply and demand in economics could use multisensory learning by building a physical model of the curves with clay. This hands-on, three-dimensional activity helps to internalise the concept in a way that simply reading about it might not.\"\r\n    },\r\n    {\r\n      id: 8,\r\n      question: \"Describe how FPK University's \\\"flexible pacing\\\" feature can benefit a student with fluctuating energy levels.\",\r\n      answer: \"FPK University's \\\"flexible pacing\\\" feature allows students to work at a rhythm that suits their energy levels and focus, such as using the Pomodoro Technique. This helps manage mental energy throughout the day, preventing burnout and improving sustained productivity for students whose focus fluctuates.\"\r\n    },\r\n    {\r\n      id: 9,\r\n      question: \"Why does the text argue that neurodiverse minds have a \\\"natural advantage\\\" in economics?\",\r\n      answer: \"The text argues that neurodiverse minds have a \\\"natural advantage\\\" in economics because the field is built on patterns, relationships, and cause-and-effect logic. Strengths like systematic thinking and pattern recognition allow them to understand underlying economic structures rather than just memorise facts.\"\r\n    },\r\n    {\r\n      id: 10,\r\n      question: \"How can \\\"argument mapping\\\" be a beneficial study tool for individuals with systematic thinking strengths in logic and critical thinking?\",\r\n      answer: \"Argument mapping is a beneficial study tool for individuals with systematic thinking strengths because it provides a structured and visual way to break down complex ideas. It allows them to clearly see the main conclusion and the premises that support it, making logical structures more comprehensible than just reading text.\"\r\n    }\r\n  ];\r\n\r\n  const glossaryData = [\r\n    { term: \"Neurodiversity\", definition: \"A concept proposing that variations in brain function, including how we learn, socialise, and pay attention, are natural and valuable parts of human diversity, akin to biodiversity. Coined by Judy Singer in 1998.\" },\r\n    { term: \"Neurodiverse\", definition: \"An individual whose brain functions in a way that diverges significantly from the neurotypical majority. This term aims to be empowering and inclusive.\" },\r\n    { term: \"Neurotypical\", definition: \"An individual whose brain functions in a way that aligns with the societal norm. Used to highlight the existence of neurological diversity.\" },\r\n    { term: \"Medical Model\", definition: \"A traditional perspective that views neurological differences as medical problems or disorders that need to be 'cured' or 'fixed.'\" },\r\n    { term: \"Social Model\", definition: \"A perspective that argues the real issue isn't the individual's brain, but a society that is not built to accommodate a wide range of minds, advocating for environmental and societal accommodations.\" },\r\n    { term: \"Pattern Recognition\", definition: \"The ability to identify regularities and structures in data or information, often a strength in neurodiverse individuals, particularly those with dyslexia.\" },\r\n    { term: \"Hyperfocus\", definition: \"An intense, prolonged period of concentration on a specific task or area of interest, often experienced by individuals with ADHD or autism, allowing for deep and productive work.\" },\r\n    { term: \"Universal Design for Learning (UDL)\", definition: \"A framework that advocates for designing learning environments and materials to be accessible and effective for all learners, recognising that diverse approaches benefit everyone.\" },\r\n    { term: \"Multisensory Learning\", definition: \"An approach to learning that engages multiple senses (e.g., visual, auditory, kinesthetic, tactile) to improve comprehension and retention, especially beneficial for neurodiverse learners.\" },\r\n    { term: \"Self-Advocacy\", definition: \"The ability to understand one's own needs and confidently communicate them to others, particularly important for neurodiverse individuals seeking appropriate accommodations and support.\" },\r\n  ];\r\n\r\n  const filteredQuestions = questions.filter(q => \r\n    q.question.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    q.answer.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const filteredGlossary = glossaryData.filter(item =>\r\n    item.term.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    item.definition.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-8\">\r\n      {/* Unit Header */}\r\n      <div className=\"text-center space-y-4\">\r\n        <div className=\"inline-flex items-center px-4 py-2 bg-indigo-100 dark:bg-indigo-900/30 rounded-full\">\r\n          <Trophy className=\"w-5 h-5 mr-2 text-indigo-600\" />\r\n          <span className=\"text-indigo-800 dark:text-indigo-200 font-semibold\">UNIT 4: INTERACTIVE STUDY GUIDE</span>\r\n        </div>\r\n        <h1 className=\"text-3xl font-bold text-foreground\">LESSON 4.2: Quiz & Assessment</h1>\r\n        <p className=\"text-xl text-muted-foreground\">Test Your Knowledge</p>\r\n      </div>\r\n\r\n      {/* Search Bar */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4\" />\r\n            <Input\r\n              placeholder=\"Search questions or glossary terms...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"pl-10\"\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Short-Answer Questions */}\r\n      <div className=\"space-y-6\">\r\n        <h2 className=\"text-2xl font-bold\">Short-Answer Questions</h2>\r\n        <p className=\"text-muted-foreground\">\r\n          Test your knowledge with these short-answer questions. Click on each question to reveal the answer.\r\n        </p>\r\n        \r\n        <div className=\"space-y-4\">\r\n          {filteredQuestions.map((item) => (\r\n            <Card key={item.id} className=\"border-2 hover:border-primary/20 transition-colors\">\r\n              <CardHeader\r\n                className=\"cursor-pointer\"\r\n                onClick={() => handleQuestionClick(item.id)}\r\n              >\r\n                <CardTitle className=\"flex justify-between items-center text-base\">\r\n                  <span>{item.id}. {item.question}</span>\r\n                  {expandedQuestions.has(item.id) ? (\r\n                    <ChevronUp className=\"w-5 h-5 flex-shrink-0\" />\r\n                  ) : (\r\n                    <ChevronDown className=\"w-5 h-5 flex-shrink-0\" />\r\n                  )}\r\n                </CardTitle>\r\n              </CardHeader>\r\n              {expandedQuestions.has(item.id) && (\r\n                <CardContent className=\"pt-0\">\r\n                  <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border-l-4 border-l-green-500\">\r\n                    <p><strong>Answer:</strong> {item.answer}</p>\r\n                  </div>\r\n                </CardContent>\r\n              )}\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Essay Format Questions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Essay Format Questions</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <p className=\"text-muted-foreground mb-4\">\r\n            These questions are designed for deeper reflection and analysis. Choose one and practice writing a detailed response.\r\n          </p>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <p className=\"font-medium mb-2\">1.</p>\r\n              <p className=\"text-sm\">\r\n                Discuss how the shift from a \"medical model\" to a \"social model\" of neurodiversity fundamentally changes the approach to supporting neurodiverse individuals in educational and societal contexts. Provide specific examples from the text to illustrate this change.\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <p className=\"font-medium mb-2\">2.</p>\r\n              <p className=\"text-sm\">\r\n                Analyse how the concept of \"reframing traits as strengths\" applies to at least two specific neurodiverse conditions (e.g., dyslexia, ADHD, autism) as described in the source material. How do these reframed traits contribute to unique academic or professional \"superpowers\"?\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <p className=\"font-medium mb-2\">3.</p>\r\n              <p className=\"text-sm\">\r\n                Evaluate the core learning strategies (structure and predictability, multisensory learning, self-advocacy) introduced in Lesson 2.1. Explain how each strategy addresses common challenges faced by neurodiverse learners and provides a personalised path to success.\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <p className=\"font-medium mb-2\">4.</p>\r\n              <p className=\"text-sm\">\r\n                FPK University positions itself as a platform \"built for your brain.\" Discuss how its core features (customisable interface, flexible pacing, AI study coach) embody the principles of Universal Design for Learning (UDL) and actively support neurodiverse students beyond traditional educational models.\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n              <p className=\"font-medium mb-2\">5.</p>\r\n              <p className=\"text-sm\">\r\n                Drawing on the \"Applying Your Strengths\" unit, explain how neurodiverse cognitive styles are particularly well-suited for excelling in subjects like Economics and Logic & Critical Thinking. Provide examples of specific strengths and how they can be applied to master these fields.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Glossary */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Glossary of Key Terms</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {filteredGlossary.map((item, index) => (\r\n              <div key={index} className=\"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg\">\r\n                <h4 className=\"font-bold text-lg mb-2\">{item.term}</h4>\r\n                <p className=\"text-muted-foreground\">{item.definition}</p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Final Message */}\r\n      <Card className=\"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <Trophy className=\"w-6 h-6 mr-2\" />\r\n            Conclusion: Your Journey Begins\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"prose max-w-none dark:prose-invert\">\r\n            <p>\r\n              Welcome to FPK University. Your arrival here is not a coincidence, but the start of a new journey built just for you. For too long, you may have been told you need to change your mind to fit the world. We believe the opposite. We believe the world needs to change to fit your mind.\r\n            </p>\r\n            <p className=\"mt-4\">\r\n              Throughout this course, we've talked about what makes your brain uniqueâ€”your attention to detail, your ability to see patterns, your capacity for deep focus. These are not just traits; they are the keys to a different kind of success. We want you to visualize where they can take you.\r\n            </p>\r\n            <p className=\"mt-4\">\r\n              You are not here to be fixed. You are here to learn how to harness your incredible potential. We know this journey can feel lonely, but you are not alone. This platform, and the community it is building, are here to support you. You have everything you need within you to succeed. Your journey begins now. Let's build a path to success together.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Button */}\r\n      {!isCompleted && (\r\n        <div className=\"flex justify-center pt-8\">\r\n          <Button \r\n            onClick={handleComplete}\r\n            size=\"lg\"\r\n            className=\"px-8 py-3\"\r\n          >\r\n            Complete Course\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\AIInsightsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\APODCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\APODGalleryModal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'nextImage' and 'prevImage'. Either include them or remove the dependency array.","line":82,"column":6,"nodeType":"ArrayExpression","endLine":82,"endColumn":39,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, onClose, apods, cleanup, prevImage, nextImage]","fix":{"range":[2264,2297],"text":"[isOpen, onClose, apods, cleanup, prevImage, nextImage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { \r\n  Accordion,\r\n  AccordionContent,\r\n  AccordionItem,\r\n  AccordionTrigger,\r\n} from '@/components/ui/accordion';\r\nimport { \r\n  X, \r\n  ChevronLeft, \r\n  ChevronRight, \r\n  Calendar, \r\n  User, \r\n  Telescope,\r\n  Loader2,\r\n  RotateCcw,\r\n  ExternalLink\r\n} from 'lucide-react';\r\nimport { useNASARecentAPODs } from '@/hooks/useNASAAPOD';\r\nimport { format } from 'date-fns';\r\nimport { APODData } from '@/services/NASAService';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface APODGalleryModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  initialDate?: string;\r\n}\r\n\r\nconst APODGalleryModal: React.FC<APODGalleryModalProps> = ({ \r\n  isOpen, \r\n  onClose, \r\n  initialDate \r\n}) => {\r\n  const cleanup = useCleanup('APODGalleryModal');\r\n  const { data: apods, isLoading, error, refetch } = useNASARecentAPODs(7);\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const isMobile = useIsMobile();\r\n\r\n  // Reset to first image when modal opens\r\n  useEffect(() => {\r\n    if (isOpen && apods && apods.length > 0) {\r\n      if (initialDate) {\r\n        const index = apods.findIndex(apod => apod.date === initialDate);\r\n        setCurrentIndex(index >= 0 ? index : 0);\r\n      } else {\r\n        setCurrentIndex(0);\r\n      }\r\n    }\r\n  }, [isOpen, apods, initialDate]);\r\n\r\n  // Keyboard navigation\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const handleKeyPress = (event: KeyboardEvent) => {\r\n      switch (event.key) {\r\n        case 'Escape':\r\n          onClose();\r\n          break;\r\n        case 'ArrowLeft':\r\n          event.preventDefault();\r\n          prevImage();\r\n          break;\r\n        case 'ArrowRight':\r\n          event.preventDefault();\r\n          nextImage();\r\n          break;\r\n      }\r\n    };\r\n\r\n    const keyListenerId = cleanup.addEventListener(document, 'keydown', handleKeyPress);\r\n    return () => {\r\n      cleanup.cleanup(keyListenerId);\r\n    };\r\n  }, [isOpen, onClose, apods, cleanup]);\r\n\r\n  const currentAPOD = apods?.[currentIndex];\r\n\r\n  const nextImage = () => {\r\n    if (!apods || apods.length === 0) return;\r\n    setCurrentIndex(prev => prev < (apods.length - 1) ? prev + 1 : 0);\r\n  };\r\n\r\n  const prevImage = () => {\r\n    if (!apods || apods.length === 0) return;\r\n    setCurrentIndex(prev => prev > 0 ? prev - 1 : (apods.length - 1));\r\n  };\r\n\r\n  const renderMediaContent = (apod: APODData) => {\r\n    if (apod.media_type === 'video') {\r\n      // Extract YouTube video ID for embedding\r\n      const youtubeMatch = apod.url.match(/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([^&\\n?#]+)/);\r\n      const vimeoMatch = apod.url.match(/vimeo\\.com\\/(\\d+)/);\r\n      \r\n      if (youtubeMatch) {\r\n        return (\r\n          <iframe\r\n            src={`https://www.youtube.com/embed/${youtubeMatch[1]}`}\r\n            className=\"w-full aspect-video rounded-lg\"\r\n            frameBorder=\"0\"\r\n            allowFullScreen\r\n            title={apod.title}\r\n          />\r\n        );\r\n      } else if (vimeoMatch) {\r\n        return (\r\n          <iframe\r\n            src={`https://player.vimeo.com/video/${vimeoMatch[1]}`}\r\n            className=\"w-full aspect-video rounded-lg\"\r\n            frameBorder=\"0\"\r\n            allowFullScreen\r\n            title={apod.title}\r\n          />\r\n        );\r\n      } else {\r\n        // Fallback for other video types\r\n        return (\r\n          <div className=\"w-full aspect-video flex flex-col items-center justify-center bg-slate-900 rounded-lg text-white\">\r\n            <ExternalLink className=\"h-12 w-12 mb-4 text-blue-400\" />\r\n            <h3 className=\"text-lg font-semibold mb-2\">Video Content</h3>\r\n            <p className=\"text-sm text-gray-300 mb-4 text-center max-w-md px-4\">\r\n              This content is a video. Click below to view it on the original site.\r\n            </p>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => window.open(apod.url, '_blank')}\r\n              className=\"bg-blue-600 border-blue-500 text-white hover:bg-blue-700\"\r\n            >\r\n              <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n              View Video\r\n            </Button>\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n\r\n    return (\r\n      <img\r\n        src={apod.url}\r\n        alt={apod.title}\r\n        className=\"w-full h-auto max-h-[70vh] object-contain rounded-lg\"\r\n        onError={(e) => {\r\n          const target = e.target as HTMLImageElement;\r\n          target.src = 'https://images.unsplash.com/photo-1470813740244-df37b8c1edcb?w=1200&h=800&fit=crop';\r\n        }}\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onClose}>\r\n      <DialogContent className={`\r\n        ${isMobile \r\n          ? 'w-screen h-screen max-w-none max-h-none m-0 rounded-none' \r\n          : 'max-w-7xl w-full h-[90vh]'\r\n        } \r\n        p-0 gap-0 bg-slate-950 flex flex-col\r\n      `}>\r\n        {/* Header */}\r\n        <div className={`\r\n          flex items-center justify-between p-4 bg-slate-900 border-b border-slate-700\r\n          ${isMobile ? 'flex-col gap-3' : 'flex-row'}\r\n        `}>\r\n          <div className={`flex items-center gap-3 ${isMobile ? 'w-full' : ''}`}>\r\n            <Telescope className=\"h-6 w-6 text-blue-400 flex-shrink-0\" />\r\n            <div className={isMobile ? 'flex-1' : ''}>\r\n              <h2 className={`font-bold text-white ${isMobile ? 'text-base' : 'text-lg'}`}>\r\n                {currentAPOD?.title || 'NASA Astronomy Picture of the Day'}\r\n              </h2>\r\n              {currentAPOD && (\r\n                <div className=\"flex items-center gap-2 text-sm text-gray-300\">\r\n                  <Calendar className=\"h-4 w-4\" />\r\n                  <span>{format(new Date(currentAPOD.date), isMobile ? 'MMM dd, yyyy' : 'EEEE, MMMM dd, yyyy')}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className={`flex items-center gap-2 ${isMobile ? 'w-full justify-between' : ''}`}>\r\n            {/* Navigation */}\r\n            {apods && apods.length > 1 && (\r\n              <div className={`flex items-center gap-2 ${isMobile ? 'flex-1' : ''}`}>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size={isMobile ? \"default\" : \"sm\"}\r\n                  onClick={prevImage}\r\n                  className={`text-gray-300 hover:text-white hover:bg-slate-700 ${\r\n                    isMobile ? 'flex-1 min-h-[44px]' : ''\r\n                  }`}\r\n                >\r\n                  <ChevronLeft className=\"h-4 w-4 mr-1\" />\r\n                  {isMobile ? 'Prev' : 'Previous'}\r\n                </Button>\r\n                <span className=\"text-sm text-gray-400 px-2 whitespace-nowrap\">\r\n                  {currentIndex + 1} of {apods.length}\r\n                </span>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size={isMobile ? \"default\" : \"sm\"}\r\n                  onClick={nextImage}\r\n                  className={`text-gray-300 hover:text-white hover:bg-slate-700 ${\r\n                    isMobile ? 'flex-1 min-h-[44px]' : ''\r\n                  }`}\r\n                >\r\n                  {isMobile ? 'Next' : 'Next'}\r\n                  <ChevronRight className=\"h-4 w-4 ml-1\" />\r\n                </Button>\r\n              </div>\r\n            )}\r\n\r\n            {/* Close Button */}\r\n            <Button\r\n              variant=\"ghost\"\r\n              size={isMobile ? \"default\" : \"sm\"}\r\n              onClick={onClose}\r\n              className={`text-gray-300 hover:text-white hover:bg-slate-700 ${\r\n                isMobile ? 'min-h-[44px] min-w-[44px]' : ''\r\n              }`}\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <div className={`flex-1 overflow-hidden ${isMobile ? 'flex flex-col' : 'flex'}`}>\r\n          {/* Media Display */}\r\n          <div className={`bg-black flex items-center justify-center p-4 ${\r\n            isMobile ? 'flex-1' : 'flex-1'\r\n          }`}>\r\n            {isLoading ? (\r\n              <div className=\"flex flex-col items-center text-white\">\r\n                <Loader2 className=\"h-12 w-12 animate-spin mb-4 text-blue-400\" />\r\n                <p className={isMobile ? 'text-base' : 'text-lg'}>Loading astronomy images...</p>\r\n              </div>\r\n            ) : error ? (\r\n              <div className=\"flex flex-col items-center text-white text-center px-4\">\r\n                <RotateCcw className=\"h-12 w-12 mb-4 text-red-400\" />\r\n                <h3 className={`font-semibold mb-2 ${isMobile ? 'text-lg' : 'text-xl'}`}>Unable to load images</h3>\r\n                <p className=\"text-gray-300 mb-4\">There was an error loading the astronomy images.</p>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => refetch()}\r\n                  className=\"bg-blue-600 border-blue-500 text-white hover:bg-blue-700 min-h-[44px]\"\r\n                >\r\n                  <RotateCcw className=\"h-4 w-4 mr-2\" />\r\n                  Retry\r\n                </Button>\r\n              </div>\r\n            ) : currentAPOD ? (\r\n              <div className=\"w-full max-w-5xl\">\r\n                {renderMediaContent(currentAPOD)}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-white text-center\">\r\n                <Telescope className=\"h-12 w-12 mb-4 text-blue-400 mx-auto\" />\r\n                <p className={isMobile ? 'text-base' : 'text-lg'}>No images available</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Info Panel */}\r\n          <div className={`bg-slate-900 border-slate-700 ${\r\n            isMobile \r\n              ? 'border-t overflow-y-auto max-h-[40vh]' \r\n              : 'w-80 border-l flex flex-col'\r\n          }`}>\r\n            <ScrollArea className={`${isMobile ? 'h-full' : 'flex-1'} p-4`}>\r\n              {isMobile ? (\r\n                // Mobile: Accordion Layout\r\n                <Accordion type=\"single\" collapsible className=\"w-full\">\r\n                  <AccordionItem value=\"about-apod\" className=\"border-slate-700\">\r\n                    <AccordionTrigger className=\"text-blue-400 hover:text-blue-300\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Telescope className=\"h-4 w-4\" />\r\n                        What is APOD?\r\n                      </div>\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"text-gray-300 leading-relaxed\">\r\n                      NASA's Astronomy Picture of the Day features a different image or photograph of our universe each day, \r\n                      along with a brief explanation written by a professional astronomer.\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n\r\n                  {currentAPOD && (\r\n                    <AccordionItem value=\"current-image\" className=\"border-slate-700\">\r\n                      <AccordionTrigger className=\"text-white hover:text-gray-200\">\r\n                        Today's Discovery\r\n                      </AccordionTrigger>\r\n                      <AccordionContent className=\"space-y-4\">\r\n                        <div>\r\n                          <h4 className=\"font-semibold text-white mb-2\">{currentAPOD.title}</h4>\r\n                          <p className=\"text-sm text-gray-300 leading-relaxed\">\r\n                            {currentAPOD.explanation}\r\n                          </p>\r\n                        </div>\r\n\r\n                        {currentAPOD.copyright && (\r\n                          <div className=\"pt-3 border-t border-slate-700\">\r\n                            <div className=\"flex items-start gap-2\">\r\n                              <User className=\"h-3 w-3 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                              <div>\r\n                                <p className=\"text-xs text-gray-400 font-medium\">Credits</p>\r\n                                <p className=\"text-xs text-gray-300\">{currentAPOD.copyright}</p>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        <div className=\"pt-3 border-t border-slate-700\">\r\n                          <div className=\"flex items-center gap-2 text-xs text-gray-400\">\r\n                            <Calendar className=\"h-3 w-3\" />\r\n                            <span>Published: {format(new Date(currentAPOD.date), 'MMM dd, yyyy')}</span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2 text-xs text-gray-400 mt-1\">\r\n                            <span className=\"w-3 h-3 rounded-full bg-blue-500 flex-shrink-0\"></span>\r\n                            <span>Media Type: {currentAPOD.media_type === 'image' ? 'Image' : 'Video'}</span>\r\n                          </div>\r\n                        </div>\r\n                      </AccordionContent>\r\n                    </AccordionItem>\r\n                  )}\r\n                </Accordion>\r\n              ) : (\r\n                // Desktop: Card Layout\r\n                <>\r\n                  {/* About APOD */}\r\n                  <Card className=\"mb-4 bg-slate-800 border-slate-700\">\r\n                    <CardHeader className=\"pb-3\">\r\n                      <CardTitle className=\"text-sm text-blue-400 flex items-center gap-2\">\r\n                        <Telescope className=\"h-4 w-4\" />\r\n                        What is APOD?\r\n                      </CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent className=\"pt-0\">\r\n                      <p className=\"text-xs text-gray-300 leading-relaxed\">\r\n                        NASA's Astronomy Picture of the Day features a different image or photograph of our universe each day, \r\n                        along with a brief explanation written by a professional astronomer.\r\n                      </p>\r\n                    </CardContent>\r\n                  </Card>\r\n\r\n                  {/* Current Image Details */}\r\n                  {currentAPOD && (\r\n                    <Card className=\"bg-slate-800 border-slate-700\">\r\n                      <CardHeader className=\"pb-3\">\r\n                        <CardTitle className=\"text-sm text-white\">Today's Discovery</CardTitle>\r\n                      </CardHeader>\r\n                      <CardContent className=\"pt-0 space-y-4\">\r\n                        <div>\r\n                          <h4 className=\"font-semibold text-white mb-2 text-sm\">{currentAPOD.title}</h4>\r\n                          <p className=\"text-xs text-gray-300 leading-relaxed\">\r\n                            {currentAPOD.explanation}\r\n                          </p>\r\n                        </div>\r\n\r\n                        {currentAPOD.copyright && (\r\n                          <div className=\"pt-3 border-t border-slate-700\">\r\n                            <div className=\"flex items-start gap-2\">\r\n                              <User className=\"h-3 w-3 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                              <div>\r\n                                <p className=\"text-xs text-gray-400 font-medium\">Credits</p>\r\n                                <p className=\"text-xs text-gray-300\">{currentAPOD.copyright}</p>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        <div className=\"pt-3 border-t border-slate-700\">\r\n                          <div className=\"flex items-center gap-2 text-xs text-gray-400\">\r\n                            <Calendar className=\"h-3 w-3\" />\r\n                            <span>Published: {format(new Date(currentAPOD.date), 'MMM dd, yyyy')}</span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2 text-xs text-gray-400 mt-1\">\r\n                            <span className=\"w-3 h-3 rounded-full bg-blue-500 flex-shrink-0\"></span>\r\n                            <span>Media Type: {currentAPOD.media_type === 'image' ? 'Image' : 'Video'}</span>\r\n                          </div>\r\n                        </div>\r\n                      </CardContent>\r\n                    </Card>\r\n                  )}\r\n                </>\r\n              )}\r\n            </ScrollArea>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default APODGalleryModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\GamificationOverview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\GoalsOverview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\LearningAnalyticsOverview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\LiveHubAPODCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\ModelViewerModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\OrgBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\QuickAccessBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\QuickNavigationGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\QuoteOfTheDayCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\RecentActivityFeed.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\VisualOfTheWeekCarousel.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":65,"column":6,"nodeType":"ArrayExpression","endLine":65,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [api, cleanup, items]","fix":{"range":[2115,2127],"text":"[api, cleanup, items]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\nimport { \r\n  Carousel,\r\n  CarouselContent,\r\n  CarouselItem,\r\n  CarouselNext,\r\n  CarouselPrevious,\r\n  type CarouselApi\r\n} from '@/components/ui/carousel';\r\nimport { Palette, ChevronLeft, ChevronRight, RotateCcw } from 'lucide-react';\r\nimport { useVisualOfTheWeek } from '@/hooks/useMuseumData';\r\nimport { useViewportAnalytics } from '@/hooks/useViewportAnalytics';\r\nimport { MuseumItem } from '@/services/MuseumService';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface VisualOfTheWeekCarouselProps {\r\n  onItemClick: (item: MuseumItem) => void;\r\n}\r\n\r\nconst VisualOfTheWeekCarousel: React.FC<VisualOfTheWeekCarouselProps> = ({ onItemClick }) => {\r\n  const cleanup = useCleanup('VisualOfTheWeekCarousel');\r\n  const { data: items, isLoading, error, refetch } = useVisualOfTheWeek();\r\n  const { elementRef, trackClick } = useViewportAnalytics('visual3d');\r\n  const [api, setApi] = useState<CarouselApi>();\r\n  const [current, setCurrent] = useState(0);\r\n  const [imageErrors, setImageErrors] = useState<Set<string>>(new Set());\r\n\r\n  React.useEffect(() => {\r\n    if (!api) return;\r\n\r\n    const onSelect = () => {\r\n      setCurrent(api.selectedScrollSnap());\r\n    };\r\n\r\n    setCurrent(api.selectedScrollSnap());\r\n    api.on('select', onSelect);\r\n\r\n    return () => {\r\n      api.off('select', onSelect);\r\n    };\r\n  }, [api]);\r\n\r\n  // Keyboard navigation\r\n  React.useEffect(() => {\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      if (!api || !items?.length) return;\r\n      \r\n      if (event.key === 'ArrowLeft') {\r\n        event.preventDefault();\r\n        api.scrollPrev();\r\n      } else if (event.key === 'ArrowRight') {\r\n        event.preventDefault();\r\n        api.scrollNext();\r\n      }\r\n    };\r\n\r\n    const keyListenerId = cleanup.addEventListener(document, 'keydown', handleKeyDown);\r\n    return () => {\r\n      cleanup.cleanup(keyListenerId);\r\n    };\r\n  }, [api, items]);\r\n\r\n  const handleItemClick = (item: MuseumItem) => {\r\n    trackClick(item.id);\r\n    onItemClick(item);\r\n  };\r\n\r\n  const handleImageError = (itemId: string, originalSrc: string) => {\r\n    console.warn(`ðŸ›ï¸ Museum: Image failed to load for ${itemId}:`, originalSrc);\r\n    setImageErrors(prev => new Set([...prev, itemId]));\r\n  };\r\n\r\n  const getImageSrc = (item: MuseumItem): string => {\r\n    // If this image has errored, use the generic fallback\r\n    if (imageErrors.has(item.id)) {\r\n      return 'https://images.unsplash.com/photo-1578321272176-b7bbc0679853?w=400&h=300&fit=crop&auto=format';\r\n    }\r\n    \r\n    // Otherwise use the thumbnail (which should be a real museum image)\r\n    return item.thumbnail;\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    if (!api) return;\r\n    api.scrollPrev();\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (!api) return;\r\n    api.scrollNext();\r\n  };\r\n\r\n  const goToSlide = (index: number) => {\r\n    if (!api) return;\r\n    api.scrollTo(index);\r\n  };\r\n\r\n  if (error) {\r\n    return (\r\n      <Card ref={elementRef} className=\"bg-gradient-to-br from-purple-50 to-pink-100 border-purple-200 h-80\">\r\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-3\">\r\n          <CardTitle className=\"text-base font-medium text-purple-800\">Visual of the Week</CardTitle>\r\n          <Palette className=\"h-5 w-5 text-purple-600\" />\r\n        </CardHeader>\r\n        <CardContent className=\"h-60 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <RotateCcw className=\"h-12 w-12 text-purple-400 mx-auto mb-3\" />\r\n            <div className=\"text-xl font-bold text-purple-900 mb-2\">\r\n              Unable to Load\r\n            </div>\r\n            <p className=\"text-sm text-purple-700 mb-4\">Failed to fetch visual content</p>\r\n            <Button \r\n              variant=\"outline\" \r\n              size=\"sm\" \r\n              onClick={() => refetch()}\r\n              className=\"bg-purple-600 border-purple-500 text-white hover:bg-purple-700\"\r\n            >\r\n              <RotateCcw className=\"h-4 w-4 mr-2\" />\r\n              Retry\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card ref={elementRef} className=\"bg-gradient-to-br from-purple-50 to-pink-100 border-purple-200 h-80 flex flex-col\">\r\n      <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-3 flex-shrink-0\">\r\n        <CardTitle className=\"text-base font-medium text-purple-800\">Visual of the Week</CardTitle>\r\n        <Palette className=\"h-5 w-5 text-purple-600\" />\r\n      </CardHeader>\r\n      <CardContent className=\"flex-1 flex flex-col min-h-0 p-4\">\r\n        {isLoading ? (\r\n          <div className=\"space-y-3 flex-1\">\r\n            <Skeleton className=\"flex-1 w-full rounded-lg min-h-[120px]\" />\r\n            <Skeleton className=\"h-4 w-3/4\" />\r\n            <Skeleton className=\"h-4 w-1/2\" />\r\n          </div>\r\n        ) : items && items.length > 0 ? (\r\n          <div className=\"flex flex-col h-full space-y-3\">\r\n            {/* Carousel Container with fixed aspect ratio */}\r\n            <div className=\"relative flex-1 min-h-[120px]\">\r\n              <Carousel \r\n                setApi={setApi} \r\n                className=\"w-full h-full\"\r\n                opts={{\r\n                  align: \"start\",\r\n                  loop: true,\r\n                }}\r\n              >\r\n                <CarouselContent className=\"h-full\">\r\n                  {items.map((item, index) => (\r\n                    <CarouselItem key={item.id} className=\"h-full\">\r\n                      <div \r\n                        className=\"cursor-pointer group h-full\"\r\n                        onClick={() => handleItemClick(item)}\r\n                        role=\"button\"\r\n                        tabIndex={0}\r\n                        aria-label={`View ${item.title}`}\r\n                        onKeyDown={(e) => {\r\n                          if (e.key === 'Enter' || e.key === ' ') {\r\n                            e.preventDefault();\r\n                            handleItemClick(item);\r\n                          }\r\n                        }}\r\n                      >\r\n                        <div className=\"relative overflow-hidden rounded-lg bg-white/35 backdrop-blur-sm shadow-sm group-hover:shadow-md transition-shadow h-full flex flex-col border border-white/20\">\r\n                          {/* Image wrapper with controlled aspect ratio */}\r\n                          <div className=\"visual-week__image-wrapper relative w-full overflow-hidden rounded-lg\" style={{ paddingTop: '60%' }}>\r\n                            <img\r\n                              src={getImageSrc(item)}\r\n                              alt={item.title}\r\n                              className=\"absolute top-1/2 left-1/2 h-auto w-full transform -translate-x-1/2 -translate-y-1/2 group-hover:scale-105 transition-transform duration-200\"\r\n                              style={{ backgroundColor: '#000' }}\r\n                              onError={(e) => {\r\n                                handleImageError(item.id, item.thumbnail);\r\n                                // Don't change src here, let getImageSrc handle it on next render\r\n                              }}\r\n                            />\r\n                            <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\" />\r\n                            <div className=\"absolute bottom-2 left-2 right-2\">\r\n                              <h4 className=\"text-sm font-semibold text-white line-clamp-2 mb-1\">\r\n                                {item.title}\r\n                              </h4>\r\n                              <p className=\"text-xs text-white/80\">\r\n                                {item.source === 'smithsonian' ? 'Smithsonian' : 'Met Museum'}\r\n                                {item.isThreeD && ' â€¢ 3D Model'}\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </CarouselItem>\r\n                  ))}\r\n                </CarouselContent>\r\n                \r\n                {/* Desktop Navigation Controls */}\r\n                <CarouselPrevious \r\n                  className=\"hidden sm:flex absolute left-2 top-1/2 -translate-y-1/2 h-8 w-8 bg-white/35 hover:bg-white/50 backdrop-blur-sm border-purple-200 text-purple-700 hover:text-purple-900\"\r\n                  onClick={handlePrevious}\r\n                  aria-label=\"Previous image\"\r\n                />\r\n                <CarouselNext \r\n                  className=\"hidden sm:flex absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 bg-white/35 hover:bg-white/50 backdrop-blur-sm border-purple-200 text-purple-700 hover:text-purple-900\"\r\n                  onClick={handleNext}\r\n                  aria-label=\"Next image\"\r\n                />\r\n              </Carousel>\r\n            </div>\r\n\r\n            {/* Mobile Navigation and Indicators */}\r\n            <div className=\"flex sm:hidden items-center justify-between px-2 flex-shrink-0\">\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={handlePrevious}\r\n                className=\"text-purple-700 hover:text-purple-900 hover:bg-purple-100 h-8 px-3\"\r\n                aria-label=\"Previous image\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4 mr-1\" />\r\n                <span className=\"text-sm\">Prev</span>\r\n              </Button>\r\n              \r\n              <div className=\"flex space-x-1\" role=\"tablist\" aria-label=\"Image indicators\">\r\n                {items.map((_, index) => (\r\n                  <button\r\n                    key={index}\r\n                    className={`w-2 h-2 rounded-full transition-colors ${\r\n                      index === current ? 'bg-purple-600' : 'bg-purple-300'\r\n                    }`}\r\n                    onClick={() => goToSlide(index)}\r\n                    aria-label={`Go to slide ${index + 1}`}\r\n                    role=\"tab\"\r\n                    aria-selected={index === current}\r\n                  />\r\n                ))}\r\n              </div>\r\n\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={handleNext}\r\n                className=\"text-purple-700 hover:text-purple-900 hover:bg-purple-100 h-8 px-3\"\r\n                aria-label=\"Next image\"\r\n              >\r\n                <span className=\"text-sm\">Next</span>\r\n                <ChevronRight className=\"h-4 w-4 ml-1\" />\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Item Counter */}\r\n            <div className=\"text-center space-y-1 flex-shrink-0\">\r\n              <div className=\"text-sm font-medium text-purple-800\">\r\n                {current + 1} of {items.length}\r\n              </div>\r\n              <p className=\"text-xs text-purple-600\">\r\n                {items.length} curated visuals â€¢ Updated weekly\r\n              </p>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-center py-8 flex-1 flex flex-col items-center justify-center\">\r\n            <Palette className=\"h-12 w-12 text-purple-400 mx-auto mb-3\" />\r\n            <div className=\"text-lg font-semibold text-purple-900 mb-2\">\r\n              No Visuals Available\r\n            </div>\r\n            <p className=\"text-sm text-purple-700\">Check back later for new content</p>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default VisualOfTheWeekCarousel;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\WeatherChart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\WeatherMiniLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\dashboard\\WeatherScienceLabCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FlashcardBatchActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FlashcardFilterBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FlashcardFolderItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FlashcardFolderView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FlashcardGridView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FlashcardListView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FlashcardManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FolderContentArea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\flashcards\\FolderSummaryHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\gamification\\BadgeDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\gamification\\GamificationDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\gamification\\LeaderboardCard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLeaderboard'. Either include it or remove the dependency array.","line":34,"column":6,"nodeType":"ArrayExpression","endLine":34,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [fetchLeaderboard, limit]","fix":{"range":[935,942],"text":"[fetchLeaderboard, limit]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Trophy, Medal, Award } from 'lucide-react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\ninterface LeaderboardEntry {\r\n  user_id: string;\r\n  total_xp: number;\r\n  level: number;\r\n  profiles: {\r\n    display_name: string;\r\n    full_name: string;\r\n    avatar_url: string;\r\n  };\r\n}\r\n\r\ninterface LeaderboardCardProps {\r\n  className?: string;\r\n  limit?: number;\r\n}\r\n\r\nconst LeaderboardCard: React.FC<LeaderboardCardProps> = ({\r\n  className = '',\r\n  limit = 10\r\n}) => {\r\n  const [leaderboard, setLeaderboard] = useState<LeaderboardEntry[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchLeaderboard();\r\n  }, [limit]);\r\n\r\n  const fetchLeaderboard = async () => {\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-system', {\r\n        body: {\r\n          action: 'get_leaderboard',\r\n          limit\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n      setLeaderboard(data || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch leaderboard:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getRankIcon = (rank: number) => {\r\n    switch (rank) {\r\n      case 1: return <Trophy className=\"h-5 w-5 text-yellow-500\" />;\r\n      case 2: return <Medal className=\"h-5 w-5 text-gray-400\" />;\r\n      case 3: return <Award className=\"h-5 w-5 text-amber-600\" />;\r\n      default: return <span className=\"w-5 text-center font-semibold text-muted-foreground\">#{rank}</span>;\r\n    }\r\n  };\r\n\r\n  const getRankBadgeColor = (rank: number) => {\r\n    switch (rank) {\r\n      case 1: return 'bg-yellow-100 text-yellow-800';\r\n      case 2: return 'bg-gray-100 text-gray-800';\r\n      case 3: return 'bg-amber-100 text-amber-800';\r\n      default: return 'bg-blue-100 text-blue-800';\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card className={className}>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Trophy className=\"h-5 w-5\" />\r\n            Leaderboard\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-3\">\r\n            {Array.from({ length: 5 }).map((_, index) => (\r\n              <div key={index} className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50 animate-pulse\">\r\n                <div className=\"w-10 h-10 rounded-full bg-muted\" />\r\n                <div className=\"flex-1 space-y-1\">\r\n                  <div className=\"h-4 bg-muted rounded w-3/4\" />\r\n                  <div className=\"h-3 bg-muted rounded w-1/2\" />\r\n                </div>\r\n                <div className=\"w-16 h-6 bg-muted rounded\" />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card className={className}>\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2\">\r\n          <Trophy className=\"h-5 w-5\" />\r\n          Leaderboard\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"space-y-2\">\r\n          {leaderboard.map((entry, index) => {\r\n            const rank = index + 1;\r\n            const displayName = entry.profiles?.display_name || entry.profiles?.full_name || 'Anonymous';\r\n            \r\n            return (\r\n              <div\r\n                key={entry.user_id}\r\n                className={`flex items-center gap-3 p-3 rounded-lg transition-colors ${\r\n                  rank <= 3 ? 'bg-gradient-to-r from-yellow-50 to-orange-50' : 'hover:bg-muted/50'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-center w-8\">\r\n                  {getRankIcon(rank)}\r\n                </div>\r\n                \r\n                <Avatar className=\"h-10 w-10\">\r\n                  <AvatarImage src={entry.profiles?.avatar_url} />\r\n                  <AvatarFallback>\r\n                    {displayName.substring(0, 2).toUpperCase()}\r\n                  </AvatarFallback>\r\n                </Avatar>\r\n                \r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"font-medium truncate\">{displayName}</div>\r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    Level {entry.level} â€¢ {entry.total_xp.toLocaleString()} XP\r\n                  </div>\r\n                </div>\r\n                \r\n                {rank <= 3 && (\r\n                  <Badge className={getRankBadgeColor(rank)}>\r\n                    #{rank}\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n        \r\n        {leaderboard.length === 0 && (\r\n          <div className=\"text-center py-6 text-muted-foreground\">\r\n            No leaderboard data available yet.\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default LeaderboardCard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\gamification\\StreakDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\gamification\\XPBackfillCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\gamification\\XPProgressBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\ActiveLearningGoals.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\GoalCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\GoalCreateForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\GoalCreationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\GoalEditForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\GoalReminders.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\GoalXPTracker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\GoalsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\ReadingProgressWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\ReadingProgressWidgetErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\ReminderManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\goals\\SimpleGoalsOverview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\guards\\RequireAdmin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\guards\\RequireRole.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\CTASection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\EmpoweringLearningSection.tsx","messages":[{"ruleId":"no-irregular-whitespace","severity":2,"message":"Irregular whitespace not allowed.","line":9,"column":138,"nodeType":"Program","messageId":"noIrregularWhitespace","endLine":9,"endColumn":139}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport oliveImage from '@/assets/olive-hickmott.png';\r\nconst EmpoweringLearningSection = () => {\r\n  return <section className=\"py-20 px-6 w-full\">\r\n      <div className=\"w-full max-w-none mx-auto\">\r\n        <div className=\"bg-white/70 backdrop-blur-sm rounded-2xl p-8 md:p-12 shadow-lg border border-white/20 max-w-4xl mx-auto\">\r\n          <div className=\"flex flex-col md:flex-row items-center gap-6 mb-8\">\r\n            <img src=\"https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/home-page/olive.png\" alt=\"Olive Hickmott, creator of Empowering Learning\" className=\"w-32 h-32 md:w-40 md:h-40 object-contain flex-shrink-0\" />\r\n            <h2 className=\"text-4xl md:text-5xl font-bold text-slate-900 text-center md:text-left\">The Foundation of Empowering Learning.Â </h2>\r\n          </div>\r\n          \r\n          <div className=\"prose prose-lg prose-slate max-w-none\">\r\n            <p className=\"text-xl text-slate-800 mb-6 leading-relaxed\">\r\n              The foundation of our platform is the <strong>Empowering Learning</strong> model, created by Olive Hickmott, a forensic learning coach with decades of experience.\r\n            </p>\r\n            \r\n            <p className=\"text-lg text-slate-700 mb-6 leading-relaxed\">\r\n              Neuroscience shows that fluent reading, spelling, and handwriting depend on building a <strong>Word Form Area (WFA)</strong> in the brain, near the occipital lobe where visual images are stored.\r\n            </p>\r\n            \r\n            <p className=\"text-lg text-slate-700 mb-6 leading-relaxed\">\r\n              FPK University helps children grow their WFA by connecting visual memory to words, making learning natural, memorable, and enjoyable.\r\n            </p>\r\n            \r\n            <p className=\"text-lg text-slate-700 mb-8 leading-relaxed\">\r\n              This approach has already helped <strong>thousands of children</strong> unlock their creativity, boost self-esteem, and rediscover the joy of learning.\r\n            </p>\r\n            \r\n            <div className=\"text-center\">\r\n              <a href=\"https://empoweringlearning.fpkadapt.com/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"inline-flex items-center px-6 py-3 bg-fpk-orange hover:bg-fpk-orange/90 text-white font-semibold rounded-lg transition-colors duration-200\">\r\n                Learn More About Empowering Learning\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>;\r\n};\r\nexport default EmpoweringLearningSection;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\HomepageFooter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\HomepageHero.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\HomepageNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\IntroSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\OfferingsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\homepage\\WhyChooseSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\insights\\AIInsightsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\AnalyticsTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\CoursesTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\CreateAssignmentDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\CreateFolderDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\CreateNoteDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\CreateOrganizationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\EnhancedStudentsTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\GoalsTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\InviteLinkManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\InviteStudentDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\NotesTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\instructor\\StudentsTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\layout\\ResponsiveLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\layout\\StickyMediaToolbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\ApprovedStorageBooksSection.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1445,1448],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1445,1448],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { FileText, Download, Eye, Grid, List, Loader2, ChevronDown, ChevronRight, RotateCcw, Upload, BookOpen } from 'lucide-react';\r\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from '@/components/ui/collapsible';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport OptimizedPDFViewer from '@/components/library/OptimizedPDFViewer';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useAccessibility } from '@/hooks/useAccessibility';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface Book {\r\n  id: string;\r\n  title: string;\r\n  author?: string;\r\n  file_name?: string;\r\n  file_size?: number;\r\n  file_url?: string;\r\n  download_url?: string;\r\n  created_at?: string;\r\n}\r\n\r\ninterface ApprovedStorageBooksProps {\r\n  books: Book[];\r\n  isLoading?: boolean;\r\n  error?: string | null;\r\n  parentViewMode?: 'grid' | 'list';\r\n}\r\n\r\nconst ApprovedStorageBooksSection: React.FC<ApprovedStorageBooksProps> = ({ books, isLoading, error, parentViewMode }) => {\r\n  const { getAccessibilityClasses } = useAccessibility();\r\n  const [selectedPDF, setSelectedPDF] = useState<any>(null);\r\n  const [validatingPDF, setValidatingPDF] = useState<string | null>(null);\r\n  const { toast } = useToast();\r\n  const cleanup = useCleanup('ApprovedStorageBooksSection');\r\n\r\n  // Collapsible state with localStorage persistence - defaulting to closed\r\n  const [isExpanded, setIsExpanded] = useState(() => {\r\n    const saved = safeLocalStorage.getItem<string>('communityLibrary-expanded', {\r\n      fallbackValue: 'false',\r\n      logErrors: false\r\n    });\r\n    return saved !== null ? JSON.parse(saved) : false;\r\n  });\r\n  \r\n  // Use parent viewMode or fallback to localStorage\r\n  const [localViewMode, setLocalViewMode] = useState<'list' | 'grid'>(() => {\r\n    const saved = safeLocalStorage.getItem<string>('communityLibrary-viewMode', {\r\n      fallbackValue: parentViewMode,\r\n      logErrors: false\r\n    });\r\n    return (saved as 'list' | 'grid') || parentViewMode;\r\n  });\r\n\r\n  const viewMode = parentViewMode || localViewMode;\r\n\r\n  // Persist state changes to localStorage\r\n  useEffect(() => {\r\n    safeLocalStorage.setItem('communityLibrary-expanded', JSON.stringify(isExpanded));\r\n  }, [isExpanded]);\r\n\r\n  useEffect(() => {\r\n    safeLocalStorage.setItem('communityLibrary-viewMode', viewMode);\r\n  }, [viewMode]);\r\n\r\n  const handlePDFOpen = async (book: Book) => {\r\n    console.log('ðŸ“– Opening PDF with optimized viewer:', book.file_name);\r\n    setValidatingPDF(book.id);\r\n    \r\n    try {\r\n      await new Promise(resolve => {\r\n        cleanup.setTimeout(() => resolve(undefined), 500);\r\n      });\r\n      setSelectedPDF(book);\r\n      \r\n      toast({\r\n        title: \"PDF Loading\",\r\n        description: `Opening ${book.file_name}...`,\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to open PDF viewer\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setValidatingPDF(null);\r\n    }\r\n  };\r\n\r\n  const handleDownload = async (book: Book) => {\r\n    try {\r\n      const response = await fetch(book.file_url);\r\n      const blob = await response.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.style.display = 'none';\r\n      a.href = url;\r\n      a.download = book.file_name || 'download.pdf';\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n      document.body.removeChild(a);\r\n      \r\n      toast({\r\n        title: \"Download Started\",\r\n        description: `Downloading ${book.file_name}...`,\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Download Error\",\r\n        description: \"Failed to download the file\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  // Render PDF viewer modal\r\n  if (selectedPDF) {\r\n    return (\r\n      <OptimizedPDFViewer\r\n        fileUrl={selectedPDF.file_url}\r\n        fileName={selectedPDF.file_name}\r\n        onClose={() => setSelectedPDF(null)}\r\n      />\r\n    );\r\n  }\r\n\r\n  const renderBookCard = (book: Book) => (\r\n    <Card key={book.id} className=\"hover:shadow-lg transition-all duration-200 cursor-pointer border-2 hover:border-primary/20\">\r\n      <CardContent className=\"p-4\">\r\n        <div className=\"flex flex-col h-full\">\r\n          <div className=\"flex items-start gap-3 mb-3\">\r\n            <div className=\"w-12 h-16 bg-gradient-to-br from-primary/10 to-primary/20 rounded flex items-center justify-center flex-shrink-0\">\r\n              <FileText className=\"h-6 w-6 text-primary/60\" />\r\n            </div>\r\n            <div className=\"flex-1 min-w-0\">\r\n              <h3 className={`font-semibold text-sm leading-tight line-clamp-2 mb-1 ${getAccessibilityClasses('text')}`}>\r\n                {book.title || book.file_name}\r\n              </h3>\r\n              <p className={`text-xs text-muted-foreground line-clamp-1 mb-2 ${getAccessibilityClasses('text')}`}>\r\n                {book.author || 'Community Upload'}\r\n              </p>\r\n              <div className=\"flex flex-wrap gap-1 mb-2\">\r\n                <Badge variant=\"secondary\" className=\"text-xs\">\r\n                  Community Library\r\n                </Badge>\r\n                {book.file_size && (\r\n                  <Badge variant=\"outline\" className=\"text-xs\">\r\n                    {(book.file_size / (1024 * 1024)).toFixed(1)} MB\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex gap-2 mt-auto\">\r\n            <Button\r\n              variant=\"default\"\r\n              size=\"sm\"\r\n              onClick={() => handlePDFOpen(book)}\r\n              disabled={validatingPDF === book.id}\r\n              className=\"flex-1\"\r\n            >\r\n              {validatingPDF === book.id ? (\r\n                <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n              ) : (\r\n                <Eye className=\"h-4 w-4 mr-2\" />\r\n              )}\r\n              Read\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => handleDownload(book)}\r\n            >\r\n              <Download className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n\r\n  const renderBookList = (book: Book) => (\r\n    <div key={book.id} className=\"flex items-center gap-4 p-3 border rounded-lg hover:bg-muted/50 transition-colors\">\r\n      <div className=\"w-10 h-12 bg-gradient-to-br from-primary/10 to-primary/20 rounded flex items-center justify-center flex-shrink-0\">\r\n        <FileText className=\"h-5 w-5 text-primary/60\" />\r\n      </div>\r\n      <div className=\"flex-1 min-w-0\">\r\n        <h3 className={`font-medium text-sm leading-tight line-clamp-2 mb-1 ${getAccessibilityClasses('text')}`}>\r\n          {book.title || book.file_name}\r\n        </h3>\r\n        <p className={`text-xs text-muted-foreground line-clamp-1 ${getAccessibilityClasses('text')}`}>\r\n          {book.author || 'Community Upload'}\r\n        </p>\r\n        <div className=\"flex gap-1 mt-1\">\r\n          <Badge variant=\"secondary\" className=\"text-xs\">Community</Badge>\r\n          {book.file_size && (\r\n            <Badge variant=\"outline\" className=\"text-xs\">\r\n              {(book.file_size / (1024 * 1024)).toFixed(1)} MB\r\n            </Badge>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"flex gap-2\">\r\n        <Button\r\n          variant=\"default\"\r\n          size=\"sm\"\r\n          onClick={() => handlePDFOpen(book)}\r\n          disabled={validatingPDF === book.id}\r\n        >\r\n          {validatingPDF === book.id ? (\r\n            <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n          ) : (\r\n            <Eye className=\"h-4 w-4 mr-2\" />\r\n          )}\r\n          Read\r\n        </Button>\r\n        <Button\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          onClick={() => handleDownload(book)}\r\n        >\r\n          <Download className=\"h-4 w-4\" />\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Collapsible open={isExpanded} onOpenChange={setIsExpanded}>\r\n      <Card>\r\n        <CollapsibleTrigger asChild>\r\n          <CardHeader className=\"cursor-pointer hover:bg-muted/50 transition-colors\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <BookOpen className=\"h-5 w-5 text-blue-600\" />\r\n                Community Library\r\n                {books?.length > 0 && (\r\n                  <Badge variant=\"secondary\">{books.length}</Badge>\r\n                )}\r\n              </CardTitle>\r\n              <div className=\"flex items-center gap-2\">\r\n                {isExpanded ? (\r\n                  <ChevronDown className=\"h-4 w-4\" />\r\n                ) : (\r\n                  <ChevronRight className=\"h-4 w-4\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n        </CollapsibleTrigger>\r\n        <CollapsibleContent>\r\n          <CardContent>\r\n            {isLoading ? (\r\n              <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\r\n                {[...Array(6)].map((_, i) => (\r\n                  <Card key={i}>\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex gap-3\">\r\n                        <div className=\"w-12 h-16 bg-muted rounded animate-pulse\" />\r\n                        <div className=\"flex-1 space-y-2\">\r\n                          <div className=\"h-4 bg-muted rounded animate-pulse\" />\r\n                          <div className=\"h-3 bg-muted rounded animate-pulse w-2/3\" />\r\n                          <div className=\"h-6 bg-muted rounded animate-pulse w-1/2\" />\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            ) : error ? (\r\n              <div className=\"text-center py-8\">\r\n                <FileText className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                <p className=\"text-muted-foreground\">Error loading community books</p>\r\n              </div>\r\n            ) : books?.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <BookOpen className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                <p className=\"text-muted-foreground\">No approved books available yet</p>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {books?.length || 0} books available\r\n                  </p>\r\n                  <Select value={viewMode} onValueChange={(value: 'list' | 'grid') => setLocalViewMode(value)}>\r\n                    <SelectTrigger className=\"w-32\">\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"grid\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Grid className=\"h-4 w-4\" />\r\n                          Grid\r\n                        </div>\r\n                      </SelectItem>\r\n                      <SelectItem value=\"list\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <List className=\"h-4 w-4\" />\r\n                          List\r\n                        </div>\r\n                      </SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                {viewMode === 'grid' ? (\r\n                  <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\r\n                    {books?.map(renderBookCard)}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-3\">\r\n                    {books?.map(renderBookList)}\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n          </CardContent>\r\n        </CollapsibleContent>\r\n      </Card>\r\n    </Collapsible>\r\n  );\r\n};\r\n\r\nexport default ApprovedStorageBooksSection;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\BookCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\BookCarousel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\BookDetailModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\BookItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\BookListDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\BookQuizModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1309,1312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1309,1312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { CheckCircle, XCircle, Brain, Trophy, RotateCcw } from 'lucide-react';\r\nimport { useBookQuiz, QuizQuestion } from '@/hooks/useBookQuiz';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface BookQuizModalProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  bookId: string;\r\n  bookTitle: string;\r\n  maxChapterIndex: number;\r\n}\r\n\r\nconst BookQuizModal = ({ open, onOpenChange, bookId, bookTitle, maxChapterIndex }: BookQuizModalProps) => {\r\n  const { session, loading, error, startQuiz, submitAnswer, completeQuiz, resetQuiz } = useBookQuiz();\r\n  const cleanup = useCleanup('BookQuizModal');\r\n  const [selectedAnswer, setSelectedAnswer] = useState<string>('');\r\n  const [showFeedback, setShowFeedback] = useState(false);\r\n  const [lastAnswerResult, setLastAnswerResult] = useState<{ isCorrect: boolean; currentScore: number } | null>(null);\r\n  const [quizResults, setQuizResults] = useState<any>(null);\r\n\r\n  const handleStartQuiz = async () => {\r\n    await startQuiz(bookId, maxChapterIndex);\r\n  };\r\n\r\n  const handleSubmitAnswer = () => {\r\n    if (!selectedAnswer || !session) return;\r\n\r\n    const result = submitAnswer(selectedAnswer);\r\n    setLastAnswerResult(result);\r\n    setShowFeedback(true);\r\n    \r\n    // Auto-advance after showing feedback\r\n    cleanup.setTimeout(() => {\r\n      if (session.isComplete) {\r\n        handleCompleteQuiz();\r\n      } else {\r\n        setSelectedAnswer('');\r\n        setShowFeedback(false);\r\n        setLastAnswerResult(null);\r\n      }\r\n    }, 2000);\r\n  };\r\n\r\n  const handleCompleteQuiz = async () => {\r\n    try {\r\n      const results = await completeQuiz();\r\n      setQuizResults(results);\r\n    } catch (error) {\r\n      console.error('Error completing quiz:', error);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    resetQuiz();\r\n    setSelectedAnswer('');\r\n    setShowFeedback(false);\r\n    setLastAnswerResult(null);\r\n    setQuizResults(null);\r\n    onOpenChange(false);\r\n  };\r\n\r\n  const currentQuestion = session?.questions[session.currentQuestionIndex];\r\n  const progress = session ? ((session.currentQuestionIndex + 1) / session.questions.length) * 100 : 0;\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Brain className=\"h-5 w-5 text-purple-600\" />\r\n            Quiz: {bookTitle}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-6\">\r\n          {/* Error State */}\r\n          {error && (\r\n            <Card className=\"border-red-200 bg-red-50\">\r\n              <CardContent className=\"p-4\">\r\n                <p className=\"text-red-600\">{error}</p>\r\n                <Button onClick={handleStartQuiz} className=\"mt-2\">\r\n                  Try Again\r\n                </Button>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Quiz Start Screen */}\r\n          {!session && !loading && !error && (\r\n            <div className=\"text-center space-y-4\">\r\n              <div className=\"p-6 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg\">\r\n                <Brain className=\"h-16 w-16 text-purple-600 mx-auto mb-4\" />\r\n                <h3 className=\"text-lg font-semibold mb-2\">Ready to test your knowledge?</h3>\r\n                <p className=\"text-gray-600 mb-4\">\r\n                  This quiz covers chapters 1-{maxChapterIndex} of {bookTitle}\r\n                </p>\r\n                <Badge variant=\"secondary\" className=\"mb-4\">\r\n                  {maxChapterIndex} {maxChapterIndex === 1 ? 'Chapter' : 'Chapters'} Available\r\n                </Badge>\r\n              </div>\r\n              <Button \r\n                onClick={handleStartQuiz} \r\n                className=\"w-full bg-purple-600 hover:bg-purple-700\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? 'Loading Questions...' : 'Start Quiz'}\r\n              </Button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Quiz Results Screen */}\r\n          {quizResults && (\r\n            <div className=\"text-center space-y-4\">\r\n              <div className=\"p-6 bg-gradient-to-br from-green-50 to-blue-50 rounded-lg\">\r\n                <Trophy className=\"h-16 w-16 text-yellow-500 mx-auto mb-4\" />\r\n                <h3 className=\"text-xl font-bold mb-2\">Quiz Complete!</h3>\r\n                <div className=\"grid grid-cols-2 gap-4 max-w-md mx-auto\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-2xl font-bold text-green-600\">\r\n                      {quizResults.score}/{quizResults.totalQuestions}\r\n                    </div>\r\n                    <p className=\"text-sm text-gray-600\">Correct Answers</p>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-2xl font-bold text-purple-600\">\r\n                      +{quizResults.xpAwarded}\r\n                    </div>\r\n                    <p className=\"text-sm text-gray-600\">XP Earned</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-4\">\r\n                  <Badge \r\n                    variant={quizResults.percentage >= 80 ? \"default\" : quizResults.percentage >= 60 ? \"secondary\" : \"destructive\"}\r\n                    className=\"text-sm\"\r\n                  >\r\n                    {quizResults.percentage.toFixed(0)}% Score\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                <Button onClick={handleStartQuiz} variant=\"outline\" className=\"flex-1\">\r\n                  <RotateCcw className=\"h-4 w-4 mr-2\" />\r\n                  Retake Quiz\r\n                </Button>\r\n                <Button onClick={handleClose} className=\"flex-1\">\r\n                  Close\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Active Quiz */}\r\n          {session && currentQuestion && !quizResults && (\r\n            <div className=\"space-y-4\">\r\n              {/* Progress */}\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between text-sm text-gray-600\">\r\n                  <span>Question {session.currentQuestionIndex + 1} of {session.questions.length}</span>\r\n                  <span>Score: {session.score}/{session.questions.length}</span>\r\n                </div>\r\n                <Progress value={progress} className=\"h-2\" />\r\n              </div>\r\n\r\n              {/* Question */}\r\n              <Card>\r\n                <CardContent className=\"p-6\">\r\n                  <div className=\"flex items-start gap-3 mb-4\">\r\n                    <Badge variant=\"outline\">Chapter {currentQuestion.chapter_index}</Badge>\r\n                    <div className=\"flex-1\">\r\n                      <h3 className=\"text-lg font-medium mb-4\">\r\n                        {currentQuestion.question_text}\r\n                      </h3>\r\n\r\n                      {/* Answer Options */}\r\n                      <div className=\"grid gap-2\">\r\n                        {currentQuestion.options.map((option, index) => {\r\n                          const isSelected = selectedAnswer === option;\r\n                          const isCorrect = showFeedback && option === currentQuestion.correct_answer;\r\n                          const isWrong = showFeedback && isSelected && option !== currentQuestion.correct_answer;\r\n\r\n                          return (\r\n                            <Button\r\n                              key={index}\r\n                              variant={isSelected ? \"default\" : \"outline\"}\r\n                              className={cn(\r\n                                \"justify-start text-left h-auto p-4 transition-all\",\r\n                                isCorrect && \"bg-green-100 border-green-300 text-green-800\",\r\n                                isWrong && \"bg-red-100 border-red-300 text-red-800\",\r\n                                !showFeedback && isSelected && \"bg-purple-100 border-purple-300\"\r\n                              )}\r\n                              onClick={() => !showFeedback && setSelectedAnswer(option)}\r\n                              disabled={showFeedback}\r\n                            >\r\n                              <div className=\"flex items-center gap-3 w-full\">\r\n                                <div className={cn(\r\n                                  \"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-sm font-medium\",\r\n                                  isCorrect && \"bg-green-600 text-white\",\r\n                                  isWrong && \"bg-red-600 text-white\",\r\n                                  !showFeedback && isSelected && \"bg-purple-600 text-white\",\r\n                                  !showFeedback && !isSelected && \"bg-gray-100 text-gray-600\"\r\n                                )}>\r\n                                  {showFeedback ? (\r\n                                    isCorrect ? <CheckCircle className=\"h-3 w-3\" /> : \r\n                                    isWrong ? <XCircle className=\"h-3 w-3\" /> : \r\n                                    String.fromCharCode(65 + index)\r\n                                  ) : String.fromCharCode(65 + index)}\r\n                                </div>\r\n                                <span className=\"flex-1\">{option}</span>\r\n                              </div>\r\n                            </Button>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Feedback */}\r\n                  {showFeedback && lastAnswerResult && (\r\n                    <div className={cn(\r\n                      \"p-4 rounded-lg border mt-4\",\r\n                      lastAnswerResult.isCorrect \r\n                        ? \"bg-green-50 border-green-200 text-green-800\"\r\n                        : \"bg-orange-50 border-orange-200 text-orange-800\"\r\n                    )}>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {lastAnswerResult.isCorrect ? (\r\n                          <>\r\n                            <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                            <span className=\"font-medium\">Correct! Well done! ðŸŽ‰</span>\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <XCircle className=\"h-4 w-4 text-orange-600\" />\r\n                            <span className=\"font-medium\">\r\n                              Not quite. The correct answer is: {currentQuestion.correct_answer}\r\n                            </span>\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Submit Button */}\r\n                  {!showFeedback && (\r\n                    <div className=\"mt-6\">\r\n                      <Button\r\n                        onClick={handleSubmitAnswer}\r\n                        disabled={!selectedAnswer}\r\n                        className=\"w-full bg-purple-600 hover:bg-purple-700\"\r\n                      >\r\n                        Submit Answer\r\n                      </Button>\r\n                    </div>\r\n                  )}\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default BookQuizModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\CommunityBookItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\CommunityBooksGridView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\CommunityBooksListView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\CommunityLibraryContent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\CuratedBookItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\CuratedBooksSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\EPUBReader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\EPUBReaderFooter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\EPUBReaderHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\EPUBTableOfContents.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\EnhancedLoadingProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\EnhancedPDFViewer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'goToNextPage'. Either include it or remove the dependency array.","line":139,"column":6,"nodeType":"ArrayExpression","endLine":139,"endColumn":77,"suggestions":[{"desc":"Update the dependencies array to be: [pageNumber, numPages, onClose, isValidating, validationError, cleanup, goToNextPage]","fix":{"range":[5169,5240],"text":"[pageNumber, numPages, onClose, isValidating, validationError, cleanup, goToNextPage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Document, Page, pdfjs } from 'react-pdf';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogDescription, DialogTitle } from '@/components/ui/dialog';\r\nimport { ChevronLeft, ChevronRight, X, ZoomIn, ZoomOut, Home } from 'lucide-react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { pdfWorkerManager } from '@/utils/enhancedPdfWorkerConfig';\r\nimport { EnhancedPDFLoader, PDFLoadingProgress } from '@/utils/enhancedPdfUtils';\r\nimport UnifiedLoadingProgress from './UnifiedLoadingProgress';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport 'react-pdf/dist/Page/AnnotationLayer.css';\r\nimport 'react-pdf/dist/Page/TextLayer.css';\r\n\r\ninterface EnhancedPDFViewerProps {\r\n  fileUrl: string;\r\n  fileName: string;\r\n  onClose: () => void;\r\n}\r\n\r\nconst EnhancedPDFViewer: React.FC<EnhancedPDFViewerProps> = ({ fileUrl, fileName, onClose }) => {\r\n  const [numPages, setNumPages] = useState<number>(0);\r\n  const [pageNumber, setPageNumber] = useState<number>(1);\r\n  const [scale, setScale] = useState<number>(1.0);\r\n  const [isValidating, setIsValidating] = useState<boolean>(true);\r\n  const cleanup = useCleanup('EnhancedPDFViewer');\r\n  const [validationProgress, setValidationProgress] = useState<PDFLoadingProgress | null>(null);\r\n  const [validationError, setValidationError] = useState<string | null>(null);\r\n  const [processedUrl, setProcessedUrl] = useState<string>('');\r\n  const { toast } = useToast();\r\n\r\n  // Enhanced PDF options\r\n  const pdfOptions = React.useMemo(() => ({\r\n    cMapUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@4.8.69/cmaps/`,\r\n    cMapPacked: true,\r\n    standardFontDataUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@4.8.69/standard_fonts/`,\r\n  }), []);\r\n\r\n  useEffect(() => {\r\n    const initializeAndValidate = async () => {\r\n      console.log('ðŸ” Enhanced PDF Viewer initializing:', fileName);\r\n      \r\n      // Ensure PDF worker is ready\r\n      const workerReady = await pdfWorkerManager.initialize();\r\n      if (!workerReady) {\r\n        setValidationError('PDF worker failed to initialize. Please refresh the page.');\r\n        setIsValidating(false);\r\n        return;\r\n      }\r\n\r\n      // Validate and process the PDF URL\r\n      const loader = new EnhancedPDFLoader(setValidationProgress);\r\n      const result = await loader.validateAndLoad(fileUrl);\r\n\r\n      if (!result.isValid) {\r\n        setValidationError(result.error || 'PDF validation failed');\r\n        setIsValidating(false);\r\n        return;\r\n      }\r\n\r\n      setProcessedUrl(result.processedUrl!);\r\n      setIsValidating(false);\r\n      setValidationProgress(null);\r\n\r\n      toast({\r\n        title: \"PDF Ready\",\r\n        description: `${fileName} has been validated and is ready to view.`,\r\n      });\r\n    };\r\n\r\n    initializeAndValidate();\r\n  }, [fileUrl, fileName, toast]);\r\n\r\n  const onDocumentLoadSuccess = ({ numPages }: { numPages: number }) => {\r\n    console.log('âœ… Enhanced PDF loaded successfully:', { \r\n      numPages, \r\n      fileName,\r\n      workerStatus: pdfWorkerManager.getStatus()\r\n    });\r\n    \r\n    setNumPages(numPages);\r\n    \r\n    toast({\r\n      title: \"PDF Loaded\",\r\n      description: `Successfully loaded ${fileName} with ${numPages} pages.`,\r\n    });\r\n  };\r\n\r\n  const onDocumentLoadError = async (error: Error) => {\r\n    console.error('âŒ Enhanced PDF loading error:', error);\r\n    \r\n    let errorMessage = \"Failed to load PDF file.\";\r\n    \r\n    if (error.message.includes('worker')) {\r\n      errorMessage = \"PDF worker issue. Attempting to fix...\";\r\n      const workerFixed = await pdfWorkerManager.reinitialize();\r\n      if (!workerFixed) {\r\n        errorMessage = \"PDF worker configuration failed. Please refresh the page.\";\r\n      }\r\n    } else if (error.message.includes('fetch') || error.message.includes('network')) {\r\n      errorMessage = \"Network error loading PDF. Please check your connection.\";\r\n    } else if (error.message.includes('Invalid PDF')) {\r\n      errorMessage = \"Invalid or corrupted PDF file.\";\r\n    }\r\n    \r\n    toast({\r\n      title: \"PDF Error\",\r\n      description: errorMessage,\r\n      variant: \"destructive\"\r\n    });\r\n  };\r\n\r\n  const goToPrevPage = () => setPageNumber(prev => Math.max(prev - 1, 1));\r\n  const goToNextPage = () => setPageNumber(prev => Math.min(prev + 1, numPages));\r\n  const zoomIn = () => setScale(prev => Math.min(prev + 0.2, 2.0));\r\n  const zoomOut = () => setScale(prev => Math.max(prev - 0.2, 0.5));\r\n\r\n  const progressPercentage = numPages > 0 ? (pageNumber / numPages) * 100 : 0;\r\n\r\n  // Keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyPress = (event: KeyboardEvent) => {\r\n      if (event.key === 'Escape') {\r\n        onClose();\r\n      } else if (event.key === 'ArrowLeft') {\r\n        goToPrevPage();\r\n      } else if (event.key === 'ArrowRight') {\r\n        goToNextPage();\r\n      }\r\n    };\r\n\r\n    if (!isValidating && !validationError) {\r\n      const listenerId = cleanup.addEventListener(document, 'keydown', handleKeyPress);\r\n      return () => {\r\n        // Cleanup handled by useCleanup hook\r\n      };\r\n    }\r\n  }, [pageNumber, numPages, onClose, isValidating, validationError, cleanup]);\r\n\r\n  // Show validation/loading state\r\n  if (isValidating || validationError) {\r\n    return (\r\n      <Dialog open={true} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-full max-h-full w-screen h-screen p-0\">\r\n          <DialogTitle className=\"sr-only\">PDF Viewer: {fileName}</DialogTitle>\r\n          <DialogDescription className=\"sr-only\">\r\n            Enhanced PDF viewer for {fileName}\r\n          </DialogDescription>\r\n          \r\n          <UnifiedLoadingProgress\r\n            title={fileName}\r\n            progress={validationProgress}\r\n            error={validationError}\r\n            onRetry={() => window.location.reload()}\r\n            onCancel={onClose}\r\n            type=\"pdf\"\r\n          />\r\n        </DialogContent>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Dialog open={true} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-full max-h-full w-screen h-screen p-0\">\r\n        <DialogTitle className=\"sr-only\">Enhanced PDF Viewer: {fileName}</DialogTitle>\r\n        <DialogDescription className=\"sr-only\">\r\n          Enhanced PDF viewer for {fileName}. Use arrow keys to navigate pages.\r\n        </DialogDescription>\r\n        \r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Header */}\r\n          <div className=\"flex-shrink-0 p-4 border-b bg-background\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex-1 min-w-0\">\r\n                <h2 className=\"text-lg font-semibold truncate\">{fileName}</h2>\r\n                {numPages > 0 && (\r\n                  <div className=\"mt-2 space-y-1\">\r\n                    <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n                      <span>Page {pageNumber} of {numPages}</span>\r\n                      <span>{progressPercentage.toFixed(1)}% complete</span>\r\n                    </div>\r\n                    <Progress value={progressPercentage} className=\"h-1.5 bg-muted\" />\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-2 ml-4\">\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={zoomOut} disabled={scale <= 0.5}>\r\n                  <ZoomOut className=\"h-4 w-4\" />\r\n                </Button>\r\n                <span className=\"text-sm px-2\">{Math.round(scale * 100)}%</span>\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={zoomIn} disabled={scale >= 2.0}>\r\n                  <ZoomIn className=\"h-4 w-4\" />\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\r\n                  <X className=\"h-4 w-4\" />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* PDF Content */}\r\n          <div className=\"flex-1 overflow-auto bg-gray-100 flex items-center justify-center p-4\">\r\n            <div className=\"bg-white shadow-lg\">\r\n              <Document\r\n                file={processedUrl}\r\n                onLoadSuccess={onDocumentLoadSuccess}\r\n                onLoadError={onDocumentLoadError}\r\n                loading={\r\n                  <div className=\"flex items-center justify-center p-8\">\r\n                    <div className=\"text-center space-y-4\">\r\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"text-sm text-muted-foreground\">Rendering PDF...</div>\r\n                        <div className=\"text-xs text-muted-foreground\">{fileName}</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                }\r\n                options={pdfOptions}\r\n              >\r\n                {numPages > 0 && (\r\n                  <Page\r\n                    pageNumber={pageNumber}\r\n                    scale={scale}\r\n                    loading={\r\n                      <div className=\"flex items-center justify-center h-96 w-64\">\r\n                        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary\"></div>\r\n                      </div>\r\n                    }\r\n                  />\r\n                )}\r\n              </Document>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Footer Navigation */}\r\n          {numPages > 0 && (\r\n            <div className=\"flex-shrink-0 p-4 border-t bg-background\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Button variant=\"outline\" onClick={onClose} className=\"flex items-center gap-2\">\r\n                  <Home className=\"h-4 w-4\" />\r\n                  <span className=\"hidden sm:inline\">Back to Library</span>\r\n                </Button>\r\n                \r\n                <div className=\"flex items-center gap-2\">\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    onClick={goToPrevPage} \r\n                    disabled={pageNumber <= 1}\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    <ChevronLeft className=\"h-4 w-4\" />\r\n                    <span className=\"hidden sm:inline\">Previous</span>\r\n                  </Button>\r\n                  \r\n                  <div className=\"hidden md:flex items-center gap-2 px-3 py-1 bg-muted rounded text-sm text-muted-foreground\">\r\n                    Page {pageNumber} of {numPages}\r\n                  </div>\r\n                  \r\n                  <Button \r\n                    variant=\"outline\" \r\n                    onClick={goToNextPage} \r\n                    disabled={pageNumber >= numPages}\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    <span className=\"hidden sm:inline\">Next</span>\r\n                    <ChevronRight className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"mt-2 text-center text-xs text-muted-foreground\">\r\n                Use arrow keys to navigate â€¢ Press ESC to close â€¢ Enhanced loading system active\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default EnhancedPDFViewer;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\EnhancedSearchBar.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":69,"column":6,"nodeType":"ArrayExpression","endLine":69,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, query]","fix":{"range":[2413,2420],"text":"[cleanup, query]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * Enhanced search bar with instant suggestions and typeahead\r\n */\r\n\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { Search, Zap, TrendingUp, Clock } from 'lucide-react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { searchIndexService } from '@/services/SearchIndexService';\r\nimport { browsingPatternsAnalyzer } from '@/services/BrowsingPatternsAnalyzer';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface SearchSuggestion {\r\n  term: string;\r\n  type: 'title' | 'author' | 'subject';\r\n  bookCount: number;\r\n  books: string[];\r\n}\r\n\r\ninterface EnhancedSearchBarProps {\r\n  placeholder?: string;\r\n  onSearch?: (query: string) => void;\r\n  onSuggestionSelect?: (suggestion: SearchSuggestion) => void;\r\n  className?: string;\r\n}\r\n\r\nconst EnhancedSearchBar: React.FC<EnhancedSearchBarProps> = ({\r\n  placeholder = \"Search books with instant suggestions...\",\r\n  onSearch,\r\n  onSuggestionSelect,\r\n  className = \"\"\r\n}) => {\r\n  const [query, setQuery] = useState('');\r\n  const [suggestions, setSuggestions] = useState<SearchSuggestion[]>([]);\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [selectedIndex, setSelectedIndex] = useState(-1);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n  const suggestionsRef = useRef<HTMLDivElement>(null);\r\n  const cleanup = useCleanup('EnhancedSearchBar');\r\n\r\n  // Get search stats and popular terms\r\n  const searchStats = searchIndexService.getSearchStats();\r\n  const popularTerms = searchIndexService.getPopularTerms();\r\n\r\n  // Debounced suggestion fetching\r\n  useEffect(() => {\r\n    const timer = cleanup.setTimeout(() => {\r\n      if (query.trim() && query.length >= 2) {\r\n        setIsSearching(true);\r\n        console.log('ðŸ” Fetching suggestions for:', query);\r\n        \r\n        const fetchedSuggestions = searchIndexService.getInstantSuggestions(query, 8);\r\n        console.log('ðŸ’¡ Got suggestions:', fetchedSuggestions);\r\n        \r\n        setSuggestions(fetchedSuggestions);\r\n        setShowSuggestions(fetchedSuggestions.length > 0);\r\n        setIsSearching(false);\r\n      } else {\r\n        setSuggestions([]);\r\n        setShowSuggestions(false);\r\n        setIsSearching(false);\r\n      }\r\n      setSelectedIndex(-1);\r\n    }, 150);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [query]);\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    setQuery(value);\r\n    \r\n    // Record search event for pattern analysis\r\n    if (value.length >= 2) {\r\n      browsingPatternsAnalyzer.recordEvent('search', 'search', { query: value });\r\n    }\r\n    \r\n    // Immediately notify parent of search\r\n    onSearch?.(value);\r\n  };\r\n\r\n  const handleSuggestionClick = (suggestion: SearchSuggestion) => {\r\n    setQuery(suggestion.term);\r\n    setShowSuggestions(false);\r\n    onSuggestionSelect?.(suggestion);\r\n    onSearch?.(suggestion.term);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (!showSuggestions) return;\r\n\r\n    switch (e.key) {\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        setSelectedIndex(prev => Math.min(prev + 1, suggestions.length - 1));\r\n        break;\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        setSelectedIndex(prev => Math.max(prev - 1, -1));\r\n        break;\r\n      case 'Enter':\r\n        e.preventDefault();\r\n        if (selectedIndex >= 0 && suggestions[selectedIndex]) {\r\n          handleSuggestionClick(suggestions[selectedIndex]);\r\n        } else if (query) {\r\n          setShowSuggestions(false);\r\n          onSearch?.(query);\r\n        }\r\n        break;\r\n      case 'Escape':\r\n        setShowSuggestions(false);\r\n        setSelectedIndex(-1);\r\n        inputRef.current?.blur();\r\n        break;\r\n    }\r\n  };\r\n\r\n  const handlePopularTermClick = (term: string) => {\r\n    setQuery(term);\r\n    onSearch?.(term);\r\n  };\r\n\r\n  const clearSearch = () => {\r\n    setQuery('');\r\n    setSuggestions([]);\r\n    setShowSuggestions(false);\r\n    onSearch?.('');\r\n  };\r\n\r\n  const getSuggestionIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'author': return 'ðŸ‘¤';\r\n      case 'subject': return 'ðŸ“š';\r\n      case 'title': return 'ðŸ“–';\r\n      default: return 'ðŸ”';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`relative w-full max-w-2xl mx-auto ${className}`}>\r\n      {/* Search Input */}\r\n      <div className=\"relative\">\r\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\r\n        <Input\r\n          ref={inputRef}\r\n          type=\"search\"\r\n          placeholder={placeholder}\r\n          value={query}\r\n          onChange={handleInputChange}\r\n          onKeyDown={handleKeyDown}\r\n          onFocus={() => query.length >= 2 && setShowSuggestions(true)}\r\n          className=\"pl-10 pr-20\"\r\n        />\r\n        \r\n        {/* Search Stats & Clear Button */}\r\n        <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2\">\r\n          {isSearching && (\r\n            <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent\" />\r\n          )}\r\n          {query && (\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={clearSearch}\r\n              className=\"h-6 w-6 p-0\"\r\n            >\r\n              Ã—\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Enhanced Suggestions Dropdown */}\r\n      {showSuggestions && (\r\n        <div\r\n          ref={suggestionsRef}\r\n          className=\"absolute z-50 w-full mt-1 bg-card border border-border rounded-md shadow-lg max-h-80 overflow-y-auto\"\r\n        >\r\n          {suggestions.map((suggestion, index) => (\r\n            <div\r\n              key={`${suggestion.type}-${suggestion.term}`}\r\n              className={`flex items-center gap-3 p-3 cursor-pointer transition-colors hover:bg-muted/50 border-b border-border last:border-b-0 ${\r\n                index === selectedIndex ? 'bg-muted/50' : ''\r\n              }`}\r\n              onClick={() => handleSuggestionClick(suggestion)}\r\n              onMouseEnter={() => setSelectedIndex(index)}\r\n            >\r\n              <span className=\"text-lg\">{getSuggestionIcon(suggestion.type)}</span>\r\n              <div className=\"flex-1 min-w-0\">\r\n                <p className=\"font-medium text-sm truncate\">{suggestion.term}</p>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {suggestion.bookCount} book{suggestion.bookCount !== 1 ? 's' : ''} â€¢ {suggestion.type}\r\n                </p>\r\n              </div>\r\n              <Zap className=\"h-3 w-3 text-primary\" />\r\n            </div>\r\n          ))}\r\n\r\n          {/* Popular Terms Section */}\r\n          {!query && popularTerms.length > 0 && (\r\n            <div className=\"border-t border-border p-3\">\r\n              <div className=\"flex items-center gap-2 mb-2\">\r\n                <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n                <span className=\"text-sm font-medium text-muted-foreground\">Popular Searches</span>\r\n              </div>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {popularTerms.slice(0, 5).map(term => (\r\n                  <button\r\n                    key={term}\r\n                    onClick={() => handlePopularTermClick(term)}\r\n                    className=\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded hover:bg-secondary/80 transition-colors\"\r\n                  >\r\n                    {term}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Search Performance Stats */}\r\n      {searchStats && query.length >= 2 && (\r\n        <div className=\"mt-2 text-xs text-muted-foreground text-center\">\r\n          <div className=\"flex items-center justify-center gap-4\">\r\n            <span className=\"flex items-center gap-1\">\r\n              <Zap className=\"h-3 w-3\" />\r\n              {searchStats.indexedBooks} books indexed\r\n            </span>\r\n            <span className=\"flex items-center gap-1\">\r\n              <Clock className=\"h-3 w-3\" />\r\n              Instant search enabled\r\n            </span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EnhancedSearchBar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\ErrorHandler.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\GutenbergIngestionTrigger.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\LibraryHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\LibraryHero.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\LibrarySearchSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\LibrarySection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\LibraryWithMonitoring.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\LoadMoreSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\LoadingIndicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\OpenLibrarySearchBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\OptimizedPDFViewer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'pageNumber'. Either exclude it or remove the dependency array.","line":161,"column":6,"nodeType":"ArrayExpression","endLine":161,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [numPages, preloadedPages]","fix":{"range":[6738,6776],"text":"[numPages, preloadedPages]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'fileName'. Either exclude it or remove the dependency array.","line":247,"column":6,"nodeType":"ArrayExpression","endLine":247,"endColumn":35,"suggestions":[{"desc":"Update the dependencies array to be: [retryCount, toast]","fix":{"range":[9547,9576],"text":"[retryCount, toast]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":344,"column":6,"nodeType":"ArrayExpression","endLine":344,"endColumn":119,"suggestions":[{"desc":"Update the dependencies array to be: [pageNumber, numPages, onClose, goToPrevPage, goToNextPage, goToPage, zoomIn, zoomOut, resetZoom, rotateDocument, cleanup]","fix":{"range":[12507,12620],"text":"[pageNumber, numPages, onClose, goToPrevPage, goToNextPage, goToPage, zoomIn, zoomOut, resetZoom, rotateDocument, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { Document, Page, pdfjs } from 'react-pdf';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogDescription, DialogTitle } from '@/components/ui/dialog';\r\nimport { Slider } from '@/components/ui/slider';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { ChevronLeft, ChevronRight, X, ZoomIn, ZoomOut, Home, RefreshCw, AlertTriangle, RotateCcw, Download, Copy } from 'lucide-react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\nimport { initializeReliablePDF } from '@/utils/reliablePdfConfig';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport 'react-pdf/dist/Page/AnnotationLayer.css';\r\nimport 'react-pdf/dist/Page/TextLayer.css';\r\n\r\ninterface OptimizedPDFViewerProps {\r\n  fileUrl: string;\r\n  fileName: string;\r\n  onClose: () => void;\r\n}\r\n\r\ninterface PageCache {\r\n  [pageNumber: number]: React.ReactElement;\r\n}\r\n\r\nconst OptimizedPDFViewer: React.FC<OptimizedPDFViewerProps> = ({ fileUrl, fileName, onClose }) => {\r\n  const cleanup = useCleanup('OptimizedPDFViewer');\r\n  const [numPages, setNumPages] = useState<number>(0);\r\n  const [pageNumber, setPageNumber] = useState<number>(1);\r\n  const [scale, setScale] = useState<number>(1.0);\r\n  const [rotation, setRotation] = useState<number>(0);\r\n  const [isLoading, setIsLoading] = useState<boolean>(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [pageCache, setPageCache] = useState<PageCache>({});\r\n  const [preloadedPages, setPreloadedPages] = useState<Set<number>>(new Set());\r\n  const [isTextSelectionEnabled, setIsTextSelectionEnabled] = useState<boolean>(true);\r\n  const [retryCount, setRetryCount] = useState<number>(0);\r\n  const [loadingProgress, setLoadingProgress] = useState<number>(0);\r\n  const [isTimedOut, setIsTimedOut] = useState<boolean>(false);\r\n  \r\n  const { toast } = useToast();\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const pageRefs = useRef<{ [key: number]: HTMLDivElement | null }>({});\r\n  const loadingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  \r\n  // Touch gesture handling\r\n  const [touchStart, setTouchStart] = useState<{ x: number; y: number } | null>(null);\r\n  const [lastTouchDistance, setLastTouchDistance] = useState<number>(0);\r\n\r\n  // Buffer size for lazy loading (pages to render around current page)\r\n  const BUFFER_SIZE = 2;\r\n  const PRELOAD_SIZE = 3;\r\n  const MAX_RETRIES = 3;\r\n  const LOADING_TIMEOUT = 45000; // 45 seconds timeout\r\n\r\n  // Initialize PDF worker on mount\r\n  useEffect(() => {\r\n    const workerInitialized = initializeReliablePDF();\r\n    if (!workerInitialized) {\r\n      console.warn('âš ï¸ PDF worker initialization failed, may cause loading issues');\r\n    }\r\n  }, []);\r\n\r\n  // PDF.js options optimized for performance\r\n  const pdfOptions = React.useMemo(() => ({\r\n    cMapUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@${pdfjs.version}/cmaps/`,\r\n    cMapPacked: true,\r\n    standardFontDataUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@${pdfjs.version}/standard_fonts/`,\r\n    disableWorker: false,\r\n    enableXfa: false,\r\n    disableRange: false, // Enable range requests for better performance\r\n    disableStream: false, // Enable streaming for better performance\r\n    httpHeaders: {\r\n      'Access-Control-Allow-Origin': '*',\r\n      'Access-Control-Allow-Methods': 'GET, HEAD, OPTIONS',\r\n      'Access-Control-Allow-Headers': 'Range, Content-Range, Content-Length'\r\n    },\r\n    withCredentials: false // Prevent CORS issues\r\n  }), []);\r\n\r\n  // Set up loading timeout\r\n  useEffect(() => {\r\n    if (isLoading) {\r\n      loadingTimeoutRef.current = setTimeout(() => {\r\n        console.warn('â° PDF loading timeout reached');\r\n        setIsTimedOut(true);\r\n        setError('PDF loading timed out. The file might be too large or there may be a network issue.');\r\n        setIsLoading(false);\r\n        \r\n        toast({\r\n          title: \"Loading Timeout\",\r\n          description: \"PDF took too long to load. Try refreshing or check your connection.\",\r\n          variant: \"destructive\"\r\n        });\r\n      }, LOADING_TIMEOUT);\r\n    } else {\r\n      if (loadingTimeoutRef.current) {\r\n        clearTimeout(loadingTimeoutRef.current);\r\n        loadingTimeoutRef.current = null;\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (loadingTimeoutRef.current) {\r\n        clearTimeout(loadingTimeoutRef.current);\r\n        loadingTimeoutRef.current = null;\r\n      }\r\n    };\r\n  }, [isLoading, toast]);\r\n\r\n  // Calculate which pages should be rendered based on current page and buffer\r\n  const getVisiblePages = useCallback(() => {\r\n    const maxPages = Math.min(numPages, 100); // Limit total pages to prevent memory issues\r\n    const effectiveBufferSize = Math.min(BUFFER_SIZE, 5); // Limit buffer size\r\n    const start = Math.max(1, pageNumber - effectiveBufferSize);\r\n    const end = Math.min(maxPages, pageNumber + effectiveBufferSize);\r\n    const pageCount = end - start + 1;\r\n    \r\n    // Further limit if too many pages\r\n    if (pageCount > 20) {\r\n      const limitedEnd = Math.min(end, start + 19);\r\n      return Array.from({ length: limitedEnd - start + 1 }, (_, i) => start + i);\r\n    }\r\n    \r\n    return Array.from({ length: pageCount }, (_, i) => start + i);\r\n  }, [pageNumber, numPages]);\r\n\r\n  // Preload pages near current page with memory limits\r\n  const preloadPages = useCallback((centerPage: number) => {\r\n    const maxPreloadedPages = 15; // Limit preloaded pages\r\n    const effectivePreloadSize = Math.min(PRELOAD_SIZE, 3); // Reduce preload size\r\n    \r\n    // Clean up old preloaded pages if we have too many\r\n    if (preloadedPages.size > maxPreloadedPages) {\r\n      const pagesToKeep = new Set<number>();\r\n      const keepRange = 5;\r\n      for (let i = Math.max(1, centerPage - keepRange); i <= Math.min(numPages, centerPage + keepRange); i++) {\r\n        if (preloadedPages.has(i)) {\r\n          pagesToKeep.add(i);\r\n        }\r\n      }\r\n      setPreloadedPages(pagesToKeep);\r\n    }\r\n    \r\n    const pagesToPreload = [];\r\n    for (let i = Math.max(1, centerPage - effectivePreloadSize); i <= Math.min(numPages, centerPage + effectivePreloadSize); i++) {\r\n      if (!preloadedPages.has(i) && pagesToPreload.length < 5) { // Limit new preloads\r\n        pagesToPreload.push(i);\r\n      }\r\n    }\r\n    \r\n    if (pagesToPreload.length > 0) {\r\n      setPreloadedPages(prev => {\r\n        const newSet = new Set(prev);\r\n        pagesToPreload.forEach(page => newSet.add(page));\r\n        return newSet;\r\n      });\r\n    }\r\n  }, [pageNumber, numPages, preloadedPages]);\r\n\r\n  const onDocumentLoadSuccess = ({ numPages }: { numPages: number }) => {\r\n    console.log('âœ… PDF loaded successfully:', { numPages, fileName });\r\n    \r\n    setNumPages(numPages);\r\n    setIsLoading(false);\r\n    setError(null);\r\n    setRetryCount(0); // Reset retry count on successful load\r\n    setLoadingProgress(100);\r\n    setIsTimedOut(false);\r\n    \r\n    // Clear timeout\r\n    if (loadingTimeoutRef.current) {\r\n      clearTimeout(loadingTimeoutRef.current);\r\n      loadingTimeoutRef.current = null;\r\n    }\r\n    \r\n    // Start preloading first few pages\r\n    preloadPages(1);\r\n    \r\n    toast({\r\n      title: \"PDF Loaded\",\r\n      description: `Successfully loaded ${fileName} with ${numPages} pages.`,\r\n    });\r\n  };\r\n\r\n  const onDocumentLoadError = (error: Error) => {\r\n    console.error('âŒ PDF loading error:', error);\r\n    setIsLoading(false);\r\n    setLoadingProgress(0);\r\n    setIsTimedOut(false);\r\n    \r\n    // Clear timeout\r\n    if (loadingTimeoutRef.current) {\r\n      clearTimeout(loadingTimeoutRef.current);\r\n      loadingTimeoutRef.current = null;\r\n    }\r\n    \r\n    const errorMessage = `Failed to load PDF: ${error.message}`;\r\n    let suggestion = '';\r\n    \r\n    // Provide specific error handling\r\n    if (error.message.includes('CORS')) {\r\n      suggestion = 'This PDF may have CORS restrictions. Try downloading it directly.';\r\n    } else if (error.message.includes('network') || error.message.includes('fetch')) {\r\n      suggestion = 'Network issue detected. Please check your connection and try again.';\r\n    } else if (error.message.includes('Invalid PDF')) {\r\n      suggestion = 'This file appears to be corrupted or is not a valid PDF.';\r\n    } else if (error.message.includes('Worker')) {\r\n      suggestion = 'PDF.js worker issue. The page will attempt to reload the viewer.';\r\n    }\r\n    \r\n    setError(`${errorMessage}${suggestion ? ` ${suggestion}` : ''}`);\r\n    \r\n    toast({\r\n      title: \"PDF Error\",\r\n      description: `Failed to load ${fileName}${suggestion ? `: ${suggestion}` : ''}`,\r\n      variant: \"destructive\"\r\n    });\r\n  };\r\n\r\n  const retryLoading = useCallback(() => {\r\n    if (retryCount < MAX_RETRIES) {\r\n      setRetryCount(prev => prev + 1);\r\n      setError(null);\r\n      setIsLoading(true);\r\n      setLoadingProgress(0);\r\n      setIsTimedOut(false);\r\n      setNumPages(0);\r\n      setPageNumber(1);\r\n      \r\n      // Clear any existing timeout\r\n      if (loadingTimeoutRef.current) {\r\n        clearTimeout(loadingTimeoutRef.current);\r\n        loadingTimeoutRef.current = null;\r\n      }\r\n      \r\n      // Reinitialize PDF worker\r\n      initializeReliablePDF();\r\n      \r\n      toast({\r\n        title: \"Retrying...\",\r\n        description: `Attempting to reload PDF (${retryCount + 1}/${MAX_RETRIES})`,\r\n      });\r\n    }\r\n  }, [retryCount, fileName, toast]);\r\n\r\n  const goToPage = useCallback((page: number) => {\r\n    const newPage = Math.max(1, Math.min(page, numPages));\r\n    setPageNumber(newPage);\r\n    preloadPages(newPage);\r\n    \r\n    // Scroll page into view\r\n    setTimeout(() => {\r\n      const pageElement = pageRefs.current[newPage];\r\n      if (pageElement) {\r\n        pageElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n      }\r\n    }, 100);\r\n  }, [numPages, preloadPages]);\r\n\r\n  const goToPrevPage = useCallback(() => goToPage(pageNumber - 1), [pageNumber, goToPage]);\r\n  const goToNextPage = useCallback(() => goToPage(pageNumber + 1), [pageNumber, goToPage]);\r\n  \r\n  const zoomIn = useCallback(() => setScale(prev => Math.min(prev + 0.25, 3.0)), []);\r\n  const zoomOut = useCallback(() => setScale(prev => Math.max(prev - 0.25, 0.25)), []);\r\n  const resetZoom = useCallback(() => setScale(1.0), []);\r\n  const rotateDocument = useCallback(() => setRotation(prev => (prev + 90) % 360), []);\r\n\r\n  const downloadPDF = useCallback(() => {\r\n    const link = document.createElement('a');\r\n    link.href = fileUrl;\r\n    link.download = fileName;\r\n    link.click();\r\n  }, [fileUrl, fileName]);\r\n\r\n  const copyPageNumber = useCallback(() => {\r\n    navigator.clipboard.writeText(`Page ${pageNumber} of ${numPages}`);\r\n    toast({\r\n      title: \"Copied\",\r\n      description: `Page ${pageNumber} of ${numPages} copied to clipboard`,\r\n    });\r\n  }, [pageNumber, numPages, toast]);\r\n\r\n  // Keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyPress = (event: KeyboardEvent) => {\r\n      if (event.target instanceof HTMLInputElement) return;\r\n      \r\n      switch (event.key) {\r\n        case 'Escape':\r\n          onClose();\r\n          break;\r\n        case 'ArrowLeft':\r\n        case 'h':\r\n          event.preventDefault();\r\n          goToPrevPage();\r\n          break;\r\n        case 'ArrowRight':\r\n        case 'l':\r\n          event.preventDefault();\r\n          goToNextPage();\r\n          break;\r\n        case 'ArrowUp':\r\n        case 'k':\r\n          event.preventDefault();\r\n          goToPage(pageNumber - 5);\r\n          break;\r\n        case 'ArrowDown':\r\n        case 'j':\r\n          event.preventDefault();\r\n          goToPage(pageNumber + 5);\r\n          break;\r\n        case '+':\r\n        case '=':\r\n          event.preventDefault();\r\n          zoomIn();\r\n          break;\r\n        case '-':\r\n          event.preventDefault();\r\n          zoomOut();\r\n          break;\r\n        case '0':\r\n          event.preventDefault();\r\n          resetZoom();\r\n          break;\r\n        case 'r':\r\n          event.preventDefault();\r\n          rotateDocument();\r\n          break;\r\n        case 'Home':\r\n          event.preventDefault();\r\n          goToPage(1);\r\n          break;\r\n        case 'End':\r\n          event.preventDefault();\r\n          goToPage(numPages);\r\n          break;\r\n      }\r\n    };\r\n\r\n    cleanup.addEventListener(document, 'keydown', handleKeyPress);\r\n  }, [pageNumber, numPages, onClose, goToPrevPage, goToNextPage, goToPage, zoomIn, zoomOut, resetZoom, rotateDocument]);\r\n\r\n  // Touch gesture handling\r\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\r\n    if (e.touches.length === 1) {\r\n      setTouchStart({ x: e.touches[0].clientX, y: e.touches[0].clientY });\r\n    } else if (e.touches.length === 2) {\r\n      const distance = Math.sqrt(\r\n        Math.pow(e.touches[0].clientX - e.touches[1].clientX, 2) +\r\n        Math.pow(e.touches[0].clientY - e.touches[1].clientY, 2)\r\n      );\r\n      setLastTouchDistance(distance);\r\n    }\r\n  }, []);\r\n\r\n  const handleTouchMove = useCallback((e: React.TouchEvent) => {\r\n    if (e.touches.length === 2) {\r\n      e.preventDefault();\r\n      const distance = Math.sqrt(\r\n        Math.pow(e.touches[0].clientX - e.touches[1].clientX, 2) +\r\n        Math.pow(e.touches[0].clientY - e.touches[1].clientY, 2)\r\n      );\r\n      \r\n      if (lastTouchDistance > 0) {\r\n        const scaleChange = distance / lastTouchDistance;\r\n        setScale(prev => Math.max(0.25, Math.min(3.0, prev * scaleChange)));\r\n      }\r\n      setLastTouchDistance(distance);\r\n    }\r\n  }, [lastTouchDistance]);\r\n\r\n  const handleTouchEnd = useCallback((e: React.TouchEvent) => {\r\n    if (touchStart && e.changedTouches.length === 1) {\r\n      const touchEnd = { x: e.changedTouches[0].clientX, y: e.changedTouches[0].clientY };\r\n      const deltaX = touchEnd.x - touchStart.x;\r\n      const deltaY = touchEnd.y - touchStart.y;\r\n      \r\n      // Swipe detection (minimum 50px movement)\r\n      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {\r\n        if (deltaX > 0) {\r\n          goToPrevPage();\r\n        } else {\r\n          goToNextPage();\r\n        }\r\n      }\r\n    }\r\n    \r\n    setTouchStart(null);\r\n    setLastTouchDistance(0);\r\n  }, [touchStart, goToPrevPage, goToNextPage]);\r\n\r\n  const progressPercentage = numPages > 0 ? (pageNumber / numPages) * 100 : 0;\r\n\r\n  if (error) {\r\n    return (\r\n      <Dialog open={true} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-md\">\r\n          <DialogTitle>PDF Viewer Error</DialogTitle>\r\n          <DialogDescription>\r\n            <div className=\"flex items-center justify-center p-8\">\r\n              <div className=\"text-center space-y-4\">\r\n                <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\r\n                <div className=\"text-destructive\">{error}</div>\r\n                <div className=\"text-xs text-muted-foreground\">\r\n                  File: {fileName}\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  {retryCount < MAX_RETRIES && (\r\n                    <Button variant=\"default\" size=\"sm\" onClick={retryLoading}>\r\n                      <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                      Retry ({retryCount + 1}/{MAX_RETRIES})\r\n                    </Button>\r\n                  )}\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={onClose}>\r\n                    <X className=\"h-4 w-4 mr-2\" />\r\n                    Close\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </DialogDescription>\r\n        </DialogContent>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Dialog open={true} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-full max-h-full w-screen h-screen p-0\">\r\n        <DialogTitle className=\"sr-only\">PDF Viewer: {fileName}</DialogTitle>\r\n        <DialogDescription className=\"sr-only\">\r\n          Optimized PDF viewer for {fileName}. Use arrow keys, swipe gestures, or controls to navigate.\r\n        </DialogDescription>\r\n        \r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Enhanced Header with More Controls */}\r\n          <div className=\"flex-shrink-0 p-3 border-b bg-background\">\r\n            <div className=\"flex items-center justify-between gap-2\">\r\n              <div className=\"flex-1 min-w-0\">\r\n                <h2 className=\"text-lg font-semibold truncate\">{fileName}</h2>\r\n                {!isLoading && numPages > 0 && (\r\n                  <div className=\"mt-2 space-y-1\">\r\n                    <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n                      <span>Page {pageNumber} of {numPages}</span>\r\n                      <span>{progressPercentage.toFixed(1)}% complete</span>\r\n                    </div>\r\n                    <Progress value={progressPercentage} className=\"h-1.5 bg-muted\" />\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <TooltipProvider>\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button variant=\"ghost\" size=\"sm\" onClick={zoomOut} disabled={scale <= 0.25}>\r\n                        <ZoomOut className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>Zoom Out (-)</TooltipContent>\r\n                  </Tooltip>\r\n                  \r\n                  <span className=\"text-xs px-2 min-w-[60px] text-center\">{Math.round(scale * 100)}%</span>\r\n                  \r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button variant=\"ghost\" size=\"sm\" onClick={zoomIn} disabled={scale >= 3.0}>\r\n                        <ZoomIn className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>Zoom In (+)</TooltipContent>\r\n                  </Tooltip>\r\n                  \r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button variant=\"ghost\" size=\"sm\" onClick={rotateDocument}>\r\n                        <RotateCcw className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>Rotate (R)</TooltipContent>\r\n                  </Tooltip>\r\n                  \r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button variant=\"ghost\" size=\"sm\" onClick={downloadPDF}>\r\n                        <Download className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>Download PDF</TooltipContent>\r\n                  </Tooltip>\r\n                  \r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button variant=\"ghost\" size=\"sm\" onClick={copyPageNumber}>\r\n                        <Copy className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>Copy Page Info</TooltipContent>\r\n                  </Tooltip>\r\n                  \r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\r\n                    <X className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </TooltipProvider>\r\n            </div>\r\n          </div>\r\n\r\n          {/* PDF Content with Touch Support */}\r\n          <div \r\n            className=\"flex-1 overflow-auto bg-gray-100 flex items-center justify-center p-4\"\r\n            onTouchStart={handleTouchStart}\r\n            onTouchMove={handleTouchMove}\r\n            onTouchEnd={handleTouchEnd}\r\n            ref={containerRef}\r\n            role=\"main\"\r\n            aria-label=\"PDF document viewer\"\r\n          >\r\n            <div className=\"bg-white shadow-lg max-w-full\" style={{ maxWidth: 'none' }}>\r\n              <Document\r\n                file={fileUrl}\r\n                onLoadSuccess={onDocumentLoadSuccess}\r\n                onLoadError={onDocumentLoadError}\r\n                onLoadProgress={({ loaded, total }) => {\r\n                  const progress = Math.round((loaded / total) * 100);\r\n                  setLoadingProgress(progress);\r\n                  console.log(`ðŸ“Š PDF loading progress: ${loaded}/${total} bytes (${progress}%)`);\r\n                }}\r\n                loading={\r\n                  <div className=\"flex items-center justify-center p-8\">\r\n                    <div className=\"text-center space-y-4 max-w-sm\">\r\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\r\n                      <div className=\"space-y-3\">\r\n                        <div className=\"text-sm text-muted-foreground\">Loading PDF document...</div>\r\n                        <div className=\"text-xs text-muted-foreground\">{fileName}</div>\r\n                        \r\n                        {/* Progress Bar */}\r\n                        <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                          <div \r\n                            className=\"bg-primary h-2 rounded-full transition-all duration-300 ease-out\"\r\n                            style={{ width: `${loadingProgress}%` }}\r\n                          ></div>\r\n                        </div>\r\n                        <div className=\"text-xs text-muted-foreground\">{loadingProgress}% complete</div>\r\n                        \r\n                        {retryCount > 0 && (\r\n                          <div className=\"text-xs text-amber-600\">Retry attempt {retryCount}/{MAX_RETRIES}</div>\r\n                        )}\r\n                        \r\n                        {isTimedOut && (\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"text-xs text-red-600\">Loading is taking longer than expected</div>\r\n                            <Button \r\n                              size=\"sm\" \r\n                              variant=\"outline\" \r\n                              onClick={retryLoading}\r\n                              disabled={retryCount >= MAX_RETRIES}\r\n                            >\r\n                              Retry Loading\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                }\r\n                options={pdfOptions}\r\n                key={`${fileUrl}-${retryCount}`}\r\n              >\r\n                {numPages > 0 && getVisiblePages().map(pageNum => (\r\n                  <div\r\n                    key={pageNum}\r\n                    ref={el => { pageRefs.current[pageNum] = el; }}\r\n                    className={`mb-4 ${pageNum === pageNumber ? 'ring-2 ring-primary' : ''}`}\r\n                  >\r\n                    <Page\r\n                      pageNumber={pageNum}\r\n                      scale={scale}\r\n                      rotate={rotation}\r\n                      renderTextLayer={isTextSelectionEnabled}\r\n                      renderAnnotationLayer={true}\r\n                      loading={\r\n                        <div className=\"flex items-center justify-center h-96 w-64 border border-gray-200 bg-gray-50\">\r\n                          <Skeleton className=\"h-full w-full\" />\r\n                        </div>\r\n                      }\r\n                      onLoadSuccess={() => {\r\n                        console.log(`ðŸ“„ Page ${pageNum} loaded successfully`);\r\n                      }}\r\n                      onLoadError={(error) => {\r\n                        console.warn(`âš ï¸ Page ${pageNum} failed to load:`, error);\r\n                      }}\r\n                    />\r\n                    <div className=\"text-center text-xs text-muted-foreground mt-2 py-1\">\r\n                      Page {pageNum}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </Document>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Enhanced Footer with Page Slider */}\r\n          {!isLoading && numPages > 0 && (\r\n            <div className=\"flex-shrink-0 p-4 border-t bg-background space-y-3\">\r\n              {/* Page Navigation Slider */}\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n                  <span>Quick Navigation</span>\r\n                  <span>Drag to jump to any page</span>\r\n                </div>\r\n                <Slider\r\n                  value={[pageNumber]}\r\n                  onValueChange={([value]) => goToPage(value)}\r\n                  max={numPages}\r\n                  min={1}\r\n                  step={1}\r\n                  className=\"w-full\"\r\n                  aria-label=\"Page navigation slider\"\r\n                />\r\n              </div>\r\n              \r\n              {/* Navigation Controls */}\r\n              <div className=\"flex items-center justify-between\">\r\n                <Button variant=\"outline\" onClick={onClose} className=\"flex items-center gap-2\">\r\n                  <Home className=\"h-4 w-4\" />\r\n                  <span className=\"hidden sm:inline\">Back to Library</span>\r\n                </Button>\r\n                \r\n                <div className=\"flex items-center gap-2\">\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    onClick={goToPrevPage} \r\n                    disabled={pageNumber <= 1}\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    <ChevronLeft className=\"h-4 w-4\" />\r\n                    <span className=\"hidden sm:inline\">Previous</span>\r\n                  </Button>\r\n                  \r\n                  <div className=\"flex items-center gap-2 px-3 py-1 bg-muted rounded text-sm text-muted-foreground\">\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      max={numPages}\r\n                      value={pageNumber}\r\n                      onChange={(e) => goToPage(parseInt(e.target.value) || 1)}\r\n                      className=\"w-16 text-center bg-transparent border-none outline-none\"\r\n                      aria-label=\"Current page number\"\r\n                    />\r\n                    <span>of {numPages}</span>\r\n                  </div>\r\n                  \r\n                  <Button \r\n                    variant=\"outline\" \r\n                    onClick={goToNextPage} \r\n                    disabled={pageNumber >= numPages}\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    <span className=\"hidden sm:inline\">Next</span>\r\n                    <ChevronRight className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Keyboard Shortcuts Help */}\r\n              <div className=\"text-center text-xs text-muted-foreground\">\r\n                <span className=\"hidden md:inline\">\r\n                  Keyboard: â†/â†’ (pages) â€¢ +/- (zoom) â€¢ R (rotate) â€¢ Home/End (first/last) â€¢ \r\n                </span>\r\n                Touch: Swipe to navigate â€¢ Pinch to zoom â€¢ ESC to close\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default OptimizedPDFViewer;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\OptimizedPublicDomainBooksList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\PDFLoadingProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\PDFUploadComponent.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":58,"column":6,"nodeType":"ArrayExpression","endLine":58,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, uploadPDF]","fix":{"range":[2019,2030],"text":"[cleanup, uploadPDF]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useCallback, useState } from 'react';\r\nimport { useDropzone } from 'react-dropzone';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useUserUploadedBooks } from '@/hooks/useUserUploadedBooks';\r\nimport { Upload, FileText, AlertCircle, CheckCircle } from 'lucide-react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { toast } from 'sonner';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\nconst PDFUploadComponent: React.FC = () => {\r\n  const cleanup = useCleanup('PDFUploadComponent');\r\n  const { uploadPDF, isUploading } = useUserUploadedBooks();\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n\r\n  const onDrop = useCallback((acceptedFiles: File[]) => {\r\n    const file = acceptedFiles[0];\r\n    if (!file) return;\r\n\r\n    if (file.type !== 'application/pdf') {\r\n      toast.error('Please upload a PDF file only');\r\n      return;\r\n    }\r\n\r\n    if (file.size > 50 * 1024 * 1024) { // 50MB limit\r\n      toast.error('File size must be less than 50MB');\r\n      return;\r\n    }\r\n\r\n    console.log('ðŸ“¤ Starting upload for:', file.name);\r\n    toast.success(`Uploading ${file.name}...`);\r\n    \r\n    // Simulate upload progress\r\n    let progress = 0;\r\n    const progressIntervalId = cleanup.setInterval(() => {\r\n      progress += 10;\r\n      setUploadProgress(progress);\r\n      if (progress >= 90) {\r\n        cleanup.cleanup(progressIntervalId);\r\n      }\r\n    }, 200);\r\n\r\n    uploadPDF(file, {\r\n      onSuccess: () => {\r\n        cleanup.cleanup(progressIntervalId);\r\n        setUploadProgress(100);\r\n        toast.success('PDF uploaded successfully! It\\'s now pending admin approval.');\r\n        cleanup.setTimeout(() => setUploadProgress(0), 2000);\r\n      },\r\n      onError: (error) => {\r\n        cleanup.cleanup(progressIntervalId);\r\n        setUploadProgress(0);\r\n        console.error('Upload error:', error);\r\n        toast.error('Failed to upload PDF. Please try again.');\r\n      }\r\n    });\r\n  }, [uploadPDF]);\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    accept: {\r\n      'application/pdf': ['.pdf']\r\n    },\r\n    multiple: false,\r\n    disabled: isUploading\r\n  });\r\n\r\n  return (\r\n    <Card className=\"w-full\">\r\n      <CardContent className=\"p-6\">\r\n        <div className=\"space-y-4\">\r\n          <div className=\"text-center\">\r\n            <h3 className=\"text-lg font-semibold mb-2\">Upload Your PDF Book</h3>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Share your own PDF books with the community. Files are reviewed before becoming available to all users.\r\n            </p>\r\n          </div>\r\n\r\n          <div\r\n            {...getRootProps()}\r\n            className={`\r\n              border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\r\n              ${isDragActive ? 'border-primary bg-primary/5' : 'border-muted-foreground/25'}\r\n              ${isUploading ? 'cursor-not-allowed opacity-50' : 'hover:border-primary hover:bg-primary/5'}\r\n            `}\r\n          >\r\n            <input {...getInputProps()} />\r\n            \r\n            {isUploading ? (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary\"></div>\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <p className=\"text-sm font-medium\">Uploading PDF...</p>\r\n                  <Progress value={uploadProgress} className=\"w-full max-w-xs mx-auto\" />\r\n                  <p className=\"text-xs text-muted-foreground\">{uploadProgress}% complete</p>\r\n                </div>\r\n              </div>\r\n            ) : isDragActive ? (\r\n              <div className=\"space-y-2\">\r\n                <Upload className=\"mx-auto h-8 w-8 text-primary\" />\r\n                <p className=\"text-sm font-medium\">Drop your PDF here</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-2\">\r\n                <FileText className=\"mx-auto h-8 w-8 text-muted-foreground\" />\r\n                <p className=\"text-sm font-medium\">Drag & drop a PDF file here</p>\r\n                <p className=\"text-xs text-muted-foreground\">or click to browse</p>\r\n                <Button variant=\"outline\" size=\"sm\" className=\"mt-2\">\r\n                  Select PDF File\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-xs text-muted-foreground\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <FileText className=\"h-4 w-4\" />\r\n              <span>PDF files only</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <AlertCircle className=\"h-4 w-4\" />\r\n              <span>Max 50MB file size</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <CheckCircle className=\"h-4 w-4\" />\r\n              <span>Admin review required</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default PDFUploadComponent;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\PDFViewer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'goToNextPage'. Either include it or remove the dependency array.","line":131,"column":6,"nodeType":"ArrayExpression","endLine":131,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [pageNumber, numPages, onClose, cleanup, goToNextPage]","fix":{"range":[4548,4588],"text":"[pageNumber, numPages, onClose, cleanup, goToNextPage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Document, Page, pdfjs } from 'react-pdf';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogDescription, DialogTitle } from '@/components/ui/dialog';\r\nimport { ChevronLeft, ChevronRight, X, ZoomIn, ZoomOut, Home, RefreshCw, AlertTriangle } from 'lucide-react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { reinitializeWorker, getWorkerInfo } from '@/utils/pdfWorkerConfig';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport 'react-pdf/dist/Page/AnnotationLayer.css';\r\nimport 'react-pdf/dist/Page/TextLayer.css';\r\n\r\ninterface PDFViewerProps {\r\n  fileUrl: string;\r\n  fileName: string;\r\n  onClose: () => void;\r\n}\r\n\r\nconst PDFViewer: React.FC<PDFViewerProps> = ({ fileUrl, fileName, onClose }) => {\r\n  const [numPages, setNumPages] = useState<number>(0);\r\n  const [pageNumber, setPageNumber] = useState<number>(1);\r\n  const [scale, setScale] = useState<number>(1.0);\r\n  const [isLoading, setIsLoading] = useState<boolean>(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const { toast } = useToast();\r\n  const cleanup = useCleanup('PDFViewer');\r\n\r\n  // Memoize the options to avoid react-pdf warnings\r\n  const pdfOptions = React.useMemo(() => ({\r\n    cMapUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@4.8.69/cmaps/`,\r\n    cMapPacked: true,\r\n    standardFontDataUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@4.8.69/standard_fonts/`,\r\n  }), []);\r\n\r\n  useEffect(() => {\r\n    console.log('ðŸ” PDFViewer Debug Info:', {\r\n      fileName,\r\n      fileUrl: fileUrl.substring(0, 100) + '...',\r\n      workerInfo: getWorkerInfo()\r\n    });\r\n  }, [fileUrl, fileName]);\r\n\r\n  const onDocumentLoadSuccess = ({ numPages }: { numPages: number }) => {\r\n    console.log('âœ… PDF loaded successfully:', { \r\n      numPages, \r\n      fileName,\r\n      workerInfo: getWorkerInfo()\r\n    });\r\n    \r\n    setNumPages(numPages);\r\n    setIsLoading(false);\r\n    setError(null);\r\n    \r\n    toast({\r\n      title: \"PDF Loaded\",\r\n      description: `Successfully loaded ${fileName} with ${numPages} pages.`,\r\n    });\r\n  };\r\n\r\n  const onDocumentLoadError = async (error: Error) => {\r\n    console.error('âŒ PDF loading error:', {\r\n      errorName: error.name,\r\n      errorMessage: error.message,\r\n      fileName,\r\n      workerInfo: getWorkerInfo()\r\n    });\r\n    \r\n    setIsLoading(false);\r\n    \r\n    let errorMessage = \"Failed to load PDF file.\";\r\n    \r\n    if (error.message.includes('worker') || error.message.includes('Setting up fake worker')) {\r\n      errorMessage = \"PDF worker configuration issue. Attempting to fix...\";\r\n      \r\n      // Try to reinitialize worker\r\n      const workerFixed = await reinitializeWorker();\r\n      if (workerFixed) {\r\n        errorMessage = \"Worker was reinitialized. Please try again.\";\r\n      } else {\r\n        errorMessage = \"Worker configuration failed. Please refresh the page.\";\r\n      }\r\n    } else if (error.message.includes('fetch') || error.message.includes('network')) {\r\n      errorMessage = \"Network error loading PDF. Please check your connection.\";\r\n    } else if (error.message.includes('Invalid PDF')) {\r\n      errorMessage = \"Invalid or corrupted PDF file.\";\r\n    }\r\n    \r\n    setError(errorMessage);\r\n    \r\n    toast({\r\n      title: \"PDF Error\",\r\n      description: errorMessage,\r\n      variant: \"destructive\"\r\n    });\r\n  };\r\n\r\n  const handleRetry = async () => {\r\n    console.log('ðŸ”„ Retrying PDF load for:', fileName);\r\n    \r\n    await reinitializeWorker();\r\n    \r\n    setError(null);\r\n    setIsLoading(true);\r\n    setNumPages(0);\r\n    setPageNumber(1);\r\n  };\r\n\r\n  const goToPrevPage = () => setPageNumber(prev => Math.max(prev - 1, 1));\r\n  const goToNextPage = () => setPageNumber(prev => Math.min(prev + 1, numPages));\r\n  const zoomIn = () => setScale(prev => Math.min(prev + 0.2, 2.0));\r\n  const zoomOut = () => setScale(prev => Math.max(prev - 0.2, 0.5));\r\n\r\n  const progressPercentage = numPages > 0 ? (pageNumber / numPages) * 100 : 0;\r\n\r\n  // Add keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyPress = (event: KeyboardEvent) => {\r\n      if (event.key === 'Escape') {\r\n        onClose();\r\n      } else if (event.key === 'ArrowLeft') {\r\n        goToPrevPage();\r\n      } else if (event.key === 'ArrowRight') {\r\n        goToNextPage();\r\n      }\r\n    };\r\n\r\n    const listenerId = cleanup.addEventListener(document, 'keydown', handleKeyPress);\r\n    return () => {\r\n      // Cleanup handled by useCleanup hook\r\n    };\r\n  }, [pageNumber, numPages, onClose, cleanup]);\r\n\r\n  if (error) {\r\n    return (\r\n      <Dialog open={true} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-md\">\r\n          <DialogTitle>PDF Viewer Error</DialogTitle>\r\n          <DialogDescription>\r\n            <div className=\"flex items-center justify-center p-8\">\r\n              <div className=\"text-center space-y-4\">\r\n                <AlertTriangle className=\"h-12 w-12 text-destructive mx-auto\" />\r\n                <div className=\"text-destructive\">{error}</div>\r\n                <div className=\"text-xs text-muted-foreground space-y-1\">\r\n                  <div>File: {fileName}</div>\r\n                  <div className=\"break-all\">URL: {fileUrl.substring(0, 50)}...</div>\r\n                </div>\r\n                <div className=\"space-x-2\">\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={handleRetry}>\r\n                    <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                    Retry\r\n                  </Button>\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={onClose}>\r\n                    <X className=\"h-4 w-4 mr-2\" />\r\n                    Close\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </DialogDescription>\r\n        </DialogContent>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Dialog open={true} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-full max-h-full w-screen h-screen p-0\">\r\n        <DialogTitle className=\"sr-only\">PDF Viewer: {fileName}</DialogTitle>\r\n        <DialogDescription className=\"sr-only\">\r\n          PDF viewer for {fileName}. Use arrow keys to navigate pages.\r\n        </DialogDescription>\r\n        \r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Header */}\r\n          <div className=\"flex-shrink-0 p-4 border-b bg-background\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex-1 min-w-0\">\r\n                <h2 className=\"text-lg font-semibold truncate\">{fileName}</h2>\r\n                {!isLoading && numPages > 0 && (\r\n                  <div className=\"mt-2 space-y-1\">\r\n                    <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n                      <span>Page {pageNumber} of {numPages}</span>\r\n                      <span>{progressPercentage.toFixed(1)}% complete</span>\r\n                    </div>\r\n                    <Progress value={progressPercentage} className=\"h-1.5 bg-muted\" />\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-2 ml-4\">\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={zoomOut} disabled={scale <= 0.5}>\r\n                  <ZoomOut className=\"h-4 w-4\" />\r\n                </Button>\r\n                <span className=\"text-sm px-2\">{Math.round(scale * 100)}%</span>\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={zoomIn} disabled={scale >= 2.0}>\r\n                  <ZoomIn className=\"h-4 w-4\" />\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\r\n                  <X className=\"h-4 w-4\" />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* PDF Content */}\r\n          <div className=\"flex-1 overflow-auto bg-gray-100 flex items-center justify-center p-4\">\r\n            <div className=\"bg-white shadow-lg\">\r\n              <Document\r\n                file={fileUrl}\r\n                onLoadSuccess={onDocumentLoadSuccess}\r\n                onLoadError={onDocumentLoadError}\r\n                loading={\r\n                  <div className=\"flex items-center justify-center p-8\">\r\n                    <div className=\"text-center space-y-4\">\r\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"text-sm text-muted-foreground\">Loading PDF...</div>\r\n                        <div className=\"text-xs text-muted-foreground\">{fileName}</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                }\r\n                options={pdfOptions}\r\n              >\r\n                {numPages > 0 && (\r\n                  <Page\r\n                    pageNumber={pageNumber}\r\n                    scale={scale}\r\n                    loading={\r\n                      <div className=\"flex items-center justify-center h-96 w-64\">\r\n                        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary\"></div>\r\n                      </div>\r\n                    }\r\n                  />\r\n                )}\r\n              </Document>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Footer Navigation */}\r\n          {!isLoading && numPages > 0 && (\r\n            <div className=\"flex-shrink-0 p-4 border-t bg-background\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Button variant=\"outline\" onClick={onClose} className=\"flex items-center gap-2\">\r\n                  <Home className=\"h-4 w-4\" />\r\n                  <span className=\"hidden sm:inline\">Back to Library</span>\r\n                </Button>\r\n                \r\n                <div className=\"flex items-center gap-2\">\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    onClick={goToPrevPage} \r\n                    disabled={pageNumber <= 1}\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    <ChevronLeft className=\"h-4 w-4\" />\r\n                    <span className=\"hidden sm:inline\">Previous</span>\r\n                  </Button>\r\n                  \r\n                  <div className=\"hidden md:flex items-center gap-2 px-3 py-1 bg-muted rounded text-sm text-muted-foreground\">\r\n                    Page {pageNumber} of {numPages}\r\n                  </div>\r\n                  \r\n                  <Button \r\n                    variant=\"outline\" \r\n                    onClick={goToNextPage} \r\n                    disabled={pageNumber >= numPages}\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    <span className=\"hidden sm:inline\">Next</span>\r\n                    <ChevronRight className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"mt-2 text-center text-xs text-muted-foreground\">\r\n                Use arrow keys to navigate â€¢ Press ESC to close\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default PDFViewer;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\PerformanceMetricsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\PublicDomainBooksList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\PublicDomainBooksSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\QuizButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\RecommendedBookListItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\RecommendedBooksSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\SearchControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\SimplifiedPDFViewer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\UnifiedLoadingProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\UserUploadItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\UserUploadsContent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\UserUploadsGridView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\UserUploadsListView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\UserUploadsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\VirtualizedBookList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[924,927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[924,927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { PublicDomainBook } from '@/types/publicDomainBooks';\r\nimport { searchIndexService } from '@/services/SearchIndexService';\r\nimport SearchControls from './SearchControls';\r\nimport BookListDisplay from './BookListDisplay';\r\n\r\ninterface SearchSuggestion {\r\n  term: string;\r\n  type: 'title' | 'author' | 'subject';\r\n  bookCount: number;\r\n  books: string[];\r\n}\r\n\r\ninterface VirtualizedBookListProps {\r\n  books: PublicDomainBook[];\r\n  onBookClick: (book: PublicDomainBook) => void;\r\n  isLoading: boolean;\r\n}\r\n\r\nconst VirtualizedBookList: React.FC<VirtualizedBookListProps> = ({\r\n  books,\r\n  onBookClick,\r\n  isLoading\r\n}) => {\r\n  const [query, setQuery] = useState('');\r\n  const [displayBooks, setDisplayBooks] = useState<PublicDomainBook[]>([]);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const [searchStats, setSearchStats] = useState<any>(null);\r\n\r\n  // Index books for instant search when books change\r\n  useEffect(() => {\r\n    if (books.length > 0) {\r\n      console.log(`ðŸ” Indexing ${books.length} books for instant search...`);\r\n      searchIndexService.indexBooks(books);\r\n      \r\n      // Update search stats\r\n      const stats = searchIndexService.getSearchStats();\r\n      setSearchStats(stats);\r\n      console.log('ðŸ“Š Search stats updated:', stats);\r\n      \r\n      // Show all books initially\r\n      setDisplayBooks(books);\r\n    }\r\n  }, [books]);\r\n\r\n  // Perform instant search when query changes\r\n  useEffect(() => {\r\n    const performSearch = async () => {\r\n      if (query.trim() && query.length >= 1) {\r\n        setIsSearching(true);\r\n        console.log(`ðŸ” Performing instant search for: \"${query}\"`);\r\n        \r\n        // Use a small delay to show the searching state\r\n        setTimeout(() => {\r\n          const results = searchIndexService.instantSearch(query);\r\n          console.log(`âœ… Found ${results.length} results for \"${query}\"`);\r\n          setDisplayBooks(results);\r\n          \r\n          // Record the search for analytics\r\n          searchIndexService.recordSearch(query);\r\n          setIsSearching(false);\r\n        }, 100);\r\n      } else {\r\n        console.log(`ðŸ“š Showing all ${books.length} books`);\r\n        setDisplayBooks(books);\r\n        setIsSearching(false);\r\n      }\r\n    };\r\n\r\n    performSearch();\r\n  }, [query, books]);\r\n\r\n  const handleSearch = useCallback((searchQuery: string) => {\r\n    console.log('ðŸ” Search executed:', searchQuery);\r\n    setQuery(searchQuery);\r\n  }, []);\r\n\r\n  const handleSuggestionSelect = useCallback((suggestion: SearchSuggestion) => {\r\n    console.log('ðŸ’¡ Suggestion selected:', suggestion);\r\n    setQuery(suggestion.term);\r\n  }, []);\r\n\r\n  const clearSearch = useCallback(() => {\r\n    console.log('ðŸ§¹ Clearing search');\r\n    setQuery('');\r\n  }, []);\r\n\r\n  if (isLoading && books.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <div className=\"inline-flex items-center gap-3\">\r\n          <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary\"></div>\r\n          <span className=\"text-muted-foreground\">Loading books with performance optimizations...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <SearchControls\r\n        query={query}\r\n        isSearching={isSearching}\r\n        searchStats={searchStats}\r\n        hasResults={displayBooks.length > 0}\r\n        resultsCount={displayBooks.length}\r\n        onSearch={handleSearch}\r\n        onSuggestionSelect={handleSuggestionSelect}\r\n        onClearSearch={clearSearch}\r\n      />\r\n\r\n      <BookListDisplay\r\n        books={displayBooks}\r\n        query={query}\r\n        isLoading={isLoading}\r\n        onBookClick={onBookClick}\r\n        onClearSearch={clearSearch}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VirtualizedBookList;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\epub\\EPUBProgressConverter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\epub\\EPUBReaderContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\epub\\EPUBReaderContent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\library\\epub\\EPUBReaderNavigation.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":56,"column":6,"nodeType":"ArrayExpression","endLine":56,"endColumn":86,"suggestions":[{"desc":"Update the dependencies array to be: [isLoading, error, isNavigating, onPrevPage, onNextPage, onClose, isInitialized, cleanup]","fix":{"range":[1520,1600],"text":"[isLoading, error, isNavigating, onPrevPage, onNextPage, onClose, isInitialized, cleanup]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cleanup' and 'readerRef'. Either include them or remove the dependency array.","line":114,"column":6,"nodeType":"ArrayExpression","endLine":114,"endColumn":77,"suggestions":[{"desc":"Update the dependencies array to be: [isLoading, error, isNavigating, onPrevPage, onNextPage, isInitialized, readerRef, cleanup]","fix":{"range":[3385,3456],"text":"[isLoading, error, isNavigating, onPrevPage, onNextPage, isInitialized, readerRef, cleanup]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useEffect } from 'react';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface EPUBReaderNavigationProps {\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  isNavigating: boolean;\r\n  isInitialized: boolean;\r\n  onPrevPage: () => void;\r\n  onNextPage: () => void;\r\n  onClose: () => void;\r\n  readerRef: React.RefObject<HTMLDivElement>;\r\n}\r\n\r\nexport const EPUBReaderNavigation: React.FC<EPUBReaderNavigationProps> = ({\r\n  isLoading,\r\n  error,\r\n  isNavigating,\r\n  isInitialized,\r\n  onPrevPage,\r\n  onNextPage,\r\n  onClose,\r\n  readerRef\r\n}) => {\r\n  const cleanup = useCleanup('EPUBReaderNavigation');\r\n  // Add keyboard navigation that doesn't interfere with scrolling\r\n  useEffect(() => {\r\n    if (isLoading || error || !isInitialized) return;\r\n\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      if (isNavigating) return;\r\n      \r\n      // Only handle navigation keys, not scroll-related keys\r\n      switch (event.key) {\r\n        case 'ArrowLeft':\r\n        case 'PageUp':\r\n          event.preventDefault();\r\n          onPrevPage();\r\n          break;\r\n        case 'ArrowRight':\r\n        case 'PageDown':\r\n          event.preventDefault();\r\n          onNextPage();\r\n          break;\r\n        case 'Escape':\r\n          event.preventDefault();\r\n          onClose();\r\n          break;\r\n        // Allow arrow up/down and space for scrolling within content\r\n        // Don't prevent these events\r\n      }\r\n    };\r\n\r\n    cleanup.addEventListener(document, 'keydown', handleKeyDown);\r\n  }, [isLoading, error, isNavigating, onPrevPage, onNextPage, onClose, isInitialized]);\r\n\r\n  // Add enhanced touch/swipe navigation that respects scrolling\r\n  useEffect(() => {\r\n    if (!readerRef.current || isLoading || error || !isInitialized) return;\r\n\r\n    let startX = 0;\r\n    let startY = 0;\r\n    let isScrolling = false;\r\n    \r\n    const handleTouchStart = (e: TouchEvent) => {\r\n      startX = e.touches[0].clientX;\r\n      startY = e.touches[0].clientY;\r\n      isScrolling = false;\r\n    };\r\n    \r\n    const handleTouchMove = (e: TouchEvent) => {\r\n      if (!startX || !startY) return;\r\n      \r\n      const currentX = e.touches[0].clientX;\r\n      const currentY = e.touches[0].clientY;\r\n      \r\n      const deltaX = Math.abs(startX - currentX);\r\n      const deltaY = Math.abs(startY - currentY);\r\n      \r\n      // Detect if user is scrolling vertically\r\n      if (deltaY > deltaX && deltaY > 10) {\r\n        isScrolling = true;\r\n      }\r\n    };\r\n    \r\n    const handleTouchEnd = (e: TouchEvent) => {\r\n      if (!startX || !startY || isNavigating || isScrolling) return;\r\n      \r\n      const endX = e.changedTouches[0].clientX;\r\n      const endY = e.changedTouches[0].clientY;\r\n      \r\n      const deltaX = startX - endX;\r\n      const deltaY = startY - endY;\r\n      \r\n      // Only trigger page navigation for horizontal swipes\r\n      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {\r\n        if (deltaX > 0) {\r\n          onNextPage();\r\n        } else {\r\n          onPrevPage();\r\n        }\r\n      }\r\n      \r\n      startX = 0;\r\n      startY = 0;\r\n      isScrolling = false;\r\n    };\r\n\r\n    const container = readerRef.current;\r\n    cleanup.addEventListener(container, 'touchstart', handleTouchStart);\r\n    cleanup.addEventListener(container, 'touchmove', handleTouchMove);\r\n    cleanup.addEventListener(container, 'touchend', handleTouchEnd);\r\n  }, [isLoading, error, isNavigating, onPrevPage, onNextPage, isInitialized]);\r\n\r\n  return null; // This component only handles navigation logic\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\linear-equations\\lessons\\LinearEquationsLesson1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\linear-equations\\lessons\\LinearEquationsLesson2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\linear-equations\\lessons\\LinearEquationsLesson3.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\linear-equations\\lessons\\LinearEquationsLesson4.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\linear-equations\\lessons\\LinearEquationsLesson5.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\linear-equations\\lessons\\LinearEquationsLesson6.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\linear-equations\\lessons\\LinearEquationsLesson7.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\live-hub\\LiveHubVideoModal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":37,"column":6,"nodeType":"ArrayExpression","endLine":37,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, isOpen, onClose]","fix":{"range":[997,1014],"text":"[cleanup, isOpen, onClose]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from 'react';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { HelpCircle } from 'lucide-react';\r\n\r\ninterface LiveHubVideoModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function LiveHubVideoModal({ isOpen, onClose }: LiveHubVideoModalProps) {\r\n  const cleanup = useCleanup('LiveHubVideoModal');\r\n  \r\n  // Handle ESC key press\r\n  useEffect(() => {\r\n    const handleEscapeKey = (event: KeyboardEvent) => {\r\n      if (event.key === 'Escape' && isOpen) {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      cleanup.addEventListener(document, 'keydown', handleEscapeKey);\r\n      // Prevent body scroll when modal is open\r\n      document.body.style.overflow = 'hidden';\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleEscapeKey);\r\n      document.body.style.overflow = 'unset';\r\n    };\r\n  }, [isOpen, onClose]);\r\n\r\n  const handleOverlayClick = (e: React.MouseEvent) => {\r\n    // Close modal when clicking on the overlay (outside the video)\r\n    if (e.target === e.currentTarget) {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const handleVideoClick = (e: React.MouseEvent) => {\r\n    // Prevent modal from closing when clicking on the video itself\r\n    e.stopPropagation();\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onClose}>\r\n      <DialogContent \r\n        className=\"max-w-[90vw] md:max-w-[70vw] p-0 bg-background/95 backdrop-blur-sm border-border\"\r\n        onClick={handleOverlayClick}\r\n      >\r\n        <DialogHeader className=\"p-6 pb-2\">\r\n          <DialogTitle className=\"flex items-center gap-2 text-xl font-semibold\">\r\n            <HelpCircle className=\"h-5 w-5 text-primary\" />\r\n            How to Use Live Learning Hub\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        <div className=\"px-6 pb-6\">\r\n          <div \r\n            className=\"relative w-full aspect-video bg-muted rounded-lg overflow-hidden\"\r\n            onClick={handleVideoClick}\r\n          >\r\n            <iframe \r\n              width=\"100%\" \r\n              height=\"100%\" \r\n              src=\"https://www.youtube.com/embed/SIskFst2jR8?si=78d5_8vUi1vb2-MR\" \r\n              title=\"YouTube video player\" \r\n              frameBorder=\"0\" \r\n              allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" \r\n              referrerPolicy=\"strict-origin-when-cross-origin\" \r\n              allowFullScreen\r\n              className=\"absolute inset-0 w-full h-full\"\r\n            />\r\n          </div>\r\n          \r\n          <p className=\"text-sm text-muted-foreground mt-4 text-center\">\r\n            Learn how to make the most of your Live Learning Hub features and interactive learning sessions.\r\n          </p>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\3d-shapes\\ThreeDShapesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\3d-shapes\\ThreeDShapesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\3d-shapes\\ThreeDShapesMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\ConceptScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\ExampleScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\MicroLessonContainer.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":61,"column":3,"nodeType":"Identifier","endLine":61,"endColumn":12}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport DOMPurify from 'isomorphic-dompurify';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { ChevronLeft, ChevronRight, Menu, Clock, Target, Trophy } from 'lucide-react';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\nexport interface MicroLessonScreen {\r\n  id: string;\r\n  type: 'concept' | 'practice' | 'example' | 'summary';\r\n  title: string;\r\n  content: React.ReactNode | string;\r\n  estimatedTime?: number; // in minutes\r\n}\r\n\r\nexport interface MicroLessonData {\r\n  id: string;\r\n  moduleTitle: string;\r\n  totalScreens: number;\r\n  screens: MicroLessonScreen[];\r\n}\r\n\r\ninterface MicroLessonContainerProps {\r\n  lessonData: MicroLessonData;\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n}\r\n\r\nexport const MicroLessonContainer: React.FC<MicroLessonContainerProps> = ({\r\n  lessonData,\r\n  onComplete,\r\n  onNext,\r\n  hasNext\r\n}) => {\r\n  const cleanup = useCleanup('micro-lesson-container');\r\n  const [currentScreenIndex, setCurrentScreenIndex] = useState(0);\r\n  const [startTime] = useState(Date.now());\r\n  const [timeSpent, setTimeSpent] = useState(0);\r\n  const [isCompleted, setIsCompleted] = useState(false);\r\n\r\n  const currentScreen = lessonData.screens[currentScreenIndex];\r\n  const progress = ((currentScreenIndex + 1) / lessonData.screens.length) * 100;\r\n\r\n  // Safety check - ensure currentScreen exists\r\n  if (!currentScreen) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto space-y-6\">\r\n        <Card className=\"bg-gradient-to-r from-red-50 to-orange-50 border-red-200\">\r\n          <CardContent className=\"p-6 text-center\">\r\n            <p className=\"text-red-700\">Unable to load course content. Please refresh the page.</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Update time spent every second using cleanupManager\r\n  useEffect(() => {\r\n    cleanup.setInterval(() => {\r\n      setTimeSpent(Math.floor((Date.now() - startTime) / 1000));\r\n    }, 1000);\r\n  }, [startTime, cleanup]);\r\n\r\n  const handleNext = () => {\r\n    if (currentScreenIndex < lessonData.screens.length - 1) {\r\n      setCurrentScreenIndex(currentScreenIndex + 1);\r\n    } else if (!isCompleted) {\r\n      setIsCompleted(true);\r\n      onComplete?.();\r\n    }\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    if (currentScreenIndex > 0) {\r\n      setCurrentScreenIndex(currentScreenIndex - 1);\r\n    }\r\n  };\r\n\r\n  const handleScreenJump = (screenIndex: number) => {\r\n    setCurrentScreenIndex(screenIndex);\r\n  };\r\n\r\n  const formatTime = (seconds: number) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  const getScreenIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'concept': return 'ðŸ“š';\r\n      case 'practice': return 'âœï¸';\r\n      case 'example': return 'ðŸ’¡';\r\n      case 'summary': return 'ðŸ“‹';\r\n      default: return 'ðŸ“';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Header with Progress */}\r\n      <Card className=\"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200\">\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <CardTitle className=\"text-xl text-blue-800 flex items-center gap-2\">\r\n              <Target className=\"h-5 w-5\" />\r\n              {lessonData.moduleTitle}\r\n            </CardTitle>\r\n            <div className=\"flex items-center gap-3 text-sm text-white\">\r\n              <div className=\"flex items-center gap-1\">\r\n                <Clock className=\"h-4 w-4\" />\r\n                {formatTime(timeSpent)}\r\n              </div>\r\n              <div className=\"text-sm\">\r\n                Screen {currentScreenIndex + 1} of {lessonData.screens.length}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <Progress value={progress} className=\"h-2\" />\r\n          <div className=\"flex items-center justify-between text-sm text-white mt-2\">\r\n            <span>{Math.round(progress)}% Complete</span>\r\n            {currentScreen.estimatedTime && (\r\n              <span>Est. {currentScreen.estimatedTime} min</span>\r\n            )}\r\n          </div>\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      {/* Main Content Screen */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-2xl\">{getScreenIcon(currentScreen.type)}</span>\r\n            <CardTitle className=\"text-xl\">{currentScreen.title}</CardTitle>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {typeof currentScreen.content === 'string' ? (\r\n            <div dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(currentScreen.content) }} />\r\n          ) : (\r\n            currentScreen.content\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Navigation */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handlePrevious}\r\n              disabled={currentScreenIndex === 0}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <ChevronLeft className=\"h-4 w-4\" />\r\n              Previous\r\n            </Button>\r\n\r\n            {/* Screen Navigation Menu */}\r\n            <div className=\"flex gap-1 max-w-md overflow-x-auto\">\r\n              {lessonData.screens.map((screen, index) => (\r\n                <Button\r\n                  key={screen.id}\r\n                  variant={index === currentScreenIndex ? \"default\" : \"ghost\"}\r\n                  size=\"sm\"\r\n                  onClick={() => handleScreenJump(index)}\r\n                  className=\"min-w-[40px] h-8 text-xs\"\r\n                  title={screen.title}\r\n                >\r\n                  {index + 1}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n\r\n            {currentScreenIndex < lessonData.screens.length - 1 ? (\r\n              <Button\r\n                onClick={handleNext}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                Next\r\n                <ChevronRight className=\"h-4 w-4\" />\r\n              </Button>\r\n            ) : (\r\n              <Button\r\n                onClick={handleNext}\r\n                disabled={isCompleted}\r\n                className=\"flex items-center gap-2\"\r\n                variant={isCompleted ? \"outline\" : \"default\"}\r\n              >\r\n                {isCompleted ? \"Completed\" : \"Complete Lesson\"}\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Completion Message with Celebration */}\r\n      {isCompleted && (\r\n        <Card className=\"border-green-200 bg-gradient-to-r from-green-50 to-emerald-50\">\r\n          <CardContent className=\"p-8 text-center\">\r\n            <div className=\"space-y-6\">\r\n              <div className=\"animate-bounce\">\r\n                <Trophy className=\"h-16 w-16 text-yellow-500 mx-auto\" />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <h3 className=\"text-2xl font-bold text-green-700\">ðŸŽ‰ Lesson Completed! ðŸŽ‰</h3>\r\n                <p className=\"text-green-600 font-medium\">\r\n                  <strong>Amazing work!</strong> You've mastered all the concepts in this lesson.\r\n                </p>\r\n                <p className=\"text-sm text-green-600\">\r\n                  Total time: {formatTime(timeSpent)}\r\n                </p>\r\n              </div>\r\n              {hasNext && onNext && (\r\n                <Button \r\n                  onClick={onNext} \r\n                  size=\"lg\" \r\n                  className=\"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-lg transform hover:scale-105 transition-all duration-200\"\r\n                >\r\n                  Continue to Next Lesson\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\PracticeScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\algebra\\AlgebraApplicationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\algebra\\AlgebraIntroductionMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\algebra\\AlgebraLinearGraphingMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\algebra\\AlgebraQuadraticsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\algebra\\AlgebraSimpleEquationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\algebra\\AlgebraSystemsEquationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\algebra\\AlgebraVariablesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\circles\\CirclesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\circles\\CirclesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\circles\\CirclesMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\coordinate-geometry\\CoordinateGeometryMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\coordinate-geometry\\CoordinateGeometryMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\coordinate-geometry\\CoordinateGeometryMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsFiscalPolicyMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsGrowthDevelopmentMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsIndicatorsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsInternationalTradeMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsIntroductionMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsMarketStructuresMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsMonetaryPolicyMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\economics\\EconomicsSupplyDemandMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\advanced-modules\\AdvancedExecutiveFunctioningMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\advanced-modules\\AdvancedExecutiveFunctioningMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\advanced-modules\\AdvancedStudyTechniquesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\advanced-modules\\AdvancedStudyTechniquesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\assessments\\SelfAssessmentMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\assessments\\SelfAssessmentMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\case-studies\\CaseStudiesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\case-studies\\CaseStudiesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\enhanced-assessments\\EnhancedAssessmentsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\enhanced-assessments\\EnhancedAssessmentsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\executive-functioning\\ExecutiveFunctioningMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\executive-functioning\\ExecutiveFunctioningMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\expanded-worksheets\\ExpandedWorksheetsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\expanded-worksheets\\ExpandedWorksheetsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\instructor-dashboard\\InstructorDashboardMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\instructor-dashboard\\InstructorDashboardMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\instructor-resources\\InstructorResourcesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\instructor-resources\\InstructorResourcesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\interactive-worksheets\\InteractiveWorksheetsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\interactive-worksheets\\InteractiveWorksheetsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\real-world-application\\RealWorldApplicationMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\real-world-application\\RealWorldApplicationMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\strengths-advocacy\\StrengthsAdvocacyMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\strengths-advocacy\\StrengthsAdvocacyMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\strengths-self-advocacy\\StrengthsSelfAdvocacyMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\strengths-self-advocacy\\StrengthsSelfAdvocacyMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\study-techniques\\StudyTechniquesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\study-techniques\\StudyTechniquesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\understanding-neurodiversity\\UnderstandingNeurodiversityMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\elt\\understanding-neurodiversity\\UnderstandingNeurodiversityMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\linear-equations\\GraphingLinearEquationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\linear-equations\\LinearEquationsIntroductionMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\linear-equations\\LinearEquationsMasteryMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\linear-equations\\MultiStepEquationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\linear-equations\\SOAPMethodMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\linear-equations\\SpecialCasesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\linear-equations\\WordProblemsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicArgumentsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicComplexMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicDeductiveMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicEvaluationMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicFormsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicIdentificationMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicInductiveMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicIntroductionMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\logic\\LogicTestingMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\BankingAccountsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\BudgetingMasteryMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\CreditDebtPlanningMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\FinancialFoundationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\InvestingBasicsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\MoneyManagementGameMicroLesson.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1084,1087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1084,1087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2189,2192],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2189,2192],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":506,"column":5,"nodeType":"Identifier","endLine":506,"endColumn":14}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useReducer, useEffect, useRef } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { \r\n  DollarSign, \r\n  TrendingUp, \r\n  TrendingDown, \r\n  PiggyBank, \r\n  CreditCard, \r\n  Target,\r\n  AlertCircle,\r\n  Trophy,\r\n  Clock,\r\n  BookOpen,\r\n  Calculator,\r\n  BarChart3,\r\n  Receipt,\r\n  Minus,\r\n  Plus,\r\n  CheckCircle,\r\n  XCircle,\r\n  ArrowRight,\r\n  Lightbulb,\r\n  TrendingDown as TrendDown,\r\n  TrendingUp as TrendUp\r\n} from 'lucide-react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { gameReducer, initialState } from './game-state';\r\nimport { ALL_SCENARIOS } from './game-data';\r\n\r\ninterface GameProps {\r\n  onComplete?: () => void;\r\n  onNext?: () => void;\r\n  hasNext?: boolean;\r\n  isCompleted?: boolean;\r\n  trackInteraction?: (event: string, details: any) => void;\r\n  lessonId?: number;\r\n  lessonTitle?: string;\r\n}\r\n\r\nconst MoneyManagementGame: React.FC<GameProps> = ({\r\n  onComplete,\r\n  onNext,\r\n  hasNext = false,\r\n  isCompleted = false,\r\n  trackInteraction,\r\n  lessonId,\r\n  lessonTitle\r\n}) => {\r\n  const [state, dispatch] = useReducer(gameReducer, initialState);\r\n  const [showWelcome, setShowWelcome] = useState(true);\r\n  const [dragAmount, setDragAmount] = useState(10);\r\n  const [ccPaymentAmount, setCcPaymentAmount] = useState('');\r\n  const [debtPaymentAmount, setDebtPaymentAmount] = useState('');\r\n  const [outcomeDelayComplete, setOutcomeDelayComplete] = useState(false);\r\n\r\n  const {\r\n    phase,\r\n    week,\r\n    balance,\r\n    savingsGoal,\r\n    creditScore,\r\n    envelopes,\r\n    monthlyIncome,\r\n    currentSavings,\r\n    currentEmergencyFund,\r\n    score,\r\n    isGameOver,\r\n    currentScenario,\r\n    feedbackMessage,\r\n    month,\r\n    currentDebt,\r\n    creditCardBalance,\r\n    creditCardLimit,\r\n    creditCardInterestRate,\r\n    debtInterestRate\r\n  } = state;\r\n\r\n  // Track game interactions\r\n  const trackGameInteraction = (action: string, details: any = {}) => {\r\n    trackInteraction?.(action, {\r\n      lessonId,\r\n      lessonTitle: \"Financial Decision-Making Game\",\r\n      gamePhase: phase,\r\n      week,\r\n      month,\r\n      ...details\r\n    });\r\n  };\r\n\r\n  // Welcome Screen Component\r\n  const WelcomeScreen = () => (\r\n    <div className=\"max-w-2xl mx-auto text-center space-y-6 p-8\">\r\n      <div className=\"flex justify-center items-center gap-3 mb-6\">\r\n        <DollarSign className=\"w-16 h-16 text-primary\" />\r\n        <Trophy className=\"w-16 h-16 text-yellow-500\" />\r\n        <TrendingUp className=\"w-16 h-16 text-green-500\" />\r\n      </div>\r\n      \r\n      <h1 className=\"text-4xl font-bold text-foreground\">\r\n        Money Management Game\r\n      </h1>\r\n      \r\n      <p className=\"text-xl text-muted-foreground leading-relaxed\">\r\n        Put your financial knowledge to the test! Make real-world money decisions, \r\n        manage your budget, and see how your choices impact your financial future.\r\n      </p>\r\n\r\n      <div className=\"bg-card/50 backdrop-blur-sm p-6 rounded-lg border\">\r\n        <h3 className=\"text-lg font-semibold mb-4 text-foreground\">Game Overview</h3>\r\n        <ul className=\"text-left space-y-2 text-muted-foreground\">\r\n          <li className=\"flex items-start gap-2\">\r\n            <Target className=\"w-5 h-5 text-primary mt-0.5 flex-shrink-0\" />\r\n            <span>Set your monthly budget and financial goals</span>\r\n          </li>\r\n          <li className=\"flex items-start gap-2\">\r\n            <BookOpen className=\"w-5 h-5 text-primary mt-0.5 flex-shrink-0\" />\r\n            <span>Make smart decisions in real-world scenarios</span>\r\n          </li>\r\n          <li className=\"flex items-start gap-2\">\r\n            <PiggyBank className=\"w-5 h-5 text-primary mt-0.5 flex-shrink-0\" />\r\n            <span>Build savings and manage debt wisely</span>\r\n          </li>\r\n          <li className=\"flex items-start gap-2\">\r\n            <Trophy className=\"w-5 h-5 text-primary mt-0.5 flex-shrink-0\" />\r\n            <span>Achieve financial stability and reach your goals</span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n\r\n      <Button \r\n        size=\"lg\" \r\n        onClick={() => {\r\n          setShowWelcome(false);\r\n          trackGameInteraction('game_started');\r\n        }}\r\n        className=\"bg-primary hover:bg-primary/90 text-primary-foreground font-semibold py-3 px-8\"\r\n      >\r\n        Start Your Financial Journey\r\n      </Button>\r\n    </div>\r\n  );\r\n\r\n  const BudgetPlanningScreen = () => {\r\n    const remainingBudget = monthlyIncome - Object.values(envelopes).reduce((sum, val) => sum + val, 0) - (state.creditCardPayment || 0);\r\n    const weeklyBudgets = Object.entries(envelopes).reduce((acc, [category, amount]) => {\r\n      acc[category] = (amount / 4).toFixed(2); // Weekly allocation\r\n      return acc;\r\n    }, {} as Record<string, string>);\r\n\r\n    const BudgetControls = ({ category, amount }: { category: string; amount: number }) => {\r\n      const increments = [1, 10, 25, 50];\r\n      \r\n      return (\r\n        <div className=\"bg-muted rounded-lg p-4 space-y-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <span className=\"font-medium\">{category}</span>\r\n            <div className=\"text-lg font-bold text-primary\">\r\n              ${amount.toFixed(2)}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"text-sm text-muted-foreground\">\r\n            Weekly: ${category === 'Credit Card Payment' ? (amount / 4).toFixed(2) : weeklyBudgets[category]}\r\n          </div>\r\n          \r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {/* Subtract buttons */}\r\n            <div className=\"flex gap-1\">\r\n              {increments.map(inc => (\r\n                <Button\r\n                  key={`sub-${inc}`}\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  onClick={() => {\r\n                    if (amount >= inc) {\r\n                      if (category === 'Credit Card Payment') {\r\n                        dispatch({ type: 'ALLOCATE_BUDGET', category, amount: amount - inc });\r\n                      } else {\r\n                        dispatch({ type: 'ALLOCATE_BUDGET', category, amount: amount - inc });\r\n                      }\r\n                    }\r\n                  }}\r\n                  disabled={amount < inc}\r\n                  className=\"text-xs px-2\"\r\n                >\r\n                  -${inc}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n            \r\n            <div className=\"w-px bg-border\"></div>\r\n            \r\n            {/* Add buttons */}\r\n            <div className=\"flex gap-1\">\r\n              {increments.map(inc => (\r\n                <Button\r\n                  key={`add-${inc}`}\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  onClick={() => {\r\n                    if (remainingBudget >= inc) {\r\n                      if (category === 'Credit Card Payment') {\r\n                        dispatch({ type: 'ALLOCATE_BUDGET', category, amount: amount + inc });\r\n                      } else {\r\n                        dispatch({ type: 'ALLOCATE_BUDGET', category, amount: amount + inc });\r\n                      }\r\n                    }\r\n                  }}\r\n                  disabled={remainingBudget < inc}\r\n                  className=\"text-xs px-2\"\r\n                >\r\n                  +${inc}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    };\r\n\r\n    return (\r\n      <div className=\"max-w-5xl mx-auto space-y-6\">\r\n        <Card className=\"bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2 text-2xl\">\r\n              <Target className=\"w-6 h-6\" />\r\n              Plan Your Monthly Budget - Week {week}\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-6\">\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n              {/* Income and Goals */}\r\n              <div className=\"space-y-4\">\r\n                <div className=\"bg-card p-4 rounded-lg border\">\r\n                  <h3 className=\"font-semibold mb-2\">Monthly Income</h3>\r\n                  <div className=\"text-2xl font-bold text-green-600\">\r\n                    ${monthlyIncome.toFixed(2)}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground mt-1\">\r\n                    Weekly: ${(monthlyIncome / 4).toFixed(2)}\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"bg-card p-4 rounded-lg border\">\r\n                  <h3 className=\"font-semibold mb-2\">Savings Goal</h3>\r\n                  <div className=\"text-2xl font-bold text-primary\">\r\n                    ${savingsGoal.toFixed(2)}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground mt-1\">\r\n                    Weekly: ${(savingsGoal / 4).toFixed(2)}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"bg-card p-4 rounded-lg border\">\r\n                  <h3 className=\"font-semibold mb-2\">Remaining Budget</h3>\r\n                  <div className={`text-2xl font-bold ${remainingBudget === 0 ? 'text-green-600' : remainingBudget > 0 ? 'text-blue-600' : 'text-red-600'}`}>\r\n                    ${remainingBudget.toFixed(2)}\r\n                  </div>\r\n                  {remainingBudget !== 0 && (\r\n                    <div className=\"text-sm text-yellow-600 mt-1 flex items-center gap-1\">\r\n                      <AlertCircle className=\"w-3 h-3\" />\r\n                      Must be $0.00 to continue\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Budget Allocation */}\r\n              <div className=\"lg:col-span-2 space-y-4\">\r\n                <h3 className=\"text-lg font-semibold\">Allocate Your Budget</h3>\r\n                <div className=\"text-sm text-muted-foreground mb-4\">\r\n                  Use the increment buttons to precisely allocate your budget. Weekly amounts show how much you'll have each week.\r\n                </div>\r\n                \r\n                {Object.entries(envelopes).map(([category, amount]) => (\r\n                  <BudgetControls key={category} category={category} amount={amount} />\r\n                ))}\r\n                \r\n                {/* Credit Card Payment Option */}\r\n                {creditCardBalance > 0 && (\r\n                  <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n                    <h4 className=\"font-semibold text-red-800 mb-2 flex items-center gap-2\">\r\n                      <CreditCard className=\"w-4 h-4\" />\r\n                      Credit Card Payment\r\n                    </h4>\r\n                    <div className=\"text-sm text-red-600 mb-3\">\r\n                      Current Balance: ${creditCardBalance.toFixed(2)} \r\n                      <span className=\"block text-xs\">\r\n                        Monthly Interest: ${(creditCardBalance * (creditCardInterestRate / 12)).toFixed(2)}\r\n                        {' '}({(creditCardInterestRate * 100).toFixed(1)}% APR)\r\n                      </span>\r\n                    </div>\r\n                    <BudgetControls category=\"Credit Card Payment\" amount={state.creditCardPayment || 0} />\r\n                    <div className=\"text-xs text-red-500 mt-2\">\r\n                      ðŸ’¡ Tip: Paying more toward credit cards reduces interest charges and improves your credit score!\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                {/* Add credit card option even if no debt, for education */}\r\n                {creditCardBalance === 0 && (\r\n                  <div className=\"bg-green-50 border border-green-200 rounded-lg p-3\">\r\n                    <div className=\"text-sm text-green-700 flex items-center gap-2\">\r\n                      <CheckCircle className=\"w-4 h-4\" />\r\n                      Great! You have no credit card debt. Keep it that way by spending wisely!\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Weekly Budget Summary */}\r\n            <Card className=\"bg-muted/30\">\r\n              <CardHeader className=\"pb-3\">\r\n                <CardTitle className=\"text-lg\">Weekly Budget Summary</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                  {Object.entries(envelopes).map(([category, amount]) => (\r\n                    <div key={category} className=\"text-center\">\r\n                      <div className=\"text-sm font-medium text-muted-foreground\">{category}</div>\r\n                      <div className=\"text-lg font-bold\">${(amount / 4).toFixed(2)}</div>\r\n                      <div className=\"text-xs text-muted-foreground\">per week</div>\r\n                    </div>\r\n                  ))}\r\n                  {/* Add Credit Card Payment to summary if allocated */}\r\n                  {state.creditCardPayment > 0 && (\r\n                    <div className=\"text-center\">\r\n                      <div className=\"text-sm font-medium text-muted-foreground\">Credit Card Payment</div>\r\n                      <div className=\"text-lg font-bold text-red-600\">${(state.creditCardPayment / 4).toFixed(2)}</div>\r\n                      <div className=\"text-xs text-muted-foreground\">per week</div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                \r\n                {/* Show total allocated */}\r\n                <div className=\"mt-4 pt-3 border-t border-border\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"font-medium\">Total Weekly Allocation:</span>\r\n                    <span className=\"text-lg font-bold\">\r\n                      ${((Object.values(envelopes).reduce((sum, val) => sum + val, 0) + (state.creditCardPayment || 0)) / 4).toFixed(2)}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"text-xs text-muted-foreground mt-1\">\r\n                    From ${monthlyIncome.toFixed(2)} monthly income\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Button \r\n              size=\"lg\" \r\n              onClick={() => {\r\n                dispatch({ type: 'START_SCENARIOS' });\r\n                trackGameInteraction('budget_planned', { envelopes, week });\r\n              }}\r\n              disabled={remainingBudget !== 0}\r\n              className=\"w-full\"\r\n            >\r\n              Start Week {week} Scenarios\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Scenario Screen\r\n  const ScenarioScreen = () => {\r\n    if (!currentScenario) return null;\r\n\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto space-y-6\">\r\n        {/* Progress Header */}\r\n        <Card className=\"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200\">\r\n          <CardHeader className=\"pb-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <CardTitle className=\"text-xl\">\r\n                Week {week} - Scenario {state.scenarioIndex + 1} of {state.weeklyScenarios?.length || 5}\r\n              </CardTitle>\r\n              <Badge variant=\"secondary\">\r\n                Score: {score}\r\n              </Badge>\r\n            </div>\r\n            <Progress \r\n              value={((state.scenarioIndex + 1) / (state.weeklyScenarios?.length || 5)) * 100} \r\n              className=\"h-2\" \r\n            />\r\n          </CardHeader>\r\n        </Card>\r\n\r\n        {/* Current Balance Display */}\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4 text-center\">\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Balance</div>\r\n                <div className=\"text-xl font-bold\">${balance.toFixed(2)}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Savings</div>\r\n                <div className=\"text-xl font-bold text-green-600\">${currentSavings.toFixed(2)}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Emergency</div>\r\n                <div className=\"text-xl font-bold text-blue-600\">${currentEmergencyFund.toFixed(2)}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Credit Score</div>\r\n                <div className=\"text-xl font-bold\">{creditScore}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-muted-foreground\">Credit Card Debt</div>\r\n                <div className={`text-xl font-bold ${creditCardBalance > 0 ? 'text-red-600' : 'text-green-600'}`}>\r\n                  ${creditCardBalance.toFixed(2)}\r\n                </div>\r\n                {creditCardBalance > 0 && (\r\n                  <div className=\"text-xs text-red-500\">\r\n                    ${(creditCardBalance * (creditCardInterestRate / 12)).toFixed(2)}/mo interest\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Debt Warning */}\r\n            {(creditCardBalance > 0 || currentDebt > 0) && (\r\n              <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n                <div className=\"flex items-center gap-2 text-red-700\">\r\n                  <AlertCircle className=\"w-4 h-4\" />\r\n                  <span className=\"font-semibold\">Debt Alert</span>\r\n                </div>\r\n                <div className=\"text-sm text-red-600 mt-1\">\r\n                  Total Debt: ${(creditCardBalance + currentDebt).toFixed(2)}\r\n                  {creditCardBalance > 0 && (\r\n                    <div>Credit Card APR: {(creditCardInterestRate * 100).toFixed(1)}% - Monthly Interest: ${(creditCardBalance * (creditCardInterestRate / 12)).toFixed(2)}</div>\r\n                  )}\r\n                  {currentDebt > 0 && (\r\n                    <div>Other Debt APR: {(debtInterestRate * 100).toFixed(1)}% - Monthly Interest: ${(currentDebt * (debtInterestRate / 12)).toFixed(2)}</div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Scenario Card */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-xl\">{currentScenario.title}</CardTitle>\r\n            <Badge variant=\"outline\" className=\"w-fit\">\r\n              {currentScenario.category}\r\n            </Badge>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-muted-foreground mb-6\">{currentScenario.description}</p>\r\n            \r\n            <div className=\"space-y-3\">\r\n              {currentScenario.options.map((option, index) => (\r\n                <Button\r\n                  key={index}\r\n                  variant=\"outline\"\r\n                  size=\"lg\"\r\n                  className=\"w-full justify-start text-left p-4 h-auto border-input bg-background hover:bg-muted hover:text-foreground transition-colors duration-200\"\r\n                  onClick={() => {\r\n                    dispatch({ type: 'MAKE_CHOICE', option });\r\n                    trackGameInteraction('scenario_choice', {\r\n                      scenario: currentScenario.title,\r\n                      choice: option.text,\r\n                      impact: option.impact\r\n                    });\r\n                  }}\r\n                >\r\n                  <div>\r\n                    <div className=\"font-medium\">{option.text}</div>\r\n                    {option.impact && (\r\n                      <div className=\"text-sm text-muted-foreground mt-1\">\r\n                        Impact: {option.impact}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </Button>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Enhanced Scenario Outcome Summary Screen\r\n  const ScenarioOutcomeSummaryScreen = () => {\r\n    const { lastChoice } = state;\r\n    if (!lastChoice) return null;\r\n\r\n    const { scenario, option, balanceChange, creditChange, debtChange, scoreChange } = lastChoice;\r\n    \r\n    // Determine if this was a positive or negative choice based on score change\r\n    const isPositiveOutcome = scoreChange >= 0;\r\n    \r\n    // Reset delay when component mounts - REMOVED TIMER\r\n    useEffect(() => {\r\n      console.log('ðŸŽ¯ ScenarioOutcome mounted - no timer, buttons always active');\r\n    }, [lastChoice]);\r\n\r\n    // Parse financial impacts for detailed breakdown\r\n    const getFinancialImpacts = () => {\r\n      const impacts = [];\r\n      \r\n      if (balanceChange !== 0) {\r\n        impacts.push({\r\n          type: 'Balance',\r\n          amount: balanceChange,\r\n          icon: balanceChange > 0 ? TrendUp : TrendDown,\r\n          color: balanceChange > 0 ? 'text-green-600' : 'text-red-600'\r\n        });\r\n      }\r\n      \r\n      if (creditChange !== 0) {\r\n        impacts.push({\r\n          type: 'Credit Score',\r\n          amount: creditChange,\r\n          icon: creditChange > 0 ? TrendUp : TrendDown,\r\n          color: creditChange > 0 ? 'text-green-600' : 'text-red-600'\r\n        });\r\n      }\r\n      \r\n      if (debtChange !== 0) {\r\n        impacts.push({\r\n          type: 'Debt',\r\n          amount: debtChange,\r\n          icon: debtChange > 0 ? TrendDown : TrendUp, // More debt is bad, less debt is good\r\n          color: debtChange > 0 ? 'text-red-600' : 'text-green-600'\r\n        });\r\n      }\r\n      \r\n      return impacts;\r\n    };\r\n\r\n    const impacts = getFinancialImpacts();\r\n\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto space-y-6\">\r\n        {/* Header with Outcome Indicator */}\r\n        <Card className={`${isPositiveOutcome \r\n          ? 'bg-gradient-to-r from-green-50 to-emerald-50 border-green-200' \r\n          : 'bg-gradient-to-r from-orange-50 to-red-50 border-orange-200'\r\n        }`}>\r\n          <CardHeader className=\"text-center\">\r\n            <div className=\"flex justify-center mb-4\">\r\n              {isPositiveOutcome ? (\r\n                <CheckCircle className=\"w-16 h-16 text-green-600\" />\r\n              ) : (\r\n                <XCircle className=\"w-16 h-16 text-orange-600\" />\r\n              )}\r\n            </div>\r\n            <CardTitle className={`text-2xl ${isPositiveOutcome ? 'text-green-800' : 'text-orange-800'}`}>\r\n              {isPositiveOutcome ? 'Great Choice!' : 'Learning Opportunity'}\r\n            </CardTitle>\r\n          </CardHeader>\r\n        </Card>\r\n\r\n        {/* Scenario Context */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <BookOpen className=\"w-6 h-6\" />\r\n              What You Decided\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              <div className=\"bg-muted p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-lg mb-2\">{scenario.title}</h4>\r\n                <p className=\"text-muted-foreground mb-3\">{scenario.description}</p>\r\n                <div className=\"bg-card p-3 rounded border-l-4 border-primary\">\r\n                  <span className=\"font-medium\">Your Choice: </span>\r\n                  <span className=\"text-primary font-semibold\">{option.text}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Financial Impact Breakdown */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <BarChart3 className=\"w-6 h-6\" />\r\n              Financial Impact\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              {impacts.length === 0 ? (\r\n                <div className=\"col-span-3 text-center py-8 text-muted-foreground\">\r\n                  No immediate financial impact from this decision.\r\n                </div>\r\n              ) : (\r\n                impacts.map((impact, index) => (\r\n                  <div key={index} className=\"bg-muted p-4 rounded-lg text-center\">\r\n                    <div className=\"flex items-center justify-center gap-2 mb-2\">\r\n                      <impact.icon className={`w-6 h-6 ${impact.color}`} />\r\n                      <span className=\"font-medium\">{impact.type}</span>\r\n                    </div>\r\n                    <div className={`text-2xl font-bold ${impact.color}`}>\r\n                      {impact.type === 'Credit Score' ? \r\n                        `${impact.amount > 0 ? '+' : ''}${impact.amount} pts` :\r\n                        `${impact.amount > 0 ? '+' : ''}$${Math.abs(impact.amount).toFixed(2)}`\r\n                      }\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Educational \"Why\" Statement */}\r\n        <Card className=\"border-blue-200 bg-blue-50\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2 text-blue-800\">\r\n              <Lightbulb className=\"w-6 h-6\" />\r\n              Why This Matters\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"bg-white p-6 rounded-lg border border-blue-200\">\r\n              <p className=\"text-blue-900 leading-relaxed text-lg\">\r\n                {feedbackMessage}\r\n              </p>\r\n            </div>\r\n            \r\n            {/* Additional educational context based on choice type */}\r\n            {option.impact && option.impact.includes('creditCard') && (\r\n              <div className=\"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <CreditCard className=\"w-5 h-5 text-yellow-600 mt-0.5\" />\r\n                  <div>\r\n                    <h5 className=\"font-semibold text-yellow-800 mb-1\">Credit Card Education</h5>\r\n                    <p className=\"text-sm text-yellow-700\">\r\n                      Using credit cards isn't inherently bad, but it's important to pay off balances quickly. \r\n                      At 18% APR, carrying a balance costs you significantly over time.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Current Financial Status */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <DollarSign className=\"w-6 h-6\" />\r\n              Current Financial Status\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\r\n              <div className=\"bg-muted p-4 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-green-600\">${balance.toFixed(2)}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Balance</div>\r\n              </div>\r\n              <div className=\"bg-muted p-4 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-blue-600\">{score}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Score</div>\r\n              </div>\r\n              <div className=\"bg-muted p-4 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-purple-600\">{creditScore}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Credit Score</div>\r\n              </div>\r\n              <div className=\"bg-muted p-4 rounded-lg\">\r\n                <div className={`text-2xl font-bold ${(currentDebt + creditCardBalance) > 0 ? 'text-red-600' : 'text-green-600'}`}>\r\n                  ${(currentDebt + creditCardBalance).toFixed(2)}\r\n                </div>\r\n                <div className=\"text-sm text-muted-foreground\">Total Debt</div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Navigation Buttons */}\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between gap-4\">\r\n              {/* Previous Scenario Button */}\r\n              <Button \r\n                size=\"lg\" \r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  if (state.scenarioIndex > 0) {\r\n                    // Go back to previous scenario\r\n                    const prevIndex = state.scenarioIndex - 1;\r\n                    dispatch({ \r\n                      type: 'GO_TO_SCENARIO', \r\n                      payload: { \r\n                        scenarioIndex: prevIndex,\r\n                        scenario: state.weeklyScenarios[prevIndex]\r\n                      }\r\n                    });\r\n                  }\r\n                }}\r\n                disabled={state.scenarioIndex === 0}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ArrowRight className=\"w-4 h-4 rotate-180\" />\r\n                Previous Scenario\r\n              </Button>\r\n\r\n              {/* Next Scenario Button */}\r\n              <Button \r\n                size=\"lg\" \r\n                onClick={() => {\r\n                  console.log('ðŸŽ¯ Continue button clicked!');\r\n                  dispatch({ type: 'CONTINUE_FROM_OUTCOME' });\r\n                  trackGameInteraction('scenario_outcome_completed', {\r\n                    scenario: scenario.title,\r\n                    choice: option.text,\r\n                    outcome: isPositiveOutcome ? 'positive' : 'negative'\r\n                  });\r\n                }}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                Continue to Next Scenario\r\n                <ArrowRight className=\"w-4 h-4\" />\r\n              </Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Enhanced Weekly Summary Screen with comprehensive features\r\n  const WeeklySummaryScreen = () => {\r\n    // Calculate weekly analytics\r\n    const weeklyIncome = state.weekLog\r\n      .filter(entry => entry.amount > 0)\r\n      .reduce((sum, entry) => sum + entry.amount, 0);\r\n    \r\n    const discretionarySpending = state.weekLog\r\n      .filter(entry => entry.amount < 0 && (entry.type === 'Scenario' || entry.category === 'wants'))\r\n      .reduce((sum, entry) => sum + Math.abs(entry.amount), 0);\r\n    \r\n    const weeklyNetChange = state.weekLog\r\n      .reduce((sum, entry) => sum + (entry.amount || 0), 0);\r\n\r\n    // Debt calculator functions\r\n    const calculatePayoffTime = (balance: number, payment: number, apr: number) => {\r\n      if (payment <= 0 || balance <= 0) return { months: 0, totalInterest: 0 };\r\n      const monthlyRate = apr / 12;\r\n      const months = Math.ceil(-Math.log(1 - (balance * monthlyRate) / payment) / Math.log(1 + monthlyRate));\r\n      const totalPaid = payment * months;\r\n      const totalInterest = totalPaid - balance;\r\n      return { months, totalInterest };\r\n    };\r\n\r\n    const handleDebtPayment = (type: 'credit' | 'debt', amount: number) => {\r\n      if (amount <= 0 || amount > balance) return;\r\n      \r\n      dispatch({ \r\n        type: 'PAY_DEBT', \r\n        debtType: type, \r\n        amount: amount \r\n      });\r\n      \r\n      trackGameInteraction('debt_payment', {\r\n        type,\r\n        amount,\r\n        week,\r\n        remainingBalance: balance - amount\r\n      });\r\n    };\r\n\r\n    return (\r\n      <div className=\"max-w-6xl mx-auto space-y-6\">\r\n        {/* Header */}\r\n        <Card className=\"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200\">\r\n          <CardHeader>\r\n            <CardTitle className=\"text-2xl flex items-center gap-2\">\r\n              <BarChart3 className=\"w-6 h-6 text-green-600\" />\r\n              End-of-Week Recap - Week {week}\r\n            </CardTitle>\r\n          </CardHeader>\r\n        </Card>\r\n\r\n        {/* Weekly Analytics Tiles */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n          <Card className=\"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200\">\r\n            <CardContent className=\"pt-6\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <TrendingUp className=\"w-8 h-8 text-blue-600\" />\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-blue-700\">${weeklyIncome.toFixed(2)}</div>\r\n                  <div className=\"text-sm text-blue-600\">Weekly Income</div>\r\n                </div>\r\n              </div>\r\n              <p className=\"text-xs text-blue-500 mt-2\">\r\n                Extra income from side hustles and opportunities\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200\">\r\n            <CardContent className=\"pt-6\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <Receipt className=\"w-8 h-8 text-orange-600\" />\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-orange-700\">${discretionarySpending.toFixed(2)}</div>\r\n                  <div className=\"text-sm text-orange-600\">Discretionary Spending</div>\r\n                </div>\r\n              </div>\r\n              <p className=\"text-xs text-orange-500 mt-2\">\r\n                Wants and unexpected costs from scenarios\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className={`bg-gradient-to-br ${weeklyNetChange >= 0 ? 'from-green-50 to-green-100 border-green-200' : 'from-red-50 to-red-100 border-red-200'}`}>\r\n            <CardContent className=\"pt-6\">\r\n              <div className=\"flex items-center gap-3\">\r\n                {weeklyNetChange >= 0 ? (\r\n                  <TrendingUp className=\"w-8 h-8 text-green-600\" />\r\n                ) : (\r\n                  <TrendingDown className=\"w-8 h-8 text-red-600\" />\r\n                )}\r\n                <div>\r\n                  <div className={`text-2xl font-bold ${weeklyNetChange >= 0 ? 'text-green-700' : 'text-red-700'}`}>\r\n                    {weeklyNetChange >= 0 ? '+' : ''}${weeklyNetChange.toFixed(2)}\r\n                  </div>\r\n                  <div className={`text-sm ${weeklyNetChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                    Weekly Net Change\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <p className={`text-xs mt-2 ${weeklyNetChange >= 0 ? 'text-green-500' : 'text-red-500'}`}>\r\n                {weeklyNetChange >= 0 ? 'You increased your wealth this week!' : 'You spent more than you earned this week'}\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Debt Management Section */}\r\n        {(creditCardBalance > 0 || currentDebt > 0) && (\r\n          <Card className=\"border-red-200 bg-red-50\">\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2 text-red-800\">\r\n                <AlertCircle className=\"w-6 h-6\" />\r\n                Debt Management - Critical Teaching Moment\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-6\">\r\n              <div className=\"bg-red-100 border border-red-300 rounded-lg p-4\">\r\n                <h4 className=\"font-semibold text-red-900 mb-2\">ðŸ’¡ Why Managing Debt Matters</h4>\r\n                <p className=\"text-sm text-red-800\">\r\n                  Debt accumulates interest over time, meaning you pay more than what you originally borrowed. \r\n                  The longer you carry debt, the more expensive it becomes. Learning to pay down debt quickly \r\n                  is one of the most important financial skills you can develop.\r\n                </p>\r\n              </div>\r\n\r\n              {/* Debt Summary */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                {creditCardBalance > 0 && (\r\n                  <div className=\"bg-white p-4 rounded-lg border border-red-200\">\r\n                    <h5 className=\"font-semibold text-red-800 mb-3\">Credit Card Debt</h5>\r\n                    <div className=\"space-y-2 text-sm\">\r\n                      <div className=\"flex justify-between\">\r\n                        <span>Balance:</span>\r\n                        <span className=\"font-bold text-red-600\">${creditCardBalance.toFixed(2)}</span>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <span>APR:</span>\r\n                        <span>{(creditCardInterestRate * 100).toFixed(1)}%</span>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <span>Monthly Interest:</span>\r\n                        <span className=\"text-red-600\">${(creditCardBalance * creditCardInterestRate / 12).toFixed(2)}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {currentDebt > 0 && (\r\n                  <div className=\"bg-white p-4 rounded-lg border border-red-200\">\r\n                    <h5 className=\"font-semibold text-red-800 mb-3\">Other Debt</h5>\r\n                    <div className=\"space-y-2 text-sm\">\r\n                      <div className=\"flex justify-between\">\r\n                        <span>Balance:</span>\r\n                        <span className=\"font-bold text-red-600\">${currentDebt.toFixed(2)}</span>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <span>APR:</span>\r\n                        <span>{(debtInterestRate * 100).toFixed(1)}%</span>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <span>Monthly Interest:</span>\r\n                        <span className=\"text-red-600\">${(currentDebt * debtInterestRate / 12).toFixed(2)}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Interactive Debt Calculator */}\r\n              <div className=\"bg-white p-6 rounded-lg border border-red-200\">\r\n                <h4 className=\"font-semibold text-red-800 mb-4 flex items-center gap-2\">\r\n                  <Calculator className=\"w-5 h-5\" />\r\n                  Interactive Debt Payoff Calculator\r\n                </h4>\r\n                \r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  {creditCardBalance > 0 && (\r\n                    <div className=\"space-y-4\">\r\n                      <h5 className=\"font-medium\">Credit Card Payment</h5>\r\n                       <div className=\"space-y-3\">\r\n                         <div>\r\n                           <Label>Payment Amount</Label>\r\n                           <div className=\"flex items-center gap-2 mt-1\">\r\n                             <div className=\"text-sm text-muted-foreground\">\r\n                               Current Amount: ${ccPaymentAmount || '0'}\r\n                             </div>\r\n                           </div>\r\n                           \r\n                           {/* Increment buttons */}\r\n                           <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                             <div className=\"flex gap-1\">\r\n                               {[1, 5, 10, 25, 50].map(inc => {\r\n                                 const newAmount = parseFloat(ccPaymentAmount || '0') + inc;\r\n                                 const canAdd = newAmount <= balance && newAmount <= creditCardBalance;\r\n                                 return (\r\n                                   <Button\r\n                                     key={`add-${inc}`}\r\n                                     size=\"sm\"\r\n                                     variant=\"outline\"\r\n                                     onClick={() => setCcPaymentAmount((newAmount).toString())}\r\n                                     disabled={!canAdd}\r\n                                     className=\"text-xs px-2\"\r\n                                   >\r\n                                     +${inc}\r\n                                   </Button>\r\n                                 );\r\n                               })}\r\n                             </div>\r\n                             \r\n                             <div className=\"flex gap-1\">\r\n                               {[1, 5, 10, 25, 50].map(inc => {\r\n                                 const currentAmount = parseFloat(ccPaymentAmount || '0');\r\n                                 const newAmount = Math.max(0, currentAmount - inc);\r\n                                 return (\r\n                                   <Button\r\n                                     key={`sub-${inc}`}\r\n                                     size=\"sm\"\r\n                                     variant=\"outline\"\r\n                                     onClick={() => setCcPaymentAmount(newAmount.toString())}\r\n                                     disabled={currentAmount < inc}\r\n                                     className=\"text-xs px-2\"\r\n                                   >\r\n                                     -${inc}\r\n                                   </Button>\r\n                                 );\r\n                               })}\r\n                             </div>\r\n                             \r\n                             <Button\r\n                               variant=\"outline\"\r\n                               size=\"sm\"\r\n                               onClick={() => setCcPaymentAmount('0')}\r\n                               disabled={!ccPaymentAmount || parseFloat(ccPaymentAmount) === 0}\r\n                               className=\"text-xs\"\r\n                             >\r\n                               Clear\r\n                             </Button>\r\n                             \r\n                             <Button\r\n                               variant=\"outline\"\r\n                               size=\"sm\"\r\n                               onClick={() => setCcPaymentAmount(Math.min(balance, creditCardBalance).toString())}\r\n                               className=\"text-xs\"\r\n                             >\r\n                               Max\r\n                             </Button>\r\n                             \r\n                             <Button\r\n                               variant=\"default\"\r\n                               onClick={() => {\r\n                                 const amount = parseFloat(ccPaymentAmount);\r\n                                 if (amount > 0) {\r\n                                   handleDebtPayment('credit', amount);\r\n                                   setCcPaymentAmount('');\r\n                                 }\r\n                               }}\r\n                               disabled={!ccPaymentAmount || parseFloat(ccPaymentAmount) <= 0 || parseFloat(ccPaymentAmount) > balance}\r\n                             >\r\n                               Pay ${ccPaymentAmount || '0'}\r\n                             </Button>\r\n                           </div>\r\n                         </div>\r\n                        {ccPaymentAmount && parseFloat(ccPaymentAmount) > 0 && (\r\n                          <div className=\"bg-gray-50 p-3 rounded text-sm\">\r\n                            {(() => {\r\n                              const payment = parseFloat(ccPaymentAmount);\r\n                              const calc = calculatePayoffTime(creditCardBalance, payment, creditCardInterestRate);\r\n                              return (\r\n                                <div>\r\n                                  <div>Payoff time: <strong>{calc.months} months</strong></div>\r\n                                  <div>Total interest: <strong>${calc.totalInterest.toFixed(2)}</strong></div>\r\n                                </div>\r\n                              );\r\n                            })()}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {currentDebt > 0 && (\r\n                    <div className=\"space-y-4\">\r\n                      <h5 className=\"font-medium\">Other Debt Payment</h5>\r\n                       <div className=\"space-y-3\">\r\n                         <div>\r\n                           <Label>Payment Amount</Label>\r\n                           <div className=\"flex items-center gap-2 mt-1\">\r\n                             <div className=\"text-sm text-muted-foreground\">\r\n                               Current Amount: ${debtPaymentAmount || '0'}\r\n                             </div>\r\n                           </div>\r\n                           \r\n                           {/* Increment buttons */}\r\n                           <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                             <div className=\"flex gap-1\">\r\n                               {[1, 5, 10, 25, 50].map(inc => {\r\n                                 const newAmount = parseFloat(debtPaymentAmount || '0') + inc;\r\n                                 const canAdd = newAmount <= balance && newAmount <= currentDebt;\r\n                                 return (\r\n                                   <Button\r\n                                     key={`add-${inc}`}\r\n                                     size=\"sm\"\r\n                                     variant=\"outline\"\r\n                                     onClick={() => setDebtPaymentAmount((newAmount).toString())}\r\n                                     disabled={!canAdd}\r\n                                     className=\"text-xs px-2\"\r\n                                   >\r\n                                     +${inc}\r\n                                   </Button>\r\n                                 );\r\n                               })}\r\n                             </div>\r\n                             \r\n                             <div className=\"flex gap-1\">\r\n                               {[1, 5, 10, 25, 50].map(inc => {\r\n                                 const currentAmount = parseFloat(debtPaymentAmount || '0');\r\n                                 const newAmount = Math.max(0, currentAmount - inc);\r\n                                 return (\r\n                                   <Button\r\n                                     key={`sub-${inc}`}\r\n                                     size=\"sm\"\r\n                                     variant=\"outline\"\r\n                                     onClick={() => setDebtPaymentAmount(newAmount.toString())}\r\n                                     disabled={currentAmount < inc}\r\n                                     className=\"text-xs px-2\"\r\n                                   >\r\n                                     -${inc}\r\n                                   </Button>\r\n                                 );\r\n                               })}\r\n                             </div>\r\n                             \r\n                             <Button\r\n                               variant=\"outline\"\r\n                               size=\"sm\"\r\n                               onClick={() => setDebtPaymentAmount('0')}\r\n                               disabled={!debtPaymentAmount || parseFloat(debtPaymentAmount) === 0}\r\n                               className=\"text-xs\"\r\n                             >\r\n                               Clear\r\n                             </Button>\r\n                             \r\n                             <Button\r\n                               variant=\"outline\"\r\n                               size=\"sm\"\r\n                               onClick={() => setDebtPaymentAmount(Math.min(balance, currentDebt).toString())}\r\n                               className=\"text-xs\"\r\n                             >\r\n                               Max\r\n                             </Button>\r\n                             \r\n                             <Button\r\n                               variant=\"default\"\r\n                               onClick={() => {\r\n                                 const amount = parseFloat(debtPaymentAmount);\r\n                                 if (amount > 0) {\r\n                                   handleDebtPayment('debt', amount);\r\n                                   setDebtPaymentAmount('');\r\n                                 }\r\n                               }}\r\n                               disabled={!debtPaymentAmount || parseFloat(debtPaymentAmount) <= 0 || parseFloat(debtPaymentAmount) > balance}\r\n                             >\r\n                               Pay ${debtPaymentAmount || '0'}\r\n                             </Button>\r\n                           </div>\r\n                         </div>\r\n                        {debtPaymentAmount && parseFloat(debtPaymentAmount) > 0 && (\r\n                          <div className=\"bg-gray-50 p-3 rounded text-sm\">\r\n                            {(() => {\r\n                              const payment = parseFloat(debtPaymentAmount);\r\n                              const calc = calculatePayoffTime(currentDebt, payment, debtInterestRate);\r\n                              return (\r\n                                <div>\r\n                                  <div>Payoff time: <strong>{calc.months} months</strong></div>\r\n                                  <div>Total interest: <strong>${calc.totalInterest.toFixed(2)}</strong></div>\r\n                                </div>\r\n                              );\r\n                            })()}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Enhanced Financial Activity Log */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Receipt className=\"w-6 h-6\" />\r\n              Financial Activity Log - Week {week}\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3 max-h-96 overflow-y-auto\">\r\n              {state.weekLog.length === 0 ? (\r\n                <div className=\"text-center py-8 text-muted-foreground\">\r\n                  No transactions recorded this week.\r\n                </div>\r\n              ) : (\r\n                state.weekLog.map((entry, index) => (\r\n                  <div key={index} className=\"flex items-center justify-between p-4 bg-muted rounded-lg hover:bg-muted/80 transition-colors\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"font-medium\">{entry.title || entry.type}</div>\r\n                      <div className=\"text-sm text-muted-foreground mt-1\">{entry.option || entry.note}</div>\r\n                      {entry.impact && entry.impact.includes('creditCard') && (\r\n                        <div className=\"text-xs text-red-600 mt-1 flex items-center gap-1\">\r\n                          <CreditCard className=\"w-3 h-3\" />\r\n                          This purchase will accrue interest on your credit card\r\n                        </div>\r\n                      )}\r\n                      <div className=\"text-xs text-muted-foreground mt-1\">\r\n                        {entry.date} â€¢ Week {entry.week}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-right ml-4\">\r\n                      <div className={`text-lg font-bold ${entry.amount >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                        {entry.amount >= 0 ? '+' : ''}${entry.amount?.toFixed(2) || '0.00'}\r\n                      </div>\r\n                      <div className=\"text-xs text-muted-foreground\">\r\n                        Balance: ${entry.balanceAfter?.toFixed(2)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Current Financial Status */}\r\n        <Card className=\"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200\">\r\n          <CardContent className=\"pt-6\">\r\n            <h3 className=\"text-lg font-semibold mb-4\">Current Financial Status</h3>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-green-600\">${balance.toFixed(2)}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Current Balance</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-blue-600\">{score}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Financial Score</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-purple-600\">{creditScore}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Credit Score</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className={`text-2xl font-bold ${(creditCardBalance + currentDebt) > 0 ? 'text-red-600' : 'text-green-600'}`}>\r\n                  ${(creditCardBalance + currentDebt).toFixed(2)}\r\n                </div>\r\n                <div className=\"text-sm text-muted-foreground\">Total Debt</div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Game Loop Integration */}\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-center space-y-4\">\r\n              <h3 className=\"text-lg font-semibold\">\r\n                {week > 4 ? 'Ready for Monthly Summary?' : `Ready for Week ${week + 1}?`}\r\n              </h3>\r\n              <p className=\"text-muted-foreground\">\r\n                {week > 4 \r\n                  ? 'You\\'ve completed all four weeks! View your monthly report to see how you did overall and reflect on your financial journey.'\r\n                  : 'Review your performance above, then continue to the next week when you\\'re ready to face new financial challenges.'\r\n                }\r\n              </p>\r\n              <Button \r\n                size=\"lg\" \r\n                className=\"w-full max-w-md mx-auto\"\r\n                onClick={() => {\r\n                  console.log('WeeklySummary Button clicked - Week:', week, 'Should end game?', week > 4);\r\n                  if (week > 4) {\r\n                    dispatch({ type: 'GAME_OVER', status: 'completed' });\r\n                    trackGameInteraction('game_completed', { \r\n                      finalScore: score, \r\n                      finalBalance: balance,\r\n                      weeks: week \r\n                    });\r\n                  } else {\r\n                    dispatch({ type: 'NEXT_WEEK' });\r\n                    trackGameInteraction('week_completed', { week, score, balance });\r\n                  }\r\n                }}\r\n              >\r\n                {week > 4 ? 'ðŸ“Š View Monthly Summary' : `âž¡ï¸ Go to Week ${week + 1}`}\r\n              </Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Game Over/Reflection Screen (only shows after 4 complete weeks)\r\n  const ReflectionScreen = () => {\r\n    // Only show reflection if we've truly completed all 4 weeks\r\n    const isActuallyComplete = week > 4 || (week === 4 && phase === 'REFLECT' && isGameOver);\r\n    \r\n    if (!isActuallyComplete) {\r\n      // If we're here incorrectly, redirect back to appropriate phase\r\n      console.log('ReflectionScreen called prematurely - redirecting. Week:', week, 'Phase:', phase, 'GameOver:', isGameOver);\r\n      \r\n      // Determine correct phase based on current state\r\n      if (week <= 4 && state.scenarioIndex < state.weeklyScenarios.length) {\r\n        // Should be in LIVE phase for more scenarios\r\n        return <ScenarioScreen />;\r\n      } else if (week <= 4) {\r\n        // Should be in WEEKLY_SUMMARY \r\n        return <WeeklySummaryScreen />;\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto space-y-6 text-center\">\r\n        <Card className=\"bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200\">\r\n          <CardHeader>\r\n            <div className=\"flex justify-center mb-4\">\r\n              <Trophy className=\"w-20 h-20 text-yellow-500\" />\r\n            </div>\r\n            <CardTitle className=\"text-3xl\">4-Week Game Complete!</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-6\">\r\n            <p className=\"text-xl text-muted-foreground\">\r\n              Congratulations! You've completed all 4 weeks of the Money Management Game and gained practical experience with real-world financial decisions.\r\n            </p>\r\n\r\n            <div className=\"bg-card p-4 rounded-lg border\">\r\n              <h4 className=\"font-semibold mb-2\">Game Summary</h4>\r\n              <div className=\"text-sm text-muted-foreground\">\r\n                Completed {week > 4 ? 4 : week} weeks â€¢ {Math.max(0, (week - 1) * 5 + state.scenarioIndex)} scenarios faced\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n              <div className=\"p-4 bg-card rounded-lg border\">\r\n                <div className=\"text-2xl font-bold text-green-600\">${balance.toFixed(2)}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Final Balance</div>\r\n              </div>\r\n              <div className=\"p-4 bg-card rounded-lg border\">\r\n                <div className=\"text-2xl font-bold text-blue-600\">{score}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Financial Wisdom Score</div>\r\n              </div>\r\n              <div className=\"p-4 bg-card rounded-lg border\">\r\n                <div className=\"text-2xl font-bold text-purple-600\">{creditScore}</div>\r\n                <div className=\"text-sm text-muted-foreground\">Credit Score</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-card p-6 rounded-lg border\">\r\n              <h3 className=\"text-lg font-semibold mb-4\">Key Takeaways</h3>\r\n              <ul className=\"text-left space-y-2 text-muted-foreground\">\r\n                <li className=\"flex items-start gap-2\">\r\n                  <span className=\"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                  <span>Smart budgeting helps you make informed financial decisions</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-2\">\r\n                  <span className=\"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                  <span>Emergency funds protect you from unexpected expenses</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-2\">\r\n                  <span className=\"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                  <span>Every financial choice has long-term consequences</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-2\">\r\n                  <span className=\"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                  <span>Building good credit habits early pays off over time</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Only call onComplete if we've actually finished all 4 weeks */}\r\n            <Button \r\n              size=\"lg\" \r\n              onClick={() => {\r\n                // Double check we're actually complete before calling onComplete\r\n                if (week > 4 || (week === 4 && isGameOver)) {\r\n                  onComplete?.();\r\n                  trackGameInteraction('lesson_completed', { \r\n                    finalScore: score, \r\n                    finalBalance: balance,\r\n                    weeksCompleted: week > 4 ? 4 : week\r\n                  });\r\n                } else {\r\n                  console.warn('Attempted to complete lesson prematurely');\r\n                  // Force back to correct state\r\n                  dispatch({ type: 'NEXT_WEEK' });\r\n                }\r\n              }}\r\n              className=\"bg-primary hover:bg-primary/90\"\r\n            >\r\n              Complete Lesson\r\n            </Button>\r\n\r\n            {hasNext && (\r\n              <Button \r\n                size=\"lg\" \r\n                variant=\"outline\" \r\n                onClick={onNext}\r\n                className=\"ml-4\"\r\n              >\r\n                Continue to Next Lesson\r\n              </Button>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Main render logic with debugging\r\n  if (showWelcome) {\r\n    return <WelcomeScreen />;\r\n  }\r\n\r\n  // Debug logging to understand game state\r\n  console.log('Game render state:', { \r\n    phase, \r\n    week, \r\n    scenarioIndex: state.scenarioIndex, \r\n    weeklyScenarios: state.weeklyScenarios?.length || 0,\r\n    hasScenarios: !!state.weeklyScenarios?.length,\r\n    currentScenario: state.currentScenario?.title || 'none',\r\n    isGameOver \r\n  });\r\n\r\n  if (phase === 'PLAN') {\r\n    return <BudgetPlanningScreen />;\r\n  }\r\n\r\n  if (phase === 'LIVE') {\r\n    return <ScenarioScreen />;\r\n  }\r\n\r\n  if (phase === 'SCENARIO_OUTCOME') {\r\n    return <ScenarioOutcomeSummaryScreen />;\r\n  }\r\n\r\n  if (phase === 'WEEKLY_SUMMARY') {\r\n    return <WeeklySummaryScreen />;\r\n  }\r\n\r\n  // Only go to reflection screen if we've actually completed 4 weeks\r\n  if (phase === 'REFLECT' && (week > 4 || isGameOver)) {\r\n    return <ReflectionScreen />;\r\n  }\r\n\r\n  // If we somehow get into an invalid state, reset to appropriate phase\r\n  if (phase === 'REFLECT' && week <= 4) {\r\n    console.warn('Invalid state: REFLECT phase with week <= 4. Redirecting to appropriate phase.');\r\n    // Force back to correct phase\r\n    if (state.scenarioIndex < state.weeklyScenarios.length) {\r\n      return <ScenarioScreen />;\r\n    } else {\r\n      return <WeeklySummaryScreen />;\r\n    }\r\n  }\r\n\r\n  return <div>Loading game... (Week: {week}, Phase: {phase})</div>;\r\n};\r\n\r\n// Main lesson component - direct game without container wrapper\r\nexport const MoneyManagementGameMicroLesson: React.FC<GameProps> = (props) => {\r\n  return <MoneyManagementGame {...props} />;\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\SavingStrategiesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\game-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\money-management\\game-state.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[815,818],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[815,818],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[840,843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[840,843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[924,927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[924,927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[946,949],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[946,949],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[976,979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[976,979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1015,1018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1015,1018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1033,1036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1033,1036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2102,2105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2102,2105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2318,2321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2318,2321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2458,2461],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2458,2461],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ALL_SCENARIOS } from './game-data';\r\n\r\nexport interface GameState {\r\n  phase: 'PLAN' | 'LIVE' | 'WEEKLY_SUMMARY' | 'REFLECT' | 'SCENARIO_OUTCOME';\r\n  week: number;\r\n  month: number;\r\n  scenarioIndex: number;\r\n  balance: number;\r\n  monthlyIncome: number;\r\n  monthlyNeeds: number;\r\n  savingsGoal: number;\r\n  currentSavings: number;\r\n  currentEmergencyFund: number;\r\n  currentDebt: number;\r\n  creditCardBalance: number;\r\n  creditCardLimit: number;\r\n  creditCardInterestRate: number;\r\n  debtInterestRate: number;\r\n  envelopes: {\r\n    Needs: number;\r\n    Wants: number;\r\n    Savings: number;\r\n    Emergency: number;\r\n  };\r\n  creditCardPayment: number;\r\n  creditScore: number;\r\n  score: number;\r\n  streak: number;\r\n  wiseChoices: number;\r\n  isGameOver: boolean;\r\n  gameStatus: string | null;\r\n  currentScenario: any;\r\n  weeklyScenarios: any[];\r\n  feedbackMessage: string | null;\r\n  isMiniGameActive: boolean;\r\n  weekLog: any[];\r\n  monthlyLog: any[];\r\n  ledgerTransactions: any[];\r\n  lastChoice: {\r\n    scenario: any;\r\n    option: any;\r\n    balanceChange: number;\r\n    creditChange: number;\r\n    debtChange: number;\r\n    scoreChange: number;\r\n  } | null;\r\n}\r\n\r\nexport const initialState: GameState = {\r\n  phase: 'PLAN',\r\n  week: 1,\r\n  month: 1,\r\n  scenarioIndex: 0,\r\n  balance: 500,\r\n  monthlyIncome: 800,\r\n  monthlyNeeds: 400,\r\n  savingsGoal: 200,\r\n  currentSavings: 0,\r\n  currentEmergencyFund: 0,\r\n  currentDebt: 0,\r\n  creditCardBalance: 0,\r\n  creditCardLimit: 500,\r\n  creditCardInterestRate: 0.18,\r\n  debtInterestRate: 0.12,\r\n  envelopes: {\r\n    Needs: 0,\r\n    Wants: 0,\r\n    Savings: 0,\r\n    Emergency: 0\r\n  },\r\n  creditCardPayment: 0,\r\n  creditScore: 650,\r\n  score: 100,\r\n  streak: 0,\r\n  wiseChoices: 0,\r\n  isGameOver: false,\r\n  gameStatus: null,\r\n  currentScenario: null,\r\n  weeklyScenarios: [],\r\n  feedbackMessage: null,\r\n  isMiniGameActive: false,\r\n  weekLog: [],\r\n  monthlyLog: [],\r\n  ledgerTransactions: [],\r\n  lastChoice: null\r\n};\r\n\r\ntype GameAction = \r\n  | { type: 'ALLOCATE_BUDGET'; category: string; amount: number }\r\n  | { type: 'START_SCENARIOS' }\r\n  | { type: 'MAKE_CHOICE'; option: any }\r\n  | { type: 'ADVANCE_SCENARIO' }\r\n  | { type: 'NEXT_WEEK' }\r\n  | { type: 'START_NEW_MONTH' }\r\n  | { type: 'GAME_OVER'; status: string }\r\n  | { type: 'RESET_GAME' }\r\n  | { type: 'MANUAL_TRANSACTION'; logEntry: any; newBalance: number }\r\n  | { type: 'CONTINUE_FROM_OUTCOME' }\r\n  | { type: 'GO_TO_SCENARIO'; payload: { scenarioIndex: number; scenario: any } }\r\n  | { type: 'PAY_DEBT'; debtType: 'credit' | 'debt'; amount: number };\r\n\r\nexport const gameReducer = (state: GameState, action: GameAction): GameState => {\r\n  switch (action.type) {\r\n    case 'ALLOCATE_BUDGET':\r\n      if (action.category === 'Credit Card Payment') {\r\n        return {\r\n          ...state,\r\n          creditCardPayment: action.amount\r\n        };\r\n      } else {\r\n        return {\r\n          ...state,\r\n          envelopes: {\r\n            ...state.envelopes,\r\n            [action.category]: action.amount\r\n          }\r\n        };\r\n      }\r\n\r\n    case 'START_SCENARIOS': {\r\n      // Select random scenarios for the week\r\n      const shuffledScenarios = [...ALL_SCENARIOS].sort(() => 0.5 - Math.random());\r\n      const weeklyScenarios = shuffledScenarios.slice(0, 5);\r\n      \r\n      return {\r\n        ...state,\r\n        phase: 'LIVE',\r\n        weeklyScenarios,\r\n        currentScenario: weeklyScenarios[0],\r\n        scenarioIndex: 0,\r\n        feedbackMessage: null\r\n      };\r\n    }\r\n\r\n    case 'MAKE_CHOICE': {\r\n      const { option } = action;\r\n      const feedback = option.feedback || \"Decision recorded.\";\r\n      \r\n      // Store original state for calculating changes\r\n      const originalBalance = state.balance;\r\n      const originalCredit = state.creditScore;\r\n      const originalScore = state.score;\r\n      const originalDebt = state.currentDebt + state.creditCardBalance;\r\n      \r\n      // Parse the impact and apply it to the state\r\n      let newBalance = state.balance;\r\n      let newCurrentSavings = state.currentSavings;\r\n      let newCurrentEmergencyFund = state.currentEmergencyFund;\r\n      let newDebt = state.currentDebt;\r\n      let newCreditCardBalance = state.creditCardBalance;\r\n      const newEnvelopes = { ...state.envelopes };\r\n      let newScore = state.score;\r\n      let newCredit = state.creditScore;\r\n      let newStreak = state.streak;\r\n      let newWiseChoices = state.wiseChoices;\r\n\r\n      // Apply the financial impact based on the option\r\n        if (option.impact) {\r\n        const impacts = option.impact.toLowerCase().split(',').map((s: string) => s.trim());\r\n        \r\n        impacts.forEach((impact: string) => {\r\n          if (impact.includes('income:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newBalance += amount;\r\n            newScore += 5;\r\n          } else if (impact.includes('balance:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newBalance += amount;\r\n          } else if (impact.includes('wants:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newEnvelopes.Wants += amount;\r\n            newBalance += amount;\r\n          } else if (impact.includes('savings:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newCurrentSavings += amount;\r\n            newScore += amount > 0 ? 10 : -5;\r\n          } else if (impact.includes('emergency:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newCurrentEmergencyFund += amount;\r\n            newScore += amount > 0 ? 15 : -10;\r\n          } else if (impact.includes('credit:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newCredit += amount;\r\n          } else if (impact.includes('score:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newScore += amount;\r\n          } else if (impact.includes('creditcard:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newCreditCardBalance += amount;\r\n            newScore -= 2; // Small penalty for using credit\r\n          } else if (impact.includes('needs:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newEnvelopes.Needs += amount;\r\n            newBalance += amount;\r\n          } else if (impact.includes('debt:')) {\r\n            const amount = parseFloat(impact.split(':')[1].replace(/[^0-9.-]/g, ''));\r\n            newDebt += amount;\r\n            newScore -= amount > 0 ? 5 : 5; // Penalty for taking on debt\r\n          }\r\n        });\r\n\r\n        // Track wise choices\r\n        if (newScore > state.score) {\r\n          newWiseChoices += 1;\r\n          newStreak += 1;\r\n        } else if (newScore < state.score) {\r\n          newStreak = 0;\r\n        }\r\n      }\r\n\r\n      // Create log entry\r\n      const logEntry = {\r\n        type: 'Scenario',\r\n        title: state.currentScenario?.title || 'Decision',\r\n        option: option.text,\r\n        impact: option.impact,\r\n        feedback,\r\n        date: new Date().toLocaleDateString(),\r\n        week: state.week,\r\n        month: state.month,\r\n        amount: newBalance - state.balance,\r\n        balanceAfter: newBalance\r\n      };\r\n\r\n      // Calculate changes for outcome summary\r\n      const balanceChange = newBalance - originalBalance;\r\n      const creditChange = newCredit - originalCredit;\r\n      const debtChange = (newDebt + newCreditCardBalance) - originalDebt;\r\n      const scoreChange = newScore - originalScore;\r\n\r\n      return {\r\n        ...state,\r\n        phase: 'SCENARIO_OUTCOME',\r\n        balance: Math.max(0, newBalance),\r\n        currentSavings: Math.max(0, newCurrentSavings),\r\n        currentEmergencyFund: Math.max(0, newCurrentEmergencyFund),\r\n        currentDebt: Math.max(0, newDebt),\r\n        creditCardBalance: Math.max(0, newCreditCardBalance),\r\n        envelopes: newEnvelopes,\r\n        creditScore: Math.max(300, Math.min(850, newCredit)),\r\n        score: Math.max(0, newScore),\r\n        streak: newStreak,\r\n        wiseChoices: newWiseChoices,\r\n        feedbackMessage: feedback,\r\n        weekLog: [...state.weekLog, logEntry],\r\n        monthlyLog: [...state.monthlyLog, logEntry],\r\n        lastChoice: {\r\n          scenario: state.currentScenario,\r\n          option,\r\n          balanceChange,\r\n          creditChange,\r\n          debtChange,\r\n          scoreChange\r\n        }\r\n      };\r\n    }\r\n\r\n    case 'CONTINUE_FROM_OUTCOME': {\r\n      const nextIndex = state.scenarioIndex + 1;\r\n      console.log('CONTINUE_FROM_OUTCOME - Current scenarioIndex:', state.scenarioIndex, 'Next index:', nextIndex, 'weeklyScenarios length:', state.weeklyScenarios.length);\r\n      \r\n      if (nextIndex >= 5) {\r\n        // All 5 scenarios completed, go to weekly summary\r\n        return {\r\n          ...state,\r\n          phase: 'WEEKLY_SUMMARY',\r\n          feedbackMessage: null,\r\n          lastChoice: null\r\n        };\r\n      } else {\r\n        // Continue to next scenario\r\n        return {\r\n          ...state,\r\n          scenarioIndex: nextIndex,\r\n          phase: 'LIVE',\r\n          currentScenario: state.weeklyScenarios[nextIndex],\r\n          feedbackMessage: null,\r\n          lastChoice: null\r\n        };\r\n      }\r\n    }\r\n\r\n    case 'ADVANCE_SCENARIO': {\r\n      const nextIndex = state.scenarioIndex + 1;\r\n      const nextPhase = nextIndex >= state.weeklyScenarios.length ? 'WEEKLY_SUMMARY' : 'LIVE';\r\n      \r\n      return {\r\n        ...state,\r\n        scenarioIndex: nextIndex,\r\n        phase: nextPhase,\r\n        currentScenario: nextPhase === 'LIVE' ? state.weeklyScenarios[nextIndex] : null,\r\n        feedbackMessage: null\r\n      };\r\n    }\r\n\r\n    case 'NEXT_WEEK': {\r\n      const nextWeek = state.week + 1;\r\n      const nextPhase = nextWeek > 4 ? 'REFLECT' : 'PLAN';\r\n      \r\n      console.log('NEXT_WEEK reducer - Current week:', state.week, 'Next week:', nextWeek, 'Next phase:', nextPhase);\r\n      \r\n      // Apply interest if there's debt\r\n      let newDebt = state.currentDebt;\r\n      let newCreditCardBalance = state.creditCardBalance;\r\n      let newCreditScore = state.creditScore;\r\n      \r\n      if (newDebt > 0) {\r\n        const debtInterest = newDebt * (state.debtInterestRate / 12);\r\n        newDebt += debtInterest;\r\n        newCreditScore -= 5;\r\n      }\r\n      \r\n      if (newCreditCardBalance > 0) {\r\n        const ccInterest = newCreditCardBalance * (state.creditCardInterestRate / 12);\r\n        newCreditCardBalance += ccInterest;\r\n        newCreditScore -= 5;\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        phase: nextPhase,\r\n        week: nextWeek,\r\n        monthlyLog: [...state.monthlyLog, ...state.weekLog],\r\n        weekLog: [],\r\n        scenarioIndex: 0,\r\n        currentScenario: null,\r\n        weeklyScenarios: [], // Reset for new week\r\n        currentDebt: newDebt,\r\n        creditCardBalance: newCreditCardBalance,\r\n        creditScore: Math.max(300, Math.min(850, newCreditScore)),\r\n        feedbackMessage: null\r\n      };\r\n    }\r\n\r\n    case 'START_NEW_MONTH':\r\n      return {\r\n        ...state,\r\n        phase: 'PLAN',\r\n        week: 1,\r\n        month: state.month + 1,\r\n        feedbackMessage: null,\r\n        monthlyLog: [],\r\n        weekLog: [],\r\n        envelopes: { Needs: 0, Wants: 0, Savings: 0, Emergency: 0 }\r\n      };\r\n\r\n    case 'GAME_OVER':\r\n      return {\r\n        ...state,\r\n        isGameOver: true,\r\n        gameStatus: action.status,\r\n        phase: 'REFLECT'\r\n      };\r\n\r\n    case 'RESET_GAME':\r\n      return initialState;\r\n\r\n    case 'MANUAL_TRANSACTION':\r\n      return {\r\n        ...state,\r\n        balance: action.newBalance,\r\n        ledgerTransactions: [...state.ledgerTransactions, action.logEntry],\r\n        weekLog: [...state.weekLog, action.logEntry]\r\n      };\r\n\r\n    case 'GO_TO_SCENARIO':\r\n      return {\r\n        ...state,\r\n        phase: 'LIVE',\r\n        scenarioIndex: action.payload.scenarioIndex,\r\n        currentScenario: action.payload.scenario,\r\n        feedbackMessage: null,\r\n        lastChoice: null\r\n      };\r\n\r\n    case 'PAY_DEBT': {\r\n      if (action.amount <= 0 || action.amount > state.balance) return state;\r\n      \r\n      const logEntry = {\r\n        type: 'Payment',\r\n        title: action.debtType === 'credit' ? 'Credit Card Payment' : 'Debt Payment',\r\n        option: `Payment of $${action.amount.toFixed(2)}`,\r\n        impact: `balance: -${action.amount}`,\r\n        feedback: `You paid $${action.amount.toFixed(2)} toward your ${action.debtType === 'credit' ? 'credit card' : 'debt'}.`,\r\n        date: new Date().toLocaleDateString(),\r\n        week: state.week,\r\n        month: state.month,\r\n        amount: -action.amount,\r\n        balanceAfter: state.balance - action.amount\r\n      };\r\n\r\n      return {\r\n        ...state,\r\n        balance: state.balance - action.amount,\r\n        creditCardBalance: action.debtType === 'credit' \r\n          ? Math.max(0, state.creditCardBalance - action.amount)\r\n          : state.creditCardBalance,\r\n        currentDebt: action.debtType === 'debt' \r\n          ? Math.max(0, state.currentDebt - action.amount)\r\n          : state.currentDebt,\r\n        creditScore: Math.min(850, state.creditScore + 5), // Small credit boost for payment\r\n        score: state.score + 5, // Small score boost for responsible payment\r\n        weekLog: [...state.weekLog, logEntry],\r\n        monthlyLog: [...state.monthlyLog, logEntry]\r\n      };\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\brain-superpowers\\BrainSuperpowersMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\brain-superpowers\\BrainSuperpowersMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\foundational-learning\\FoundationalLearningMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\foundational-learning\\FoundationalLearningMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\fpk-advantage\\FpkAdvantageMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\fpk-advantage\\FpkAdvantageMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\key-concepts-review\\KeyConceptsReviewMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\key-concepts-review\\KeyConceptsReviewMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\logic-critical-thinking\\LogicCriticalThinkingMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\logic-critical-thinking\\LogicCriticalThinkingMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\quiz-assessment\\QuizAssessmentMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\quiz-assessment\\QuizAssessmentMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\thriving-economics\\ThrivingEconomicsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\thriving-economics\\ThrivingEconomicsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\what-is-neurodiversity\\WhatIsNeurodiversityMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\neurodiversity\\what-is-neurodiversity\\WhatIsNeurodiversityMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\points-lines-planes\\PointsLinesPlanesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\points-lines-planes\\PointsLinesPlanesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\points-lines-planes\\PointsLinesPlanesMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\quadrilaterals\\QuadrilateralsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\quadrilaterals\\QuadrilateralsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\quadrilaterals\\QuadrilateralsMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\atoms-molecules\\AtomsMoleculesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\atoms-molecules\\AtomsMoleculesMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\cell-structure\\CellStructureMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\cell-structure\\CellStructureMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\energy-work\\EnergyWorkMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\energy-work\\EnergyWorkMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\forces-motion\\ForcesMotionMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\forces-motion\\ForcesMotionMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\further-exploration\\FurtherExplorationMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\further-exploration\\FurtherExplorationMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\genetics-dna\\GeneticsDNAMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\genetics-dna\\GeneticsDNAMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\importance-of-science\\ImportanceOfScienceMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\importance-of-science\\ImportanceOfScienceMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\periodic-table\\PeriodicTableMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\periodic-table\\PeriodicTableMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\review-summary\\ReviewSummaryMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\review-summary\\ReviewSummaryMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\scientific-method\\ScientificMethodMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\scientific-method\\ScientificMethodMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\short-answer-questions\\ShortAnswerQuestionsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\short-answer-questions\\ShortAnswerQuestionsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\study-guide\\StudyGuideMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\science\\study-guide\\StudyGuideMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\transformations\\TransformationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\transformations\\TransformationsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\transformations\\TransformationsMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\triangles\\TriangleMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\triangles\\TriangleMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\triangles\\TriangleMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\trigonometry\\TrigonometryApplicationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\trigonometry\\TrigonometryEquationsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\trigonometry\\TrigonometryGraphingMicroLesson.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":8,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":8,"endColumn":44},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":862,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":862,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[42729,42732],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[42729,42732],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { TrendingUp, Waves, BarChart3, Activity, Zap, Target } from 'lucide-react';\r\nimport { MicroLessonContainer } from '@/components/micro-lessons/MicroLessonContainer';\r\n\r\nexport const trigonometryGraphingLessonData = {\r\n  id: 'trigonometry-graphing', \r\n  moduleTitle: 'Graphing Trigonometric Functions',\r\n  totalScreens: 8,\r\n  screens: [\r\n    {\r\n      id: 'welcome',\r\n      type: 'concept' as const,\r\n      title: 'From Circle to Waves: Graphing Trig Functions',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"text-center\">\r\n            <Waves className=\"h-16 w-16 mx-auto mb-4 text-primary\" />\r\n            <h2 className=\"text-2xl font-bold mb-2\">Graphing Trigonometric Functions</h2>\r\n            <p className=\"text-lg text-muted-foreground\">\r\n              Transform the unit circle into beautiful wave patterns that model the world around us!\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"bg-gradient-to-r from-blue-50 to-green-50 p-6 rounded-lg\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŽ¯ What You'll Discover</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">How circular motion creates waves</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Graphing sine and cosine functions</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Understanding amplitude and period</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Tangent function and its unique properties</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Phase shifts and transformations</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Real-world wave applications</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"text-center bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <Activity className=\"h-8 w-8 text-yellow-600 mx-auto mb-2\" />\r\n            <p className=\"text-sm text-yellow-800\">\r\n              <strong>Visual Revolution!</strong> You're about to see how the unit circle unfolds into the wave patterns \r\n              that describe music, light, electricity, and so much more in our universe!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 2\r\n    },\r\n    {\r\n      id: 'sine-wave-basics',\r\n      type: 'concept',\r\n      title: 'The Sine Wave: From Circle to Wave',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">The Sine Wave: From Circle to Wave</h2>\r\n          \r\n          <div className=\"bg-red-50 p-6 rounded-lg border border-red-200\">\r\n            <h3 className=\"font-semibold mb-4 text-red-800\">ðŸŒŠ Creating the Sine Wave</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <p className=\"mb-4\">\r\n                  Imagine tracing a point as it moves around the unit circle. If you plot the y-coordinate \r\n                  (sine value) against the angle, you create the sine wave!\r\n                </p>\r\n                \r\n                <div className=\"bg-white p-4 rounded-lg\">\r\n                  <h4 className=\"font-medium text-red-700 mb-2\">Key Properties of y = sin(x):</h4>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ <strong>Domain:</strong> All real numbers</li>\r\n                    <li>â€¢ <strong>Range:</strong> [-1, 1]</li>\r\n                    <li>â€¢ <strong>Period:</strong> 2Ï€ (360Â°)</li>\r\n                    <li>â€¢ <strong>Amplitude:</strong> 1</li>\r\n                    <li>â€¢ <strong>Starts at:</strong> (0, 0)</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center bg-white p-4 rounded-lg\">\r\n                <div className=\"text-6xl mb-2\">ã€°ï¸</div>\r\n                <p className=\"text-xs text-gray-600 mb-3\">The Classic Sine Wave</p>\r\n                <div className=\"text-xs space-y-1\">\r\n                  <p><strong>Pattern:</strong> 0 â†’ 1 â†’ 0 â†’ -1 â†’ 0</p>\r\n                  <p><strong>Smooth and continuous</strong></p>\r\n                  <p><strong>Repeats every 2Ï€ units</strong></p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-4 text-blue-800\">ðŸ“ Key Points on the Sine Wave</h3>\r\n            \r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n              <Card className=\"bg-white border-blue-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = 0</p>\r\n                  <p className=\"text-xs\">sin(0) = 0</p>\r\n                  <p className=\"text-xs text-gray-600\">Starting point</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-blue-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = Ï€/2</p>\r\n                  <p className=\"text-xs\">sin(Ï€/2) = 1</p>\r\n                  <p className=\"text-xs text-gray-600\">Maximum</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-blue-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = Ï€</p>\r\n                  <p className=\"text-xs\">sin(Ï€) = 0</p>\r\n                  <p className=\"text-xs text-gray-600\">Crosses axis</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-blue-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = 3Ï€/2</p>\r\n                  <p className=\"text-xs\">sin(3Ï€/2) = -1</p>\r\n                  <p className=\"text-xs text-gray-600\">Minimum</p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ”„ The Repeating Pattern</h3>\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <p className=\"text-sm mb-3\">\r\n                The sine function is <strong>periodic</strong> with period 2Ï€. This means:\r\n              </p>\r\n              <div className=\"text-xs space-y-1\">\r\n                <p>sin(x + 2Ï€) = sin(x) for any value of x</p>\r\n                <p>sin(0) = sin(2Ï€) = sin(4Ï€) = sin(-2Ï€) = 0</p>\r\n                <p>sin(Ï€/2) = sin(Ï€/2 + 2Ï€) = sin(Ï€/2 + 4Ï€) = 1</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h4 className=\"font-semibold text-purple-800 mb-2\">ðŸŽµ Real-World Connection</h4>\r\n            <p className=\"text-sm\">\r\n              The sine wave is everywhere! It describes sound waves (musical notes), alternating current electricity, \r\n              ocean waves, and even the motion of a swing. Nature loves sine waves because they represent \r\n              the simplest form of oscillation.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'cosine-wave-basics',\r\n      type: 'concept',\r\n      title: \"The Cosine Wave: Sine's Twin\",\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">The Cosine Wave: Sine's Twin</h2>\r\n          \r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-4 text-blue-800\">ðŸŒŠ Creating the Cosine Wave</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <p className=\"mb-4\">\r\n                  The cosine wave comes from plotting the x-coordinate (cosine value) of a point moving \r\n                  around the unit circle. It's almost identical to sine, but shifted!\r\n                </p>\r\n                \r\n                <div className=\"bg-white p-4 rounded-lg\">\r\n                  <h4 className=\"font-medium text-blue-700 mb-2\">Key Properties of y = cos(x):</h4>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ <strong>Domain:</strong> All real numbers</li>\r\n                    <li>â€¢ <strong>Range:</strong> [-1, 1]</li>\r\n                    <li>â€¢ <strong>Period:</strong> 2Ï€ (360Â°)</li>\r\n                    <li>â€¢ <strong>Amplitude:</strong> 1</li>\r\n                    <li>â€¢ <strong>Starts at:</strong> (0, 1) - Maximum!</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center bg-white p-4 rounded-lg\">\r\n                <div className=\"text-6xl mb-2\">ã€°ï¸</div>\r\n                <p className=\"text-xs text-gray-600 mb-3\">The Cosine Wave (starts high!)</p>\r\n                <div className=\"text-xs space-y-1\">\r\n                  <p><strong>Pattern:</strong> 1 â†’ 0 â†’ -1 â†’ 0 â†’ 1</p>\r\n                  <p><strong>Same shape as sine</strong></p>\r\n                  <p><strong>But shifted left by Ï€/2</strong></p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">ðŸ“ Key Points on the Cosine Wave</h3>\r\n            \r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n              <Card className=\"bg-white border-green-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = 0</p>\r\n                  <p className=\"text-xs\">cos(0) = 1</p>\r\n                  <p className=\"text-xs text-gray-600\">Maximum start!</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = Ï€/2</p>\r\n                  <p className=\"text-xs\">cos(Ï€/2) = 0</p>\r\n                  <p className=\"text-xs text-gray-600\">Crosses axis</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = Ï€</p>\r\n                  <p className=\"text-xs\">cos(Ï€) = -1</p>\r\n                  <p className=\"text-xs text-gray-600\">Minimum</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200 text-center\">\r\n                <CardContent className=\"p-3\">\r\n                  <p className=\"text-sm font-medium\">x = 3Ï€/2</p>\r\n                  <p className=\"text-xs\">cos(3Ï€/2) = 0</p>\r\n                  <p className=\"text-xs text-gray-600\">Back to axis</p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸ”„ Sine vs. Cosine Relationship</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-yellow-700 mb-2\">Key Relationship</h4>\r\n                <p className=\"text-sm mb-2\">cos(x) = sin(x + Ï€/2)</p>\r\n                <p className=\"text-xs\">\r\n                  Cosine is just sine shifted Ï€/2 units to the left. They're the same wave, \r\n                  just starting at different points!\r\n                </p>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-yellow-700 mb-2\">Phase Difference</h4>\r\n                <p className=\"text-sm mb-2\">90Â° (or Ï€/2 radians) apart</p>\r\n                <p className=\"text-xs\">\r\n                  When sine is at maximum, cosine is at zero. When sine is at zero, \r\n                  cosine is at maximum or minimum.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸŽ¯ Comparison Table</h3>\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <div className=\"grid grid-cols-3 gap-2 text-xs\">\r\n                <div className=\"font-semibold\">Angle</div>\r\n                <div className=\"font-semibold\">sin(x)</div>\r\n                <div className=\"font-semibold\">cos(x)</div>\r\n                \r\n                <div>0Â°</div><div>0</div><div>1</div>\r\n                <div>30Â°</div><div>1/2</div><div>âˆš3/2</div>\r\n                <div>45Â°</div><div>âˆš2/2</div><div>âˆš2/2</div>\r\n                <div>60Â°</div><div>âˆš3/2</div><div>1/2</div>\r\n                <div>90Â°</div><div>1</div><div>0</div>\r\n                <div>180Â°</div><div>0</div><div>-1</div>\r\n                <div>270Â°</div><div>-1</div><div>0</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-orange-50 p-4 rounded-lg border border-orange-200\">\r\n            <h4 className=\"font-semibold text-orange-800 mb-2\">âš¡ Quick Recognition</h4>\r\n            <p className=\"text-sm\">\r\n              Remember: Sine starts at 0 and goes up, Cosine starts at 1 and goes down. \r\n              If you see a wave starting at its maximum, it's probably cosine!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'tangent-function',\r\n      type: 'concept',\r\n      title: 'The Tangent Function: A Different Beast',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">The Tangent Function: A Different Beast</h2>\r\n          \r\n          <div className=\"bg-orange-50 p-6 rounded-lg border border-orange-200\">\r\n            <h3 className=\"font-semibold mb-4 text-orange-800\">ðŸ“ˆ Understanding Tangent</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <p className=\"mb-4\">\r\n                  The tangent function is different! It's not bounded like sine and cosine. \r\n                  Since tan(x) = sin(x)/cos(x), it goes to infinity when cosine equals zero.\r\n                </p>\r\n                \r\n                <div className=\"bg-white p-4 rounded-lg\">\r\n                  <h4 className=\"font-medium text-orange-700 mb-2\">Key Properties of y = tan(x):</h4>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ <strong>Domain:</strong> All reals except Ï€/2 + nÏ€</li>\r\n                    <li>â€¢ <strong>Range:</strong> All real numbers</li>\r\n                    <li>â€¢ <strong>Period:</strong> Ï€ (180Â°) - Half of sine/cosine!</li>\r\n                    <li>â€¢ <strong>Vertical asymptotes</strong> at x = Ï€/2, 3Ï€/2, etc.</li>\r\n                    <li>â€¢ <strong>Starts at:</strong> (0, 0)</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center bg-white p-4 rounded-lg\">\r\n                <div className=\"text-6xl mb-2\">ðŸ“ˆ</div>\r\n                <p className=\"text-xs text-gray-600 mb-3\">Tangent: Curves that go to infinity!</p>\r\n                <div className=\"text-xs space-y-1\">\r\n                  <p><strong>Pattern:</strong> 0 â†’ âˆž then -âˆž â†’ 0</p>\r\n                  <p><strong>Repeats every Ï€ units</strong></p>\r\n                  <p><strong>Has vertical asymptotes</strong></p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-red-50 p-6 rounded-lg border border-red-200\">\r\n            <h3 className=\"font-semibold mb-4 text-red-800\">ðŸš« Vertical Asymptotes</h3>\r\n            \r\n            <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n              <p className=\"text-sm mb-3\">\r\n                Tangent has vertical asymptotes (undefined points) where cosine equals zero:\r\n              </p>\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs\">\r\n                <div className=\"text-center p-2 bg-red-50 rounded\">\r\n                  <p className=\"font-medium\">x = Ï€/2</p>\r\n                  <p>cos(Ï€/2) = 0</p>\r\n                  <p>tan(Ï€/2) = undefined</p>\r\n                </div>\r\n                <div className=\"text-center p-2 bg-red-50 rounded\">\r\n                  <p className=\"font-medium\">x = 3Ï€/2</p>\r\n                  <p>cos(3Ï€/2) = 0</p>\r\n                  <p>tan(3Ï€/2) = undefined</p>\r\n                </div>\r\n                <div className=\"text-center p-2 bg-red-50 rounded\">\r\n                  <p className=\"font-medium\">x = -Ï€/2</p>\r\n                  <p>cos(-Ï€/2) = 0</p>\r\n                  <p>tan(-Ï€/2) = undefined</p>\r\n                </div>\r\n                <div className=\"text-center p-2 bg-red-50 rounded\">\r\n                  <p className=\"font-medium\">x = 5Ï€/2</p>\r\n                  <p>cos(5Ï€/2) = 0</p>\r\n                  <p>tan(5Ï€/2) = undefined</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"bg-yellow-50 p-3 rounded-lg border border-yellow-200\">\r\n              <p className=\"text-sm text-yellow-800\">\r\n                <strong>Visual Tip:</strong> Near these asymptotes, the tangent curve shoots up to +âˆž \r\n                on one side and down to -âˆž on the other side, creating a dramatic vertical line!\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ“ Key Points on Tangent</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n              <Card className=\"bg-white border-green-200\">\r\n                <CardContent className=\"p-3 text-center\">\r\n                  <p className=\"text-sm font-medium\">Zero Points</p>\r\n                  <p className=\"text-xs\">tan(0) = 0</p>\r\n                  <p className=\"text-xs\">tan(Ï€) = 0</p>\r\n                  <p className=\"text-xs\">tan(2Ï€) = 0</p>\r\n                  <p className=\"text-xs text-gray-600\">Crosses x-axis</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200\">\r\n                <CardContent className=\"p-3 text-center\">\r\n                  <p className=\"text-sm font-medium\">Special Values</p>\r\n                  <p className=\"text-xs\">tan(Ï€/4) = 1</p>\r\n                  <p className=\"text-xs\">tan(Ï€/3) = âˆš3</p>\r\n                  <p className=\"text-xs\">tan(Ï€/6) = 1/âˆš3</p>\r\n                  <p className=\"text-xs text-gray-600\">Memorable points</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200\">\r\n                <CardContent className=\"p-3 text-center\">\r\n                  <p className=\"text-sm font-medium\">Asymptotes</p>\r\n                  <p className=\"text-xs\">x = Ï€/2 + nÏ€</p>\r\n                  <p className=\"text-xs\">where n is any integer</p>\r\n                  <p className=\"text-xs text-gray-600\">Undefined points</p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h4 className=\"font-semibold text-blue-800 mb-2\">ðŸŽ¯ Why Tangent is Special</h4>\r\n            <p className=\"text-sm\">\r\n              Tangent represents slope! At any point on the unit circle, tan(Î¸) gives the slope of the line \r\n              from the origin to that point. This makes tangent perfect for describing steepness, \r\n              rates of change, and angular relationships in engineering and physics.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'amplitude-period',\r\n      type: 'concept',\r\n      title: 'Amplitude and Period: Controlling the Waves',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Amplitude and Period: Controlling the Waves</h2>\r\n          \r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-4 text-purple-800\">ðŸ“ Amplitude: How High the Wave Goes</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n                  <p className=\"text-sm mb-3\">\r\n                    <strong>Amplitude</strong> controls the height of the wave. For y = AÂ·sin(x) or y = AÂ·cos(x):\r\n                  </p>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ |A| = amplitude (always positive)</li>\r\n                    <li>â€¢ If A {'>'} 0: normal orientation</li>\r\n                    <li>â€¢ If A {'<'} 0: flipped upside down</li>\r\n                    <li>â€¢ Range becomes [-|A|, |A|]</li>\r\n                  </ul>\r\n                </div>\r\n                \r\n                <div className=\"bg-yellow-50 p-3 rounded-lg border border-yellow-200\">\r\n                  <p className=\"text-xs text-yellow-800\">\r\n                    <strong>Real-world:</strong> Amplitude represents volume (sound), brightness (light), \r\n                    or intensity (radio waves).\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"space-y-3\">\r\n                <Card className=\"bg-white border-purple-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = 2sin(x)</p>\r\n                    <p className=\"text-xs\">Amplitude = 2</p>\r\n                    <p className=\"text-xs\">Range: [-2, 2]</p>\r\n                    <p className=\"text-xs text-purple-600\">Twice as tall!</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-purple-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = 0.5cos(x)</p>\r\n                    <p className=\"text-xs\">Amplitude = 0.5</p>\r\n                    <p className=\"text-xs\">Range: [-0.5, 0.5]</p>\r\n                    <p className=\"text-xs text-purple-600\">Half as tall!</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-purple-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = -3sin(x)</p>\r\n                    <p className=\"text-xs\">Amplitude = 3</p>\r\n                    <p className=\"text-xs\">Range: [-3, 3]</p>\r\n                    <p className=\"text-xs text-purple-600\">Flipped and tall!</p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">ðŸ”„ Period: How Often the Wave Repeats</h3>\r\n            \r\n            <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n              <p className=\"text-sm mb-3\">\r\n                <strong>Period</strong> controls how quickly the wave repeats. For y = sin(Bx) or y = cos(Bx):\r\n              </p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ Period = 2Ï€/|B|</li>\r\n                    <li>â€¢ If |B| {'>'} 1: wave compresses (faster)</li>\r\n                    <li>â€¢ If |B| {'<'} 1: wave stretches (slower)</li>\r\n                    <li>â€¢ If B {'<'} 0: reflection about y-axis</li>\r\n                  </ul>\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"text-xs bg-green-50 p-2 rounded\">\r\n                    <p><strong>y = sin(2x):</strong> Period = Ï€ (half as long)</p>\r\n                  </div>\r\n                  <div className=\"text-xs bg-green-50 p-2 rounded\">\r\n                    <p><strong>y = sin(x/2):</strong> Period = 4Ï€ (twice as long)</p>\r\n                  </div>\r\n                  <div className=\"text-xs bg-green-50 p-2 rounded\">\r\n                    <p><strong>y = sin(3x):</strong> Period = 2Ï€/3 (third as long)</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŽµ Combined Transformations</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-blue-700 mb-2\">y = AÂ·sin(Bx)</h4>\r\n                <div className=\"text-sm space-y-1\">\r\n                  <p>â€¢ Amplitude = |A|</p>\r\n                  <p>â€¢ Period = 2Ï€/|B|</p>\r\n                  <p>â€¢ Range = [-|A|, |A|]</p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-blue-700 mb-2\">Example: y = 3sin(2x)</h4>\r\n                <div className=\"text-sm space-y-1\">\r\n                  <p>â€¢ Amplitude = 3</p>\r\n                  <p>â€¢ Period = 2Ï€/2 = Ï€</p>\r\n                  <p>â€¢ Range = [-3, 3]</p>\r\n                  <p className=\"text-xs text-blue-600\">Tall and fast!</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸŒŠ Real-World Examples</h3>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Ocean Waves</p>\r\n                <p className=\"text-xs\">Large amplitude = tall waves, short period = frequent waves</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Sound Waves</p>\r\n                <p className=\"text-xs\">Large amplitude = loud sound, short period = high pitch</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">AC Electricity</p>\r\n                <p className=\"text-xs\">Amplitude = voltage level, period = frequency (60 Hz in US)</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-red-50 p-4 rounded-lg border border-red-200\">\r\n            <h4 className=\"font-semibold text-red-800 mb-2\">âš¡ Quick Check</h4>\r\n            <p className=\"text-sm\">\r\n              Remember: Amplitude affects HEIGHT (how far up/down), Period affects WIDTH (how spread out). \r\n              Think \"tall and skinny\" vs \"short and wide\" waves!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'phase-shifts',\r\n      type: 'concept',\r\n      title: 'Phase Shifts and Vertical Shifts',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Phase Shifts and Vertical Shifts</h2>\r\n          \r\n          <div className=\"bg-indigo-50 p-6 rounded-lg border border-indigo-200\">\r\n            <h3 className=\"font-semibold mb-4 text-indigo-800\">â†”ï¸ Phase Shifts: Moving Left and Right</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n                  <p className=\"text-sm mb-3\">\r\n                    <strong>Phase shift</strong> moves the entire wave left or right. For y = sin(x - C):\r\n                  </p>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ If C {'>'} 0: shift RIGHT by C units</li>\r\n                    <li>â€¢ If C {'<'} 0: shift LEFT by |C| units</li>\r\n                    <li>â€¢ The wave keeps its shape, just moves</li>\r\n                    <li>â€¢ Also called \"horizontal translation\"</li>\r\n                  </ul>\r\n                </div>\r\n                \r\n                <div className=\"bg-yellow-50 p-3 rounded-lg border border-yellow-200\">\r\n                  <p className=\"text-xs text-yellow-800\">\r\n                    <strong>Memory trick:</strong> y = sin(x - Ï€/2) shifts RIGHT Ï€/2 units, \r\n                    which turns sine into negative cosine!\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"space-y-3\">\r\n                <Card className=\"bg-white border-indigo-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = sin(x - Ï€/4)</p>\r\n                    <p className=\"text-xs\">Shifts RIGHT Ï€/4</p>\r\n                    <p className=\"text-xs text-indigo-600\">Delayed start</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-indigo-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = cos(x + Ï€/3)</p>\r\n                    <p className=\"text-xs\">Shifts LEFT Ï€/3</p>\r\n                    <p className=\"text-xs text-indigo-600\">Early start</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-indigo-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = sin(x - Ï€/2)</p>\r\n                    <p className=\"text-xs\">Shifts RIGHT Ï€/2</p>\r\n                    <p className=\"text-xs text-indigo-600\">= -cos(x)</p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">â†•ï¸ Vertical Shifts: Moving Up and Down</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n                  <p className=\"text-sm mb-3\">\r\n                    <strong>Vertical shift</strong> moves the entire wave up or down. For y = sin(x) + D:\r\n                  </p>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ If D {'>'} 0: shift UP by D units</li>\r\n                    <li>â€¢ If D {'<'} 0: shift DOWN by |D| units</li>\r\n                    <li>â€¢ Changes the midline (center line)</li>\r\n                    <li>â€¢ New range: [min+D, max+D]</li>\r\n                  </ul>\r\n                </div>\r\n                \r\n                <div className=\"bg-blue-50 p-3 rounded-lg border border-blue-200\">\r\n                  <p className=\"text-xs text-blue-800\">\r\n                    <strong>Real-world:</strong> Vertical shifts represent baseline values - \r\n                    like average temperature with daily fluctuations!\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"space-y-3\">\r\n                <Card className=\"bg-white border-green-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = sin(x) + 2</p>\r\n                    <p className=\"text-xs\">Shifts UP 2 units</p>\r\n                    <p className=\"text-xs\">Range: [1, 3]</p>\r\n                    <p className=\"text-xs text-green-600\">Elevated wave</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-green-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = cos(x) - 1</p>\r\n                    <p className=\"text-xs\">Shifts DOWN 1 unit</p>\r\n                    <p className=\"text-xs\">Range: [-2, 0]</p>\r\n                    <p className=\"text-xs text-green-600\">Lowered wave</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-green-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">y = 2sin(x) + 3</p>\r\n                    <p className=\"text-xs\">Amplitude 2, up 3</p>\r\n                    <p className=\"text-xs\">Range: [1, 5]</p>\r\n                    <p className=\"text-xs text-green-600\">Tall and high!</p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸŽ¯ Complete Transformation Formula</h3>\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <div className=\"text-center mb-4\">\r\n                <p className=\"text-lg font-bold\">y = AÂ·sin(B(x - C)) + D</p>\r\n              </div>\r\n              \r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm\">\r\n                <div className=\"text-center p-2 bg-red-50 rounded\">\r\n                  <p className=\"font-medium\">A</p>\r\n                  <p className=\"text-xs\">Amplitude</p>\r\n                  <p className=\"text-xs\">Height control</p>\r\n                </div>\r\n                <div className=\"text-center p-2 bg-blue-50 rounded\">\r\n                  <p className=\"font-medium\">B</p>\r\n                  <p className=\"text-xs\">Period = 2Ï€/|B|</p>\r\n                  <p className=\"text-xs\">Speed control</p>\r\n                </div>\r\n                <div className=\"text-center p-2 bg-green-50 rounded\">\r\n                  <p className=\"font-medium\">C</p>\r\n                  <p className=\"text-xs\">Phase shift</p>\r\n                  <p className=\"text-xs\">Left/right move</p>\r\n                </div>\r\n                <div className=\"text-center p-2 bg-purple-50 rounded\">\r\n                  <p className=\"font-medium\">D</p>\r\n                  <p className=\"text-xs\">Vertical shift</p>\r\n                  <p className=\"text-xs\">Up/down move</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸ“ Example Analysis</h3>\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <p className=\"text-lg font-semibold mb-2\">y = 3sin(2(x - Ï€/4)) + 1</p>\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm\">\r\n                <div>\r\n                  <p className=\"font-medium\">Amplitude: 3</p>\r\n                  <p className=\"text-xs\">Wave is 3 units tall</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium\">Period: Ï€</p>\r\n                  <p className=\"text-xs\">2Ï€/2 = Ï€ units long</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium\">Phase: Ï€/4 right</p>\r\n                  <p className=\"text-xs\">Starts Ï€/4 units later</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-medium\">Vertical: +1</p>\r\n                  <p className=\"text-xs\">Centered at y = 1</p>\r\n                </div>\r\n              </div>\r\n              <p className=\"text-xs text-yellow-700 mt-3\">\r\n                <strong>Range:</strong> [1-3, 1+3] = [-2, 4]\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-orange-50 p-4 rounded-lg border border-orange-200\">\r\n            <h4 className=\"font-semibold text-orange-800 mb-2\">ðŸŽµ Musical Connection</h4>\r\n            <p className=\"text-sm\">\r\n              These transformations are like adjusting a stereo: amplitude is volume, period is pitch, \r\n              phase shift is delay/echo, and vertical shift is the baseline or DC offset. \r\n              Every wave in nature can be described this way!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'lesson-summary',\r\n      type: 'summary',\r\n      title: 'Wave Master: You Can Graph Any Trigonometric Function!',\r\n      content: (\r\n        <div className=\"space-y-4\">\r\n          <h2 className=\"text-xl font-bold\">ðŸŽ‰ Incredible! You've Mastered the Art of Trigonometric Graphing</h2>\r\n          <div className=\"bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ† Your Wave-Riding Skills:</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… Creating sine and cosine waves from the unit circle</li>\r\n                <li>âœ… Understanding tangent's unique asymptotic behavior</li>\r\n                <li>âœ… Controlling amplitude (height) and period (speed)</li>\r\n                <li>âœ… Mastering phase shifts (left/right movement)</li>\r\n              </ul>\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… Applying vertical shifts (up/down movement)</li>\r\n                <li>âœ… Analyzing complex transformations y = AÂ·sin(B(x-C))+D</li>\r\n                <li>âœ… Connecting mathematical waves to real-world phenomena</li>\r\n                <li>âœ… Recognizing wave patterns in nature and technology</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŒŠ Your Transformation Toolkit:</h3>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n              <div className=\"bg-white p-3 rounded border border-red-200 text-center\">\r\n                <TrendingUp className=\"h-6 w-6 mx-auto mb-2 text-red-600\" />\r\n                <p className=\"text-sm font-semibold\">Amplitude</p>\r\n                <p className=\"text-xs\">Controls wave height</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border border-blue-200 text-center\">\r\n                <Waves className=\"h-6 w-6 mx-auto mb-2 text-blue-600\" />\r\n                <p className=\"text-sm font-semibold\">Period</p>\r\n                <p className=\"text-xs\">Controls wave speed</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border border-green-200 text-center\">\r\n                <Target className=\"h-6 w-6 mx-auto mb-2 text-green-600\" />\r\n                <p className=\"text-sm font-semibold\">Phase Shift</p>\r\n                <p className=\"text-xs\">Moves wave left/right</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border border-purple-200 text-center\">\r\n                <BarChart3 className=\"h-6 w-6 mx-auto mb-2 text-purple-600\" />\r\n                <p className=\"text-sm font-semibold\">Vertical Shift</p>\r\n                <p className=\"text-xs\">Moves wave up/down</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸš€ Coming Up Next:</h3>\r\n            <p className=\"text-sm mb-3\">\r\n              Now that you can visualize trigonometric functions, you're ready to explore the relationships \r\n              between different trig functions:\r\n            </p>\r\n            <ul className=\"text-xs space-y-1\">\r\n              <li>â€¢ Fundamental trigonometric identities</li>\r\n              <li>â€¢ How to prove and use these powerful relationships</li>\r\n              <li>â€¢ Simplifying complex trigonometric expressions</li>\r\n              <li>â€¢ Building the foundation for solving trig equations</li>\r\n            </ul>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-2 text-yellow-800\">ðŸŽ¼ The Universal Language</h3>\r\n            <p className=\"text-sm\">\r\n              You've just learned the universal language of oscillation! Every vibrating string, radio wave, \r\n              heartbeat, brain wave, and planetary orbit can be described using the trigonometric functions \r\n              you now understand. You're seeing the mathematics that makes the universe dance!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 3\r\n    }\r\n  ]\r\n};\r\n\r\ninterface TrigonometryGraphingMicroLessonProps {\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst TrigonometryGraphingMicroLesson: React.FC<TrigonometryGraphingMicroLessonProps> = ({ onComplete }) => {\r\n  return (\r\n    <MicroLessonContainer\r\n      lessonData={trigonometryGraphingLessonData as any}\r\n      onComplete={onComplete}\r\n    />\r\n  );\r\n};\r\n\r\nexport default TrigonometryGraphingMicroLesson;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\trigonometry\\TrigonometryIdentitiesMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\trigonometry\\TrigonometryIntroductionMicroLesson.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":8,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":8,"endColumn":48},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":617,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":617,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30100,30103],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30100,30103],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Calculator, Triangle, BookOpen, Target, AlertCircle, Award } from 'lucide-react';\r\nimport { MicroLessonContainer } from '@/components/micro-lessons/MicroLessonContainer';\r\n\r\nexport const trigonometryIntroductionLessonData = {\r\n  id: 'trigonometry-introduction',\r\n  moduleTitle: 'Introduction to Trigonometry',\r\n  totalScreens: 8,\r\n  screens: [\r\n    {\r\n      id: 'welcome',\r\n      type: 'concept' as const,\r\n      title: 'Welcome to Trigonometry!',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"text-center\">\r\n            <Triangle className=\"h-16 w-16 mx-auto mb-4 text-primary\" />\r\n            <h2 className=\"text-2xl font-bold mb-2\">Introduction to Trigonometry</h2>\r\n            <p className=\"text-lg text-muted-foreground\">\r\n              Discover the fascinating world of trigonometry - the mathematics of triangles, waves, and rotations!\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŽ¯ What You'll Learn</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">What trigonometry is and why it matters</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Understanding right triangles</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">The unit circle concept</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-purple-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Key angles and their importance</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-purple-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Real-world applications</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-purple-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Building foundation for advanced concepts</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"text-center bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <AlertCircle className=\"h-8 w-8 text-yellow-600 mx-auto mb-2\" />\r\n            <p className=\"text-sm text-yellow-800\">\r\n              <strong>Pro Tip:</strong> Trigonometry connects geometry with algebra and appears everywhere in science, \r\n              engineering, and even art. Master these basics to unlock advanced mathematics!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 2\r\n    },\r\n    {\r\n      id: 'what-is-trigonometry',\r\n      type: 'concept',\r\n      title: 'What is Trigonometry?',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">What is Trigonometry?</h2>\r\n          \r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸ“š Definition</h3>\r\n            <p className=\"text-lg mb-4\">\r\n              <strong>Trigonometry</strong> is the branch of mathematics that studies the relationships between \r\n              angles and sides in triangles. The word comes from Greek: \"trigon\" (triangle) + \"metron\" (measure).\r\n            </p>\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <p className=\"font-medium text-blue-700\">In simple terms:</p>\r\n              <p className=\"text-sm mt-2\">\r\n                Trigonometry helps us find unknown sides or angles in triangles when we know some information about them.\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <Card className=\"bg-green-50 border-green-200\">\r\n              <CardContent className=\"p-4 text-center\">\r\n                <Calculator className=\"h-8 w-8 mx-auto mb-2 text-green-600\" />\r\n                <h4 className=\"font-semibold text-green-800\">Engineering</h4>\r\n                <p className=\"text-xs text-green-700 mt-2\">Building bridges, designing structures</p>\r\n              </CardContent>\r\n            </Card>\r\n            \r\n            <Card className=\"bg-purple-50 border-purple-200\">\r\n              <CardContent className=\"p-4 text-center\">\r\n                <Target className=\"h-8 w-8 mx-auto mb-2 text-purple-600\" />\r\n                <h4 className=\"font-semibold text-purple-800\">Navigation</h4>\r\n                <p className=\"text-xs text-purple-700 mt-2\">GPS, sailing, aviation</p>\r\n              </CardContent>\r\n            </Card>\r\n            \r\n            <Card className=\"bg-orange-50 border-orange-200\">\r\n              <CardContent className=\"p-4 text-center\">\r\n                <Award className=\"h-8 w-8 mx-auto mb-2 text-orange-600\" />\r\n                <h4 className=\"font-semibold text-orange-800\">Physics</h4>\r\n                <p className=\"text-xs text-orange-700 mt-2\">Waves, oscillations, forces</p>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n            <p className=\"text-sm\">\r\n              <strong>Fun Fact:</strong> Ancient Egyptians used trigonometry to build pyramids, and today it powers \r\n              everything from video games to satellite communications!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 3\r\n    },\r\n    {\r\n      id: 'right-triangles',\r\n      type: 'concept',\r\n      title: 'Right Triangles: The Foundation',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Right Triangles: The Foundation</h2>\r\n          \r\n          <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸ”º What Makes a Right Triangle Special?</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <p className=\"mb-4\">\r\n                  Right triangles are the foundation of trigonometry. They have one 90Â° angle and two acute angles that sum to 90Â°.\r\n                </p>\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-3 h-3 bg-red-500 rounded-full\"></div>\r\n                    <span className=\"text-sm\"><strong>Hypotenuse:</strong> The longest side (opposite the 90Â° angle)</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\r\n                    <span className=\"text-sm\"><strong>Opposite:</strong> The side opposite to the angle we're studying</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-3 h-3 bg-green-500 rounded-full\"></div>\r\n                    <span className=\"text-sm\"><strong>Adjacent:</strong> The side next to the angle we're studying</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"bg-white p-4 rounded-lg text-center\">\r\n                <div className=\"text-8xl font-mono mb-2\">ðŸ“</div>\r\n                <p className=\"text-xs text-gray-600\">\r\n                  Imagine this as a right triangle - the corner represents the 90Â° angle\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸŽ¯ Key Properties</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… One angle is exactly 90Â°</li>\r\n                <li>âœ… The other two angles sum to 90Â°</li>\r\n                <li>âœ… Hypotenuse is always the longest side</li>\r\n              </ul>\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… Pythagorean theorem applies: aÂ² + bÂ² = cÂ²</li>\r\n                <li>âœ… Foundation for all trigonometric ratios</li>\r\n                <li>âœ… Appears everywhere in real applications</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">\r\n            <h4 className=\"font-semibold text-green-800 mb-2\">ðŸ’¡ Memory Aid</h4>\r\n            <p className=\"text-sm\">\r\n              Think of a right triangle as a \"corner\" - like the corner of a room where two walls meet the floor. \r\n              That corner is always 90Â°, and the triangular space forms our right triangle!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'triangle-sides',\r\n      type: 'example',\r\n      title: 'Identifying Triangle Sides',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Identifying Triangle Sides</h2>\r\n          \r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-4 text-purple-800\">ðŸŽ¯ The Three Sides Explained</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\r\n              <Card className=\"bg-red-50 border-red-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-red-800\">Hypotenuse</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <p className=\"text-xs text-red-700\">\r\n                    â€¢ Always the longest side<br/>\r\n                    â€¢ Opposite the 90Â° angle<br/>\r\n                    â€¢ Never changes identity\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-blue-50 border-blue-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-blue-800\">Opposite</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <p className=\"text-xs text-blue-700\">\r\n                    â€¢ Opposite to your chosen angle<br/>\r\n                    â€¢ Changes based on which angle you're studying<br/>\r\n                    â€¢ Not the hypotenuse\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-green-50 border-green-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-green-800\">Adjacent</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <p className=\"text-xs text-green-700\">\r\n                    â€¢ Next to your chosen angle<br/>\r\n                    â€¢ Changes based on which angle you're studying<br/>\r\n                    â€¢ Not the hypotenuse\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-2\">ðŸ“ Example Walkthrough</h4>\r\n              <p className=\"text-sm mb-3\">\r\n                In a right triangle, if we're looking at angle A (not the 90Â° angle):\r\n              </p>\r\n              <div className=\"space-y-1 text-sm\">\r\n                <p>ðŸ”´ <strong>Hypotenuse:</strong> The side opposite the 90Â° angle (always the same)</p>\r\n                <p>ðŸ”µ <strong>Opposite to A:</strong> The side that doesn't touch angle A</p>\r\n                <p>ðŸŸ¢ <strong>Adjacent to A:</strong> The side that touches angle A (but isn't the hypotenuse)</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">âš¡ Quick Check</h3>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Which side is always the longest in a right triangle?</p>\r\n                <p className=\"text-xs text-gray-600 mt-1\">Answer: The hypotenuse (opposite the 90Â° angle)</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Do opposite and adjacent sides change?</p>\r\n                <p className=\"text-xs text-gray-600 mt-1\">Answer: Yes! They depend on which angle you're studying</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'unit-circle-intro',\r\n      type: 'concept',\r\n      title: 'Introduction to the Unit Circle',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Introduction to the Unit Circle</h2>\r\n          \r\n          <div className=\"bg-indigo-50 p-6 rounded-lg border border-indigo-200\">\r\n            <h3 className=\"font-semibold mb-4 text-indigo-800\">â­• What is the Unit Circle?</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <p className=\"mb-4\">\r\n                  The unit circle is a circle with radius 1, centered at the origin (0,0) of a coordinate plane. \r\n                  It's the most important tool in trigonometry!\r\n                </p>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <div className=\"bg-white p-3 rounded-lg\">\r\n                    <h4 className=\"font-medium text-indigo-700\">Key Properties:</h4>\r\n                    <ul className=\"text-sm mt-2 space-y-1\">\r\n                      <li>â€¢ Radius = 1 unit</li>\r\n                      <li>â€¢ Center at (0, 0)</li>\r\n                      <li>â€¢ Circumference = 2Ï€</li>\r\n                      <li>â€¢ Every point is distance 1 from center</li>\r\n                    </ul>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center bg-white p-4 rounded-lg\">\r\n                <div className=\"text-6xl mb-2\">â­•</div>\r\n                <p className=\"text-xs text-gray-600\">\r\n                  The unit circle - radius = 1\r\n                </p>\r\n                <div className=\"mt-3 text-xs\">\r\n                  <p>Center: (0, 0)</p>\r\n                  <p>Any point on circle: distance 1 from center</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸŽ¯ Why is it So Important?</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Connects angles to coordinates</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Makes trig functions visual</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Works for all angles (not just 0Â°-90Â°)</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Foundation for advanced topics</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Used in physics and engineering</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Essential for understanding waves</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h4 className=\"font-semibold text-purple-800 mb-2\">ðŸ”® Preview</h4>\r\n            <p className=\"text-sm\">\r\n              Soon you'll see how every point on the unit circle gives us the values of sine and cosine for different angles. \r\n              This connection between geometry and algebra is what makes trigonometry so powerful!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'key-angles',\r\n      type: 'reference',\r\n      title: 'Important Angles to Remember',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Important Angles to Remember</h2>\r\n          \r\n          <div className=\"bg-orange-50 p-6 rounded-lg border border-orange-200\">\r\n            <h3 className=\"font-semibold mb-4 text-orange-800\">ðŸ“ The Special Angles</h3>\r\n            <p className=\"mb-4 text-sm\">\r\n              Certain angles appear frequently in trigonometry. Memorizing their values will save you time and build intuition.\r\n            </p>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              <Card className=\"bg-white border-orange-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-lg text-center\">0Â°</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-xs text-gray-600 mb-2\">Starting point</p>\r\n                  <div className=\"text-2xl mb-2\">â†’</div>\r\n                  <p className=\"text-xs\">Horizontal right</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-orange-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-lg text-center\">30Â°, 45Â°, 60Â°</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-xs text-gray-600 mb-2\">The \"special\" angles</p>\r\n                  <div className=\"text-2xl mb-2\">ðŸ“</div>\r\n                  <p className=\"text-xs\">Common in problems</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-orange-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-lg text-center\">90Â°</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-xs text-gray-600 mb-2\">Right angle</p>\r\n                  <div className=\"text-2xl mb-2\">â†‘</div>\r\n                  <p className=\"text-xs\">Vertical up</p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŒ Degrees vs. Radians</h3>\r\n            <p className=\"text-sm mb-4\">\r\n              Angles can be measured in degrees (Â°) or radians. Both are important in trigonometry.\r\n            </p>\r\n            \r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-medium text-blue-700 mb-2\">Degrees</h4>\r\n                <p className=\"text-xs mb-2\">Full circle = 360Â°</p>\r\n                <div className=\"space-y-1 text-xs\">\r\n                  <p>â€¢ 0Â° = Start</p>\r\n                  <p>â€¢ 90Â° = Quarter turn</p>\r\n                  <p>â€¢ 180Â° = Half turn</p>\r\n                  <p>â€¢ 270Â° = Three-quarters</p>\r\n                  <p>â€¢ 360Â° = Full circle</p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-medium text-blue-700 mb-2\">Radians</h4>\r\n                <p className=\"text-xs mb-2\">Full circle = 2Ï€</p>\r\n                <div className=\"space-y-1 text-xs\">\r\n                  <p>â€¢ 0 = Start</p>\r\n                  <p>â€¢ Ï€/2 = Quarter turn</p>\r\n                  <p>â€¢ Ï€ = Half turn</p>\r\n                  <p>â€¢ 3Ï€/2 = Three-quarters</p>\r\n                  <p>â€¢ 2Ï€ = Full circle</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">\r\n            <h4 className=\"font-semibold text-green-800 mb-2\">ðŸŽ¯ Study Tip</h4>\r\n            <p className=\"text-sm\">\r\n              Don't worry about memorizing everything now! Focus on understanding the concepts. \r\n              As we work through examples, these special values will become natural to you.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 3\r\n    },\r\n    {\r\n      id: 'real-world-preview',\r\n      type: 'example',\r\n      title: 'Real-World Applications Preview',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Real-World Applications Preview</h2>\r\n          \r\n          <div className=\"bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-4 text-purple-800\">ðŸŒ Where You'll Use Trigonometry</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-4\">\r\n                <Card className=\"bg-white border-blue-200\">\r\n                  <CardContent className=\"p-4\">\r\n                    <h4 className=\"font-semibold text-blue-800 mb-2\">ðŸ—ï¸ Construction & Architecture</h4>\r\n                    <p className=\"text-xs text-blue-700\">\r\n                      Calculating roof angles, stair slopes, and ensuring buildings are structurally sound.\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-green-200\">\r\n                  <CardContent className=\"p-4\">\r\n                    <h4 className=\"font-semibold text-green-800 mb-2\">ðŸ§­ Navigation</h4>\r\n                    <p className=\"text-xs text-green-700\">\r\n                      GPS systems, ship navigation, and flight paths all rely on trigonometric calculations.\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n              \r\n              <div className=\"space-y-4\">\r\n                <Card className=\"bg-white border-orange-200\">\r\n                  <CardContent className=\"p-4\">\r\n                    <h4 className=\"font-semibold text-orange-800 mb-2\">ðŸŒŠ Physics & Waves</h4>\r\n                    <p className=\"text-xs text-orange-700\">\r\n                      Sound waves, light waves, ocean waves - all described using trigonometric functions.\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-red-200\">\r\n                  <CardContent className=\"p-4\">\r\n                    <h4 className=\"font-semibold text-red-800 mb-2\">ðŸŽ® Computer Graphics</h4>\r\n                    <p className=\"text-xs text-red-700\">\r\n                      Video games, animations, and 3D modeling use trigonometry for rotations and movements.\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸŽ¯ Example Scenarios</h3>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Scenario 1: Finding Building Height</p>\r\n                <p className=\"text-xs text-gray-600 mt-1\">\r\n                  Standing 50 feet from a building, you measure a 60Â° angle to the top. How tall is the building?\r\n                </p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Scenario 2: Satellite Communication</p>\r\n                <p className=\"text-xs text-gray-600 mt-1\">\r\n                  What angle should a satellite dish point to receive the strongest signal?\r\n                </p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Scenario 3: Music & Sound</p>\r\n                <p className=\"text-xs text-gray-600 mt-1\">\r\n                  How do different musical notes create harmonies? It's all about wave frequencies!\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h4 className=\"font-semibold text-blue-800 mb-2\">ðŸš€ Your Journey Ahead</h4>\r\n            <p className=\"text-sm\">\r\n              By the end of this course, you'll have the tools to solve all these real-world problems and more. \r\n              Every concept we learn builds toward these practical applications!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'lesson-summary',\r\n      type: 'summary',\r\n      title: 'Foundation Complete: Ready for Trigonometric Ratios!',\r\n      content: (\r\n        <div className=\"space-y-4\">\r\n          <h2 className=\"text-xl font-bold\">ðŸŽ‰ Excellent! You've Built a Strong Foundation</h2>\r\n          <div className=\"bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ† What You've Mastered:</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… What trigonometry is and why it's important</li>\r\n                <li>âœ… Right triangle components (hypotenuse, opposite, adjacent)</li>\r\n                <li>âœ… How to identify triangle sides based on reference angles</li>\r\n                <li>âœ… Introduction to the unit circle concept</li>\r\n              </ul>\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… Key angles in degrees and radians</li>\r\n                <li>âœ… Real-world applications overview</li>\r\n                <li>âœ… The connection between geometry and algebra</li>\r\n                <li>âœ… Why trigonometry appears in so many fields</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŽ¯ Coming Up Next:</h3>\r\n            <p className=\"text-sm mb-3\">\r\n              Now that you understand the foundation, you're ready to learn the three fundamental trigonometric ratios:\r\n            </p>\r\n            <div className=\"grid grid-cols-3 gap-2 text-center\">\r\n              <div className=\"bg-white p-2 rounded\">\r\n                <p className=\"font-semibold text-red-600\">SINE</p>\r\n                <p className=\"text-xs\">opposite/hypotenuse</p>\r\n              </div>\r\n              <div className=\"bg-white p-2 rounded\">\r\n                <p className=\"font-semibold text-blue-600\">COSINE</p>\r\n                <p className=\"text-xs\">adjacent/hypotenuse</p>\r\n              </div>\r\n              <div className=\"bg-white p-2 rounded\">\r\n                <p className=\"font-semibold text-green-600\">TANGENT</p>\r\n                <p className=\"text-xs\">opposite/adjacent</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-2 text-purple-800\">ðŸ’¡ Key Insight</h3>\r\n            <p className=\"text-sm\">\r\n              Remember: Trigonometry is about relationships. Once you see the patterns, everything becomes much clearer. \r\n              You're building mathematical superpowers that will serve you throughout your academic and professional journey!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 3\r\n    }\r\n  ]\r\n};\r\n\r\ninterface TrigonometryIntroductionMicroLessonProps {\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst TrigonometryIntroductionMicroLesson: React.FC<TrigonometryIntroductionMicroLessonProps> = ({ onComplete }) => {\r\n  return (\r\n    <MicroLessonContainer\r\n      lessonData={trigonometryIntroductionLessonData as any}\r\n      onComplete={onComplete}\r\n    />\r\n  );\r\n};\r\n\r\nexport default TrigonometryIntroductionMicroLesson;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\trigonometry\\TrigonometryRatiosMicroLesson.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":8,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":8,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":787,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":787,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[39176,39179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[39176,39179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Calculator, Target, BookOpen, AlertCircle, CheckCircle, Trophy } from 'lucide-react';\r\nimport { MicroLessonContainer } from '@/components/micro-lessons/MicroLessonContainer';\r\n\r\nexport const trigonometryRatiosLessonData = {\r\n  id: 'trigonometry-ratios',\r\n  moduleTitle: 'Sine, Cosine, and Tangent', \r\n  totalScreens: 8,\r\n  screens: [\r\n    {\r\n      id: 'welcome',\r\n      type: 'concept' as const,\r\n      title: 'The Big Three: Sin, Cos, and Tan',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"text-center\">\r\n            <Calculator className=\"h-16 w-16 mx-auto mb-4 text-primary\" />\r\n            <h2 className=\"text-2xl font-bold mb-2\">Sine, Cosine, and Tangent</h2>\r\n            <p className=\"text-lg text-muted-foreground\">\r\n              Master the three fundamental trigonometric ratios that unlock all of trigonometry!\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"bg-gradient-to-r from-red-50 to-blue-50 p-6 rounded-lg\">\r\n            <h3 className=\"font-semibold mb-3 text-red-800\">ðŸŽ¯ What You'll Learn</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">The SOHCAHTOA mnemonic</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">How to calculate sine, cosine, tangent</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">When to use each ratio</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Step-by-step problem solving</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Calculator usage and techniques</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Real-world problem applications</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"text-center bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <AlertCircle className=\"h-8 w-8 text-yellow-600 mx-auto mb-2\" />\r\n            <p className=\"text-sm text-yellow-800\">\r\n              <strong>Get Ready!</strong> You're about to learn the most important concept in trigonometry. \r\n              Once you master these three ratios, you can solve almost any triangle problem!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 2\r\n    },\r\n    {\r\n      id: 'sohcahtoa',\r\n      type: 'concept',\r\n      title: 'SOHCAHTOA: The Magic Formula',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">SOHCAHTOA: The Magic Formula</h2>\r\n          \r\n          <div className=\"bg-red-50 p-6 rounded-lg border border-red-200\">\r\n            <div className=\"text-center mb-6\">\r\n              <h3 className=\"text-3xl font-bold text-red-600 mb-2\">SOHCAHTOA</h3>\r\n              <p className=\"text-lg text-red-600\">The most important mnemonic in trigonometry!</p>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              <Card className=\"bg-white border-red-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-lg text-center text-red-700\">SOH</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-sm font-semibold mb-2\">Sine = Opposite/Hypotenuse</p>\r\n                  <div className=\"text-xs text-gray-600\">\r\n                    <p>sin(Î¸) = O/H</p>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-blue-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-lg text-center text-blue-700\">CAH</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-sm font-semibold mb-2\">Cosine = Adjacent/Hypotenuse</p>\r\n                  <div className=\"text-xs text-gray-600\">\r\n                    <p>cos(Î¸) = A/H</p>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-lg text-center text-green-700\">TOA</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-sm font-semibold mb-2\">Tangent = Opposite/Adjacent</p>\r\n                  <div className=\"text-xs text-gray-600\">\r\n                    <p>tan(Î¸) = O/A</p>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸ§  Memory Tricks</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-purple-700 mb-2\">Classic: SOHCAHTOA</h4>\r\n                <p className=\"text-sm\">{'\"Some Old Hippie Caught Another Hippie Tripping On Acid\"'}</p>\r\n              </div>\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-purple-700 mb-2\">Alternative</h4>\r\n                <p className=\"text-sm\">{'\"Silly Old Harry Caught A Herring Trawling Off America\"'}</p>\r\n              </div>\r\n            </div>\r\n            <p className=\"text-sm text-purple-700 mt-4 text-center\">\r\n              Choose whichever phrase helps you remember best, or create your own!\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h4 className=\"font-semibold text-blue-800 mb-2\">ðŸŽ¯ The Key Insight</h4>\r\n            <p className=\"text-sm\">\r\n              These aren't just formulas - they're relationships! Each ratio tells us something specific about \r\n              the triangle's shape. The same angle in any right triangle will always give the same ratios.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'sine-explained',\r\n      type: 'concept',\r\n      title: 'Understanding Sine',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Understanding Sine</h2>\r\n          \r\n          <div className=\"bg-red-50 p-6 rounded-lg border border-red-200\">\r\n            <h3 className=\"font-semibold mb-4 text-red-800\">ðŸ“ Sine: The Vertical Component</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n                  <h4 className=\"font-bold text-red-700 text-lg mb-2\">sin(Î¸) = Opposite/Hypotenuse</h4>\r\n                  <p className=\"text-sm text-red-600\">\r\n                    Sine measures how much of the hypotenuse is in the vertical direction compared to the angle.\r\n                  </p>\r\n                </div>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-red-400\">\r\n                    <p className=\"text-sm font-medium\">When sin(Î¸) = 0.5</p>\r\n                    <p className=\"text-xs text-gray-600\">The opposite side is half the length of the hypotenuse</p>\r\n                  </div>\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-red-400\">\r\n                    <p className=\"text-sm font-medium\">When sin(Î¸) = 1</p>\r\n                    <p className=\"text-xs text-gray-600\">The triangle is \"flat\" - angle is 90Â°</p>\r\n                  </div>\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-red-400\">\r\n                    <p className=\"text-sm font-medium\">When sin(Î¸) = 0</p>\r\n                    <p className=\"text-xs text-gray-600\">The triangle is \"flat\" - angle is 0Â°</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg text-center\">\r\n                <h4 className=\"font-semibold mb-4\">Common Sine Values</h4>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <div className=\"flex justify-between items-center p-2 bg-red-50 rounded\">\r\n                    <span>sin(30Â°)</span>\r\n                    <span className=\"font-mono\">0.5</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-red-50 rounded\">\r\n                    <span>sin(45Â°)</span>\r\n                    <span className=\"font-mono\">0.707</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-red-50 rounded\">\r\n                    <span>sin(60Â°)</span>\r\n                    <span className=\"font-mono\">0.866</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-red-50 rounded\">\r\n                    <span>sin(90Â°)</span>\r\n                    <span className=\"font-mono\">1.0</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸŽ¯ When to Use Sine</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-yellow-700 mb-2\">You Know:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ An angle</li>\r\n                  <li>â€¢ The hypotenuse length</li>\r\n                </ul>\r\n                <h4 className=\"font-semibold text-yellow-700 mt-3 mb-2\">You Want:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ The opposite side length</li>\r\n                </ul>\r\n              </div>\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-yellow-700 mb-2\">Or You Know:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ The opposite side</li>\r\n                  <li>â€¢ The hypotenuse</li>\r\n                </ul>\r\n                <h4 className=\"font-semibold text-yellow-700 mt-3 mb-2\">You Want:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ The angle</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">\r\n            <h4 className=\"font-semibold text-green-800 mb-2\">ðŸ’¡ Visual Tip</h4>\r\n            <p className=\"text-sm\">\r\n              Think of sine as measuring \"height.\" If you're looking up at something, sine tells you how much \r\n              of your line of sight is vertical. This is why sine is used for heights, elevations, and vertical distances!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'cosine-explained',\r\n      type: 'concept',\r\n      title: 'Understanding Cosine',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Understanding Cosine</h2>\r\n          \r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-4 text-blue-800\">ðŸ“ Cosine: The Horizontal Component</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n                  <h4 className=\"font-bold text-blue-700 text-lg mb-2\">cos(Î¸) = Adjacent/Hypotenuse</h4>\r\n                  <p className=\"text-sm text-blue-600\">\r\n                    Cosine measures how much of the hypotenuse is in the horizontal direction relative to the angle.\r\n                  </p>\r\n                </div>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-blue-400\">\r\n                    <p className=\"text-sm font-medium\">When cos(Î¸) = 1</p>\r\n                    <p className=\"text-xs text-gray-600\">The adjacent side equals the hypotenuse (angle = 0Â°)</p>\r\n                  </div>\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-blue-400\">\r\n                    <p className=\"text-sm font-medium\">When cos(Î¸) = 0.5</p>\r\n                    <p className=\"text-xs text-gray-600\">The adjacent side is half the hypotenuse length</p>\r\n                  </div>\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-blue-400\">\r\n                    <p className=\"text-sm font-medium\">When cos(Î¸) = 0</p>\r\n                    <p className=\"text-xs text-gray-600\">No horizontal component (angle = 90Â°)</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg text-center\">\r\n                <h4 className=\"font-semibold mb-4\">Common Cosine Values</h4>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <div className=\"flex justify-between items-center p-2 bg-blue-50 rounded\">\r\n                    <span>cos(0Â°)</span>\r\n                    <span className=\"font-mono\">1.0</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-blue-50 rounded\">\r\n                    <span>cos(30Â°)</span>\r\n                    <span className=\"font-mono\">0.866</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-blue-50 rounded\">\r\n                    <span>cos(45Â°)</span>\r\n                    <span className=\"font-mono\">0.707</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-blue-50 rounded\">\r\n                    <span>cos(60Â°)</span>\r\n                    <span className=\"font-mono\">0.5</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-blue-50 rounded\">\r\n                    <span>cos(90Â°)</span>\r\n                    <span className=\"font-mono\">0.0</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸŽ¯ When to Use Cosine</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">You Know:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ An angle</li>\r\n                  <li>â€¢ The hypotenuse length</li>\r\n                </ul>\r\n                <h4 className=\"font-semibold text-green-700 mt-3 mb-2\">You Want:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ The adjacent side length</li>\r\n                </ul>\r\n              </div>\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">Or You Know:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ The adjacent side</li>\r\n                  <li>â€¢ The hypotenuse</li>\r\n                </ul>\r\n                <h4 className=\"font-semibold text-green-700 mt-3 mb-2\">You Want:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ The angle</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h4 className=\"font-semibold text-purple-800 mb-2\">ðŸ’¡ Visual Tip</h4>\r\n            <p className=\"text-sm\">\r\n              Think of cosine as measuring \"distance.\" If you're walking toward something, cosine tells you how much \r\n              of your path is horizontal. This is why cosine is used for horizontal distances, shadows, and ground coverage!\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"bg-orange-50 p-4 rounded-lg border border-orange-200\">\r\n            <h4 className=\"font-semibold text-orange-800 mb-2\">ðŸ”— Sine & Cosine Connection</h4>\r\n            <p className=\"text-sm\">\r\n              Notice: sinÂ²(Î¸) + cosÂ²(Î¸) = 1. This means sine and cosine are complementary - \r\n              they always work together to describe the complete triangle!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'tangent-explained',\r\n      type: 'concept',\r\n      title: 'Understanding Tangent',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Understanding Tangent</h2>\r\n          \r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">ðŸ“ Tangent: The Slope Ratio</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n                  <h4 className=\"font-bold text-green-700 text-lg mb-2\">tan(Î¸) = Opposite/Adjacent</h4>\r\n                  <p className=\"text-sm text-green-600\">\r\n                    Tangent measures the steepness or slope of the angle. It's the ratio of \"rise over run.\"\r\n                  </p>\r\n                </div>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                    <p className=\"text-sm font-medium\">When tan(Î¸) = 1</p>\r\n                    <p className=\"text-xs text-gray-600\">45Â° angle - rise equals run (slope = 1)</p>\r\n                  </div>\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                    <p className=\"text-sm font-medium\">When tan(Î¸) {'>'}; 1</p>\r\n                    <p className=\"text-xs text-gray-600\">Steep angle - more rise than run</p>\r\n                  </div>\r\n                  <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                    <p className=\"text-sm font-medium\">When tan(Î¸) {'<'} 1</p>\r\n                    <p className=\"text-xs text-gray-600\">Shallow angle - more run than rise</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg text-center\">\r\n                <h4 className=\"font-semibold mb-4\">Common Tangent Values</h4>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <div className=\"flex justify-between items-center p-2 bg-green-50 rounded\">\r\n                    <span>tan(0Â°)</span>\r\n                    <span className=\"font-mono\">0.0</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-green-50 rounded\">\r\n                    <span>tan(30Â°)</span>\r\n                    <span className=\"font-mono\">0.577</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-green-50 rounded\">\r\n                    <span>tan(45Â°)</span>\r\n                    <span className=\"font-mono\">1.0</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-green-50 rounded\">\r\n                    <span>tan(60Â°)</span>\r\n                    <span className=\"font-mono\">1.732</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-2 bg-green-50 rounded\">\r\n                    <span>tan(90Â°)</span>\r\n                    <span className=\"font-mono\">âˆž</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸŽ¯ When to Use Tangent</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-yellow-700 mb-2\">Perfect for:</h4>\r\n                <ul className=\"text-sm space-y-1\">\r\n                  <li>â€¢ Finding angles of elevation</li>\r\n                  <li>â€¢ Calculating slopes and grades</li>\r\n                  <li>â€¢ When hypotenuse is unknown</li>\r\n                  <li>â€¢ Ramp and stair problems</li>\r\n                </ul>\r\n              </div>\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-yellow-700 mb-2\">Bonus Feature:</h4>\r\n                <p className=\"text-sm\">\r\n                  Tangent doesn't need the hypotenuse! If you only know the two legs of a right triangle, \r\n                  tangent can still find angles.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h4 className=\"font-semibold text-blue-800 mb-2\">ðŸ’¡ Real-World Connection</h4>\r\n            <p className=\"text-sm\">\r\n              Tangent is everywhere! Road grades (6% grade means tan(angle) = 0.06), roof pitches \r\n              (4:12 pitch means tan(angle) = 4/12), and even smartphone tilt sensors use tangent values.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h4 className=\"font-semibold text-purple-800 mb-2\">ðŸ”— Special Relationship</h4>\r\n            <p className=\"text-sm\">\r\n              Here's a secret: tan(Î¸) = sin(Î¸)/cos(Î¸). Tangent is actually just sine divided by cosine! \r\n              This relationship will become very useful later.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'problem-solving-steps',\r\n      type: 'example',\r\n      title: 'Step-by-Step Problem Solving',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Step-by-Step Problem Solving</h2>\r\n          \r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-4 text-purple-800\">ðŸŽ¯ The Universal Method</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-4\">\r\n                <Card className=\"bg-white border-purple-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-purple-700\">Step 1: Draw & Label</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <p className=\"text-xs\">\r\n                      â€¢ Draw the right triangle<br/>\r\n                      â€¢ Mark the right angle<br/>\r\n                      â€¢ Label known sides/angles<br/>\r\n                      â€¢ Mark what you're looking for\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-purple-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-purple-700\">Step 2: Identify</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <p className=\"text-xs\">\r\n                      â€¢ Which angle are you using?<br/>\r\n                      â€¢ Which sides are opposite, adjacent, hypotenuse?<br/>\r\n                      â€¢ What do you know? What do you need?\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n              \r\n              <div className=\"space-y-4\">\r\n                <Card className=\"bg-white border-purple-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-purple-700\">Step 3: Choose Ratio</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <p className=\"text-xs\">\r\n                      â€¢ SOH: Use sine (O/H)<br/>\r\n                      â€¢ CAH: Use cosine (A/H)<br/>\r\n                      â€¢ TOA: Use tangent (O/A)<br/>\r\n                      â€¢ Pick the one matching your known/unknown\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-purple-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-purple-700\">Step 4: Solve</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <p className=\"text-xs\">\r\n                      â€¢ Set up the equation<br/>\r\n                      â€¢ Substitute known values<br/>\r\n                      â€¢ Solve for the unknown<br/>\r\n                      â€¢ Check your answer makes sense\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">ðŸ“ Example Problem</h3>\r\n            <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n              <p className=\"text-sm font-medium mb-2\">\r\n                A ladder leans against a wall at a 60Â° angle. The ladder is 10 feet long. How high up the wall does it reach?\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-3\">\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                  <p className=\"font-semibold text-sm\">Step 1: Draw & Label</p>\r\n                  <p className=\"text-xs\">Right triangle: wall, ground, ladder. Angle = 60Â°, hypotenuse = 10 ft</p>\r\n                </div>\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                  <p className=\"font-semibold text-sm\">Step 2: Identify</p>\r\n                  <p className=\"text-xs\">Want: height (opposite to 60Â°). Know: hypotenuse = 10 ft</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-3\">\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                  <p className=\"font-semibold text-sm\">Step 3: Choose Ratio</p>\r\n                  <p className=\"text-xs\">Need opposite/hypotenuse = sine. Use SOH!</p>\r\n                </div>\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                  <p className=\"font-semibold text-sm\">Step 4: Solve</p>\r\n                  <p className=\"text-xs\">sin(60Â°) = height/10<br/>height = 10 Ã— sin(60Â°) = 10 Ã— 0.866 = 8.66 ft</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <h4 className=\"font-semibold text-yellow-800 mb-2\">ðŸŽ¯ Pro Tips</h4>\r\n            <ul className=\"text-sm space-y-1\">\r\n              <li>â€¢ Always draw a diagram - it prevents confusion</li>\r\n              <li>â€¢ Label everything you know before choosing a formula</li>\r\n              <li>â€¢ Double-check which side is opposite/adjacent to your angle</li>\r\n              <li>â€¢ Make sure your calculator is in the right mode (degrees vs radians)</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'calculator-tips',\r\n      type: 'example',\r\n      title: 'Calculator Usage and Inverse Functions',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Calculator Usage and Inverse Functions</h2>\r\n          \r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-4 text-blue-800\">ðŸ”¢ Calculator Basics</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-4\">\r\n                <Card className=\"bg-white border-blue-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-blue-700\">Finding Ratios</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <div className=\"space-y-2 text-xs\">\r\n                      <p><strong>sin(30Â°):</strong> 30 [SIN] = 0.5</p>\r\n                      <p><strong>cos(45Â°):</strong> 45 [COS] = 0.707</p>\r\n                      <p><strong>tan(60Â°):</strong> 60 [TAN] = 1.732</p>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-blue-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-blue-700\">Mode Check</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <p className=\"text-xs\">\r\n                      Always verify: DEG mode for degrees, RAD mode for radians. \r\n                      Most problems use degrees unless specified otherwise.\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n              \r\n              <div className=\"space-y-4\">\r\n                <Card className=\"bg-white border-red-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-red-700\">Finding Angles (Inverse)</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <div className=\"space-y-2 text-xs\">\r\n                      <p><strong>sinâ»Â¹(0.5):</strong> 0.5 [SINâ»Â¹] = 30Â°</p>\r\n                      <p><strong>cosâ»Â¹(0.707):</strong> 0.707 [COSâ»Â¹] = 45Â°</p>\r\n                      <p><strong>tanâ»Â¹(1.732):</strong> 1.732 [TANâ»Â¹] = 60Â°</p>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-red-200\">\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-sm text-red-700\">Inverse Notation</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"pt-0\">\r\n                    <p className=\"text-xs\">\r\n                      sinâ»Â¹, arcsin, asin all mean the same thing. Different calculators use different notation.\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">ðŸ”„ Forward vs. Inverse Functions</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">Forward (Angle â†’ Ratio)</h4>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <p><strong>Given:</strong> Angle</p>\r\n                  <p><strong>Find:</strong> Trigonometric ratio</p>\r\n                  <p><strong>Use:</strong> sin, cos, tan buttons</p>\r\n                  <p><strong>Example:</strong> sin(30Â°) = 0.5</p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">Inverse (Ratio â†’ Angle)</h4>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <p><strong>Given:</strong> Trigonometric ratio</p>\r\n                  <p><strong>Find:</strong> Angle</p>\r\n                  <p><strong>Use:</strong> sinâ»Â¹, cosâ»Â¹, tanâ»Â¹ buttons</p>\r\n                  <p><strong>Example:</strong> sinâ»Â¹(0.5) = 30Â°</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">âš¡ Quick Practice</h3>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Try this: What's cos(60Â°)?</p>\r\n                <p className=\"text-xs text-gray-600 mt-1\">Answer: 0.5 (or exactly 1/2)</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-yellow-400\">\r\n                <p className=\"text-sm font-medium\">Now try: What angle has sin(Î¸) = 0.707?</p>\r\n                <p className=\"text-xs text-gray-600 mt-1\">Answer: Î¸ = sinâ»Â¹(0.707) = 45Â°</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-red-50 p-4 rounded-lg border border-red-200\">\r\n            <h4 className=\"font-semibold text-red-800 mb-2\">âš ï¸ Common Calculator Mistakes</h4>\r\n            <ul className=\"text-sm space-y-1\">\r\n              <li>â€¢ Wrong mode (degrees vs radians)</li>\r\n              <li>â€¢ Forgetting parentheses: sin(30Â°) not sin30Â°</li>\r\n              <li>â€¢ Confusing sinâ»Â¹ with 1/sin (they're different!)</li>\r\n              <li>â€¢ Not checking if answers make sense</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'lesson-summary',\r\n      type: 'summary',\r\n      title: \"SOHCAHTOA Mastered: You're Ready for Advanced Trigonometry!\",\r\n      content: (\r\n        <div className=\"space-y-4\">\r\n          <h2 className=\"text-xl font-bold\">ðŸŽ‰ Outstanding! You've Mastered the Foundation of Trigonometry</h2>\r\n          <div className=\"bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ† What You've Conquered:</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… SOHCAHTOA mnemonic and its meaning</li>\r\n                <li>âœ… Sine: opposite/hypotenuse relationship</li>\r\n                <li>âœ… Cosine: adjacent/hypotenuse relationship</li>\r\n                <li>âœ… Tangent: opposite/adjacent relationship</li>\r\n              </ul>\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… When to use each trigonometric ratio</li>\r\n                <li>âœ… Step-by-step problem-solving method</li>\r\n                <li>âœ… Calculator techniques and inverse functions</li>\r\n                <li>âœ… Common values and practical applications</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŽ¯ Your Trigonometric Arsenal:</h3>\r\n            <div className=\"grid grid-cols-3 gap-2 text-center text-sm\">\r\n              <div className=\"bg-white p-3 rounded border border-red-200\">\r\n                <p className=\"font-bold text-red-600\">SINE</p>\r\n                <p className=\"text-xs\">Height finder</p>\r\n                <p className=\"text-xs\">Vertical component</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border border-blue-200\">\r\n                <p className=\"font-bold text-blue-600\">COSINE</p>\r\n                <p className=\"text-xs\">Distance finder</p>\r\n                <p className=\"text-xs\">Horizontal component</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border border-green-200\">\r\n                <p className=\"font-bold text-green-600\">TANGENT</p>\r\n                <p className=\"text-xs\">Slope finder</p>\r\n                <p className=\"text-xs\">Steepness measure</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸš€ Coming Up Next:</h3>\r\n            <p className=\"text-sm mb-3\">\r\n              Now that you're a SOHCAHTOA expert, you're ready to explore how these ratios work on the unit circle, \r\n              opening up a whole new world of possibilities:\r\n            </p>\r\n            <ul className=\"text-xs space-y-1\">\r\n              <li>â€¢ Understanding angles beyond 90Â°</li>\r\n              <li>â€¢ Visualizing trig functions on the coordinate plane</li>\r\n              <li>â€¢ Connecting geometry with algebra</li>\r\n              <li>â€¢ Preparing for graphing and periodic functions</li>\r\n            </ul>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-2 text-yellow-800\">ðŸ’ª Power User Status Unlocked!</h3>\r\n            <p className=\"text-sm\">\r\n              You can now solve any right triangle problem! Whether it's finding missing sides, calculating angles, \r\n              or tackling real-world applications, you have the tools. The mathematical universe just got a lot more accessible!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 3\r\n    }\r\n  ]\r\n};\r\n\r\ninterface TrigonometryRatiosMicroLessonProps {\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst TrigonometryRatiosMicroLesson: React.FC<TrigonometryRatiosMicroLessonProps> = ({ onComplete }) => {\r\n  return (\r\n    <MicroLessonContainer\r\n      lessonData={trigonometryRatiosLessonData as any}\r\n      onComplete={onComplete}\r\n    />\r\n  );\r\n};\r\n\r\nexport default TrigonometryRatiosMicroLesson;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\trigonometry\\TrigonometryUnitCircleMicroLesson.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":8,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":8,"endColumn":46},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":734,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":734,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37909,37912],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37909,37912],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Circle, Target, Compass, RotateCcw, Navigation, Award } from 'lucide-react';\r\nimport { MicroLessonContainer } from '@/components/micro-lessons/MicroLessonContainer';\r\n\r\nexport const trigonometryUnitCircleLessonData = {\r\n  id: 'trigonometry-unit-circle',\r\n  moduleTitle: 'Trigonometric Functions on the Unit Circle', \r\n  totalScreens: 8,\r\n  screens: [\r\n    {\r\n      id: 'welcome',\r\n      type: 'concept' as const,\r\n      title: 'The Unit Circle: Your Trigonometry GPS',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"text-center\">\r\n            <Circle className=\"h-16 w-16 mx-auto mb-4 text-primary\" />\r\n            <h2 className=\"text-2xl font-bold mb-2\">Trigonometric Functions on the Unit Circle</h2>\r\n            <p className=\"text-lg text-muted-foreground\">\r\n              Discover how the unit circle transforms trigonometry from triangles to coordinates!\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-lg\">\r\n            <h3 className=\"font-semibold mb-3 text-indigo-800\">ðŸŽ¯ What You'll Master</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-indigo-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Unit circle coordinates and angles</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-indigo-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">How sine and cosine become coordinates</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-indigo-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Reference angles and symmetry</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-purple-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Angles beyond 90Â° (quadrants)</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-purple-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Special angle values and patterns</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-2 h-2 bg-purple-500 rounded-full\"></div>\r\n                  <span className=\"text-sm\">Connecting circles to triangles</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"text-center bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <Target className=\"h-8 w-8 text-yellow-600 mx-auto mb-2\" />\r\n            <p className=\"text-sm text-yellow-800\">\r\n              <strong>Game Changer Ahead!</strong> The unit circle is where trigonometry becomes truly powerful. \r\n              You'll see how everything connects and why trig functions work for any angle!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 2\r\n    },\r\n    {\r\n      id: 'unit-circle-setup',\r\n      type: 'concept',\r\n      title: 'Setting Up the Unit Circle',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Setting Up the Unit Circle</h2>\r\n          \r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-4 text-blue-800\">â­• The Perfect Circle</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <p className=\"mb-4\">\r\n                  The unit circle is a circle with radius 1, centered at the origin (0,0). \r\n                  Every point on this circle is exactly 1 unit away from the center.\r\n                </p>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <div className=\"bg-white p-3 rounded-lg\">\r\n                    <h4 className=\"font-medium text-blue-700\">Key Properties:</h4>\r\n                    <ul className=\"text-sm mt-2 space-y-1\">\r\n                      <li>â€¢ Center: (0, 0)</li>\r\n                      <li>â€¢ Radius: 1 unit</li>\r\n                      <li>â€¢ Equation: xÂ² + yÂ² = 1</li>\r\n                      <li>â€¢ Circumference: 2Ï€ â‰ˆ 6.28</li>\r\n                    </ul>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center bg-white p-4 rounded-lg\">\r\n                <div className=\"text-8xl mb-2\">â­•</div>\r\n                <p className=\"text-xs text-gray-600 mb-3\">The Unit Circle</p>\r\n                <div className=\"text-xs space-y-1\">\r\n                  <p><strong>Any point (x,y) on the circle:</strong></p>\r\n                  <p>Distance from center = âˆš(xÂ² + yÂ²) = 1</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ“ Coordinate Connection</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">Starting Point: (1, 0)</h4>\r\n                <p className=\"text-sm\">\r\n                  We start at the rightmost point of the circle: (1, 0). This corresponds to 0Â° or 0 radians.\r\n                </p>\r\n              </div>\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">Moving Counterclockwise</h4>\r\n                <p className=\"text-sm\">\r\n                  As we rotate counterclockwise, we create angles and trace out points on the circle.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸŽ¯ The Magic Connection</h3>\r\n            <div className=\"bg-white p-4 rounded-lg text-center\">\r\n              <p className=\"text-lg font-semibold mb-2\">For any angle Î¸ on the unit circle:</p>\r\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                <div className=\"bg-red-50 p-3 rounded border border-red-200\">\r\n                  <p className=\"font-semibold text-red-700\">x-coordinate = cos(Î¸)</p>\r\n                  <p className=\"text-xs text-red-600\">Horizontal position</p>\r\n                </div>\r\n                <div className=\"bg-blue-50 p-3 rounded border border-blue-200\">\r\n                  <p className=\"font-semibold text-blue-700\">y-coordinate = sin(Î¸)</p>\r\n                  <p className=\"text-xs text-blue-600\">Vertical position</p>\r\n                </div>\r\n              </div>\r\n              <p className=\"text-xs text-purple-600 mt-3\">\r\n                This is the fundamental connection that makes everything work!\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <h4 className=\"font-semibold text-yellow-800 mb-2\">ðŸ’¡ Why This Matters</h4>\r\n            <p className=\"text-sm\">\r\n              Now trigonometry isn't limited to right triangles! We can find sine and cosine values for ANY angle - \r\n              even angles larger than 90Â° or negative angles. The unit circle is our universal tool.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 4\r\n    },\r\n    {\r\n      id: 'coordinates-and-angles',\r\n      type: 'example',\r\n      title: 'Coordinates and Angles',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Coordinates and Angles</h2>\r\n          \r\n          <div className=\"bg-indigo-50 p-6 rounded-lg border border-indigo-200\">\r\n            <h3 className=\"font-semibold mb-4 text-indigo-800\">ðŸ“ Key Angle Positions</h3>\r\n            \r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n              <Card className=\"bg-white border-red-200 text-center\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-red-700\">0Â° (0)</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <p className=\"text-xs font-mono\">(1, 0)</p>\r\n                  <p className=\"text-xs text-gray-600\">Start/East</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-blue-200 text-center\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-blue-700\">90Â° (Ï€/2)</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <p className=\"text-xs font-mono\">(0, 1)</p>\r\n                  <p className=\"text-xs text-gray-600\">Top/North</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200 text-center\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-green-700\">180Â° (Ï€)</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <p className=\"text-xs font-mono\">(-1, 0)</p>\r\n                  <p className=\"text-xs text-gray-600\">Left/West</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-purple-200 text-center\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-sm text-purple-700\">270Â° (3Ï€/2)</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <p className=\"text-xs font-mono\">(0, -1)</p>\r\n                  <p className=\"text-xs text-gray-600\">Bottom/South</p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold mb-3\">ðŸŽ¯ Reading Coordinates</h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <p><strong>At 0Â°:</strong> cos(0Â°) = 1, sin(0Â°) = 0 â†’ Point (1, 0)</p>\r\n                <p><strong>At 90Â°:</strong> cos(90Â°) = 0, sin(90Â°) = 1 â†’ Point (0, 1)</p>\r\n                <p><strong>At 180Â°:</strong> cos(180Â°) = -1, sin(180Â°) = 0 â†’ Point (-1, 0)</p>\r\n                <p><strong>At 270Â°:</strong> cos(270Â°) = 0, sin(270Â°) = -1 â†’ Point (0, -1)</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">ðŸ”„ Special Angles in All Quadrants</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">30Â° Family</h4>\r\n                <div className=\"space-y-1 text-xs\">\r\n                  <p><strong>30Â°:</strong> (âˆš3/2, 1/2)</p>\r\n                  <p><strong>150Â°:</strong> (-âˆš3/2, 1/2)</p>\r\n                  <p><strong>210Â°:</strong> (-âˆš3/2, -1/2)</p>\r\n                  <p><strong>330Â°:</strong> (âˆš3/2, -1/2)</p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">45Â° Family</h4>\r\n                <div className=\"space-y-1 text-xs\">\r\n                  <p><strong>45Â°:</strong> (âˆš2/2, âˆš2/2)</p>\r\n                  <p><strong>135Â°:</strong> (-âˆš2/2, âˆš2/2)</p>\r\n                  <p><strong>225Â°:</strong> (-âˆš2/2, -âˆš2/2)</p>\r\n                  <p><strong>315Â°:</strong> (âˆš2/2, -âˆš2/2)</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-yellow-50 p-3 rounded-lg mt-4 border border-yellow-200\">\r\n              <p className=\"text-sm text-yellow-800\">\r\n                <strong>Pattern Recognition:</strong> Notice how the same values appear in different quadrants, \r\n                just with different signs! This symmetry makes the unit circle predictable.\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h4 className=\"font-semibold text-blue-800 mb-2\">ðŸ§­ Navigation Tip</h4>\r\n            <p className=\"text-sm\">\r\n              Think of the unit circle like a compass: East is 0Â°, North is 90Â°, West is 180Â°, South is 270Â°. \r\n              The coordinates tell you exactly where you are on your circular journey!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'quadrants-and-signs',\r\n      type: 'concept',\r\n      title: 'Quadrants and Sign Patterns',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Quadrants and Sign Patterns</h2>\r\n          \r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-4 text-purple-800\">ðŸ—ºï¸ The Four Quadrants</h3>\r\n            \r\n            <div className=\"grid grid-cols-2 gap-4 mb-6\">\r\n              <Card className=\"bg-white border-blue-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-center text-blue-700\">Quadrant I</CardTitle>\r\n                  <p className=\"text-center text-xs text-blue-600\">0Â° to 90Â°</p>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-sm mb-2\">Both x and y positive</p>\r\n                  <p className=\"text-xs font-mono\">cos(Î¸) {'>'}; 0, sin(Î¸) {'>'}; 0</p>\r\n                  <p className=\"text-xs text-green-600 mt-2\">âœ… All trig functions positive</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-red-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-center text-red-700\">Quadrant II</CardTitle>\r\n                  <p className=\"text-center text-xs text-red-600\">90Â° to 180Â°</p>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-sm mb-2\">x negative, y positive</p>\r\n                  <p className=\"text-xs font-mono\">cos(Î¸) {'<'} 0, sin(Î¸) {'>'}; 0</p>\r\n                  <p className=\"text-xs text-blue-600 mt-2\">âœ… Only sine positive</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-orange-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-center text-orange-700\">Quadrant III</CardTitle>\r\n                  <p className=\"text-center text-xs text-orange-600\">180Â° to 270Â°</p>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-sm mb-2\">Both x and y negative</p>\r\n                  <p className=\"text-xs font-mono\">cos(Î¸) {'<'} 0, sin(Î¸) {'<'} 0</p>\r\n                  <p className=\"text-xs text-green-600 mt-2\">âœ… Only tangent positive</p>\r\n                </CardContent>\r\n              </Card>\r\n              \r\n              <Card className=\"bg-white border-green-200\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-center text-green-700\">Quadrant IV</CardTitle>\r\n                  <p className=\"text-center text-xs text-green-600\">270Â° to 360Â°</p>\r\n                </CardHeader>\r\n                <CardContent className=\"text-center\">\r\n                  <p className=\"text-sm mb-2\">x positive, y negative</p>\r\n                  <p className=\"text-xs font-mono\">cos(Î¸) {'>'}; 0, sin(Î¸) {'<'} 0</p>\r\n                  <p className=\"text-xs text-blue-600 mt-2\">âœ… Only cosine positive</p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-6 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-3 text-yellow-800\">ðŸŽ¯ ASTC Memory Device</h3>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-center text-sm\">\r\n              <div className=\"bg-white p-2 rounded border border-green-200\">\r\n                <p className=\"font-bold text-green-600\">A</p>\r\n                <p className=\"text-xs\">All positive</p>\r\n                <p className=\"text-xs\">(Quadrant I)</p>\r\n              </div>\r\n              <div className=\"bg-white p-2 rounded border border-blue-200\">\r\n                <p className=\"font-bold text-blue-600\">S</p>\r\n                <p className=\"text-xs\">Sine positive</p>\r\n                <p className=\"text-xs\">(Quadrant II)</p>\r\n              </div>\r\n              <div className=\"bg-white p-2 rounded border border-orange-200\">\r\n                <p className=\"font-bold text-orange-600\">T</p>\r\n                <p className=\"text-xs\">Tangent positive</p>\r\n                <p className=\"text-xs\">(Quadrant III)</p>\r\n              </div>\r\n              <div className=\"bg-white p-2 rounded border border-red-200\">\r\n                <p className=\"font-bold text-red-600\">C</p>\r\n                <p className=\"text-xs\">Cosine positive</p>\r\n                <p className=\"text-xs\">(Quadrant IV)</p>\r\n              </div>\r\n            </div>\r\n            <p className=\"text-sm text-yellow-700 mt-4 text-center\">\r\n              <strong>Memory phrase:</strong> \"All Students Take Calculus\" or \"All Smart Teachers Care\"\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸ“ Examples in Each Quadrant</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-3\">\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-blue-400\">\r\n                  <p className=\"text-sm font-medium\">120Â° (Quadrant II)</p>\r\n                  <p className=\"text-xs\">sin(120Â°) = âˆš3/2 (positive)</p>\r\n                  <p className=\"text-xs\">cos(120Â°) = -1/2 (negative)</p>\r\n                </div>\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-orange-400\">\r\n                  <p className=\"text-sm font-medium\">240Â° (Quadrant III)</p>\r\n                  <p className=\"text-xs\">sin(240Â°) = -âˆš3/2 (negative)</p>\r\n                  <p className=\"text-xs\">cos(240Â°) = -1/2 (negative)</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-3\">\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                  <p className=\"text-sm font-medium\">300Â° (Quadrant IV)</p>\r\n                  <p className=\"text-xs\">sin(300Â°) = -âˆš3/2 (negative)</p>\r\n                  <p className=\"text-xs\">cos(300Â°) = 1/2 (positive)</p>\r\n                </div>\r\n                <div className=\"bg-white p-3 rounded border-l-4 border-blue-400\">\r\n                  <p className=\"text-sm font-medium\">60Â° (Quadrant I)</p>\r\n                  <p className=\"text-xs\">sin(60Â°) = âˆš3/2 (positive)</p>\r\n                  <p className=\"text-xs\">cos(60Â°) = 1/2 (positive)</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">\r\n            <h4 className=\"font-semibold text-green-800 mb-2\">ðŸ’¡ Quick Sign Check</h4>\r\n            <p className=\"text-sm\">\r\n              Before calculating any trig value, determine which quadrant your angle is in. \r\n              This tells you immediately whether your answer should be positive or negative!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'reference-angles',\r\n      type: 'concept',\r\n      title: 'Reference Angles and Symmetry',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Reference Angles and Symmetry</h2>\r\n          \r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-4 text-green-800\">ðŸ”„ What Are Reference Angles?</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n                  <p className=\"text-sm mb-3\">\r\n                    A <strong>reference angle</strong> is the acute angle (0Â° to 90Â°) that an angle makes with the x-axis. \r\n                    It's always positive and always between 0Â° and 90Â°.\r\n                  </p>\r\n                  <div className=\"text-xs space-y-1\">\r\n                    <p><strong>Purpose:</strong> Find trig values using symmetry</p>\r\n                    <p><strong>Rule:</strong> |sin Î¸| = sin(reference angle)</p>\r\n                    <p><strong>Rule:</strong> |cos Î¸| = cos(reference angle)</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-green-700 mb-2\">Finding Reference Angles</h4>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <p><strong>Quadrant I:</strong> Î¸ itself</p>\r\n                  <p><strong>Quadrant II:</strong> 180Â° - Î¸</p>\r\n                  <p><strong>Quadrant III:</strong> Î¸ - 180Â°</p>\r\n                  <p><strong>Quadrant IV:</strong> 360Â° - Î¸</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-4 text-blue-800\">ðŸ“ Reference Angle Examples</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-3\">\r\n                <Card className=\"bg-white border-blue-200\">\r\n                  <CardContent className=\"p-3\">\r\n                    <p className=\"text-sm font-medium\">150Â° (Quadrant II)</p>\r\n                    <p className=\"text-xs\">Reference angle = 180Â° - 150Â° = 30Â°</p>\r\n                    <p className=\"text-xs text-blue-600\">So sin(150Â°) = sin(30Â°) = 1/2</p>\r\n                    <p className=\"text-xs text-blue-600\">But cos(150Â°) = -cos(30Â°) = -âˆš3/2</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-blue-200\">\r\n                  <CardContent className=\"p-3\">\r\n                    <p className=\"text-sm font-medium\">225Â° (Quadrant III)</p>\r\n                    <p className=\"text-xs\">Reference angle = 225Â° - 180Â° = 45Â°</p>\r\n                    <p className=\"text-xs text-blue-600\">So |sin(225Â°)| = sin(45Â°) = âˆš2/2</p>\r\n                    <p className=\"text-xs text-blue-600\">But sin(225Â°) = -âˆš2/2 (negative in Q III)</p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n              \r\n              <div className=\"space-y-3\">\r\n                <Card className=\"bg-white border-blue-200\">\r\n                  <CardContent className=\"p-3\">\r\n                    <p className=\"text-sm font-medium\">315Â° (Quadrant IV)</p>\r\n                    <p className=\"text-xs\">Reference angle = 360Â° - 315Â° = 45Â°</p>\r\n                    <p className=\"text-xs text-blue-600\">So cos(315Â°) = cos(45Â°) = âˆš2/2</p>\r\n                    <p className=\"text-xs text-blue-600\">But sin(315Â°) = -sin(45Â°) = -âˆš2/2</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-blue-200\">\r\n                  <CardContent className=\"p-3\">\r\n                    <p className=\"text-sm font-medium\">120Â° (Quadrant II)</p>\r\n                    <p className=\"text-xs\">Reference angle = 180Â° - 120Â° = 60Â°</p>\r\n                    <p className=\"text-xs text-blue-600\">So sin(120Â°) = sin(60Â°) = âˆš3/2</p>\r\n                    <p className=\"text-xs text-blue-600\">But cos(120Â°) = -cos(60Â°) = -1/2</p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸŽ¯ The Reference Angle Method</h3>\r\n            <div className=\"bg-white p-4 rounded-lg\">\r\n              <ol className=\"text-sm space-y-2\">\r\n                <li><strong>Step 1:</strong> Determine which quadrant your angle is in</li>\r\n                <li><strong>Step 2:</strong> Find the reference angle using the quadrant rules</li>\r\n                <li><strong>Step 3:</strong> Find the trig value of the reference angle</li>\r\n                <li><strong>Step 4:</strong> Apply the correct sign based on the quadrant (ASTC)</li>\r\n              </ol>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-orange-50 p-6 rounded-lg border border-orange-200\">\r\n            <h3 className=\"font-semibold mb-3 text-orange-800\">ðŸ” Symmetry Patterns</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-orange-700 mb-2\">Even/Odd Functions</h4>\r\n                <div className=\"text-xs space-y-1\">\r\n                  <p><strong>Cosine is even:</strong> cos(-Î¸) = cos(Î¸)</p>\r\n                  <p><strong>Sine is odd:</strong> sin(-Î¸) = -sin(Î¸)</p>\r\n                  <p><strong>Tangent is odd:</strong> tan(-Î¸) = -tan(Î¸)</p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-white p-4 rounded-lg\">\r\n                <h4 className=\"font-semibold text-orange-700 mb-2\">Complementary Angles</h4>\r\n                <div className=\"text-xs space-y-1\">\r\n                  <p><strong>sin(90Â° - Î¸) = cos(Î¸)</strong></p>\r\n                  <p><strong>cos(90Â° - Î¸) = sin(Î¸)</strong></p>\r\n                  <p>This is why 30Â° and 60Â° have \"swapped\" values!</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <h4 className=\"font-semibold text-yellow-800 mb-2\">âš¡ Power Move</h4>\r\n            <p className=\"text-sm\">\r\n              With reference angles, you only need to memorize the trig values for 30Â°, 45Â°, and 60Â°. \r\n              Every other special angle can be found using symmetry!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'beyond-90-degrees',\r\n      type: 'example',\r\n      title: 'Angles Beyond 90Â°',\r\n      content: (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-xl font-bold\">Angles Beyond 90Â°</h2>\r\n          \r\n          <div className=\"bg-red-50 p-6 rounded-lg border border-red-200\">\r\n            <h3 className=\"font-semibold mb-4 text-red-800\">ðŸš€ Breaking the 90Â° Barrier</h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <p className=\"mb-4\">\r\n                  With the unit circle, we're no longer limited to right triangles! We can find trigonometric \r\n                  values for any angle - even negative angles or angles greater than 360Â°.\r\n                </p>\r\n                \r\n                <div className=\"bg-white p-4 rounded-lg\">\r\n                  <h4 className=\"font-medium text-red-700 mb-2\">Types of Angles:</h4>\r\n                  <ul className=\"text-sm space-y-1\">\r\n                    <li>â€¢ <strong>Acute:</strong> 0Â° to 90Â°</li>\r\n                    <li>â€¢ <strong>Obtuse:</strong> 90Â° to 180Â°</li>\r\n                    <li>â€¢ <strong>Reflex:</strong> 180Â° to 360Â°</li>\r\n                    <li>â€¢ <strong>Negative:</strong> Clockwise rotation</li>\r\n                    <li>â€¢ <strong>Coterminal:</strong> Differ by 360Â°</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"space-y-4\">\r\n                <Card className=\"bg-white border-red-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">450Â° Example</p>\r\n                    <p className=\"text-xs\">450Â° = 360Â° + 90Â°</p>\r\n                    <p className=\"text-xs\">So 450Â° and 90Â° are coterminal</p>\r\n                    <p className=\"text-xs text-red-600\">sin(450Â°) = sin(90Â°) = 1</p>\r\n                  </CardContent>\r\n                </Card>\r\n                \r\n                <Card className=\"bg-white border-red-200\">\r\n                  <CardContent className=\"p-3 text-center\">\r\n                    <p className=\"text-sm font-medium\">-30Â° Example</p>\r\n                    <p className=\"text-xs\">-30Â° = 360Â° - 30Â° = 330Â°</p>\r\n                    <p className=\"text-xs\">Clockwise 30Â° = Counterclockwise 330Â°</p>\r\n                    <p className=\"text-xs text-red-600\">cos(-30Â°) = cos(330Â°) = âˆš3/2</p>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-4 text-blue-800\">ðŸ”„ Coterminal Angles</h3>\r\n            \r\n            <div className=\"bg-white p-4 rounded-lg mb-4\">\r\n              <p className=\"text-sm mb-3\">\r\n                <strong>Coterminal angles</strong> end at the same position on the unit circle. \r\n                They have identical trig values.\r\n              </p>\r\n              <p className=\"text-xs\">\r\n                <strong>Rule:</strong> Add or subtract 360Â° (or 2Ï€ radians) to find coterminal angles.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n              <div className=\"bg-white p-3 rounded text-center\">\r\n                <p className=\"text-sm font-medium\">45Â°</p>\r\n                <p className=\"text-xs\">405Â°, 765Â°, -315Â°</p>\r\n                <p className=\"text-xs text-blue-600\">All have same trig values</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded text-center\">\r\n                <p className=\"text-sm font-medium\">60Â°</p>\r\n                <p className=\"text-xs\">420Â°, 780Â°, -300Â°</p>\r\n                <p className=\"text-xs text-blue-600\">All have same trig values</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded text-center\">\r\n                <p className=\"text-sm font-medium\">30Â°</p>\r\n                <p className=\"text-xs\">390Â°, 750Â°, -330Â°</p>\r\n                <p className=\"text-xs text-blue-600\">All have same trig values</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ“ Extended Angle Examples</h3>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                <p className=\"text-sm font-medium\">Find sin(210Â°)</p>\r\n                <p className=\"text-xs\">210Â° is in Quadrant III (180Â° to 270Â°)</p>\r\n                <p className=\"text-xs\">Reference angle = 210Â° - 180Â° = 30Â°</p>\r\n                <p className=\"text-xs\">sin(210Â°) = -sin(30Â°) = -1/2 (negative in Q III)</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                <p className=\"text-sm font-medium\">Find cos(300Â°)</p>\r\n                <p className=\"text-xs\">300Â° is in Quadrant IV (270Â° to 360Â°)</p>\r\n                <p className=\"text-xs\">Reference angle = 360Â° - 300Â° = 60Â°</p>\r\n                <p className=\"text-xs\">cos(300Â°) = cos(60Â°) = 1/2 (positive in Q IV)</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border-l-4 border-green-400\">\r\n                <p className=\"text-sm font-medium\">Find tan(135Â°)</p>\r\n                <p className=\"text-xs\">135Â° is in Quadrant II (90Â° to 180Â°)</p>\r\n                <p className=\"text-xs\">Reference angle = 180Â° - 135Â° = 45Â°</p>\r\n                <p className=\"text-xs\">tan(135Â°) = -tan(45Â°) = -1 (negative in Q II)</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h4 className=\"font-semibold text-purple-800 mb-2\">ðŸŽ¯ The Big Picture</h4>\r\n            <p className=\"text-sm\">\r\n              The unit circle extends trigonometry from simple right triangles to all rotational motion. \r\n              This foundation enables us to model waves, oscillations, and periodic phenomena in science and engineering!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 5\r\n    },\r\n    {\r\n      id: 'lesson-summary',\r\n      type: 'summary',\r\n      title: \"Unit Circle Mastery: You are Ready for Advanced Applications!\",\r\n      content: (\r\n        <div className=\"space-y-4\">\r\n          <h2 className=\"text-xl font-bold\">ðŸŽ‰ Phenomenal! You've Unlocked the Power of the Unit Circle</h2>\r\n          <div className=\"bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-lg border border-green-200\">\r\n            <h3 className=\"font-semibold mb-3 text-green-800\">ðŸ† What You've Mastered:</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… Unit circle setup and coordinate system</li>\r\n                <li>âœ… How sine and cosine become coordinates</li>\r\n                <li>âœ… The four quadrants and their properties</li>\r\n                <li>âœ… ASTC sign pattern for all functions</li>\r\n              </ul>\r\n              <ul className=\"space-y-2 text-sm\">\r\n                <li>âœ… Reference angles and symmetry principles</li>\r\n                <li>âœ… Working with angles beyond 90Â°</li>\r\n                <li>âœ… Coterminal angles and periodicity</li>\r\n                <li>âœ… Special angle values in all quadrants</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h3 className=\"font-semibold mb-3 text-blue-800\">ðŸŽ¯ Your New Superpowers:</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n              <div className=\"bg-white p-3 rounded border border-blue-200 text-center\">\r\n                <Circle className=\"h-6 w-6 mx-auto mb-2 text-blue-600\" />\r\n                <p className=\"text-sm font-semibold\">Any Angle</p>\r\n                <p className=\"text-xs\">Find trig values for any angle, positive or negative</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border border-green-200 text-center\">\r\n                <Compass className=\"h-6 w-6 mx-auto mb-2 text-green-600\" />\r\n                <p className=\"text-sm font-semibold\">Quadrant Navigation</p>\r\n                <p className=\"text-xs\">Instantly know which functions are positive/negative</p>\r\n              </div>\r\n              <div className=\"bg-white p-3 rounded border border-purple-200 text-center\">\r\n                <RotateCcw className=\"h-6 w-6 mx-auto mb-2 text-purple-600\" />\r\n                <p className=\"text-sm font-semibold\">Reference Angles</p>\r\n                <p className=\"text-xs\">Use symmetry to find any special angle value</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\r\n            <h3 className=\"font-semibold mb-3 text-purple-800\">ðŸš€ Coming Up Next:</h3>\r\n            <p className=\"text-sm mb-3\">\r\n              Now that you understand how trigonometric functions work on the unit circle, \r\n              you're ready to see them come alive as graphs:\r\n            </p>\r\n            <ul className=\"text-xs space-y-1\">\r\n              <li>â€¢ Graphing sine, cosine, and tangent functions</li>\r\n              <li>â€¢ Understanding amplitude, period, and phase shifts</li>\r\n              <li>â€¢ Seeing the wave patterns that connect to real-world phenomena</li>\r\n              <li>â€¢ Discovering why trigonometry is the language of oscillations</li>\r\n            </ul>\r\n          </div>\r\n\r\n          <div className=\"bg-yellow-50 p-4 rounded-lg border border-yellow-200\">\r\n            <h3 className=\"font-semibold mb-2 text-yellow-800\">ðŸ’¡ The Connection Revolution</h3>\r\n            <p className=\"text-sm\">\r\n              You've just experienced one of mathematics' most beautiful connections: how circular motion creates \r\n              wave patterns. This insight connects geometry, algebra, and physics - and it's the foundation for \r\n              understanding everything from sound waves to quantum mechanics!\r\n            </p>\r\n          </div>\r\n        </div>\r\n      ),\r\n      estimatedTime: 3\r\n    }\r\n  ]\r\n};\r\n\r\ninterface TrigonometryUnitCircleMicroLessonProps {\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst TrigonometryUnitCircleMicroLesson: React.FC<TrigonometryUnitCircleMicroLessonProps> = ({ onComplete }) => {\r\n  return (\r\n    <MicroLessonContainer\r\n      lessonData={trigonometryUnitCircleLessonData as any}\r\n      onComplete={onComplete}\r\n    />\r\n  );\r\n};\r\n\r\nexport default TrigonometryUnitCircleMicroLesson;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\vectors\\VectorsMicroLesson.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\vectors\\VectorsMicroLessonData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\micro-lessons\\vectors\\VectorsMicroLessonDataPart2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\monitoring\\MonitoringDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":88,"column":6,"nodeType":"ArrayExpression","endLine":88,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [autoRefresh, cleanup]","fix":{"range":[2777,2790],"text":"[autoRefresh, cleanup]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":167,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5706,5709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5706,5709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, FunnelChart, Funnel, Cell } from 'recharts';\r\nimport { Activity, AlertTriangle, TrendingUp, Users, Clock, Zap } from 'lucide-react';\r\nimport { sloMonitoringService } from '@/services/monitoring/SLOMonitoringService';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface WebVitalMetric {\r\n  name: string;\r\n  value: number;\r\n  rating: 'good' | 'needs-improvement' | 'poor';\r\n}\r\n\r\ninterface FunnelStep {\r\n  step: string;\r\n  count: number;\r\n  conversionRate: number;\r\n}\r\n\r\ninterface MonitoringAlert {\r\n  id: string;\r\n  rule: string;\r\n  metric: string;\r\n  value: number;\r\n  target: number;\r\n  severity: 'info' | 'warning' | 'critical';\r\n  timestamp: number;\r\n  acknowledged: boolean;\r\n}\r\n\r\ninterface FunnelMetrics {\r\n  totalSearches: number;\r\n  searchToView: number;\r\n  viewToDetail: number;\r\n  detailToRead: number;\r\n  readToComplete: number;\r\n  conversionRates: {\r\n    searchToRead: number;\r\n    searchToComplete: number;\r\n    viewToRead: number;\r\n  };\r\n}\r\n\r\ninterface DashboardData {\r\n  sloStatus: Record<string, { status: 'passing' | 'failing'; value: number; target: number }>;\r\n  alerts: MonitoringAlert[];\r\n  webVitals: WebVitalMetric[];\r\n  conversionMetrics: FunnelMetrics;\r\n  funnelData: FunnelStep[];\r\n}\r\n\r\nconst MonitoringDashboard: React.FC = () => {\r\n  const cleanup = useCleanup('MonitoringDashboard');\r\n  const [dashboardData, setDashboardData] = useState<DashboardData | null>(null);\r\n  const [selectedTab, setSelectedTab] = useState('overview');\r\n  const [autoRefresh, setAutoRefresh] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const loadDashboardData = () => {\r\n      const data = sloMonitoringService.getDashboardData();\r\n      setDashboardData(data);\r\n    };\r\n\r\n    loadDashboardData();\r\n\r\n    // Auto-refresh every 30 seconds\r\n    let intervalId: string | null = null;\r\n    if (autoRefresh) {\r\n      intervalId = cleanup.setInterval(loadDashboardData, 30000);\r\n    }\r\n\r\n    // Listen for real-time alerts\r\n    const handleAlert = (event: CustomEvent) => {\r\n      loadDashboardData(); // Refresh dashboard when alert received\r\n    };\r\n\r\n    cleanup.addEventListener(window, 'slo-alert', handleAlert as EventListener);\r\n\r\n    return () => {\r\n      if (intervalId) cleanup.cleanup(intervalId);\r\n    };\r\n  }, [autoRefresh]);\r\n\r\n  if (!dashboardData) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const { sloStatus, alerts, webVitals, conversionMetrics, funnelData } = dashboardData;\r\n\r\n  const getSeverityColor = (severity: string) => {\r\n    switch (severity) {\r\n      case 'critical': return 'destructive';\r\n      case 'warning': return 'secondary';\r\n      default: return 'default';\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    return status === 'passing' ? 'secondary' : 'destructive';\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold\">Performance Monitoring</h2>\r\n          <p className=\"text-muted-foreground\">Real-time analytics and SLO monitoring</p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            variant={autoRefresh ? 'default' : 'outline'}\r\n            onClick={() => setAutoRefresh(!autoRefresh)}\r\n            size=\"sm\"\r\n          >\r\n            <Activity className=\"h-4 w-4 mr-2\" />\r\n            Auto Refresh\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={() => sloMonitoringService.requestNotificationPermission()}\r\n            size=\"sm\"\r\n          >\r\n            Enable Alerts\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Recent Alerts */}\r\n      {alerts.length > 0 && (\r\n        <Alert>\r\n          <AlertTriangle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            {alerts.filter((a: MonitoringAlert) => !a.acknowledged).length} unacknowledged alerts. \r\n            Latest: {alerts[0]?.metric} exceeded threshold.\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      <Tabs value={selectedTab} onValueChange={setSelectedTab}>\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"web-vitals\">Web Vitals</TabsTrigger>\r\n          <TabsTrigger value=\"conversion\">Conversion</TabsTrigger>\r\n          <TabsTrigger value=\"alerts\">Alerts</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            {/* SLO Status Overview */}\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">SLO Compliance</CardTitle>\r\n                <Zap className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-2\">\r\n                  {Object.entries(sloStatus).map(([metric, data]: [string, any]) => (\r\n                    <div key={metric} className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm\">{metric.replace('_', ' ')}</span>\r\n                      <Badge variant={getStatusColor(data.status)}>\r\n                        {data.status}\r\n                      </Badge>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Performance Summary */}\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Performance</CardTitle>\r\n                <Clock className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-2\">\r\n                  {webVitals.slice(0, 3).map((metric: WebVitalMetric) => (\r\n                    <div key={metric.name} className=\"space-y-1\">\r\n                      <div className=\"flex justify-between text-sm\">\r\n                        <span>{metric.name}</span>\r\n                        <span>{metric.value.toFixed(0)}{metric.name === 'CLS' ? '' : 'ms'}</span>\r\n                      </div>\r\n                      <Progress \r\n                        value={metric.rating === 'good' ? 100 : metric.rating === 'needs-improvement' ? 60 : 30} \r\n                        className=\"h-2\"\r\n                      />\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Conversion Summary */}\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Conversion Funnel</CardTitle>\r\n                <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span>Search to Read</span>\r\n                    <span>{conversionMetrics.conversionRates.searchToRead.toFixed(1)}%</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span>Total Searches</span>\r\n                    <span>{conversionMetrics.totalSearches}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span>Completed Reads</span>\r\n                    <span>{conversionMetrics.readToComplete}</span>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"web-vitals\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            {webVitals.map((metric: WebVitalMetric) => (\r\n              <Card key={metric.name}>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center justify-between\">\r\n                    {metric.name}\r\n                    <Badge variant={metric.rating === 'good' ? 'secondary' : metric.rating === 'needs-improvement' ? 'secondary' : 'destructive'}>\r\n                      {metric.rating}\r\n                    </Badge>\r\n                  </CardTitle>\r\n                  <CardDescription>\r\n                    Current: {metric.value.toFixed(2)}{metric.name === 'CLS' ? '' : 'ms'}\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <Progress \r\n                    value={metric.rating === 'good' ? 100 : metric.rating === 'needs-improvement' ? 60 : 30}\r\n                    className=\"h-4\"\r\n                  />\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"conversion\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Conversion Funnel</CardTitle>\r\n                <CardDescription>User journey from search to reading completion</CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  {funnelData.map((step: FunnelStep, index: number) => (\r\n                    <div key={step.step} className=\"space-y-2\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                        <span className=\"font-medium\">{step.step}</span>\r\n                        <span className=\"text-sm text-muted-foreground\">\r\n                          {step.count} users ({step.conversionRate.toFixed(1)}%)\r\n                        </span>\r\n                      </div>\r\n                      <Progress value={step.conversionRate} className=\"h-3\" />\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Conversion Metrics</CardTitle>\r\n                <CardDescription>Key conversion rate indicators</CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Search to Read</span>\r\n                    <span className=\"font-bold\">{conversionMetrics.conversionRates.searchToRead.toFixed(1)}%</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Search to Complete</span>\r\n                    <span className=\"font-bold\">{conversionMetrics.conversionRates.searchToComplete.toFixed(1)}%</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>View to Read</span>\r\n                    <span className=\"font-bold\">{conversionMetrics.conversionRates.viewToRead.toFixed(1)}%</span>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"alerts\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Recent Alerts</CardTitle>\r\n              <CardDescription>Performance and conversion alerts</CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-3\">\r\n                {alerts.length === 0 ? (\r\n                  <p className=\"text-muted-foreground\">No recent alerts</p>\r\n                ) : (\r\n                  alerts.map((alert: MonitoringAlert) => (\r\n                    <div key={alert.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Badge variant={getSeverityColor(alert.severity)}>\r\n                            {alert.severity}\r\n                          </Badge>\r\n                          <span className=\"font-medium\">{alert.metric}</span>\r\n                        </div>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          Value: {alert.value.toFixed(2)} (Target: {alert.target})\r\n                        </p>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          {new Date(alert.timestamp).toLocaleString()}\r\n                        </p>\r\n                      </div>\r\n                      {!alert.acknowledged && (\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => sloMonitoringService.acknowledgeAlert(alert.id)}\r\n                        >\r\n                          Acknowledge\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MonitoringDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\native-courses\\NativeCourseCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\native-courses\\NativeCoursePlayer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'allLessons' logical expression could make the dependencies of useEffect Hook (at line 83) change on every render. To fix this, wrap the initialization of 'allLessons' in its own useMemo() Hook.","line":55,"column":9,"nodeType":"VariableDeclarator","endLine":60,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":214,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7315,7318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7315,7318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { \r\n  ChevronLeft, \r\n  ChevronRight, \r\n  CheckCircle,\r\n  Menu,\r\n  X\r\n} from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { \r\n  useNativeCourse, \r\n  useCourseModules, \r\n  useCourseLesson,\r\n  useNativeEnrollments,\r\n  useNativeEnrollmentMutations \r\n} from '@/hooks/useNativeCourses';\r\nimport { NativeLessonRenderer } from './NativeLessonRenderer';\r\nimport { NativeCourseProgressSidebar } from './NativeCourseProgressSidebar';\r\nimport { useUnifiedProgressTracking } from '@/hooks/useUnifiedProgressTracking';\r\nimport { toast } from 'sonner';\r\n\r\nexport default function NativeCoursePlayer() {\r\n  const { slug } = useParams<{ slug: string }>();\r\n  const navigate = useNavigate();\r\n  const [currentLessonId, setCurrentLessonId] = useState<string | null>(null);\r\n  const [sidebarOpen, setSidebarOpen] = useState(true);\r\n  \r\n  const { data: course } = useNativeCourse(slug!);\r\n  const { data: modules } = useCourseModules(course?.id || '');\r\n  const { data: lesson } = useCourseLesson(currentLessonId || '');\r\n  const { data: enrollments } = useNativeEnrollments();\r\n  const { updateProgress } = useNativeEnrollmentMutations();\r\n\r\n  // Unified progress tracking\r\n  const {\r\n    trackInteraction,\r\n    trackLessonCompletion,\r\n    trackCourseCompletion,\r\n    totalTimeSpent,\r\n    sessionActive\r\n  } = useUnifiedProgressTracking(\r\n    course?.id || '',\r\n    course?.title || '',\r\n    currentLessonId || undefined,\r\n    lesson?.title || undefined\r\n  );\r\n\r\n  // Find current enrollment\r\n  const enrollment = enrollments?.find(e => e.course_id === course?.id);\r\n  \r\n  // Get all lessons in order\r\n  const allLessons = modules?.flatMap(module => \r\n    module.course_lessons?.map(lesson => ({\r\n      ...lesson,\r\n      module_title: module.title\r\n    })) || []\r\n  ) || [];\r\n\r\n  const currentLessonIndex = allLessons.findIndex(l => l.id === currentLessonId);\r\n  const hasQuiz = lesson?.lesson_blocks?.some(block => block.type === 'quiz') || false;\r\n  const canGoPrevious = currentLessonIndex > 0;\r\n  const canGoNext = currentLessonIndex < allLessons.length - 1;\r\n  const isLastLesson = currentLessonIndex === allLessons.length - 1;\r\n\r\n  // Initialize with first lesson or resume from last position\r\n  useEffect(() => {\r\n    if (!currentLessonId && allLessons.length > 0) {\r\n      const resumeLesson = enrollment?.last_lesson_id \r\n        ? allLessons.find(l => l.id === enrollment.last_lesson_id)\r\n        : allLessons[0];\r\n      \r\n      if (resumeLesson) {\r\n        setCurrentLessonId(resumeLesson.id);\r\n        trackInteraction('course_resumed', {\r\n          resumedLessonId: resumeLesson.id,\r\n          resumedLessonTitle: resumeLesson.title\r\n        });\r\n      }\r\n    }\r\n  }, [allLessons, enrollment, currentLessonId, trackInteraction]);\r\n\r\n  const handleExit = () => {\r\n    navigate('/dashboard/learner/courses');\r\n  };\r\n\r\n  const handlePreviousLesson = () => {\r\n    if (canGoPrevious) {\r\n      const prevLesson = allLessons[currentLessonIndex - 1];\r\n      setCurrentLessonId(prevLesson.id);\r\n    }\r\n  };\r\n\r\n  const handleNextLesson = () => {\r\n    if (canGoNext) {\r\n      const nextLesson = allLessons[currentLessonIndex + 1];\r\n      setCurrentLessonId(nextLesson.id);\r\n      trackInteraction('lesson_navigation', {\r\n        action: 'next',\r\n        fromLessonId: currentLessonId,\r\n        toLessonId: nextLesson.id\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleCompleteLesson = async () => {\r\n    if (!enrollment || !currentLessonId || !lesson) return;\r\n    \r\n    try {\r\n      // Track lesson completion with unified system\r\n      await trackLessonCompletion(currentLessonId, lesson.title);\r\n      \r\n      // Update native enrollment progress\r\n      const newProgress = Math.round(((currentLessonIndex + 1) / allLessons.length) * 100);\r\n      \r\n      await updateProgress.mutateAsync({\r\n        enrollmentId: enrollment.id,\r\n        progressPct: newProgress,\r\n        lastLessonId: currentLessonId\r\n      });\r\n      \r\n      // Check if course is complete\r\n      if (isLastLesson) {\r\n        await trackCourseCompletion();\r\n      }\r\n      \r\n      // Auto-advance to next lesson if not the last\r\n      if (!isLastLesson) {\r\n        setTimeout(() => {\r\n          handleNextLesson();\r\n        }, 1000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error completing lesson:', error);\r\n      toast.error('Failed to update progress');\r\n    }\r\n  };\r\n\r\n  const handleLessonSelect = (lessonId: string) => {\r\n    setCurrentLessonId(lessonId);\r\n    trackInteraction('lesson_selected', {\r\n      lessonId,\r\n      lessonTitle: allLessons.find(l => l.id === lessonId)?.title\r\n    });\r\n  };\r\n\r\n  if (!course || !lesson) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-muted-foreground\">Loading course...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const progressPercentage = enrollment?.progress_pct || 0;\r\n\r\n  const isLessonCompleted = (currentLessonIndex + 1) <= Math.floor((enrollment?.progress_pct || 0) * allLessons.length / 100);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background flex\">\r\n      {/* Sidebar */}\r\n      <div className={`transition-all duration-300 ${sidebarOpen ? 'w-80' : 'w-0'} overflow-hidden`}>\r\n        <NativeCourseProgressSidebar\r\n          modules={modules || []}\r\n          currentLessonId={currentLessonId}\r\n          enrollment={enrollment}\r\n          onLessonSelect={handleLessonSelect}\r\n          className=\"h-screen\"\r\n        />\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 flex flex-col\">\r\n        {/* Header */}\r\n        <CourseHeader \r\n          onBackToCourses={handleExit}\r\n          onDashboard={handleExit}\r\n          title={course.title}\r\n        />\r\n        \r\n        {/* Course Info Bar */}\r\n        <div className=\"border-b bg-card px-4 py-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-4\">\r\n              <Button \r\n                variant=\"ghost\" \r\n                size=\"sm\" \r\n                onClick={() => setSidebarOpen(!sidebarOpen)}\r\n              >\r\n                {sidebarOpen ? <X className=\"h-4 w-4\" /> : <Menu className=\"h-4 w-4\" />}\r\n              </Button>\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  Lesson {currentLessonIndex + 1} of {allLessons.length}: {lesson.title}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <div className=\"text-sm text-muted-foreground\">\r\n                {Math.round(progressPercentage)}% Complete\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Lesson Content */}\r\n        <main className=\"flex-1 p-6 overflow-y-auto\">\r\n          <div onClick={() => trackInteraction('lesson_content_interaction')}>\r\n            <NativeLessonRenderer lesson={lesson as any} />\r\n          </div>\r\n        </main>\r\n\r\n        {/* Navigation Footer */}\r\n        <footer className=\"border-t bg-card p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <Button \r\n              variant=\"outline\" \r\n              onClick={handlePreviousLesson}\r\n              disabled={!canGoPrevious}\r\n            >\r\n              <ChevronLeft className=\"h-4 w-4 mr-2\" />\r\n              Previous\r\n            </Button>\r\n\r\n            <div className=\"flex items-center space-x-3\">\r\n              {!isLessonCompleted && (\r\n                <Button onClick={handleCompleteLesson} className=\"fpk-gradient\">\r\n                  <CheckCircle className=\"h-4 w-4 mr-2\" />\r\n                  Complete Lesson\r\n                </Button>\r\n              )}\r\n              \r\n              {isLessonCompleted && (\r\n                <div className=\"flex items-center space-x-2 text-green-600\">\r\n                  <CheckCircle className=\"h-4 w-4\" />\r\n                  <span className=\"text-sm font-medium\">Completed</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <Button \r\n              onClick={handleNextLesson}\r\n              disabled={!canGoNext}\r\n            >\r\n              Next\r\n              <ChevronRight className=\"h-4 w-4 ml-2\" />\r\n            </Button>\r\n          </div>\r\n        </footer>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\native-courses\\NativeCourseProgressSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\native-courses\\NativeLessonRenderer.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1613,1616],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1613,1616],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":107,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":107,"endColumn":74,"suggestions":[{"messageId":"addBrackets","fix":{"range":[2983,3748],"text":"{ const proxyUrl = `/native-content/${data.packageId}/${data.src}`;\r\n        return (\r\n          <Card key={block.id} className=\"mb-6\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-lg flex items-center\">\r\n                Interactive Content\r\n                <Badge variant=\"secondary\" className=\"ml-2\">Legacy</Badge>\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <iframe\r\n                src={proxyUrl}\r\n                className=\"w-full h-96 border rounded-lg\"\r\n                sandbox=\"allow-scripts allow-forms allow-same-origin allow-pointer-lock allow-popups\"\r\n                title=\"Interactive lesson content\"\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        ); }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":249,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":249,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8224,8227],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8224,8227],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":267,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9274,9277],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9274,9277],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":288,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10489,10492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10489,10492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":290,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":290,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10650,10653],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10650,10653],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport DOMPurify from 'isomorphic-dompurify';\r\n\r\ninterface QuizOption {\r\n  id: string;\r\n  text: string;\r\n}\r\n\r\ninterface MCQAnswerKey {\r\n  correct_answer: string;\r\n  explanation?: string;\r\n}\r\n\r\ninterface MultiAnswerKey {\r\n  correct_answers: string[];\r\n  explanation?: string;\r\n}\r\n\r\ninterface NumericAnswerKey {\r\n  correct_value: number;\r\n  explanation?: string;\r\n}\r\n\r\ninterface QuizItem {\r\n  id: string;\r\n  kind: 'mcq' | 'multi' | 'numeric';\r\n  prompt: string;\r\n  options_json: QuizOption[];\r\n  answer_key_json: MCQAnswerKey | MultiAnswerKey | NumericAnswerKey;\r\n  points: number;\r\n  order_index: number;\r\n}\r\n\r\ninterface BlockDataRichText {\r\n  html: string;\r\n}\r\n\r\ninterface BlockDataImage {\r\n  src: string;\r\n  alt?: string;\r\n  caption?: string;\r\n}\r\n\r\ninterface LessonBlock {\r\n  id: string;\r\n  type: 'rich-text' | 'image' | 'legacy-html' | 'quiz';\r\n  order_index: number;\r\n  data_json: BlockDataRichText | BlockDataImage | Record<string, unknown>;\r\n  quiz_items?: QuizItem[];\r\n}\r\n\r\ninterface LessonData {\r\n  id: string;\r\n  title: string;\r\n  lesson_blocks: LessonBlock[];\r\n}\r\n\r\ninterface NativeLessonRendererProps {\r\n  lesson: LessonData;\r\n}\r\n\r\nexport function NativeLessonRenderer({ lesson }: NativeLessonRendererProps) {\r\n  // Sort blocks by order_index\r\n  const sortedBlocks = lesson.lesson_blocks?.sort((a, b) => a.order_index - b.order_index) || [];\r\n\r\n  const renderBlock = (block: LessonBlock) => {\r\n    const data = block.data_json as Record<string, any>;\r\n    switch (block.type) {\r\n      case 'rich-text':\r\n        return (\r\n          <Card key={block.id} className=\"mb-6\">\r\n            <CardContent className=\"pt-6\">\r\n              <div \r\n                className=\"prose prose-slate max-w-none\"\r\n                dangerouslySetInnerHTML={{\r\n                  __html: DOMPurify.sanitize(data.html || '', {\r\n                    ALLOWED_TAGS: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'br', 'strong', 'em', 'u', 'ol', 'ul', 'li', 'a', 'img', 'div', 'span', 'table', 'tbody', 'tr', 'td', 'th'],\r\n                    ALLOWED_ATTR: ['href', 'src', 'alt', 'title', 'class', 'id', 'style']\r\n                  })\r\n                }}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        );\r\n\r\n      case 'image':\r\n        return (\r\n          <Card key={block.id} className=\"mb-6\">\r\n            <CardContent className=\"pt-6 text-center\">\r\n              <img\r\n                src={data.src}\r\n                alt={data.alt || 'Course image'}\r\n                className=\"max-w-full h-auto mx-auto rounded-lg shadow-sm\"\r\n              />\r\n              {data.caption && (\r\n                <p className=\"text-sm text-muted-foreground mt-2\">\r\n                  {data.caption}\r\n                </p>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        );\r\n\r\n      case 'legacy-html':\r\n        const proxyUrl = `/native-content/${data.packageId}/${data.src}`;\r\n        return (\r\n          <Card key={block.id} className=\"mb-6\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-lg flex items-center\">\r\n                Interactive Content\r\n                <Badge variant=\"secondary\" className=\"ml-2\">Legacy</Badge>\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <iframe\r\n                src={proxyUrl}\r\n                className=\"w-full h-96 border rounded-lg\"\r\n                sandbox=\"allow-scripts allow-forms allow-same-origin allow-pointer-lock allow-popups\"\r\n                title=\"Interactive lesson content\"\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        );\r\n\r\n      case 'quiz':\r\n        return (\r\n          <Card key={block.id} className=\"mb-6 border-primary/20\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-lg flex items-center\">\r\n                Knowledge Check\r\n                <Badge variant=\"default\" className=\"ml-2 fpk-gradient text-white\">Quiz</Badge>\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <QuizRenderer items={block.quiz_items || []} />\r\n            </CardContent>\r\n          </Card>\r\n        );\r\n\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto\">\r\n      <div className=\"mb-6\">\r\n        <h1 className=\"text-3xl font-bold mb-2\">{lesson.title}</h1>\r\n        <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\r\n          <Badge variant=\"outline\">{sortedBlocks.length} sections</Badge>\r\n          <span>â€¢</span>\r\n          <span>Interactive Lesson</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-6\">\r\n        {sortedBlocks.map(renderBlock)}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Quiz renderer component\r\nfunction QuizRenderer({ items }: { items: QuizItem[] }) {\r\n  const [answers, setAnswers] = React.useState<{ [key: string]: string | string[] | number }>({});\r\n  const [submitted, setSubmitted] = React.useState(false);\r\n\r\n  const handleAnswerChange = (itemId: string, value: string | string[] | number) => {\r\n    setAnswers(prev => ({ ...prev, [itemId]: value }));\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    setSubmitted(true);\r\n    // Here you would typically send answers to the server\r\n    console.log('Quiz answers:', answers);\r\n  };\r\n\r\n  const sortedItems = items.sort((a, b) => a.order_index - b.order_index);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {sortedItems.map((item, index) => (\r\n        <div key={item.id} className=\"border rounded-lg p-4\">\r\n          <h4 className=\"font-semibold mb-3\">\r\n            Question {index + 1}: {item.prompt}\r\n          </h4>\r\n\r\n          {item.kind === 'mcq' && (\r\n            <div className=\"space-y-2\">\r\n              {item.options_json.map((option: QuizOption) => (\r\n                <label key={option.id} className=\"flex items-center space-x-3 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name={`question-${item.id}`}\r\n                    value={option.id}\r\n                    onChange={() => handleAnswerChange(item.id, option.id)}\r\n                    disabled={submitted}\r\n                    className=\"form-radio\"\r\n                  />\r\n                  <span>{option.text}</span>\r\n                </label>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {item.kind === 'multi' && (\r\n            <div className=\"space-y-2\">\r\n              {item.options_json.map((option: QuizOption) => (\r\n                <label key={option.id} className=\"flex items-center space-x-3 cursor-pointer\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    value={option.id}\r\n                    onChange={(e) => {\r\n                      const current = (answers[item.id] as string[]) || [];\r\n                      if (e.target.checked) {\r\n                        handleAnswerChange(item.id, [...current, option.id]);\r\n                      } else {\r\n                        handleAnswerChange(item.id, current.filter((id: string) => id !== option.id));\r\n                      }\r\n                    }}\r\n                    disabled={submitted}\r\n                    className=\"form-checkbox\"\r\n                  />\r\n                  <span>{option.text}</span>\r\n                </label>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {item.kind === 'numeric' && (\r\n            <input\r\n              type=\"number\"\r\n              step=\"any\"\r\n              onChange={(e) => handleAnswerChange(item.id, parseFloat(e.target.value))}\r\n              disabled={submitted}\r\n              className=\"w-full max-w-xs p-2 border rounded\"\r\n              placeholder=\"Enter your answer\"\r\n            />\r\n          )}\r\n\r\n          {submitted && (\r\n            <div className=\"mt-3 p-3 rounded-lg bg-muted/50 text-sm\">\r\n              <div className=\"flex items-center space-x-2 mb-2\">\r\n                <Badge variant={\r\n                  // Check if answers match for different quiz types\r\n                  (() => {\r\n                    const answerKey = item.answer_key_json as any;\r\n                    const userAnswer = answers[item.id];\r\n                    \r\n                    if (item.kind === 'mcq') {\r\n                      return userAnswer === answerKey?.correct_answer;\r\n                    } else if (item.kind === 'multi') {\r\n                      const userAnswers = Array.isArray(userAnswer) ? userAnswer : [];\r\n                      const correctAnswers = answerKey?.correct_answers || [];\r\n                      return JSON.stringify(userAnswers.sort()) === JSON.stringify(correctAnswers.sort());\r\n                    } else if (item.kind === 'numeric') {\r\n                      const userNum = typeof userAnswer === 'number' ? userAnswer : 0;\r\n                      const correctNum = answerKey?.correct_value || 0;\r\n                      return Math.abs(userNum - correctNum) < 0.001;\r\n                    }\r\n                    return false;\r\n                  })() ? 'default' : 'destructive'\r\n                }>\r\n                  {(() => {\r\n                    const answerKey = item.answer_key_json as any;\r\n                    const userAnswer = answers[item.id];\r\n                    \r\n                    if (item.kind === 'mcq') {\r\n                      return userAnswer === answerKey?.correct_answer ? 'Correct' : 'Incorrect';\r\n                    } else if (item.kind === 'multi') {\r\n                      const userAnswers = Array.isArray(userAnswer) ? userAnswer : [];\r\n                      const correctAnswers = answerKey?.correct_answers || [];\r\n                      return JSON.stringify(userAnswers.sort()) === JSON.stringify(correctAnswers.sort()) ? 'Correct' : 'Incorrect';\r\n                    } else if (item.kind === 'numeric') {\r\n                      const userNum = typeof userAnswer === 'number' ? userAnswer : 0;\r\n                      const correctNum = answerKey?.correct_value || 0;\r\n                      return Math.abs(userNum - correctNum) < 0.001 ? 'Correct' : 'Incorrect';\r\n                    }\r\n                    return 'Incorrect';\r\n                  })()}\r\n                </Badge>\r\n                <span className=\"text-xs text-muted-foreground\">\r\n                  {item.points} points\r\n                </span>\r\n              </div>\r\n              {(item.answer_key_json as any)?.explanation && (\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  <strong>Explanation:</strong> {(item.answer_key_json as any).explanation}\r\n                </p>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ))}\r\n\r\n      {!submitted && (\r\n        <button\r\n          onClick={handleSubmit}\r\n          className=\"w-full py-2 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors\"\r\n        >\r\n          Submit Quiz\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\BatchProcessingPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FileUploadDropzone.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FileUploadProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FileUploadSection.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'addPreviewCards', 'completeStage', 'errorStage', 'processingTimeouts', and 'toast'. Either include them or remove the dependency array.","line":175,"column":6,"nodeType":"ArrayExpression","endLine":175,"endColumn":66,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, subscribe, unsubscribe, isConnected, stopPolling, completeStage, toast, addPreviewCards, errorStage, processingTimeouts]","fix":{"range":[6867,6927],"text":"[user.id, subscribe, unsubscribe, isConnected, stopPolling, completeStage, toast, addPreviewCards, errorStage, processingTimeouts]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleFiles'. Either include it or remove the dependency array.","line":433,"column":6,"nodeType":"ArrayExpression","endLine":433,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [handleFiles]","fix":{"range":[16164,16166],"text":"[handleFiles]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useEffect, useRef } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useFileUploads, FileUpload } from '@/hooks/useFileUploads';\r\nimport { useFlashcardPreview } from '@/hooks/useFlashcardPreview';\r\nimport { useRealTimeProcessing } from '@/hooks/useRealTimeProcessing';\r\nimport { useFileUploadSubscription, FileUploadUpdatePayload } from '@/hooks/useFileUploadSubscription';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport FileUploadDropzone from './FileUploadDropzone';\r\nimport FileUploadProgress from './FileUploadProgress';\r\nimport { allowedTypes, maxFileSize, formatFileSize } from './FileUploadUtils';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface FileUploadPayload {\r\n  new: {\r\n    id: string;\r\n    processing_status: string;\r\n    error_message?: string;\r\n    [key: string]: unknown;\r\n  };\r\n}\r\n\r\ninterface FlashcardData {\r\n  flashcards: Array<{\r\n    front: string;\r\n    back: string;\r\n    [key: string]: unknown;\r\n  }>;\r\n}\r\n\r\nconst FileUploadSection: React.FC = () => {\r\n  const cleanup = useCleanup('FileUploadSection');\r\n  const { user } = useAuth();\r\n  const { uploads, createUploadAsync, updateUpload, deleteUpload } = useFileUploads();\r\n  const { addPreviewCards } = useFlashcardPreview();\r\n  const { startProcessing, completeStage, errorStage } = useRealTimeProcessing();\r\n  const { subscribe, unsubscribe, isConnected, startPolling, stopPolling } = useFileUploadSubscription();\r\n  const { toast } = useToast();\r\n  const [dragActive, setDragActive] = useState(false);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [processingProgress, setProcessingProgress] = useState<Record<string, number>>({});\r\n  const [processingTimeouts, setProcessingTimeouts] = useState<Record<string, NodeJS.Timeout>>({});\r\n  const subscriptionIdRef = useRef<string>(`notes-upload-${Date.now()}`);\r\n\r\n  // Set up centralized subscription with polling fallback\r\n  useEffect(() => {\r\n    if (!user?.id) return;\r\n\r\n    const subscriptionId = subscriptionIdRef.current;\r\n    console.log(`ðŸ“¡ Setting up notes file upload handler: ${subscriptionId}`);\r\n\r\n    const handleFileUploadUpdate = async (payload: FileUploadUpdatePayload) => {\r\n      console.log('ðŸ”„ Notes file upload updated:', payload);\r\n      \r\n      if (payload.new.processing_status === 'completed') {\r\n        console.log('âœ… Processing completed:', payload.new.id);\r\n        \r\n        completeStage(payload.new.id as string, 'generation');\r\n        \r\n        // Clear timeout and progress\r\n        setProcessingProgress(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id as string];\r\n          return newState;\r\n        });\r\n        \r\n        setProcessingTimeouts(prev => {\r\n          if (prev[payload.new.id as string]) {\r\n            clearTimeout(prev[payload.new.id as string]);\r\n          }\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id as string];\r\n          return newState;\r\n        });\r\n\r\n        // Stop polling if it was running\r\n        stopPolling(payload.new.id as string);\r\n\r\n        // Fetch flashcards and add to preview\r\n        try {\r\n          const { data, error } = await supabase.functions.invoke('process-file-flashcards', {\r\n            body: {\r\n              uploadId: payload.new.id,\r\n              filePath: payload.new.storage_path,\r\n              fileName: payload.new.file_name,\r\n              fileType: payload.new.file_type,\r\n              userId: user.id,\r\n              previewMode: true,\r\n              fetchOnly: true\r\n            }\r\n          });\r\n\r\n          if (error) {\r\n            console.error('âŒ Error fetching flashcards:', error);\r\n            toast({\r\n              title: \"âš ï¸ Processing complete\",\r\n              description: `${payload.new.file_name} processed but couldn't retrieve flashcards.`,\r\n            });\r\n          } else if (data?.flashcards?.length > 0) {\r\n        const previewCards = data.flashcards.map((card: FlashcardData['flashcards'][0], index: number) => ({\r\n              front_content: card.front_content || card.front || '',\r\n              back_content: card.back_content || card.back || '',\r\n              title: `${payload.new.file_name} - Card ${index + 1}`,\r\n              source: 'upload' as const,\r\n              status: 'new' as const,\r\n              session_id: payload.new.id\r\n            }));\r\n\r\n            addPreviewCards(previewCards);\r\n            \r\n            toast({\r\n              title: \"ðŸŽ‰ Flashcards ready!\",\r\n              description: `Generated ${data.flashcards.length} flashcards from ${payload.new.file_name}. Check the preview above!`,\r\n            });\r\n          }\r\n        } catch (error) {\r\n          console.error('ðŸ’¥ Error in completion handling:', error);\r\n        }\r\n      } else if (payload.new.processing_status === 'failed') {\r\n        console.log('âŒ Processing failed:', payload.new.id);\r\n        \r\n        errorStage(payload.new.id as string, 'generation', (payload.new.error_message as string) || 'Processing failed');\r\n        \r\n        // Clean up\r\n        setProcessingProgress(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id as string];\r\n          return newState;\r\n        });\r\n        \r\n        setProcessingTimeouts(prev => {\r\n          if (prev[payload.new.id as string]) {\r\n            clearTimeout(prev[payload.new.id as string]);\r\n          }\r\n          const newState = { ...prev };\r\n          delete newState[payload.new.id as string];\r\n          return newState;\r\n        });\r\n\r\n        // Stop polling if it was running\r\n        stopPolling(payload.new.id as string);\r\n        \r\n        toast({\r\n          title: \"âŒ Processing failed\",\r\n          description: payload.new.error_message as string || \"Failed to generate flashcards\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    };\r\n\r\n    subscribe(subscriptionId, handleFileUploadUpdate);\r\n\r\n    // If real-time connection fails, show warning and ensure polling fallback\r\n    const connectionCheckTimer = setTimeout(() => {\r\n      if (!isConnected) {\r\n        console.log('âš ï¸ Real-time connection not established, relying on polling fallback');\r\n        toast({\r\n          title: \"Connection Notice\",\r\n          description: \"Using backup sync method for file processing updates.\",\r\n        });\r\n      }\r\n    }, 5000);\r\n\r\n    return () => {\r\n      console.log(`ðŸ”Œ Cleaning up notes file upload handler: ${subscriptionId}`);\r\n      unsubscribe(subscriptionId);\r\n      clearTimeout(connectionCheckTimer);\r\n      \r\n      // Clean up timeouts\r\n      Object.values(processingTimeouts).forEach(timeout => {\r\n        clearTimeout(timeout);\r\n      });\r\n    };\r\n  }, [user?.id, subscribe, unsubscribe, isConnected, stopPolling]);\r\n\r\n  const handleDrag = useCallback((e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\r\n      setDragActive(true);\r\n    } else if (e.type === \"dragleave\") {\r\n      setDragActive(false);\r\n    }\r\n  }, []);\r\n\r\n  const processFileForFlashcards = async (file: File, uploadId: string, filePath: string) => {\r\n    if (!user) return 0;\r\n\r\n    try {\r\n      console.log('ðŸ¤– Starting AI processing for file:', file.name);\r\n      \r\n      // Start the real-time processing UI\r\n      startProcessing(uploadId, file.name, file.size);\r\n      \r\n      // Simulate progress stages more quickly\r\n      cleanup.setTimeout(() => completeStage(uploadId, 'download'), 1000);\r\n      cleanup.setTimeout(() => completeStage(uploadId, 'extraction'), 2000);\r\n      \r\n      const { data, error } = await supabase.functions.invoke('process-file-flashcards', {\r\n        body: {\r\n          uploadId,\r\n          filePath,\r\n          fileName: file.name,\r\n          fileType: file.type,\r\n          userId: user.id,\r\n          previewMode: true\r\n        }\r\n      });\r\n\r\n      if (error) {\r\n        console.error('Edge function error:', error);\r\n        errorStage(uploadId, 'generation', error.message || 'AI processing failed');\r\n        throw error;\r\n      }\r\n\r\n      console.log('ðŸŽ¯ Processing response:', data);\r\n\r\n      if (data?.flashcards?.length > 0) {\r\n        const previewCards = data.flashcards.map((card: FlashcardData['flashcards'][0], index: number) => ({\r\n          front_content: card.front_content || card.front || '',\r\n          back_content: card.back_content || card.back || '',\r\n          title: `${file.name} - Card ${index + 1}`,\r\n          source: 'upload' as const,\r\n          status: 'new' as const,\r\n          session_id: uploadId\r\n        }));\r\n\r\n        addPreviewCards(previewCards);\r\n        \r\n        toast({\r\n          title: \"ðŸŽ‰ Cards ready for preview!\",\r\n          description: `${data.flashcards.length} flashcards generated and added to preview. Review them above!`,\r\n        });\r\n      }\r\n\r\n      return data.flashcardsGenerated || 0;\r\n\r\n    } catch (error) {\r\n      console.error('Processing error:', error);\r\n      errorStage(uploadId, 'generation', error instanceof Error ? error.message : 'Processing failed');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const handleFiles = async (files: FileList) => {\r\n    if (!user || files.length === 0) return;\r\n\r\n    setUploading(true);\r\n    \r\n    for (const file of Array.from(files)) {\r\n      if (!allowedTypes.includes(file.type)) {\r\n        toast({\r\n          title: \"âŒ File type not supported\",\r\n          description: `${file.type} files are not supported. Please upload PDF, DOC, PPT, TXT, MD, CSV, or RTF files.`,\r\n          variant: \"destructive\"\r\n        });\r\n        continue;\r\n      }\r\n\r\n      if (file.size > maxFileSize) {\r\n        toast({\r\n          title: \"âŒ File too large\",\r\n          description: `File size must be less than ${formatFileSize(maxFileSize)}. Your file is ${formatFileSize(file.size)}.`,\r\n          variant: \"destructive\"\r\n        });\r\n        continue;\r\n      }\r\n\r\n      try {\r\n        // Sanitize filename for storage\r\n        const sanitizedFileName = file.name\r\n          .replace(/[^a-zA-Z0-9.-]/g, '_') // Replace invalid characters with underscore\r\n          .replace(/_{2,}/g, '_') // Replace multiple underscores with single\r\n          .replace(/^_|_$/g, ''); // Remove leading/trailing underscores\r\n        \r\n        const fileName = `${Date.now()}-${sanitizedFileName}`;\r\n        const filePath = `${user.id}/${fileName}`;\r\n\r\n        const { error: uploadError } = await supabase.storage\r\n          .from('study-files')\r\n          .upload(filePath, file);\r\n\r\n        if (uploadError) {\r\n          console.error('Upload error:', uploadError);\r\n          toast({\r\n            title: \"âŒ Upload failed\",\r\n            description: \"Failed to upload file to storage.\",\r\n            variant: \"destructive\"\r\n          });\r\n          continue;\r\n        }\r\n\r\n        // Create upload record with processing status\r\n        const uploadData = {\r\n          file_name: file.name,\r\n          file_size: file.size,\r\n          file_type: file.type,\r\n          storage_path: filePath,\r\n          processing_status: 'processing' as const\r\n        };\r\n\r\n        console.log('ðŸ“ Creating upload record with processing status');\r\n        \r\n        try {\r\n          // Use the async mutation to wait for the result\r\n          console.log('ðŸ“ Creating upload record...');\r\n          const uploadRecord = await createUploadAsync(uploadData);\r\n          \r\n          console.log('ðŸ“ Upload record created:', uploadRecord.id);\r\n\r\n          toast({\r\n            title: \"âœ… File uploaded\",\r\n            description: `${file.name} uploaded successfully. Processing started...`,\r\n          });\r\n\r\n          const baseTimeout = 180000;\r\n          const sizeMultiplier = Math.min(file.size / (10 * 1024 * 1024), 2.5);\r\n          const timeoutDuration = Math.min(baseTimeout * (1 + sizeMultiplier), 480000);\r\n\r\n          const timeoutId = setTimeout(() => {\r\n            console.log('â±ï¸ Processing timeout for upload:', uploadRecord.id);\r\n            updateUpload({\r\n              id: uploadRecord.id,\r\n              processing_status: 'failed',\r\n              error_message: 'Processing timeout - file may be too complex. Try breaking into smaller sections.'\r\n            });\r\n\r\n            errorStage(uploadRecord.id, 'generation', 'Processing timeout');\r\n\r\n            setProcessingProgress(prev => {\r\n              const newState = { ...prev };\r\n              delete newState[uploadRecord.id];\r\n              return newState;\r\n            });\r\n\r\n            toast({\r\n              title: \"â±ï¸ Processing timeout\",\r\n              description: \"File processing took too long. Try uploading smaller sections.\",\r\n              variant: \"destructive\"\r\n            });\r\n          }, timeoutDuration);\r\n\r\n          setProcessingTimeouts(prev => ({\r\n            ...prev,\r\n            [uploadRecord.id]: timeoutId\r\n          }));\r\n\r\n          console.log('ðŸš€ Starting AI processing for:', uploadRecord.id);\r\n          \r\n          // Start processing immediately with better error handling\r\n          try {\r\n            await processFileForFlashcards(file, uploadRecord.id, filePath);\r\n          } catch (processingError) {\r\n            console.error('âŒ Processing failed:', processingError);\r\n            \r\n            // Update status to failed with error message\r\n            updateUpload({\r\n              id: uploadRecord.id,\r\n              processing_status: 'failed',\r\n              error_message: processingError instanceof Error ? processingError.message : 'AI processing failed'\r\n            });\r\n            \r\n            // Clear timeout\r\n            if (processingTimeouts[uploadRecord.id]) {\r\n              clearTimeout(processingTimeouts[uploadRecord.id]);\r\n              setProcessingTimeouts(prev => {\r\n                const newState = { ...prev };\r\n                delete newState[uploadRecord.id];\r\n                return newState;\r\n              });\r\n            }\r\n            \r\n            toast({\r\n              title: \"âŒ Processing failed\",\r\n              description: \"AI processing encountered an error. Please try again.\",\r\n              variant: \"destructive\"\r\n            });\r\n            \r\n            return; // Don't continue with polling setup\r\n          }\r\n\r\n          // Start polling as fallback if real-time isn't connected\r\n          if (!isConnected) {\r\n            console.log('ðŸ”„ Starting polling fallback for:', uploadRecord.id);\r\n            startPolling(uploadRecord.id, (updatedUpload) => {\r\n              if (updatedUpload.processing_status === 'completed' || updatedUpload.processing_status === 'failed') {\r\n                // Trigger the same handler as real-time would\r\n                const payload = { new: updatedUpload, old: uploadRecord };\r\n                setTimeout(() => {\r\n                  // Find and call the handler\r\n                  const handler = document.querySelector('[data-upload-handler]');\r\n                  if (handler) {\r\n                    const event = new CustomEvent('uploadUpdate', { detail: payload });\r\n                    handler.dispatchEvent(event);\r\n                  }\r\n                }, 100);\r\n              }\r\n            });\r\n          }\r\n\r\n        } catch (error) {\r\n          console.error('âŒ Upload record creation error:', error);\r\n          \r\n          toast({\r\n            title: \"âŒ Upload failed\",\r\n            description: \"Failed to create upload record. Please try again.\",\r\n            variant: \"destructive\"\r\n          });\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('File upload error:', error);\r\n        toast({\r\n          title: \"âŒ Upload error\",\r\n          description: \"An unexpected error occurred during upload.\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    }\r\n    \r\n    setUploading(false);\r\n  };\r\n\r\n  const handleDrop = useCallback((e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n    \r\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\r\n      handleFiles(e.dataTransfer.files);\r\n    }\r\n  }, []);\r\n\r\n  const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      handleFiles(e.target.files);\r\n    }\r\n  };\r\n\r\n  const removeUpload = (id: string) => {\r\n    setProcessingTimeouts(prev => {\r\n      if (prev[id]) {\r\n        clearTimeout(prev[id]);\r\n      }\r\n      const newState = { ...prev };\r\n      delete newState[id];\r\n      return newState;\r\n    });\r\n    \r\n    setProcessingProgress(prev => {\r\n      const newState = { ...prev };\r\n      delete newState[id];\r\n      return newState;\r\n    });\r\n    \r\n    deleteUpload(id);\r\n  };\r\n\r\n  const retryProcessing = async (upload: FileUpload) => {\r\n    try {\r\n      console.log('ðŸ”„ Retrying processing for:', upload.id);\r\n      \r\n      // Immediately update status to processing\r\n      updateUpload({\r\n        id: upload.id,\r\n        processing_status: 'processing',\r\n        error_message: null\r\n      });\r\n\r\n      const timeoutId = setTimeout(() => {\r\n        updateUpload({\r\n          id: upload.id,\r\n          processing_status: 'failed',\r\n          error_message: 'Processing timeout - please try a smaller file'\r\n        });\r\n\r\n        setProcessingProgress(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[upload.id];\r\n          return newState;\r\n        });\r\n      }, 300000);\r\n\r\n      setProcessingTimeouts(prev => ({\r\n        ...prev,\r\n        [upload.id]: timeoutId\r\n      }));\r\n\r\n      await processFileForFlashcards(\r\n        new File([], upload.file_name, { type: upload.file_type || 'application/octet-stream' }),\r\n        upload.id,\r\n        upload.storage_path || ''\r\n      );\r\n\r\n    } catch (error) {\r\n      console.error('Retry processing error:', error);\r\n      toast({\r\n        title: \"âŒ Retry failed\",\r\n        description: \"Failed to retry processing. Please try uploading again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card className=\"fpk-card border-0 shadow-md\" data-upload-handler>\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2 text-sm sm:text-base\">\r\n          ðŸ“¤ Enhanced File Upload & AI Processing\r\n          {!isConnected && (\r\n            <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded\">\r\n              Backup Mode\r\n            </span>\r\n          )}\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        <FileUploadDropzone\r\n          dragActive={dragActive}\r\n          uploading={uploading}\r\n          onDragEnter={handleDrag}\r\n          onDragLeave={handleDrag}\r\n          onDragOver={handleDrag}\r\n          onDrop={handleDrop}\r\n          onFileInput={handleFileInput}\r\n          maxFileSize={maxFileSize}\r\n        />\r\n\r\n        <FileUploadProgress\r\n          uploads={uploads}\r\n          processingProgress={processingProgress}\r\n          onRemoveUpload={removeUpload}\r\n          onRetryProcessing={retryProcessing}\r\n        />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default FileUploadSection;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FileUploadUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FlashcardPreviewCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FlashcardPreviewCardActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FlashcardPreviewCardEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FlashcardPreviewCardView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FlashcardPreviewModule.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\FlashcardsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\KBFileManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\KBUploader.tsx","messages":[{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":77,"column":7,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":83,"endColumn":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useCallback, useState } from 'react';\r\nimport { useDropzone } from 'react-dropzone';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Upload, FileText, Image, Film } from 'lucide-react';\r\nimport { useKnowledgeBaseFiles } from '@/hooks/useKnowledgeBaseFiles';\r\nimport { useBatchProcessing } from '@/hooks/useBatchProcessing';\r\nimport BatchProcessingPanel from './BatchProcessingPanel';\r\n\r\nconst allowedTypes = [\r\n  'application/pdf',\r\n  'application/msword',\r\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n  'application/vnd.ms-powerpoint',\r\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation',\r\n  'text/plain',\r\n  'text/markdown',\r\n  'text/csv',\r\n  'application/rtf',\r\n  'image/png',\r\n  'image/jpeg',\r\n  'image/gif',\r\n  'image/webp'\r\n];\r\n\r\nconst maxFileSize = 50 * 1024 * 1024; // 50MB\r\n\r\nconst formatFileSize = (bytes: number): string => {\r\n  if (bytes === 0) return '0 Bytes';\r\n  const k = 1024;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n};\r\n\r\nconst getFileIcon = (mimeType: string) => {\r\n  if (mimeType.startsWith('image/')) return Image;\r\n  if (mimeType.startsWith('video/')) return Film;\r\n  return FileText;\r\n};\r\n\r\nconst KBUploader: React.FC = () => {\r\n  const { uploadAndProcessFile } = useKnowledgeBaseFiles();\r\n  const {\r\n    batchState,\r\n    addFiles,\r\n    updateFileStatus,\r\n    processBatch,\r\n    pauseProcessing,\r\n    cancelProcessing,\r\n    clearBatch,\r\n    removeFile,\r\n    isProcessing\r\n  } = useBatchProcessing();\r\n\r\n  const onDrop = useCallback((acceptedFiles: File[]) => {\r\n    const validFiles = acceptedFiles.filter(file => {\r\n      if (!allowedTypes.includes(file.type)) {\r\n        return false;\r\n      }\r\n      \r\n      if (file.size > maxFileSize) {\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n\r\n    if (validFiles.length > 0) {\r\n      addFiles(validFiles);\r\n    }\r\n  }, [addFiles]);\r\n\r\n  const handleStartProcessing = useCallback(async () => {\r\n    await processBatch(async (file: File, fileId: string) => {\r\n      try {\r\n        updateFileStatus(fileId, 'processing', 50);\r\n        await uploadAndProcessFile(file);\r\n        updateFileStatus(fileId, 'completed', 100);\r\n      } catch (error) {\r\n        throw error;\r\n      }\r\n    });\r\n  }, [processBatch, updateFileStatus, uploadAndProcessFile]);\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    accept: {\r\n      'application/pdf': ['.pdf'],\r\n      'application/msword': ['.doc'],\r\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],\r\n      'application/vnd.ms-powerpoint': ['.ppt'],\r\n      'application/vnd.openxmlformats-officedocument.presentationml.presentation': ['.pptx'],\r\n      'text/plain': ['.txt'],\r\n      'text/markdown': ['.md'],\r\n      'text/csv': ['.csv'],\r\n      'application/rtf': ['.rtf'],\r\n      'image/png': ['.png'],\r\n      'image/jpeg': ['.jpg', '.jpeg'],\r\n      'image/gif': ['.gif'],\r\n      'image/webp': ['.webp']\r\n    },\r\n    maxSize: maxFileSize,\r\n    multiple: true,\r\n    disabled: isProcessing\r\n  });\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <Card className=\"border-2 border-dashed transition-colors duration-200 hover:border-primary/50\">\r\n        <CardContent className=\"p-6\">\r\n          <div \r\n            {...getRootProps()} \r\n            className={`cursor-pointer text-center space-y-4 ${\r\n              isDragActive ? 'opacity-75' : ''\r\n            } ${isProcessing ? 'pointer-events-none opacity-50' : ''}`}\r\n          >\r\n            <input {...getInputProps()} />\r\n            \r\n            <div className=\"flex justify-center\">\r\n              <Upload className={`h-12 w-12 transition-colors ${\r\n                isDragActive ? 'text-primary' : 'text-muted-foreground'\r\n              }`} />\r\n            </div>\r\n            \r\n            <div>\r\n              <h3 className=\"text-lg font-semibold mb-2\">\r\n                {isDragActive ? 'Drop files here' : 'Upload Knowledge Base Files'}\r\n              </h3>\r\n              <p className=\"text-sm text-muted-foreground mb-4\">\r\n                Drag & drop files or click to browse. These will enhance your AI conversations.\r\n              </p>\r\n              \r\n              <div className=\"space-y-2 text-xs text-muted-foreground\">\r\n                <div>\r\n                  <strong>Supported:</strong> PDF, DOC, DOCX, PPT, PPTX, TXT, MD, CSV, RTF, Images\r\n                </div>\r\n                <div>\r\n                  <strong>Max size:</strong> {formatFileSize(maxFileSize)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              className=\"w-full\"\r\n              disabled={isProcessing}\r\n            >\r\n              {isProcessing ? 'Processing...' : 'Choose Files'}\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <BatchProcessingPanel\r\n        batchState={batchState}\r\n        onStart={handleStartProcessing}\r\n        onPause={pauseProcessing}\r\n        onCancel={cancelProcessing}\r\n        onClear={clearBatch}\r\n        onRemoveFile={removeFile}\r\n        isProcessing={isProcessing}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default KBUploader;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\KnowledgeBaseSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\MobileTabsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\NotesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\ProgressSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\RealTimeProcessingMeter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notes\\VoiceInputButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notifications\\BetaUpdateListener.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notifications\\NotificationDemo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\notifications\\NotificationDropdown.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\org\\CreateInviteDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\org\\OrgBrandingBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\org\\OrgThemeProvider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":22,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":22,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useState } from 'react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\ninterface OrgBranding {\r\n  logo_url?: string;\r\n  banner_url?: string;\r\n  primary_color?: string;\r\n  accent_color?: string;\r\n}\r\n\r\ninterface OrgThemeContextType {\r\n  branding: OrgBranding | null;\r\n  isLoading: boolean;\r\n}\r\n\r\nconst OrgThemeContext = createContext<OrgThemeContextType>({\r\n  branding: null,\r\n  isLoading: true,\r\n});\r\n\r\nexport function useOrgTheme() {\r\n  return useContext(OrgThemeContext);\r\n}\r\n\r\ninterface OrgThemeProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport function OrgThemeProvider({ children }: OrgThemeProviderProps) {\r\n  const { currentOrg } = useOrgContext();\r\n  const [branding, setBranding] = useState<OrgBranding | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!currentOrg) {\r\n      setBranding(null);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    const loadBranding = async () => {\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('organizations')\r\n          .select('branding')\r\n          .eq('id', currentOrg.organization_id)\r\n          .single();\r\n\r\n        if (error) {\r\n          console.error('Error loading org branding:', error);\r\n          setBranding(null);\r\n        } else {\r\n          setBranding((data?.branding as OrgBranding) || null);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading org branding:', error);\r\n        setBranding(null);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadBranding();\r\n  }, [currentOrg]);\r\n\r\n  // Apply branding CSS variables\r\n  useEffect(() => {\r\n    const root = document.documentElement;\r\n    \r\n    if (branding) {\r\n      if (branding.primary_color) {\r\n        root.style.setProperty('--org-primary', branding.primary_color);\r\n      }\r\n      if (branding.accent_color) {\r\n        root.style.setProperty('--org-accent', branding.accent_color);\r\n      }\r\n    } else {\r\n      // Reset to defaults when no branding\r\n      root.style.removeProperty('--org-primary');\r\n      root.style.removeProperty('--org-accent');\r\n    }\r\n\r\n    return () => {\r\n      // Cleanup on unmount\r\n      root.style.removeProperty('--org-primary');\r\n      root.style.removeProperty('--org-accent');\r\n    };\r\n  }, [branding]);\r\n\r\n  return (\r\n    <OrgThemeContext.Provider value={{ branding, isLoading }}>\r\n      {children}\r\n    </OrgThemeContext.Provider>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\organizations\\OrgContext.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'setSearchParams'. Either include it or remove the dependency array.","line":58,"column":6,"nodeType":"ArrayExpression","endLine":58,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [searchParams, orgId, setSearchParams]","fix":{"range":[2503,2524],"text":"[searchParams, orgId, setSearchParams]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":144,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":144,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useState } from 'react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useUserOrganizations } from '@/hooks/useUserOrganization';\r\nimport type { UserOrganizationMembership } from '@/hooks/useUserOrganization';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport { useOrgBranding } from '@/hooks/useOrgBranding';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\n\r\ninterface OrgContextType {\r\n  currentOrg: UserOrganizationMembership | null;\r\n  organizations: UserOrganizationMembership[];\r\n  isLoading: boolean;\r\n  activeOrgId: string | null;\r\n  isPersonalMode: boolean;\r\n  switchOrganization: (orgId: string | null) => void;\r\n  switchToPersonal: () => void;\r\n  // Navigation context helpers\r\n  getNavigationContext: () => 'personal' | 'org-student' | 'org-instructor';\r\n  getUserRole: () => 'owner' | 'instructor' | 'student' | null;\r\n}\r\n\r\nconst OrgContext = createContext<OrgContextType | undefined>(undefined);\r\n\r\nexport function OrgProvider({ children, orgId }: { children: React.ReactNode; orgId?: string }) {\r\n  const { user } = useAuth();\r\n  const { data: organizations = [], isLoading } = useUserOrganizations();\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const [activeOrgId, setActiveOrgId] = useState<string | null>(null);\r\n  const [currentOrg, setCurrentOrg] = useState<UserOrganizationMembership | null>(null);\r\n\r\n  // Initialize activeOrgId from URL params, props, or localStorage (safe)\r\n  useEffect(() => {\r\n    const orgFromUrl = searchParams.get('org');\r\n    const orgFromStorage = safeLocalStorage.getItem<string>('fpk.activeOrgId', {\r\n      fallbackValue: null,\r\n      logErrors: false\r\n    });\r\n    \r\n    // Priority: URL param > orgId prop > localStorage\r\n    if (orgFromUrl) {\r\n      setActiveOrgId(orgFromUrl);\r\n      safeLocalStorage.setItem('fpk.activeOrgId', orgFromUrl);\r\n    } else if (orgId) {\r\n      setActiveOrgId(orgId);\r\n      safeLocalStorage.setItem('fpk.activeOrgId', orgId);\r\n      // Update URL to include org parameter for consistency\r\n      if (!searchParams.get('org')) {\r\n        const newSearchParams = new URLSearchParams(searchParams);\r\n        newSearchParams.set('org', orgId);\r\n        setSearchParams(newSearchParams, { replace: true });\r\n      }\r\n    } else if (orgFromStorage && orgFromStorage !== 'null') {\r\n      setActiveOrgId(orgFromStorage);\r\n    } else {\r\n      setActiveOrgId(null);\r\n    }\r\n  }, [searchParams, orgId]);\r\n\r\n  // Update currentOrg when activeOrgId or organizations change\r\n  useEffect(() => {\r\n    if (activeOrgId && organizations.length > 0) {\r\n      const org = organizations.find(o => o.organization_id === activeOrgId);\r\n      setCurrentOrg(org || null);\r\n    } else {\r\n      setCurrentOrg(null);\r\n    }\r\n  }, [activeOrgId, organizations]);\r\n\r\n  const switchOrganization = (orgId: string | null) => {\r\n    setActiveOrgId(orgId);\r\n    \r\n    if (orgId) {\r\n      safeLocalStorage.setItem('fpk.activeOrgId', orgId);\r\n      \r\n      // Find the organization to check the user's role\r\n      const selectedOrg = organizations.find(o => o.organization_id === orgId);\r\n      \r\n      // Navigate to appropriate dashboard based on role and current location\r\n      if (window.location.pathname.includes('/dashboard/')) {\r\n        if (selectedOrg?.role === 'owner' || selectedOrg?.role === 'instructor') {\r\n          // Navigate to instructor dashboard with org parameter\r\n          navigate(`/dashboard/instructor?org=${orgId}`);\r\n        } else {\r\n          // For students, stay on learner dashboard but add org parameter\r\n          const newSearchParams = new URLSearchParams(searchParams);\r\n          newSearchParams.set('org', orgId);\r\n          setSearchParams(newSearchParams);\r\n        }\r\n      }\r\n    } else {\r\n      safeLocalStorage.removeItem('fpk.activeOrgId');\r\n      // Remove org param from URL\r\n      const newSearchParams = new URLSearchParams(searchParams);\r\n      newSearchParams.delete('org');\r\n      setSearchParams(newSearchParams);\r\n    }\r\n  };\r\n\r\n  const switchToPersonal = () => {\r\n    switchOrganization(null);\r\n    // Navigate to learner dashboard if in org context\r\n    if (window.location.pathname.includes('/dashboard/instructor')) {\r\n      navigate('/dashboard/learner');\r\n    }\r\n  };\r\n\r\n  const isPersonalMode = activeOrgId === null;\r\n\r\n  // Helper functions for navigation context\r\n  const getNavigationContext = (): 'personal' | 'org-student' | 'org-instructor' => {\r\n    if (isPersonalMode) {\r\n      return 'personal';\r\n    }\r\n    \r\n    if (currentOrg?.role === 'owner' || currentOrg?.role === 'instructor') {\r\n      return 'org-instructor';\r\n    }\r\n    \r\n    return 'org-student';\r\n  };\r\n\r\n  const getUserRole = (): 'owner' | 'instructor' | 'student' | null => {\r\n    return currentOrg?.role || null;\r\n  };\r\n\r\n  return (\r\n    <OrgContext.Provider value={{\r\n      currentOrg,\r\n      organizations,\r\n      isLoading,\r\n      activeOrgId,\r\n      isPersonalMode,\r\n      switchOrganization,\r\n      switchToPersonal,\r\n      getNavigationContext,\r\n      getUserRole,\r\n    }}>\r\n      {children}\r\n    </OrgContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useOrgContext() {\r\n  const context = useContext(OrgContext);\r\n  if (context === undefined) {\r\n    throw new Error('useOrgContext must be used within an OrgProvider');\r\n  }\r\n  return context;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\organizations\\OrgGoalCreationDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\organizations\\OrgHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\organizations\\OrgLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\organizations\\OrgNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\organizations\\OrgPageLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\organizations\\OrgSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\scorm\\ErrorBanners.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\scorm\\ScormAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\scorm\\ScormCatalog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\scorm\\ScormIframe.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\scorm\\ScormPackageList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\scorm\\ScormPlayerBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\scorm\\ScormUploader.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'uploadScormPackage'. Either include it or remove the dependency array.","line":66,"column":6,"nodeType":"ArrayExpression","endLine":66,"endColumn":54,"suggestions":[{"desc":"Update the dependencies array to be: [packageInfo.title, toast, uploadScormPackage, uploadedFiles.length]","fix":{"range":[2327,2375],"text":"[packageInfo.title, toast, uploadScormPackage, uploadedFiles.length]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback } from \"react\";\r\nimport { useDropzone } from \"react-dropzone\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\r\nimport { Upload, File, CheckCircle, AlertCircle, X } from \"lucide-react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\n\r\ninterface ScormUploaderProps {\r\n  onUploadComplete?: () => void;\r\n}\r\n\r\ninterface UploadedFile {\r\n  file: File;\r\n  progress: number;\r\n  status: 'uploading' | 'processing' | 'completed' | 'error';\r\n  error?: string;\r\n  packageId?: string;\r\n}\r\n\r\nexport function ScormUploader({ onUploadComplete }: ScormUploaderProps) {\r\n  const [uploadedFiles, setUploadedFiles] = useState<UploadedFile[]>([]);\r\n  const [packageInfo, setPackageInfo] = useState({\r\n    title: \"\",\r\n    description: \"\",\r\n    category: \"general\"\r\n  });\r\n  const { toast } = useToast();\r\n\r\n  const onDrop = useCallback((acceptedFiles: File[]) => {\r\n    const scormFiles = acceptedFiles.filter(file => {\r\n      return file.name.toLowerCase().endsWith('.zip') && file.size <= 300 * 1024 * 1024; // 300MB limit\r\n    });\r\n\r\n    if (scormFiles.length !== acceptedFiles.length) {\r\n      toast({\r\n        title: \"Invalid files detected\",\r\n        description: \"Only ZIP files under 300MB are allowed for SCORM packages.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n\r\n    const newFiles: UploadedFile[] = scormFiles.map(file => ({\r\n      file,\r\n      progress: 0,\r\n      status: 'uploading'\r\n    }));\r\n\r\n    setUploadedFiles(prev => [...prev, ...newFiles]);\r\n\r\n    // Auto-fill title from filename if empty\r\n    if (!packageInfo.title && scormFiles.length > 0) {\r\n      const fileName = scormFiles[0].name.replace('.zip', '');\r\n      setPackageInfo(prev => ({ ...prev, title: fileName }));\r\n    }\r\n\r\n    // Start upload process for each file\r\n    newFiles.forEach((fileInfo, index) => {\r\n      uploadScormPackage(fileInfo, index + uploadedFiles.length);\r\n    });\r\n  }, [uploadedFiles.length, packageInfo.title, toast]);\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    accept: {\r\n      'application/zip': ['.zip']\r\n    },\r\n    multiple: false,\r\n    maxSize: 300 * 1024 * 1024 // 300MB\r\n  });\r\n\r\n  const uploadScormPackage = async (fileInfo: UploadedFile, fileIndex: number) => {\r\n    try {\r\n      const { file } = fileInfo;\r\n      \r\n      // Get current user\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) {\r\n        throw new Error('User not authenticated');\r\n      }\r\n      \r\n      // Step 1: Upload ZIP to storage\r\n      const storageKey = `scorm-packages/${Date.now()}-${file.name}`;\r\n      \r\n      updateFileProgress(fileIndex, 10, 'uploading');\r\n      \r\n      const { error: uploadError } = await supabase.storage\r\n        .from('scorm-packages')\r\n        .upload(storageKey, file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      updateFileProgress(fileIndex, 50, 'processing');\r\n\r\n      // Step 2: Create package record\r\n      const { data: packageData, error: packageError } = await supabase\r\n        .from('scorm_packages')\r\n        .insert({\r\n          title: packageInfo.title || file.name.replace('.zip', ''),\r\n          description: packageInfo.description,\r\n          zip_path: storageKey,\r\n          status: 'uploading',\r\n          created_by: user.id,\r\n          metadata: {\r\n            originalFileName: file.name,\r\n            fileSize: file.size,\r\n            uploadedAt: new Date().toISOString()\r\n          }\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (packageError) throw packageError;\r\n\r\n      // Step 3: Process package with edge function\r\n      const { data, error: processError } = await supabase.functions.invoke('scorm-parser-production', {\r\n        body: {\r\n          packageId: packageData.id,\r\n          fileName: file.name,\r\n          fileSize: file.size\r\n        }\r\n      });\r\n\r\n      if (processError) throw processError;\r\n\r\n      updateFileProgress(fileIndex, 100, 'completed');\r\n      \r\n      setUploadedFiles(prev => \r\n        prev.map((f, i) => \r\n          i === fileIndex ? { ...f, packageId: packageData.id } : f\r\n        )\r\n      );\r\n\r\n      toast({\r\n        title: \"SCORM package uploaded successfully\",\r\n        description: `${file.name} has been processed and is ready to use.`\r\n      });\r\n\r\n      if (onUploadComplete) {\r\n        onUploadComplete();\r\n      }\r\n\r\n    } catch (error: unknown) {\r\n      console.error('Upload error:', error);\r\n      const errorMessage = error instanceof Error ? error.message : 'Upload failed';\r\n      updateFileProgress(fileIndex, 0, 'error', errorMessage);\r\n      \r\n      toast({\r\n        title: \"Upload failed\",\r\n        description: errorMessage,\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const updateFileProgress = (\r\n    fileIndex: number, \r\n    progress: number, \r\n    status: UploadedFile['status'],\r\n    error?: string\r\n  ) => {\r\n    setUploadedFiles(prev => \r\n      prev.map((file, i) => \r\n        i === fileIndex ? { ...file, progress, status, error } : file\r\n      )\r\n    );\r\n  };\r\n\r\n  const removeFile = (fileIndex: number) => {\r\n    setUploadedFiles(prev => prev.filter((_, i) => i !== fileIndex));\r\n  };\r\n\r\n  const getStatusIcon = (status: UploadedFile['status']) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      case 'error':\r\n        return <AlertCircle className=\"h-4 w-4 text-red-500\" />;\r\n      default:\r\n        return <Upload className=\"h-4 w-4 text-blue-500\" />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Package Information Form */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <Label htmlFor=\"title\">Package Title</Label>\r\n          <Input\r\n            id=\"title\"\r\n            placeholder=\"Enter package title\"\r\n            value={packageInfo.title}\r\n            onChange={(e) => setPackageInfo(prev => ({ ...prev, title: e.target.value }))}\r\n          />\r\n        </div>\r\n        <div>\r\n          <Label htmlFor=\"category\">Category</Label>\r\n          <Input\r\n            id=\"category\"\r\n            placeholder=\"e.g., Training, Compliance\"\r\n            value={packageInfo.category}\r\n            onChange={(e) => setPackageInfo(prev => ({ ...prev, category: e.target.value }))}\r\n          />\r\n        </div>\r\n      </div>\r\n      \r\n      <div>\r\n        <Label htmlFor=\"description\">Description</Label>\r\n        <Textarea\r\n          id=\"description\"\r\n          placeholder=\"Describe the learning content\"\r\n          value={packageInfo.description}\r\n          onChange={(e) => setPackageInfo(prev => ({ ...prev, description: e.target.value }))}\r\n        />\r\n      </div>\r\n\r\n      {/* Upload Area */}\r\n      <Card \r\n        {...getRootProps()} \r\n        className={`cursor-pointer border-2 border-dashed transition-colors ${\r\n          isDragActive ? 'border-primary bg-primary/5' : 'border-muted-foreground/25 hover:border-primary/50'\r\n        }`}\r\n      >\r\n        <CardContent className=\"flex flex-col items-center justify-center py-12\">\r\n          <input {...getInputProps()} />\r\n          <File className={`h-12 w-12 mb-4 ${isDragActive ? 'text-primary' : 'text-muted-foreground'}`} />\r\n          <div className=\"text-center\">\r\n            <p className=\"text-lg font-semibold mb-2\">\r\n              {isDragActive ? 'Drop your SCORM package here' : 'Upload SCORM Package'}\r\n            </p>\r\n            <p className=\"text-muted-foreground mb-4\">\r\n              Drag and drop a ZIP file containing your SCORM package, or click to browse\r\n            </p>\r\n            <Button type=\"button\">\r\n              Choose File\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Upload Progress */}\r\n      {uploadedFiles.length > 0 && (\r\n        <div className=\"space-y-4\">\r\n          <h3 className=\"font-semibold\">Upload Progress</h3>\r\n          {uploadedFiles.map((file, index) => (\r\n            <Card key={index}>\r\n              <CardContent className=\"p-4\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    {getStatusIcon(file.status)}\r\n                    <span className=\"font-medium\">{file.file.name}</span>\r\n                  </div>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    onClick={() => removeFile(index)}\r\n                    disabled={file.status === 'uploading' || file.status === 'processing'}\r\n                  >\r\n                    <X className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n                \r\n                {file.status !== 'completed' && file.status !== 'error' && (\r\n                  <Progress value={file.progress} className=\"mb-2\" />\r\n                )}\r\n                \r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  {file.status === 'uploading' && 'Uploading file...'}\r\n                  {file.status === 'processing' && 'Processing SCORM package...'}\r\n                  {file.status === 'completed' && `Successfully processed (Package ID: ${file.packageId})`}\r\n                  {file.status === 'error' && `Error: ${file.error}`}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Help Information */}\r\n      <Alert>\r\n        <AlertCircle className=\"h-4 w-4\" />\r\n        <AlertDescription>\r\n          <strong>SCORM Package Requirements:</strong>\r\n          <ul className=\"mt-2 ml-4 list-disc space-y-1 text-sm\">\r\n            <li>ZIP file containing imsmanifest.xml in the root</li>\r\n            <li>SCORM 1.2 or 2004 standard supported</li>\r\n            <li>Maximum file size: 300MB</li>\r\n            <li>All referenced files must be included in the ZIP</li>\r\n          </ul>\r\n        </AlertDescription>\r\n      </Alert>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\AccessibilitySettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\AvatarUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\EnhancedAvatarUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\IntegrationSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\LanguageSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\LearningStyleTags.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\LivePreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\NotificationSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\PasswordChangeForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\ProfileSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\SecuritySection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\settings\\SettingsHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\FlashcardFolderList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\FlashcardIndividualList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\FlashcardReview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\FlashcardSelectionHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\FlashcardSelectionModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\MemoryTestSession.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\MultipleChoiceSession.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'generateOptions'. Either include it or remove the dependency array.","line":39,"column":6,"nodeType":"ArrayExpression","endLine":39,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [currentIndex, currentCard, generateOptions]","fix":{"range":[1504,1531],"text":"[currentIndex, currentCard, generateOptions]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useStudySessions } from '@/hooks/useStudySessions';\r\nimport { useFlashcards } from '@/hooks/useFlashcards';\r\nimport { Check, X, ArrowLeft } from 'lucide-react';\r\nimport type { StudySession } from '@/hooks/useStudySessions';\r\nimport type { Flashcard } from '@/hooks/useFlashcards';\r\n\r\ninterface MultipleChoiceSessionProps {\r\n  session: StudySession;\r\n  flashcards: Flashcard[];\r\n  onComplete: () => void;\r\n}\r\n\r\nconst MultipleChoiceSession: React.FC<MultipleChoiceSessionProps> = ({\r\n  session,\r\n  flashcards,\r\n  onComplete\r\n}) => {\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [selectedAnswer, setSelectedAnswer] = useState<number | null>(null);\r\n  const [showResult, setShowResult] = useState(false);\r\n  const [answers, setAnswers] = useState<boolean[]>([]);\r\n  const [options, setOptions] = useState<string[]>([]);\r\n  const [correctIndex, setCorrectIndex] = useState(0);\r\n  const [startTime] = useState(Date.now());\r\n  const { completeSession } = useStudySessions();\r\n  const { updateFlashcard } = useFlashcards();\r\n\r\n  const currentCard = flashcards[currentIndex];\r\n  const progress = ((currentIndex + (answers.length > currentIndex ? 1 : 0)) / flashcards.length) * 100;\r\n\r\n  useEffect(() => {\r\n    if (currentCard) {\r\n      generateOptions();\r\n    }\r\n  }, [currentIndex, currentCard]);\r\n\r\n  const generateOptions = () => {\r\n    const correctAnswer = currentCard.back_content;\r\n    const otherCards = flashcards.filter(card => card.id !== currentCard.id);\r\n    \r\n    // Get 3 random wrong answers\r\n    const wrongAnswers = otherCards\r\n      .sort(() => Math.random() - 0.5)\r\n      .slice(0, 3)\r\n      .map(card => card.back_content);\r\n    \r\n    // Combine and shuffle\r\n    const allOptions = [correctAnswer, ...wrongAnswers];\r\n    const shuffled = allOptions.sort(() => Math.random() - 0.5);\r\n    \r\n    setOptions(shuffled);\r\n    setCorrectIndex(shuffled.indexOf(correctAnswer));\r\n    setSelectedAnswer(null);\r\n    setShowResult(false);\r\n  };\r\n\r\n  const handleAnswer = (answerIndex: number) => {\r\n    if (showResult) return;\r\n    \r\n    setSelectedAnswer(answerIndex);\r\n    setShowResult(true);\r\n    \r\n    const isCorrect = answerIndex === correctIndex;\r\n    const newAnswers = [...answers];\r\n    newAnswers[currentIndex] = isCorrect;\r\n    setAnswers(newAnswers);\r\n\r\n    // Update flashcard statistics\r\n    updateFlashcard({\r\n      id: currentCard.id,\r\n      times_reviewed: currentCard.times_reviewed + 1,\r\n      times_correct: isCorrect ? currentCard.times_correct + 1 : currentCard.times_correct,\r\n      last_reviewed_at: new Date().toISOString()\r\n    });\r\n\r\n    // Move to next card or complete session\r\n    setTimeout(() => {\r\n      if (currentIndex < flashcards.length - 1) {\r\n        setCurrentIndex(currentIndex + 1);\r\n      } else {\r\n        handleComplete(newAnswers);\r\n      }\r\n    }, 1500);\r\n  };\r\n\r\n  const handleComplete = (finalAnswers: boolean[]) => {\r\n    const correctCount = finalAnswers.filter(Boolean).length;\r\n    const incorrectCount = finalAnswers.length - correctCount;\r\n    const duration = Math.round((Date.now() - startTime) / 1000);\r\n\r\n    completeSession({\r\n      id: session.id,\r\n      correct_answers: correctCount,\r\n      incorrect_answers: incorrectCount,\r\n      session_duration_seconds: duration\r\n    });\r\n\r\n    setTimeout(onComplete, 1000);\r\n  };\r\n\r\n  if (currentIndex >= flashcards.length && answers.length === flashcards.length) {\r\n    const correctCount = answers.filter(Boolean).length;\r\n    const accuracy = Math.round((correctCount / answers.length) * 100);\r\n\r\n    return (\r\n      <div className=\"max-w-2xl mx-auto p-6\">\r\n        <Card className=\"text-center\">\r\n          <CardContent className=\"p-8\">\r\n            <div className=\"mb-6\">\r\n              <div className=\"text-4xl mb-4\">ðŸŽ¯</div>\r\n              <h2 className=\"text-2xl font-bold mb-2\">Session Complete!</h2>\r\n              <p className=\"text-gray-600\">Great job on your multiple choice test!</p>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-3 gap-4 mb-6\">\r\n              <div className=\"p-4 bg-blue-50 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-blue-900\">{answers.length}</div>\r\n                <div className=\"text-sm text-blue-700\">Questions</div>\r\n              </div>\r\n              <div className=\"p-4 bg-green-50 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-green-900\">{correctCount}</div>\r\n                <div className=\"text-sm text-green-700\">Correct</div>\r\n              </div>\r\n              <div className=\"p-4 bg-purple-50 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-purple-900\">{accuracy}%</div>\r\n                <div className=\"text-sm text-purple-700\">Score</div>\r\n              </div>\r\n            </div>\r\n\r\n            <Button onClick={onComplete} className=\"w-full\">\r\n              Return to Notes\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto p-6\">\r\n      <div className=\"mb-6\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"sm\" \r\n              onClick={onComplete}\r\n              className=\"text-gray-600 hover:text-gray-900\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              Exit\r\n            </Button>\r\n            <h1 className=\"text-xl font-bold\">Multiple Choice</h1>\r\n          </div>\r\n          <span className=\"text-sm text-gray-600\">\r\n            {currentIndex + 1} of {flashcards.length}\r\n          </span>\r\n        </div>\r\n        <Progress value={progress} className=\"h-2\" />\r\n      </div>\r\n\r\n      <Card className=\"mb-6\">\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"text-center mb-6\">\r\n            <div className=\"text-sm text-gray-500 mb-2\">Question</div>\r\n            <div className=\"text-lg font-medium leading-relaxed\">\r\n              {currentCard?.front_content}\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"space-y-3\">\r\n        {options.map((option, index) => {\r\n          let buttonClass = \"w-full text-left p-4 border rounded-lg transition-colors \";\r\n          \r\n          if (!showResult) {\r\n            buttonClass += \"hover:bg-gray-50 border-gray-200\";\r\n          } else {\r\n            if (index === correctIndex) {\r\n              buttonClass += \"bg-green-100 border-green-300 text-green-900\";\r\n            } else if (index === selectedAnswer && index !== correctIndex) {\r\n              buttonClass += \"bg-red-100 border-red-300 text-red-900\";\r\n            } else {\r\n              buttonClass += \"bg-gray-50 border-gray-200 text-gray-600\";\r\n            }\r\n          }\r\n\r\n          return (\r\n            <button\r\n              key={index}\r\n              onClick={() => handleAnswer(index)}\r\n              disabled={showResult}\r\n              className={buttonClass}\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"flex-1\">{option}</span>\r\n                {showResult && index === correctIndex && (\r\n                  <Check className=\"h-5 w-5 text-green-600\" />\r\n                )}\r\n                {showResult && index === selectedAnswer && index !== correctIndex && (\r\n                  <X className=\"h-5 w-5 text-red-600\" />\r\n                )}\r\n              </div>\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MultipleChoiceSession;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\QuizletSearchTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\StudySessionRouter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\study\\TimedChallengeSession.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'generateOptions'. Either include it or remove the dependency array.","line":41,"column":6,"nodeType":"ArrayExpression","endLine":41,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [currentIndex, currentCard, generateOptions]","fix":{"range":[1585,1612],"text":"[currentIndex, currentCard, generateOptions]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'flashcards.length' and 'handleTimeUp'. Either include them or remove the dependency array.","line":50,"column":6,"nodeType":"ArrayExpression","endLine":50,"endColumn":42,"suggestions":[{"desc":"Update the dependencies array to be: [timeLeft, showResult, currentIndex, flashcards.length, handleTimeUp]","fix":{"range":[1912,1948],"text":"[timeLeft, showResult, currentIndex, flashcards.length, handleTimeUp]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useStudySessions } from '@/hooks/useStudySessions';\r\nimport { useFlashcards } from '@/hooks/useFlashcards';\r\nimport { Clock, Check, X, ArrowLeft } from 'lucide-react';\r\nimport type { StudySession } from '@/hooks/useStudySessions';\r\nimport type { Flashcard } from '@/hooks/useFlashcards';\r\n\r\ninterface TimedChallengeSessionProps {\r\n  session: StudySession;\r\n  flashcards: Flashcard[];\r\n  onComplete: () => void;\r\n}\r\n\r\nconst TimedChallengeSession: React.FC<TimedChallengeSessionProps> = ({\r\n  session,\r\n  flashcards,\r\n  onComplete\r\n}) => {\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [selectedAnswer, setSelectedAnswer] = useState<number | null>(null);\r\n  const [timeLeft, setTimeLeft] = useState(30); // 30 seconds per card\r\n  const [showResult, setShowResult] = useState(false);\r\n  const [answers, setAnswers] = useState<boolean[]>([]);\r\n  const [options, setOptions] = useState<string[]>([]);\r\n  const [correctIndex, setCorrectIndex] = useState(0);\r\n  const [startTime] = useState(Date.now());\r\n  const { completeSession } = useStudySessions();\r\n  const { updateFlashcard } = useFlashcards();\r\n\r\n  const currentCard = flashcards[currentIndex];\r\n  const progress = ((currentIndex + (answers.length > currentIndex ? 1 : 0)) / flashcards.length) * 100;\r\n\r\n  useEffect(() => {\r\n    if (currentCard) {\r\n      generateOptions();\r\n    }\r\n  }, [currentIndex, currentCard]);\r\n\r\n  useEffect(() => {\r\n    if (timeLeft > 0 && !showResult && currentIndex < flashcards.length) {\r\n      const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);\r\n      return () => clearTimeout(timer);\r\n    } else if (timeLeft === 0 && !showResult) {\r\n      handleTimeUp();\r\n    }\r\n  }, [timeLeft, showResult, currentIndex]);\r\n\r\n  useEffect(() => {\r\n    setTimeLeft(30);\r\n    setSelectedAnswer(null);\r\n    setShowResult(false);\r\n  }, [currentIndex]);\r\n\r\n  const generateOptions = () => {\r\n    const correctAnswer = currentCard.back_content;\r\n    const otherCards = flashcards.filter(card => card.id !== currentCard.id);\r\n    \r\n    // Get 3 random wrong answers\r\n    const wrongAnswers = otherCards\r\n      .sort(() => Math.random() - 0.5)\r\n      .slice(0, 3)\r\n      .map(card => card.back_content);\r\n    \r\n    // Combine and shuffle\r\n    const allOptions = [correctAnswer, ...wrongAnswers];\r\n    const shuffled = allOptions.sort(() => Math.random() - 0.5);\r\n    \r\n    setOptions(shuffled);\r\n    setCorrectIndex(shuffled.indexOf(correctAnswer));\r\n  };\r\n\r\n  const handleTimeUp = () => {\r\n    handleAnswer(-1); // -1 indicates timeout (no answer selected)\r\n  };\r\n\r\n  const handleAnswer = (answerIndex: number) => {\r\n    if (showResult) return;\r\n    \r\n    setSelectedAnswer(answerIndex);\r\n    setShowResult(true);\r\n    \r\n    const isCorrect = answerIndex === correctIndex;\r\n    const newAnswers = [...answers];\r\n    newAnswers[currentIndex] = isCorrect;\r\n    setAnswers(newAnswers);\r\n\r\n    // Update flashcard statistics\r\n    updateFlashcard({\r\n      id: currentCard.id,\r\n      times_reviewed: currentCard.times_reviewed + 1,\r\n      times_correct: isCorrect ? currentCard.times_correct + 1 : currentCard.times_correct,\r\n      last_reviewed_at: new Date().toISOString()\r\n    });\r\n\r\n    // Move to next card or complete session\r\n    setTimeout(() => {\r\n      if (currentIndex < flashcards.length - 1) {\r\n        setCurrentIndex(currentIndex + 1);\r\n      } else {\r\n        handleComplete(newAnswers);\r\n      }\r\n    }, 2000);\r\n  };\r\n\r\n  const handleComplete = (finalAnswers: boolean[]) => {\r\n    const correctCount = finalAnswers.filter(Boolean).length;\r\n    const incorrectCount = finalAnswers.length - correctCount;\r\n    const duration = Math.round((Date.now() - startTime) / 1000);\r\n\r\n    completeSession({\r\n      id: session.id,\r\n      correct_answers: correctCount,\r\n      incorrect_answers: incorrectCount,\r\n      session_duration_seconds: duration\r\n    });\r\n\r\n    setTimeout(onComplete, 1000);\r\n  };\r\n\r\n  if (currentIndex >= flashcards.length && answers.length === flashcards.length) {\r\n    const correctCount = answers.filter(Boolean).length;\r\n    const accuracy = Math.round((correctCount / answers.length) * 100);\r\n    const totalTime = Math.round((Date.now() - startTime) / 1000);\r\n\r\n    return (\r\n      <div className=\"max-w-2xl mx-auto p-6\">\r\n        <Card className=\"text-center\">\r\n          <CardContent className=\"p-8\">\r\n            <div className=\"mb-6\">\r\n              <div className=\"text-4xl mb-4\">âš¡</div>\r\n              <h2 className=\"text-2xl font-bold mb-2\">Challenge Complete!</h2>\r\n              <p className=\"text-gray-600\">You beat the clock!</p>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-4 gap-4 mb-6\">\r\n              <div className=\"p-4 bg-blue-50 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-blue-900\">{answers.length}</div>\r\n                <div className=\"text-sm text-blue-700\">Cards</div>\r\n              </div>\r\n              <div className=\"p-4 bg-green-50 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-green-900\">{correctCount}</div>\r\n                <div className=\"text-sm text-green-700\">Correct</div>\r\n              </div>\r\n              <div className=\"p-4 bg-purple-50 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-purple-900\">{accuracy}%</div>\r\n                <div className=\"text-sm text-purple-700\">Accuracy</div>\r\n              </div>\r\n              <div className=\"p-4 bg-orange-50 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-orange-900\">{totalTime}s</div>\r\n                <div className=\"text-sm text-orange-700\">Time</div>\r\n              </div>\r\n            </div>\r\n\r\n            <Button onClick={onComplete} className=\"w-full\">\r\n              Return to Notes\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const timePercentage = (timeLeft / 30) * 100;\r\n  const isLowTime = timeLeft <= 10;\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto p-6\">\r\n      <div className=\"mb-6\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"sm\" \r\n              onClick={onComplete}\r\n              className=\"text-gray-600 hover:text-gray-900\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              Exit\r\n            </Button>\r\n            <h1 className=\"text-xl font-bold\">Timed Challenge</h1>\r\n          </div>\r\n          <div className={`flex items-center gap-2 ${isLowTime ? 'text-red-600' : 'text-gray-600'}`}>\r\n            <Clock className=\"h-4 w-4\" />\r\n            <span className=\"font-mono text-lg\">{timeLeft}s</span>\r\n          </div>\r\n        </div>\r\n        <div className=\"space-y-2\">\r\n          <Progress value={progress} className=\"h-2\" />\r\n          <Progress \r\n            value={timePercentage} \r\n            className={`h-1 ${isLowTime ? 'bg-red-100' : 'bg-orange-100'}`}\r\n          />\r\n        </div>\r\n        <div className=\"text-xs text-gray-500 mt-1\">\r\n          Question {currentIndex + 1} of {flashcards.length}\r\n        </div>\r\n      </div>\r\n\r\n      <Card className=\"mb-6\">\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"text-center mb-6\">\r\n            <div className=\"text-sm text-gray-500 mb-2\">Question</div>\r\n            <div className=\"text-lg font-medium leading-relaxed\">\r\n              {currentCard?.front_content}\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"space-y-3\">\r\n        {showResult && timeLeft === 0 && selectedAnswer === -1 && (\r\n          <div className=\"text-center p-4 bg-red-100 text-red-900 rounded-lg mb-4\">\r\n            <div className=\"font-medium\">Time's up!</div>\r\n            <div className=\"text-sm\">Correct answer: \"{currentCard?.back_content}\"</div>\r\n          </div>\r\n        )}\r\n        \r\n        {options.map((option, index) => {\r\n          let buttonClass = \"w-full text-left p-4 border rounded-lg transition-colors \";\r\n          \r\n          if (!showResult && timeLeft > 0) {\r\n            buttonClass += \"hover:bg-gray-50 border-gray-200\";\r\n          } else {\r\n            if (index === correctIndex) {\r\n              buttonClass += \"bg-green-100 border-green-300 text-green-900\";\r\n            } else if (index === selectedAnswer && index !== correctIndex) {\r\n              buttonClass += \"bg-red-100 border-red-300 text-red-900\";\r\n            } else {\r\n              buttonClass += \"bg-gray-50 border-gray-200 text-gray-600\";\r\n            }\r\n          }\r\n\r\n          return (\r\n            <button\r\n              key={index}\r\n              onClick={() => handleAnswer(index)}\r\n              disabled={showResult || timeLeft === 0}\r\n              className={buttonClass}\r\n              aria-label={`Option ${index + 1}: ${option}`}\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"flex-1\">{option}</span>\r\n                {showResult && index === correctIndex && (\r\n                  <Check className=\"h-5 w-5 text-green-600\" />\r\n                )}\r\n                {showResult && index === selectedAnswer && index !== correctIndex && (\r\n                  <X className=\"h-5 w-5 text-red-600\" />\r\n                )}\r\n              </div>\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TimedChallengeSession;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\subscription\\SubscriptionPlans.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":331,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":331,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10455,10458],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10455,10458],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Check, Loader2, DollarSign, Euro } from 'lucide-react';\r\nimport { useSubscription } from '@/hooks/useSubscription';\r\nimport { useOrganizations } from '@/hooks/useOrganizations';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\n// Beta mode flag - set to false to re-enable subscription buttons post-beta\r\nconst IS_BETA_MODE = true;\r\n\r\ninterface PlanType {\r\n  name: string;\r\n  badge: string;\r\n  monthly: number;\r\n  annual: number;\r\n  popular?: boolean;\r\n  isBeta?: boolean;\r\n  features: string[];\r\n}\r\n\r\n// Organization subscription plans\r\nconst ORG_PLANS: Record<'basic' | 'standard' | 'premium' | 'beta', PlanType> = {\r\n  basic: {\r\n    name: 'FPK Instructor Basic',\r\n    badge: 'Up to 3 Students',\r\n    monthly: 29,\r\n    annual: 290,\r\n    features: [\r\n      'Up to 3 students',\r\n      'Basic analytics',\r\n      'Goal tracking',\r\n      'Note management',\r\n      'Student progress reports',\r\n      'Course assignments',\r\n      'Email support'\r\n    ]\r\n  },\r\n  standard: {\r\n    name: 'FPK Instructor Standard', \r\n    badge: 'Up to 10 Students',\r\n    monthly: 79,\r\n    annual: 790,\r\n    popular: true,\r\n    features: [\r\n      'Up to 10 students',\r\n      'Advanced analytics',\r\n      'Bulk operations',\r\n      'Custom reporting',\r\n      'Student portfolios',\r\n      'Assignment grading',\r\n      'Video conferencing',\r\n      'Priority support'\r\n    ]\r\n  },\r\n  premium: {\r\n    name: 'FPK Instructor Premium',\r\n    badge: 'Up to 25+ Students',\r\n    monthly: 149,\r\n    annual: 1490,\r\n    features: [\r\n      'Up to 25+ students',\r\n      'Full analytics suite',\r\n      'White-label options',\r\n      'API access',\r\n      'Custom integrations',\r\n      'Advanced reporting',\r\n      'Dedicated support',\r\n      'Early access features'\r\n    ]\r\n  },\r\n  beta: {\r\n    name: 'FPK Beta Access',\r\n    badge: 'Up to 50+ Students (FREE)',\r\n    monthly: 0,\r\n    annual: 0,\r\n    isBeta: true,\r\n    features: [\r\n      'Up to 50+ students (Beta)',\r\n      'Full analytics suite',\r\n      'White-label options',\r\n      'API access',\r\n      'Custom integrations',\r\n      'Advanced reporting',\r\n      'Dedicated support',\r\n      'Early access features',\r\n      'ðŸ†“ Free during beta period',\r\n      'â° Limited time offer'\r\n    ]\r\n  }\r\n};\r\n\r\nconst PLANS: Record<'calm' | 'me' | 'us' | 'universal', PlanType> = {\r\n  calm: {\r\n    name: 'FPK Calm',\r\n    badge: 'Free',\r\n    monthly: 0,\r\n    annual: 0,\r\n    features: [\r\n      '1 seat included',\r\n      '5 AI chat messages/month',\r\n      '2 minutes voice processing/month',\r\n      '3 knowledge queries/month',\r\n      '1 document processing/month',\r\n      '25 flashcard generations/month',\r\n      '5 AI insights/month',\r\n      '10MB storage',\r\n      'Community support'\r\n    ]\r\n  },\r\n  me: {\r\n    name: 'FPK Me',\r\n    badge: 'Individual',\r\n    monthly: 16.49,\r\n    annual: 179.88, // Updated to annual total\r\n    features: [\r\n      '1 seat included',\r\n      '150 AI chat messages/month',\r\n      '90 minutes voice processing/month',\r\n      '75 knowledge queries/month',\r\n      '15 document processing/month',\r\n      '300 flashcard generations/month',\r\n      '75 AI insights/month',\r\n      '200MB knowledge storage',\r\n      'Personal progress tracking',\r\n      'Email support'\r\n    ]\r\n  },\r\n  us: {\r\n    name: 'FPK Us',\r\n    badge: 'Family',\r\n    monthly: 26.39,\r\n    annual: 287.88, // Updated to annual total\r\n    popular: true,\r\n    features: [\r\n      'ðŸ  3 family member seats',\r\n      '500 AI chat messages/month (shared)',\r\n      '300 minutes voice processing/month (shared)',\r\n      '250 knowledge queries/month (shared)',\r\n      '50 document processing/month (shared)',\r\n      '1,000 flashcard generations/month (shared)',\r\n      '200 AI insights/month (shared)',\r\n      '1GB knowledge storage (shared)',\r\n      'Family progress dashboard',\r\n      'Individual member tracking',\r\n      'Priority support'\r\n    ]\r\n  },\r\n  universal: {\r\n    name: 'FPK Universal',\r\n    badge: 'Premium',\r\n    monthly: 54.99,\r\n    annual: 599.88, // Updated to annual total\r\n    features: [\r\n      '1 seat included',\r\n      'ðŸš€ Unlimited AI interactions',\r\n      'ðŸš€ Unlimited voice processing',\r\n      'ðŸš€ Unlimited knowledge queries',\r\n      'ðŸš€ Unlimited document processing',\r\n      'ðŸš€ Unlimited flashcard generation',\r\n      'ðŸš€ Unlimited AI insights',\r\n      '5GB knowledge storage',\r\n      'Advanced analytics dashboard',\r\n      'Advanced course creation tools',\r\n      'White-label options',\r\n      'API access (coming soon)',\r\n      'Dedicated support',\r\n      'Early access to new features'\r\n    ]\r\n  }\r\n};\r\n\r\nexport function SubscriptionPlans() {\r\n  const [isAnnual, setIsAnnual] = useState(true); // Changed to true to make annual default\r\n  const [isEuro, setIsEuro] = useState(false);\r\n  const [couponCode, setCouponCode] = useState('');\r\n  const [loading, setLoading] = useState<string | null>(null);\r\n  const [planType, setPlanType] = useState<'individual' | 'organization'>('individual');\r\n  const { subscription, createCheckout } = useSubscription();\r\n  const { toast } = useToast();\r\n\r\n  const EUR_RATE = 1; // Prices are already in EUR\r\n\r\n  const handleSubscribe = async (tier: 'me' | 'us' | 'universal') => {\r\n    try {\r\n      setLoading(tier);\r\n      const interval = isAnnual ? 'annual' : 'monthly';\r\n      await createCheckout(tier, interval, couponCode || undefined);\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error instanceof Error ? error.message : \"Failed to create checkout session\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(null);\r\n    }\r\n  };\r\n\r\n  const handleOrgSubscribe = async (tier: 'basic' | 'standard' | 'premium' | 'beta') => {\r\n    try {\r\n      setLoading(tier);\r\n      \r\n      if (tier === 'beta') {\r\n        // For beta tier, show success message and redirect to organization creation\r\n        toast({\r\n          title: \"Beta Access Granted!\",\r\n          description: \"You now have access to all Premium features for free during the beta period.\",\r\n        });\r\n        // Here you would typically redirect to organization creation\r\n        // For now, we'll just show the success message\r\n        return;\r\n      }\r\n\r\n      // For paid tiers, handle normal checkout process\r\n      // This would need to be implemented with organization-specific checkout\r\n      toast({\r\n        title: \"Coming Soon\",\r\n        description: \"Organization subscriptions will be available soon!\",\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error instanceof Error ? error.message : \"Failed to process subscription\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(null);\r\n    }\r\n  };\r\n\r\n  const getDiscountPercentage = (tier: 'calm' | 'me' | 'us' | 'universal') => {\r\n    if (tier === 'calm') return 0;\r\n    if (tier === 'me') return 10;\r\n    if (tier === 'us') return 15;\r\n    return 20;\r\n  };\r\n\r\n  const getCurrentPlanBadge = (tier: 'calm' | 'me' | 'us' | 'universal') => {\r\n    if (subscription.subscribed && subscription.subscription_tier === tier) {\r\n      return <Badge variant=\"default\" className=\"ml-2\">Current Plan</Badge>;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const formatPrice = (price: number) => {\r\n    const convertedPrice = isEuro ? price : price * 1.1; // Convert EUR to USD with ~10% markup\r\n    const symbol = isEuro ? 'â‚¬' : '$';\r\n    return `${symbol}${convertedPrice.toFixed(2)}`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Beta Mode Notice */}\r\n      {IS_BETA_MODE && (\r\n        <div className=\"text-center\">\r\n          <Badge className=\"bg-accent text-white font-semibold px-4 py-2 mb-2\">\r\n            BETA ACCESS ONLY\r\n          </Badge>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            Subscription buttons are disabled during beta. Use coupon codes below for access.\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Plan Type Toggle */}\r\n      <div className=\"flex flex-col items-center space-y-4\">\r\n        {/* Individual vs Organization Toggle */}\r\n        <div className=\"flex items-center space-x-4\">\r\n          <Label className=\"flex items-center\">\r\n            Individual Plans\r\n          </Label>\r\n          <Switch\r\n            checked={planType === 'organization'}\r\n            onCheckedChange={(checked) => setPlanType(checked ? 'organization' : 'individual')}\r\n          />\r\n          <Label className=\"flex items-center\">\r\n            Organization Plans\r\n          </Label>\r\n        </div>\r\n\r\n        {/* Currency Toggle */}\r\n        <div className=\"flex items-center space-x-4\">\r\n          <Label className=\"flex items-center\">\r\n            <DollarSign className=\"h-4 w-4 mr-1\" />\r\n            USD\r\n          </Label>\r\n          <Switch\r\n            checked={isEuro}\r\n            onCheckedChange={setIsEuro}\r\n          />\r\n          <Label className=\"flex items-center\">\r\n            <Euro className=\"h-4 w-4 mr-1\" />\r\n            EUR\r\n          </Label>\r\n        </div>\r\n        \r\n        {/* Annual/Monthly Toggle */}\r\n        <div className=\"flex items-center justify-center space-x-4\">\r\n          <Label htmlFor=\"billing-toggle\">Monthly</Label>\r\n          <Switch\r\n            id=\"billing-toggle\"\r\n            checked={isAnnual}\r\n            onCheckedChange={setIsAnnual}\r\n          />\r\n          <Label htmlFor=\"billing-toggle\">\r\n            Annual \r\n            <Badge variant=\"secondary\" className=\"ml-2\">Save up to 10%</Badge>\r\n          </Label>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Coupon Code Input */}\r\n      <div className=\"max-w-md mx-auto\">\r\n        <Label htmlFor=\"coupon\">Coupon Code</Label>\r\n        <Input\r\n          id=\"coupon\"\r\n          placeholder=\"Enter coupon code for discounts or free access\"\r\n          value={couponCode}\r\n          onChange={(e) => setCouponCode(e.target.value.toUpperCase())}\r\n        />\r\n      </div>\r\n\r\n      {/* Pricing Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        {Object.entries(planType === 'organization' ? ORG_PLANS : PLANS).map(([key, plan]) => {\r\n          const tier = key as any;\r\n          const price = isAnnual ? plan.annual : plan.monthly;\r\n          const monthlyPrice = isAnnual ? price / 12 : price;\r\n          const discount = isAnnual ? getDiscountPercentage(tier) : 0;\r\n          \r\n          return (\r\n            <Card key={tier} className={`relative ${\r\n              plan.popular ? 'ring-2 ring-primary border-primary shadow-lg' : ''\r\n            } ${\r\n              plan.isBeta ? 'ring-2 ring-gradient-to-r from-purple-500 to-pink-500 border-purple-500 shadow-xl bg-gradient-to-br from-purple-50 to-pink-50' : ''\r\n            }`}>\r\n              {plan.popular && (\r\n                <div className=\"absolute -top-2 -right-2 z-10\">\r\n                  <Badge className=\"bg-primary text-primary-foreground font-medium px-2 py-1 text-xs shadow-md rounded-full\">\r\n                    â­ Popular\r\n                  </Badge>\r\n                </div>\r\n              )}\r\n              {plan.isBeta && (\r\n                <div className=\"absolute -top-2 -left-2 z-10\">\r\n                  <Badge className=\"bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold px-3 py-1 text-xs shadow-lg rounded-full animate-pulse\">\r\n                    ðŸš€ BETA\r\n                  </Badge>\r\n                </div>\r\n              )}\r\n              \r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <div className=\"text-lg font-bold\">{plan.name}</div>\r\n                    <Badge variant=\"outline\" className=\"text-xs\">{plan.badge}</Badge>\r\n                  </div>\r\n                  {getCurrentPlanBadge(tier)}\r\n                </CardTitle>\r\n                 <CardDescription>\r\n                   <div className=\"text-3xl font-bold\">\r\n                     {formatPrice(monthlyPrice)}\r\n                     <span className=\"text-base font-normal\">/month</span>\r\n                   </div>\r\n                   {isAnnual && tier !== 'calm' && (\r\n                     <div className=\"text-sm text-muted-foreground\">\r\n                       <span className=\"line-through\">{formatPrice(plan.monthly)}/month</span>\r\n                       <Badge variant=\"secondary\" className=\"ml-2\">Save 10%</Badge>\r\n                     </div>\r\n                   )}\r\n                   {isAnnual && tier !== 'calm' && (\r\n                     <div className=\"text-sm text-muted-foreground mt-1\">\r\n                       Billed annually: {formatPrice(price)}\r\n                     </div>\r\n                   )}\r\n                 </CardDescription>\r\n              </CardHeader>\r\n              \r\n              <CardContent>\r\n                <ul className=\"space-y-2\">\r\n                  {plan.features.map((feature, index) => (\r\n                    <li key={index} className=\"flex items-center\">\r\n                      <Check className=\"h-4 w-4 text-green-500 mr-2 flex-shrink-0\" />\r\n                      <span className=\"text-sm\">{feature}</span>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </CardContent>\r\n              \r\n              <CardFooter>\r\n                <Button \r\n                  className=\"w-full\" \r\n                  onClick={() => {\r\n                    if (planType === 'organization') {\r\n                      if (plan.isBeta || !IS_BETA_MODE) {\r\n                        handleOrgSubscribe(tier as 'basic' | 'standard' | 'premium' | 'beta');\r\n                      }\r\n                    } else {\r\n                      if (!IS_BETA_MODE && tier !== 'calm') {\r\n                        handleSubscribe(tier as 'me' | 'us' | 'universal');\r\n                      }\r\n                    }\r\n                  }}\r\n                  disabled={\r\n                    planType === 'organization' \r\n                      ? (!plan.isBeta && IS_BETA_MODE) || loading === tier\r\n                      : IS_BETA_MODE || tier === 'calm' || loading === tier || (subscription.subscribed && subscription.subscription_tier === tier)\r\n                  }\r\n                  variant={\r\n                    plan.popular ? 'default' : \r\n                    plan.isBeta ? 'default' : \r\n                    tier === 'calm' ? 'outline' : \r\n                    'outline'\r\n                  }\r\n                >\r\n                  {planType === 'organization' ? (\r\n                    plan.isBeta ? (\r\n                      loading === tier ? (\r\n                        <>\r\n                          <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                          Processing...\r\n                        </>\r\n                      ) : (\r\n                        'Start Beta Access'\r\n                      )\r\n                    ) : IS_BETA_MODE ? (\r\n                      'Coming Soon'\r\n                    ) : loading === tier ? (\r\n                      <>\r\n                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                        Processing...\r\n                      </>\r\n                    ) : (\r\n                      `Subscribe to ${plan.badge}`\r\n                    )\r\n                  ) : (\r\n                    IS_BETA_MODE ? (\r\n                      'Beta Access Only'\r\n                    ) : tier === 'calm' ? (\r\n                      'Current Plan'\r\n                    ) : loading === tier ? (\r\n                      <>\r\n                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                        Processing...\r\n                      </>\r\n                    ) : subscription.subscribed && subscription.subscription_tier === tier ? (\r\n                      'Current Plan'\r\n                    ) : (\r\n                      `Subscribe to ${plan.badge}`\r\n                    )\r\n                  )}\r\n                </Button>\r\n              </CardFooter>\r\n            </Card>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Free Trial Coupons Info */}\r\n      <div className=\"text-center text-sm text-muted-foreground\">\r\n        <p>Try these coupon codes for free access:</p>\r\n        <div className=\"flex justify-center gap-4 mt-2\">\r\n          <Badge variant=\"outline\">BETA2025</Badge>\r\n          <Badge variant=\"outline\">FREEMONTH</Badge>\r\n          <Badge variant=\"outline\">WELCOME</Badge>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\subscription\\SubscriptionStatus.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\theme\\OrgThemeProvider.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'l' is never reassigned. Use 'const' instead.","line":62,"column":13,"nodeType":"Identifier","messageId":"useConst","endLine":62,"endColumn":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect } from 'react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\nimport { useOrgBranding } from '@/hooks/useOrgBranding';\r\n\r\ninterface OrgThemeProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport function OrgThemeProvider({ children }: OrgThemeProviderProps) {\r\n  const { currentOrg, isPersonalMode } = useOrgContext();\r\n  const { data: branding } = useOrgBranding(currentOrg?.organization_id || null);\r\n\r\n  useEffect(() => {\r\n    const root = document.documentElement;\r\n\r\n    if (isPersonalMode || !branding?.theme_accent) {\r\n      // Reset to default theme\r\n      root.style.removeProperty('--accent');\r\n      root.style.removeProperty('--accent-foreground');\r\n      return;\r\n    }\r\n\r\n    // Apply organization theme\r\n    const accent = branding.theme_accent;\r\n    \r\n    // Convert hex to HSL if needed, or use CSS variable format\r\n    if (accent.startsWith('#')) {\r\n      const hsl = hexToHsl(accent);\r\n      root.style.setProperty('--accent', hsl);\r\n      // Calculate contrasting foreground color\r\n      const foreground = isLightColor(accent) ? '0 0% 10%' : '0 0% 98%';\r\n      root.style.setProperty('--accent-foreground', foreground);\r\n    } else if (accent.includes('hsl') || accent.includes('%')) {\r\n      // Already in HSL format\r\n      root.style.setProperty('--accent', accent);\r\n    } else {\r\n      // Assume it's a CSS variable format like \"280 100% 70%\"\r\n      root.style.setProperty('--accent', accent);\r\n    }\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      root.style.removeProperty('--accent');\r\n      root.style.removeProperty('--accent-foreground');\r\n    };\r\n  }, [branding?.theme_accent, isPersonalMode]);\r\n\r\n  return <>{children}</>;\r\n}\r\n\r\n// Utility function to convert hex to HSL\r\nfunction hexToHsl(hex: string): string {\r\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n  if (!result) return '280 100% 70%'; // fallback\r\n  \r\n  const r = parseInt(result[1], 16) / 255;\r\n  const g = parseInt(result[2], 16) / 255;\r\n  const b = parseInt(result[3], 16) / 255;\r\n  \r\n  const max = Math.max(r, g, b);\r\n  const min = Math.min(r, g, b);\r\n  let h, s, l = (max + min) / 2;\r\n  \r\n  if (max === min) {\r\n    h = s = 0; // achromatic\r\n  } else {\r\n    const d = max - min;\r\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n    switch (max) {\r\n      case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n      case g: h = (b - r) / d + 2; break;\r\n      case b: h = (r - g) / d + 4; break;\r\n      default: h = 0;\r\n    }\r\n    h /= 6;\r\n  }\r\n  \r\n  return `${Math.round(h * 360)} ${Math.round(s * 100)}% ${Math.round(l * 100)}%`;\r\n}\r\n\r\n// Utility to determine if a color is light (for contrast calculation)\r\nfunction isLightColor(hex: string): boolean {\r\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n  if (!result) return false;\r\n  \r\n  const r = parseInt(result[1], 16);\r\n  const g = parseInt(result[2], 16);\r\n  const b = parseInt(result[3], 16);\r\n  \r\n  // Using relative luminance formula\r\n  const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\r\n  return luminance > 0.5;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\trigonometry\\lessons\\TrigonometryLesson1.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\trigonometry\\lessons\\TrigonometryLesson2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\trigonometry\\lessons\\TrigonometryLesson3.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\trigonometry\\lessons\\TrigonometryLesson4.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\trigonometry\\lessons\\TrigonometryLesson5.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\trigonometry\\lessons\\TrigonometryLesson6.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\trigonometry\\lessons\\TrigonometryLesson7.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\aspect-ratio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\badge.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":36,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":36,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\r\n        outline: \"text-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface BadgeProps\r\n  extends React.HTMLAttributes<HTMLDivElement>,\r\n    VariantProps<typeof badgeVariants> {}\r\n\r\nfunction Badge({ className, variant, ...props }: BadgeProps) {\r\n  return (\r\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":56,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":56,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\r\n        destructive:\r\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\r\n        outline:\r\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-10 px-4 py-2\",\r\n        sm: \"h-9 rounded-md px-3\",\r\n        lg: \"h-11 rounded-md px-8\",\r\n        icon: \"h-10 w-10\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface ButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof buttonVariants> {\r\n  asChild?: boolean\r\n}\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\r\n    const Comp = asChild ? Slot : \"button\"\r\n    return (\r\n      <Comp\r\n        className={cn(buttonVariants({ variant, size, className }))}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nButton.displayName = \"Button\"\r\n\r\nexport { Button, buttonVariants }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\carousel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\color-picker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\command.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":24,"column":11,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":24,"endColumn":29,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[724,775],"text":"type CommandDialogProps = DialogProps"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\r\nimport { Command as CommandPrimitive } from \"cmdk\"\r\nimport { Search } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\r\n\r\nconst Command = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nCommand.displayName = CommandPrimitive.displayName\r\n\r\ninterface CommandDialogProps extends DialogProps {}\r\n\r\nconst CommandDialog = ({ children, ...props }: CommandDialogProps) => {\r\n  return (\r\n    <Dialog {...props}>\r\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\r\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\r\n          {children}\r\n        </Command>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nconst CommandInput = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Input>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\r\n>(({ className, ...props }, ref) => (\r\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\r\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\r\n    <CommandPrimitive.Input\r\n      ref={ref}\r\n      className={cn(\r\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  </div>\r\n))\r\n\r\nCommandInput.displayName = CommandPrimitive.Input.displayName\r\n\r\nconst CommandList = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.List\r\n    ref={ref}\r\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandList.displayName = CommandPrimitive.List.displayName\r\n\r\nconst CommandEmpty = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Empty>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\r\n>((props, ref) => (\r\n  <CommandPrimitive.Empty\r\n    ref={ref}\r\n    className=\"py-6 text-center text-sm\"\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\r\n\r\nconst CommandGroup = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Group>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Group\r\n    ref={ref}\r\n    className={cn(\r\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandGroup.displayName = CommandPrimitive.Group.displayName\r\n\r\nconst CommandSeparator = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Separator>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Separator\r\n    ref={ref}\r\n    className={cn(\"-mx-1 h-px bg-border\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\r\n\r\nconst CommandItem = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Item\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandItem.displayName = CommandPrimitive.Item.displayName\r\n\r\nconst CommandShortcut = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLSpanElement>) => {\r\n  return (\r\n    <span\r\n      className={cn(\r\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\nCommandShortcut.displayName = \"CommandShortcut\"\r\n\r\nexport {\r\n  Command,\r\n  CommandDialog,\r\n  CommandInput,\r\n  CommandList,\r\n  CommandEmpty,\r\n  CommandGroup,\r\n  CommandItem,\r\n  CommandShortcut,\r\n  CommandSeparator,\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\context-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\form.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":168,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":168,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport {\r\n  Controller,\r\n  ControllerProps,\r\n  FieldPath,\r\n  FieldValues,\r\n  FormProvider,\r\n  useFormContext,\r\n} from \"react-hook-form\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Label } from \"@/components/ui/label\"\r\n\r\nconst Form = FormProvider\r\n\r\ntype FormFieldContextValue<\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n> = {\r\n  name: TName\r\n}\r\n\r\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\r\n  {} as FormFieldContextValue\r\n)\r\n\r\nconst FormField = <\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n>({\r\n  ...props\r\n}: ControllerProps<TFieldValues, TName>) => {\r\n  return (\r\n    <FormFieldContext.Provider value={{ name: props.name }}>\r\n      <Controller {...props} />\r\n    </FormFieldContext.Provider>\r\n  )\r\n}\r\n\r\nconst useFormField = () => {\r\n  const fieldContext = React.useContext(FormFieldContext)\r\n  const itemContext = React.useContext(FormItemContext)\r\n  const { getFieldState, formState } = useFormContext()\r\n\r\n  const fieldState = getFieldState(fieldContext.name, formState)\r\n\r\n  if (!fieldContext) {\r\n    throw new Error(\"useFormField should be used within <FormField>\")\r\n  }\r\n\r\n  const { id } = itemContext\r\n\r\n  return {\r\n    id,\r\n    name: fieldContext.name,\r\n    formItemId: `${id}-form-item`,\r\n    formDescriptionId: `${id}-form-item-description`,\r\n    formMessageId: `${id}-form-item-message`,\r\n    ...fieldState,\r\n  }\r\n}\r\n\r\ntype FormItemContextValue = {\r\n  id: string\r\n}\r\n\r\nconst FormItemContext = React.createContext<FormItemContextValue>(\r\n  {} as FormItemContextValue\r\n)\r\n\r\nconst FormItem = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => {\r\n  const id = React.useId()\r\n\r\n  return (\r\n    <FormItemContext.Provider value={{ id }}>\r\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\r\n    </FormItemContext.Provider>\r\n  )\r\n})\r\nFormItem.displayName = \"FormItem\"\r\n\r\nconst FormLabel = React.forwardRef<\r\n  React.ElementRef<typeof LabelPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\r\n>(({ className, ...props }, ref) => {\r\n  const { error, formItemId } = useFormField()\r\n\r\n  return (\r\n    <Label\r\n      ref={ref}\r\n      className={cn(error && \"text-destructive\", className)}\r\n      htmlFor={formItemId}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormLabel.displayName = \"FormLabel\"\r\n\r\nconst FormControl = React.forwardRef<\r\n  React.ElementRef<typeof Slot>,\r\n  React.ComponentPropsWithoutRef<typeof Slot>\r\n>(({ ...props }, ref) => {\r\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\r\n\r\n  return (\r\n    <Slot\r\n      ref={ref}\r\n      id={formItemId}\r\n      aria-describedby={\r\n        !error\r\n          ? `${formDescriptionId}`\r\n          : `${formDescriptionId} ${formMessageId}`\r\n      }\r\n      aria-invalid={!!error}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormControl.displayName = \"FormControl\"\r\n\r\nconst FormDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => {\r\n  const { formDescriptionId } = useFormField()\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formDescriptionId}\r\n      className={cn(\"text-sm text-muted-foreground\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormDescription.displayName = \"FormDescription\"\r\n\r\nconst FormMessage = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, children, ...props }, ref) => {\r\n  const { error, formMessageId } = useFormField()\r\n  const body = error ? String(error?.message) : children\r\n\r\n  if (!body) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formMessageId}\r\n      className={cn(\"text-sm font-medium text-destructive\", className)}\r\n      {...props}\r\n    >\r\n      {body}\r\n    </p>\r\n  )\r\n})\r\nFormMessage.displayName = \"FormMessage\"\r\n\r\nexport {\r\n  useFormField,\r\n  Form,\r\n  FormItem,\r\n  FormLabel,\r\n  FormControl,\r\n  FormDescription,\r\n  FormMessage,\r\n  FormField,\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\hover-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\input-otp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\menubar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\navigation-menu.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":119,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":119,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\r\nimport { cva } from \"class-variance-authority\"\r\nimport { ChevronDown } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst NavigationMenu = React.forwardRef<\r\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\r\n>(({ className, children, ...props }, ref) => (\r\n  <NavigationMenuPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    {children}\r\n    <NavigationMenuViewport />\r\n  </NavigationMenuPrimitive.Root>\r\n))\r\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\r\n\r\nconst NavigationMenuList = React.forwardRef<\r\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <NavigationMenuPrimitive.List\r\n    ref={ref}\r\n    className={cn(\r\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\r\n\r\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\r\n\r\nconst navigationMenuTriggerStyle = cva(\r\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\"\r\n)\r\n\r\nconst NavigationMenuTrigger = React.forwardRef<\r\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\r\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\r\n>(({ className, children, ...props }, ref) => (\r\n  <NavigationMenuPrimitive.Trigger\r\n    ref={ref}\r\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\r\n    {...props}\r\n  >\r\n    {children}{\" \"}\r\n    <ChevronDown\r\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\r\n      aria-hidden=\"true\"\r\n    />\r\n  </NavigationMenuPrimitive.Trigger>\r\n))\r\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\r\n\r\nconst NavigationMenuContent = React.forwardRef<\r\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\r\n>(({ className, ...props }, ref) => (\r\n  <NavigationMenuPrimitive.Content\r\n    ref={ref}\r\n    className={cn(\r\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\r\n\r\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\r\n\r\nconst NavigationMenuViewport = React.forwardRef<\r\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\r\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\r\n>(({ className, ...props }, ref) => (\r\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\r\n    <NavigationMenuPrimitive.Viewport\r\n      className={cn(\r\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\r\n        className\r\n      )}\r\n      ref={ref}\r\n      {...props}\r\n    />\r\n  </div>\r\n))\r\nNavigationMenuViewport.displayName =\r\n  NavigationMenuPrimitive.Viewport.displayName\r\n\r\nconst NavigationMenuIndicator = React.forwardRef<\r\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\r\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\r\n>(({ className, ...props }, ref) => (\r\n  <NavigationMenuPrimitive.Indicator\r\n    ref={ref}\r\n    className={cn(\r\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\r\n  </NavigationMenuPrimitive.Indicator>\r\n))\r\nNavigationMenuIndicator.displayName =\r\n  NavigationMenuPrimitive.Indicator.displayName\r\n\r\nexport {\r\n  navigationMenuTriggerStyle,\r\n  NavigationMenu,\r\n  NavigationMenuList,\r\n  NavigationMenuItem,\r\n  NavigationMenuContent,\r\n  NavigationMenuTrigger,\r\n  NavigationMenuLink,\r\n  NavigationMenuIndicator,\r\n  NavigationMenuViewport,\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\resizable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\sidebar.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":760,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":760,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { VariantProps, cva } from \"class-variance-authority\"\r\nimport { PanelLeft } from \"lucide-react\"\r\n\r\nimport { useIsMobile } from \"@/hooks/use-mobile\"\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Separator } from \"@/components/ui/separator\"\r\nimport { Sheet, SheetContent } from \"@/components/ui/sheet\"\r\nimport { Skeleton } from \"@/components/ui/skeleton\"\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\"\r\n\r\nconst SIDEBAR_COOKIE_NAME = \"sidebar:state\"\r\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\r\nconst SIDEBAR_WIDTH = \"16rem\"\r\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\r\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\r\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\r\n\r\ntype SidebarContext = {\r\n  state: \"expanded\" | \"collapsed\"\r\n  open: boolean\r\n  setOpen: (open: boolean) => void\r\n  openMobile: boolean\r\n  setOpenMobile: (open: boolean) => void\r\n  isMobile: boolean\r\n  toggleSidebar: () => void\r\n}\r\n\r\nconst SidebarContext = React.createContext<SidebarContext | null>(null)\r\n\r\nfunction useSidebar() {\r\n  const context = React.useContext(SidebarContext)\r\n  if (!context) {\r\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\r\n  }\r\n\r\n  return context\r\n}\r\n\r\nconst SidebarProvider = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\"> & {\r\n    defaultOpen?: boolean\r\n    open?: boolean\r\n    onOpenChange?: (open: boolean) => void\r\n  }\r\n>(\r\n  (\r\n    {\r\n      defaultOpen = true,\r\n      open: openProp,\r\n      onOpenChange: setOpenProp,\r\n      className,\r\n      style,\r\n      children,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const isMobile = useIsMobile()\r\n    const [openMobile, setOpenMobile] = React.useState(false)\r\n\r\n    // This is the internal state of the sidebar.\r\n    // We use openProp and setOpenProp for control from outside the component.\r\n    const [_open, _setOpen] = React.useState(defaultOpen)\r\n    const open = openProp ?? _open\r\n    const setOpen = React.useCallback(\r\n      (value: boolean | ((value: boolean) => boolean)) => {\r\n        const openState = typeof value === \"function\" ? value(open) : value\r\n        if (setOpenProp) {\r\n          setOpenProp(openState)\r\n        } else {\r\n          _setOpen(openState)\r\n        }\r\n\r\n        // This sets the cookie to keep the sidebar state.\r\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\r\n      },\r\n      [setOpenProp, open]\r\n    )\r\n\r\n    // Helper to toggle the sidebar.\r\n    const toggleSidebar = React.useCallback(() => {\r\n      return isMobile\r\n        ? setOpenMobile((open) => !open)\r\n        : setOpen((open) => !open)\r\n    }, [isMobile, setOpen, setOpenMobile])\r\n\r\n    // Adds a keyboard shortcut to toggle the sidebar.\r\n    React.useEffect(() => {\r\n      const handleKeyDown = (event: KeyboardEvent) => {\r\n        if (\r\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\r\n          (event.metaKey || event.ctrlKey)\r\n        ) {\r\n          event.preventDefault()\r\n          toggleSidebar()\r\n        }\r\n      }\r\n\r\n      window.addEventListener(\"keydown\", handleKeyDown)\r\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\r\n    }, [toggleSidebar])\r\n\r\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\r\n    // This makes it easier to style the sidebar with Tailwind classes.\r\n    const state = open ? \"expanded\" : \"collapsed\"\r\n\r\n    const contextValue = React.useMemo<SidebarContext>(\r\n      () => ({\r\n        state,\r\n        open,\r\n        setOpen,\r\n        isMobile,\r\n        openMobile,\r\n        setOpenMobile,\r\n        toggleSidebar,\r\n      }),\r\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\r\n    )\r\n\r\n    return (\r\n      <SidebarContext.Provider value={contextValue}>\r\n        <TooltipProvider delayDuration={0}>\r\n          <div\r\n            style={\r\n              {\r\n                \"--sidebar-width\": SIDEBAR_WIDTH,\r\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\r\n                ...style,\r\n              } as React.CSSProperties\r\n            }\r\n            className={cn(\r\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\r\n              className\r\n            )}\r\n            ref={ref}\r\n            {...props}\r\n          >\r\n            {children}\r\n          </div>\r\n        </TooltipProvider>\r\n      </SidebarContext.Provider>\r\n    )\r\n  }\r\n)\r\nSidebarProvider.displayName = \"SidebarProvider\"\r\n\r\nconst Sidebar = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\"> & {\r\n    side?: \"left\" | \"right\"\r\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\r\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\r\n  }\r\n>(\r\n  (\r\n    {\r\n      side = \"left\",\r\n      variant = \"sidebar\",\r\n      collapsible = \"offcanvas\",\r\n      className,\r\n      children,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\r\n\r\n    if (collapsible === \"none\") {\r\n      return (\r\n        <div\r\n          className={cn(\r\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\r\n            className\r\n          )}\r\n          ref={ref}\r\n          {...props}\r\n        >\r\n          {children}\r\n        </div>\r\n      )\r\n    }\r\n\r\n    if (isMobile) {\r\n      return (\r\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\r\n          <SheetContent\r\n            data-sidebar=\"sidebar\"\r\n            data-mobile=\"true\"\r\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\r\n            style={\r\n              {\r\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\r\n              } as React.CSSProperties\r\n            }\r\n            side={side}\r\n          >\r\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\r\n          </SheetContent>\r\n        </Sheet>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className=\"group peer hidden md:block text-sidebar-foreground\"\r\n        data-state={state}\r\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\r\n        data-variant={variant}\r\n        data-side={side}\r\n      >\r\n        {/* This is what handles the sidebar gap on desktop */}\r\n        <div\r\n          className={cn(\r\n            \"duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear\",\r\n            \"group-data-[collapsible=offcanvas]:w-0\",\r\n            \"group-data-[side=right]:rotate-180\",\r\n            variant === \"floating\" || variant === \"inset\"\r\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\r\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\r\n          )}\r\n        />\r\n        <div\r\n          className={cn(\r\n            \"duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex\",\r\n            side === \"left\"\r\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\r\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\r\n            // Adjust the padding for floating and inset variants.\r\n            variant === \"floating\" || variant === \"inset\"\r\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\r\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\r\n            className\r\n          )}\r\n          {...props}\r\n        >\r\n          <div\r\n            data-sidebar=\"sidebar\"\r\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\r\n          >\r\n            {children}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n)\r\nSidebar.displayName = \"Sidebar\"\r\n\r\nconst SidebarTrigger = React.forwardRef<\r\n  React.ElementRef<typeof Button>,\r\n  React.ComponentProps<typeof Button>\r\n>(({ className, onClick, ...props }, ref) => {\r\n  const { toggleSidebar } = useSidebar()\r\n\r\n  return (\r\n    <Button\r\n      ref={ref}\r\n      data-sidebar=\"trigger\"\r\n      variant=\"ghost\"\r\n      size=\"icon\"\r\n      className={cn(\"h-7 w-7\", className)}\r\n      onClick={(event) => {\r\n        onClick?.(event)\r\n        toggleSidebar()\r\n      }}\r\n      {...props}\r\n    >\r\n      <PanelLeft />\r\n      <span className=\"sr-only\">Toggle Sidebar</span>\r\n    </Button>\r\n  )\r\n})\r\nSidebarTrigger.displayName = \"SidebarTrigger\"\r\n\r\nconst SidebarRail = React.forwardRef<\r\n  HTMLButtonElement,\r\n  React.ComponentProps<\"button\">\r\n>(({ className, ...props }, ref) => {\r\n  const { toggleSidebar } = useSidebar()\r\n\r\n  return (\r\n    <button\r\n      ref={ref}\r\n      data-sidebar=\"rail\"\r\n      aria-label=\"Toggle Sidebar\"\r\n      tabIndex={-1}\r\n      onClick={toggleSidebar}\r\n      title=\"Toggle Sidebar\"\r\n      className={cn(\r\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\r\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\r\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\r\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\r\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\r\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarRail.displayName = \"SidebarRail\"\r\n\r\nconst SidebarInset = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"main\">\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <main\r\n      ref={ref}\r\n      className={cn(\r\n        \"relative flex min-h-svh flex-1 flex-col bg-background\",\r\n        \"peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarInset.displayName = \"SidebarInset\"\r\n\r\nconst SidebarInput = React.forwardRef<\r\n  React.ElementRef<typeof Input>,\r\n  React.ComponentProps<typeof Input>\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <Input\r\n      ref={ref}\r\n      data-sidebar=\"input\"\r\n      className={cn(\r\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarInput.displayName = \"SidebarInput\"\r\n\r\nconst SidebarHeader = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\">\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      data-sidebar=\"header\"\r\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarHeader.displayName = \"SidebarHeader\"\r\n\r\nconst SidebarFooter = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\">\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      data-sidebar=\"footer\"\r\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarFooter.displayName = \"SidebarFooter\"\r\n\r\nconst SidebarSeparator = React.forwardRef<\r\n  React.ElementRef<typeof Separator>,\r\n  React.ComponentProps<typeof Separator>\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <Separator\r\n      ref={ref}\r\n      data-sidebar=\"separator\"\r\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarSeparator.displayName = \"SidebarSeparator\"\r\n\r\nconst SidebarContent = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\">\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      data-sidebar=\"content\"\r\n      className={cn(\r\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarContent.displayName = \"SidebarContent\"\r\n\r\nconst SidebarGroup = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\">\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      data-sidebar=\"group\"\r\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarGroup.displayName = \"SidebarGroup\"\r\n\r\nconst SidebarGroupLabel = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\r\n>(({ className, asChild = false, ...props }, ref) => {\r\n  const Comp = asChild ? Slot : \"div\"\r\n\r\n  return (\r\n    <Comp\r\n      ref={ref}\r\n      data-sidebar=\"group-label\"\r\n      className={cn(\r\n        \"duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\r\n\r\nconst SidebarGroupAction = React.forwardRef<\r\n  HTMLButtonElement,\r\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\r\n>(({ className, asChild = false, ...props }, ref) => {\r\n  const Comp = asChild ? Slot : \"button\"\r\n\r\n  return (\r\n    <Comp\r\n      ref={ref}\r\n      data-sidebar=\"group-action\"\r\n      className={cn(\r\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        // Increases the hit area of the button on mobile.\r\n        \"after:absolute after:-inset-2 after:md:hidden\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\r\n\r\nconst SidebarGroupContent = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\">\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    data-sidebar=\"group-content\"\r\n    className={cn(\"w-full text-sm\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\r\n\r\nconst SidebarMenu = React.forwardRef<\r\n  HTMLUListElement,\r\n  React.ComponentProps<\"ul\">\r\n>(({ className, ...props }, ref) => (\r\n  <ul\r\n    ref={ref}\r\n    data-sidebar=\"menu\"\r\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSidebarMenu.displayName = \"SidebarMenu\"\r\n\r\nconst SidebarMenuItem = React.forwardRef<\r\n  HTMLLIElement,\r\n  React.ComponentProps<\"li\">\r\n>(({ className, ...props }, ref) => (\r\n  <li\r\n    ref={ref}\r\n    data-sidebar=\"menu-item\"\r\n    className={cn(\"group/menu-item relative\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\r\n\r\nconst sidebarMenuButtonVariants = cva(\r\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\r\n        outline:\r\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\r\n      },\r\n      size: {\r\n        default: \"h-8 text-sm\",\r\n        sm: \"h-7 text-xs\",\r\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nconst SidebarMenuButton = React.forwardRef<\r\n  HTMLButtonElement,\r\n  React.ComponentProps<\"button\"> & {\r\n    asChild?: boolean\r\n    isActive?: boolean\r\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\r\n  } & VariantProps<typeof sidebarMenuButtonVariants>\r\n>(\r\n  (\r\n    {\r\n      asChild = false,\r\n      isActive = false,\r\n      variant = \"default\",\r\n      size = \"default\",\r\n      tooltip,\r\n      className,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const Comp = asChild ? Slot : \"button\"\r\n    const { isMobile, state } = useSidebar()\r\n\r\n    const button = (\r\n      <Comp\r\n        ref={ref}\r\n        data-sidebar=\"menu-button\"\r\n        data-size={size}\r\n        data-active={isActive}\r\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\r\n        {...props}\r\n      />\r\n    )\r\n\r\n    if (!tooltip) {\r\n      return button\r\n    }\r\n\r\n    if (typeof tooltip === \"string\") {\r\n      tooltip = {\r\n        children: tooltip,\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Tooltip>\r\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\r\n        <TooltipContent\r\n          side=\"right\"\r\n          align=\"center\"\r\n          hidden={state !== \"collapsed\" || isMobile}\r\n          {...tooltip}\r\n        />\r\n      </Tooltip>\r\n    )\r\n  }\r\n)\r\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\r\n\r\nconst SidebarMenuAction = React.forwardRef<\r\n  HTMLButtonElement,\r\n  React.ComponentProps<\"button\"> & {\r\n    asChild?: boolean\r\n    showOnHover?: boolean\r\n  }\r\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\r\n  const Comp = asChild ? Slot : \"button\"\r\n\r\n  return (\r\n    <Comp\r\n      ref={ref}\r\n      data-sidebar=\"menu-action\"\r\n      className={cn(\r\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        // Increases the hit area of the button on mobile.\r\n        \"after:absolute after:-inset-2 after:md:hidden\",\r\n        \"peer-data-[size=sm]/menu-button:top-1\",\r\n        \"peer-data-[size=default]/menu-button:top-1.5\",\r\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        showOnHover &&\r\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\r\n\r\nconst SidebarMenuBadge = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\">\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    data-sidebar=\"menu-badge\"\r\n    className={cn(\r\n      \"absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none\",\r\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\r\n      \"peer-data-[size=sm]/menu-button:top-1\",\r\n      \"peer-data-[size=default]/menu-button:top-1.5\",\r\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\r\n      \"group-data-[collapsible=icon]:hidden\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\r\n\r\nconst SidebarMenuSkeleton = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.ComponentProps<\"div\"> & {\r\n    showIcon?: boolean\r\n  }\r\n>(({ className, showIcon = false, ...props }, ref) => {\r\n  // Random width between 50 to 90%.\r\n  const width = React.useMemo(() => {\r\n    return `${Math.floor(Math.random() * 40) + 50}%`\r\n  }, [])\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      data-sidebar=\"menu-skeleton\"\r\n      className={cn(\"rounded-md h-8 flex gap-2 px-2 items-center\", className)}\r\n      {...props}\r\n    >\r\n      {showIcon && (\r\n        <Skeleton\r\n          className=\"size-4 rounded-md\"\r\n          data-sidebar=\"menu-skeleton-icon\"\r\n        />\r\n      )}\r\n      <Skeleton\r\n        className=\"h-4 flex-1 max-w-[--skeleton-width]\"\r\n        data-sidebar=\"menu-skeleton-text\"\r\n        style={\r\n          {\r\n            \"--skeleton-width\": width,\r\n          } as React.CSSProperties\r\n        }\r\n      />\r\n    </div>\r\n  )\r\n})\r\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\r\n\r\nconst SidebarMenuSub = React.forwardRef<\r\n  HTMLUListElement,\r\n  React.ComponentProps<\"ul\">\r\n>(({ className, ...props }, ref) => (\r\n  <ul\r\n    ref={ref}\r\n    data-sidebar=\"menu-sub\"\r\n    className={cn(\r\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\r\n      \"group-data-[collapsible=icon]:hidden\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\r\n\r\nconst SidebarMenuSubItem = React.forwardRef<\r\n  HTMLLIElement,\r\n  React.ComponentProps<\"li\">\r\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\r\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\r\n\r\nconst SidebarMenuSubButton = React.forwardRef<\r\n  HTMLAnchorElement,\r\n  React.ComponentProps<\"a\"> & {\r\n    asChild?: boolean\r\n    size?: \"sm\" | \"md\"\r\n    isActive?: boolean\r\n  }\r\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\r\n  const Comp = asChild ? Slot : \"a\"\r\n\r\n  return (\r\n    <Comp\r\n      ref={ref}\r\n      data-sidebar=\"menu-sub-button\"\r\n      data-size={size}\r\n      data-active={isActive}\r\n      className={cn(\r\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\r\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\r\n        size === \"sm\" && \"text-xs\",\r\n        size === \"md\" && \"text-sm\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\r\n\r\nexport {\r\n  Sidebar,\r\n  SidebarContent,\r\n  SidebarFooter,\r\n  SidebarGroup,\r\n  SidebarGroupAction,\r\n  SidebarGroupContent,\r\n  SidebarGroupLabel,\r\n  SidebarHeader,\r\n  SidebarInput,\r\n  SidebarInset,\r\n  SidebarMenu,\r\n  SidebarMenuAction,\r\n  SidebarMenuBadge,\r\n  SidebarMenuButton,\r\n  SidebarMenuItem,\r\n  SidebarMenuSkeleton,\r\n  SidebarMenuSub,\r\n  SidebarMenuSubButton,\r\n  SidebarMenuSubItem,\r\n  SidebarProvider,\r\n  SidebarRail,\r\n  SidebarSeparator,\r\n  SidebarTrigger,\r\n  useSidebar,\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\sonner.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":29,"column":19,"nodeType":"Identifier","messageId":"namedExport","endLine":29,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useTheme } from \"next-themes\"\r\nimport { Toaster as Sonner, toast } from \"sonner\"\r\n\r\ntype ToasterProps = React.ComponentProps<typeof Sonner>\r\n\r\nconst Toaster = ({ ...props }: ToasterProps) => {\r\n  const { theme = \"system\" } = useTheme()\r\n\r\n  return (\r\n    <Sonner\r\n      theme={theme as ToasterProps[\"theme\"]}\r\n      className=\"toaster group\"\r\n      toastOptions={{\r\n        classNames: {\r\n          toast:\r\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\r\n          description: \"group-[.toast]:text-muted-foreground\",\r\n          actionButton:\r\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\r\n          cancelButton:\r\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\r\n        },\r\n      }}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Toaster, toast }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,164],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n  ({ className, ...props }, ref) => {\r\n    return (\r\n      <textarea\r\n        className={cn(\r\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\toggle-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\toggle.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":43,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":43,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst toggleVariants = cva(\r\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-transparent\",\r\n        outline:\r\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\r\n      },\r\n      size: {\r\n        default: \"h-10 px-3\",\r\n        sm: \"h-9 px-2.5\",\r\n        lg: \"h-11 px-5\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nconst Toggle = React.forwardRef<\r\n  React.ElementRef<typeof TogglePrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\r\n    VariantProps<typeof toggleVariants>\r\n>(({ className, variant, size, ...props }, ref) => (\r\n  <TogglePrimitive.Root\r\n    ref={ref}\r\n    className={cn(toggleVariants({ variant, size, className }))}\r\n    {...props}\r\n  />\r\n))\r\n\r\nToggle.displayName = TogglePrimitive.Root.displayName\r\n\r\nexport { Toggle, toggleVariants }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\ui\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\usage\\UsageDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3148,3151],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3148,3151],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3983,3986],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3983,3986],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { \r\n  MessageSquare, \r\n  Mic, \r\n  Brain, \r\n  FileText, \r\n  Sparkles, \r\n  BarChart3,\r\n  Database,\r\n  Calendar,\r\n  TrendingUp\r\n} from 'lucide-react';\r\nimport { useUsageTracking } from '@/hooks/useUsageTracking';\r\nimport { useSubscription } from '@/hooks/useSubscription';\r\nimport { format } from 'date-fns';\r\n\r\nconst FEATURE_CONFIG = {\r\n  ai_chat: {\r\n    icon: MessageSquare,\r\n    label: 'AI Chat Messages',\r\n    description: 'Messages with AI Study Coach',\r\n    color: 'hsl(var(--primary))',\r\n  },\r\n  voice_processing: {\r\n    icon: Mic,\r\n    label: 'Voice Processing',\r\n    description: 'Minutes of voice-to-text processing',\r\n    color: 'hsl(var(--accent))',\r\n  },\r\n  rag_query: {\r\n    icon: Brain,\r\n    label: 'Knowledge Queries',\r\n    description: 'RAG-powered knowledge searches',\r\n    color: 'hsl(var(--secondary))',\r\n  },\r\n  document_processing: {\r\n    icon: FileText,\r\n    label: 'Document Processing',\r\n    description: 'PDF and document analysis',\r\n    color: 'hsl(var(--primary-variant))',\r\n  },\r\n  flashcard_generation: {\r\n    icon: Sparkles,\r\n    label: 'Flashcard Generation',\r\n    description: 'AI-generated flashcards',\r\n    color: 'hsl(var(--accent-variant))',\r\n  },\r\n  ai_insights: {\r\n    icon: BarChart3,\r\n    label: 'AI Insights',\r\n    description: 'Personalized learning insights',\r\n    color: 'hsl(var(--muted-foreground))',\r\n  },\r\n} as const;\r\n\r\ninterface UsageCardProps {\r\n  featureType: keyof typeof FEATURE_CONFIG;\r\n  used: number;\r\n  limit: number;\r\n  unit?: string;\r\n}\r\n\r\nfunction UsageCard({ featureType, used, limit, unit = '' }: UsageCardProps) {\r\n  const config = FEATURE_CONFIG[featureType];\r\n  const IconComponent = config.icon;\r\n  const percentage = limit === -1 ? 0 : Math.min((used / limit) * 100, 100);\r\n  const isUnlimited = limit === -1;\r\n  \r\n  const getStatusColor = () => {\r\n    if (isUnlimited) return 'success';\r\n    if (percentage >= 90) return 'destructive';\r\n    if (percentage >= 75) return 'warning';\r\n    return 'default';\r\n  };\r\n\r\n  const getStatusText = () => {\r\n    if (isUnlimited) return 'Unlimited';\r\n    if (percentage >= 100) return 'Limit Reached';\r\n    if (percentage >= 90) return 'Almost Full';\r\n    return 'Available';\r\n  };\r\n\r\n  return (\r\n    <Card className=\"transition-all hover:shadow-md\">\r\n      <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <div \r\n            className=\"p-2 rounded-lg\"\r\n            style={{ backgroundColor: `${config.color}20`, color: config.color }}\r\n          >\r\n            <IconComponent className=\"h-4 w-4\" />\r\n          </div>\r\n          <div>\r\n            <CardTitle className=\"text-sm font-medium\">{config.label}</CardTitle>\r\n            <CardDescription className=\"text-xs\">{config.description}</CardDescription>\r\n          </div>\r\n        </div>\r\n        <Badge variant={getStatusColor() as any} className=\"text-xs\">\r\n          {getStatusText()}\r\n        </Badge>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex items-center justify-between text-sm\">\r\n            <span className=\"text-muted-foreground\">Usage</span>\r\n            <span className=\"font-medium\">\r\n              {used.toLocaleString()}{unit}\r\n              {!isUnlimited && (\r\n                <span className=\"text-muted-foreground\"> / {limit.toLocaleString()}{unit}</span>\r\n              )}\r\n            </span>\r\n          </div>\r\n          {!isUnlimited && (\r\n            <Progress \r\n              value={percentage} \r\n              className=\"h-2\"\r\n              style={{ \r\n                '--progress-foreground': percentage >= 90 ? 'hsl(var(--destructive))' : config.color \r\n              } as any}\r\n            />\r\n          )}\r\n          {!isUnlimited && (\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              {(limit - used).toLocaleString()}{unit} remaining\r\n            </div>\r\n          )}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport function UsageDashboard() {\r\n  const { quotas, usageLogs, isLoading } = useUsageTracking();\r\n  const { subscription } = useSubscription();\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {Array.from({ length: 6 }).map((_, i) => (\r\n            <Card key={i} className=\"animate-pulse\">\r\n              <CardHeader>\r\n                <div className=\"h-4 bg-muted rounded w-3/4\"></div>\r\n                <div className=\"h-3 bg-muted rounded w-1/2\"></div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"h-2 bg-muted rounded\"></div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!quotas) {\r\n    return (\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center space-x-2\">\r\n            <TrendingUp className=\"h-5 w-5\" />\r\n            <span>Usage Tracking</span>\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Track your AI feature usage and manage your subscription limits\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <p className=\"text-muted-foreground\">\r\n            No usage data available. Your usage tracking will appear here once you start using AI features.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  const currentPeriodEnd = new Date(quotas.period_end);\r\n  const isCurrentPeriod = currentPeriodEnd > new Date();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold tracking-tight\">Usage & Billing</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Track your AI feature usage for the current billing period\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n          <span className=\"text-sm text-muted-foreground\">\r\n            Period ends: {format(currentPeriodEnd, 'MMM dd, yyyy')}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Current Plan Info */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center justify-between\">\r\n            <span>Current Plan: {subscription.subscription_tier?.charAt(0).toUpperCase() + subscription.subscription_tier?.slice(1) || 'Free'}</span>\r\n            <Badge variant={subscription.subscribed ? 'default' : 'secondary'}>\r\n              {subscription.subscribed ? 'Active' : 'Free Tier'}\r\n            </Badge>\r\n          </CardTitle>\r\n          <CardDescription>\r\n            {subscription.subscription_end && (\r\n              <>Next billing: {format(new Date(subscription.subscription_end), 'MMM dd, yyyy')}</>\r\n            )}\r\n          </CardDescription>\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      {/* Usage Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n        <UsageCard\r\n          featureType=\"ai_chat\"\r\n          used={quotas.ai_chat_messages_used}\r\n          limit={quotas.ai_chat_messages_limit}\r\n          unit=\" msgs\"\r\n        />\r\n        <UsageCard\r\n          featureType=\"voice_processing\"\r\n          used={quotas.voice_minutes_used}\r\n          limit={quotas.voice_minutes_limit}\r\n          unit=\" min\"\r\n        />\r\n        <UsageCard\r\n          featureType=\"rag_query\"\r\n          used={quotas.rag_queries_used}\r\n          limit={quotas.rag_queries_limit}\r\n          unit=\" queries\"\r\n        />\r\n        <UsageCard\r\n          featureType=\"document_processing\"\r\n          used={quotas.document_processing_used}\r\n          limit={quotas.document_processing_limit}\r\n          unit=\" docs\"\r\n        />\r\n        <UsageCard\r\n          featureType=\"flashcard_generation\"\r\n          used={quotas.flashcard_generation_used}\r\n          limit={quotas.flashcard_generation_limit}\r\n          unit=\" cards\"\r\n        />\r\n        <UsageCard\r\n          featureType=\"ai_insights\"\r\n          used={quotas.ai_insights_used}\r\n          limit={quotas.ai_insights_limit}\r\n          unit=\" insights\"\r\n        />\r\n      </div>\r\n\r\n      {/* Storage Usage */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center space-x-2\">\r\n            <Database className=\"h-5 w-5\" />\r\n            <span>Knowledge Base Storage</span>\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-sm text-muted-foreground\">Used</span>\r\n              <span className=\"font-medium\">\r\n                {quotas.knowledge_base_storage_mb_used} MB / {quotas.knowledge_base_storage_mb_limit} MB\r\n              </span>\r\n            </div>\r\n            <Progress \r\n              value={(quotas.knowledge_base_storage_mb_used / quotas.knowledge_base_storage_mb_limit) * 100} \r\n              className=\"h-2\"\r\n            />\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              {quotas.knowledge_base_storage_mb_limit - quotas.knowledge_base_storage_mb_used} MB remaining\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Recent Usage Activity */}\r\n      {usageLogs && usageLogs.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Recent Activity</CardTitle>\r\n            <CardDescription>Your latest AI feature usage</CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              {usageLogs.slice(0, 5).map((log) => {\r\n                const config = FEATURE_CONFIG[log.feature_type as keyof typeof FEATURE_CONFIG];\r\n                const IconComponent = config?.icon || FileText;\r\n                \r\n                return (\r\n                  <div key={log.id} className=\"flex items-center justify-between py-2 border-b last:border-b-0\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <IconComponent className=\"h-4 w-4 text-muted-foreground\" />\r\n                      <div>\r\n                        <span className=\"text-sm font-medium\">\r\n                          {config?.label || log.feature_type}\r\n                        </span>\r\n                        <div className=\"text-xs text-muted-foreground\">\r\n                          {format(new Date(log.timestamp), 'MMM dd, HH:mm')}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <Badge variant=\"outline\">\r\n                      +{log.usage_amount}\r\n                    </Badge>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\components\\usage\\UsageGate.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\config\\chartDefinitions.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[214,217],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[214,217],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[921,924],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[921,924],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nexport interface ChartDefinition {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  type: 'bar' | 'line' | 'pie' | 'area' | 'scatter';\r\n  dataSource: {\r\n    query: string;\r\n    params?: Record<string, any>;\r\n    transform?: string;\r\n  };\r\n  config: {\r\n    xAxis?: {\r\n      dataKey: string;\r\n      label?: string;\r\n      type?: 'category' | 'number';\r\n    };\r\n    yAxis?: {\r\n      label?: string;\r\n      domain?: [number, number];\r\n    };\r\n    series: Array<{\r\n      dataKey: string;\r\n      name: string;\r\n      color: string;\r\n      type?: 'monotone' | 'basis' | 'linear';\r\n    }>;\r\n    legend?: {\r\n      show: boolean;\r\n      position?: 'top' | 'bottom' | 'left' | 'right';\r\n    };\r\n    tooltip?: {\r\n      show: boolean;\r\n      formatter?: string;\r\n    };\r\n  };\r\n  filters?: Array<{\r\n    key: string;\r\n    label: string;\r\n    type: 'date' | 'select' | 'number';\r\n    options?: string[];\r\n    defaultValue?: any;\r\n  }>;\r\n  refreshInterval?: number; // seconds\r\n  enableRealtime?: boolean;\r\n  featureFlag?: string;\r\n}\r\n\r\nexport const CHART_DEFINITIONS: Record<string, ChartDefinition> = {\r\n  weeklyActivity: {\r\n    id: 'weeklyActivity',\r\n    title: 'Weekly Learning Activity',\r\n    description: 'Study sessions and time spent per day',\r\n    type: 'bar',\r\n    dataSource: {\r\n      query: 'weekly_activity',\r\n      transform: 'groupByDay'\r\n    },\r\n    config: {\r\n      xAxis: {\r\n        dataKey: 'day',\r\n        label: 'Day of Week'\r\n      },\r\n      yAxis: {\r\n        label: 'Minutes / Sessions'\r\n      },\r\n      series: [\r\n        {\r\n          dataKey: 'studyTime',\r\n          name: 'Study Time (min)',\r\n          color: '#F59E0B'\r\n        },\r\n        {\r\n          dataKey: 'studySessions',\r\n          name: 'Sessions',\r\n          color: '#8B5CF6'\r\n        }\r\n      ],\r\n      legend: {\r\n        show: true,\r\n        position: 'bottom'\r\n      },\r\n      tooltip: {\r\n        show: true\r\n      }\r\n    },\r\n    enableRealtime: true,\r\n    featureFlag: 'weekly_activity_chart'\r\n  },\r\n\r\n  readingProgress: {\r\n    id: 'readingProgress',\r\n    title: 'Reading Time Trends',\r\n    description: 'Daily reading time over the past week',\r\n    type: 'area',\r\n    dataSource: {\r\n      query: 'reading_trends',\r\n      params: { days: 7 }\r\n    },\r\n    config: {\r\n      xAxis: {\r\n        dataKey: 'day',\r\n        label: 'Day'\r\n      },\r\n      yAxis: {\r\n        label: 'Reading Time (minutes)'\r\n      },\r\n      series: [\r\n        {\r\n          dataKey: 'reading_time',\r\n          name: 'Reading Time',\r\n          color: '#3B82F6',\r\n          type: 'monotone'\r\n        }\r\n      ],\r\n      legend: {\r\n        show: false\r\n      },\r\n      tooltip: {\r\n        show: true,\r\n        formatter: '{value} minutes'\r\n      }\r\n    },\r\n    refreshInterval: 300,\r\n    enableRealtime: true,\r\n    featureFlag: 'reading_trends_chart'\r\n  },\r\n\r\n  xpBreakdown: {\r\n    id: 'xpBreakdown',\r\n    title: 'XP Sources Distribution',\r\n    description: 'XP earned from different activities',\r\n    type: 'pie',\r\n    dataSource: {\r\n      query: 'xp_breakdown',\r\n      params: { period: '7d' }\r\n    },\r\n    config: {\r\n      series: [\r\n        {\r\n          dataKey: 'value',\r\n          name: 'XP Source',\r\n          color: '#8B5CF6'\r\n        }\r\n      ],\r\n      legend: {\r\n        show: true,\r\n        position: 'right'\r\n      },\r\n      tooltip: {\r\n        show: true,\r\n        formatter: '{name}: {value} XP'\r\n      }\r\n    },\r\n    filters: [\r\n      {\r\n        key: 'period',\r\n        label: 'Time Period',\r\n        type: 'select',\r\n        options: ['1d', '7d', '30d', '90d'],\r\n        defaultValue: '7d'\r\n      }\r\n    ],\r\n    featureFlag: 'xp_breakdown_chart'\r\n  },\r\n\r\n  studyAccuracy: {\r\n    id: 'studyAccuracy',\r\n    title: 'Study Accuracy Over Time',\r\n    description: 'Accuracy percentage in study sessions',\r\n    type: 'line',\r\n    dataSource: {\r\n      query: 'study_accuracy',\r\n      params: { days: 30 }\r\n    },\r\n    config: {\r\n      xAxis: {\r\n        dataKey: 'date',\r\n        label: 'Date'\r\n      },\r\n      yAxis: {\r\n        label: 'Accuracy (%)',\r\n        domain: [0, 100]\r\n      },\r\n      series: [\r\n        {\r\n          dataKey: 'accuracy',\r\n          name: 'Accuracy',\r\n          color: '#10B981',\r\n          type: 'monotone'\r\n        },\r\n        {\r\n          dataKey: 'target',\r\n          name: 'Target',\r\n          color: '#EF4444',\r\n          type: 'linear'\r\n        }\r\n      ],\r\n      legend: {\r\n        show: true,\r\n        position: 'top'\r\n      },\r\n      tooltip: {\r\n        show: true\r\n      }\r\n    },\r\n    featureFlag: 'study_accuracy_chart'\r\n  }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\config\\nav.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\config\\readerConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\contexts\\GamificationContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[306,309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[306,309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":15,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":15,"endColumn":36},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[812,815],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[812,815],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refreshStats'. Either include it or remove the dependency array.","line":149,"column":6,"nodeType":"ArrayExpression","endLine":149,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [refreshStats, user.id]","fix":{"range":[4367,4377],"text":"[refreshStats, user.id]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { createContext, useContext, useEffect, useState, useRef } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useGamification } from '@/hooks/useGamification';\r\n\r\ninterface GamificationContextType {\r\n  userStats: any;\r\n  refreshStats: () => Promise<void>;\r\n  isLoading: boolean;\r\n}\r\n\r\nconst GamificationContext = createContext<GamificationContextType | undefined>(undefined);\r\n\r\nexport const useGamificationContext = () => {\r\n  const context = useContext(GamificationContext);\r\n  if (!context) {\r\n    throw new Error('useGamificationContext must be used within a GamificationProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n// Global channel tracking to prevent multiple subscriptions\r\nconst activeChannels = new Map<string, any>();\r\n\r\nexport const GamificationProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const { user } = useAuth();\r\n  const { userStats, fetchUserStats, isLoading } = useGamification();\r\n  const [lastUpdate, setLastUpdate] = useState<number>(Date.now());\r\n  const initializationRef = useRef<boolean>(false);\r\n\r\n  const refreshStats = async () => {\r\n    await fetchUserStats();\r\n    setLastUpdate(Date.now());\r\n  };\r\n\r\n  // Cleanup function\r\n  const cleanup = (userId: string) => {\r\n    const channelKey = `gamification-${userId}`;\r\n    const existingChannel = activeChannels.get(channelKey);\r\n    \r\n    if (existingChannel) {\r\n      try {\r\n        console.log('ðŸ§¹ Cleaning up existing gamification channel for user:', userId);\r\n        supabase.removeChannel(existingChannel);\r\n        activeChannels.delete(channelKey);\r\n      } catch (error) {\r\n        console.log('Error removing channel:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Prevent multiple initializations\r\n    if (!user?.id || initializationRef.current) {\r\n      return;\r\n    }\r\n\r\n    console.log('ðŸ”— Setting up gamification real-time subscription for user:', user.id);\r\n    \r\n    const channelKey = `gamification-${user.id}`;\r\n    \r\n    // Clean up any existing channel for this user\r\n    cleanup(user.id);\r\n    \r\n    // Mark as initialized\r\n    initializationRef.current = true;\r\n\r\n    // Create a single channel with a stable name\r\n    const channel = supabase.channel(channelKey, {\r\n      config: {\r\n        broadcast: { self: false }\r\n      }\r\n    });\r\n\r\n    // Configure all the real-time listeners\r\n    channel\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'user_xp',\r\n          filter: `user_id=eq.${user.id}`\r\n        },\r\n        () => {\r\n          console.log('Real-time XP update detected');\r\n          refreshStats();\r\n        }\r\n      )\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'user_badges',\r\n          filter: `user_id=eq.${user.id}`\r\n        },\r\n        () => {\r\n          console.log('Real-time badge update detected');\r\n          refreshStats();\r\n        }\r\n      )\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'achievements',\r\n          filter: `user_id=eq.${user.id}`\r\n        },\r\n        () => {\r\n          console.log('Real-time achievement update detected');\r\n          refreshStats();\r\n        }\r\n      )\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'streaks',\r\n          filter: `user_id=eq.${user.id}`\r\n        },\r\n        () => {\r\n          console.log('Real-time streak update detected');\r\n          refreshStats();\r\n        }\r\n      );\r\n\r\n    // Subscribe to the channel only once\r\n    channel.subscribe((status) => {\r\n      console.log('Gamification channel subscription status:', status);\r\n      if (status === 'SUBSCRIBED') {\r\n        console.log('âœ… Gamification channel successfully subscribed');\r\n      } else if (status === 'CLOSED' || status === 'CHANNEL_ERROR') {\r\n        console.log('âŒ Gamification channel closed or error');\r\n        initializationRef.current = false;\r\n      }\r\n    });\r\n\r\n    // Store the channel reference for cleanup\r\n    activeChannels.set(channelKey, channel);\r\n\r\n    // Cleanup function for effect\r\n    return () => {\r\n      initializationRef.current = false;\r\n    };\r\n  }, [user?.id]); // Only depend on user.id\r\n\r\n  // Cleanup when user logs out\r\n  useEffect(() => {\r\n    if (!user?.id && initializationRef.current) {\r\n      // Clean up all channels when user logs out\r\n      activeChannels.forEach((channel, key) => {\r\n        try {\r\n          supabase.removeChannel(channel);\r\n        } catch (error) {\r\n          console.log('Error removing channel during logout:', error);\r\n        }\r\n      });\r\n      activeChannels.clear();\r\n      initializationRef.current = false;\r\n    }\r\n  }, [user?.id]);\r\n\r\n  // Auto-refresh on mount\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchUserStats();\r\n    }\r\n  }, [user, fetchUserStats]);\r\n\r\n  const value = {\r\n    userStats,\r\n    refreshStats,\r\n    isLoading\r\n  };\r\n\r\n  return (\r\n    <GamificationContext.Provider value={value}>\r\n      {children}\r\n    </GamificationContext.Provider>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\contexts\\VoiceSettingsContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":37,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":37,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'saveSettingsToStorage'. Either include it or remove the dependency array.","line":144,"column":6,"nodeType":"ArrayExpression","endLine":144,"endColumn":115,"suggestions":[{"desc":"Update the dependencies array to be: [settings.enabled, settings.autoRead, settings.selectedVoice, settings.rate, settings.pitch, settings.volume, saveSettingsToStorage]","fix":{"range":[4554,4663],"text":"[settings.enabled, settings.autoRead, settings.selectedVoice, settings.rate, settings.pitch, settings.volume, saveSettingsToStorage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface VoiceSettings {\r\n  enabled: boolean;\r\n  autoRead: boolean;\r\n  selectedVoice: string | null; // Browser voice name\r\n  rate: number;\r\n  pitch: number;\r\n  volume: number;\r\n  hasInteracted: boolean;\r\n  paused: boolean;\r\n}\r\n\r\ninterface BrowserVoice {\r\n  id: string;\r\n  name: string;\r\n  gender: string;\r\n}\r\n\r\ninterface VoiceSettingsContextType {\r\n  settings: VoiceSettings;\r\n  updateSettings: (updates: Partial<VoiceSettings>) => void;\r\n  availableVoices: BrowserVoice[];\r\n  isSupported: boolean;\r\n  toggle: () => void;\r\n  togglePaused: () => void;\r\n  initializeVoice: () => Promise<void>;\r\n  setSelectedVoice: (voiceId: string) => void;\r\n  saveSettingsToStorage: () => void;\r\n  loadSettingsFromStorage: () => Partial<VoiceSettings>;\r\n}\r\n\r\nconst VoiceSettingsContext = createContext<VoiceSettingsContextType | undefined>(undefined);\r\n\r\nexport const useVoiceSettings = () => {\r\n  const context = useContext(VoiceSettingsContext);\r\n  if (!context) {\r\n    throw new Error('useVoiceSettings must be used within a VoiceSettingsProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n// Get browser voices and map them to our interface\r\nconst getBrowserVoices = (): BrowserVoice[] => {\r\n  if (!('speechSynthesis' in window)) return [];\r\n  \r\n  const voices = window.speechSynthesis.getVoices();\r\n  return voices.map(voice => ({\r\n    id: voice.name,\r\n    name: `${voice.name} (${voice.lang})`,\r\n    gender: voice.name.toLowerCase().includes('female') || voice.name.toLowerCase().includes('woman') ? 'female' : 'male'\r\n  }));\r\n};\r\n\r\nexport const VoiceSettingsProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const cleanup = useCleanup('VoiceSettingsProvider');\r\n  const [settings, setSettings] = useState<VoiceSettings>({\r\n    enabled: true,\r\n    autoRead: true,\r\n    selectedVoice: null, // Will be set to first available voice\r\n    rate: 1.0,\r\n    pitch: 1.0,\r\n    volume: 0.8,\r\n    hasInteracted: false,\r\n    paused: false\r\n  });\r\n  \r\n  const [availableVoices, setAvailableVoices] = useState<BrowserVoice[]>([]);\r\n  const isSupported = 'speechSynthesis' in window;\r\n\r\n  // Load voices when available\r\n  useEffect(() => {\r\n    if (!isSupported) return;\r\n\r\n    const loadVoices = () => {\r\n      const voices = getBrowserVoices();\r\n      setAvailableVoices(voices);\r\n      \r\n      // Set default voice if none selected\r\n      if (!settings.selectedVoice && voices.length > 0) {\r\n        const defaultVoice = voices.find(v => v.name.includes('English')) || voices[0];\r\n        setSettings(prev => ({ ...prev, selectedVoice: defaultVoice.id }));\r\n      }\r\n    };\r\n\r\n    // Load voices immediately and also when they change\r\n    loadVoices();\r\n    window.speechSynthesis.onvoiceschanged = loadVoices;\r\n\r\n    return () => {\r\n      window.speechSynthesis.onvoiceschanged = null;\r\n    };\r\n  }, [isSupported, settings.selectedVoice]);\r\n\r\n  // Load settings from localStorage on mount\r\n  const loadSettingsFromStorage = (): Partial<VoiceSettings> => {\r\n    const stored = safeLocalStorage.getItem<Partial<VoiceSettings>>('voiceSettings', {\r\n      fallbackValue: {},\r\n      logErrors: false\r\n    });\r\n    \r\n    if (stored && typeof stored === 'object') {\r\n      console.log('ðŸ”Š Loaded voice settings from storage:', stored);\r\n      return stored;\r\n    }\r\n    \r\n    return {};\r\n  };\r\n\r\n  // Save settings to localStorage (safe)\r\n  const saveSettingsToStorage = () => {\r\n    const success = safeLocalStorage.setItem('voiceSettings', {\r\n      enabled: settings.enabled,\r\n      autoRead: settings.autoRead,\r\n      selectedVoice: settings.selectedVoice,\r\n      rate: settings.rate,\r\n      pitch: settings.pitch,\r\n      volume: settings.volume\r\n    });\r\n    \r\n    if (success) {\r\n      console.log('ðŸ”Š Saved voice settings to storage');\r\n    }\r\n  };\r\n\r\n  // Load settings on mount\r\n  useEffect(() => {\r\n    const storedSettings = loadSettingsFromStorage();\r\n    if (Object.keys(storedSettings).length > 0) {\r\n      // Always ensure TTS is enabled by default, even if stored settings say otherwise\r\n      setSettings(prev => ({ ...prev, ...storedSettings, enabled: true }));\r\n    }\r\n  }, []);\r\n\r\n  // Save settings whenever they change - debounced to prevent performance issues\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      saveSettingsToStorage();\r\n    }, 1000); // Debounce saves by 1 second\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [settings.enabled, settings.autoRead, settings.selectedVoice, settings.rate, settings.pitch, settings.volume]);\r\n\r\n  // Track user interaction for TTS\r\n  useEffect(() => {\r\n    const handleUserInteraction = () => {\r\n      if (!settings.hasInteracted) {\r\n        console.log('ðŸ”Š User interaction detected, enabling browser TTS');\r\n        setSettings(prev => ({ ...prev, hasInteracted: true }));\r\n      }\r\n    };\r\n\r\n    cleanup.addEventListener(document, 'click', handleUserInteraction);\r\n    cleanup.addEventListener(document, 'keydown', handleUserInteraction);\r\n  }, [settings.hasInteracted, cleanup]);\r\n\r\n  const initializeVoice = async (): Promise<void> => {\r\n    console.log('ðŸ”Š Browser voice system initialized with', availableVoices.length, 'voices');\r\n  };\r\n\r\n  const updateSettings = (updates: Partial<VoiceSettings>) => {\r\n    setSettings(prev => ({ ...prev, ...updates }));\r\n  };\r\n\r\n  const setSelectedVoice = (voiceId: string) => {\r\n    console.log('ðŸ”Š Setting selected voice to:', voiceId);\r\n    setSettings(prev => ({ ...prev, selectedVoice: voiceId }));\r\n  };\r\n\r\n  const toggle = () => {\r\n    const newEnabled = !settings.enabled;\r\n    console.log('ðŸ”Š Browser TTS toggled:', newEnabled ? 'enabled' : 'disabled');\r\n    setSettings(prev => ({ ...prev, enabled: newEnabled, paused: false }));\r\n  };\r\n\r\n  const togglePaused = () => {\r\n    const newPaused = !settings.paused;\r\n    console.log('ðŸ”Š Pause state toggled to:', newPaused);\r\n    setSettings(prev => ({ ...prev, paused: newPaused }));\r\n  };\r\n\r\n  const value = {\r\n    settings,\r\n    updateSettings,\r\n    availableVoices,\r\n    isSupported,\r\n    toggle,\r\n    togglePaused,\r\n    initializeVoice,\r\n    setSelectedVoice,\r\n    saveSettingsToStorage,\r\n    loadSettingsFromStorage\r\n  };\r\n\r\n  return (\r\n    <VoiceSettingsContext.Provider value={value}>\r\n      {children}\r\n    </VoiceSettingsContext.Provider>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\scorm\\useScormAnalytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":198,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5984,5987],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5984,5987],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":225,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6687,6690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6687,6690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nexport interface ScormSummaryData {\r\n  totalPackages: number;\r\n  totalEnrollments: number;\r\n  completed: number;\r\n  avgScore: number;\r\n  avgMinutes: number;\r\n  packages: PackageMetric[];\r\n}\r\n\r\nexport interface PackageMetric {\r\n  id: string;\r\n  title: string;\r\n  status: string;\r\n  created_at: string;\r\n  enrollment_count: number;\r\n  completions: number;\r\n  completion_rate: number;\r\n  avg_score: number;\r\n}\r\n\r\nexport interface LearnerProgress {\r\n  enrollment_id: string;\r\n  user_id: string;\r\n  package_id: string;\r\n  package_title: string;\r\n  learner_name: string;\r\n  total_scos: number;\r\n  completed_scos: number;\r\n  progress_percentage: number;\r\n  last_commit_at: string | null;\r\n  enrolled_at: string;\r\n  avg_score: number;\r\n}\r\n\r\nexport function useScormSummary({ \r\n  days, \r\n  packageId \r\n}: { \r\n  days?: number; \r\n  packageId?: string \r\n} = {}) {\r\n  return useQuery<ScormSummaryData>({\r\n    queryKey: ['scorm-summary', days, packageId],\r\n    queryFn: async () => {\r\n      try {\r\n        // Get total packages count\r\n        const { count: totalPackages, error: packagesError } = await supabase\r\n          .from('scorm_packages')\r\n          .select('*', { count: 'exact', head: true });\r\n\r\n        if (packagesError) {\r\n          console.error('Error fetching packages count:', packagesError);\r\n        }\r\n\r\n        // Get total enrollments count with date filter\r\n        let enrollmentsQuery = supabase\r\n          .from('scorm_enrollments')\r\n          .select('*', { count: 'exact', head: true });\r\n        \r\n        if (days) {\r\n          const dateFrom = new Date(Date.now() - days * 24 * 60 * 60 * 1000).toISOString();\r\n          enrollmentsQuery = enrollmentsQuery.gte('enrolled_at', dateFrom);\r\n        }\r\n\r\n        const { count: totalEnrollments, error: enrollmentsError } = await enrollmentsQuery;\r\n        \r\n        if (enrollmentsError) {\r\n          console.error('Error fetching enrollments count:', enrollmentsError);\r\n        }\r\n\r\n        // Get package metrics from the view\r\n        let metricsQuery = supabase.from('scorm_package_metrics').select('*');\r\n        \r\n        if (packageId) {\r\n          metricsQuery = metricsQuery.eq('id', packageId);\r\n        }\r\n\r\n        const { data: packageMetrics, error: metricsError } = await metricsQuery;\r\n        \r\n        if (metricsError) {\r\n          console.error('Error fetching package metrics:', metricsError);\r\n        }\r\n\r\n        // Calculate totals from package metrics\r\n        const totals = (packageMetrics || []).reduce((acc, pkg) => {\r\n          acc.completed += Number(pkg.completions) || 0;\r\n          acc.scoreSum += Number(pkg.avg_score) || 0;\r\n          acc.pkgCount += pkg.avg_score ? 1 : 0; // Only count packages with scores\r\n          acc.enrollments += Number(pkg.enrollment_count) || 0;\r\n          return acc;\r\n        }, { \r\n          completed: 0, \r\n          scoreSum: 0, \r\n          pkgCount: 0, \r\n          enrollments: 0\r\n        });\r\n\r\n        return {\r\n          totalPackages: totalPackages || 0,\r\n          totalEnrollments: totals.enrollments || 0,\r\n          completed: totals.completed,\r\n          avgScore: totals.pkgCount > 0 ? Math.round(totals.scoreSum / totals.pkgCount) : 0,\r\n          avgMinutes: 0, // Not available in current view structure\r\n          packages: packageMetrics || []\r\n        };\r\n      } catch (error) {\r\n        console.error('Error in useScormSummary:', error);\r\n        // Return zeros on error\r\n        return {\r\n          totalPackages: 0,\r\n          totalEnrollments: 0,\r\n          completed: 0,\r\n          avgScore: 0,\r\n          avgMinutes: 0,\r\n          packages: []\r\n        };\r\n      }\r\n    },\r\n    staleTime: 30_000, // Cache for 30 seconds\r\n    refetchOnWindowFocus: false,\r\n  });\r\n}\r\n\r\nexport function useLearnerProgress({ \r\n  packageId,\r\n  limit = 50,\r\n  offset = 0\r\n}: { \r\n  packageId?: string;\r\n  limit?: number;\r\n  offset?: number;\r\n} = {}) {\r\n  return useQuery<{ data: LearnerProgress[]; total: number; page: number; pageSize: number; }>({\r\n    queryKey: ['scorm-learner-progress', packageId, limit, offset],\r\n    queryFn: async () => {\r\n      try {\r\n        let query = supabase\r\n          .from('scorm_learner_progress')\r\n          .select('*', { count: 'exact' })\r\n          .order('enrolled_at', { ascending: false })\r\n          .range(offset, offset + limit - 1);\r\n        \r\n        if (packageId) {\r\n          query = query.eq('package_id', packageId);\r\n        }\r\n\r\n        const { data, error, count } = await query;\r\n        \r\n        if (error) {\r\n          console.error('Error fetching learner progress:', error);\r\n          return { data: [], total: 0, page: Math.floor(offset / limit) + 1, pageSize: limit };\r\n        }\r\n\r\n        return { \r\n          data: data || [], \r\n          total: count || 0, \r\n          page: Math.floor(offset / limit) + 1, \r\n          pageSize: limit \r\n        };\r\n      } catch (error) {\r\n        console.error('Error in useLearnerProgress:', error);\r\n        return { data: [], total: 0, page: 1, pageSize: limit };\r\n      }\r\n    },\r\n    staleTime: 60_000, // Cache for 1 minute\r\n    refetchOnWindowFocus: false,\r\n  });\r\n}\r\n\r\nexport function useScormPackages({\r\n  limit = 20,\r\n  offset = 0,\r\n  search = '',\r\n  status = 'all'\r\n}: {\r\n  limit?: number;\r\n  offset?: number;\r\n  search?: string;\r\n  status?: string;\r\n} = {}) {\r\n  return useQuery({\r\n    queryKey: ['scorm-packages', limit, offset, search, status],\r\n    queryFn: async () => {\r\n      try {\r\n        let query = supabase\r\n          .from('scorm_packages')\r\n          .select('id, title, description, status, version, created_at, updated_at', { count: 'exact' })\r\n          .order('created_at', { ascending: false });\r\n\r\n        if (search) {\r\n          query = query.or(`title.ilike.%${search}%,description.ilike.%${search}%`);\r\n        }\r\n\r\n        if (status !== 'all') {\r\n          query = query.eq('status', status as any);\r\n        }\r\n\r\n        query = query.range(offset, offset + limit - 1);\r\n\r\n        const { data, error, count } = await query;\r\n        \r\n        if (error) {\r\n          console.error('Error fetching SCORM packages:', error);\r\n          return { packages: [], total: 0 };\r\n        }\r\n\r\n        return { \r\n          packages: data || [], \r\n          total: count || 0 \r\n        };\r\n      } catch (error) {\r\n        console.error('Error in useScormPackages:', error);\r\n        return { packages: [], total: 0 };\r\n      }\r\n    },\r\n    staleTime: 60_000, // Cache for 1 minute\r\n    refetchOnWindowFocus: false,\r\n  });\r\n}\r\n\r\n// Export function to download data as CSV\r\nexport function exportToCSV(data: any[], filename: string) {\r\n  if (!data || data.length === 0) return;\r\n\r\n  const headers = Object.keys(data[0]);\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...data.map(row => \r\n      headers.map(header => {\r\n        const value = row[header];\r\n        // Escape values that contain commas or quotes\r\n        if (typeof value === 'string' && (value.includes(',') || value.includes('\"'))) {\r\n          return `\"${value.replace(/\"/g, '\"\"')}\"`;\r\n        }\r\n        return value || '';\r\n      }).join(',')\r\n    )\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n  link.setAttribute('href', url);\r\n  link.setAttribute('download', `${filename}-${new Date().toISOString().split('T')[0]}.csv`);\r\n  link.style.visibility = 'hidden';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\use-mobile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAICoachAnalytics.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAICoachAnalytics'. Either include it or remove the dependency array.","line":181,"column":6,"nodeType":"ArrayExpression","endLine":181,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [loadAICoachAnalytics, targetUserId]","fix":{"range":[6216,6230],"text":"[loadAICoachAnalytics, targetUserId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\ninterface AICoachSession {\r\n  id: string;\r\n  title: string;\r\n  context_tag: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  message_count?: number;\r\n  duration_minutes?: number;\r\n}\r\n\r\ninterface AICoachMessage {\r\n  id: string;\r\n  session_id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\ninterface AICoachMetrics {\r\n  totalSessions: number;\r\n  totalMessages: number;\r\n  averageSessionDuration: number;\r\n  averageMessagesPerSession: number;\r\n  sessionsThisWeek: number;\r\n  weeklySessionGrowth: number;\r\n  contextTagDistribution: { [key: string]: number };\r\n  weeklyActivity: Array<{\r\n    week: string;\r\n    sessions: number;\r\n    messages: number;\r\n  }>;\r\n}\r\n\r\nexport const useAICoachAnalytics = (userId?: string) => {\r\n  const [metrics, setMetrics] = useState<AICoachMetrics | null>(null);\r\n  const [sessions, setSessions] = useState<AICoachSession[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const { user } = useAuth();\r\n\r\n  // Use provided userId or fall back to current user\r\n  const targetUserId = userId || user?.id;\r\n\r\n  const loadAICoachAnalytics = async () => {\r\n    if (!targetUserId) return;\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      // Fetch all chat sessions for the user\r\n      const { data: sessionsData, error: sessionsError } = await supabase\r\n        .from('chat_sessions')\r\n        .select('*')\r\n        .eq('user_id', targetUserId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (sessionsError) throw sessionsError;\r\n\r\n      // Fetch all messages for these sessions\r\n      const sessionIds = sessionsData?.map(s => s.id) || [];\r\n      let messagesData: AICoachMessage[] = [];\r\n      \r\n      if (sessionIds.length > 0) {\r\n        const { data: messages, error: messagesError } = await supabase\r\n          .from('chat_messages')\r\n          .select('*')\r\n          .in('session_id', sessionIds)\r\n          .order('timestamp', { ascending: true });\r\n\r\n        if (messagesError) throw messagesError;\r\n        \r\n        // Type cast the role field to ensure it matches our expected union type\r\n        messagesData = (messages || []).map(msg => ({\r\n          ...msg,\r\n          role: msg.role as 'user' | 'assistant'\r\n        }));\r\n      }\r\n\r\n      // Calculate session durations and message counts\r\n      const enrichedSessions: AICoachSession[] = (sessionsData || []).map(session => {\r\n        const sessionMessages = messagesData.filter(m => m.session_id === session.id);\r\n        const messageCount = sessionMessages.length;\r\n        \r\n        let durationMinutes = 0;\r\n        if (sessionMessages.length > 1) {\r\n          const firstMessage = new Date(sessionMessages[0].timestamp);\r\n          const lastMessage = new Date(sessionMessages[sessionMessages.length - 1].timestamp);\r\n          durationMinutes = Math.round((lastMessage.getTime() - firstMessage.getTime()) / (1000 * 60));\r\n        }\r\n\r\n        return {\r\n          ...session,\r\n          message_count: messageCount,\r\n          duration_minutes: Math.max(durationMinutes, 1) // Minimum 1 minute\r\n        };\r\n      });\r\n\r\n      setSessions(enrichedSessions);\r\n\r\n      // Calculate metrics\r\n      const now = new Date();\r\n      const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n      const twoWeeksAgo = new Date(now.getTime() - 14 * 24 * 60 * 60 * 1000);\r\n\r\n      const totalSessions = enrichedSessions.length;\r\n      const totalMessages = messagesData.length;\r\n      const totalDuration = enrichedSessions.reduce((sum, s) => sum + (s.duration_minutes || 0), 0);\r\n      \r\n      const sessionsThisWeek = enrichedSessions.filter(s => \r\n        new Date(s.created_at) >= oneWeekAgo\r\n      ).length;\r\n      \r\n      const sessionsLastWeek = enrichedSessions.filter(s => {\r\n        const createdAt = new Date(s.created_at);\r\n        return createdAt >= twoWeeksAgo && createdAt < oneWeekAgo;\r\n      }).length;\r\n\r\n      const weeklySessionGrowth = sessionsLastWeek > 0 \r\n        ? Math.round(((sessionsThisWeek - sessionsLastWeek) / sessionsLastWeek) * 100)\r\n        : sessionsThisWeek > 0 ? 100 : 0;\r\n\r\n      // Context tag distribution\r\n      const contextTagDistribution: { [key: string]: number } = {};\r\n      enrichedSessions.forEach(session => {\r\n        const tag = session.context_tag || 'General Study Support';\r\n        contextTagDistribution[tag] = (contextTagDistribution[tag] || 0) + 1;\r\n      });\r\n\r\n      // Weekly activity for the last 4 weeks\r\n      const weeklyActivity = [];\r\n      for (let i = 3; i >= 0; i--) {\r\n        const weekStart = new Date(now.getTime() - (i + 1) * 7 * 24 * 60 * 60 * 1000);\r\n        const weekEnd = new Date(now.getTime() - i * 7 * 24 * 60 * 60 * 1000);\r\n        \r\n        const weekSessions = enrichedSessions.filter(s => {\r\n          const createdAt = new Date(s.created_at);\r\n          return createdAt >= weekStart && createdAt < weekEnd;\r\n        });\r\n\r\n        const weekMessages = messagesData.filter(m => {\r\n          const timestamp = new Date(m.timestamp);\r\n          return timestamp >= weekStart && timestamp < weekEnd;\r\n        });\r\n\r\n        weeklyActivity.push({\r\n          week: `Week ${4 - i}`,\r\n          sessions: weekSessions.length,\r\n          messages: weekMessages.length\r\n        });\r\n      }\r\n\r\n      const calculatedMetrics: AICoachMetrics = {\r\n        totalSessions,\r\n        totalMessages,\r\n        averageSessionDuration: totalSessions > 0 ? Math.round(totalDuration / totalSessions) : 0,\r\n        averageMessagesPerSession: totalSessions > 0 ? Math.round(totalMessages / totalSessions) : 0,\r\n        sessionsThisWeek,\r\n        weeklySessionGrowth,\r\n        contextTagDistribution,\r\n        weeklyActivity\r\n      };\r\n\r\n      setMetrics(calculatedMetrics);\r\n\r\n    } catch (error) {\r\n      console.error('Error loading AI Coach analytics:', error);\r\n      setError('Failed to load AI Coach analytics');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadAICoachAnalytics();\r\n  }, [targetUserId]);\r\n\r\n  return {\r\n    metrics,\r\n    sessions,\r\n    isLoading,\r\n    error,\r\n    refetch: loadAICoachAnalytics\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAICoachPerformanceAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAIFeatureGate.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has unnecessary dependencies: 'canUseFeature' and 'toast'. Either exclude them or remove the dependency array.","line":81,"column":6,"nodeType":"ArrayExpression","endLine":81,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [trackUsage]","fix":{"range":[2320,2354],"text":"[trackUsage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback } from 'react';\r\nimport { useUsageTracking, AIFeatureType } from '@/hooks/useUsageTracking';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\n/**\r\n * Custom hook for gating AI features based on usage limits\r\n * Automatically tracks usage when a feature is used\r\n */\r\nexport function useAIFeatureGate() {\r\n  const { canUseFeature, trackUsage, isTrackingUsage } = useUsageTracking();\r\n  const { toast } = useToast();\r\n\r\n  /**\r\n   * Execute an AI feature action with automatic usage tracking\r\n   */\r\n  const executeWithGate = useCallback(async <T>(\r\n    featureType: AIFeatureType,\r\n    action: () => Promise<T>,\r\n    options: {\r\n      amount?: number;\r\n      metadata?: Record<string, unknown>;\r\n      onLimitReached?: () => void;\r\n      silentLimitCheck?: boolean;\r\n    } = {}\r\n  ): Promise<T | null> => {\r\n    const { \r\n      amount = 1, \r\n      metadata = {}, \r\n      onLimitReached, \r\n      silentLimitCheck = false \r\n    } = options;\r\n\r\n    // Skip limit checking - unlimited access for all users\r\n    // if (!canUseFeature(featureType, amount)) {\r\n    //   if (!silentLimitCheck) {\r\n    //     toast({\r\n    //       title: \"Usage Limit Reached\", \r\n    //       description: `You've reached your ${featureType.replace('_', ' ')} limit. Please upgrade your plan to continue.`,\r\n    //       variant: \"destructive\"\r\n    //     });\r\n    //   }\r\n    //   \r\n    //   if (onLimitReached) {\r\n    //     onLimitReached();\r\n    //   }\r\n    //   \r\n    //   return null;\r\n    // }\r\n\r\n    try {\r\n      // Execute the action first\r\n      const result = await action();\r\n      \r\n      // Track usage after successful execution\r\n      trackUsage({\r\n        featureType,\r\n        amount,\r\n        metadata: {\r\n          ...metadata,\r\n          timestamp: new Date().toISOString(),\r\n          success: true\r\n        }\r\n      });\r\n\r\n      return result;\r\n    } catch (error) {\r\n      // Still track usage even if action fails (user consumed the resource)\r\n      trackUsage({\r\n        featureType,\r\n        amount,\r\n        metadata: {\r\n          ...metadata,\r\n          timestamp: new Date().toISOString(),\r\n          success: false,\r\n          error: error instanceof Error ? error.message : 'Unknown error'\r\n        }\r\n      });\r\n\r\n      throw error; // Re-throw the error for the caller to handle\r\n    }\r\n  }, [canUseFeature, trackUsage, toast]);\r\n\r\n  /**\r\n   * Check if a feature can be used without executing it\r\n   */\r\n  const checkFeatureAccess = useCallback((\r\n    featureType: AIFeatureType,\r\n    amount: number = 1\r\n  ): boolean => {\r\n    // Always return true for unlimited access\r\n    return true;\r\n  }, []);\r\n\r\n  /**\r\n   * Get a gate component for wrapping UI elements\r\n   */\r\n  const createGatedAction = useCallback(<T extends unknown[]>(\r\n    featureType: AIFeatureType,\r\n    action: (...args: T) => Promise<unknown> | unknown,\r\n    options: {\r\n      amount?: number;\r\n      metadata?: Record<string, unknown>;\r\n      onLimitReached?: () => void;\r\n    } = {}\r\n  ) => {\r\n    return async (...args: T) => {\r\n      if (typeof action === 'function') {\r\n        return executeWithGate(\r\n          featureType,\r\n          () => Promise.resolve(action(...args)),\r\n          options\r\n        );\r\n      }\r\n      return null;\r\n    };\r\n  }, [executeWithGate]);\r\n\r\n  return {\r\n    executeWithGate,\r\n    checkFeatureAccess,\r\n    createGatedAction,\r\n    isProcessing: isTrackingUsage,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAIInsights.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAccessibility.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'profile'. Either include it or remove the dependency array.","line":40,"column":6,"nodeType":"ArrayExpression","endLine":46,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [profile]","fix":{"range":[1253,1396],"text":"[profile]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useEffect, useState, useMemo, useCallback } from 'react';\r\nimport { useUserProfile } from '@/hooks/useUserProfile';\r\n\r\ninterface AccessibilityClasses {\r\n  fontFamily: string;\r\n  textSize: string;\r\n  lineHeight: string;\r\n  textColor: string;\r\n  backgroundColor: string;\r\n  borderColor: string;\r\n  cardClasses: string;\r\n  containerClasses: string;\r\n}\r\n\r\nexport const useAccessibility = () => {\r\n  const { profile } = useUserProfile();\r\n  const [classes, setClasses] = useState<AccessibilityClasses>({\r\n    fontFamily: 'font-system',\r\n    textSize: 'text-base',\r\n    lineHeight: 'leading-normal',\r\n    textColor: 'text-foreground',\r\n    backgroundColor: 'bg-background',\r\n    borderColor: 'border-border',\r\n    cardClasses: 'bg-card text-card-foreground',\r\n    containerClasses: 'bg-background text-foreground'\r\n  });\r\n\r\n  // Memoize profile values to prevent unnecessary re-renders\r\n  const profileSettings = useMemo(() => {\r\n    if (!profile) return null;\r\n    \r\n    return {\r\n      fontFamily: profile.font_family || 'System',\r\n      textSize: profile.text_size || 3,\r\n      lineSpacing: profile.line_spacing || 3,\r\n      colorContrast: profile.color_contrast || 'Standard',\r\n      comfortMode: profile.comfort_mode || 'Normal'\r\n    };\r\n  }, [\r\n    profile?.font_family,\r\n    profile?.text_size,\r\n    profile?.line_spacing,\r\n    profile?.color_contrast,\r\n    profile?.comfort_mode\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (!profileSettings) return;\r\n\r\n    // Only log occasionally to avoid console spam - log every 10th update\r\n    const shouldLog = Math.random() < 0.1;\r\n    if (shouldLog) {\r\n      console.log('ðŸŽ¨ useAccessibility: Updating classes for profile', profileSettings);\r\n    }\r\n\r\n    // Apply accessibility settings globally via CSS variables\r\n    const root = document.documentElement;\r\n    root.style.setProperty('--accessibility-text-size', `${profileSettings.textSize * 0.25 + 0.75}rem`);\r\n    root.style.setProperty('--accessibility-line-height', `${profileSettings.lineSpacing * 0.25 + 1}`);\r\n    \r\n    const fontMapping = {\r\n      'System': 'system-ui, -apple-system, sans-serif',\r\n      'OpenDyslexic': 'OpenDyslexic, system-ui, sans-serif',\r\n      'Arial': 'Arial, sans-serif',\r\n      'Times': 'Times, serif',\r\n      'Verdana': 'Verdana, sans-serif'\r\n    };\r\n    root.style.setProperty('--accessibility-font-family', fontMapping[profileSettings.fontFamily as keyof typeof fontMapping] || fontMapping.System);\r\n\r\n    // Component classes for fallback and component-specific styling\r\n    const newClasses: AccessibilityClasses = {\r\n      fontFamily: `font-${profileSettings.fontFamily.toLowerCase().replace(/\\s+/g, '-')}`,\r\n      textSize: 'text-accessibility', // Use CSS variable\r\n      lineHeight: 'leading-accessibility', // Use CSS variable\r\n      textColor: profileSettings.colorContrast === 'High' ? 'text-black' : 'text-foreground',\r\n      backgroundColor: 'bg-background',\r\n      borderColor: 'border-border',\r\n      cardClasses: 'bg-card text-card-foreground border-border',\r\n      containerClasses: 'bg-background text-foreground'\r\n    };\r\n\r\n    setClasses(newClasses);\r\n    \r\n  }, [profileSettings]);\r\n\r\n  const getAccessibilityClasses = useCallback((element: 'card' | 'container' | 'text' = 'container') => {\r\n    const baseClasses = `transition-all duration-200`;\r\n    \r\n    switch (element) {\r\n      case 'card':\r\n        return `${baseClasses} ${classes.cardClasses}`;\r\n      case 'text':\r\n        return `${baseClasses} ${classes.textColor}`;\r\n      case 'container':\r\n      default:\r\n        return `${baseClasses} ${classes.containerClasses}`;\r\n    }\r\n  }, [classes]);\r\n\r\n  return useMemo(() => ({\r\n    classes,\r\n    getAccessibilityClasses,\r\n    profile,\r\n    isHighContrast: profileSettings?.colorContrast === 'High',\r\n    comfortMode: profileSettings?.comfortMode || 'Normal',\r\n    fontFamily: profileSettings?.fontFamily || 'System',\r\n    textSize: profileSettings?.textSize || 3,\r\n    lineSpacing: profileSettings?.lineSpacing || 3\r\n  }), [classes, getAccessibilityClasses, profile, profileSettings]);\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useActivityDistribution.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useActivityHeatmap.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAdaptiveLearning.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'generateLearningProfile'. Either include it or remove the dependency array.","line":65,"column":6,"nodeType":"ArrayExpression","endLine":65,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [generateLearningProfile, user.id]","fix":{"range":[2209,2219],"text":"[generateLearningProfile, user.id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'analyzeUserData'. Either include it or remove the dependency array.","line":112,"column":6,"nodeType":"ArrayExpression","endLine":112,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [analyzeUserData, user.id]","fix":{"range":[3772,3782],"text":"[analyzeUserData, user.id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":148,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5362,5365],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5362,5365],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":238,"column":91,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":238,"endColumn":94,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8648,8651],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8648,8651],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport type { Json } from '@/integrations/supabase/types';\r\n\r\ninterface LearningProfile {\r\n  preferredContentTypes: string[];\r\n  optimalDifficulty: number;\r\n  attentionSpan: number;\r\n  learningVelocity: number;\r\n  strengths: string[];\r\n  challenges: string[];\r\n  adaptations: Record<string, unknown>;\r\n  [key: string]: unknown; // Add index signature for Json compatibility\r\n}\r\n\r\ninterface AdaptiveRecommendation {\r\n  type: 'content_adjustment' | 'difficulty_change' | 'format_change' | 'break_suggestion' | 'path_change';\r\n  priority: 'low' | 'medium' | 'high' | 'urgent';\r\n  title: string;\r\n  description: string;\r\n  actionData: Record<string, unknown>;\r\n  expectedImpact: string;\r\n  confidence: number;\r\n}\r\n\r\nexport const useAdaptiveLearning = () => {\r\n  const { user } = useAuth();\r\n  const [learningProfile, setLearningProfile] = useState<LearningProfile | null>(null);\r\n  const [recommendations, setRecommendations] = useState<AdaptiveRecommendation[]>([]);\r\n  const [adaptationHistory, setAdaptationHistory] = useState<Array<{\r\n    recommendation: AdaptiveRecommendation;\r\n    appliedAt: string;\r\n    effectiveness?: number;\r\n  }>>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Load user's learning profile\r\n  const loadLearningProfile = useCallback(async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Get stored learning profile\r\n      const { data: storedProfile } = await supabase\r\n        .from('adaptive_learning_paths')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .eq('is_active', true)\r\n        .single();\r\n\r\n      if (storedProfile) {\r\n        setLearningProfile(storedProfile.learning_profile as LearningProfile);\r\n      } else {\r\n        // Generate initial profile from behavioral data\r\n        const generatedProfile = await generateLearningProfile();\r\n        setLearningProfile(generatedProfile);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading learning profile:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  // Generate learning profile from behavioral analytics\r\n  const generateLearningProfile = useCallback(async (): Promise<LearningProfile> => {\r\n    if (!user?.id) {\r\n      return getDefaultProfile();\r\n    }\r\n\r\n    try {\r\n      // Get behavioral data from last 30 days\r\n      const thirtyDaysAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString();\r\n      \r\n      const { data: behavioralData } = await supabase\r\n        .from('behavioral_analytics')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .gte('timestamp', thirtyDaysAgo);\r\n\r\n      const { data: slideData } = await supabase\r\n        .from('slide_analytics')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .gte('timestamp', thirtyDaysAgo);\r\n\r\n      const { data: progressData } = await supabase\r\n        .from('lesson_progress_detailed')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .gte('updated_at', thirtyDaysAgo);\r\n\r\n      // Analyze data to create profile\r\n      const profile = analyzeUserData(behavioralData || [], slideData || [], progressData || []);\r\n      \r\n      // Store the generated profile\r\n      await supabase\r\n        .from('adaptive_learning_paths')\r\n        .upsert({\r\n          user_id: user.id,\r\n          learning_profile: profile as unknown as Json,\r\n          effectiveness_score: 0, // Will be updated as user interacts\r\n        });\r\n\r\n      return profile;\r\n    } catch (error) {\r\n      console.error('Error generating learning profile:', error);\r\n      return getDefaultProfile();\r\n    }\r\n  }, [user?.id]);\r\n\r\n  // Analyze user data to create learning profile  \r\n  const analyzeUserData = (behavioral: Record<string, unknown>[], slides: Record<string, unknown>[], progress: Record<string, unknown>[]): LearningProfile => {\r\n    // Analyze learning style preferences\r\n    const stylePreferences = analyzeLearningStyles(behavioral);\r\n    \r\n    // Analyze attention patterns\r\n    const attentionData = analyzeAttentionPatterns(behavioral, slides);\r\n    \r\n    // Analyze learning velocity\r\n    const velocityData = analyzeLearningVelocity(progress);\r\n    \r\n    // Analyze difficulty preferences\r\n    const difficultyData = analyzeDifficultyPreferences(progress, slides);\r\n    \r\n    // Identify strengths and challenges\r\n    const strengthsAndChallenges = identifyStrengthsAndChallenges(progress, behavioral);\r\n\r\n    return {\r\n      preferredContentTypes: stylePreferences,\r\n      optimalDifficulty: difficultyData.optimal,\r\n      attentionSpan: attentionData.average,\r\n      learningVelocity: velocityData.average,\r\n      strengths: strengthsAndChallenges.strengths,\r\n      challenges: strengthsAndChallenges.challenges,\r\n      adaptations: {\r\n        contentFormat: getBestContentFormat(stylePreferences),\r\n        sessionLength: getOptimalSessionLength(attentionData.average),\r\n        difficultyProgression: getDifficultyProgression(difficultyData),\r\n        breakFrequency: getOptimalBreakFrequency(attentionData.variance)\r\n      }\r\n    };\r\n  };\r\n\r\n  // Generate AI-powered adaptive recommendations\r\n  const generateRecommendations = useCallback(async (currentContext: Record<string, any>) => {\r\n    if (!user?.id || !learningProfile) return;\r\n\r\n    try {\r\n      // Get recent performance data\r\n      const recentData = await getRecentPerformanceData();\r\n      \r\n      // Analyze current learning state\r\n      const currentState = await analyzeLearningState(recentData, currentContext);\r\n      \r\n      // Generate recommendations based on profile and current state\r\n      const newRecommendations = await generateContextualRecommendations(\r\n        learningProfile, \r\n        currentState, \r\n        currentContext\r\n      );\r\n\r\n      setRecommendations(newRecommendations);\r\n\r\n      // Store recommendations in database\r\n      for (const rec of newRecommendations) {\r\n        await supabase\r\n          .from('ai_recommendations')\r\n          .insert({\r\n            user_id: user.id,\r\n            recommendation_type: rec.type,\r\n            recommendation_data: {\r\n              title: rec.title,\r\n              description: rec.description,\r\n              actionData: rec.actionData as unknown as Json,\r\n              expectedImpact: rec.expectedImpact,\r\n              confidence: rec.confidence,\r\n              priority: rec.priority\r\n            } as Json,\r\n            trigger_context: currentContext as unknown as Json,\r\n            expires_at: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString() // 24 hours\r\n          });\r\n      }\r\n\r\n      console.log(`ðŸ¤– Generated ${newRecommendations.length} adaptive recommendations`);\r\n    } catch (error) {\r\n      console.error('Error generating recommendations:', error);\r\n    }\r\n  }, [user?.id, learningProfile]);\r\n\r\n  // Apply adaptive recommendation\r\n  const applyRecommendation = useCallback(async (recommendation: AdaptiveRecommendation, effectiveness?: number) => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      // Mark recommendation as applied\r\n      await supabase\r\n        .from('ai_recommendations')\r\n        .update({\r\n          applied_at: new Date().toISOString(),\r\n          effectiveness_rating: effectiveness\r\n        })\r\n        .eq('user_id', user.id)\r\n        .eq('recommendation_type', recommendation.type);\r\n\r\n      // Update learning profile based on effectiveness\r\n      if (effectiveness && learningProfile) {\r\n        const updatedProfile = updateProfileFromFeedback(learningProfile, recommendation, effectiveness);\r\n        setLearningProfile(updatedProfile);\r\n        \r\n        await supabase\r\n          .from('adaptive_learning_paths')\r\n          .update({ \r\n            learning_profile: updatedProfile as unknown as Json,\r\n            effectiveness_score: calculateEffectivenessScore(adaptationHistory)\r\n          })\r\n          .eq('user_id', user.id);\r\n      }\r\n\r\n      // Add to adaptation history\r\n      const adaptationEntry = {\r\n        recommendation,\r\n        appliedAt: new Date().toISOString(),\r\n        effectiveness\r\n      };\r\n      \r\n      setAdaptationHistory(prev => [adaptationEntry, ...prev]);\r\n\r\n      console.log(`âœ… Applied recommendation: ${recommendation.title}`);\r\n    } catch (error) {\r\n      console.error('Error applying recommendation:', error);\r\n    }\r\n  }, [user?.id, learningProfile, adaptationHistory]);\r\n\r\n  // Update learning profile based on real-time performance\r\n  const updateProfileFromPerformance = useCallback(async (performanceData: Record<string, any>) => {\r\n    if (!learningProfile || !user?.id) return;\r\n\r\n    const updatedProfile = { ...learningProfile };\r\n    \r\n    // Update based on performance indicators\r\n    if (performanceData.attentionScore < 60) {\r\n      updatedProfile.attentionSpan = Math.max(300, updatedProfile.attentionSpan - 30); // Reduce by 30s\r\n    } else if (performanceData.attentionScore > 80) {\r\n      updatedProfile.attentionSpan = Math.min(1800, updatedProfile.attentionSpan + 30); // Increase by 30s\r\n    }\r\n\r\n    if (performanceData.cognitiveLoad > 70) {\r\n      updatedProfile.optimalDifficulty = Math.max(1, updatedProfile.optimalDifficulty - 0.1);\r\n    } else if (performanceData.cognitiveLoad < 30) {\r\n      updatedProfile.optimalDifficulty = Math.min(10, updatedProfile.optimalDifficulty + 0.1);\r\n    }\r\n\r\n    // Update adaptations\r\n    updatedProfile.adaptations = {\r\n      ...updatedProfile.adaptations,\r\n      sessionLength: getOptimalSessionLength(updatedProfile.attentionSpan),\r\n      breakFrequency: getOptimalBreakFrequency(performanceData.cognitiveLoad)\r\n    };\r\n\r\n    setLearningProfile(updatedProfile);\r\n\r\n    // Store updated profile\r\n    await supabase\r\n      .from('adaptive_learning_paths')\r\n      .update({ learning_profile: updatedProfile as unknown as Json })\r\n      .eq('user_id', user.id);\r\n\r\n    console.log('ðŸ“Š Learning profile updated from performance data');\r\n  }, [learningProfile, user?.id]);\r\n\r\n  // Helper functions\r\n  const getDefaultProfile = (): LearningProfile => ({\r\n    preferredContentTypes: ['visual', 'interactive'],\r\n    optimalDifficulty: 5,\r\n    attentionSpan: 900, // 15 minutes\r\n    learningVelocity: 1.0,\r\n    strengths: [],\r\n    challenges: [],\r\n    adaptations: {\r\n      contentFormat: 'mixed',\r\n      sessionLength: 'medium',\r\n      difficultyProgression: 'gradual',\r\n      breakFrequency: 'regular'\r\n    }\r\n  });\r\n\r\n  const analyzeLearningStyles = (behavioral: Record<string, unknown>[]): string[] => {\r\n    const styleData = behavioral.filter(d => d.behavior_type === 'learning_style');\r\n    const preferences: Record<string, number> = {};\r\n    \r\n    styleData.forEach(d => {\r\n      const behaviorData = d.behavior_data as Record<string, unknown> | undefined;\r\n      const contentType = behaviorData?.contentType as string;\r\n      const preference = (behaviorData?.preferenceRating as number) || 0;\r\n      if (contentType) {\r\n        preferences[contentType] = (preferences[contentType] || 0) + preference;\r\n      }\r\n    });\r\n\r\n    return Object.entries(preferences)\r\n      .sort(([,a], [,b]) => b - a)\r\n      .slice(0, 3)\r\n      .map(([style]) => style);\r\n  };\r\n\r\n  const analyzeAttentionPatterns = (behavioral: Record<string, unknown>[], slides: Record<string, unknown>[]) => {\r\n    const attentionData = [\r\n      ...behavioral.filter(d => d.behavior_type === 'attention_pattern'),\r\n      ...slides.filter(d => d.event_type === 'view_end')\r\n    ];\r\n\r\n    if (attentionData.length === 0) return { average: 900, variance: 0 };\r\n\r\n    const durations = attentionData.map(d => {\r\n      const behaviorData = d.behavior_data as Record<string, unknown> | undefined;\r\n      return (behaviorData?.durationSeconds as number) || (d.duration_seconds as number) || 0;\r\n    });\r\n    const average = durations.reduce((a, b) => a + b, 0) / durations.length;\r\n    const variance = durations.reduce((sum, dur) => sum + Math.pow(dur - average, 2), 0) / durations.length;\r\n\r\n    return { average, variance };\r\n  };\r\n\r\n  const analyzeLearningVelocity = (progress: Record<string, unknown>[]) => {\r\n    if (progress.length === 0) return { average: 1.0 };\r\n\r\n    const velocities = progress.map(p => (p.learning_velocity as number) || 1.0);\r\n    const average = velocities.reduce((a, b) => a + b, 0) / velocities.length;\r\n\r\n    return { average };\r\n  };\r\n\r\n  const analyzeDifficultyPreferences = (progress: Record<string, unknown>[], slides: Record<string, unknown>[]) => {\r\n    // Analyze relationship between difficulty and performance\r\n    const combinedData = progress.map(p => {\r\n      const completionQuality = p.completion_quality as Record<string, unknown> | undefined;\r\n      return {\r\n        difficulty: (p.difficulty_perception as number) || 5,\r\n        performance: (completionQuality?.overallQuality as number) || 0.5\r\n      };\r\n    });\r\n\r\n    if (combinedData.length === 0) return { optimal: 5 };\r\n\r\n    // Find difficulty level with best performance\r\n    const difficultyGroups: Record<number, number[]> = {};\r\n    combinedData.forEach(d => {\r\n      const diffLevel = Math.round(d.difficulty);\r\n      if (!difficultyGroups[diffLevel]) difficultyGroups[diffLevel] = [];\r\n      difficultyGroups[diffLevel].push(d.performance);\r\n    });\r\n\r\n    let bestDifficulty = 5;\r\n    let bestPerformance = 0;\r\n\r\n    Object.entries(difficultyGroups).forEach(([diff, performances]) => {\r\n      const avgPerformance = performances.reduce((a, b) => a + b, 0) / performances.length;\r\n      if (avgPerformance > bestPerformance) {\r\n        bestPerformance = avgPerformance;\r\n        bestDifficulty = parseInt(diff);\r\n      }\r\n    });\r\n\r\n    return { optimal: bestDifficulty };\r\n  };\r\n\r\n  const identifyStrengthsAndChallenges = (progress: Record<string, unknown>[], behavioral: Record<string, unknown>[]) => {\r\n    const strengths: string[] = [];\r\n    const challenges: string[] = [];\r\n\r\n    // Analyze completion rates by content type\r\n    const completionRates: Record<string, number[]> = {};\r\n    progress.forEach(p => {\r\n      const metadata = p.metadata as Record<string, unknown> | undefined;\r\n      const contentType = (metadata?.contentType as string) || 'general';\r\n      if (!completionRates[contentType]) completionRates[contentType] = [];\r\n      completionRates[contentType].push(((p.progress_percentage as number) || 0) / 100);\r\n    });\r\n\r\n    Object.entries(completionRates).forEach(([contentType, rates]) => {\r\n      const avgRate = rates.reduce((a, b) => a + b, 0) / rates.length;\r\n      if (avgRate > 0.8) strengths.push(contentType);\r\n      if (avgRate < 0.5) challenges.push(contentType);\r\n    });\r\n\r\n    return { strengths, challenges };\r\n  };\r\n\r\n  const getBestContentFormat = (preferences: string[]): string => {\r\n    if (preferences.includes('visual') && preferences.includes('interactive')) return 'mixed_interactive';\r\n    if (preferences.includes('visual')) return 'visual_heavy';\r\n    if (preferences.includes('auditory')) return 'audio_enhanced';\r\n    return 'balanced';\r\n  };\r\n\r\n  const getOptimalSessionLength = (attentionSpan: number): string => {\r\n    if (attentionSpan < 600) return 'short'; // < 10 minutes\r\n    if (attentionSpan < 1200) return 'medium'; // < 20 minutes\r\n    return 'long'; // 20+ minutes\r\n  };\r\n\r\n  const getDifficultyProgression = (difficultyData: { optimal: number }): string => {\r\n    return difficultyData.optimal > 7 ? 'aggressive' : difficultyData.optimal < 4 ? 'gentle' : 'gradual';\r\n  };\r\n\r\n  const getOptimalBreakFrequency = (variance: number): string => {\r\n    if (variance > 200) return 'frequent'; // High variance suggests need for more breaks\r\n    if (variance < 50) return 'minimal'; // Low variance suggests sustained attention\r\n    return 'regular';\r\n  };\r\n\r\n  // Load learning profile on mount\r\n  useEffect(() => {\r\n    loadLearningProfile();\r\n  }, [loadLearningProfile]);\r\n\r\n  return {\r\n    learningProfile,\r\n    recommendations,\r\n    adaptationHistory,\r\n    loading,\r\n    generateRecommendations,\r\n    applyRecommendation,\r\n    updateProfileFromPerformance,\r\n    loadLearningProfile\r\n  };\r\n}\r\n\r\n// Helper functions for recommendation generation (would be expanded with AI logic)\r\nasync function getRecentPerformanceData() {\r\n  // Implementation would fetch recent performance metrics\r\n  return {};\r\n}\r\n\r\nasync function analyzeLearningState(recentData: Record<string, unknown>, context: Record<string, unknown>) {\r\n  // Implementation would analyze current learning state\r\n  return {};\r\n}\r\n\r\nasync function generateContextualRecommendations(\r\n  profile: LearningProfile, \r\n  state: Record<string, unknown>, \r\n  context: Record<string, unknown>\r\n): Promise<AdaptiveRecommendation[]> {\r\n  // Implementation would use AI to generate personalized recommendations\r\n  return [];\r\n}\r\n\r\nfunction updateProfileFromFeedback(\r\n  profile: LearningProfile, \r\n  recommendation: AdaptiveRecommendation, \r\n  effectiveness: number\r\n): LearningProfile {\r\n  // Implementation would update profile based on recommendation effectiveness\r\n  return profile;\r\n}\r\n\r\nfunction calculateEffectivenessScore(history: Array<{ effectiveness?: number }>): number {\r\n  if (history.length === 0) return 0;\r\n  \r\n  const totalEffectiveness = history\r\n    .filter(h => h.effectiveness)\r\n    .reduce((sum, h) => sum + h.effectiveness, 0);\r\n  \r\n  return totalEffectiveness / history.length;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAddPublicDomainBook.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAdminBookApproval.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAdminOrganizations.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1458,1461],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1458,1461],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport type { Organization } from '@/types/organization';\r\n\r\nconsole.log('ðŸ” useAdminOrganizations Hook - Loading');\r\n\r\n// Admin-specific hook to fetch ALL organizations in the system\r\nexport function useAdminOrganizations() {\r\n  const { user } = useAuth();\r\n\r\n  console.log('ðŸ” useAdminOrganizations Hook - User:', user);\r\n\r\n  const { data: organizations, isLoading, error } = useQuery({\r\n    queryKey: ['admin-organizations'],\r\n    queryFn: async (): Promise<Organization[]> => {\r\n      if (!user) return [];\r\n\r\n      console.log('ðŸ” Admin Organizations Hook - Fetching organizations for admin:', user.id);\r\n\r\n      // Fetch ALL organizations - admin policies will handle access control\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      console.log('ðŸ“Š Admin Organizations Query Result:', { data, error });\r\n\r\n      if (error) {\r\n        console.error('Error fetching admin organizations:', error);\r\n        throw error;\r\n      }\r\n\r\n      // Transform data to match our interface  \r\n      return data.map((org): Organization => ({\r\n        id: org.id,\r\n        name: org.name,\r\n        description: org.description || undefined,\r\n        owner_id: org.owner_id,\r\n        plan: org.plan as any, // Type assertion for database enum\r\n        seat_cap: org.seat_cap,\r\n        seats_used: org.seats_used || 0,\r\n        instructors_used: org.instructors_used || 0,\r\n        instructor_limit: org.instructor_limit || 5,\r\n        brand_primary: org.brand_primary,\r\n        brand_accent: org.brand_accent,\r\n        logo_url: org.logo_url,\r\n        slug: org.slug,\r\n        is_suspended: org.is_suspended,\r\n        suspended_at: org.suspended_at,\r\n        suspended_by: org.suspended_by,\r\n        suspended_reason: org.suspended_reason,\r\n        status: (org.status as 'active' | 'suspended' | 'deleted') || 'active',\r\n        created_by: org.created_by,\r\n        created_at: org.created_at,\r\n        updated_at: org.updated_at,\r\n      }));\r\n    },\r\n    enabled: !!user,\r\n  });\r\n\r\n  return {\r\n    organizations: organizations || [],\r\n    isLoading,\r\n    error,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAdvancedAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAnalyticsCards.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAnalyticsEventBus.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'eventTypes' and 'subscribe'. Either include them or remove the dependency array.","line":120,"column":6,"nodeType":"ArrayExpression","endLine":120,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [eventTypes, subscribe]","fix":{"range":[3802,3824],"text":"[eventTypes, subscribe]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":120,"column":7,"nodeType":"CallExpression","endLine":120,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useEffect, useRef } from 'react';\r\nimport { analyticsEventBus, AnalyticsEvent, EventSubscriber, ANALYTICS_EVENTS } from '@/services/AnalyticsEventBus';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\nexport const useAnalyticsEventBus = () => {\r\n  const { user } = useAuth();\r\n\r\n  const publishEvent = async (eventType: string, metadata: Record<string, unknown>, source = 'web') => {\r\n    if (!user?.id) return;\r\n\r\n    await analyticsEventBus.publish({\r\n      userId: user.id,\r\n      eventType,\r\n      metadata,\r\n      source,\r\n      sessionId: crypto.randomUUID()\r\n    });\r\n  };\r\n\r\n  const subscribe = (eventTypes: string[], callback: (event: AnalyticsEvent) => void) => {\r\n    const subscriber: EventSubscriber = {\r\n      id: crypto.randomUUID(),\r\n      eventTypes,\r\n      callback\r\n    };\r\n\r\n    return analyticsEventBus.subscribe(subscriber);\r\n  };\r\n\r\n  const getEventHistory = () => {\r\n    return analyticsEventBus.getEventHistory();\r\n  };\r\n\r\n  const getEventsByType = (eventType: string, limit?: number) => {\r\n    return analyticsEventBus.getEventsByType(eventType, limit);\r\n  };\r\n\r\n  const getTimeSeriesData = async (metricName: string, timeRange?: string) => {\r\n    return analyticsEventBus.getTimeSeriesData(metricName, timeRange);\r\n  };\r\n\r\n  return {\r\n    publishEvent,\r\n    subscribe,\r\n    getEventHistory,\r\n    getEventsByType,\r\n    getTimeSeriesData,\r\n    EVENTS: ANALYTICS_EVENTS\r\n  };\r\n};\r\n\r\n// Hook for specific event publishing with enhanced capabilities\r\nexport const useAnalyticsPublisher = () => {\r\n  const { publishEvent, EVENTS } = useAnalyticsEventBus();\r\n\r\n  const publishReadingSessionStart = (bookId: string, metadata = {}) => {\r\n    publishEvent(EVENTS.READING_SESSION_START, { bookId, ...metadata });\r\n  };\r\n\r\n  const publishReadingSessionEnd = (bookId: string, duration: number, metadata = {}) => {\r\n    publishEvent(EVENTS.READING_SESSION_END, { bookId, duration, ...metadata });\r\n  };\r\n\r\n  const publishStudySessionComplete = (sessionType: string, performance: Record<string, unknown>, metadata = {}) => {\r\n    publishEvent(EVENTS.STUDY_SESSION_COMPLETE, { sessionType, performance, ...metadata });\r\n  };\r\n\r\n  const publishXPEarned = (amount: number, source: string, metadata = {}) => {\r\n    publishEvent(EVENTS.XP_EARNED, { amount, source, ...metadata });\r\n  };\r\n\r\n  const publishGoalCompleted = (goalId: string, metadata = {}) => {\r\n    publishEvent(EVENTS.GOAL_COMPLETED, { goalId, ...metadata });\r\n  };\r\n\r\n  const publishFlashcardReviewed = (cardId: string, correct: boolean, metadata = {}) => {\r\n    publishEvent(EVENTS.FLASHCARD_REVIEWED, { cardId, correct, ...metadata });\r\n  };\r\n\r\n  const publishStreakUpdated = (streakType: string, count: number, metadata = {}) => {\r\n    publishEvent(EVENTS.STREAK_UPDATED, { streakType, count, ...metadata });\r\n  };\r\n\r\n  return {\r\n    publishReadingSessionStart,\r\n    publishReadingSessionEnd,\r\n    publishStudySessionComplete,\r\n    publishXPEarned,\r\n    publishGoalCompleted,\r\n    publishFlashcardReviewed,\r\n    publishStreakUpdated,\r\n    publishEvent\r\n  };\r\n};\r\n\r\n// Hook for real-time analytics updates with time-series support\r\nexport const useRealtimeAnalytics = (eventTypes: string[] = ['*']) => {\r\n  const { subscribe, getTimeSeriesData } = useAnalyticsEventBus();\r\n  const unsubscribeRef = useRef<(() => void) | null>(null);\r\n\r\n  useEffect(() => {\r\n    const callback = (event: AnalyticsEvent) => {\r\n      // Dispatch custom event for components to listen to\r\n      window.dispatchEvent(new CustomEvent('analytics-event', { \r\n        detail: { \r\n          ...event, \r\n          isRealtime: true \r\n        } \r\n      }));\r\n    };\r\n\r\n    unsubscribeRef.current = subscribe(eventTypes, callback);\r\n\r\n    return () => {\r\n      if (unsubscribeRef.current) {\r\n        unsubscribeRef.current();\r\n      }\r\n    };\r\n  }, [eventTypes.join(',')]);\r\n\r\n  const useEventListener = (callback: (event: AnalyticsEvent & { isRealtime?: boolean }) => void) => {\r\n    useEffect(() => {\r\n      const handler = (event: CustomEvent) => {\r\n        callback(event.detail);\r\n      };\r\n\r\n      window.addEventListener('analytics-event', handler as EventListener);\r\n      return () => window.removeEventListener('analytics-event', handler as EventListener);\r\n    }, [callback]);\r\n  };\r\n\r\n  const useTimeSeriesMetrics = (metricName: string, timeRange = '24h') => {\r\n    return getTimeSeriesData(metricName, timeRange);\r\n  };\r\n\r\n  return { \r\n    useEventListener, \r\n    useTimeSeriesMetrics \r\n  };\r\n};\r\n\r\n// Hook for anomaly detection and alerting\r\nexport const useAnomalyDetection = () => {\r\n  const { subscribe } = useAnalyticsEventBus();\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = subscribe(['*'], (event) => {\r\n      // The AI Insights Engine handles anomaly detection automatically\r\n      // This hook can be used to add custom client-side anomaly detection logic\r\n      console.log('ðŸ” Event processed for anomaly detection:', event.eventType);\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [subscribe]);\r\n\r\n  return {\r\n    // Placeholder for future client-side anomaly detection methods\r\n    isMonitoring: true\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAppUser.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAuditLog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[792,795],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[792,795],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[847,850],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[847,850],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\nexport interface AuditEvent {\r\n  action: 'create' | 'read' | 'update' | 'delete' | 'export' | 'access';\r\n  tableName: string;\r\n  recordId?: string;\r\n  oldValues?: Record<string, unknown> | null;\r\n  newValues?: Record<string, unknown> | null;\r\n  legalBasis?: string;\r\n  purpose?: string;\r\n}\r\n\r\nexport function useAuditLog() {\r\n  const { user } = useAuth();\r\n\r\n  const logEvent = async (event: AuditEvent) => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      await supabase.rpc('record_audit_event', {\r\n        p_user_id: user.id,\r\n        p_action: event.action,\r\n        p_table_name: event.tableName,\r\n        p_record_id: event.recordId || null,\r\n        p_old_values: event.oldValues as any || null,\r\n        p_new_values: event.newValues as any || null,\r\n        p_legal_basis: event.legalBasis || null,\r\n        p_purpose: event.purpose || null,\r\n      });\r\n    } catch (error) {\r\n      console.error('Error logging audit event:', error);\r\n    }\r\n  };\r\n\r\n  const logDataAccess = async (tableName: string, recordId?: string, purpose?: string) => {\r\n    await logEvent({\r\n      action: 'read',\r\n      tableName,\r\n      recordId,\r\n      purpose: purpose || `User accessed ${tableName} data`,\r\n      legalBasis: 'legitimate_interest',\r\n    });\r\n  };\r\n\r\n  const logDataExport = async (dataTypes: string[], recordCount: number) => {\r\n    await logEvent({\r\n      action: 'export',\r\n      tableName: 'user_data_export',\r\n      newValues: {\r\n        exported_data_types: dataTypes,\r\n        record_count: recordCount,\r\n        export_format: 'JSON',\r\n      },\r\n      purpose: 'User requested data export (GDPR Article 20)',\r\n      legalBasis: 'legal_obligation',\r\n    });\r\n  };\r\n\r\n  const logDataDeletion = async (tableName: string, recordId: string, reason: string) => {\r\n    await logEvent({\r\n      action: 'delete',\r\n      tableName,\r\n      recordId,\r\n      purpose: reason,\r\n      legalBasis: reason.includes('GDPR') ? 'legal_obligation' : 'contract',\r\n    });\r\n  };\r\n\r\n  const getUserAuditLogs = async (limit: number = 100) => {\r\n    if (!user) return { data: null, error: 'User not authenticated' };\r\n\r\n    const { data, error } = await supabase\r\n      .from('audit_log')\r\n      .select('*')\r\n      .eq('user_id', user.id)\r\n      .order('timestamp', { ascending: false })\r\n      .limit(limit);\r\n\r\n    return { data, error };\r\n  };\r\n\r\n  return {\r\n    logEvent,\r\n    logDataAccess,\r\n    logDataExport,\r\n    logDataDeletion,\r\n    getUserAuditLogs,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAuth.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":69,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":69,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect, createContext, useContext } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport type { User, Session } from '@supabase/supabase-js';\r\nimport { logger } from '@/utils/logger';\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  session: Session | null;\r\n  loading: boolean;\r\n  signOut: () => Promise<void>;\r\n}\r\n\r\ninterface AuthProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [session, setSession] = useState<Session | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    console.log('useAuth: Setting up authentication listeners');\r\n    console.log('useAuth: Current domain:', window.location.hostname);\r\n    \r\n    // Set up auth state listener\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\r\n      (event, session) => {\r\n        console.log('useAuth: Auth state changed', { event, hasSession: !!session, hasUser: !!session?.user });\r\n        logger.auth('Auth state changed', { event, hasSession: !!session, hasUser: !!session?.user });\r\n        setSession(session);\r\n        setUser(session?.user ?? null);\r\n        setLoading(false);\r\n      }\r\n    );\r\n\r\n    // Get initial session\r\n    console.log('useAuth: Getting initial session...');\r\n    supabase.auth.getSession().then(({ data: { session }, error }) => {\r\n      console.log('useAuth: Initial session result', { hasSession: !!session, error });\r\n      setSession(session);\r\n      setUser(session?.user ?? null);\r\n      setLoading(false);\r\n    }).catch((err) => {\r\n      console.error('useAuth: Error getting initial session:', err);\r\n      setLoading(false); // Still set loading to false even on error\r\n    });\r\n\r\n    return () => {\r\n      console.log('useAuth: Cleaning up auth listeners');\r\n      subscription.unsubscribe();\r\n    };\r\n  }, []);\r\n\r\n  const signOut = async () => {\r\n    await supabase.auth.signOut();\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, session, loading, signOut }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useAutoEnrollPreloadedCourses.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useBatchProcessing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useBehavioralAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useBookDetails.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useBookQuiz.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useChallengeAnalytics.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'toast'. Either include it or remove the dependency array.","line":116,"column":6,"nodeType":"ArrayExpression","endLine":116,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [user?.id, awardChallengeCompletionXP, toast]","fix":{"range":[3578,3616],"text":"[user?.id, awardChallengeCompletionXP, toast]"}}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":137,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":137,"endColumn":77,"suggestions":[{"messageId":"addBrackets","fix":{"range":[4063,4299],"text":"{ const accuracy = cardCount > 0 ? (correctCount / cardCount) * 100 : 0;\r\n      if (accuracy >= 80) {\r\n        return 20 * cardCount;\r\n      } else {\r\n        return Math.max(correctCount * 5, 10); // Minimum 10 XP for attempting\r\n      } }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":146,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":146,"endColumn":39,"suggestions":[{"messageId":"addBrackets","fix":{"range":[4415,4598],"text":"{ let speedXP = correctCount * 15;\r\n      if (correctCount === cardCount && cardCount > 0) {\r\n        speedXP += 50; // Perfect score bonus\r\n      }\r\n      return Math.max(speedXP, 10); }"},"desc":"Add {} brackets around the case block."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useCallback } from 'react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useXPIntegration } from '@/hooks/useXPIntegration';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface ChallengeStartEvent {\r\n  challengeType: 'quick_review' | 'accuracy_challenge' | 'speed_test' | 'custom_practice';\r\n  mode: 'random' | 'custom';\r\n  cardCount: number;\r\n  timestamp: string;\r\n}\r\n\r\ninterface ChallengeCompleteEvent extends ChallengeStartEvent {\r\n  correctCount: number;\r\n  timeTakenSec: number;\r\n}\r\n\r\ninterface XPAwardedEvent {\r\n  challengeType: string;\r\n  xpAmount: number;\r\n  reason: string;\r\n  timestamp: string;\r\n}\r\n\r\nexport function useChallengeAnalytics() {\r\n  const { user } = useAuth();\r\n  const { awardChallengeCompletionXP } = useXPIntegration();\r\n  const { toast } = useToast();\r\n\r\n  const trackChallengeStart = useCallback(async (\r\n    challengeType: ChallengeStartEvent['challengeType'],\r\n    mode: 'random' | 'custom',\r\n    cardCount: number\r\n  ) => {\r\n    if (!user?.id) return;\r\n\r\n    const event: ChallengeStartEvent = {\r\n      challengeType,\r\n      mode,\r\n      cardCount,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    console.log('ðŸ“Š Challenge Started:', event);\r\n\r\n    // Feature implementation: Send to analytics pipeline (Supabase edge function)\r\n    // For now, we'll log the event and could extend this to send to our analytics system\r\n    try {\r\n      // This could be extended to send to a dedicated analytics edge function\r\n      console.log('Analytics Event - challenge_start:', event);\r\n    } catch (error) {\r\n      console.error('Failed to track challenge start:', error);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const trackChallengeComplete = useCallback(async (\r\n    challengeType: ChallengeCompleteEvent['challengeType'],\r\n    mode: 'random' | 'custom',\r\n    cardCount: number,\r\n    correctCount: number,\r\n    timeTakenSec: number,\r\n    startTime?: number\r\n  ) => {\r\n    if (!user?.id) return;\r\n\r\n    const actualTimeTaken = startTime ? Math.floor((Date.now() - startTime) / 1000) : timeTakenSec;\r\n\r\n    const event: ChallengeCompleteEvent = {\r\n      challengeType,\r\n      mode,\r\n      cardCount,\r\n      correctCount,\r\n      timeTakenSec: actualTimeTaken,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    console.log('ðŸ“Š Challenge Completed:', event);\r\n\r\n    // Calculate XP based on challenge type and performance\r\n    const xpAmount = calculateChallengeXP(challengeType, cardCount, correctCount, actualTimeTaken);\r\n    \r\n    try {\r\n      // Award XP through existing system\r\n      await awardChallengeCompletionXP(challengeType, xpAmount);\r\n\r\n      // Track XP awarded event\r\n      const xpEvent: XPAwardedEvent = {\r\n        challengeType,\r\n        xpAmount,\r\n        reason: `Completed ${challengeType.replace('_', ' ')} challenge`,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n\r\n      console.log('ðŸ“Š XP Awarded:', xpEvent);\r\n\r\n      // Show success toast to user\r\n      toast({\r\n        title: `ðŸŽ‰ Challenge Complete!`,\r\n        description: `You earned ${xpAmount} XP for completing the ${challengeType.replace('_', ' ')} challenge!`,\r\n        duration: 4000,\r\n      });\r\n\r\n      // Track completion event\r\n      console.log('Analytics Event - challenge_complete:', event);\r\n      console.log('Analytics Event - xp_awarded:', xpEvent);\r\n\r\n    } catch (error) {\r\n      console.error('Failed to award XP for challenge completion:', error);\r\n      toast({\r\n        title: \"Challenge Complete\",\r\n        description: \"Challenge completed successfully!\",\r\n        duration: 3000,\r\n      });\r\n    }\r\n  }, [user?.id, awardChallengeCompletionXP]);\r\n\r\n  return {\r\n    trackChallengeStart,\r\n    trackChallengeComplete\r\n  };\r\n}\r\n\r\nfunction calculateChallengeXP(\r\n  challengeType: string,\r\n  cardCount: number,\r\n  correctCount: number,\r\n  timeTakenSec: number\r\n): number {\r\n  switch (challengeType) {\r\n    case 'quick_review':\r\n      // +10 XP per card reviewed\r\n      return cardCount * 10;\r\n      \r\n    case 'accuracy_challenge':\r\n      // +20 XP if â‰¥80% correct, else +5 XP per correct\r\n      const accuracy = cardCount > 0 ? (correctCount / cardCount) * 100 : 0;\r\n      if (accuracy >= 80) {\r\n        return 20 * cardCount;\r\n      } else {\r\n        return Math.max(correctCount * 5, 10); // Minimum 10 XP for attempting\r\n      }\r\n      \r\n    case 'speed_test':\r\n      // +15 XP per card answered within time limit, bonus +50 XP for 100%\r\n      let speedXP = correctCount * 15;\r\n      if (correctCount === cardCount && cardCount > 0) {\r\n        speedXP += 50; // Perfect score bonus\r\n      }\r\n      return Math.max(speedXP, 10);\r\n      \r\n    case 'custom_practice':\r\n      // +10 XP per card, +10 XP bonus for custom selection effort\r\n      return (cardCount * 10) + 10;\r\n      \r\n    default:\r\n      return Math.max(cardCount * 5, 10); // Fallback\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useChatMessages.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadMessages'. Either include it or remove the dependency array.","line":262,"column":6,"nodeType":"ArrayExpression","endLine":262,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [loadMessages, sessionId]","fix":{"range":[9259,9270],"text":"[loadMessages, sessionId]"}}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\+.","line":279,"column":34,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":279,"endColumn":35,"suggestions":[{"messageId":"removeEscape","fix":{"range":[9699,9700],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[9699,9699],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\*.","line":279,"column":38,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":279,"endColumn":39,"suggestions":[{"messageId":"removeEscape","fix":{"range":[9703,9704],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[9703,9703],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":279,"column":40,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":279,"endColumn":41,"suggestions":[{"messageId":"removeEscape","fix":{"range":[9705,9706],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[9705,9705],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\+.","line":280,"column":48,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":280,"endColumn":49,"suggestions":[{"messageId":"removeEscape","fix":{"range":[9768,9769],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[9768,9768],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\*.","line":280,"column":52,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":280,"endColumn":53,"suggestions":[{"messageId":"removeEscape","fix":{"range":[9772,9773],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[9772,9772],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":280,"column":54,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":280,"endColumn":55,"suggestions":[{"messageId":"removeEscape","fix":{"range":[9774,9775],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[9774,9774],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useConversationState } from '@/hooks/useConversationState';\r\n\r\ninterface ChatMessage {\r\n  id: string;\r\n  session_id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\nexport const useChatMessages = (sessionId: string | null) => {\r\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSending, setIsSending] = useState(false);\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const { analyzeConversation } = useConversationState();\r\n\r\n  // Load messages for a session\r\n  const loadMessages = async () => {\r\n    // Critical validation: ensure we have valid UUIDs before database queries\r\n    if (!sessionId || !user?.id || typeof sessionId !== 'string' || typeof user.id !== 'string') {\r\n      console.warn('Invalid parameters for loadMessages:', { sessionId, userId: user?.id });\r\n      setMessages([]);\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('chat_messages')\r\n        .select('*')\r\n        .eq('session_id', sessionId)\r\n        .order('timestamp', { ascending: true });\r\n\r\n      if (error) throw error;\r\n      \r\n      // Type-safe conversion with proper role casting\r\n      const typedMessages: ChatMessage[] = (data || []).map(msg => ({\r\n        id: msg.id,\r\n        session_id: msg.session_id,\r\n        role: msg.role as 'user' | 'assistant',\r\n        content: msg.content,\r\n        timestamp: msg.timestamp\r\n      }));\r\n      \r\n      setMessages(typedMessages);\r\n    } catch (error) {\r\n      console.error('Error loading messages:', error);\r\n      toast({\r\n        title: \"Error loading messages\",\r\n        description: \"There was a problem loading the chat messages.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Add a message to the current session\r\n  const addMessage = async (content: string, role: 'user' | 'assistant') => {\r\n    // Critical validation: ensure we have valid UUIDs before database operations\r\n    if (!sessionId || !user?.id || typeof sessionId !== 'string' || typeof user.id !== 'string') {\r\n      console.warn('Invalid parameters for addMessage:', { sessionId, userId: user?.id });\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('chat_messages')\r\n        .insert({\r\n          session_id: sessionId,\r\n          role,\r\n          content,\r\n          timestamp: new Date().toISOString()\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Type-safe message addition\r\n      const newMessage: ChatMessage = {\r\n        id: data.id,\r\n        session_id: data.session_id,\r\n        role: data.role as 'user' | 'assistant',\r\n        content: data.content,\r\n        timestamp: data.timestamp\r\n      };\r\n\r\n      setMessages(prev => [...prev, newMessage]);\r\n      return newMessage;\r\n    } catch (error) {\r\n      console.error('Error adding message:', error);\r\n      toast({\r\n        title: \"Error sending message\",\r\n        description: \"There was a problem sending your message.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // Simplified hybrid sendMessage with backend-driven intelligence\r\n  const sendMessage = async (content: string, context?: string, chatMode: 'personal' | 'general' = 'general') => {\r\n    if (!user?.id || isSending || typeof user.id !== 'string') {\r\n      throw new Error('Invalid user state');\r\n    }\r\n    \r\n    if (!sessionId || typeof sessionId !== 'string') {\r\n      throw new Error('No active session. Please refresh the page.');\r\n    }\r\n\r\n    setIsSending(true);\r\n    \r\n    try {\r\n      // Add user message first\r\n      const userMessage = await addMessage(content, 'user');\r\n      if (!userMessage) {\r\n        throw new Error('Failed to save user message');\r\n      }\r\n\r\n      // Backend conversation analysis - moved from AI layer\r\n      const conversationHistory = messages.map(msg => ({\r\n        role: msg.role,\r\n        content: msg.content,\r\n        timestamp: msg.timestamp\r\n      }));\r\n\r\n      let conversationState;\r\n      try {\r\n        conversationState = analyzeConversation(conversationHistory, content);\r\n      } catch (error) {\r\n        // Fallback to default state\r\n        conversationState = {\r\n          promptType: 'general_guidance',\r\n          isInQuiz: false,\r\n          inRefresherMode: false,\r\n          lastAIQuestion: null,\r\n          currentTopic: null,\r\n          incorrectAnswersCount: 0,\r\n          teachingMethods: []\r\n        };\r\n      }\r\n      \r\n      // Prepare simple context data for Edge Function\r\n      const contextData: Record<string, unknown> = {};\r\n      \r\n      if (conversationState.promptType === 'initiate_quiz' && conversationState.currentTopic) {\r\n        contextData.quizTopic = conversationState.currentTopic;\r\n      }\r\n      \r\n      if (conversationState.promptType === 'evaluate_answer') {\r\n        contextData.teachingHistory = conversationState.teachingMethods?.join(', ') || '';\r\n        contextData.incorrectCount = conversationState.incorrectAnswersCount;\r\n      }\r\n\r\n      // Call simplified AI function with backend-determined prompt type\r\n      const { data, error } = await supabase.functions.invoke('ai-study-chat', {\r\n        body: { \r\n          message: content,\r\n          userId: user.id,\r\n          sessionId: sessionId,\r\n          promptType: conversationState.promptType,\r\n          contextData: contextData,\r\n          chatMode: chatMode,\r\n          voiceActive: false\r\n        }\r\n      });\r\n\r\n      if (error) {\r\n        console.error('ðŸš¨ Hybrid AI function error:', error);\r\n        throw error;\r\n      }\r\n\r\n      console.log('âœ… Hybrid response received:', {\r\n        promptType: conversationState.promptType,\r\n        hasResponse: !!data?.response,\r\n        source: data?.source,\r\n        error: data?.error\r\n      });\r\n\r\n      // Better error handling and contextual responses\r\n      if (!data?.response) {\r\n        console.error('ðŸš¨ No response from AI function:', data);\r\n        \r\n        // Show specific error information to help diagnose the issue\r\n        if (data?.error) {\r\n          console.error('ðŸš¨ Edge Function Error Details:', data.error);\r\n          \r\n          // If it's an API authentication error, show helpful message\r\n          if (data.error.includes('401') || data.error.includes('authentication_error')) {\r\n            const errorMsg = 'The AI service is experiencing authentication issues. The response has been generated using fallback methods.';\r\n            console.log('ðŸ”„ Using fallback response due to API auth issue');\r\n            \r\n            // Use the fallback response from the Edge Function\r\n            const fallbackResponse = data?.response || getContextualErrorResponse(content, chatMode, new Error('API authentication issue'));\r\n            await addMessage(fallbackResponse, 'assistant');\r\n            return;\r\n          }\r\n        }\r\n        \r\n        throw new Error(`AI service error: ${data?.error || 'No response received'}`);\r\n      }\r\n\r\n      const aiResponse = data.response;\r\n      \r\n      // Add AI response\r\n      const assistantMessage = await addMessage(aiResponse, 'assistant');\r\n      if (!assistantMessage) {\r\n        throw new Error('Failed to save AI response');\r\n      }\r\n\r\n      // Update session metadata on first message\r\n      if (messages.length <= 1) {\r\n        const title = content.length > 40 ? content.substring(0, 40) + '...' : content;\r\n        const contextTag = context?.includes('Notes') ? 'Study Notes' : \r\n                         context?.includes('Coach') ? 'AI Coaching' : \r\n                         context?.includes('Flashcard') ? 'Flashcard Help' : \r\n                         content.toLowerCase().includes('quiz') ? 'Quiz Help' :\r\n                         chatMode === 'personal' ? 'Socratic Learning Session' : 'General Knowledge Exploration';\r\n                         \r\n        await supabase\r\n          .from('chat_sessions')\r\n          .update({ \r\n            title, \r\n            updated_at: new Date().toISOString(),\r\n            context_tag: contextTag\r\n          })\r\n          .eq('id', sessionId);\r\n      }\r\n\r\n      toast({\r\n        title: \"ðŸŽ¯ Hybrid AI Active\",\r\n        description: `Using ${conversationState.promptType.replace('_', ' ')} approach`,\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('âŒ Error in hybrid sendMessage:', error);\r\n      \r\n      // Provide a contextual error response that acknowledges what the user asked\r\n      const contextualFallback = getContextualErrorResponse(content, chatMode, error);\r\n      \r\n      await addMessage(contextualFallback, 'assistant');\r\n      \r\n      toast({\r\n        title: \"âš ï¸ Connection Issue\",\r\n        description: `There's a technical problem, but I tried to help with \"${content.substring(0, 30)}...\"`,\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadMessages();\r\n  }, [sessionId]);\r\n\r\n  return {\r\n    messages,\r\n    isLoading,\r\n    isSending,\r\n    sendMessage,\r\n    addMessage,\r\n    loadMessages\r\n  };\r\n};\r\n\r\n// Helper function to provide contextual error responses\r\nfunction getContextualErrorResponse(message: string, chatMode: string, error: Error): string {\r\n  const lowerMessage = message.toLowerCase();\r\n  \r\n  // Math questions - provide the answer even if AI is down\r\n  if (lowerMessage.match(/\\d+\\s*[\\+\\-\\*\\/]\\s*\\d+/)) {\r\n    const mathMatch = message.match(/(\\d+)\\s*([\\+\\-\\*\\/])\\s*(\\d+)/);\r\n    if (mathMatch) {\r\n      const [, num1, op, num2] = mathMatch;\r\n      const a = parseInt(num1), b = parseInt(num2);\r\n      let result;\r\n      switch(op) {\r\n        case '+': result = a + b; break;\r\n        case '-': result = a - b; break;\r\n        case '*': result = a * b; break;\r\n        case '/': result = b !== 0 ? a / b : 'undefined (cannot divide by zero)'; break;\r\n      }\r\n      \r\n      return `I can still help with your math question! ${num1} ${op} ${num2} = ${result} ðŸ§®\\n\\nI'm having technical difficulties with my full AI capabilities, but I wanted to make sure you got an answer to your calculation. Once I'm back online, I can guide you through more complex mathematical concepts!`;\r\n    }\r\n  }\r\n  \r\n  // Extract key topics from the message\r\n  const topics = [];\r\n  if (lowerMessage.includes('cloud')) topics.push('clouds');\r\n  if (lowerMessage.includes('weather')) topics.push('weather');\r\n  if (lowerMessage.includes('science')) topics.push('science');\r\n  if (lowerMessage.includes('math')) topics.push('mathematics');\r\n  if (lowerMessage.includes('history')) topics.push('history');\r\n  \r\n  const topicText = topics.length > 0 ? topics.join(', ') : 'this topic';\r\n  \r\n  if (chatMode === 'personal') {\r\n    return `I apologize - I'm experiencing technical difficulties and can't provide my full Socratic guidance right now. But I noticed you're interested in ${topicText}! \r\n\r\nWhile I work on reconnecting, here's what I'd normally ask you: What do you already know about ${topicText}? What specific aspect makes you curious? \r\n\r\nError details: ${error.message || 'Connection issue'}`;\r\n  } else {\r\n    return `I'm having technical difficulties but I see you're asking about ${topicText}. Let me try to help while I resolve the connection issue.\r\n\r\nWhat specific aspect of ${topicText} would you like to explore? I'll do my best to assist even with limited capabilities.\r\n\r\nTechnical details: ${error.message || 'Service temporarily unavailable'}`;\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useChatMode.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useChatSessions.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSessions'. Either include it or remove the dependency array.","line":135,"column":6,"nodeType":"ArrayExpression","endLine":135,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [loadSessions, user]","fix":{"range":[3709,3715],"text":"[loadSessions, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface ChatSession {\r\n  id: string;\r\n  user_id: string;\r\n  title: string;\r\n  context_tag: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport const useChatSessions = () => {\r\n  const [sessions, setSessions] = useState<ChatSession[]>([]);\r\n  const [currentSessionId, setCurrentSessionId] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n\r\n  // Load all sessions for the user\r\n  const loadSessions = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('chat_sessions')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('updated_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      setSessions(data || []);\r\n    } catch (error) {\r\n      console.error('Error loading sessions:', error);\r\n      toast({\r\n        title: \"Error loading sessions\",\r\n        description: \"There was a problem loading your chat sessions.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Create a new session\r\n  const createSession = async (contextTag: string = 'Study Coach') => {\r\n    if (!user) return null;\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('chat_sessions')\r\n        .insert({\r\n          user_id: user.id,\r\n          title: 'New Chat',\r\n          context_tag: contextTag\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      setSessions(prev => [data, ...prev]);\r\n      setCurrentSessionId(data.id);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error creating session:', error);\r\n      toast({\r\n        title: \"Error creating session\",\r\n        description: \"There was a problem creating a new chat session.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // Update session title\r\n  const updateSessionTitle = async (sessionId: string, title: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('chat_sessions')\r\n        .update({ title, updated_at: new Date().toISOString() })\r\n        .eq('id', sessionId);\r\n\r\n      if (error) throw error;\r\n\r\n      setSessions(prev => \r\n        prev.map(session => \r\n          session.id === sessionId \r\n            ? { ...session, title, updated_at: new Date().toISOString() }\r\n            : session\r\n        )\r\n      );\r\n    } catch (error) {\r\n      console.error('Error updating session title:', error);\r\n    }\r\n  };\r\n\r\n  // Delete a session\r\n  const deleteSession = async (sessionId: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('chat_sessions')\r\n        .delete()\r\n        .eq('id', sessionId);\r\n\r\n      if (error) throw error;\r\n\r\n      setSessions(prev => prev.filter(session => session.id !== sessionId));\r\n      \r\n      if (currentSessionId === sessionId) {\r\n        setCurrentSessionId(sessions.length > 1 ? sessions[0].id : null);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting session:', error);\r\n      toast({\r\n        title: \"Error deleting session\",\r\n        description: \"There was a problem deleting the chat session.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  // Switch to a different session\r\n  const switchToSession = (sessionId: string) => {\r\n    setCurrentSessionId(sessionId);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadSessions();\r\n    }\r\n  }, [user]);\r\n\r\n  return {\r\n    sessions,\r\n    currentSessionId,\r\n    isLoading,\r\n    createSession,\r\n    updateSessionTitle,\r\n    deleteSession,\r\n    switchToSession,\r\n    loadSessions\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useChatTopics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useCleanupDebugUI.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'options.removeDebugAttributes'. Either include it or remove the dependency array.","line":94,"column":6,"nodeType":"ArrayExpression","endLine":94,"endColumn":87,"suggestions":[{"desc":"Update the dependencies array to be: [removeDebugAttributes, removeTestIds, removeConsoleOutputs, hideDevOnlyElements, options.removeDebugAttributes]","fix":{"range":[2951,3032],"text":"[removeDebugAttributes, removeTestIds, removeConsoleOutputs, hideDevOnlyElements, options.removeDebugAttributes]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Debug UI Cleanup Hook\r\n * Removes debug elements and developer-only UI in production\r\n */\r\n\r\nimport { useEffect } from 'react';\r\nimport { logger } from '@/utils/logger';\r\n\r\ninterface DebugCleanupOptions {\r\n  removeDebugAttributes?: boolean;\r\n  removeTestIds?: boolean;\r\n  removeConsoleOutputs?: boolean;\r\n  hideDevOnlyElements?: boolean;\r\n}\r\n\r\nexport const useCleanupDebugUI = (options: DebugCleanupOptions = {}) => {\r\n  const {\r\n    removeDebugAttributes = true,\r\n    removeTestIds = true,\r\n    removeConsoleOutputs = false,\r\n    hideDevOnlyElements = true\r\n  } = options;\r\n\r\n  useEffect(() => {\r\n    // Only run cleanup in production or when explicitly requested\r\n    if (process.env.NODE_ENV !== 'production' && !options.removeDebugAttributes) {\r\n      return;\r\n    }\r\n\r\n    const cleanupTasks: Array<() => void> = [];\r\n\r\n    // Remove debug attributes\r\n    if (removeDebugAttributes) {\r\n      const elementsWithDebugAttrs = document.querySelectorAll('[data-debug], [debug], [data-dev]');\r\n      elementsWithDebugAttrs.forEach(el => {\r\n        el.removeAttribute('data-debug');\r\n        el.removeAttribute('debug');\r\n        el.removeAttribute('data-dev');\r\n      });\r\n    }\r\n\r\n    // Remove test IDs in production\r\n    if (removeTestIds) {\r\n      const elementsWithTestIds = document.querySelectorAll('[data-testid]');\r\n      elementsWithTestIds.forEach(el => {\r\n        el.removeAttribute('data-testid');\r\n      });\r\n    }\r\n\r\n    // Hide dev-only elements\r\n    if (hideDevOnlyElements) {\r\n      const devOnlyElements = document.querySelectorAll('.dev-only, [data-dev-only]');\r\n      devOnlyElements.forEach(el => {\r\n        (el as HTMLElement).style.display = 'none';\r\n      });\r\n    }\r\n\r\n    // Note: Console override removed in favor of centralized logging system\r\n    // All logging should now use the logger utility which handles environment filtering\r\n    if (removeConsoleOutputs) {\r\n      logger.debug('Console cleanup requested - using centralized logging system instead', 'DEBUG_CLEANUP');\r\n    }\r\n\r\n    // Remove debug text content\r\n    const debugTextElements = document.querySelectorAll('*');\r\n    debugTextElements.forEach(el => {\r\n      if (el.textContent) {\r\n        // Remove common debug phrases\r\n        const debugPhrases = [\r\n          'Allow multiple content types',\r\n          '[DEBUG]',\r\n          '[DEV]',\r\n          'Test content',\r\n          'Lorem ipsum dolor sit amet' // Remove placeholder text\r\n        ];\r\n        \r\n        let textContent = el.textContent;\r\n        debugPhrases.forEach(phrase => {\r\n          if (textContent.includes(phrase)) {\r\n            textContent = textContent.replace(phrase, '').trim();\r\n          }\r\n        });\r\n        \r\n        if (textContent !== el.textContent && el.children.length === 0) {\r\n          el.textContent = textContent;\r\n        }\r\n      }\r\n    });\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      cleanupTasks.forEach(cleanup => cleanup());\r\n    };\r\n  }, [removeDebugAttributes, removeTestIds, removeConsoleOutputs, hideDevOnlyElements]);\r\n\r\n  // Utility function to mark elements as dev-only\r\n  const markAsDevOnly = (element: HTMLElement) => {\r\n    element.setAttribute('data-dev-only', 'true');\r\n    if (process.env.NODE_ENV === 'production') {\r\n      element.style.display = 'none';\r\n    }\r\n  };\r\n\r\n  // Utility function to add debug info (only in development)\r\n  const addDebugInfo = (element: HTMLElement, info: string) => {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      element.setAttribute('data-debug', info);\r\n    }\r\n  };\r\n\r\n  return {\r\n    markAsDevOnly,\r\n    addDebugInfo\r\n  };\r\n};\r\n\r\nexport default useCleanupDebugUI;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useConsent.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadConsent'. Either include it or remove the dependency array.","line":36,"column":6,"nodeType":"ArrayExpression","endLine":36,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [loadConsent, user]","fix":{"range":[1191,1197],"text":"[loadConsent, user]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":221,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":221,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":265,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8220,8223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8220,8223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":266,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":266,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8261,8264],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8261,8264],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { logger } from '@/utils/logger';\r\n\r\nexport interface ConsentPreferences {\r\n  essential: boolean;\r\n  analytics: boolean;\r\n  marketing: boolean;\r\n  functional: boolean;\r\n}\r\n\r\nexport interface ConsentContextType {\r\n  preferences: ConsentPreferences;\r\n  hasConsent: (type: keyof ConsentPreferences) => boolean;\r\n  updateConsent: (preferences: ConsentPreferences) => Promise<void>;\r\n  withdrawConsent: (type: keyof ConsentPreferences) => Promise<void>;\r\n  isLoading: boolean;\r\n}\r\n\r\nconst ConsentContext = createContext<ConsentContextType | undefined>(undefined);\r\n\r\nexport function ConsentProvider({ children }: { children: ReactNode }) {\r\n  const { user } = useAuth();\r\n  const [preferences, setPreferences] = useState<ConsentPreferences>({\r\n    essential: true,\r\n    analytics: false,\r\n    marketing: false,\r\n    functional: false,\r\n  });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadConsent();\r\n  }, [user]);\r\n\r\n  const loadConsent = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      // First check localStorage for immediate access\r\n      const localConsent = safeLocalStorage.getItem<string>('cookie-consent', {\r\n        fallbackValue: null,\r\n        logErrors: false\r\n      });\r\n      if (localConsent) {\r\n        try {\r\n          const parsed = typeof localConsent === 'string' ? JSON.parse(localConsent) : localConsent;\r\n          setPreferences(parsed);\r\n        } catch (parseError) {\r\n          logger.warn('Failed to parse consent preferences, using defaults', 'CONSENT', { localConsent, error: parseError });\r\n          // Reset corrupted data\r\n          safeLocalStorage.removeItem('cookie-consent');\r\n        }\r\n      }\r\n\r\n      // If user is authenticated, load from database\r\n      if (user) {\r\n        const { data, error } = await supabase\r\n          .from('user_consent')\r\n          .select('consent_type, is_granted, withdrawn_at')\r\n          .eq('user_id', user.id)\r\n          .is('withdrawn_at', null);\r\n\r\n        if (error) {\r\n          logger.error('Error loading consent', 'CONSENT', error);\r\n          return;\r\n        }\r\n\r\n        // Convert database records to preferences object\r\n        const dbPreferences: ConsentPreferences = {\r\n          essential: true, // Always true\r\n          analytics: false,\r\n          marketing: false,\r\n          functional: false,\r\n        };\r\n\r\n        data?.forEach((record) => {\r\n          if (record.consent_type in dbPreferences) {\r\n            dbPreferences[record.consent_type as keyof ConsentPreferences] = record.is_granted;\r\n          }\r\n        });\r\n\r\n        setPreferences(dbPreferences);\r\n        // Sync with localStorage\r\n        safeLocalStorage.setItem('cookie-consent', JSON.stringify(dbPreferences));\r\n      }\r\n    } catch (error) {\r\n      logger.error('Error loading consent preferences', 'CONSENT', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateConsent = async (newPreferences: ConsentPreferences) => {\r\n    setPreferences(newPreferences);\r\n    safeLocalStorage.setItem('cookie-consent', JSON.stringify(newPreferences));\r\n\r\n    // If user is authenticated, save to database\r\n    if (user) {\r\n      try {\r\n        const clientIP = await getClientIP();\r\n        const consentRecords = Object.entries(newPreferences).map(([type, granted]) => ({\r\n          user_id: user.id,\r\n          consent_type: type,\r\n          is_granted: granted,\r\n          granted_at: granted ? new Date().toISOString() : null,\r\n          legal_basis: 'consent',\r\n          purpose: getConsentPurpose(type),\r\n          ip_address: clientIP,\r\n          user_agent: navigator.userAgent,\r\n        }));\r\n\r\n        // Insert new consent records\r\n        const { error } = await supabase\r\n          .from('user_consent')\r\n          .insert(consentRecords);\r\n\r\n        if (error) {\r\n          logger.error('Error saving consent', 'CONSENT', error);\r\n        }\r\n\r\n        // Record audit event\r\n        await recordAuditEvent('update', 'user_consent', null, null, {\r\n          consent_preferences: newPreferences\r\n        }, 'consent', 'User updated cookie consent preferences');\r\n\r\n      } catch (error) {\r\n        logger.error('Error updating consent in database', 'CONSENT', error);\r\n      }\r\n    }\r\n\r\n    // Apply consent preferences immediately\r\n    applyConsentPreferences(newPreferences);\r\n  };\r\n\r\n  const withdrawConsent = async (type: keyof ConsentPreferences) => {\r\n    const updatedPreferences = { ...preferences, [type]: false };\r\n    await updateConsent(updatedPreferences);\r\n\r\n    // Mark specific consent as withdrawn in database\r\n    if (user) {\r\n      try {\r\n        await supabase\r\n          .from('user_consent')\r\n          .update({ \r\n            withdrawn_at: new Date().toISOString(),\r\n            is_granted: false \r\n          })\r\n          .eq('user_id', user.id)\r\n          .eq('consent_type', type)\r\n          .is('withdrawn_at', null);\r\n\r\n        await recordAuditEvent('withdraw', 'user_consent', null, null, {\r\n          consent_type: type\r\n        }, 'consent', `User withdrew ${type} consent`);\r\n\r\n      } catch (error) {\r\n        logger.error('Error withdrawing consent', 'CONSENT', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const hasConsent = (type: keyof ConsentPreferences): boolean => {\r\n    return preferences[type];\r\n  };\r\n\r\n  const applyConsentPreferences = (prefs: ConsentPreferences) => {\r\n    // Analytics consent\r\n    if (!prefs.analytics) {\r\n      // Disable analytics tracking\r\n      window.gtag?.('consent', 'update', {\r\n        analytics_storage: 'denied'\r\n      });\r\n      // Clear analytics cookies\r\n      clearAnalyticsCookies();\r\n    } else {\r\n      window.gtag?.('consent', 'update', {\r\n        analytics_storage: 'granted'\r\n      });\r\n    }\r\n\r\n    // Marketing consent\r\n    if (!prefs.marketing) {\r\n      window.gtag?.('consent', 'update', {\r\n        ad_storage: 'denied',\r\n        ad_user_data: 'denied',\r\n        ad_personalization: 'denied'\r\n      });\r\n      clearMarketingCookies();\r\n    } else {\r\n      window.gtag?.('consent', 'update', {\r\n        ad_storage: 'granted',\r\n        ad_user_data: 'granted',\r\n        ad_personalization: 'granted'\r\n      });\r\n    }\r\n\r\n    // Functional consent\r\n    if (!prefs.functional) {\r\n      // Clear functional cookies except essential ones\r\n      clearFunctionalCookies();\r\n    }\r\n  };\r\n\r\n  const value: ConsentContextType = {\r\n    preferences,\r\n    hasConsent,\r\n    updateConsent,\r\n    withdrawConsent,\r\n    isLoading,\r\n  };\r\n\r\n  return (\r\n    <ConsentContext.Provider value={value}>\r\n      {children}\r\n    </ConsentContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useConsent() {\r\n  const context = useContext(ConsentContext);\r\n  if (context === undefined) {\r\n    throw new Error('useConsent must be used within a ConsentProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\n// Helper functions\r\nfunction getConsentPurpose(type: string): string {\r\n  const purposes = {\r\n    essential: 'Required for platform functionality and security',\r\n    analytics: 'Analyzing user behavior to improve platform performance',\r\n    marketing: 'Personalizing content and delivering relevant advertisements',\r\n    functional: 'Remembering user preferences and settings',\r\n  };\r\n  return purposes[type as keyof typeof purposes] || 'Unknown purpose';\r\n}\r\n\r\nasync function getClientIP(): Promise<string | null> {\r\n  try {\r\n    const response = await fetch('https://api.ipify.org?format=json');\r\n    const data = await response.json();\r\n    return data.ip;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nasync function recordAuditEvent(\r\n  action: string,\r\n  tableName: string,\r\n  recordId: string | null,\r\n  oldValues: Record<string, unknown> | null,\r\n  newValues: Record<string, unknown> | null,\r\n  legalBasis: string,\r\n  purpose: string\r\n) {\r\n  try {\r\n    await supabase.rpc('record_audit_event', {\r\n      p_user_id: (await supabase.auth.getUser()).data.user?.id,\r\n      p_action: action,\r\n      p_table_name: tableName,\r\n      p_record_id: recordId,\r\n        p_old_values: oldValues as any,\r\n        p_new_values: newValues as any,\r\n      p_legal_basis: legalBasis,\r\n      p_purpose: purpose,\r\n    });\r\n  } catch (error) {\r\n    logger.error('Error recording audit event', 'CONSENT', error);\r\n  }\r\n}\r\n\r\nfunction clearAnalyticsCookies() {\r\n  const analyticsCookies = ['_ga', '_ga_', '_gid', '_gat', '_gtag'];\r\n  analyticsCookies.forEach(cookieName => {\r\n    document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\r\n    document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.${window.location.hostname};`;\r\n  });\r\n}\r\n\r\nfunction clearMarketingCookies() {\r\n  const marketingCookies = ['_fbp', '_fbc', '__Secure-3PAPISID', '__Secure-3PSID'];\r\n  marketingCookies.forEach(cookieName => {\r\n    document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\r\n    document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.${window.location.hostname};`;\r\n  });\r\n}\r\n\r\nfunction clearFunctionalCookies() {\r\n  // Clear non-essential functional cookies\r\n  const functionalCookies = ['theme', 'language', 'sidebar-state'];\r\n  functionalCookies.forEach(cookieName => {\r\n    document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\r\n  });\r\n}\r\n\r\n// Extend Window interface for gtag\r\ndeclare global {\r\n  interface Window {\r\n    gtag?: (...args: unknown[]) => void;\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useConversationMemory.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3785,3788],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3785,3788],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadMemory'. Either include it or remove the dependency array.","line":283,"column":6,"nodeType":"ArrayExpression","endLine":283,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [loadMemory, sessionId, user?.id]","fix":{"range":[8990,9011],"text":"[loadMemory, sessionId, user?.id]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\n// Advanced Conversation Memory Management Hook - Phase 1 Implementation\r\ninterface WorkingMemory {\r\n  currentTopic: string | null;\r\n  questionSequence: string[];\r\n  studentResponses: string[];\r\n  misconceptions: string[];\r\n}\r\n\r\ninterface EpisodicMemory {\r\n  sessionHistory: SessionData[];\r\n  learningPatterns: string[];\r\n  successfulStrategies: string[];\r\n}\r\n\r\ninterface SessionData {\r\n  timestamp: string;\r\n  topic: string;\r\n  performance: number;\r\n  [key: string]: unknown;\r\n}\r\n\r\ninterface SemanticMemory {\r\n  conceptMap: Record<string, string[]>;\r\n  knowledgeGaps: string[];\r\n  masteredConcepts: string[];\r\n}\r\n\r\ninterface ProceduralMemory {\r\n  preferredQuestioningStyles: string[];\r\n  effectiveScaffolding: string[];\r\n  adaptationStrategies: string[];\r\n}\r\n\r\ninterface ConversationMemory {\r\n  id?: string;\r\n  user_id: string;\r\n  session_id: string;\r\n  memory_type: 'working' | 'episodic' | 'semantic' | 'procedural';\r\n  memory_data: WorkingMemory | EpisodicMemory | SemanticMemory | ProceduralMemory;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface MemoryState {\r\n  working: WorkingMemory;\r\n  episodic: EpisodicMemory;\r\n  semantic: SemanticMemory;\r\n  procedural: ProceduralMemory;\r\n}\r\n\r\nexport const useConversationMemory = (sessionId: string | null) => {\r\n  const [memory, setMemory] = useState<MemoryState>({\r\n    working: {\r\n      currentTopic: null,\r\n      questionSequence: [],\r\n      studentResponses: [],\r\n      misconceptions: []\r\n    },\r\n    episodic: {\r\n      sessionHistory: [],\r\n      learningPatterns: [],\r\n      successfulStrategies: []\r\n    },\r\n    semantic: {\r\n      conceptMap: {},\r\n      knowledgeGaps: [],\r\n      masteredConcepts: []\r\n    },\r\n    procedural: {\r\n      preferredQuestioningStyles: [],\r\n      effectiveScaffolding: [],\r\n      adaptationStrategies: []\r\n    }\r\n  });\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { user } = useAuth();\r\n\r\n  // Load conversation memory for session\r\n  const loadMemory = async () => {\r\n    if (!user?.id || !sessionId) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('conversation_memory')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .eq('session_id', sessionId);\r\n\r\n      if (error) throw error;\r\n\r\n      // Organize memory by type\r\n      const memoryByType = data.reduce((acc, item) => {\r\n        acc[item.memory_type] = item.memory_data;\r\n        return acc;\r\n      }, {} as Record<string, unknown>);\r\n\r\n      setMemory({\r\n        working: (memoryByType.working as WorkingMemory) || memory.working,\r\n        episodic: (memoryByType.episodic as EpisodicMemory) || memory.episodic,\r\n        semantic: (memoryByType.semantic as SemanticMemory) || memory.semantic,\r\n        procedural: (memoryByType.procedural as ProceduralMemory) || memory.procedural\r\n      });\r\n    } catch (error) {\r\n      console.error('Error loading conversation memory:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Update specific memory type\r\n  const updateMemory = async (\r\n    memoryType: 'working' | 'episodic' | 'semantic' | 'procedural',\r\n    updates: Partial<WorkingMemory | EpisodicMemory | SemanticMemory | ProceduralMemory>\r\n  ) => {\r\n    if (!user?.id || !sessionId) return;\r\n\r\n    try {\r\n      const currentMemory = memory[memoryType];\r\n      const updatedMemory = { ...currentMemory, ...updates };\r\n\r\n      const { error } = await supabase\r\n        .from('conversation_memory')\r\n        .upsert({\r\n          user_id: user.id,\r\n          session_id: sessionId,\r\n          memory_type: memoryType,\r\n          memory_data: updatedMemory as any,\r\n          updated_at: new Date().toISOString()\r\n        }, {\r\n          onConflict: 'user_id,session_id,memory_type'\r\n        });\r\n\r\n      if (error) throw error;\r\n\r\n      setMemory(prev => ({\r\n        ...prev,\r\n        [memoryType]: updatedMemory\r\n      }));\r\n    } catch (error) {\r\n      console.error(`Error updating ${memoryType} memory:`, error);\r\n    }\r\n  };\r\n\r\n  // Working Memory Operations\r\n  const addToQuestionSequence = (question: string) => {\r\n    const updatedSequence = [...memory.working.questionSequence, question].slice(-10); // Keep last 10\r\n    updateMemory('working', { questionSequence: updatedSequence });\r\n  };\r\n\r\n  const addStudentResponse = (response: string) => {\r\n    const updatedResponses = [...memory.working.studentResponses, response].slice(-10); // Keep last 10\r\n    updateMemory('working', { studentResponses: updatedResponses });\r\n  };\r\n\r\n  const setCurrentTopic = (topic: string) => {\r\n    updateMemory('working', { currentTopic: topic });\r\n  };\r\n\r\n  const addMisconception = (misconception: string) => {\r\n    const misconceptions = [...new Set([...memory.working.misconceptions, misconception])];\r\n    updateMemory('working', { misconceptions });\r\n  };\r\n\r\n  // Episodic Memory Operations\r\n  const addLearningPattern = (pattern: string) => {\r\n    const patterns = [...new Set([...memory.episodic.learningPatterns, pattern])];\r\n    updateMemory('episodic', { learningPatterns: patterns });\r\n  };\r\n\r\n  const addSuccessfulStrategy = (strategy: string) => {\r\n    const strategies = [...new Set([...memory.episodic.successfulStrategies, strategy])];\r\n    updateMemory('episodic', { successfulStrategies: strategies });\r\n  };\r\n\r\n  const updateSessionHistory = (sessionData: SessionData) => {\r\n    const history = [...memory.episodic.sessionHistory, sessionData].slice(-20); // Keep last 20\r\n    updateMemory('episodic', { sessionHistory: history });\r\n  };\r\n\r\n  // Semantic Memory Operations\r\n  const updateConceptMap = (concept: string, relatedConcepts: string[]) => {\r\n    const conceptMap = {\r\n      ...memory.semantic.conceptMap,\r\n      [concept]: relatedConcepts\r\n    };\r\n    updateMemory('semantic', { conceptMap });\r\n  };\r\n\r\n  const addKnowledgeGap = (gap: string) => {\r\n    const gaps = [...new Set([...memory.semantic.knowledgeGaps, gap])];\r\n    updateMemory('semantic', { knowledgeGaps: gaps });\r\n  };\r\n\r\n  const addMasteredConcept = (concept: string) => {\r\n    const mastered = [...new Set([...memory.semantic.masteredConcepts, concept])];\r\n    // Remove from knowledge gaps if present\r\n    const gaps = memory.semantic.knowledgeGaps.filter(gap => gap !== concept);\r\n    updateMemory('semantic', { \r\n      masteredConcepts: mastered,\r\n      knowledgeGaps: gaps \r\n    });\r\n  };\r\n\r\n  // Procedural Memory Operations\r\n  const addPreferredQuestioningStyle = (style: string) => {\r\n    const styles = [...new Set([...memory.procedural.preferredQuestioningStyles, style])];\r\n    updateMemory('procedural', { preferredQuestioningStyles: styles });\r\n  };\r\n\r\n  const addEffectiveScaffolding = (scaffolding: string) => {\r\n    const scaffolds = [...new Set([...memory.procedural.effectiveScaffolding, scaffolding])];\r\n    updateMemory('procedural', { effectiveScaffolding: scaffolds });\r\n  };\r\n\r\n  const addAdaptationStrategy = (strategy: string) => {\r\n    const strategies = [...new Set([...memory.procedural.adaptationStrategies, strategy])];\r\n    updateMemory('procedural', { adaptationStrategies: strategies });\r\n  };\r\n\r\n  // Analysis functions\r\n  const getConversationInsights = () => {\r\n    return {\r\n      topicProgression: memory.working.questionSequence.length,\r\n      identifiedMisconceptions: memory.working.misconceptions.length,\r\n      learningPatterns: memory.episodic.learningPatterns,\r\n      knowledgeGaps: memory.semantic.knowledgeGaps.length,\r\n      masteredConcepts: memory.semantic.masteredConcepts.length,\r\n      preferredStrategies: memory.procedural.preferredQuestioningStyles\r\n    };\r\n  };\r\n\r\n  const getAdaptationRecommendations = () => {\r\n    const insights = getConversationInsights();\r\n    const recommendations = [];\r\n\r\n    if (insights.identifiedMisconceptions > 3) {\r\n      recommendations.push({\r\n        type: 'misconception_focus',\r\n        message: 'Focus on addressing core misconceptions before advancing',\r\n        priority: 'high'\r\n      });\r\n    }\r\n\r\n    if (insights.knowledgeGaps > insights.masteredConcepts) {\r\n      recommendations.push({\r\n        type: 'foundation_building',\r\n        message: 'Strengthen foundational concepts',\r\n        priority: 'medium'\r\n      });\r\n    }\r\n\r\n    if (memory.procedural.preferredQuestioningStyles.length > 0) {\r\n      recommendations.push({\r\n        type: 'questioning_adaptation',\r\n        message: `Use preferred questioning style: ${memory.procedural.preferredQuestioningStyles[0]}`,\r\n        priority: 'low'\r\n      });\r\n    }\r\n\r\n    return recommendations;\r\n  };\r\n\r\n  // Clear memory for new session\r\n  const clearWorkingMemory = () => {\r\n    updateMemory('working', {\r\n      currentTopic: null,\r\n      questionSequence: [],\r\n      studentResponses: [],\r\n      misconceptions: []\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (sessionId && user?.id) {\r\n      loadMemory();\r\n    }\r\n  }, [sessionId, user?.id]);\r\n\r\n  return {\r\n    memory,\r\n    isLoading,\r\n    \r\n    // Working Memory\r\n    addToQuestionSequence,\r\n    addStudentResponse,\r\n    setCurrentTopic,\r\n    addMisconception,\r\n    \r\n    // Episodic Memory\r\n    addLearningPattern,\r\n    addSuccessfulStrategy,\r\n    updateSessionHistory,\r\n    \r\n    // Semantic Memory\r\n    updateConceptMap,\r\n    addKnowledgeGap,\r\n    addMasteredConcept,\r\n    \r\n    // Procedural Memory\r\n    addPreferredQuestioningStyle,\r\n    addEffectiveScaffolding,\r\n    addAdaptationStrategy,\r\n    \r\n    // Analysis\r\n    getConversationInsights,\r\n    getAdaptationRecommendations,\r\n    clearWorkingMemory,\r\n    refreshMemory: loadMemory\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useConversationState.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'isInQuizSession'. Either include it or remove the dependency array.","line":98,"column":6,"nodeType":"ArrayExpression","endLine":98,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [isInQuizSession, state]","fix":{"range":[2989,2996],"text":"[isInQuizSession, state]"}}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":164,"column":43,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":164,"endColumn":44,"suggestions":[{"messageId":"removeEscape","fix":{"range":[5178,5179],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[5178,5178],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Conversation State Management Hook - Backend Intelligence Layer\r\nimport { useState, useCallback } from 'react';\r\n\r\nexport interface ConversationState {\r\n  promptType: 'initiate_session' | 'initiate_quiz' | 'evaluate_answer' | 'evaluate_quiz_answer' | 'proactive_help' | 'evaluate_refresher' | 'direct_answer';\r\n  isInQuiz: boolean;\r\n  inRefresherMode: boolean;\r\n  lastAIQuestion: string | null;\r\n  currentTopic: string | null;\r\n  incorrectAnswersCount: number;\r\n  teachingMethods: string[];\r\n}\r\n\r\nexport interface ChatMessage {\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\nexport const useConversationState = () => {\r\n  const [state, setState] = useState<ConversationState>({\r\n    promptType: 'initiate_session',\r\n    isInQuiz: false,\r\n    inRefresherMode: false,\r\n    lastAIQuestion: null,\r\n    currentTopic: null,\r\n    incorrectAnswersCount: 0,\r\n    teachingMethods: []\r\n  });\r\n\r\n  // Analyze conversation history and determine next prompt type\r\n  const analyzeConversation = useCallback((chatHistory: ChatMessage[], currentMessage: string): ConversationState => {\r\n    const trimmed = currentMessage.trim();\r\n    \r\n    // Direct answer command\r\n    if (trimmed.startsWith('/answer')) {\r\n      return { ...state, promptType: 'direct_answer' };\r\n    }\r\n\r\n    // Struggle indicators\r\n    if (isStruggleIndicator(trimmed)) {\r\n      return { ...state, promptType: 'proactive_help' };\r\n    }\r\n\r\n    // Quiz request\r\n    if (isQuizRequest(trimmed)) {\r\n      return { \r\n        ...state, \r\n        promptType: 'initiate_quiz',\r\n        isInQuiz: true,\r\n        currentTopic: extractQuizTopic(trimmed)\r\n      };\r\n    }\r\n\r\n    const lastAIMessage = chatHistory.length > 0 ? chatHistory[chatHistory.length - 1] : null;\r\n    const lastAIQuestion = lastAIMessage?.role === 'assistant' ? extractLastQuestion(lastAIMessage.content) : null;\r\n    \r\n    // Check if user is answering a question\r\n    if (lastAIQuestion && isLikelyAnswer(trimmed, lastAIQuestion)) {\r\n      // In refresher mode\r\n      if (state.inRefresherMode) {\r\n        return { \r\n          ...state, \r\n          promptType: 'evaluate_refresher',\r\n          lastAIQuestion \r\n        };\r\n      }\r\n      \r\n      // In quiz mode\r\n      if (state.isInQuiz || isInQuizSession(chatHistory)) {\r\n        return { \r\n          ...state, \r\n          promptType: 'evaluate_quiz_answer',\r\n          isInQuiz: true,\r\n          lastAIQuestion \r\n        };\r\n      }\r\n      \r\n      // Regular answer evaluation\r\n      const teachingMethods = extractTeachingHistory(chatHistory);\r\n      const incorrectCount = countRecentIncorrectAnswers(chatHistory);\r\n      \r\n      return { \r\n        ...state, \r\n        promptType: 'evaluate_answer',\r\n        lastAIQuestion,\r\n        teachingMethods,\r\n        incorrectAnswersCount: incorrectCount\r\n      };\r\n    }\r\n\r\n    // Default to initiate session for new questions\r\n    return { \r\n      ...state, \r\n      promptType: 'initiate_session',\r\n      lastAIQuestion \r\n    };\r\n  }, [state]);\r\n\r\n  // Helper functions moved from prompt-builder\r\n  const isStruggleIndicator = (message: string): boolean => {\r\n    const struggleKeywords = [\r\n      /i need more help/i,\r\n      /can you help/i,\r\n      /i don't know/i,\r\n      /i'm stuck/i,\r\n      /i need to go back to the basics/i,\r\n      /i'm confused/i,\r\n      /this is hard/i,\r\n      /i don't understand/i\r\n    ];\r\n    return struggleKeywords.some(pattern => pattern.test(message));\r\n  };\r\n\r\n  const isQuizRequest = (message: string): boolean => {\r\n    const quizPatterns = [\r\n      /quiz me on/i,\r\n      /give me a quiz on/i,\r\n      /test me on/i,\r\n      /can you quiz me/i,\r\n      /i want a quiz on/i,\r\n      /quiz about/i,\r\n      /test my knowledge/i\r\n    ];\r\n    return quizPatterns.some(pattern => pattern.test(message));\r\n  };\r\n\r\n  const extractQuizTopic = (message: string): string => {\r\n    const patterns = [\r\n      /(?:quiz me on|give me a quiz on|test me on|can you quiz me (?:on|about)|i want a quiz on|quiz about|test my knowledge (?:of|on|about))\\s+(.+)/i\r\n    ];\r\n    \r\n    for (const pattern of patterns) {\r\n      const match = message.match(pattern);\r\n      if (match && match[1]) {\r\n        return match[1].trim().replace(/[?.!]*$/, '');\r\n      }\r\n    }\r\n    return message.trim();\r\n  };\r\n\r\n  const extractLastQuestion = (content: string): string | null => {\r\n    if (content.includes('?') || \r\n        content.toLowerCase().includes('what') ||\r\n        content.toLowerCase().includes('how') ||\r\n        content.toLowerCase().includes('why') ||\r\n        content.toLowerCase().includes('when') ||\r\n        content.toLowerCase().includes('where') ||\r\n        content.toLowerCase().includes('tell me about') ||\r\n        content.toLowerCase().includes('explain')) {\r\n      return content;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const isLikelyAnswer = (message: string, lastQuestion: string): boolean => {\r\n    const answerPatterns = [\r\n      /^(yes|no|maybe|i think|i believe|is it|that's|this is|it's|the answer is)/i,\r\n      /^(because|since|due to|as a result)/i,\r\n      /^[a-zA-Z\\s]{1,50}$/i,\r\n    ];\r\n    \r\n    const numericAnswer = /^\\s*[-+]?\\d+(?:\\.\\d+)?\\s*$/;\r\n    const simpleMathExpr = /\\b\\d+\\s*([x*Ã—+\\/-])\\s*\\d+\\b/;\r\n\r\n    return answerPatterns.some(pattern => pattern.test(message.trim())) ||\r\n           numericAnswer.test(message) ||\r\n           simpleMathExpr.test(message) ||\r\n           message.trim().length < 50;\r\n  };\r\n\r\n  const isInQuizSession = (chatHistory: ChatMessage[]): boolean => {\r\n    for (let i = chatHistory.length - 1; i >= Math.max(0, chatHistory.length - 5); i--) {\r\n      const msg = chatHistory[i];\r\n      if (msg.role === 'assistant') {\r\n        const content = msg.content.toLowerCase();\r\n        if (content.includes('quiz') || content.includes('test') || \r\n            content.includes('let\\'s start') || content.includes('great idea! let\\'s begin')) {\r\n          return true;\r\n        }\r\n      } else if (msg.role === 'user' && isQuizRequest(msg.content)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const extractTeachingHistory = (chatHistory: ChatMessage[]): string[] => {\r\n    const teachingMethods: string[] = [];\r\n    \r\n    for (const msg of chatHistory) {\r\n      if (msg.role === 'assistant') {\r\n        const content = msg.content.toLowerCase();\r\n        \r\n        if (content.includes('add') && content.includes('times')) {\r\n          teachingMethods.push('addition breakdown');\r\n        }\r\n        if (content.includes('analogy') || content.includes('like') || content.includes('imagine')) {\r\n          teachingMethods.push('analogy method');\r\n        }\r\n        if (content.includes('break down') || content.includes('step by step')) {\r\n          teachingMethods.push('step-by-step breakdown');\r\n        }\r\n        if (content.includes('example') || content.includes('for instance')) {\r\n          teachingMethods.push('example illustration');\r\n        }\r\n        if (content.includes('visual') || content.includes('picture') || content.includes('draw')) {\r\n          teachingMethods.push('visual approach');\r\n        }\r\n        if (content.includes('simpler') || content.includes('easier')) {\r\n          teachingMethods.push('simplification method');\r\n        }\r\n        if (content.includes('pattern') || content.includes('sequence')) {\r\n          teachingMethods.push('pattern recognition');\r\n        }\r\n        if (content.includes('group') || content.includes('set')) {\r\n          teachingMethods.push('grouping method');\r\n        }\r\n      }\r\n    }\r\n    \r\n    return [...new Set(teachingMethods)];\r\n  };\r\n\r\n  const countRecentIncorrectAnswers = (chatHistory: ChatMessage[]): number => {\r\n    let count = 0;\r\n    for (let i = chatHistory.length - 1; i >= 0; i--) {\r\n      const msg = chatHistory[i];\r\n      if (msg.role === 'assistant') {\r\n        const content = msg.content.toLowerCase();\r\n        if (content.includes('not quite') || content.includes('try again') || content.includes('incorrect')) {\r\n          count++;\r\n        } else if (content.includes('correct') || content.includes('exactly') || content.includes('that\\'s it')) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return count;\r\n  };\r\n\r\n  const updateState = (updates: Partial<ConversationState>) => {\r\n    setState(prev => ({ ...prev, ...updates }));\r\n  };\r\n\r\n  return {\r\n    state,\r\n    analyzeConversation,\r\n    updateState\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useCourseEnrollment.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useCourseMedia.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadMedia'. Either include it or remove the dependency array.","line":143,"column":6,"nodeType":"ArrayExpression","endLine":143,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [loadMedia, moduleId]","fix":{"range":[3958,3968],"text":"[loadMedia, moduleId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport type { Database } from '@/integrations/supabase/types';\r\n\r\ntype CourseMedia = Database['public']['Tables']['course_media']['Row'];\r\n\r\nexport const useCourseMedia = (moduleId?: string) => {\r\n  const [media, setMedia] = useState<CourseMedia[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const { toast } = useToast();\r\n\r\n  // Load media for a module\r\n  const loadMedia = async () => {\r\n    if (!moduleId) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('course_media')\r\n        .select('*')\r\n        .eq('module_id', moduleId)\r\n        .order('created_at', { ascending: true });\r\n\r\n      if (error) throw error;\r\n      setMedia(data || []);\r\n    } catch (error) {\r\n      console.error('Error loading media:', error);\r\n      toast({\r\n        title: \"Error loading media\",\r\n        description: \"Failed to load course media.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Upload media file\r\n  const uploadMedia = async (file: File, mediaType: 'video' | 'audio' | 'document' | 'image') => {\r\n    if (!moduleId) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Module ID is required for media upload.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    try {\r\n      // Determine bucket based on media type\r\n      const bucketMap = {\r\n        video: 'course-videos',\r\n        audio: 'course-audio',\r\n        document: 'course-documents',\r\n        image: 'course-images'\r\n      };\r\n\r\n      const bucket = bucketMap[mediaType];\r\n      const fileName = `${moduleId}/${Date.now()}-${file.name}`;\r\n\r\n      // Upload file to storage\r\n      const { data: uploadData, error: uploadError } = await supabase.storage\r\n        .from(bucket)\r\n        .upload(fileName, file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      // Get public URL\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(bucket)\r\n        .getPublicUrl(fileName);\r\n\r\n      // Create media record\r\n      const { data: mediaData, error: mediaError } = await supabase\r\n        .from('course_media')\r\n        .insert({\r\n          module_id: moduleId,\r\n          media_type: mediaType,\r\n          file_name: file.name,\r\n          file_path: publicUrl,\r\n          file_size: file.size,\r\n          mime_type: file.type,\r\n          metadata: {}\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (mediaError) throw mediaError;\r\n\r\n      setMedia(prev => [...prev, mediaData]);\r\n      \r\n      toast({\r\n        title: \"Media uploaded\",\r\n        description: `${file.name} has been uploaded successfully.`,\r\n      });\r\n\r\n      return mediaData;\r\n    } catch (error) {\r\n      console.error('Error uploading media:', error);\r\n      toast({\r\n        title: \"Upload failed\",\r\n        description: \"Failed to upload media file.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  // Delete media\r\n  const deleteMedia = async (mediaId: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('course_media')\r\n        .delete()\r\n        .eq('id', mediaId);\r\n\r\n      if (error) throw error;\r\n\r\n      setMedia(prev => prev.filter(m => m.id !== mediaId));\r\n      \r\n      toast({\r\n        title: \"Media deleted\",\r\n        description: \"Media file has been removed.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Error deleting media:', error);\r\n      toast({\r\n        title: \"Delete failed\",\r\n        description: \"Failed to delete media file.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadMedia();\r\n  }, [moduleId]);\r\n\r\n  return {\r\n    media,\r\n    isLoading,\r\n    isUploading,\r\n    uploadMedia,\r\n    deleteMedia,\r\n    loadMedia\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useCourses.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useCurrentReadingBooks.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isSubscribed'. Either include it or remove the dependency array.","line":110,"column":6,"nodeType":"ArrayExpression","endLine":110,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, refetch, isSubscribed]","fix":{"range":[3343,3362],"text":"[user.id, refetch, isSubscribed]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\ninterface ReadingBook {\r\n  id: string;\r\n  user_id: string;\r\n  book_id: string;\r\n  current_cfi?: string;\r\n  chapter_index: number;\r\n  reading_time_seconds: number;\r\n  completion_percentage: number;\r\n  last_read_at: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport const useCurrentReadingBooks = () => {\r\n  const { user } = useAuth();\r\n  const subscriptionRef = useRef<ReturnType<typeof supabase.channel> | null>(null);\r\n  const [isSubscribed, setIsSubscribed] = useState(false);\r\n\r\n  const { data, isLoading, error, refetch } = useQuery({\r\n    queryKey: ['currentReadingBooks', user?.id],\r\n    queryFn: async (): Promise<ReadingBook[]> => {\r\n      if (!user?.id) {\r\n        console.log('ðŸ“š No user ID, returning empty array');\r\n        return [];\r\n      }\r\n\r\n      console.log('ðŸ“š Loading current reading books for user:', user.id);\r\n      \r\n      const { data, error } = await supabase\r\n        .from('reading_progress')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('last_read_at', { ascending: false });\r\n      \r\n      if (error) {\r\n        console.error('âŒ Error fetching reading books:', error);\r\n        throw new Error(`Failed to fetch reading books: ${error.message}`);\r\n      }\r\n      \r\n      console.log('âœ… Loaded reading books:', data?.length || 0);\r\n      return data || [];\r\n    },\r\n    enabled: !!user?.id,\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n    gcTime: 10 * 60 * 1000, // 10 minutes\r\n  });\r\n\r\n  // Set up real-time subscription with proper cleanup\r\n  useEffect(() => {\r\n    if (!user?.id) {\r\n      return;\r\n    }\r\n\r\n    // Prevent multiple subscriptions\r\n    if (subscriptionRef.current || isSubscribed) {\r\n      return;\r\n    }\r\n\r\n    const setupSubscription = () => {\r\n      try {\r\n        console.log('ðŸ”„ Setting up reading progress subscription for user:', user.id);\r\n        \r\n        const channel = supabase\r\n          .channel(`reading-progress-${user.id}-${Date.now()}`)\r\n          .on(\r\n            'postgres_changes',\r\n            {\r\n              event: '*',\r\n              schema: 'public',\r\n              table: 'reading_progress',\r\n              filter: `user_id=eq.${user.id}`,\r\n            },\r\n            (payload) => {\r\n              console.log('ðŸ“š Reading progress change detected:', payload);\r\n              refetch();\r\n            }\r\n          )\r\n          .subscribe((status) => {\r\n            console.log('ðŸ“š Reading progress subscription status:', status);\r\n            if (status === 'SUBSCRIBED') {\r\n              setIsSubscribed(true);\r\n            }\r\n            if (status === 'CLOSED') {\r\n              setIsSubscribed(false);\r\n            }\r\n          });\r\n\r\n        subscriptionRef.current = channel;\r\n      } catch (error) {\r\n        console.error('âŒ Error setting up reading progress subscription:', error);\r\n      }\r\n    };\r\n\r\n    setupSubscription();\r\n\r\n    return () => {\r\n      if (subscriptionRef.current) {\r\n        console.log('ðŸ§¹ Cleaning up reading progress subscription');\r\n        subscriptionRef.current.unsubscribe();\r\n        subscriptionRef.current = null;\r\n        setIsSubscribed(false);\r\n      }\r\n    };\r\n  }, [user?.id, refetch]); // Removed isSubscribed from dependencies to prevent loops\r\n\r\n  return {\r\n    data: data || [],\r\n    isLoading,\r\n    error,\r\n    refetch,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useDebouncedSearch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useDualLanguage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useEPUBUrlOptimizer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useEnhancedAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useEnhancedEPUBLoader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useEnhancedVoiceInput.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[643,646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[643,646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[727,730],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[727,730],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[815,818],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[815,818],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[879,882],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[879,882],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'stopNativeRecognition'. Either include it or remove the dependency array.","line":130,"column":6,"nodeType":"ArrayExpression","endLine":130,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [isNativeSupported, stopNativeRecognition, toast]","fix":{"range":[4236,4262],"text":"[isNativeSupported, stopNativeRecognition, toast]"}}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useRef, useCallback } from 'react';\r\nimport { useVoiceRecording } from '@/hooks/useVoiceRecording';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface SpeechRecognitionEvent extends Event {\r\n  results: SpeechRecognitionResultList;\r\n  resultIndex: number;\r\n}\r\n\r\ninterface SpeechRecognitionErrorEvent extends Event {\r\n  error: string;\r\n  message?: string;\r\n}\r\n\r\ninterface SpeechRecognition extends EventTarget {\r\n  continuous: boolean;\r\n  interimResults: boolean;\r\n  lang: string;\r\n  maxAlternatives: number;\r\n  start(): void;\r\n  stop(): void;\r\n  abort(): void;\r\n  onstart: ((this: SpeechRecognition, ev: Event) => any) | null;\r\n  onresult: ((this: SpeechRecognition, ev: SpeechRecognitionEvent) => any) | null;\r\n  onerror: ((this: SpeechRecognition, ev: SpeechRecognitionErrorEvent) => any) | null;\r\n  onend: ((this: SpeechRecognition, ev: Event) => any) | null;\r\n}\r\n\r\ndeclare global {\r\n  interface Window {\r\n    SpeechRecognition: new () => SpeechRecognition;\r\n    webkitSpeechRecognition: new () => SpeechRecognition;\r\n  }\r\n}\r\n\r\nexport const useEnhancedVoiceInput = () => {\r\n  const [isNativeListening, setIsNativeListening] = useState(false);\r\n  const [transcript, setTranscript] = useState('');\r\n  const [useNativeFirst, setUseNativeFirst] = useState(true);\r\n  \r\n  const recognitionRef = useRef<SpeechRecognition | null>(null);\r\n  const { toast } = useToast();\r\n  \r\n  // Fallback to existing MediaRecorder approach\r\n  const mediaRecorderHook = useVoiceRecording();\r\n  \r\n  // Check if native Speech Recognition is supported\r\n  const isNativeSupported = 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window;\r\n\r\n  const startNativeRecognition = useCallback((onResult: (text: string) => void) => {\r\n    if (!isNativeSupported) {\r\n      toast({\r\n        title: \"Speech Recognition Not Supported\",\r\n        description: \"Falling back to audio recording...\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n      const recognition = new SpeechRec();\r\n      \r\n      recognition.continuous = false;\r\n      recognition.interimResults = true;\r\n      recognition.lang = 'en-US';\r\n      recognition.maxAlternatives = 1;\r\n\r\n      recognition.onstart = () => {\r\n        setIsNativeListening(true);\r\n        setTranscript('');\r\n      };\r\n\r\n      recognition.onresult = (event: SpeechRecognitionEvent) => {\r\n        let finalTranscript = '';\r\n        let interimTranscript = '';\r\n\r\n        for (let i = event.resultIndex; i < event.results.length; i++) {\r\n          const result = event.results[i];\r\n          if (result.isFinal) {\r\n            finalTranscript += result[0].transcript;\r\n          } else {\r\n            interimTranscript += result[0].transcript;\r\n          }\r\n        }\r\n\r\n        setTranscript(finalTranscript + interimTranscript);\r\n\r\n        if (finalTranscript) {\r\n          onResult(finalTranscript.trim());\r\n          stopNativeRecognition();\r\n        }\r\n      };\r\n\r\n      recognition.onerror = (event: SpeechRecognitionErrorEvent) => {\r\n        console.error('Speech recognition error:', event.error);\r\n        setIsNativeListening(false);\r\n        \r\n        if (event.error === 'not-allowed' || event.error === 'service-not-allowed') {\r\n          toast({\r\n            title: \"Microphone Permission Denied\",\r\n            description: \"Please allow microphone access and try again.\",\r\n            variant: \"destructive\"\r\n          });\r\n        } else if (event.error === 'no-speech') {\r\n          toast({\r\n            title: \"No Speech Detected\",\r\n            description: \"Please try speaking again.\",\r\n          });\r\n        } else {\r\n          toast({\r\n            title: \"Speech Recognition Error\",\r\n            description: \"There was an issue with speech recognition. Falling back to audio recording.\",\r\n          });\r\n        }\r\n      };\r\n\r\n      recognition.onend = () => {\r\n        setIsNativeListening(false);\r\n      };\r\n\r\n      recognitionRef.current = recognition;\r\n      recognition.start();\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Failed to start native speech recognition:', error);\r\n      setIsNativeListening(false);\r\n      return false;\r\n    }\r\n  }, [isNativeSupported, toast]);\r\n\r\n  const stopNativeRecognition = useCallback(() => {\r\n    if (recognitionRef.current) {\r\n      recognitionRef.current.stop();\r\n      recognitionRef.current = null;\r\n    }\r\n    setIsNativeListening(false);\r\n    setTranscript('');\r\n  }, []);\r\n\r\n  // Enhanced start recording that tries native first, then falls back\r\n  const startRecording = useCallback(async (onResult: (text: string) => void) => {\r\n    if (useNativeFirst && isNativeSupported) {\r\n      const nativeStarted = startNativeRecognition(onResult);\r\n      if (nativeStarted) return;\r\n    }\r\n    \r\n    // Fallback to MediaRecorder approach\r\n    try {\r\n      await mediaRecorderHook.startRecording();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Recording Failed\",\r\n        description: \"Could not access microphone. Please check permissions.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  }, [useNativeFirst, isNativeSupported, startNativeRecognition, mediaRecorderHook, toast]);\r\n\r\n  const stopRecording = useCallback(async (): Promise<string> => {\r\n    if (isNativeListening) {\r\n      stopNativeRecognition();\r\n      return transcript;\r\n    } else {\r\n      return await mediaRecorderHook.stopRecording();\r\n    }\r\n  }, [isNativeListening, stopNativeRecognition, transcript, mediaRecorderHook]);\r\n\r\n  const cancelRecording = useCallback(() => {\r\n    if (isNativeListening) {\r\n      stopNativeRecognition();\r\n    } else {\r\n      mediaRecorderHook.cancelRecording();\r\n    }\r\n  }, [isNativeListening, stopNativeRecognition, mediaRecorderHook]);\r\n\r\n  const isRecording = isNativeListening || mediaRecorderHook.isRecording;\r\n  const isProcessing = mediaRecorderHook.isProcessing;\r\n\r\n  return {\r\n    isRecording,\r\n    isProcessing,\r\n    isNativeListening,\r\n    transcript,\r\n    startRecording,\r\n    stopRecording,\r\n    cancelRecording,\r\n    isNativeSupported,\r\n    useNativeFirst,\r\n    setUseNativeFirst,\r\n    // Pass through MediaRecorder properties for compatibility\r\n    recordingDuration: mediaRecorderHook.recordingDuration,\r\n    maxRecordingTime: mediaRecorderHook.maxRecordingTime,\r\n    getRemainingTime: mediaRecorderHook.getRemainingTime,\r\n    getFormattedDuration: mediaRecorderHook.getFormattedDuration,\r\n    getFormattedRemainingTime: mediaRecorderHook.getFormattedRemainingTime\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useEnrolledCourses.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useEnrollmentProgress.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useExtractAlgebraZip.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useExtractLinearEquationsZip.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFileUpload.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFileUploadSubscription.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'initializeConnection'. Either include it or remove the dependency array.","line":64,"column":6,"nodeType":"ArrayExpression","endLine":64,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [initializeConnection]","fix":{"range":[2166,2168],"text":"[initializeConnection]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'cleanupConnection'. Either include it or remove the dependency array.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [cleanupConnection]","fix":{"range":[2533,2535],"text":"[cleanupConnection]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { RealtimeChannel } from '@supabase/supabase-js';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface FileUploadPayload {\r\n  new: {\r\n    id: string;\r\n    processing_status: string;\r\n    error_message?: string;\r\n    [key: string]: unknown;\r\n  };\r\n  old: Record<string, unknown>;\r\n}\r\n\r\ninterface FileUploadUpdatePayload {\r\n  new: Record<string, unknown>;\r\n  old: Record<string, unknown>;\r\n}\r\n\r\ninterface FileUploadUpdateHandler {\r\n  id: string;\r\n  handler: (payload: FileUploadUpdatePayload) => void;\r\n}\r\n\r\ninterface FileUploadSubscriptionService {\r\n  subscribe: (id: string, handler: (payload: FileUploadUpdatePayload) => void) => void;\r\n  unsubscribe: (id: string) => void;\r\n  isConnected: boolean;\r\n  startPolling: (uploadId: string, callback: (upload: Record<string, unknown>) => void) => void;\r\n  stopPolling: (uploadId: string) => void;\r\n}\r\n\r\nconst useFileUploadSubscription = (): FileUploadSubscriptionService => {\r\n  const cleanup = useCleanup('file-upload-subscription');\r\n  const { user } = useAuth();\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const handlersRef = useRef<FileUploadUpdateHandler[]>([]);\r\n  const mountedRef = useRef(true);\r\n  const channelRef = useRef<RealtimeChannel | null>(null);\r\n  const pollingIntervalsRef = useRef<Record<string, string>>({});\r\n\r\n  const subscribe = useCallback((id: string, handler: (payload: FileUploadUpdatePayload) => void) => {\r\n    if (!mountedRef.current) return;\r\n    \r\n    console.log(`ðŸ“¡ Subscribing handler: ${id}`);\r\n    \r\n    // Check if handler already exists\r\n    const existingHandler = handlersRef.current.find(h => h.id === id);\r\n    if (existingHandler) {\r\n      console.log(`ðŸ“¡ Handler ${id} already exists, updating`);\r\n      existingHandler.handler = handler;\r\n      return;\r\n    }\r\n    \r\n    // Add to local handlers\r\n    const newHandler = { id, handler };\r\n    handlersRef.current.push(newHandler);\r\n    \r\n    // Initialize connection if needed\r\n    initializeConnection();\r\n  }, []);\r\n\r\n  const unsubscribe = useCallback((id: string) => {\r\n    console.log(`ðŸ“¡ Unsubscribing handler: ${id}`);\r\n    \r\n    // Remove from local handlers\r\n    handlersRef.current = handlersRef.current.filter(h => h.id !== id);\r\n    \r\n    // Clean up connection if no handlers left\r\n    if (handlersRef.current.length === 0) {\r\n      cleanupConnection();\r\n    }\r\n  }, []);\r\n\r\n  const startPolling = useCallback((uploadId: string, callback: (upload: Record<string, unknown>) => void) => {\r\n    if (!mountedRef.current) return;\r\n    \r\n    console.log(`ðŸ”„ Starting polling for upload: ${uploadId}`);\r\n    \r\n    if (pollingIntervalsRef.current[uploadId]) {\r\n      cleanup.cleanup(pollingIntervalsRef.current[uploadId]);\r\n    }\r\n\r\n    const intervalId = cleanup.setInterval(async () => {\r\n      if (!mountedRef.current) {\r\n        cleanup.cleanup(pollingIntervalsRef.current[uploadId]);\r\n        delete pollingIntervalsRef.current[uploadId];\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('file_uploads')\r\n          .select('*')\r\n          .eq('id', uploadId)\r\n          .single();\r\n\r\n        if (error) {\r\n          console.error('âŒ Polling error:', error);\r\n          return;\r\n        }\r\n\r\n        if (data && (data.processing_status === 'completed' || data.processing_status === 'failed')) {\r\n          console.log(`âœ… Polling complete for ${uploadId}: ${data.processing_status}`);\r\n          callback(data);\r\n          cleanup.cleanup(pollingIntervalsRef.current[uploadId]);\r\n          delete pollingIntervalsRef.current[uploadId];\r\n        }\r\n      } catch (error) {\r\n        console.error('âŒ Polling fetch error:', error);\r\n      }\r\n    }, 3000);\r\n\r\n    pollingIntervalsRef.current[uploadId] = intervalId;\r\n\r\n    // Auto cleanup after 5 minutes\r\n    cleanup.setTimeout(() => {\r\n      if (pollingIntervalsRef.current[uploadId]) {\r\n        console.log(`â° Polling timeout for ${uploadId}`);\r\n        cleanup.cleanup(pollingIntervalsRef.current[uploadId]);\r\n        delete pollingIntervalsRef.current[uploadId];\r\n      }\r\n    }, 300000);\r\n  }, [cleanup]);\r\n\r\n  const stopPolling = useCallback((uploadId: string) => {\r\n    if (pollingIntervalsRef.current[uploadId]) {\r\n      console.log(`ðŸ›‘ Stopping polling for ${uploadId}`);\r\n      cleanup.cleanup(pollingIntervalsRef.current[uploadId]);\r\n      delete pollingIntervalsRef.current[uploadId];\r\n    }\r\n  }, [cleanup]);\r\n\r\n  const initializeConnection = useCallback(() => {\r\n    // Critical validation: ensure we have valid user ID before creating channels\r\n    if (!user?.id || typeof user.id !== 'string' || !mountedRef.current) {\r\n      console.warn('Invalid state for file upload subscription:', { userId: user?.id, mounted: mountedRef.current });\r\n      return;\r\n    }\r\n    \r\n    if (channelRef.current) {\r\n      console.log('ðŸ“¡ File upload subscription already exists, skipping initialization');\r\n      return; // Already have a connection\r\n    }\r\n\r\n    console.log('ðŸ“¡ Initializing file upload subscription connection');\r\n\r\n    try {\r\n      const channelName = `file-uploads-${user.id}`;\r\n      const channel = supabase\r\n        .channel(channelName)\r\n        .on(\r\n          'postgres_changes',\r\n          {\r\n            event: 'UPDATE',\r\n            schema: 'public',\r\n            table: 'file_uploads',\r\n            filter: `user_id=eq.${user.id}`\r\n          },\r\n          (payload) => {\r\n            if (!mountedRef.current) return;\r\n            \r\n            console.log('ðŸ“¡ Broadcasting file upload update to handlers:', payload);\r\n            \r\n            // Notify all registered handlers for this instance\r\n            handlersRef.current.forEach(({ id, handler }) => {\r\n              try {\r\n                handler(payload);\r\n              } catch (error) {\r\n                console.error(`ðŸ“¡ Error in handler ${id}:`, error);\r\n              }\r\n            });\r\n          }\r\n        );\r\n\r\n      channelRef.current = channel;\r\n\r\n      channel.subscribe((status) => {\r\n        if (status === 'SUBSCRIBED') {\r\n          console.log('âœ… File upload subscription connected');\r\n          if (mountedRef.current) {\r\n            setIsConnected(true);\r\n          }\r\n        } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT' || status === 'CLOSED') {\r\n          console.warn('âš ï¸ File upload connection status:', status);\r\n          if (mountedRef.current) {\r\n            setIsConnected(false);\r\n          }\r\n          \r\n          // Clean up the failed channel and use polling fallback\r\n          if (channelRef.current) {\r\n            try {\r\n              supabase.removeChannel(channelRef.current);\r\n            } catch (error) {\r\n              // Silently handle cleanup errors\r\n            }\r\n            channelRef.current = null;\r\n          }\r\n          \r\n          // Fallback: Start polling for all pending uploads\r\n          console.log('ðŸ”„ Falling back to polling mode for file uploads');\r\n          setTimeout(async () => {\r\n            if (!mountedRef.current || !user?.id) return;\r\n            \r\n            try {\r\n              const { data: pendingUploads } = await supabase\r\n                .from('file_uploads')\r\n                .select('*')\r\n                .eq('user_id', user.id)\r\n                .eq('processing_status', 'processing');\r\n\r\n              if (pendingUploads && mountedRef.current) {\r\n                pendingUploads.forEach(upload => {\r\n                  startPolling(upload.id, (updatedUpload) => {\r\n                    if (mountedRef.current) {\r\n                      handlersRef.current.forEach(({ handler }) => {\r\n                        try {\r\n                          handler({ new: updatedUpload, old: upload });\r\n                        } catch (error) {\r\n                          console.error('Error in polling handler:', error);\r\n                        }\r\n                      });\r\n                    }\r\n                  });\r\n                });\r\n              }\r\n            } catch (error) {\r\n              console.error('Error setting up polling fallback:', error);\r\n            }\r\n          }, 1000);\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error('Error initializing connection:', error);\r\n      if (mountedRef.current) {\r\n        setIsConnected(false);\r\n      }\r\n    }\r\n  }, [user?.id, startPolling]);\r\n\r\n  const cleanupConnection = useCallback(() => {\r\n    console.log('ðŸ“¡ Cleaning up file upload connection');\r\n    if (channelRef.current) {\r\n      try {\r\n        supabase.removeChannel(channelRef.current);\r\n      } catch (error) {\r\n        console.error('Error removing channel:', error);\r\n      }\r\n      channelRef.current = null;\r\n      if (mountedRef.current) {\r\n        setIsConnected(false);\r\n      }\r\n    }\r\n    \r\n    // Clean up all polling intervals\r\n    Object.keys(pollingIntervalsRef.current).forEach(uploadId => {\r\n      clearInterval(pollingIntervalsRef.current[uploadId]);\r\n      delete pollingIntervalsRef.current[uploadId];\r\n    });\r\n    pollingIntervalsRef.current = {};\r\n  }, []);\r\n\r\n  // Initialize connection when user changes\r\n  useEffect(() => {\r\n    mountedRef.current = true;\r\n    \r\n    return () => {\r\n      mountedRef.current = false;\r\n      cleanupConnection();\r\n    };\r\n  }, [cleanupConnection]);\r\n\r\n  // Separate effect for user-dependent initialization\r\n  useEffect(() => {\r\n    if (user?.id && mountedRef.current) {\r\n      initializeConnection();\r\n    }\r\n    \r\n    return () => {\r\n      // Cleanup on user change\r\n      if (channelRef.current) {\r\n        cleanupConnection();\r\n      }\r\n    };\r\n  }, [user?.id, initializeConnection, cleanupConnection]);\r\n\r\n  return {\r\n    subscribe,\r\n    unsubscribe,\r\n    isConnected,\r\n    startPolling,\r\n    stopPolling\r\n  };\r\n};\r\n\r\nexport { useFileUploadSubscription };\r\nexport type { FileUploadUpdatePayload };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFileUploads.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFirstVisitVideo.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFlashcardManager.ts","messages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":140,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":140,"endColumn":89,"suggestions":[{"messageId":"addBrackets","fix":{"range":[4888,5113],"text":"{ const aRate = a.times_reviewed > 0 ? (a.times_correct / a.times_reviewed) : 0;\r\n          const bRate = b.times_reviewed > 0 ? (b.times_correct / b.times_reviewed) : 0;\r\n          comparison = aRate - bRate;\r\n          break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":141,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":141,"endColumn":89,"suggestions":[{"messageId":"addBrackets","fix":{"range":[4888,5113],"text":"{ const aRate = a.times_reviewed > 0 ? (a.times_correct / a.times_reviewed) : 0;\r\n          const bRate = b.times_reviewed > 0 ? (b.times_correct / b.times_reviewed) : 0;\r\n          comparison = aRate - bRate;\r\n          break; }"},"desc":"Add {} brackets around the case block."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect } from 'react';\r\nimport { useFlashcards, type Flashcard } from '@/hooks/useFlashcards';\r\nimport { useFlashcardSets } from '@/hooks/useFlashcardSets';\r\nimport { analyzeFlashcardTopic } from '@/utils/flashcardTopicAnalyzer';\r\n\r\nexport interface FlashcardManagerState {\r\n  selectedCards: Set<string>;\r\n  searchTerm: string;\r\n  filterBy: 'all' | 'source' | 'difficulty' | 'performance' | 'recent';\r\n  filterValue: string;\r\n  viewMode: 'grid' | 'list';\r\n  sortBy: 'created' | 'difficulty' | 'performance' | 'alphabetical';\r\n  sortOrder: 'asc' | 'desc';\r\n  expandedFolders: Set<string>;\r\n  folderViewModes: Record<string, 'grid' | 'list'>;\r\n}\r\n\r\nconst RECENT_CARDS_MINUTES = 10; // Consider cards \"new\" for 10 minutes\r\n\r\nexport const useFlashcardManager = () => {\r\n  const { flashcards, deleteFlashcard, updateFlashcard, isLoading } = useFlashcards();\r\n  const { sets } = useFlashcardSets();\r\n  \r\n  const [state, setState] = useState<FlashcardManagerState>({\r\n    selectedCards: new Set(),\r\n    searchTerm: '',\r\n    filterBy: 'all',\r\n    filterValue: '',\r\n    viewMode: 'grid',\r\n    sortBy: 'created',\r\n    sortOrder: 'desc',\r\n    expandedFolders: new Set(),\r\n    folderViewModes: {}\r\n  });\r\n\r\n  // Track recently created cards\r\n  const recentCardIds = useMemo(() => {\r\n    const cutoffTime = new Date(Date.now() - RECENT_CARDS_MINUTES * 60 * 1000);\r\n    return flashcards\r\n      .filter(card => new Date(card.created_at) > cutoffTime)\r\n      .map(card => card.id);\r\n  }, [flashcards]);\r\n\r\n  // Auto-expand folders with recent cards\r\n  useEffect(() => {\r\n    if (recentCardIds.length > 0) {\r\n      console.log('ðŸ“Œ Found recent cards, auto-expanding relevant folders:', recentCardIds);\r\n      \r\n      // Find folders that contain recent cards\r\n      const foldersWithRecentCards = new Set<string>();\r\n      \r\n      recentCardIds.forEach(cardId => {\r\n        const card = flashcards.find(c => c.id === cardId);\r\n        if (card) {\r\n          const topicFolder = analyzeFlashcardTopic(\r\n            card.front_content, \r\n            card.back_content, \r\n            card.note_id,\r\n            card.created_at\r\n          );\r\n          foldersWithRecentCards.add(topicFolder);\r\n        }\r\n      });\r\n\r\n      if (foldersWithRecentCards.size > 0) {\r\n        setState(prev => ({\r\n          ...prev,\r\n          expandedFolders: new Set([...prev.expandedFolders, ...foldersWithRecentCards])\r\n        }));\r\n      }\r\n    }\r\n  }, [recentCardIds, flashcards]);\r\n\r\n  // Filter and search flashcards\r\n  const filteredFlashcards = useMemo(() => {\r\n    let filtered = [...flashcards];\r\n\r\n    // Apply search\r\n    if (state.searchTerm) {\r\n      const term = state.searchTerm.toLowerCase();\r\n      filtered = filtered.filter(card => \r\n        card.front_content.toLowerCase().includes(term) ||\r\n        card.back_content.toLowerCase().includes(term)\r\n      );\r\n    }\r\n\r\n    // Apply filters\r\n    if (state.filterBy !== 'all' && state.filterValue) {\r\n      switch (state.filterBy) {\r\n        case 'difficulty':\r\n          filtered = filtered.filter(card => \r\n            card.difficulty_level.toString() === state.filterValue\r\n          );\r\n          break;\r\n        case 'performance':\r\n          filtered = filtered.filter(card => {\r\n            const successRate = card.times_reviewed > 0 \r\n              ? (card.times_correct / card.times_reviewed) * 100 \r\n              : 0;\r\n            if (state.filterValue === 'high') return successRate >= 80;\r\n            if (state.filterValue === 'medium') return successRate >= 50 && successRate < 80;\r\n            if (state.filterValue === 'low') return successRate < 50;\r\n            return true;\r\n          });\r\n          break;\r\n        case 'source':\r\n          // Filter by source (note_id or upload source)\r\n          filtered = filtered.filter(card => {\r\n            if (state.filterValue === 'manual') return !card.note_id;\r\n            if (state.filterValue === 'notes') return !!card.note_id;\r\n            return true;\r\n          });\r\n          break;\r\n        case 'recent':\r\n          filtered = filtered.filter(card => recentCardIds.includes(card.id));\r\n          break;\r\n      }\r\n    }\r\n\r\n    // Apply sorting - prioritize recent cards\r\n    filtered.sort((a, b) => {\r\n      // Always put recent cards first\r\n      const aIsRecent = recentCardIds.includes(a.id);\r\n      const bIsRecent = recentCardIds.includes(b.id);\r\n      \r\n      if (aIsRecent && !bIsRecent) return -1;\r\n      if (!aIsRecent && bIsRecent) return 1;\r\n      \r\n      // Then apply normal sorting\r\n      let comparison = 0;\r\n      \r\n      switch (state.sortBy) {\r\n        case 'created':\r\n          comparison = new Date(a.created_at).getTime() - new Date(b.created_at).getTime();\r\n          break;\r\n        case 'difficulty':\r\n          comparison = a.difficulty_level - b.difficulty_level;\r\n          break;\r\n        case 'performance':\r\n          const aRate = a.times_reviewed > 0 ? (a.times_correct / a.times_reviewed) : 0;\r\n          const bRate = b.times_reviewed > 0 ? (b.times_correct / b.times_reviewed) : 0;\r\n          comparison = aRate - bRate;\r\n          break;\r\n        case 'alphabetical':\r\n          comparison = a.front_content.localeCompare(b.front_content);\r\n          break;\r\n      }\r\n      \r\n      return state.sortOrder === 'asc' ? comparison : -comparison;\r\n    });\r\n\r\n    return filtered;\r\n  }, [flashcards, state.searchTerm, state.filterBy, state.filterValue, state.sortBy, state.sortOrder, recentCardIds]);\r\n\r\n  // Group flashcards by automatically detected topics/sources - prioritize folders with recent cards\r\n  const groupedFlashcards = useMemo(() => {\r\n    const groups: Record<string, Flashcard[]> = {};\r\n    \r\n    filteredFlashcards.forEach(card => {\r\n      // Use the topic analyzer to determine the appropriate folder\r\n      const topicFolder = analyzeFlashcardTopic(\r\n        card.front_content, \r\n        card.back_content, \r\n        card.note_id,\r\n        card.created_at\r\n      );\r\n      \r\n      if (!groups[topicFolder]) {\r\n        groups[topicFolder] = [];\r\n      }\r\n      groups[topicFolder].push(card);\r\n    });\r\n    \r\n    // Sort groups by whether they contain recent cards, then by name\r\n    const sortedGroups: Record<string, Flashcard[]> = {};\r\n    Object.keys(groups)\r\n      .sort((a, b) => {\r\n        const aHasRecent = groups[a].some(card => recentCardIds.includes(card.id));\r\n        const bHasRecent = groups[b].some(card => recentCardIds.includes(card.id));\r\n        \r\n        if (aHasRecent && !bHasRecent) return -1;\r\n        if (!aHasRecent && bHasRecent) return 1;\r\n        \r\n        return a.localeCompare(b);\r\n      })\r\n      .forEach(key => {\r\n        sortedGroups[key] = groups[key];\r\n      });\r\n    \r\n    return sortedGroups;\r\n  }, [filteredFlashcards, recentCardIds]);\r\n\r\n  // Check if a card is recent\r\n  const isCardRecent = (cardId: string) => recentCardIds.includes(cardId);\r\n\r\n  // Check if a folder has recent cards\r\n  const folderHasRecentCards = (folderId: string) => {\r\n    const folderCards = groupedFlashcards[folderId] || [];\r\n    return folderCards.some(card => isCardRecent(card.id));\r\n  };\r\n\r\n  // Get recent card count for a folder\r\n  const getRecentCardCount = (folderId: string) => {\r\n    const folderCards = groupedFlashcards[folderId] || [];\r\n    return folderCards.filter(card => isCardRecent(card.id)).length;\r\n  };\r\n\r\n  // Folder management\r\n  const toggleFolder = (folderId: string) => {\r\n    setState(prev => {\r\n      const newExpanded = new Set(prev.expandedFolders);\r\n      if (newExpanded.has(folderId)) {\r\n        newExpanded.delete(folderId);\r\n      } else {\r\n        newExpanded.add(folderId);\r\n      }\r\n      return { ...prev, expandedFolders: newExpanded };\r\n    });\r\n  };\r\n\r\n  const toggleFolderViewMode = (folderId: string) => {\r\n    setState(prev => ({\r\n      ...prev,\r\n      folderViewModes: {\r\n        ...prev.folderViewModes,\r\n        [folderId]: prev.folderViewModes[folderId] === 'grid' ? 'list' : 'grid'\r\n      }\r\n    }));\r\n  };\r\n\r\n  const selectAllInFolder = (folderId: string) => {\r\n    const folderCards = groupedFlashcards[folderId] || [];\r\n    setState(prev => {\r\n      const newSelected = new Set(prev.selectedCards);\r\n      const allSelected = folderCards.every(card => newSelected.has(card.id));\r\n      \r\n      if (allSelected) {\r\n        // Deselect all in folder\r\n        folderCards.forEach(card => newSelected.delete(card.id));\r\n      } else {\r\n        // Select all in folder\r\n        folderCards.forEach(card => newSelected.add(card.id));\r\n      }\r\n      \r\n      return { ...prev, selectedCards: newSelected };\r\n    });\r\n  };\r\n\r\n  const bulkFolderAction = async (folderId: string, action: 'delete' | 'archive') => {\r\n    const folderCards = groupedFlashcards[folderId] || [];\r\n    \r\n    if (action === 'delete') {\r\n      const promises = folderCards.map(card => deleteFlashcard(card.id));\r\n      await Promise.all(promises);\r\n    } else if (action === 'archive') {\r\n      const promises = folderCards.map(card => \r\n        updateFlashcard({ id: card.id, difficulty_level: 0 }) // Use difficulty 0 as archived\r\n      );\r\n      await Promise.all(promises);\r\n    }\r\n    \r\n    // Clear selections for this folder\r\n    setState(prev => {\r\n      const newSelected = new Set(prev.selectedCards);\r\n      folderCards.forEach(card => newSelected.delete(card.id));\r\n      return { ...prev, selectedCards: newSelected };\r\n    });\r\n  };\r\n\r\n  // Selection management\r\n  const toggleCardSelection = (cardId: string) => {\r\n    setState(prev => {\r\n      const newSelected = new Set(prev.selectedCards);\r\n      if (newSelected.has(cardId)) {\r\n        newSelected.delete(cardId);\r\n      } else {\r\n        newSelected.add(cardId);\r\n      }\r\n      return { ...prev, selectedCards: newSelected };\r\n    });\r\n  };\r\n\r\n  const selectAllCards = () => {\r\n    setState(prev => ({\r\n      ...prev,\r\n      selectedCards: new Set(filteredFlashcards.map(card => card.id))\r\n    }));\r\n  };\r\n\r\n  const clearSelection = () => {\r\n    setState(prev => ({\r\n      ...prev,\r\n      selectedCards: new Set()\r\n    }));\r\n  };\r\n\r\n  // Batch operations\r\n  const bulkDeleteCards = async () => {\r\n    const promises = Array.from(state.selectedCards).map(cardId => \r\n      deleteFlashcard(cardId)\r\n    );\r\n    await Promise.all(promises);\r\n    clearSelection();\r\n  };\r\n\r\n  const bulkArchiveCards = async () => {\r\n    const promises = Array.from(state.selectedCards).map(cardId => \r\n      updateFlashcard({ id: cardId, difficulty_level: 0 }) // Use difficulty 0 as archived\r\n    );\r\n    await Promise.all(promises);\r\n    clearSelection();\r\n  };\r\n\r\n  // State updates\r\n  const updateState = (updates: Partial<FlashcardManagerState>) => {\r\n    setState(prev => ({ ...prev, ...updates }));\r\n  };\r\n\r\n  return {\r\n    state,\r\n    updateState,\r\n    filteredFlashcards,\r\n    groupedFlashcards,\r\n    selectedCards: Array.from(state.selectedCards),\r\n    selectedCount: state.selectedCards.size,\r\n    totalCount: filteredFlashcards.length,\r\n    recentCardIds,\r\n    recentCardCount: recentCardIds.length,\r\n    isLoading,\r\n    isCardRecent,\r\n    folderHasRecentCards,\r\n    getRecentCardCount,\r\n    toggleCardSelection,\r\n    selectAllCards,\r\n    clearSelection,\r\n    bulkDeleteCards,\r\n    bulkArchiveCards,\r\n    // Folder-specific methods\r\n    toggleFolder,\r\n    toggleFolderViewMode,\r\n    selectAllInFolder,\r\n    bulkFolderAction,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFlashcardPreview.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFlashcardSets.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useFlashcards.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useGamification.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'fetchUserStats' and 'toast'. Either include them or remove the dependency array.","line":122,"column":6,"nodeType":"ArrayExpression","endLine":122,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [user?.id, isProcessing, toast, fetchUserStats]","fix":{"range":[3114,3138],"text":"[user?.id, isProcessing, toast, fetchUserStats]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'toast'. Either include it or remove the dependency array.","line":186,"column":6,"nodeType":"ArrayExpression","endLine":186,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [user?.id, fetchUserStats, toast]","fix":{"range":[4808,4834],"text":"[user?.id, fetchUserStats, toast]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'toast'. Either include it or remove the dependency array.","line":226,"column":6,"nodeType":"ArrayExpression","endLine":226,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [user?.id, toast, fetchUserStats]","fix":{"range":[5830,5856],"text":"[user?.id, toast, fetchUserStats]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface BadgeItem {\r\n  id: string;\r\n  badge_id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  criteria: Record<string, unknown>;\r\n  rarity: string;\r\n  xp_reward: number;\r\n  awarded_at?: string;\r\n}\r\n\r\ninterface Streak {\r\n  id: string;\r\n  user_id: string;\r\n  streak_type: string;\r\n  current_count: number;\r\n  max_count: number;\r\n  best_count: number;\r\n  last_activity: string;\r\n  start_date: string;\r\n  last_activity_date: string;\r\n  created_at: string;\r\n}\r\n\r\ninterface XPResponse {\r\n  success: boolean;\r\n  xp_awarded: number;\r\n  total_xp: number;\r\n  level: number;\r\n  xp_to_next: number;\r\n  leveled_up: boolean;\r\n  multiplier: number;\r\n  new_badges: BadgeItem[];\r\n}\r\n\r\ninterface UserStats {\r\n  xp: {\r\n    total_xp: number;\r\n    level: number;\r\n    next_level_xp: number;\r\n  };\r\n  badges: BadgeItem[];\r\n  streaks: Streak[];\r\n}\r\n\r\nexport function useGamification() {\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [userStats, setUserStats] = useState<UserStats | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n\r\n  const awardXP = useCallback(async (eventType: string, eventValue: number, metadata?: Record<string, unknown>) => {\r\n    if (!user?.id || isProcessing) return;\r\n\r\n    setIsProcessing(true);\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-system', {\r\n        body: {\r\n          action: 'award_xp',\r\n          event_type: eventType,\r\n          event_value: eventValue,\r\n          metadata\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      const response = data as XPResponse;\r\n\r\n      // Show XP notification\r\n      let xpMessage = `+${response.xp_awarded} XP`;\r\n      if (response.multiplier > 1) {\r\n        xpMessage += ` (${response.multiplier}x multiplier!)`;\r\n      }\r\n\r\n      toast({\r\n        title: xpMessage,\r\n        description: `Total XP: ${response.total_xp} | Level ${response.level}`,\r\n        duration: 3000,\r\n      });\r\n\r\n      // Show level up notification\r\n      if (response.leveled_up) {\r\n        toast({\r\n          title: `ðŸŽ‰ Level Up!`,\r\n          description: `Congratulations! You reached Level ${response.level}!`,\r\n          duration: 5000,\r\n        });\r\n      }\r\n\r\n      // Show badge notifications\r\n      response.new_badges.forEach(badge => {\r\n        toast({\r\n          title: `ðŸ† Badge Unlocked!`,\r\n          description: `${badge.icon} ${badge.name}: ${badge.description}`,\r\n          duration: 4000,\r\n        });\r\n      });\r\n\r\n      // Refresh user stats\r\n      await fetchUserStats();\r\n\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Failed to award XP:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to award XP. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  }, [user?.id, isProcessing]);\r\n\r\n  const fetchUserStats = useCallback(async () => {\r\n    if (!user?.id) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-system', {\r\n        body: { action: 'get_user_stats' }\r\n      });\r\n\r\n      if (error) throw error;\r\n      setUserStats(data);\r\n    } catch (error) {\r\n      console.error('Failed to fetch user stats:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const updateStreak = useCallback(async (streakType: string) => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-system', {\r\n        body: {\r\n          action: 'update_streak',\r\n          streak_type: streakType\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n      \r\n      await fetchUserStats();\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to update streak:', error);\r\n    }\r\n  }, [user?.id, fetchUserStats]);\r\n\r\n  const checkBadges = useCallback(async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-system', {\r\n        body: { action: 'check_badges' }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      // Show notifications for new badges\r\n      data.newBadges?.forEach((badge: BadgeItem) => {\r\n        toast({\r\n          title: `ðŸ† Badge Unlocked!`,\r\n          description: `${badge.icon} ${badge.name}: ${badge.description}`,\r\n          duration: 4000,\r\n        });\r\n      });\r\n\r\n      await fetchUserStats();\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to check badges:', error);\r\n    }\r\n  }, [user?.id, fetchUserStats]);\r\n\r\n  const purchaseItem = useCallback(async (itemId: string) => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-system', {\r\n        body: {\r\n          action: 'purchase_item',\r\n          item_id: itemId\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      if (data.error) {\r\n        toast({\r\n          title: \"Purchase Failed\",\r\n          description: data.error,\r\n          variant: \"destructive\"\r\n        });\r\n        return null;\r\n      }\r\n\r\n      toast({\r\n        title: \"Purchase Successful!\",\r\n        description: `You bought ${data.item_purchased.name} for ${data.xp_spent} XP`,\r\n        duration: 3000,\r\n      });\r\n\r\n      await fetchUserStats();\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to purchase item:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to purchase item. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  }, [user?.id, fetchUserStats]);\r\n\r\n  return {\r\n    awardXP,\r\n    fetchUserStats,\r\n    updateStreak,\r\n    checkBadges,\r\n    purchaseItem,\r\n    userStats,\r\n    isLoading,\r\n    isProcessing\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useGlobalChat.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useGlobalTranslation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useGoalProgressTracking.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'checkOverdueGoals', 'updateReadingGoals', and 'updateStudyGoals'. Either include them or remove the dependency array.","line":158,"column":6,"nodeType":"ArrayExpression","endLine":158,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [checkOverdueGoals, goals.length, updateReadingGoals, updateStudyGoals, user.id]","fix":{"range":[5484,5508],"text":"[checkOverdueGoals, goals.length, updateReadingGoals, updateStudyGoals, user.id]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useEffect } from 'react';\r\nimport { useGoals } from '@/hooks/useGoals';\r\nimport { useNotificationTriggers } from '@/hooks/useNotificationTriggers';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nexport const useGoalProgressTracking = () => {\r\n  const { goals, updateGoal } = useGoals();\r\n  const { triggerGoalCompletion } = useNotificationTriggers();\r\n  const { user } = useAuth();\r\n\r\n  // Auto-update reading goals based on reading sessions\r\n  const updateReadingGoals = async () => {\r\n    if (!user?.id) return;\r\n\r\n    const readingGoals = goals.filter(goal => \r\n      goal.category === 'reading' && goal.status === 'active'\r\n    );\r\n\r\n    for (const goal of readingGoals) {\r\n      try {\r\n        // Get reading sessions for this week\r\n        const oneWeekAgo = new Date();\r\n        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\r\n\r\n        const { data: sessions } = await supabase\r\n          .from('reading_sessions')\r\n          .select('duration_seconds')\r\n          .eq('user_id', user.id)\r\n          .gte('session_start', oneWeekAgo.toISOString());\r\n\r\n        const totalMinutes = (sessions || []).reduce(\r\n          (sum, session) => sum + Math.round((session.duration_seconds || 0) / 60),\r\n          0\r\n        );\r\n\r\n        // Assume goal target is minutes per week (could be customized)\r\n        const targetMinutes = 420; // 7 hours per week default\r\n        const newProgress = Math.min(100, Math.round((totalMinutes / targetMinutes) * 100));\r\n\r\n        if (newProgress !== goal.progress) {\r\n          await updateGoal(goal.id, { progress: newProgress });\r\n\r\n          // Trigger milestone notifications\r\n          if (newProgress >= 25 && goal.progress < 25) {\r\n            await triggerGoalCompletion(goal.title, 25);\r\n          } else if (newProgress >= 50 && goal.progress < 50) {\r\n            await triggerGoalCompletion(goal.title, 50);\r\n          } else if (newProgress >= 75 && goal.progress < 75) {\r\n            await triggerGoalCompletion(goal.title, 75);\r\n          } else if (newProgress >= 100 && goal.progress < 100) {\r\n            await updateGoal(goal.id, { \r\n              progress: 100, \r\n              status: 'completed', \r\n              completed_at: new Date().toISOString() \r\n            });\r\n            await triggerGoalCompletion(goal.title, 100);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('âŒ Error updating reading goal progress:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Auto-update study goals based on study sessions\r\n  const updateStudyGoals = async () => {\r\n    if (!user?.id) return;\r\n\r\n    const studyGoals = goals.filter(goal => \r\n      goal.category === 'study' && goal.status === 'active'\r\n    );\r\n\r\n    for (const goal of studyGoals) {\r\n      try {\r\n        // Get study sessions for this week\r\n        const oneWeekAgo = new Date();\r\n        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\r\n\r\n        const { data: sessions } = await supabase\r\n          .from('study_sessions')\r\n          .select('session_duration_seconds, correct_answers, total_cards')\r\n          .eq('user_id', user.id)\r\n          .gte('created_at', oneWeekAgo.toISOString());\r\n\r\n        if (!sessions || sessions.length === 0) continue;\r\n\r\n        const totalHours = sessions.reduce(\r\n          (sum, session) => sum + ((session.session_duration_seconds || 0) / 3600),\r\n          0\r\n        );\r\n\r\n        const averageAccuracy = sessions.reduce(\r\n          (sum, session) => {\r\n            const accuracy = session.total_cards > 0 \r\n              ? (session.correct_answers || 0) / session.total_cards \r\n              : 0;\r\n            return sum + accuracy;\r\n          },\r\n          0\r\n        ) / sessions.length;\r\n\r\n        // Calculate progress based on study time and accuracy\r\n        const targetHours = 10; // 10 hours per week default\r\n        const timeProgress = Math.min(100, (totalHours / targetHours) * 100);\r\n        const accuracyBonus = averageAccuracy > 0.8 ? 20 : 0;\r\n        \r\n        const newProgress = Math.min(100, Math.round(timeProgress + accuracyBonus));\r\n\r\n        if (newProgress !== goal.progress) {\r\n          await updateGoal(goal.id, { progress: newProgress });\r\n\r\n          // Trigger milestone notifications\r\n          if (newProgress >= 100 && goal.progress < 100) {\r\n            await updateGoal(goal.id, { \r\n              progress: 100, \r\n              status: 'completed', \r\n              completed_at: new Date().toISOString() \r\n            });\r\n            await triggerGoalCompletion(goal.title, 100);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('âŒ Error updating study goal progress:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Check for overdue goals\r\n  const checkOverdueGoals = async () => {\r\n    const today = new Date();\r\n    const overdueGoals = goals.filter(goal => \r\n      goal.status === 'active' && \r\n      goal.target_date && \r\n      new Date(goal.target_date) < today\r\n    );\r\n\r\n    for (const goal of overdueGoals) {\r\n      if (goal.progress >= 100) {\r\n        await updateGoal(goal.id, { \r\n          status: 'completed', \r\n          completed_at: new Date().toISOString() \r\n        });\r\n      } else {\r\n        // Could trigger overdue notifications here\r\n        console.log(`Goal \"${goal.title}\" is overdue`);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (goals.length > 0) {\r\n      updateReadingGoals();\r\n      updateStudyGoals();\r\n      checkOverdueGoals();\r\n    }\r\n  }, [goals.length, user?.id]);\r\n\r\n  return {\r\n    updateReadingGoals,\r\n    updateStudyGoals,\r\n    checkOverdueGoals\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useGoalReminders.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchReminders'. Either include it or remove the dependency array.","line":152,"column":6,"nodeType":"ArrayExpression","endLine":152,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [fetchReminders, user.id]","fix":{"range":[4119,4129],"text":"[fetchReminders, user.id]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\nexport interface GoalReminder {\r\n  id: string;\r\n  user_id: string;\r\n  goal_id: string | null;\r\n  reminder_type: 'daily' | 'weekly' | 'custom' | 'deadline';\r\n  reminder_time: string | null;\r\n  reminder_days: number[] | null;\r\n  is_active: boolean;\r\n  message: string | null;\r\n  next_reminder_at: string | null;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface GoalReminderInsert {\r\n  goal_id?: string;\r\n  reminder_type: 'daily' | 'weekly' | 'custom' | 'deadline';\r\n  reminder_time?: string;\r\n  reminder_days?: number[];\r\n  is_active?: boolean;\r\n  message?: string;\r\n  next_reminder_at?: string;\r\n}\r\n\r\nexport const useGoalReminders = () => {\r\n  const { user } = useAuth();\r\n  const [reminders, setReminders] = useState<GoalReminder[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  const fetchReminders = async () => {\r\n    if (!user?.id) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('goal_reminders')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('âŒ Error fetching goal reminders:', error);\r\n        return;\r\n      }\r\n\r\n      // Type assertion to handle the database string types\r\n      setReminders((data || []).map(item => ({\r\n        ...item,\r\n        reminder_type: item.reminder_type as GoalReminder['reminder_type']\r\n      })) as GoalReminder[]);\r\n    } catch (err) {\r\n      console.error('âŒ Error in fetchReminders:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const createReminder = async (reminderData: GoalReminderInsert): Promise<GoalReminder | null> => {\r\n    if (!user?.id) return null;\r\n\r\n    try {\r\n      setSaving(true);\r\n      const { data, error } = await supabase\r\n        .from('goal_reminders')\r\n        .insert({\r\n          ...reminderData,\r\n          user_id: user.id,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('âŒ Error creating reminder:', error);\r\n        return null;\r\n      }\r\n\r\n      const newReminder = {\r\n        ...data,\r\n        reminder_type: data.reminder_type as GoalReminder['reminder_type']\r\n      } as GoalReminder;\r\n      setReminders(prev => [newReminder, ...prev]);\r\n      return newReminder;\r\n    } catch (err) {\r\n      console.error('âŒ Error in createReminder:', err);\r\n      return null;\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const updateReminder = async (id: string, updates: Partial<GoalReminderInsert>): Promise<void> => {\r\n    try {\r\n      setSaving(true);\r\n      const { data, error } = await supabase\r\n        .from('goal_reminders')\r\n        .update(updates)\r\n        .eq('id', id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('âŒ Error updating reminder:', error);\r\n        return;\r\n      }\r\n\r\n      const updatedReminder = {\r\n        ...data,\r\n        reminder_type: data.reminder_type as GoalReminder['reminder_type']\r\n      } as GoalReminder;\r\n      setReminders(prev => prev.map(reminder => \r\n        reminder.id === id ? updatedReminder : reminder\r\n      ));\r\n    } catch (err) {\r\n      console.error('âŒ Error in updateReminder:', err);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const deleteReminder = async (id: string): Promise<void> => {\r\n    try {\r\n      setSaving(true);\r\n      const { error } = await supabase\r\n        .from('goal_reminders')\r\n        .delete()\r\n        .eq('id', id);\r\n\r\n      if (error) {\r\n        console.error('âŒ Error deleting reminder:', error);\r\n        return;\r\n      }\r\n\r\n      setReminders(prev => prev.filter(reminder => reminder.id !== id));\r\n    } catch (err) {\r\n      console.error('âŒ Error in deleteReminder:', err);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchReminders();\r\n  }, [user?.id]);\r\n\r\n  return {\r\n    reminders,\r\n    loading,\r\n    saving,\r\n    createReminder,\r\n    updateReminder,\r\n    deleteReminder,\r\n    refetchReminders: fetchReminders\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useGoals.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'goalsManager'. Either include it or remove the dependency array.","line":281,"column":6,"nodeType":"ArrayExpression","endLine":281,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [goalsManager, user?.id]","fix":{"range":[9490,9500],"text":"[goalsManager, user?.id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'goalsManager'. Either include it or remove the dependency array.","line":325,"column":6,"nodeType":"ArrayExpression","endLine":325,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [goalsManager, user.id]","fix":{"range":[10801,10811],"text":"[goalsManager, user.id]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport type { Goal, GoalInsert, GoalUpdate } from '@/types/goals';\r\n\r\n// Singleton class to manage goals data globally\r\nclass GoalsManager {\r\n  private static instance: GoalsManager;\r\n  private goals: Goal[] = [];\r\n  private loading: boolean = false;\r\n  private loadingPromise: Promise<Goal[]> | null = null;\r\n  private error: string | null = null;\r\n  private subscribers: Set<(goals: Goal[], loading: boolean, error: string | null) => void> = new Set();\r\n  private userId: string | null = null;\r\n  private hasLoadedOnce: boolean = false;\r\n\r\n  private constructor() {}\r\n\r\n  static getInstance(): GoalsManager {\r\n    if (!GoalsManager.instance) {\r\n      GoalsManager.instance = new GoalsManager();\r\n    }\r\n    return GoalsManager.instance;\r\n  }\r\n\r\n  subscribe(\r\n    userId: string | undefined,\r\n    callback: (goals: Goal[], loading: boolean, error: string | null) => void\r\n  ) {\r\n    this.subscribers.add(callback);\r\n    \r\n    // If user changed, reset state\r\n    if (this.userId !== userId) {\r\n      console.log('ðŸŽ¯ GoalsManager: User changed from', this.userId, 'to', userId);\r\n      this.userId = userId || null;\r\n      this.goals = [];\r\n      this.loading = false;\r\n      this.error = null;\r\n      this.loadingPromise = null;\r\n      this.hasLoadedOnce = false;\r\n    }\r\n\r\n    // Immediately notify with current state\r\n    callback(this.goals, this.loading, this.error);\r\n    \r\n    // Only load goals if we need to (haven't loaded once, not currently loading, and have user)\r\n    if (userId && this.userId === userId && !this.hasLoadedOnce && !this.loading && !this.loadingPromise) {\r\n      console.log('ðŸŽ¯ GoalsManager: Initiating goals load for user:', userId);\r\n      this.loadGoals(userId);\r\n    }\r\n    \r\n    return () => {\r\n      this.subscribers.delete(callback);\r\n    };\r\n  }\r\n\r\n  private notify() {\r\n    this.subscribers.forEach(callback => {\r\n      callback(this.goals, this.loading, this.error);\r\n    });\r\n  }\r\n\r\n  async loadGoals(userId: string, retryCount = 0): Promise<Goal[]> {\r\n    // Prevent multiple simultaneous loads for the same user\r\n    if (this.loadingPromise && this.userId === userId) {\r\n      return this.loadingPromise;\r\n    }\r\n\r\n    // If we have already loaded for this user, return cached data\r\n    if (this.userId === userId && this.hasLoadedOnce && !this.error) {\r\n      console.log('ðŸŽ¯ GoalsManager: Using cached goals:', this.goals.length);\r\n      return this.goals;\r\n    }\r\n\r\n    // Only set loading if we're not already loading\r\n    if (!this.loading) {\r\n      this.loading = true;\r\n      this.error = null;\r\n      this.notify();\r\n    }\r\n\r\n    this.loadingPromise = this.fetchGoals(userId, retryCount);\r\n    const result = await this.loadingPromise;\r\n    \r\n    this.loading = false;\r\n    this.loadingPromise = null;\r\n    this.hasLoadedOnce = true;\r\n    this.notify();\r\n    \r\n    return result;\r\n  }\r\n\r\n  private async fetchGoals(userId: string, retryCount = 0): Promise<Goal[]> {\r\n    try {\r\n      console.log('ðŸŽ¯ GoalsManager: Fetching goals for user:', userId, retryCount > 0 ? `(retry ${retryCount})` : '');\r\n      \r\n      // Check if we have a valid session before making the request\r\n      const { data: { session } } = await supabase.auth.getSession();\r\n      console.log('ðŸ” GoalsManager: Current session state:', { \r\n        hasSession: !!session, \r\n        userId: session?.user?.id, \r\n        targetUserId: userId \r\n      });\r\n      \r\n      if (!session || !session.user) {\r\n        console.error('âŒ GoalsManager: No valid session found');\r\n        this.error = 'Authentication required. Please log in again.';\r\n        return [];\r\n      }\r\n      \r\n      if (session.user.id !== userId) {\r\n        console.error('âŒ GoalsManager: Session user ID does not match target user ID');\r\n        this.error = 'Authentication mismatch. Please log in again.';\r\n        return [];\r\n      }\r\n      \r\n      const { data, error } = await supabase\r\n        .from('goals')\r\n        .select('*')\r\n        .eq('user_id', userId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('âŒ GoalsManager: Error fetching goals:', error);\r\n        \r\n        // Check if it's an authentication error\r\n        if (error.code === 'PGRST301' || error.message.includes('JWT') || error.message.includes('auth')) {\r\n          this.error = 'Authentication expired. Please log in again.';\r\n          return [];\r\n        }\r\n        \r\n        // Retry logic for network failures\r\n        if (retryCount < 2 && (error.message.includes('Failed to fetch') || error.message.includes('network'))) {\r\n          console.log(`ðŸ”„ GoalsManager: Retrying goals fetch in ${(retryCount + 1) * 1000}ms...`);\r\n          await new Promise(resolve => setTimeout(resolve, (retryCount + 1) * 1000));\r\n          return this.fetchGoals(userId, retryCount + 1);\r\n        }\r\n        \r\n        this.error = error.message;\r\n        return [];\r\n      }\r\n\r\n      console.log('ðŸŽ¯ GoalsManager: Fetched goals:', data?.length || 0, data);\r\n      \r\n      // Type assertion to handle the database string types\r\n      const validatedGoals = (data || []).map(goal => ({\r\n        ...goal,\r\n        status: goal.status || 'active',\r\n        progress: goal.progress || 0,\r\n        category: goal.category || 'general'\r\n      })) as Goal[];\r\n      \r\n      this.goals = validatedGoals;\r\n      this.error = null;\r\n      return validatedGoals;\r\n    } catch (err) {\r\n      console.error('âŒ GoalsManager: Error in fetchGoals:', err);\r\n      \r\n      // Retry for network errors\r\n      if (retryCount < 2) {\r\n        console.log(`ðŸ”„ GoalsManager: Retrying goals fetch due to network error in ${(retryCount + 1) * 1000}ms...`);\r\n        await new Promise(resolve => setTimeout(resolve, (retryCount + 1) * 1000));\r\n        return this.fetchGoals(userId, retryCount + 1);\r\n      }\r\n      \r\n      this.error = 'Failed to fetch goals';\r\n      return [];\r\n    }\r\n  }\r\n\r\n\r\n  async createGoal(userId: string, goalData: Omit<GoalInsert, 'user_id'>): Promise<Goal | null> {\r\n    try {\r\n      // Check session before creating goal\r\n      const { data: { session } } = await supabase.auth.getSession();\r\n      console.log('ðŸ” GoalsManager: Creating goal with session:', { \r\n        hasSession: !!session, \r\n        userId: session?.user?.id, \r\n        targetUserId: userId \r\n      });\r\n      \r\n      if (!session || !session.user) {\r\n        console.error('âŒ GoalsManager: No valid session for goal creation');\r\n        throw new Error('Authentication required. Please log in again.');\r\n      }\r\n      \r\n      if (session.user.id !== userId) {\r\n        console.error('âŒ GoalsManager: Session user ID does not match target user ID');\r\n        throw new Error('Authentication mismatch. Please log in again.');\r\n      }\r\n      \r\n      const { data, error } = await supabase\r\n        .from('goals')\r\n        .insert({\r\n          ...goalData,\r\n          user_id: userId,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('âŒ GoalsManager: Error creating goal:', error);\r\n        \r\n        // Check if it's an authentication error\r\n        if (error.code === 'PGRST301' || error.message.includes('JWT') || error.message.includes('auth')) {\r\n          throw new Error('Authentication expired. Please log in again.');\r\n        }\r\n        \r\n        throw new Error(error.message);\r\n      }\r\n\r\n      const newGoal = data as Goal;\r\n      this.goals = [newGoal, ...this.goals];\r\n      this.notify();\r\n      return newGoal;\r\n    } catch (err) {\r\n      console.error('âŒ GoalsManager: Error in createGoal:', err);\r\n      throw err; // Re-throw to allow proper error handling in components\r\n    }\r\n  }\r\n\r\n  async updateGoal(id: string, updates: GoalUpdate): Promise<void> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('goals')\r\n        .update(updates)\r\n        .eq('id', id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('âŒ GoalsManager: Error updating goal:', error);\r\n        return;\r\n      }\r\n\r\n      const updatedGoal = data as Goal;\r\n      this.goals = this.goals.map(goal => goal.id === id ? updatedGoal : goal);\r\n      this.notify();\r\n    } catch (err) {\r\n      console.error('âŒ GoalsManager: Error in updateGoal:', err);\r\n    }\r\n  }\r\n\r\n  async deleteGoal(id: string): Promise<void> {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('goals')\r\n        .delete()\r\n        .eq('id', id);\r\n\r\n      if (error) {\r\n        console.error('âŒ GoalsManager: Error deleting goal:', error);\r\n        return;\r\n      }\r\n\r\n      this.goals = this.goals.filter(goal => goal.id !== id);\r\n      this.notify();\r\n    } catch (err) {\r\n      console.error('âŒ GoalsManager: Error in deleteGoal:', err);\r\n    }\r\n  }\r\n}\r\n\r\nexport const useGoals = () => {\r\n  const { user } = useAuth();\r\n  const [goals, setGoals] = useState<Goal[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const goalsManager = GoalsManager.getInstance();\r\n\r\n  useEffect(() => {\r\n    // Subscribe to goals changes\r\n    const unsubscribe = goalsManager.subscribe(user?.id, (newGoals, isLoading, errorMessage) => {\r\n      setGoals(newGoals);\r\n      setLoading(isLoading);\r\n      setError(errorMessage);\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [user?.id]);\r\n\r\n  const createGoal = async (goalData: Omit<GoalInsert, 'user_id'>): Promise<Goal | null> => {\r\n    if (!user?.id) {\r\n      setError('Authentication required. Please log in again.');\r\n      return null;\r\n    }\r\n\r\n    setSaving(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const result = await goalsManager.createGoal(user.id, goalData);\r\n      setSaving(false);\r\n      return result;\r\n    } catch (err) {\r\n      setSaving(false);\r\n      const errorMessage = err instanceof Error ? err.message : 'Failed to create goal';\r\n      setError(errorMessage);\r\n      throw err; // Re-throw to allow component error handling\r\n    }\r\n  };\r\n\r\n  const updateGoal = async (id: string, updates: GoalUpdate): Promise<void> => {\r\n    setSaving(true);\r\n    await goalsManager.updateGoal(id, updates);\r\n    setSaving(false);\r\n  };\r\n\r\n  const deleteGoal = async (id: string): Promise<void> => {\r\n    setSaving(true);\r\n    await goalsManager.deleteGoal(id);\r\n    setSaving(false);\r\n  };\r\n\r\n  const completeGoal = async (id: string): Promise<void> => {\r\n    await updateGoal(id, { status: 'completed', completed_at: new Date().toISOString() });\r\n  };\r\n\r\n  const refetchGoals = useCallback(() => {\r\n    if (user?.id) {\r\n      return goalsManager.loadGoals(user.id);\r\n    }\r\n    return Promise.resolve([]);\r\n  }, [user?.id]);\r\n\r\n  return {\r\n    goals,\r\n    loading,\r\n    saving,\r\n    error,\r\n    createGoal,\r\n    updateGoal,\r\n    completeGoal,\r\n    deleteGoal,\r\n    refetch: refetchGoals\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useGoogleCalendarSync.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":107,"column":6,"nodeType":"ArrayExpression","endLine":107,"endColumn":53,"suggestions":[{"desc":"Update the dependencies array to be: [session.access_token, toast, cleanup, checkConnection]","fix":{"range":[3182,3229],"text":"[session.access_token, toast, cleanup, checkConnection]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface SyncResult {\r\n  goalId: string;\r\n  status: 'created' | 'updated' | 'error';\r\n  eventId?: string;\r\n  error?: string;\r\n}\r\n\r\ninterface Goal {\r\n  id: string;\r\n  title: string;\r\n  target_date?: string | null;\r\n  description?: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\nexport function useGoogleCalendarSync() {\r\n  const cleanup = useCleanup('google-calendar-sync');\r\n  const { session } = useAuth();\r\n  const { toast } = useToast();\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n  const [isSyncing, setIsSyncing] = useState(false);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n\r\n  const checkConnection = useCallback(async () => {\r\n    if (!session?.user) return false;\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('google_oauth_tokens')\r\n        .select('id')\r\n        .eq('user_id', session.user.id)\r\n        .single();\r\n\r\n      const connected = !error && !!data;\r\n      setIsConnected(connected);\r\n      return connected;\r\n    } catch (error) {\r\n      console.error('Error checking Google Calendar connection:', error);\r\n      return false;\r\n    }\r\n  }, [session?.user]);\r\n\r\n  const connectCalendar = useCallback(async () => {\r\n    if (!session?.access_token) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Please log in to connect Google Calendar\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsConnecting(true);\r\n    \r\n    try {\r\n      // Get OAuth URL\r\n      const { data, error } = await supabase.functions.invoke('google-calendar-sync', {\r\n        body: { action: 'get-auth-url' },\r\n        headers: {\r\n          Authorization: `Bearer ${session.access_token}`,\r\n        },\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      // Open OAuth flow in new window\r\n      const popup = window.open(\r\n        data.authUrl,\r\n        'google-oauth',\r\n        'width=500,height=600,scrollbars=yes,resizable=yes'\r\n      );\r\n\r\n      // Listen for OAuth completion using cleanupManager\r\n      const checkClosedId = cleanup.setInterval(() => {\r\n        if (popup?.closed) {\r\n          cleanup.cleanup(checkClosedId);\r\n          // Check if connection was successful\r\n          cleanup.setTimeout(async () => {\r\n            const connected = await checkConnection();\r\n            if (connected) {\r\n              toast({\r\n                title: \"Success!\",\r\n                description: \"Google Calendar connected successfully\",\r\n              });\r\n            }\r\n            setIsConnecting(false);\r\n          }, 1000);\r\n        }\r\n      }, 1000);\r\n\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : \"Failed to connect Google Calendar\";\r\n      console.error('Error connecting Google Calendar:', error);\r\n      toast({\r\n        title: \"Connection Failed\",\r\n        description: errorMessage,\r\n        variant: \"destructive\",\r\n      });\r\n      setIsConnecting(false);\r\n    }\r\n  }, [session?.access_token, toast, checkConnection]);\r\n\r\n  const disconnectCalendar = useCallback(async () => {\r\n    if (!session?.access_token) return;\r\n\r\n    try {\r\n      const { error } = await supabase.functions.invoke('google-calendar-sync', {\r\n        body: { action: 'disconnect' },\r\n        headers: {\r\n          Authorization: `Bearer ${session.access_token}`,\r\n        },\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      setIsConnected(false);\r\n      toast({\r\n        title: \"Disconnected\",\r\n        description: \"Google Calendar has been disconnected\",\r\n      });\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : \"Failed to disconnect Google Calendar\";\r\n      console.error('Error disconnecting Google Calendar:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: errorMessage,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  }, [session?.access_token, toast]);\r\n\r\n  const syncGoals = useCallback(async (goals: Goal[]) => {\r\n    if (!session?.access_token) return;\r\n\r\n    setIsSyncing(true);\r\n    \r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('google-calendar-sync', {\r\n        body: { \r\n          action: 'sync-goals',\r\n          goals: goals.filter(goal => goal.target_date) // Only sync goals with target dates\r\n        },\r\n        headers: {\r\n          Authorization: `Bearer ${session.access_token}`,\r\n        },\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      const results: SyncResult[] = data.syncResults;\r\n      const successCount = results.filter(r => r.status !== 'error').length;\r\n      const errorCount = results.filter(r => r.status === 'error').length;\r\n\r\n      if (successCount > 0) {\r\n        toast({\r\n          title: \"Sync Complete\",\r\n          description: `${successCount} goal(s) synced to Google Calendar${errorCount > 0 ? ` (${errorCount} failed)` : ''}`,\r\n        });\r\n      }\r\n\r\n      if (errorCount > 0) {\r\n        console.error('Sync errors:', results.filter(r => r.status === 'error'));\r\n      }\r\n\r\n      return results;\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : \"Failed to sync goals to Google Calendar\";\r\n      console.error('Error syncing goals:', error);\r\n      toast({\r\n        title: \"Sync Failed\",\r\n        description: errorMessage,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsSyncing(false);\r\n    }\r\n  }, [session?.access_token, toast]);\r\n\r\n  return {\r\n    isConnected,\r\n    isConnecting,\r\n    isSyncing,\r\n    connectCalendar,\r\n    disconnectCalendar,\r\n    syncGoals,\r\n    checkConnection,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useInteractiveCourseAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useInteractiveCourseEnrollmentBridge.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1975,1978],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1975,1978],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'migrateEnrollmentData'. Either include it or remove the dependency array.","line":104,"column":6,"nodeType":"ArrayExpression","endLine":104,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [migrateEnrollmentData, user?.id]","fix":{"range":[3812,3822],"text":"[migrateEnrollmentData, user?.id]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\n/**\r\n * Hook to bridge old enrollment system with new interactive course analytics\r\n * This ensures backward compatibility and data migration\r\n */\r\nexport const useInteractiveCourseEnrollmentBridge = () => {\r\n  const { user } = useAuth();\r\n\r\n  const migrateEnrollmentData = async () => {\r\n    if (!user?.id) return;\r\n\r\n    console.log('ðŸ”„ Starting enrollment migration for user:', user.id);\r\n\r\n    try {\r\n      // Add timeout protection for migration\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), 15000); // 15s timeout\r\n\r\n      // Get existing enrollments for interactive courses\r\n      const { data: existingEnrollments } = await supabase\r\n        .from('enrollments')\r\n        .select('course_id, enrolled_at, progress')\r\n        .eq('user_id', user.id)\r\n        .in('course_id', ['economics-101', 'algebra-basics', 'trigonometry-fundamentals', 'linear-equations']);\r\n\r\n      if (!existingEnrollments?.length) {\r\n        console.log('âœ… No existing enrollments to migrate');\r\n        clearTimeout(timeoutId);\r\n        return;\r\n      }\r\n\r\n      // Check which ones don't exist in the new system\r\n      const { data: interactiveEnrollments } = await supabase\r\n        .from('interactive_course_enrollments')\r\n        .select('course_id')\r\n        .eq('user_id', user.id);\r\n\r\n      const existingInteractiveCourseIds = new Set(\r\n        interactiveEnrollments?.map(e => e.course_id) || []\r\n      );\r\n\r\n      // Migrate missing enrollments\r\n      const enrollmentsToMigrate = existingEnrollments.filter(\r\n        enrollment => !existingInteractiveCourseIds.has(enrollment.course_id)\r\n      );\r\n\r\n      if (enrollmentsToMigrate.length > 0) {\r\n        const migratedEnrollments = enrollmentsToMigrate.map(enrollment => {\r\n          const progress = enrollment.progress as any;\r\n          const completionPercentage = progress?.completion_percentage || 0;\r\n          return {\r\n            user_id: user.id,\r\n            course_id: enrollment.course_id,\r\n            course_title: getCourseTitle(enrollment.course_id),\r\n            enrolled_at: enrollment.enrolled_at,\r\n            last_accessed_at: new Date().toISOString(),\r\n            completion_percentage: completionPercentage,\r\n            completed_at: completionPercentage >= 100 ? new Date().toISOString() : null,\r\n            total_time_spent_minutes: 0 // Will be updated as user progresses\r\n          };\r\n        });\r\n\r\n        const { error } = await supabase\r\n          .from('interactive_course_enrollments')\r\n          .insert(migratedEnrollments);\r\n\r\n        if (error) {\r\n          console.error('âŒ Error migrating enrollment data:', error);\r\n        } else {\r\n          console.log('âœ… Successfully migrated enrollment data for', migratedEnrollments.length, 'courses');\r\n        }\r\n      } else {\r\n        console.log('âœ… All enrollments already migrated');\r\n      }\r\n\r\n      clearTimeout(timeoutId);\r\n    } catch (error) {\r\n      console.error('âŒ Error in enrollment bridge:', error);\r\n    }\r\n  };\r\n\r\n  const getCourseTitle = (courseId: string): string => {\r\n    const titles: Record<string, string> = {\r\n      'economics-101': 'Introduction to Modern Economics',\r\n      'algebra-basics': 'Algebra Fundamentals',\r\n      'trigonometry-fundamentals': 'Trigonometry Fundamentals',\r\n      'linear-equations': 'Linear Equations Mastery'\r\n    };\r\n    return titles[courseId] || courseId;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      // Debounce migration to prevent multiple calls\r\n      const timeoutId = setTimeout(() => {\r\n        migrateEnrollmentData();\r\n      }, 1000);\r\n\r\n      return () => clearTimeout(timeoutId);\r\n    }\r\n  }, [user?.id]); // Fixed dependency\r\n\r\n  return { migrateEnrollmentData };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useInteractiveCourseProgress.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useKnowledgeBaseFiles.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useKnowledgeBaseUsage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLanguageConsistency.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLearningAnalytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[623,626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[623,626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2071,2074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2071,2074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":265,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9537,9540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9537,9540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":269,"column":131,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":269,"endColumn":134,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9783,9786],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9783,9786],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":273,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":273,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9996,9999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9996,9999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10182,10185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10182,10185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":281,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10380,10383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10380,10383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":342,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":342,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12312,12315],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12312,12315],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAnalytics'. Either include it or remove the dependency array.","line":357,"column":6,"nodeType":"ArrayExpression","endLine":357,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [loadAnalytics, user?.id]","fix":{"range":[12683,12693],"text":"[loadAnalytics, user?.id]"}}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\n// Advanced Learning Analytics Hook - Phase 4 Implementation\r\ninterface AnalyticsEvent {\r\n  id?: string;\r\n  user_id: string;\r\n  session_id: string;\r\n  interaction_type: 'question_asked' | 'answer_given' | 'misconception_corrected' | 'concept_mastered' | 'scaffold_provided';\r\n  topic: string;\r\n  difficulty_level: number;\r\n  success_rate: number;\r\n  time_spent_seconds: number;\r\n  cognitive_load_estimate: number;\r\n  engagement_score: number;\r\n  metadata: Record<string, any>;\r\n  created_at?: string;\r\n}\r\n\r\ninterface LearningTrends {\r\n  understanding_trend: number[];\r\n  engagement_trend: number[];\r\n  difficulty_progression: number[];\r\n  topic_mastery: Record<string, number>;\r\n  time_analysis: {\r\n    average_session_time: number;\r\n    peak_learning_hours: number[];\r\n    consistency_score: number;\r\n  };\r\n}\r\n\r\ninterface PerformanceMetrics {\r\n  current_session: {\r\n    questions_answered: number;\r\n    concepts_explored: number;\r\n    misconceptions_addressed: number;\r\n    scaffolding_provided: number;\r\n    engagement_score: number;\r\n  };\r\n  overall: {\r\n    total_sessions: number;\r\n    average_understanding: number;\r\n    improvement_rate: number;\r\n    mastered_topics: string[];\r\n    struggling_areas: string[];\r\n  };\r\n}\r\n\r\nexport const useLearningAnalytics = (sessionId: string | null) => {\r\n  const [events, setEvents] = useState<AnalyticsEvent[]>([]);\r\n  const [trends, setTrends] = useState<LearningTrends | null>(null);\r\n  const [metrics, setMetrics] = useState<PerformanceMetrics | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { user } = useAuth();\r\n\r\n  // Log learning interaction\r\n  const logInteraction = async (\r\n    interactionType: AnalyticsEvent['interaction_type'],\r\n    topic: string,\r\n    difficultyLevel: number,\r\n    successRate: number,\r\n    timeSpentSeconds: number,\r\n    cognitiveLoadEstimate: number,\r\n    engagementScore: number,\r\n    metadata: Record<string, any> = {}\r\n  ) => {\r\n    if (!user?.id || !sessionId) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('learning_analytics')\r\n        .insert({\r\n          user_id: user.id,\r\n          session_id: sessionId,\r\n          interaction_type: interactionType,\r\n          topic,\r\n          difficulty_level: difficultyLevel,\r\n          success_rate: successRate,\r\n          time_spent_seconds: timeSpentSeconds,\r\n          cognitive_load_estimate: cognitiveLoadEstimate,\r\n          engagement_score: engagementScore,\r\n          metadata\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      setEvents(prev => [...prev, data as AnalyticsEvent]);\r\n    } catch (error) {\r\n      console.error('Error logging interaction:', error);\r\n    }\r\n  };\r\n\r\n  // Load analytics data\r\n  const loadAnalytics = async () => {\r\n    if (!user?.id) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      // Load recent events\r\n      const { data: eventsData, error: eventsError } = await supabase\r\n        .from('learning_analytics')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('created_at', { ascending: false })\r\n        .limit(100);\r\n\r\n      if (eventsError) throw eventsError;\r\n      setEvents((eventsData || []) as AnalyticsEvent[]);\r\n\r\n      // Calculate trends and metrics\r\n      if (eventsData && eventsData.length > 0) {\r\n        calculateTrends(eventsData as AnalyticsEvent[]);\r\n        calculateMetrics(eventsData as AnalyticsEvent[]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading analytics:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Calculate learning trends\r\n  const calculateTrends = (eventsData: AnalyticsEvent[]) => {\r\n    const sortedEvents = [...eventsData].sort((a, b) => \r\n      new Date(a.created_at!).getTime() - new Date(b.created_at!).getTime()\r\n    );\r\n\r\n    const understandingTrend = sortedEvents\r\n      .filter(e => e.interaction_type === 'answer_given')\r\n      .map(e => e.success_rate)\r\n      .slice(-20); // Last 20 interactions\r\n\r\n    const engagementTrend = sortedEvents\r\n      .map(e => e.engagement_score)\r\n      .slice(-20);\r\n\r\n    const difficultyProgression = sortedEvents\r\n      .map(e => e.difficulty_level)\r\n      .slice(-20);\r\n\r\n    // Topic mastery calculation\r\n    const topicMastery: Record<string, number[]> = {};\r\n    sortedEvents.forEach(event => {\r\n      if (!topicMastery[event.topic]) {\r\n        topicMastery[event.topic] = [];\r\n      }\r\n      topicMastery[event.topic].push(event.success_rate);\r\n    });\r\n\r\n    // Calculate average mastery for each topic\r\n    const finalTopicMastery: Record<string, number> = {};\r\n    Object.keys(topicMastery).forEach(topic => {\r\n      const scores = topicMastery[topic];\r\n      finalTopicMastery[topic] = scores.reduce((sum, score) => sum + score, 0) / scores.length;\r\n    });\r\n\r\n    // Time analysis\r\n    const sessionTimes = groupBy(sortedEvents, 'session_id');\r\n    const sessionDurations = Object.values(sessionTimes).map(sessionEvents => \r\n      sessionEvents.reduce((total, event) => total + event.time_spent_seconds, 0)\r\n    );\r\n\r\n    const averageSessionTime = sessionDurations.length > 0 \r\n      ? sessionDurations.reduce((sum, duration) => sum + duration, 0) / sessionDurations.length\r\n      : 0;\r\n\r\n    // Peak learning hours analysis\r\n    const hourCounts: Record<number, number> = {};\r\n    sortedEvents.forEach(event => {\r\n      const hour = new Date(event.created_at!).getHours();\r\n      hourCounts[hour] = (hourCounts[hour] || 0) + 1;\r\n    });\r\n\r\n    const peakLearningHours = Object.entries(hourCounts)\r\n      .sort(([,a], [,b]) => b - a)\r\n      .slice(0, 3)\r\n      .map(([hour]) => parseInt(hour));\r\n\r\n    // Consistency score (sessions per week over last month)\r\n    const now = new Date();\r\n    const lastMonth = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n    const recentSessions = Object.keys(sessionTimes).filter(sessionId => {\r\n      const sessionEvents = sessionTimes[sessionId];\r\n      return sessionEvents.some(event => new Date(event.created_at!) > lastMonth);\r\n    });\r\n\r\n    const consistencyScore = Math.min(1, recentSessions.length / 20); // 20 sessions in a month = perfect consistency\r\n\r\n    setTrends({\r\n      understanding_trend: understandingTrend,\r\n      engagement_trend: engagementTrend,\r\n      difficulty_progression: difficultyProgression,\r\n      topic_mastery: finalTopicMastery,\r\n      time_analysis: {\r\n        average_session_time: averageSessionTime,\r\n        peak_learning_hours: peakLearningHours,\r\n        consistency_score: consistencyScore\r\n      }\r\n    });\r\n  };\r\n\r\n  // Calculate performance metrics\r\n  const calculateMetrics = (eventsData: AnalyticsEvent[]) => {\r\n    const currentSessionEvents = eventsData.filter(e => e.session_id === sessionId);\r\n    const allSessions = groupBy(eventsData, 'session_id');\r\n\r\n    // Current session metrics\r\n    const currentSession = {\r\n      questions_answered: currentSessionEvents.filter(e => e.interaction_type === 'answer_given').length,\r\n      concepts_explored: new Set(currentSessionEvents.map(e => e.topic)).size,\r\n      misconceptions_addressed: currentSessionEvents.filter(e => e.interaction_type === 'misconception_corrected').length,\r\n      scaffolding_provided: currentSessionEvents.filter(e => e.interaction_type === 'scaffold_provided').length,\r\n      engagement_score: currentSessionEvents.length > 0 \r\n        ? currentSessionEvents.reduce((sum, e) => sum + e.engagement_score, 0) / currentSessionEvents.length\r\n        : 0\r\n    };\r\n\r\n    // Overall metrics\r\n    const allAnswerEvents = eventsData.filter(e => e.interaction_type === 'answer_given');\r\n    const averageUnderstanding = allAnswerEvents.length > 0\r\n      ? allAnswerEvents.reduce((sum, e) => sum + e.success_rate, 0) / allAnswerEvents.length\r\n      : 0;\r\n\r\n    // Improvement rate (comparing first 10 vs last 10 interactions)\r\n    const firstTen = allAnswerEvents.slice(0, 10);\r\n    const lastTen = allAnswerEvents.slice(-10);\r\n    const improvementRate = firstTen.length > 0 && lastTen.length > 0\r\n      ? (lastTen.reduce((sum, e) => sum + e.success_rate, 0) / lastTen.length) -\r\n        (firstTen.reduce((sum, e) => sum + e.success_rate, 0) / firstTen.length)\r\n      : 0;\r\n\r\n    // Mastered topics (>80% success rate)\r\n    const topicPerformance: Record<string, number[]> = {};\r\n    allAnswerEvents.forEach(event => {\r\n      if (!topicPerformance[event.topic]) {\r\n        topicPerformance[event.topic] = [];\r\n      }\r\n      topicPerformance[event.topic].push(event.success_rate);\r\n    });\r\n\r\n    const masteredTopics = Object.entries(topicPerformance)\r\n      .filter(([, scores]) => scores.reduce((sum, score) => sum + score, 0) / scores.length > 0.8)\r\n      .map(([topic]) => topic);\r\n\r\n    const strugglingAreas = Object.entries(topicPerformance)\r\n      .filter(([, scores]) => scores.reduce((sum, score) => sum + score, 0) / scores.length < 0.5)\r\n      .map(([topic]) => topic);\r\n\r\n    setMetrics({\r\n      current_session: currentSession,\r\n      overall: {\r\n        total_sessions: Object.keys(allSessions).length,\r\n        average_understanding: averageUnderstanding,\r\n        improvement_rate: improvementRate,\r\n        mastered_topics: masteredTopics,\r\n        struggling_areas: strugglingAreas\r\n      }\r\n    });\r\n  };\r\n\r\n  // Quick logging functions for common interactions\r\n  const logQuestionAsked = (topic: string, difficulty: number, metadata: Record<string, any> = {}) => {\r\n    return logInteraction('question_asked', topic, difficulty, 1, 0, 0.3, 0.8, metadata);\r\n  };\r\n\r\n  const logAnswerGiven = (topic: string, success_rate: number, time_seconds: number, difficulty: number, metadata: Record<string, any> = {}) => {\r\n    return logInteraction('answer_given', topic, difficulty, success_rate, time_seconds, 0.5, 0.7, metadata);\r\n  };\r\n\r\n  const logMisconceptionCorrected = (topic: string, metadata: Record<string, any> = {}) => {\r\n    return logInteraction('misconception_corrected', topic, 3, 1, 0, 0.6, 0.9, metadata);\r\n  };\r\n\r\n  const logConceptMastered = (topic: string, metadata: Record<string, any> = {}) => {\r\n    return logInteraction('concept_mastered', topic, 4, 1, 0, 0.4, 1, metadata);\r\n  };\r\n\r\n  const logScaffoldProvided = (topic: string, difficulty: number, metadata: Record<string, any> = {}) => {\r\n    return logInteraction('scaffold_provided', topic, difficulty, 1, 0, 0.7, 0.8, metadata);\r\n  };\r\n\r\n  // Get learning insights\r\n  const getLearningInsights = () => {\r\n    if (!trends || !metrics) return [];\r\n\r\n    const insights = [];\r\n\r\n    // Understanding trend analysis\r\n    if (trends.understanding_trend.length >= 5) {\r\n      const recent = trends.understanding_trend.slice(-5);\r\n      const average = recent.reduce((sum, val) => sum + val, 0) / recent.length;\r\n      \r\n      if (average > 0.8) {\r\n        insights.push({\r\n          type: 'positive',\r\n          title: 'Excellent Understanding',\r\n          message: 'You\\'re demonstrating strong comprehension across topics!',\r\n          priority: 'high'\r\n        });\r\n      } else if (average < 0.5) {\r\n        insights.push({\r\n          type: 'concern',\r\n          title: 'Understanding Needs Attention',\r\n          message: 'Let\\'s focus on building stronger foundations in key concepts.',\r\n          priority: 'high'\r\n        });\r\n      }\r\n    }\r\n\r\n    // Engagement analysis\r\n    if (trends.engagement_trend.length >= 3) {\r\n      const recent = trends.engagement_trend.slice(-3);\r\n      const average = recent.reduce((sum, val) => sum + val, 0) / recent.length;\r\n      \r\n      if (average < 0.6) {\r\n        insights.push({\r\n          type: 'engagement',\r\n          title: 'Engagement Opportunity',\r\n          message: 'Try exploring topics that interest you more or take short breaks.',\r\n          priority: 'medium'\r\n        });\r\n      }\r\n    }\r\n\r\n    // Improvement analysis\r\n    if (metrics.overall.improvement_rate > 0.2) {\r\n      insights.push({\r\n        type: 'positive',\r\n        title: 'Great Progress!',\r\n        message: `You've improved significantly! Keep up the excellent work.`,\r\n        priority: 'medium'\r\n      });\r\n    }\r\n\r\n    return insights;\r\n  };\r\n\r\n  // Utility function for grouping\r\n  const groupBy = <T extends Record<string, any>>(array: T[], key: keyof T) => {\r\n    return array.reduce((groups, item) => {\r\n      const groupKey = item[key];\r\n      if (!groups[groupKey]) {\r\n        groups[groupKey] = [];\r\n      }\r\n      groups[groupKey].push(item);\r\n      return groups;\r\n    }, {} as Record<string, T[]>);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      loadAnalytics();\r\n    }\r\n  }, [user?.id]);\r\n\r\n  return {\r\n    events,\r\n    trends,\r\n    metrics,\r\n    isLoading,\r\n    \r\n    // Core logging\r\n    logInteraction,\r\n    \r\n    // Quick logging functions\r\n    logQuestionAsked,\r\n    logAnswerGiven,\r\n    logMisconceptionCorrected,\r\n    logConceptMastered,\r\n    logScaffoldProvided,\r\n    \r\n    // Analysis\r\n    getLearningInsights,\r\n    refreshAnalytics: loadAnalytics\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLessonChat.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLessonPerformance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLessons.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[636,639],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[636,639],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[678,681],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[678,681],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1125,1128],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1125,1128],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1161,1164],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1161,1164],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nexport interface Lesson {\r\n  id: string;\r\n  course_id: string;\r\n  title: string;\r\n  description: string | null;\r\n  lesson_number: number;\r\n  content_type: string | null;\r\n  video_url: string | null;\r\n  audio_url: string | null;\r\n  transcript: string | null;\r\n  transcript_url: string | null;\r\n  duration_minutes: number | null;\r\n  is_published: boolean | null;\r\n  sort_order: number | null;\r\n  scorm_package_url: string | null;\r\n  scorm_manifest: any | null;\r\n  scorm_completion_criteria: any | null;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface CreateLessonData {\r\n  course_id: string;\r\n  title: string;\r\n  description?: string;\r\n  lesson_number: number;\r\n  content_type?: string;\r\n  video_url?: string;\r\n  audio_url?: string;\r\n  transcript?: string;\r\n  transcript_url?: string;\r\n  duration_minutes?: number;\r\n  is_published?: boolean;\r\n  sort_order?: number;\r\n  scorm_package_url?: string;\r\n  scorm_manifest?: any;\r\n  scorm_completion_criteria?: any;\r\n}\r\n\r\nexport function useLessons(courseId?: string) {\r\n  return useQuery({\r\n    queryKey: ['lessons', courseId],\r\n    queryFn: async () => {\r\n      if (!courseId) return [];\r\n      \r\n      const { data, error } = await supabase\r\n        .from('lessons')\r\n        .select('*')\r\n        .eq('course_id', courseId)\r\n        .order('sort_order', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('Error fetching lessons:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as Lesson[];\r\n    },\r\n    enabled: !!courseId,\r\n  });\r\n}\r\n\r\nexport function useLesson(lessonId?: string) {\r\n  return useQuery({\r\n    queryKey: ['lesson', lessonId],\r\n    queryFn: async () => {\r\n      if (!lessonId) return null;\r\n      \r\n      const { data, error } = await supabase\r\n        .from('lessons')\r\n        .select('*')\r\n        .eq('id', lessonId)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error fetching lesson:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as Lesson;\r\n    },\r\n    enabled: !!lessonId,\r\n  });\r\n}\r\n\r\nexport function useLessonMutations() {\r\n  const queryClient = useQueryClient();\r\n  const { toast } = useToast();\r\n\r\n  const createLesson = useMutation({\r\n    mutationFn: async (lessonData: CreateLessonData) => {\r\n      const { data, error } = await supabase\r\n        .from('lessons')\r\n        .insert(lessonData)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: ['lessons'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Lesson created successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error creating lesson:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create lesson.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const updateLesson = useMutation({\r\n    mutationFn: async ({ id, ...lessonData }: Partial<Lesson> & { id: string }) => {\r\n      const { data, error } = await supabase\r\n        .from('lessons')\r\n        .update(lessonData)\r\n        .eq('id', id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: ['lessons'] });\r\n      queryClient.invalidateQueries({ queryKey: ['lesson', data.id] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Lesson updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error updating lesson:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update lesson.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const deleteLesson = useMutation({\r\n    mutationFn: async (lessonId: string) => {\r\n      const { error } = await supabase\r\n        .from('lessons')\r\n        .delete()\r\n        .eq('id', lessonId);\r\n\r\n      if (error) throw error;\r\n      return lessonId;\r\n    },\r\n    onSuccess: (lessonId) => {\r\n      queryClient.invalidateQueries({ queryKey: ['lessons'] });\r\n      queryClient.removeQueries({ queryKey: ['lesson', lessonId] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Lesson deleted successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error deleting lesson:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete lesson.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    createLesson,\r\n    updateLesson,\r\n    deleteLesson,\r\n    isCreating: createLesson.isPending,\r\n    isUpdating: updateLesson.isPending,\r\n    isDeleting: deleteLesson.isPending,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLibrarySearch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLiveHubVideoStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useLocalStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useMediaAnalytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1313,1316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1313,1316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1346,1349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1346,1349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1800,1803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1800,1803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1838,1841],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1838,1841],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Hook for tracking media playback analytics events\r\n * Tracks play, pause, seek, speed changes, and completion\r\n */\r\n\r\nimport { useCallback } from 'react';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\n\r\ninterface MediaAnalyticsEvent {\r\n  event: 'play' | 'pause' | 'seek' | 'speed_change' | 'completion' | 'buffer' | 'error';\r\n  mediaId: string;\r\n  currentTime: number;\r\n  duration: number;\r\n  playbackRate?: number;\r\n  seekFrom?: number;\r\n  seekTo?: number;\r\n  errorMessage?: string;\r\n  timestamp: number;\r\n}\r\n\r\ninterface UseMediaAnalyticsProps {\r\n  mediaId: string;\r\n  courseId?: string;\r\n  moduleId?: string;\r\n}\r\n\r\nexport const useMediaAnalytics = ({ mediaId, courseId, moduleId }: UseMediaAnalyticsProps) => {\r\n  \r\n  const trackEvent = useCallback((eventData: Omit<MediaAnalyticsEvent, 'mediaId' | 'timestamp'>) => {\r\n    const analyticsEvent: MediaAnalyticsEvent = {\r\n      ...eventData,\r\n      mediaId,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    // Log for debugging\r\n    console.log(`ðŸ“Š [Analytics] ${eventData.event}:`, {\r\n      mediaId,\r\n      courseId,\r\n      moduleId,\r\n      ...eventData\r\n    });\r\n\r\n    // Send to analytics service (could be GA4, Mixpanel, etc.)\r\n    try {\r\n      // If window.gtag exists (Google Analytics)\r\n      if (typeof window !== 'undefined' && (window as any).gtag) {\r\n        (window as any).gtag('event', `media_${eventData.event}`, {\r\n          media_id: mediaId,\r\n          course_id: courseId,\r\n          module_id: moduleId,\r\n          current_time: eventData.currentTime,\r\n          duration: eventData.duration,\r\n          playback_rate: eventData.playbackRate,\r\n          custom_map: { dimension1: mediaId }\r\n        });\r\n      }\r\n\r\n      // If custom analytics function exists\r\n      if (typeof window !== 'undefined' && (window as any).analytics) {\r\n        (window as any).analytics.track(`Media ${eventData.event}`, analyticsEvent);\r\n      }\r\n\r\n      // Store in localStorage for offline analytics queue\r\n      const queue = JSON.parse(safeLocalStorage.getItem<string>('media-analytics-queue', {\r\n        fallbackValue: '[]',\r\n        logErrors: false\r\n      }) || '[]');\r\n      queue.push(analyticsEvent);\r\n      \r\n      // Keep only last 100 events\r\n      if (queue.length > 100) {\r\n        queue.splice(0, queue.length - 100);\r\n      }\r\n      \r\n      safeLocalStorage.setItem('media-analytics-queue', JSON.stringify(queue));\r\n      \r\n    } catch (error) {\r\n      console.warn('Error tracking analytics event:', error);\r\n    }\r\n  }, [mediaId, courseId, moduleId]);\r\n\r\n  const trackPlay = useCallback((currentTime: number, duration: number) => {\r\n    trackEvent({ event: 'play', currentTime, duration });\r\n  }, [trackEvent]);\r\n\r\n  const trackPause = useCallback((currentTime: number, duration: number) => {\r\n    trackEvent({ event: 'pause', currentTime, duration });\r\n  }, [trackEvent]);\r\n\r\n  const trackSeek = useCallback((seekFrom: number, seekTo: number, duration: number) => {\r\n    trackEvent({ \r\n      event: 'seek', \r\n      currentTime: seekTo, \r\n      duration, \r\n      seekFrom, \r\n      seekTo \r\n    });\r\n  }, [trackEvent]);\r\n\r\n  const trackSpeedChange = useCallback((currentTime: number, duration: number, playbackRate: number) => {\r\n    trackEvent({ \r\n      event: 'speed_change', \r\n      currentTime, \r\n      duration, \r\n      playbackRate \r\n    });\r\n  }, [trackEvent]);\r\n\r\n  const trackCompletion = useCallback((duration: number) => {\r\n    trackEvent({ \r\n      event: 'completion', \r\n      currentTime: duration, \r\n      duration \r\n    });\r\n  }, [trackEvent]);\r\n\r\n  const trackError = useCallback((currentTime: number, duration: number, errorMessage: string) => {\r\n    trackEvent({ \r\n      event: 'error', \r\n      currentTime, \r\n      duration, \r\n      errorMessage \r\n    });\r\n  }, [trackEvent]);\r\n\r\n  return {\r\n    trackPlay,\r\n    trackPause,\r\n    trackSeek,\r\n    trackSpeedChange,\r\n    trackCompletion,\r\n    trackError\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useMediaProgress.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useModuleMutations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useModuleProgressAnalytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1996,1999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1996,1999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'updateModuleProgress'. Either include it or remove the dependency array.","line":108,"column":6,"nodeType":"ArrayExpression","endLine":108,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [user?.id, moduleProgress, updateModuleProgress]","fix":{"range":[3318,3344],"text":"[user?.id, moduleProgress, updateModuleProgress]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'updateModuleProgress'. Either include it or remove the dependency array.","line":128,"column":6,"nodeType":"ArrayExpression","endLine":128,"endColumn":64,"suggestions":[{"desc":"Update the dependencies array to be: [currentSession, activeModuleId, user?.id, moduleProgress, updateModuleProgress]","fix":{"range":[4055,4113],"text":"[currentSession, activeModuleId, user?.id, moduleProgress, updateModuleProgress]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Module-Level Progress Analytics Hook\r\n * Tracks detailed module engagement metrics\r\n */\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\ninterface ModuleProgressData {\r\n  moduleId: string;\r\n  courseId: string;\r\n  timeSpent: number; // in seconds\r\n  completionStatus: 'not_started' | 'in_progress' | 'completed';\r\n  viewedPercentage: number; // 0-100\r\n  interactions: {\r\n    playCount: number;\r\n    pauseCount: number;\r\n    seekCount: number;\r\n    speedChanges: number;\r\n    lastInteraction: string;\r\n  };\r\n  startedAt?: string;\r\n  completedAt?: string;\r\n  lastActiveAt: string;\r\n}\r\n\r\ninterface ModuleSession {\r\n  startTime: number;\r\n  endTime?: number;\r\n  interactions: number;\r\n  maxProgress: number;\r\n}\r\n\r\nexport const useModuleProgressAnalytics = (courseId: string) => {\r\n  const { user } = useAuth();\r\n  const [moduleProgress, setModuleProgress] = useState<Map<string, ModuleProgressData>>(new Map());\r\n  const [currentSession, setCurrentSession] = useState<ModuleSession | null>(null);\r\n  const [activeModuleId, setActiveModuleId] = useState<string | null>(null);\r\n\r\n  // Load existing progress data\r\n  useEffect(() => {\r\n    if (!user?.id || !courseId) return;\r\n\r\n    const loadModuleProgress = async () => {\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('lesson_progress')\r\n          .select('*')\r\n          .eq('user_id', user.id)\r\n          .eq('course_id', courseId);\r\n\r\n        if (error) {\r\n          console.error('Error loading module progress:', error);\r\n          return;\r\n        }\r\n\r\n        const progressMap = new Map<string, ModuleProgressData>();\r\n        data?.forEach(record => {\r\n          progressMap.set(record.lesson_id, {\r\n            moduleId: record.lesson_id,\r\n            courseId: record.course_id,\r\n            timeSpent: record.time_spent_seconds || 0,\r\n            completionStatus: record.status as any,\r\n            viewedPercentage: record.completion_percentage || 0,\r\n            interactions: {\r\n              playCount: 0,\r\n              pauseCount: 0,\r\n              seekCount: 0,\r\n              speedChanges: 0,\r\n              lastInteraction: record.updated_at\r\n            },\r\n            startedAt: record.created_at,\r\n            completedAt: record.completed_at,\r\n            lastActiveAt: record.updated_at\r\n          });\r\n        });\r\n\r\n        setModuleProgress(progressMap);\r\n      } catch (error) {\r\n        console.error('Error in loadModuleProgress:', error);\r\n      }\r\n    };\r\n\r\n    loadModuleProgress();\r\n  }, [user?.id, courseId]);\r\n\r\n  // Start tracking a module session\r\n  const startModuleSession = useCallback((moduleId: string) => {\r\n    if (!user?.id) return;\r\n\r\n    console.log(`ðŸ“Š Starting session for module: ${moduleId}`);\r\n    setActiveModuleId(moduleId);\r\n    setCurrentSession({\r\n      startTime: Date.now(),\r\n      interactions: 0,\r\n      maxProgress: 0\r\n    });\r\n\r\n    // Update module as started if not already\r\n    const existing = moduleProgress.get(moduleId);\r\n    if (!existing || existing.completionStatus === 'not_started') {\r\n      updateModuleProgress(moduleId, {\r\n        completionStatus: 'in_progress',\r\n        startedAt: new Date().toISOString()\r\n      });\r\n    }\r\n  }, [user?.id, moduleProgress]);\r\n\r\n  // End tracking a module session\r\n  const endModuleSession = useCallback(() => {\r\n    if (!currentSession || !activeModuleId || !user?.id) return;\r\n\r\n    const sessionDuration = (Date.now() - currentSession.startTime) / 1000;\r\n    console.log(`ðŸ“Š Ending session for module: ${activeModuleId}, duration: ${Math.round(sessionDuration)}s`);\r\n\r\n    // Update total time spent\r\n    const existing = moduleProgress.get(activeModuleId);\r\n    const newTimeSpent = (existing?.timeSpent || 0) + sessionDuration;\r\n\r\n    updateModuleProgress(activeModuleId, {\r\n      timeSpent: newTimeSpent,\r\n      lastActiveAt: new Date().toISOString()\r\n    });\r\n\r\n    setCurrentSession(null);\r\n    setActiveModuleId(null);\r\n  }, [currentSession, activeModuleId, user?.id, moduleProgress]);\r\n\r\n  // Update module progress data\r\n  const updateModuleProgress = useCallback(async (\r\n    moduleId: string, \r\n    updates: Partial<ModuleProgressData>\r\n  ) => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const existing = moduleProgress.get(moduleId);\r\n      const updatedProgress: ModuleProgressData = {\r\n        moduleId,\r\n        courseId,\r\n        timeSpent: 0,\r\n        completionStatus: 'not_started',\r\n        viewedPercentage: 0,\r\n        interactions: {\r\n          playCount: 0,\r\n          pauseCount: 0,\r\n          seekCount: 0,\r\n          speedChanges: 0,\r\n          lastInteraction: new Date().toISOString()\r\n        },\r\n        lastActiveAt: new Date().toISOString(),\r\n        ...existing,\r\n        ...updates\r\n      };\r\n\r\n      // Update local state\r\n      setModuleProgress(prev => new Map(prev).set(moduleId, updatedProgress));\r\n\r\n      // Update database\r\n      const { error } = await supabase\r\n        .from('lesson_progress')\r\n        .upsert({\r\n          user_id: user.id,\r\n          course_id: courseId,\r\n          lesson_id: moduleId,\r\n          status: updatedProgress.completionStatus,\r\n          completion_percentage: Math.round(updatedProgress.viewedPercentage),\r\n          time_spent_seconds: Math.round(updatedProgress.timeSpent),\r\n          completed_at: updatedProgress.completedAt || null,\r\n          updated_at: new Date().toISOString()\r\n        }, {\r\n          onConflict: 'user_id,course_id,lesson_id'\r\n        });\r\n\r\n      if (error) {\r\n        console.error('Error updating module progress:', error);\r\n      } else {\r\n        console.log(`ðŸ“Š Updated progress for ${moduleId}:`, updatedProgress);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in updateModuleProgress:', error);\r\n    }\r\n  }, [user?.id, courseId, moduleProgress]);\r\n\r\n  // Track specific interactions\r\n  const trackInteraction = useCallback((\r\n    type: 'play' | 'pause' | 'seek' | 'speed_change',\r\n    progress?: number\r\n  ) => {\r\n    if (!activeModuleId || !currentSession) return;\r\n\r\n    // Update session\r\n    setCurrentSession(prev => prev ? {\r\n      ...prev,\r\n      interactions: prev.interactions + 1,\r\n      maxProgress: Math.max(prev.maxProgress, progress || 0)\r\n    } : null);\r\n\r\n    // Update module interactions\r\n    const existing = moduleProgress.get(activeModuleId);\r\n    if (existing) {\r\n      const updatedInteractions = { ...existing.interactions };\r\n      \r\n      switch (type) {\r\n        case 'play':\r\n          updatedInteractions.playCount++;\r\n          break;\r\n        case 'pause':\r\n          updatedInteractions.pauseCount++;\r\n          break;\r\n        case 'seek':\r\n          updatedInteractions.seekCount++;\r\n          break;\r\n        case 'speed_change':\r\n          updatedInteractions.speedChanges++;\r\n          break;\r\n      }\r\n\r\n      updatedInteractions.lastInteraction = new Date().toISOString();\r\n\r\n      updateModuleProgress(activeModuleId, {\r\n        interactions: updatedInteractions,\r\n        viewedPercentage: Math.max(existing.viewedPercentage, progress || 0)\r\n      });\r\n    }\r\n  }, [activeModuleId, currentSession, moduleProgress, updateModuleProgress]);\r\n\r\n  // Mark module as completed\r\n  const markModuleCompleted = useCallback((moduleId: string) => {\r\n    updateModuleProgress(moduleId, {\r\n      completionStatus: 'completed',\r\n      viewedPercentage: 100,\r\n      completedAt: new Date().toISOString()\r\n    });\r\n  }, [updateModuleProgress]);\r\n\r\n  // Get analytics summary for all modules\r\n  const getAnalyticsSummary = useCallback(() => {\r\n    const modules = Array.from(moduleProgress.values());\r\n    const totalTimeSpent = modules.reduce((acc, m) => acc + m.timeSpent, 0);\r\n    const completedModules = modules.filter(m => m.completionStatus === 'completed').length;\r\n    const averageCompletion = modules.length > 0 \r\n      ? modules.reduce((acc, m) => acc + m.viewedPercentage, 0) / modules.length \r\n      : 0;\r\n\r\n    return {\r\n      totalTimeSpent,\r\n      completedModules,\r\n      totalModules: modules.length,\r\n      averageCompletion,\r\n      moduleBreakdown: modules\r\n    };\r\n  }, [moduleProgress]);\r\n\r\n  // Auto-save session data on unmount or visibility change\r\n  useEffect(() => {\r\n    const handleBeforeUnload = () => {\r\n      endModuleSession();\r\n    };\r\n\r\n    const handleVisibilityChange = () => {\r\n      if (document.hidden) {\r\n        endModuleSession();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('beforeunload', handleBeforeUnload);\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n\r\n    return () => {\r\n      window.removeEventListener('beforeunload', handleBeforeUnload);\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n      endModuleSession();\r\n    };\r\n  }, [endModuleSession]);\r\n\r\n  return {\r\n    moduleProgress: Array.from(moduleProgress.values()),\r\n    startModuleSession,\r\n    endModuleSession,\r\n    trackInteraction,\r\n    markModuleCompleted,\r\n    getAnalyticsSummary,\r\n    activeModuleId,\r\n    currentSession\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useModules.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[314,317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[314,317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nexport interface Module {\r\n  id: string;\r\n  course_id: string;\r\n  module_number: number;\r\n  title: string;\r\n  description?: string;\r\n  content_type: string;\r\n  duration_minutes: number;\r\n  metadata: any;\r\n  is_published: boolean;\r\n  sort_order?: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n  video_url?: string;\r\n  audio_url?: string;\r\n  pdf_url?: string;\r\n  word_url?: string;\r\n  image_url?: string;\r\n}\r\n\r\nexport function useModules(courseId: string) {\r\n  const { data: modules = [], isLoading, error, refetch } = useQuery({\r\n    queryKey: ['modules', courseId],\r\n    queryFn: async () => {\r\n      if (!courseId) return [];\r\n\r\n      const { data, error } = await supabase\r\n        .from('modules')\r\n        .select('*')\r\n        .eq('course_id', courseId)\r\n        .eq('is_published', true)\r\n        .order('module_number', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('Error fetching modules:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as Module[];\r\n    },\r\n    enabled: !!courseId,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n\r\n  return {\r\n    modules,\r\n    isLoading,\r\n    error,\r\n    refetch\r\n  };\r\n}\r\n\r\nexport function useModule(moduleId: string) {\r\n  const { data: module, isLoading, error, refetch } = useQuery({\r\n    queryKey: ['module', moduleId],\r\n    queryFn: async () => {\r\n      if (!moduleId) return null;\r\n\r\n      const { data, error } = await supabase\r\n        .from('modules')\r\n        .select('*')\r\n        .eq('id', moduleId)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error fetching module:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as Module;\r\n    },\r\n    enabled: !!moduleId,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n\r\n  return {\r\n    module,\r\n    isLoading,\r\n    error,\r\n    refetch\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useMonitoring.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[225,228],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[225,228],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { sloMonitoringService } from '@/services/monitoring/SLOMonitoringService';\r\n\r\nexport const useMonitoring = () => {\r\n  const [dashboardData, setDashboardData] = useState<any>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const loadData = () => {\r\n      try {\r\n        const data = sloMonitoringService.getDashboardData();\r\n        setDashboardData(data);\r\n      } catch (error) {\r\n        console.error('Failed to load monitoring data:', error);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n\r\n    // Listen for real-time updates\r\n    const handleAlert = () => {\r\n      loadData();\r\n    };\r\n\r\n    window.addEventListener('slo-alert', handleAlert);\r\n\r\n    return () => {\r\n      window.removeEventListener('slo-alert', handleAlert);\r\n    };\r\n  }, []);\r\n\r\n  const trackSearch = (query: string, searchType: 'instant' | 'full' = 'full') => {\r\n    sloMonitoringService['conversionTracker'].trackSearch(query, searchType);\r\n  };\r\n\r\n  const trackSearchResults = (query: string, resultCount: number, loadTime?: number) => {\r\n    sloMonitoringService['conversionTracker'].trackSearchResults(query, resultCount, loadTime);\r\n  };\r\n\r\n  const trackBookDetail = (bookId: string, source: 'search' | 'recommendation' | 'browse' = 'search') => {\r\n    sloMonitoringService['conversionTracker'].trackBookDetail(bookId, source);\r\n  };\r\n\r\n  const trackReadingStart = (bookId: string, format: 'epub' | 'pdf', loadTime?: number) => {\r\n    sloMonitoringService['conversionTracker'].trackReadingStart(bookId, format, loadTime);\r\n  };\r\n\r\n  const trackReadingComplete = (bookId: string, totalTime: number, completionRate: number) => {\r\n    sloMonitoringService['conversionTracker'].trackReadingComplete(bookId, totalTime, completionRate);\r\n  };\r\n\r\n  const recordCustomMetric = (name: string, value: number) => {\r\n    sloMonitoringService['webVitalsTracker'].recordCustomMetric(name, value);\r\n  };\r\n\r\n  return {\r\n    dashboardData,\r\n    isLoading,\r\n    trackSearch,\r\n    trackSearchResults,\r\n    trackBookDetail,\r\n    trackReadingStart,\r\n    trackReadingComplete,\r\n    recordCustomMetric,\r\n    getSLOStatus: () => sloMonitoringService.getSLOStatus(),\r\n    getAlerts: () => sloMonitoringService.getAlerts(),\r\n    acknowledgeAlert: (id: string) => sloMonitoringService.acknowledgeAlert(id)\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useMuseumData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useNASAAPOD.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useNativeCourses.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1061,1064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1061,1064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1256,1259],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1256,1259],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1283,1286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1283,1286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { toast } from 'sonner';\r\n\r\nexport interface NativeCourse {\r\n  id: string;\r\n  title: string;\r\n  slug: string;\r\n  summary?: string;\r\n  est_minutes: number;\r\n  cover_url?: string;\r\n  visibility: 'draft' | 'published' | 'archived';\r\n  created_by?: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  organization_id?: string;\r\n  course_visibility?: 'global' | 'organization_only' | 'private';\r\n}\r\n\r\nexport interface CourseModule {\r\n  id: string;\r\n  course_id: string;\r\n  title: string;\r\n  order_index: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface CourseLesson {\r\n  id: string;\r\n  module_id: string;\r\n  title: string;\r\n  order_index: number;\r\n  est_minutes: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface LessonBlock {\r\n  id: string;\r\n  lesson_id: string;\r\n  order_index: number;\r\n  type: 'rich-text' | 'image' | 'legacy-html' | 'quiz';\r\n  data_json: any;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface QuizItem {\r\n  id: string;\r\n  block_id: string;\r\n  kind: 'mcq' | 'multi' | 'numeric';\r\n  prompt: string;\r\n  options_json: any[];\r\n  answer_key_json: any;\r\n  points: number;\r\n  order_index: number;\r\n  created_at: string;\r\n}\r\n\r\nexport interface NativeEnrollment {\r\n  id: string;\r\n  user_id: string;\r\n  course_id: string;\r\n  status: string; // Changed to string to match DB\r\n  progress_pct: number;\r\n  last_lesson_id?: string;\r\n  last_visit_at: string;\r\n  enrolled_at: string;\r\n  completed_at?: string;\r\n}\r\n\r\n// Hook to fetch all native courses\r\nexport function useNativeCourses(options?: { organizationId?: string }) {\r\n  return useQuery({\r\n    queryKey: ['native-courses', options],\r\n    queryFn: async () => {\r\n      let query = supabase\r\n        .from('native_courses')\r\n        .select('*')\r\n        .eq('visibility', 'published')\r\n        .order('created_at', { ascending: false });\r\n\r\n      // Filter by organization if specified\r\n      if (options?.organizationId) {\r\n        query = query.or(`organization_id.eq.${options.organizationId},course_visibility.eq.global,course_visibility.is.null`);\r\n      }\r\n\r\n      const { data, error } = await query;\r\n\r\n      if (error) {\r\n        console.error('Error fetching native courses:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as NativeCourse[];\r\n    },\r\n    staleTime: 1000 * 60 * 5, // 5 minutes\r\n  });\r\n}\r\n\r\n// Hook to fetch a single native course\r\nexport function useNativeCourse(slug: string) {\r\n  return useQuery({\r\n    queryKey: ['native-course', slug],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('native_courses')\r\n        .select('*')\r\n        .eq('slug', slug)\r\n        .eq('visibility', 'published')\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error fetching native course:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as NativeCourse;\r\n    },\r\n    enabled: !!slug,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n}\r\n\r\n// Hook to fetch course modules with lessons\r\nexport function useCourseModules(courseId: string) {\r\n  return useQuery({\r\n    queryKey: ['course-modules', courseId],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('course_modules')\r\n        .select(`\r\n          *,\r\n          course_lessons (\r\n            *,\r\n            lesson_blocks (\r\n              id,\r\n              type,\r\n              order_index\r\n            )\r\n          )\r\n        `)\r\n        .eq('course_id', courseId)\r\n        .order('order_index', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('Error fetching course modules:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data;\r\n    },\r\n    enabled: !!courseId,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n}\r\n\r\n// Hook to fetch a single lesson with blocks\r\nexport function useCourseLesson(lessonId: string) {\r\n  return useQuery({\r\n    queryKey: ['course-lesson', lessonId],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('course_lessons')\r\n        .select(`\r\n          *,\r\n          lesson_blocks (\r\n            *,\r\n            quiz_items (*)\r\n          )\r\n        `)\r\n        .eq('id', lessonId)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error fetching course lesson:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data;\r\n    },\r\n    enabled: !!lessonId,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n}\r\n\r\n// Hook to fetch user's native course enrollments\r\nexport function useNativeEnrollments() {\r\n  return useQuery({\r\n    queryKey: ['native-enrollments'],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('native_enrollments')\r\n        .select(`\r\n          *,\r\n          native_courses (*)\r\n        `)\r\n        .order('enrolled_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching native enrollments:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data;\r\n    },\r\n    staleTime: 1000 * 60 * 2, // 2 minutes\r\n  });\r\n}\r\n\r\n// Hook to manage native course enrollments\r\nexport function useNativeEnrollmentMutations() {\r\n  const queryClient = useQueryClient();\r\n\r\n  const enrollInCourse = useMutation({\r\n    mutationFn: async (courseId: string) => {\r\n      const { data, error } = await supabase\r\n        .from('native_enrollments')\r\n        .insert([\r\n          {\r\n            course_id: courseId,\r\n            user_id: (await supabase.auth.getUser()).data.user?.id,\r\n          },\r\n        ])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['native-enrollments'] });\r\n      toast.success('Successfully enrolled in course!');\r\n    },\r\n    onError: (error) => {\r\n      console.error('Enrollment error:', error);\r\n      toast.error('Failed to enroll in course');\r\n    },\r\n  });\r\n\r\n  const updateProgress = useMutation({\r\n    mutationFn: async ({\r\n      enrollmentId,\r\n      progressPct,\r\n      lastLessonId,\r\n    }: {\r\n      enrollmentId: string;\r\n      progressPct: number;\r\n      lastLessonId?: string;\r\n    }) => {\r\n      const { data, error } = await supabase\r\n        .from('native_enrollments')\r\n        .update({\r\n          progress_pct: progressPct,\r\n          last_lesson_id: lastLessonId,\r\n          last_visit_at: new Date().toISOString(),\r\n        })\r\n        .eq('id', enrollmentId)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['native-enrollments'] });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Progress update error:', error);\r\n    },\r\n  });\r\n\r\n  return {\r\n    enrollInCourse,\r\n    updateProgress,\r\n    isEnrolling: enrollInCourse.isPending,\r\n    isUpdating: updateProgress.isPending,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useNotes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useNotesVideoStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useNotificationTriggers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useNotifications.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[392,395],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[392,395],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadNotifications' and 'user'. Either include them or remove the dependency array.","line":143,"column":6,"nodeType":"ArrayExpression","endLine":143,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [loadNotifications, user, user.id]","fix":{"range":[4196,4206],"text":"[loadNotifications, user, user.id]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useRealtimeChannel } from '@/hooks/useRealtimeChannel';\r\n\r\ninterface Notification {\r\n  id: string;\r\n  user_id: string;\r\n  type: string;\r\n  title: string;\r\n  message: string;\r\n  read_status: boolean;\r\n  action_url?: string;\r\n  metadata: any;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport const useNotifications = () => {\r\n  const [notifications, setNotifications] = useState<Notification[]>([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n\r\n  // Load notifications\r\n  const loadNotifications = async () => {\r\n    if (!user) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const { supabase } = await import('@/integrations/supabase/client');\r\n      const { data, error } = await supabase\r\n        .from('notifications')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('created_at', { ascending: false })\r\n        .limit(20);\r\n\r\n      if (error) throw error;\r\n      \r\n      setNotifications(data || []);\r\n      setUnreadCount(data?.filter(n => !n.read_status).length || 0);\r\n    } catch (error) {\r\n      console.error('Error loading notifications:', error);\r\n      toast({\r\n        title: \"Error loading notifications\",\r\n        description: \"Failed to load your notifications.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Mark notification as read\r\n  const markAsRead = async (notificationId: string) => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { supabase } = await import('@/integrations/supabase/client');\r\n      const { error } = await supabase\r\n        .from('notifications')\r\n        .update({ read_status: true, updated_at: new Date().toISOString() })\r\n        .eq('id', notificationId)\r\n        .eq('user_id', user.id);\r\n\r\n      if (error) throw error;\r\n\r\n      setNotifications(prev => \r\n        prev.map(n => n.id === notificationId ? { ...n, read_status: true } : n)\r\n      );\r\n      setUnreadCount(prev => Math.max(0, prev - 1));\r\n    } catch (error) {\r\n      console.error('Error marking notification as read:', error);\r\n    }\r\n  };\r\n\r\n  // Mark all notifications as read\r\n  const markAllAsRead = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { supabase } = await import('@/integrations/supabase/client');\r\n      const { error } = await supabase\r\n        .from('notifications')\r\n        .update({ read_status: true, updated_at: new Date().toISOString() })\r\n        .eq('user_id', user.id)\r\n        .eq('read_status', false);\r\n\r\n      if (error) throw error;\r\n\r\n      setNotifications(prev => \r\n        prev.map(n => ({ ...n, read_status: true }))\r\n      );\r\n      setUnreadCount(0);\r\n    } catch (error) {\r\n      console.error('Error marking all notifications as read:', error);\r\n    }\r\n  };\r\n\r\n  // Create notification (for system use)\r\n  const createNotification = async (notification: Omit<Notification, 'id' | 'user_id' | 'read_status' | 'created_at' | 'updated_at'>) => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { supabase } = await import('@/integrations/supabase/client');\r\n      const { data, error } = await supabase\r\n        .from('notifications')\r\n        .insert({\r\n          user_id: user.id,\r\n          read_status: false,\r\n          ...notification\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Show toast for immediate feedback with better styling\r\n      toast({\r\n        title: notification.title,\r\n        description: notification.message,\r\n        duration: 5000,\r\n      });\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error creating notification:', error);\r\n      toast({\r\n        title: \"Notification Error\",\r\n        description: \"Failed to create notification.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  // Set up real-time subscription using centralized hook\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    loadNotifications();\r\n  }, [user?.id]);\r\n\r\n  // Use centralized real-time hook for notifications\r\n  useRealtimeChannel(\r\n    `notifications-insert-${user?.id}`,\r\n    {\r\n      event: 'INSERT',\r\n      table: 'notifications',\r\n      filter: `user_id=eq.${user?.id}`,\r\n    },\r\n    (payload) => {\r\n      const newNotification = payload.new as Notification;\r\n      setNotifications(prev => [newNotification, ...prev]);\r\n      setUnreadCount(prev => prev + 1);\r\n      \r\n      toast({\r\n        title: newNotification.title,\r\n        description: newNotification.message,\r\n        duration: 6000,\r\n      });\r\n    }\r\n  );\r\n\r\n  useRealtimeChannel(\r\n    `notifications-update-${user?.id}`,\r\n    {\r\n      event: 'UPDATE',\r\n      table: 'notifications',\r\n      filter: `user_id=eq.${user?.id}`,\r\n    },\r\n    (payload) => {\r\n      const updatedNotification = payload.new as Notification;\r\n      setNotifications(prev => \r\n        prev.map(n => n.id === updatedNotification.id ? updatedNotification : n)\r\n      );\r\n    }\r\n  );\r\n\r\n  return {\r\n    notifications,\r\n    unreadCount,\r\n    isLoading,\r\n    loadNotifications,\r\n    markAsRead,\r\n    markAllAsRead,\r\n    createNotification\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOnboardingFlow.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'determineStep', 'location.pathname', and 'user'. Either include them or remove the dependency array.","line":190,"column":6,"nodeType":"ArrayExpression","endLine":190,"endColumn":76,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, authLoading, subscription?.subscribed, subscriptionLoading, determineStep, user, location.pathname]","fix":{"range":[6082,6152],"text":"[user.id, authLoading, subscription?.subscribed, subscriptionLoading, determineStep, user, location.pathname]"}}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":211,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":211,"endColumn":54,"suggestions":[{"messageId":"addBrackets","fix":{"range":[6834,7089],"text":"{ const currentPath = window.location.pathname;\r\n        if (currentPath.startsWith('/dashboard')) {\r\n          // Already on dashboard, don't navigate\r\n          return;\r\n        }\r\n        navigate('/dashboard/learner', { replace: true });\r\n        break; }"},"desc":"Add {} brackets around the case block."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from './useAuth';\r\nimport { useSubscription } from './useSubscription';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nexport type OnboardingStep = \r\n  | 'loading'\r\n  | 'unauthenticated' \r\n  | 'choose-plan'\r\n  | 'beta-onboarding'\r\n  | 'dashboard';\r\n\r\ninterface OnboardingFlowState {\r\n  currentStep: OnboardingStep;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  hasCompletedBetaOnboarding: boolean;\r\n}\r\n\r\nexport const useOnboardingFlow = () => {\r\n  const { user, loading: authLoading, session } = useAuth();\r\n  const { subscription, isLoading: subscriptionLoading } = useSubscription();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  \r\n  const [state, setState] = useState<OnboardingFlowState>({\r\n    currentStep: 'loading',\r\n    isLoading: true,\r\n    error: null,\r\n    hasCompletedBetaOnboarding: false\r\n  });\r\n\r\n  // Check if user has completed beta onboarding\r\n  const checkBetaOnboardingStatus = async (userId: string) => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('profiles')\r\n        .select('onboarding_completed')\r\n        .eq('id', userId)\r\n        .maybeSingle();\r\n\r\n      if (error && error.code !== 'PGRST116') {\r\n        console.error('Error checking onboarding status:', error);\r\n        return false;\r\n      }\r\n\r\n      return data?.onboarding_completed || false;\r\n    } catch (error) {\r\n      console.error('Error checking onboarding status:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // Determine current step based on user state\r\n  const determineStep = async (): Promise<OnboardingStep> => {\r\n    console.log('ðŸ” Determining onboarding step:', { \r\n      authLoading,\r\n      subscriptionLoading,\r\n      user: !!user, \r\n      subscription: subscription?.subscribed \r\n    });\r\n\r\n    // Still loading auth state\r\n    if (authLoading) {\r\n      console.log('â³ Auth still loading...');\r\n      return 'loading';\r\n    }\r\n\r\n    // Not authenticated\r\n    if (!user || !session) {\r\n      console.log('âž¡ï¸ No user/session - going to unauthenticated');\r\n      return 'unauthenticated';\r\n    }\r\n\r\n    // Skip subscription check if it's taking too long and user exists\r\n    if (subscriptionLoading) {\r\n      console.log('â³ Subscription loading, but user exists - proceeding to dashboard');\r\n      return 'dashboard'; // Fallback to dashboard if subscription is taking too long\r\n    }\r\n\r\n    // No subscription - need to choose plan\r\n    if (!subscription?.subscribed) {\r\n      console.log('âž¡ï¸ No subscription - going to choose-plan');\r\n      return 'choose-plan';\r\n    }\r\n\r\n    // Has subscription, check beta onboarding\r\n    console.log('ðŸ” Checking beta onboarding status...');\r\n    try {\r\n      const hasCompletedOnboarding = await checkBetaOnboardingStatus(user.id);\r\n      \r\n      if (!hasCompletedOnboarding) {\r\n        console.log('âž¡ï¸ Beta onboarding incomplete - going to beta-onboarding');\r\n        return 'beta-onboarding';\r\n      }\r\n\r\n      console.log('âœ… All checks passed - going to dashboard');\r\n      return 'dashboard';\r\n    } catch (error) {\r\n      console.error('Error checking beta onboarding:', error);\r\n      // Fallback to dashboard if beta check fails\r\n      return 'dashboard';\r\n    }\r\n  };\r\n\r\n  // Update flow state with proper dependency management\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    let timeoutId: NodeJS.Timeout;\r\n    \r\n    const updateFlow = async () => {\r\n      if (!isMounted) return;\r\n      \r\n      try {\r\n        setState(prev => ({ ...prev, isLoading: true, error: null }));\r\n        \r\n        // Add timeout to prevent infinite loading\r\n        timeoutId = setTimeout(() => {\r\n          if (isMounted) {\r\n            console.warn('âš ï¸ Onboarding flow timeout - forcing fallback navigation');\r\n            const fallbackStep = user ? 'dashboard' : 'unauthenticated';\r\n            setState(prev => ({\r\n              ...prev,\r\n              currentStep: fallbackStep,\r\n              isLoading: false,\r\n              error: 'Loading timeout - using fallback navigation'\r\n            }));\r\n          }\r\n        }, 8000); // 8 second timeout\r\n        \r\n        const step = await determineStep();\r\n        const hasCompletedOnboarding = user ? await checkBetaOnboardingStatus(user.id) : false;\r\n        \r\n        if (!isMounted) return;\r\n        \r\n        clearTimeout(timeoutId);\r\n        setState(prev => ({\r\n          ...prev,\r\n          currentStep: step,\r\n          isLoading: false,\r\n          hasCompletedBetaOnboarding: hasCompletedOnboarding\r\n        }));\r\n        \r\n        console.log('ðŸš€ Onboarding Flow Update:', {\r\n          user: !!user,\r\n          hasSubscription: subscription?.subscribed,\r\n          hasCompletedOnboarding,\r\n          currentStep: step,\r\n          currentPath: location.pathname\r\n        });\r\n        \r\n      } catch (error) {\r\n        if (!isMounted) return;\r\n        clearTimeout(timeoutId);\r\n        console.error('Error determining onboarding step:', error);\r\n        const fallbackStep = user ? 'dashboard' : 'unauthenticated';\r\n        setState(prev => ({\r\n          ...prev,\r\n          currentStep: fallbackStep,\r\n          isLoading: false,\r\n          error: error instanceof Error ? error.message : 'Unknown error'\r\n        }));\r\n      }\r\n    };\r\n\r\n    // Only update if auth and subscription state are stable OR if we've been loading too long\r\n    if (!authLoading && !subscriptionLoading) {\r\n      updateFlow();\r\n    } else {\r\n      // Force update after 10 seconds even if still loading\r\n      const forceUpdateTimeout = setTimeout(() => {\r\n        if (isMounted) {\r\n          console.warn('âš ï¸ Forcing onboarding update due to prolonged loading');\r\n          updateFlow();\r\n        }\r\n      }, 10000);\r\n      \r\n      return () => {\r\n        isMounted = false;\r\n        clearTimeout(forceUpdateTimeout);\r\n        if (timeoutId) clearTimeout(timeoutId);\r\n      };\r\n    }\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      if (timeoutId) clearTimeout(timeoutId);\r\n    };\r\n  }, [user?.id, authLoading, subscription?.subscribed, subscriptionLoading]); // Minimal stable dependencies\r\n\r\n  // Navigation helpers\r\n  const navigateToStep = (step: OnboardingStep) => {\r\n    console.log('ðŸ”„ OnboardingFlow: Navigating to step:', step);\r\n    \r\n    // Prevent navigation during loading states\r\n    if (state.isLoading) return;\r\n    \r\n    switch (step) {\r\n      case 'unauthenticated':\r\n        navigate('/login', { replace: true });\r\n        break;\r\n      case 'choose-plan':\r\n        navigate('/choose-plan', { replace: true });\r\n        break;\r\n      case 'beta-onboarding':\r\n        // Stay on current page but show onboarding\r\n        break;\r\n      case 'dashboard':\r\n        // Try to restore previous route or go to default\r\n        const currentPath = window.location.pathname;\r\n        if (currentPath.startsWith('/dashboard')) {\r\n          // Already on dashboard, don't navigate\r\n          return;\r\n        }\r\n        navigate('/dashboard/learner', { replace: true });\r\n        break;\r\n    }\r\n  };\r\n\r\n  const completeOnboarding = async () => {\r\n    if (!user) return false;\r\n    \r\n    try {\r\n      const { error } = await supabase\r\n        .from('profiles')\r\n        .upsert({\r\n          id: user.id,\r\n          onboarding_completed: true,\r\n          updated_at: new Date().toISOString()\r\n        });\r\n\r\n      if (error) {\r\n        console.error('Error completing onboarding:', error);\r\n        return false;\r\n      }\r\n\r\n      setState(prev => ({\r\n        ...prev,\r\n        hasCompletedBetaOnboarding: true,\r\n        currentStep: 'dashboard'\r\n      }));\r\n\r\n      navigate('/dashboard/learner');\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error completing onboarding:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return {\r\n    ...state,\r\n    navigateToStep,\r\n    completeOnboarding,\r\n    shouldShowBetaOnboarding: state.currentStep === 'beta-onboarding'\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOpenLibrarySearch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOptimizedAccessibility.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[787,790],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[787,790],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1372,1375],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1372,1375],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { useUserProfile } from '@/hooks/useUserProfile';\r\n\r\ninterface AccessibilityState {\r\n  fontFamily: string;\r\n  textSize: number;\r\n  lineSpacing: number;\r\n  colorContrast: string;\r\n  comfortMode: string;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n}\r\n\r\nconst DEFAULT_ACCESSIBILITY_STATE: AccessibilityState = {\r\n  fontFamily: 'System',\r\n  textSize: 3,\r\n  lineSpacing: 3,\r\n  colorContrast: 'Standard',\r\n  comfortMode: 'Normal',\r\n  isLoading: false,\r\n  error: null,\r\n};\r\n\r\nexport const useOptimizedAccessibility = () => {\r\n  const { profile } = useUserProfile();\r\n  const [state, setState] = useState<AccessibilityState>(DEFAULT_ACCESSIBILITY_STATE);\r\n  const [appliedSettings, setAppliedSettings] = useState<any>(null);\r\n\r\n  // Memoize settings to prevent unnecessary re-renders\r\n  const currentSettings = useMemo(() => {\r\n    if (!profile) return null;\r\n    \r\n    return {\r\n      fontFamily: profile.font_family || 'System',\r\n      textSize: profile.text_size || 3,\r\n      lineSpacing: profile.line_spacing || 3,\r\n      colorContrast: profile.color_contrast || 'Standard',\r\n      comfortMode: profile.comfort_mode || 'Normal',\r\n    };\r\n  }, [profile]);\r\n\r\n  // Apply settings with error handling and performance optimization\r\n  const applyAccessibilitySettings = useCallback(async (settings: any) => {\r\n    if (!settings) return;\r\n\r\n    // Skip if settings haven't changed\r\n    if (appliedSettings && JSON.stringify(settings) === JSON.stringify(appliedSettings)) {\r\n      return;\r\n    }\r\n\r\n    setState(prev => ({ ...prev, isLoading: true, error: null }));\r\n\r\n    try {\r\n      const html = document.documentElement;\r\n      const body = document.body;\r\n\r\n      // Clear existing accessibility classes with error handling\r\n      try {\r\n        const existingClasses = Array.from(html.classList).filter(cls => \r\n          cls.startsWith('font-') || \r\n          cls.startsWith('high-') || \r\n          cls.startsWith('low-') || \r\n          cls.startsWith('focus-') ||\r\n          cls === 'accessibility-active'\r\n        );\r\n        html.classList.remove(...existingClasses);\r\n      } catch (error) {\r\n        console.warn('Error clearing existing classes:', error);\r\n      }\r\n\r\n      // Apply font with fallback handling\r\n      try {\r\n        const fontFamily = settings.fontFamily || 'System';\r\n        \r\n        switch (fontFamily) {\r\n          case 'OpenDyslexic':\r\n            html.classList.add('font-opendyslexic');\r\n            body.style.fontFamily = 'Atkinson Hyperlegible, Comic Sans MS, Trebuchet MS, Verdana, sans-serif';\r\n            break;\r\n          case 'Arial':\r\n            html.classList.add('font-arial');\r\n            body.style.fontFamily = 'Arial, Helvetica Neue, Helvetica, sans-serif';\r\n            break;\r\n          case 'Georgia':\r\n            html.classList.add('font-georgia');\r\n            body.style.fontFamily = 'Georgia, Times New Roman, Times, serif';\r\n            break;\r\n          case 'Cursive':\r\n            html.classList.add('font-cursive');\r\n            body.style.fontFamily = 'Dancing Script, Brush Script MT, cursive';\r\n            break;\r\n          case 'System':\r\n          default:\r\n            html.classList.add('font-system');\r\n            body.style.fontFamily = 'system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif';\r\n            break;\r\n        }\r\n      } catch (error) {\r\n        console.warn('Error applying font family:', error);\r\n        // Fallback to system font\r\n        body.style.fontFamily = 'system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif';\r\n      }\r\n\r\n      // Apply size and spacing with validation\r\n      try {\r\n        const baseSize = 16;\r\n        const textSize = Math.max(1, Math.min(5, settings.textSize || 3));\r\n        const lineSpacing = Math.max(1, Math.min(5, settings.lineSpacing || 3));\r\n        \r\n        const sizeMultiplier = 0.75 + (textSize - 1) * 0.125;\r\n        const fontSize = `${baseSize * sizeMultiplier}px`;\r\n        const lineHeightValue = 1 + (lineSpacing - 1) * 0.25;\r\n        \r\n        html.style.setProperty('--accessibility-font-size', fontSize);\r\n        html.style.setProperty('--accessibility-line-height', lineHeightValue.toString());\r\n      } catch (error) {\r\n        console.warn('Error applying text size/spacing:', error);\r\n        // Fallback to default values\r\n        html.style.setProperty('--accessibility-font-size', '16px');\r\n        html.style.setProperty('--accessibility-line-height', '1.5');\r\n      }\r\n\r\n      // Apply contrast and comfort modes with error handling\r\n      try {\r\n        if (settings.colorContrast === 'High') {\r\n          html.classList.add('high-contrast');\r\n        }\r\n        \r\n        if (settings.comfortMode === 'Focus Mode') {\r\n          html.classList.add('focus-mode');\r\n        } else if (settings.comfortMode === 'Low-Stimulus') {\r\n          html.classList.add('low-stimulus');\r\n        }\r\n      } catch (error) {\r\n        console.warn('Error applying contrast/comfort modes:', error);\r\n      }\r\n\r\n      html.classList.add('accessibility-active');\r\n      setAppliedSettings(settings);\r\n      \r\n      setState(prev => ({\r\n        ...prev,\r\n        ...settings,\r\n        isLoading: false,\r\n        error: null,\r\n      }));\r\n\r\n      console.log('âœ… Accessibility settings applied successfully:', settings);\r\n    } catch (error) {\r\n      console.error('âŒ Failed to apply accessibility settings:', error);\r\n      setState(prev => ({\r\n        ...prev,\r\n        isLoading: false,\r\n        error: 'Failed to apply accessibility settings. Please try refreshing the page.',\r\n      }));\r\n    }\r\n  }, [appliedSettings]);\r\n\r\n  // Apply settings when profile changes\r\n  useEffect(() => {\r\n    if (currentSettings) {\r\n      applyAccessibilitySettings(currentSettings);\r\n    }\r\n  }, [currentSettings, applyAccessibilitySettings]);\r\n\r\n  // Provide fallback when no profile is available\r\n  useEffect(() => {\r\n    if (!profile && !appliedSettings) {\r\n      setState(DEFAULT_ACCESSIBILITY_STATE);\r\n    }\r\n  }, [profile, appliedSettings]);\r\n\r\n  const getAccessibilityClasses = useCallback((element: 'card' | 'container' | 'text' = 'container') => {\r\n    const baseClasses = 'transition-all duration-200';\r\n    \r\n    switch (element) {\r\n      case 'card':\r\n        return `${baseClasses} bg-card text-card-foreground border-border`;\r\n      case 'text':\r\n        return `${baseClasses} ${state.colorContrast === 'High' ? 'text-black' : 'text-foreground'}`;\r\n      case 'container':\r\n      default:\r\n        return `${baseClasses} bg-background text-foreground`;\r\n    }\r\n  }, [state.colorContrast]);\r\n\r\n  return {\r\n    ...state,\r\n    getAccessibilityClasses,\r\n    isHighContrast: state.colorContrast === 'High',\r\n    applySettings: applyAccessibilitySettings,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOptimizedEPUBLoader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[840,843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[840,843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[886,889],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[886,889],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1081,1084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1081,1084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3590,3593],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3590,3593],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { PublicDomainBook } from '@/types/publicDomainBooks';\r\n\r\nexport interface EPUBLoadingProgress {\r\n  stage: 'downloading' | 'processing' | 'ready';\r\n  percentage: number;\r\n  message: string;\r\n  bytesLoaded?: number;\r\n  totalBytes?: number;\r\n  estimatedTimeRemaining?: number;\r\n}\r\n\r\nexport interface EPUBLoadError {\r\n  type: 'network' | 'timeout' | 'parsing' | 'unknown';\r\n  message: string;\r\n  recoverable: boolean;\r\n  retryCount: number;\r\n}\r\n\r\nexport const useOptimizedEPUBLoader = (book: PublicDomainBook) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [progress, setProgress] = useState<EPUBLoadingProgress | null>(null);\r\n  const [error, setError] = useState<EPUBLoadError | null>(null);\r\n  const [epubInstance, setEpubInstance] = useState<any>(null);\r\n  const [toc, setToc] = useState<any[]>([]);\r\n  \r\n  const retryCountRef = useRef(0);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n  const startTimeRef = useRef<number>(0);\r\n  const epubModuleRef = useRef<any>(null);\r\n  \r\n  const MAX_RETRIES = 4; // Increased retries for better reliability\r\n  const BASE_TIMEOUT = 45000; // Base 45 seconds\r\n  const MAX_TIMEOUT = 120000; // Max 2 minutes\r\n\r\n  const updateProgress = useCallback((\r\n    stage: EPUBLoadingProgress['stage'],\r\n    percentage: number,\r\n    message: string,\r\n    bytesLoaded?: number,\r\n    totalBytes?: number\r\n  ) => {\r\n    const elapsed = Date.now() - startTimeRef.current;\r\n    const estimatedTimeRemaining = percentage > 5 && percentage < 95\r\n      ? Math.round(((elapsed / percentage) * (100 - percentage)) / 1000)\r\n      : undefined;\r\n\r\n    setProgress({\r\n      stage,\r\n      percentage,\r\n      message,\r\n      bytesLoaded,\r\n      totalBytes,\r\n      estimatedTimeRemaining\r\n    });\r\n  }, []);\r\n\r\n  const getOptimalEPUBUrl = useCallback(() => {\r\n    const urls = [];\r\n    \r\n    // PRIORITY 1: Storage URL (fastest and most reliable)\r\n    if (book.storage_url && book.download_status === 'completed') {\r\n      console.log('ðŸ“š Using optimized storage URL');\r\n      urls.push(book.storage_url);\r\n    }\r\n    \r\n    // PRIORITY 2: Direct Gutenberg URLs\r\n    if (book.gutenberg_id) {\r\n      urls.push(`https://www.gutenberg.org/ebooks/${book.gutenberg_id}.epub.noimages`);\r\n      urls.push(`https://www.gutenberg.org/cache/epub/${book.gutenberg_id}/pg${book.gutenberg_id}.epub`);\r\n      urls.push(`https://www.gutenberg.org/files/${book.gutenberg_id}/${book.gutenberg_id}-0.epub`);\r\n    }\r\n    \r\n    // PRIORITY 3: Backup URLs if available\r\n    if (book.backup_urls?.length) {\r\n      urls.push(...book.backup_urls);\r\n    }\r\n    \r\n    // PRIORITY 4: Original EPUB URL\r\n    urls.push(book.epub_url);\r\n    \r\n    // PRIORITY 5: Proxy URL as last resort\r\n    const proxyUrl = `https://zgcegkmqfgznbpdplscz.supabase.co/functions/v1/epub-proxy?url=${encodeURIComponent(book.epub_url)}&timeout=120`;\r\n    urls.push(proxyUrl);\r\n    \r\n    // Return the URL to try based on retry count\r\n    const urlIndex = Math.min(retryCountRef.current, urls.length - 1);\r\n    const selectedUrl = urls[urlIndex];\r\n    \r\n    console.log(`ðŸ”— URL Strategy ${urlIndex + 1}/${urls.length}:`, \r\n      selectedUrl.includes('storage') ? 'Storage (Fast)' :\r\n      selectedUrl.includes('gutenberg.org') ? 'Direct Gutenberg' :\r\n      selectedUrl.includes('proxy') ? 'Proxy Fallback' : 'Standard');\r\n    \r\n    return selectedUrl;\r\n  }, [book.storage_url, book.download_status, book.epub_url, book.gutenberg_id, book.backup_urls]);\r\n\r\n  const createOptimizedError = useCallback((\r\n    error: any,\r\n    type: EPUBLoadError['type'] = 'unknown'\r\n  ): EPUBLoadError => {\r\n    let message = 'Unable to load this book';\r\n    let recoverable = retryCountRef.current < MAX_RETRIES;\r\n\r\n    if (error.message?.includes('timeout') || error.name === 'TimeoutError') {\r\n      type = 'timeout';\r\n      message = book.storage_url \r\n        ? `Book is taking longer than expected to download. Trying alternative servers...`\r\n        : `Large book detected. Using faster download methods...`;\r\n    } else if (error.message?.includes('Failed to fetch') || error.message?.includes('NetworkError')) {\r\n      type = 'network';\r\n      message = book.storage_url \r\n        ? 'Storage temporarily unavailable. Trying Project Gutenberg directly...'\r\n        : 'Connection issue detected. Trying alternative download methods...';\r\n    } else if (error.message?.includes('parse') || error.message?.includes('invalid')) {\r\n      type = 'parsing';\r\n      message = 'Book file appears corrupted. Trying alternative sources...';\r\n      recoverable = true;\r\n    }\r\n\r\n    return { type, message, recoverable, retryCount: retryCountRef.current };\r\n  }, [book.storage_url]);\r\n\r\n  const cleanup = useCallback(() => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n      abortControllerRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const loadEPUB = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      setProgress(null);\r\n      setEpubInstance(null);\r\n      setToc([]);\r\n      startTimeRef.current = Date.now();\r\n      \r\n      cleanup();\r\n      abortControllerRef.current = new AbortController();\r\n      \r\n      console.log(`ðŸ“– Starting optimized EPUB load attempt ${retryCountRef.current + 1}/${MAX_RETRIES + 1} for:`, book.title);\r\n      \r\n      updateProgress('downloading', 10, 'Initializing optimized reader...');\r\n      \r\n      // Load EPUB.js module if not already loaded\r\n      if (!epubModuleRef.current) {\r\n        updateProgress('downloading', 20, 'Loading EPUB engine...');\r\n        epubModuleRef.current = await import('epubjs');\r\n      }\r\n      \r\n      const EPubLib = epubModuleRef.current.default;\r\n      \r\n      const epubUrl = getOptimalEPUBUrl();\r\n      const isStorageUrl = epubUrl.includes('storage');\r\n      const isProxyUrl = epubUrl.includes('proxy');\r\n      \r\n      updateProgress('downloading', 30, \r\n        isStorageUrl ? 'Connecting to optimized storage...' :\r\n        isProxyUrl ? 'Using enhanced proxy server...' :\r\n        'Connecting to Project Gutenberg...'\r\n      );\r\n      \r\n      // Progressive timeout based on source and retry count\r\n      const timeout = isStorageUrl ? 30000 : // Storage should be fast\r\n                     isProxyUrl ? MAX_TIMEOUT : // Proxy gets max time\r\n                     Math.min(BASE_TIMEOUT + (retryCountRef.current * 15000), MAX_TIMEOUT);\r\n      \r\n      console.log(`â±ï¸ Using ${timeout / 1000}s timeout for ${isStorageUrl ? 'storage' : isProxyUrl ? 'proxy' : 'direct'} download`);\r\n      \r\n      updateProgress('downloading', 50, \r\n        isStorageUrl ? 'Loading from optimized storage...' :\r\n        'Downloading book content...'\r\n      );\r\n      \r\n      // Create EPUB instance with enhanced error handling\r\n      const newEpubInstance = EPubLib(epubUrl);\r\n      \r\n      // Set up timeout\r\n      const timeoutId = setTimeout(() => {\r\n        console.log(`â° Timeout reached after ${timeout / 1000}s`);\r\n        abortControllerRef.current?.abort();\r\n      }, timeout);\r\n      \r\n      updateProgress('processing', 70, 'Processing book structure...');\r\n      \r\n      // Wait for book to be ready\r\n      await Promise.race([\r\n        newEpubInstance.ready,\r\n        new Promise((_, reject) => {\r\n          abortControllerRef.current?.signal.addEventListener('abort', () => {\r\n            reject(new Error(`Book loading timed out after ${timeout / 1000} seconds`));\r\n          });\r\n        })\r\n      ]);\r\n      \r\n      clearTimeout(timeoutId);\r\n      console.log('âœ… EPUB instance ready');\r\n      \r\n      setEpubInstance(newEpubInstance);\r\n      \r\n      updateProgress('processing', 85, 'Loading navigation...');\r\n      \r\n      // Load navigation with extended timeout for complex books\r\n      try {\r\n        await Promise.race([\r\n          newEpubInstance.loaded.navigation.then(() => {\r\n            const tocItems = newEpubInstance.navigation?.toc || [];\r\n            setToc(tocItems);\r\n            console.log('ðŸ“š Navigation loaded:', tocItems.length, 'items');\r\n          }),\r\n          new Promise((_, reject) => \r\n            setTimeout(() => reject(new Error('Navigation timeout')), 15000)\r\n          )\r\n        ]);\r\n      } catch (navError) {\r\n        console.warn('âš ï¸ Navigation loading failed, continuing without TOC');\r\n        setToc([]);\r\n      }\r\n      \r\n      updateProgress('ready', 100, 'Book ready to read!');\r\n      \r\n      // Small delay for smooth UX\r\n      await new Promise(resolve => setTimeout(resolve, 500));\r\n      \r\n      setIsLoading(false);\r\n      setProgress(null);\r\n      retryCountRef.current = 0;\r\n      \r\n      console.log('âœ… Optimized EPUB loading completed successfully');\r\n      \r\n    } catch (err) {\r\n      console.error(`âŒ EPUB loading error (attempt ${retryCountRef.current + 1}):`, err);\r\n      \r\n      const optimizedError = createOptimizedError(err);\r\n      \r\n      if (optimizedError.recoverable && retryCountRef.current < MAX_RETRIES) {\r\n        retryCountRef.current++;\r\n        const retryDelay = 1500 + (retryCountRef.current * 1500); // Progressive delay\r\n        \r\n        console.log(`ðŸ”„ Retrying with next strategy... Attempt ${retryCountRef.current}/${MAX_RETRIES}`);\r\n        updateProgress('downloading', 5, \r\n          `Trying alternative download method... (${retryCountRef.current}/${MAX_RETRIES})`\r\n        );\r\n        \r\n        setTimeout(() => {\r\n          loadEPUB();\r\n        }, retryDelay);\r\n        \r\n        return;\r\n      }\r\n      \r\n      setError(optimizedError);\r\n      setIsLoading(false);\r\n      setProgress(null);\r\n    }\r\n  }, [book, updateProgress, createOptimizedError, getOptimalEPUBUrl, cleanup]);\r\n\r\n  const retryLoad = useCallback(() => {\r\n    console.log('ðŸ”„ Manual retry requested');\r\n    retryCountRef.current = 0;\r\n    setError(null);\r\n    loadEPUB();\r\n  }, [loadEPUB]);\r\n\r\n  const abortLoad = useCallback(() => {\r\n    console.log('ðŸ›‘ Load aborted by user');\r\n    cleanup();\r\n    setIsLoading(false);\r\n    setProgress(null);\r\n    setError(null);\r\n  }, [cleanup]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      cleanup();\r\n      if (epubInstance && typeof epubInstance.destroy === 'function') {\r\n        try {\r\n          epubInstance.destroy();\r\n        } catch (err) {\r\n          console.warn('EPUB cleanup error (non-critical):', err);\r\n        }\r\n      }\r\n    };\r\n  }, [cleanup, epubInstance]);\r\n\r\n  return {\r\n    isLoading,\r\n    progress,\r\n    error,\r\n    epubInstance,\r\n    toc,\r\n    loadEPUB,\r\n    retryLoad,\r\n    abortLoad\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOptimizedEPUBRendition.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgAssignments.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgBranding.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgCourses.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgGoals.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[549,552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[549,552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":163,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4501,4504],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4501,4504],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { assertOrg } from '@/lib/org/context';\r\n\r\nexport interface OrgGoal {\r\n  id: string;\r\n  organization_id: string;\r\n  created_by: string;\r\n  student_id: string;\r\n  title: string;\r\n  description: string;\r\n  category: string;\r\n  folder_path: string;\r\n  target_date: string;\r\n  status: string;\r\n  priority: string;\r\n  progress_percentage: number;\r\n  metadata: any;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface GoalTarget {\r\n  goal_id: string;\r\n  user_id: string;\r\n  progress: number;\r\n  status: 'active' | 'completed' | 'paused';\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport function useOrgGoals() {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n  const orgId = assertOrg();\r\n\r\n  const { data: goals = [], isLoading, error, refetch } = useQuery({\r\n    queryKey: ['org-goals', orgId],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('org_goals')\r\n        .select('*')\r\n        .eq('organization_id', orgId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching org goals:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as OrgGoal[];\r\n    },\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n\r\n  const createGoalMutation = useMutation({\r\n    mutationFn: async (goalData: { title: string; description: string; category: string; student_id: string; priority: string }) => {\r\n      // Create goal using existing table structure\r\n      const { data: goalResult, error: goalError } = await supabase\r\n        .from('org_goals')\r\n        .insert({\r\n          ...goalData,\r\n          organization_id: orgId,\r\n          created_by: (await supabase.auth.getUser()).data.user?.id,\r\n          folder_path: '/',\r\n          target_date: new Date().toISOString().split('T')[0],\r\n          status: 'active',\r\n          progress_percentage: 0,\r\n          metadata: {},\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (goalError) throw goalError;\r\n      return goalResult;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-goals'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Goal created successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error creating goal:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create goal.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const updateGoalMutation = useMutation({\r\n    mutationFn: async (goalData: Partial<OrgGoal> & { id: string }) => {\r\n      const { id, ...updateData } = goalData;\r\n      const { data, error } = await supabase\r\n        .from('org_goals')\r\n        .update(updateData)\r\n        .eq('id', id)\r\n        .eq('organization_id', orgId)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-goals'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Goal updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error updating goal:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update goal.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    goals,\r\n    isLoading,\r\n    error,\r\n    refetch,\r\n    createGoal: createGoalMutation.mutate,\r\n    updateGoal: updateGoalMutation.mutate,\r\n    isCreating: createGoalMutation.isPending,\r\n    isUpdating: updateGoalMutation.isPending,\r\n  };\r\n}\r\n\r\nexport function useGoalTargets(goalId?: string) {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: targets = [], isLoading } = useQuery({\r\n    queryKey: ['goal-targets', goalId],\r\n    queryFn: async () => {\r\n      if (!goalId) return [];\r\n      \r\n      const { data, error } = await supabase\r\n        .from('org_goal_targets')\r\n        .select(`\r\n          *,\r\n          profiles:user_id (\r\n            display_name,\r\n            full_name\r\n          )\r\n        `)\r\n        .eq('goal_id', goalId);\r\n\r\n      if (error) {\r\n        console.error('Error fetching goal targets:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as (GoalTarget & { profiles: any })[];\r\n    },\r\n    enabled: !!goalId,\r\n  });\r\n\r\n  const updateTargetMutation = useMutation({\r\n    mutationFn: async (targetData: Partial<GoalTarget> & { goal_id: string; user_id: string }) => {\r\n      const { data, error } = await supabase\r\n        .from('org_goal_targets')\r\n        .update(targetData)\r\n        .eq('goal_id', targetData.goal_id)\r\n        .eq('user_id', targetData.user_id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['goal-targets'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Goal progress updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error updating goal target:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update goal progress.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    targets,\r\n    isLoading,\r\n    updateTarget: updateTargetMutation.mutate,\r\n    isUpdating: updateTargetMutation.isPending,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgInvitations.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1112,1115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1112,1115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3043,3046],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3043,3046],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3764,3767],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3764,3767],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":224,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6410,6413],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6410,6413],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport type { OrgInvitation } from '@/types/organization';\r\n\r\nexport function useOrgInvitations(organizationId?: string) {\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  // Fetch invitations\r\n  const {\r\n    data: invitations,\r\n    isLoading,\r\n    error,\r\n  } = useQuery<OrgInvitation[]>({\r\n    queryKey: ['orgInvitations', organizationId],\r\n    queryFn: async () => {\r\n      if (!organizationId) return [];\r\n\r\n      const { data, error } = await supabase\r\n        .from('org_invites')\r\n        .select(`\r\n          *,\r\n          organizations (\r\n            id,\r\n            name,\r\n            slug\r\n          )\r\n        `)\r\n        .eq('org_id', organizationId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n\r\n      return data.map((invite: any) => ({\r\n        id: invite.id,\r\n        org_id: invite.org_id,\r\n        created_by: invite.created_by,\r\n        email: invite.email,\r\n        code: invite.code,\r\n        token: invite.token,\r\n        status: invite.status,\r\n        expires_at: invite.expires_at,\r\n        max_uses: invite.max_uses || 1,\r\n        uses_count: invite.uses_count || 0,\r\n        role: invite.role,\r\n        metadata: invite.metadata || {},\r\n        created_at: invite.created_at,\r\n        organizations: invite.organizations\r\n      }));\r\n    },\r\n    enabled: !!organizationId && !!user,\r\n  });\r\n\r\n  // Create invitation\r\n  const createInvitation = useMutation({\r\n    mutationFn: async ({ \r\n      email, \r\n      maxUses, \r\n      expiresInDays, \r\n      role \r\n    }: { \r\n      email?: string; \r\n      maxUses: number; \r\n      expiresInDays: number;\r\n      role: string;\r\n    }) => {\r\n      if (!organizationId) throw new Error('Organization ID is required');\r\n\r\n      const expiresAt = new Date();\r\n      expiresAt.setDate(expiresAt.getDate() + expiresInDays);\r\n\r\n      // Generate invitation code\r\n      const code = Math.random().toString(36).substring(2, 10).toUpperCase();\r\n\r\n      const { data, error } = await supabase\r\n        .from('org_invites')\r\n        .insert([\r\n          {\r\n            org_id: organizationId,\r\n            email: email || null,\r\n            code,\r\n            role,\r\n            max_uses: maxUses,\r\n            uses_count: 0,\r\n            status: 'pending',\r\n            expires_at: expiresAt.toISOString(),\r\n            created_by: user?.id\r\n          }\r\n        ])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['orgInvitations', organizationId] });\r\n      toast({\r\n        title: 'Success',\r\n        description: 'Invitation created successfully',\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: 'Error creating invitation',\r\n        description: error.message,\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n\r\n  // Deactivate invitation\r\n  const deactivateInvitation = useMutation({\r\n    mutationFn: async (invitationId: string) => {\r\n      const { error } = await supabase\r\n        .from('org_invites')\r\n        .update({ status: 'expired' })\r\n        .eq('id', invitationId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['orgInvitations', organizationId] });\r\n      toast({\r\n        title: 'Success',\r\n        description: 'Invitation deactivated',\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: 'Error deactivating invitation',\r\n        description: error.message,\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n\r\n  // Process invitation (for users accepting invites)\r\n  const processInvitation = useMutation({\r\n    mutationFn: async ({ code, token }: { code?: string; token?: string }) => {\r\n      if (!code && !token) throw new Error('Code or token is required');\r\n\r\n      let invitation;\r\n\r\n      if (code) {\r\n        const { data, error } = await supabase\r\n          .from('org_invites')\r\n          .select(`\r\n            *,\r\n            organizations (\r\n              id,\r\n              name,\r\n              slug\r\n            )\r\n          `)\r\n          .eq('code', code)\r\n          .gt('expires_at', new Date().toISOString())\r\n          .eq('status', 'pending')\r\n          .single();\r\n\r\n        if (error || !data) {\r\n          throw new Error('Invalid invitation code or expired invitation.');\r\n        }\r\n\r\n        invitation = data;\r\n      }\r\n\r\n      if (!invitation) throw new Error('Invitation not found');\r\n\r\n      // Check if invitation has reached max uses\r\n      if (invitation.uses_count >= invitation.max_uses) {\r\n        throw new Error('This invitation code has already been used the maximum number of times.');\r\n      }\r\n\r\n      // Check if user is already a member\r\n      const { data: existingMember } = await supabase\r\n        .from('org_members')\r\n        .select('id')\r\n        .eq('org_id', invitation.org_id)\r\n        .eq('user_id', user?.id)\r\n        .maybeSingle();\r\n\r\n      if (existingMember) {\r\n        throw new Error('You are already a member of this organization.');\r\n      }\r\n\r\n      // Add user as member\r\n      const { error: memberError } = await supabase\r\n        .from('org_members')\r\n        .insert({\r\n          org_id: invitation.org_id,\r\n          user_id: user?.id,\r\n          role: invitation.role,\r\n          status: 'active'\r\n        });\r\n\r\n      if (memberError) throw memberError;\r\n\r\n      // Update invitation usage\r\n      await supabase\r\n        .from('org_invites')\r\n        .update({\r\n          uses_count: (invitation.uses_count || 0) + 1,\r\n          status: (invitation.uses_count + 1) >= invitation.max_uses ? 'accepted' : 'pending'\r\n        })\r\n        .eq('id', invitation.id);\r\n\r\n      return {\r\n        orgName: invitation.organizations?.name,\r\n        orgSlug: invitation.organizations?.slug,\r\n        role: invitation.role\r\n      };\r\n    },\r\n    onSuccess: (data) => {\r\n      toast({\r\n        title: 'Welcome!',\r\n        description: `You have successfully joined ${data.orgName}.`,\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: 'Error joining organization',\r\n        description: error.message,\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    invitations: invitations || [],\r\n    isLoading,\r\n    error,\r\n    createInvitation: createInvitation.mutate,\r\n    deactivateInvitation: deactivateInvitation.mutate,\r\n    processInvitation: processInvitation.mutate,\r\n    isCreating: createInvitation.isPending,\r\n    isDeactivating: deactivateInvitation.isPending,\r\n    isProcessing: processInvitation.isPending,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgInvites.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgMemberManagement.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgMembers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgNoteFolders.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgNotes.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[726,729],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[726,729],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1493,1496],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1493,1496],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { assertOrg } from '@/lib/org/context';\r\n\r\nexport interface OrgNoteFolder {\r\n  id: string;\r\n  org_id: string;\r\n  name: string;\r\n  created_by: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface OrgNote {\r\n  id: string;\r\n  organization_id: string;\r\n  created_by: string;\r\n  student_id: string;\r\n  title: string;\r\n  content: string;\r\n  category: string;\r\n  folder_path: string;\r\n  visibility_scope: 'student-only' | 'instructor-visible' | 'org-public';\r\n  is_private: boolean;\r\n  tags: string[];\r\n  metadata: any;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface NoteTarget {\r\n  note_id: string;\r\n  user_id: string;\r\n  created_at: string;\r\n}\r\n\r\nexport function useOrgNoteFolders() {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n  const orgId = assertOrg();\r\n\r\n  const { data: folders = [], isLoading, error, refetch } = useQuery({\r\n    queryKey: ['org-note-folders', orgId],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('org_note_folders')\r\n        .select('*')\r\n        .eq('org_id', orgId)\r\n        .order('name', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('Error fetching org note folders:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as any[];\r\n    },\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n\r\n  const createFolderMutation = useMutation({\r\n    mutationFn: async (folderData: { name: string }) => {\r\n      const { data, error } = await supabase\r\n        .from('org_note_folders')\r\n        .insert({\r\n          ...folderData,\r\n          org_id: orgId,\r\n          created_by: (await supabase.auth.getUser()).data.user?.id,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-note-folders'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Folder created successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error creating folder:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create folder.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    folders,\r\n    isLoading,\r\n    error,\r\n    refetch,\r\n    createFolder: createFolderMutation.mutate,\r\n    isCreating: createFolderMutation.isPending,\r\n  };\r\n}\r\n\r\nexport function useOrgNotes(folderId?: string) {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n  const orgId = assertOrg();\r\n\r\n  const { data: notes = [], isLoading, error, refetch } = useQuery({\r\n    queryKey: ['org-notes', orgId, folderId],\r\n    queryFn: async () => {\r\n      let query = supabase\r\n        .from('org_notes')\r\n        .select('*')\r\n        .eq('organization_id', orgId);\r\n\r\n      if (folderId) {\r\n        query = query.eq('folder_path', `/${folderId}/`);\r\n      }\r\n\r\n      const { data, error } = await query.order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching org notes:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as OrgNote[];\r\n    },\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n\r\n  const createNoteMutation = useMutation({\r\n    mutationFn: async (noteData: { title: string; content: string; category: string; student_id: string; folder_path?: string }) => {\r\n      // Create note using existing table structure\r\n      const { data: noteResult, error: noteError } = await supabase\r\n        .from('org_notes')\r\n        .insert({\r\n          ...noteData,\r\n          organization_id: orgId,\r\n          created_by: (await supabase.auth.getUser()).data.user?.id,\r\n          folder_path: noteData.folder_path || '/',\r\n          visibility_scope: 'org-public' as const,\r\n          is_private: false,\r\n          tags: [],\r\n          metadata: {},\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (noteError) throw noteError;\r\n      return noteResult;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-notes'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Note created successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error creating note:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create note.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const updateNoteMutation = useMutation({\r\n    mutationFn: async (noteData: Partial<OrgNote> & { id: string }) => {\r\n      const { id, ...updateData } = noteData;\r\n      const { data, error } = await supabase\r\n        .from('org_notes')\r\n        .update(updateData)\r\n        .eq('id', id)\r\n        .eq('organization_id', orgId)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-notes'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Note updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error updating note:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update note.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    notes,\r\n    isLoading,\r\n    error,\r\n    refetch,\r\n    createNote: createNoteMutation.mutate,\r\n    updateNote: updateNoteMutation.mutate,\r\n    isCreating: createNoteMutation.isPending,\r\n    isUpdating: updateNoteMutation.isPending,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgPermissions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrgStatistics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrganization.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3191,3194],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3191,3194],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":137,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4071,4074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4071,4074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":232,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":232,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7173,7176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7173,7176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport type { Organization, OrgMember, OrgInvitation, OrgGoal, OrgNote, OrgSubscriptionTier } from '@/types/organization';\r\n\r\nexport function useOrganizations() {\r\n  const { user } = useAuth();\r\n\r\n  return useQuery({\r\n    queryKey: ['organizations', user?.id],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      \r\n      console.log('Organizations data:', data);\r\n      \r\n      return data as Organization[];\r\n    },\r\n    enabled: !!user,\r\n  });\r\n}\r\n\r\nexport function useOrganization(orgId: string) {\r\n  return useQuery({\r\n    queryKey: ['organization', orgId],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .select('*')\r\n        .eq('id', orgId)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      \r\n      console.log('Organization data:', data);\r\n      \r\n      return data as Organization;\r\n    },\r\n    enabled: !!orgId,\r\n  });\r\n}\r\n\r\nexport function useOrgMembers(orgId: string) {\r\n  return useQuery({\r\n    queryKey: ['org-members', orgId],\r\n    queryFn: async () => {\r\n      console.log('useOrgMembers: Fetching members for org:', orgId);\r\n      \r\n      // Fetch org members and profiles separately, then join manually\r\n      const { data: orgMembers, error: membersError } = await supabase\r\n        .from('org_members')\r\n        .select('*')\r\n        .eq('org_id', orgId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (membersError) {\r\n        console.error('useOrgMembers members error:', membersError);\r\n        throw membersError;\r\n      }\r\n\r\n      // Fetch user profiles separately\r\n      const userIds = orgMembers?.map(m => m.user_id) || [];\r\n      if (userIds.length === 0) {\r\n        console.log('useOrgMembers: No members found');\r\n        return [];\r\n      }\r\n\r\n      const { data: profiles, error: profilesError } = await supabase\r\n        .from('profiles')\r\n        .select('id, full_name, display_name')\r\n        .in('id', userIds);\r\n\r\n      if (profilesError) {\r\n        console.warn('useOrgMembers profiles error:', profilesError);\r\n      }\r\n\r\n      // Manual join\r\n      const result = orgMembers?.map(member => ({\r\n        ...member,\r\n        profiles: profiles?.find(p => p.id === member.user_id) || null\r\n      })) || [];\r\n\r\n      console.log('useOrgMembers: Manual join result:', result);\r\n      return result as OrgMember[];\r\n    },\r\n    enabled: !!orgId,\r\n  });\r\n}\r\n\r\nexport function useOrgInvitations(orgId: string) {\r\n  return useQuery({\r\n    queryKey: ['org-invitations', orgId],\r\n    queryFn: async () => {\r\n        const { data, error } = await supabase\r\n          .from('org_invites')\r\n          .select('*')\r\n          .eq('org_id', orgId)\r\n          .order('created_at', { ascending: false });\r\n\r\n        if (error) throw error;\r\n        return data?.map((inv: any) => ({\r\n          id: inv.id,\r\n          org_id: inv.org_id,\r\n          created_by: inv.created_by,\r\n          email: inv.email,\r\n          code: inv.code,\r\n          token: inv.token,\r\n          status: inv.status,\r\n          expires_at: inv.expires_at,\r\n          max_uses: inv.max_uses || 1,\r\n          uses_count: inv.uses_count || 0,\r\n          role: inv.role,\r\n          metadata: inv.metadata || {},\r\n          created_at: inv.created_at,\r\n        })) || [];\r\n    },\r\n    enabled: !!orgId,\r\n  });\r\n}\r\n\r\nexport function useCreateOrganization() {\r\n  const queryClient = useQueryClient();\r\n  const { toast } = useToast();\r\n  const { user } = useAuth();\r\n\r\n  return useMutation({\r\n    mutationFn: async (orgInput: {\r\n      name: string;\r\n      description?: string;\r\n      subscription_tier: OrgSubscriptionTier;\r\n      seat_limit: number;\r\n      settings?: Record<string, any>;\r\n    }) => {\r\n      // Ensure user is authenticated\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) {\r\n        throw new Error('You must be signed in to create an organization.');\r\n      }\r\n\r\n      // Explicitly set owner_id to current user\r\n      const organizationData = {\r\n        name: orgInput.name,\r\n        description: orgInput.description,\r\n        owner_id: user.id, // REQUIRED for RLS policy\r\n        subscription_tier: orgInput.subscription_tier,\r\n        seat_limit: orgInput.seat_limit,\r\n        settings: orgInput.settings || {},\r\n        is_beta_access: orgInput.subscription_tier === 'beta',\r\n        beta_expiration_date: orgInput.subscription_tier === 'beta' \r\n          ? new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString()\r\n          : null,\r\n      };\r\n\r\n      console.log('Creating organization with data:', organizationData);\r\n\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .insert(organizationData)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Organization creation error:', error);\r\n        throw error;\r\n      }\r\n\r\n      console.log('Organization created successfully:', data);\r\n\r\n      // Create owner membership record\r\n      const { error: memberError } = await supabase\r\n        .from('org_members')\r\n        .insert({\r\n          org_id: data.id,\r\n          user_id: user.id,\r\n          role: 'owner',\r\n          status: 'active',\r\n          joined_at: new Date().toISOString(),\r\n        });\r\n\r\n      if (memberError) {\r\n        console.error('Error creating owner membership:', memberError);\r\n        // Clean up the organization if member creation fails\r\n        await supabase.from('organizations').delete().eq('id', data.id);\r\n        throw memberError;\r\n      }\r\n\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      toast({\r\n        title: 'Organization created',\r\n        description: 'Your organization has been created successfully.',\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Organization creation failed:', error);\r\n      let errorMessage = 'Failed to create organization';\r\n      \r\n      if (error.message.includes('row-level security')) {\r\n        errorMessage = 'Authentication required. Please sign in and try again.';\r\n      } else if (error.message.includes('You must be signed in')) {\r\n        errorMessage = 'Please sign in to create an organization.';\r\n      } else if (error instanceof Error) {\r\n        errorMessage = error.message;\r\n      }\r\n\r\n      toast({\r\n        title: 'Error creating organization',\r\n        description: errorMessage,\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useInviteToOrganization() {\r\n  const queryClient = useQueryClient();\r\n  const { toast } = useToast();\r\n\r\n  return useMutation({\r\n    mutationFn: async (invitation: {\r\n      organization_id: string;\r\n      email?: string;\r\n      generate_code?: boolean;\r\n    }) => {\r\n      const inviteData: any = {\r\n        org_id: invitation.organization_id,\r\n        created_by: (await supabase.auth.getUser()).data.user?.id,\r\n        role: 'student', // Default role for invitations\r\n        max_uses: 1,\r\n        expires_at: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(), // 7 days\r\n      };\r\n\r\n      if (invitation.email) {\r\n        inviteData.email = invitation.email;\r\n      }\r\n\r\n      // Always generate a code for invitations (needed for email links and manual codes)\r\n      const { data: codeData } = await supabase.rpc('generate_invitation_code');\r\n      inviteData.code = codeData;\r\n\r\n      const { data, error } = await supabase\r\n        .from('org_invites')\r\n        .insert(inviteData)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Send email if email was provided\r\n      if (invitation.email && data.code) {\r\n        try {\r\n          // Get organization details\r\n          const { data: orgData } = await supabase\r\n            .from('organizations')\r\n            .select('name')\r\n            .eq('id', invitation.organization_id)\r\n            .single();\r\n\r\n          // Get current user for inviter name\r\n          const { data: { user } } = await supabase.auth.getUser();\r\n          const { data: profile } = await supabase\r\n            .from('profiles')\r\n            .select('display_name, full_name')\r\n            .eq('id', user?.id)\r\n            .single();\r\n\r\n          const inviterName = profile?.display_name || profile?.full_name || 'Someone';\r\n\r\n          await supabase.functions.invoke('send-invitation-email', {\r\n            body: {\r\n              email: invitation.email,\r\n              organizationName: orgData?.name || 'FPK University',\r\n              invitationCode: data.code,\r\n              inviterName\r\n            }\r\n          });\r\n        } catch (emailError) {\r\n          console.error('Failed to send invitation email:', emailError);\r\n          // Don't throw error - invitation was created successfully\r\n        }\r\n      }\r\n\r\n      return data;\r\n    },\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-invitations', variables.organization_id] });\r\n      toast({\r\n        title: 'Invitation created',\r\n        description: variables.email \r\n          ? `Invitation sent to ${variables.email}` \r\n          : `Invitation code generated: ${data.code}`,\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      toast({\r\n        title: 'Error creating invitation',\r\n        description: error.message,\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useRemoveMember() {\r\n  const queryClient = useQueryClient();\r\n  const { toast } = useToast();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({ memberId, orgId }: { memberId: string; orgId: string }) => {\r\n      const { error } = await supabase\r\n        .from('org_members')\r\n        .update({ \r\n          status: 'removed',\r\n          removed_at: new Date().toISOString()\r\n        })\r\n        .eq('id', memberId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: ['org-members', variables.orgId] });\r\n      queryClient.invalidateQueries({ queryKey: ['organization', variables.orgId] });\r\n      toast({\r\n        title: 'Member removed',\r\n        description: 'The member has been removed from the organization.',\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      toast({\r\n        title: 'Error removing member',\r\n        description: error.message,\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrganizationActions.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[376,379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[376,379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1552,1555],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1552,1555],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2371,2374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2371,2374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":118,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3434,3437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3434,3437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4316,4319],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4316,4319],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":176,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5072,5075],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5072,5075],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":203,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5841,5844],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5841,5844],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":231,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6660,6663],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6660,6663],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport type { Organization } from '@/types/organization';\r\n\r\nexport interface UpdateOrganizationData {\r\n  name?: string;\r\n  description?: string;\r\n  seat_limit?: number;\r\n  settings?: Record<string, any>;\r\n}\r\n\r\nexport interface SuspendOrganizationData {\r\n  reason: string;\r\n  duration?: string; // e.g., '30 days', 'indefinite'\r\n}\r\n\r\nexport interface NotificationData {\r\n  subject: string;\r\n  message: string;\r\n  notification_type: string;\r\n}\r\n\r\nexport interface ExportRequest {\r\n  export_type: 'members' | 'activity' | 'usage' | 'complete';\r\n  format: 'csv' | 'json';\r\n}\r\n\r\nexport function useOrganizationActions() {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  const updateOrganization = useMutation({\r\n    mutationFn: async ({ id, data }: { id: string; data: UpdateOrganizationData }) => {\r\n      const { data: result, error } = await supabase\r\n        .from('organizations')\r\n        .update({\r\n          ...data,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('id', id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return result;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Organization updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error.message || \"Failed to update organization.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const deleteOrganization = useMutation({\r\n    mutationFn: async (organizationId: string) => {\r\n      // Soft delete by updating status\r\n      const { error } = await supabase\r\n        .from('organizations')\r\n        .update({ \r\n          status: 'deleted',\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('id', organizationId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Organization deleted successfully.\",\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error.message || \"Failed to delete organization.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const suspendOrganization = useMutation({\r\n    mutationFn: async ({ id, data }: { id: string; data: SuspendOrganizationData }) => {\r\n      const { data: user } = await supabase.auth.getUser();\r\n      if (!user.user) throw new Error('Not authenticated');\r\n\r\n      const { error } = await supabase\r\n        .from('organizations')\r\n        .update({\r\n          status: 'suspended',\r\n          suspended_at: new Date().toISOString(),\r\n          suspended_reason: data.reason,\r\n          suspended_by: user.user.id,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('id', id);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Organization suspended successfully.\",\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error.message || \"Failed to suspend organization.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const reactivateOrganization = useMutation({\r\n    mutationFn: async (organizationId: string) => {\r\n      const { error } = await supabase\r\n        .from('organizations')\r\n        .update({\r\n          status: 'active',\r\n          suspended_at: null,\r\n          suspended_reason: null,\r\n          suspended_by: null,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('id', organizationId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Organization reactivated successfully.\",\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error.message || \"Failed to reactivate organization.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const sendNotification = useMutation({\r\n    mutationFn: async ({ organizationId, data }: { organizationId: string; data: NotificationData }) => {\r\n      const { data: result, error } = await supabase.functions.invoke('send-organization-notification', {\r\n        body: {\r\n          organizationId,\r\n          ...data\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n      return result;\r\n    },\r\n    onSuccess: () => {\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Notification sent successfully.\",\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error.message || \"Failed to send notification.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const exportData = useMutation({\r\n    mutationFn: async ({ organizationId, data }: { organizationId: string; data: ExportRequest }) => {\r\n      const { data: result, error } = await supabase.functions.invoke('export-organization-data', {\r\n        body: {\r\n          organizationId,\r\n          ...data\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n      return result;\r\n    },\r\n    onSuccess: () => {\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Export request submitted. You'll receive a download link shortly.\",\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error.message || \"Failed to export data.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const changeSubscriptionTier = useMutation({\r\n    mutationFn: async ({ organizationId, tier }: { organizationId: string; tier: string }) => {\r\n      const { data: result, error } = await supabase.functions.invoke('change-subscription-tier', {\r\n        body: {\r\n          organizationId,\r\n          newTier: tier\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n      return result;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Subscription tier updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error: any) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error.message || \"Failed to change subscription tier.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    updateOrganization,\r\n    deleteOrganization,\r\n    suspendOrganization,\r\n    reactivateOrganization,\r\n    sendNotification,\r\n    exportData,\r\n    changeSubscriptionTier,\r\n    isLoading: updateOrganization.isPending || \r\n               deleteOrganization.isPending || \r\n               suspendOrganization.isPending || \r\n               reactivateOrganization.isPending || \r\n               sendNotification.isPending || \r\n               exportData.isPending ||\r\n               changeSubscriptionTier.isPending\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrganizationCourses.ts","messages":[{"ruleId":"@typescript-eslint/no-non-null-asserted-optional-chain","severity":2,"message":"Optional chain expressions can return undefined by design - using a non-null assertion is unsafe and wrong.","line":165,"column":24,"nodeType":"TSNonNullExpression","messageId":"noNonNullOptionalChain","endLine":165,"endColumn":70,"suggestions":[{"messageId":"suggestRemovingNonNull","fix":{"range":[5877,5878],"text":""},"desc":"You should remove the non-null assertion."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { toast } from 'sonner';\r\nimport { Course } from './useCourses';\r\nimport { NativeCourse } from './useNativeCourses';\r\n\r\nexport interface OrganizationCourseAssignment {\r\n  id: string;\r\n  organization_id: string;\r\n  course_id?: string;\r\n  native_course_id?: string;\r\n  assigned_by: string;\r\n  assigned_at: string;\r\n  is_active: boolean;\r\n  created_at: string;\r\n}\r\n\r\nexport interface OrganizationCoursesResponse {\r\n  globalCourses: Course[];\r\n  nativeCourses: NativeCourse[];\r\n  assignedCourses: Course[];\r\n  assignedNativeCourses: NativeCourse[];\r\n  organizationOwnedCourses: Course[];\r\n  organizationOwnedNativeCourses: NativeCourse[];\r\n}\r\n\r\n// Hook to fetch courses available to an organization\r\nexport function useOrganizationCourses(organizationId: string) {\r\n  return useQuery({\r\n    queryKey: ['organization-courses', organizationId],\r\n    queryFn: async (): Promise<OrganizationCoursesResponse> => {\r\n      // Fetch global courses\r\n      const { data: globalCourses, error: globalError } = await supabase\r\n        .from('courses')\r\n        .select('*')\r\n        .eq('course_visibility', 'global')\r\n        .eq('status', 'published');\r\n\r\n      if (globalError) throw globalError;\r\n\r\n      // Fetch global native courses\r\n      const { data: globalNativeCourses, error: globalNativeError } = await supabase\r\n        .from('native_courses')\r\n        .select('*')\r\n        .eq('visibility', 'published')\r\n        .or('course_visibility.is.null,course_visibility.eq.global');\r\n\r\n      if (globalNativeError) throw globalNativeError;\r\n\r\n      // Fetch assigned courses\r\n      const { data: assignments, error: assignmentsError } = await supabase\r\n        .from('organization_course_assignments')\r\n        .select(`\r\n          *,\r\n          courses (*),\r\n          native_courses (*)\r\n        `)\r\n        .eq('organization_id', organizationId)\r\n        .eq('is_active', true);\r\n\r\n      if (assignmentsError) throw assignmentsError;\r\n\r\n      // Fetch organization-owned courses\r\n      const { data: orgCourses, error: orgCoursesError } = await supabase\r\n        .from('courses')\r\n        .select('*')\r\n        .eq('organization_id', organizationId);\r\n\r\n      if (orgCoursesError) throw orgCoursesError;\r\n\r\n      const { data: orgNativeCourses, error: orgNativeCoursesError } = await supabase\r\n        .from('native_courses')\r\n        .select('*')\r\n        .eq('organization_id', organizationId);\r\n\r\n      if (orgNativeCoursesError) throw orgNativeCoursesError;\r\n\r\n      const assignedCourses = assignments\r\n        .filter(a => a.course_id && a.courses)\r\n        .map(a => a.courses);\r\n\r\n      const assignedNativeCourses = assignments\r\n        .filter(a => a.native_course_id && a.native_courses)\r\n        .map(a => a.native_courses);\r\n\r\n      return {\r\n        globalCourses: (globalCourses || []) as Course[],\r\n        nativeCourses: (globalNativeCourses || []) as NativeCourse[],\r\n        assignedCourses: (assignedCourses || []) as Course[],\r\n        assignedNativeCourses: (assignedNativeCourses || []) as NativeCourse[],\r\n        organizationOwnedCourses: (orgCourses || []) as Course[],\r\n        organizationOwnedNativeCourses: (orgNativeCourses || []) as NativeCourse[],\r\n      };\r\n    },\r\n    enabled: !!organizationId,\r\n    staleTime: 1000 * 60 * 5, // 5 minutes\r\n  });\r\n}\r\n\r\n// Hook to fetch available courses that can be assigned to an organization\r\nexport function useAvailableCourses(organizationId: string) {\r\n  return useQuery({\r\n    queryKey: ['available-courses', organizationId],\r\n    queryFn: async () => {\r\n      // Get already assigned course IDs\r\n      const { data: assignments } = await supabase\r\n        .from('organization_course_assignments')\r\n        .select('course_id, native_course_id')\r\n        .eq('organization_id', organizationId)\r\n        .eq('is_active', true);\r\n\r\n      const assignedCourseIds = assignments?.map(a => a.course_id).filter(Boolean) || [];\r\n      const assignedNativeCourseIds = assignments?.map(a => a.native_course_id).filter(Boolean) || [];\r\n\r\n      // Fetch global courses not already assigned\r\n      const { data: availableCourses, error: coursesError } = await supabase\r\n        .from('courses')\r\n        .select('*')\r\n        .eq('course_visibility', 'global')\r\n        .eq('status', 'published')\r\n        .not('id', 'in', `(${assignedCourseIds.join(',')})`);\r\n\r\n      if (coursesError) throw coursesError;\r\n\r\n      // Fetch global native courses not already assigned\r\n      const { data: availableNativeCourses, error: nativeCoursesError } = await supabase\r\n        .from('native_courses')\r\n        .select('*')\r\n        .eq('visibility', 'published')\r\n        .or('course_visibility.is.null,course_visibility.eq.global')\r\n        .not('id', 'in', `(${assignedNativeCourseIds.join(',')})`);\r\n\r\n      if (nativeCoursesError) throw nativeCoursesError;\r\n\r\n      return {\r\n        courses: (availableCourses || []) as Course[],\r\n        nativeCourses: (availableNativeCourses || []) as NativeCourse[],\r\n      };\r\n    },\r\n    enabled: !!organizationId,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n}\r\n\r\n// Hook to manage course assignments\r\nexport function useOrganizationCourseAssignments() {\r\n  const queryClient = useQueryClient();\r\n\r\n  const assignCourse = useMutation({\r\n    mutationFn: async ({\r\n      organizationId,\r\n      courseId,\r\n      nativeCourseId,\r\n    }: {\r\n      organizationId: string;\r\n      courseId?: string;\r\n      nativeCourseId?: string;\r\n    }) => {\r\n      const { data, error } = await supabase\r\n        .from('organization_course_assignments')\r\n        .insert([{\r\n          organization_id: organizationId,\r\n          course_id: courseId,\r\n          native_course_id: nativeCourseId,\r\n          assigned_by: (await supabase.auth.getUser()).data.user?.id!,\r\n        }])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: ['organization-courses', variables.organizationId] });\r\n      queryClient.invalidateQueries({ queryKey: ['available-courses', variables.organizationId] });\r\n      toast.success('Course assigned successfully!');\r\n    },\r\n    onError: (error) => {\r\n      console.error('Assignment error:', error);\r\n      toast.error('Failed to assign course');\r\n    },\r\n  });\r\n\r\n  const unassignCourse = useMutation({\r\n    mutationFn: async ({\r\n      organizationId,\r\n      courseId,\r\n      nativeCourseId,\r\n    }: {\r\n      organizationId: string;\r\n      courseId?: string;\r\n      nativeCourseId?: string;\r\n    }) => {\r\n      let query = supabase\r\n        .from('organization_course_assignments')\r\n        .update({ is_active: false })\r\n        .eq('organization_id', organizationId);\r\n\r\n      if (courseId) {\r\n        query = query.eq('course_id', courseId);\r\n      } else if (nativeCourseId) {\r\n        query = query.eq('native_course_id', nativeCourseId);\r\n      }\r\n\r\n      const { error } = await query;\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: ['organization-courses', variables.organizationId] });\r\n      queryClient.invalidateQueries({ queryKey: ['available-courses', variables.organizationId] });\r\n      toast.success('Course unassigned successfully!');\r\n    },\r\n    onError: (error) => {\r\n      console.error('Unassignment error:', error);\r\n      toast.error('Failed to unassign course');\r\n    },\r\n  });\r\n\r\n  return {\r\n    assignCourse,\r\n    unassignCourse,\r\n    isAssigning: assignCourse.isPending,\r\n    isUnassigning: unassignCourse.isPending,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useOrganizations.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1136,1139],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1136,1139],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport type { Organization, OrgSubscriptionTier } from '@/types/organization';\r\n\r\nexport function useOrganizations() {\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  // Fetch user's organizations\r\n  const { data: organizations, isLoading, error } = useQuery({\r\n    queryKey: ['organizations', user?.id],\r\n    queryFn: async (): Promise<Organization[]> => {\r\n      if (!user) return [];\r\n\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .select('*')\r\n        .eq('owner_id', user.id)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching organizations:', error);\r\n        throw error;\r\n      }\r\n\r\n      // Transform data to match our interface, handling missing fields gracefully\r\n      return data.map((org: any) => ({\r\n        id: org.id,\r\n        name: org.name,\r\n        description: org.description || undefined,\r\n        owner_id: org.owner_id,\r\n        plan: org.plan,\r\n        seat_cap: org.seat_cap,\r\n        seats_used: org.seats_used || 0,\r\n        instructors_used: org.instructors_used || 0,\r\n        instructor_limit: org.instructor_limit || 5,\r\n        brand_primary: org.brand_primary,\r\n        brand_accent: org.brand_accent,\r\n        logo_url: org.logo_url,\r\n        slug: org.slug,\r\n        is_suspended: org.is_suspended,\r\n        suspended_at: org.suspended_at,\r\n        suspended_by: org.suspended_by,\r\n        suspended_reason: org.suspended_reason,\r\n        status: org.status || 'active',\r\n        created_by: org.created_by,\r\n        created_at: org.created_at,\r\n        updated_at: org.updated_at,\r\n      }));\r\n    },\r\n    enabled: !!user,\r\n  });\r\n\r\n  // Create organization mutation\r\n  const createOrganizationMutation = useMutation({\r\n    mutationFn: async (orgData: {\r\n      name: string;\r\n      description?: string;\r\n      subscription_tier: OrgSubscriptionTier;\r\n    }) => {\r\n      if (!user) throw new Error('User not authenticated');\r\n\r\n      const seat_limit = orgData.subscription_tier === 'beta' ? 50 :\r\n                        orgData.subscription_tier === 'premium' ? 25 :\r\n                        orgData.subscription_tier === 'standard' ? 10 : 3;\r\n\r\n      const organization = {\r\n        name: orgData.name,\r\n        description: orgData.description,\r\n        owner_id: user.id,\r\n        plan: orgData.subscription_tier,\r\n        seat_cap: seat_limit,\r\n        slug: orgData.name.toLowerCase().replace(/\\s+/g, '-'),\r\n        status: 'active',\r\n        created_by: user.id,\r\n        is_suspended: false,\r\n      };\r\n\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .insert(organization)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error creating organization:', error);\r\n        throw error;\r\n      }\r\n\r\n      // Create owner membership record\r\n      const { error: memberError } = await supabase\r\n        .from('org_members')\r\n        .insert({\r\n          org_id: data.id,\r\n          user_id: user.id,\r\n          role: 'owner',\r\n          status: 'active',\r\n          joined_at: new Date().toISOString(),\r\n        });\r\n\r\n      if (memberError) {\r\n        console.error('Error creating owner membership:', memberError);\r\n        // Clean up the organization if member creation fails\r\n        await supabase.from('organizations').delete().eq('id', data.id);\r\n        throw memberError;\r\n      }\r\n\r\n      return data;\r\n    },\r\n    onSuccess: (data) => {\r\n      // Invalidate both organization query caches\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      queryClient.invalidateQueries({ queryKey: ['user-organizations'] });\r\n      toast({\r\n        title: \"Organization Created!\",\r\n        description: `${data.name} has been created successfully with ${data.plan} access.`,\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error instanceof Error ? error.message : \"Failed to create organization\",\r\n        variant: \"destructive\"\r\n      });\r\n    },\r\n  });\r\n\r\n  // Update organization mutation\r\n  const updateOrganizationMutation = useMutation({\r\n    mutationFn: async ({ id, updates }: { id: string; updates: Partial<Organization> }) => {\r\n      if (!user) throw new Error('User not authenticated');\r\n\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .update({\r\n          ...updates,\r\n          updated_at: new Date().toISOString(),\r\n        })\r\n        .eq('id', id)\r\n        .eq('owner_id', user.id) // Ensure user owns the organization\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error updating organization:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      // Invalidate both organization query caches\r\n      queryClient.invalidateQueries({ queryKey: ['organizations'] });\r\n      queryClient.invalidateQueries({ queryKey: ['user-organizations'] });\r\n      toast({\r\n        title: \"Organization Updated\",\r\n        description: \"Organization has been updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: error instanceof Error ? error.message : \"Failed to update organization\",\r\n        variant: \"destructive\"\r\n      });\r\n    },\r\n  });\r\n\r\n  return {\r\n    organizations: organizations || [],\r\n    isLoading,\r\n    error,\r\n    createOrganization: createOrganizationMutation.mutate,\r\n    updateOrganization: updateOrganizationMutation.mutate,\r\n    isCreating: createOrganizationMutation.isPending,\r\n    isUpdating: updateOrganizationMutation.isPending,\r\n  };\r\n}\r\n\r\n// Hook for checking if user has organization access\r\nexport function useOrganizationAccess(organizationId?: string) {\r\n  const { user } = useAuth();\r\n\r\n  const { data: hasAccess, isLoading } = useQuery({\r\n    queryKey: ['organizationAccess', organizationId, user?.id],\r\n    queryFn: async () => {\r\n      if (!user || !organizationId) return false;\r\n\r\n      // Check if user is owner\r\n      const { data: orgData } = await supabase\r\n        .from('organizations')\r\n        .select('owner_id')\r\n        .eq('id', organizationId)\r\n        .single();\r\n\r\n      if (orgData?.owner_id === user.id) return true;\r\n\r\n      // Check if user is a member\r\n      const { data: memberData } = await supabase\r\n        .from('org_members')\r\n        .select('status')\r\n        .eq('org_id', organizationId)\r\n        .eq('user_id', user.id)\r\n        .eq('status', 'active')\r\n        .single();\r\n\r\n      return !!memberData;\r\n    },\r\n    enabled: !!user && !!organizationId,\r\n  });\r\n\r\n  return { hasAccess: hasAccess || false, isLoading };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\usePDFPerformanceMonitoring.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[341,344],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[341,344],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1197,1200],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1197,1200],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1918,1921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1918,1921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2173,2176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2173,2176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useCallback, useRef } from 'react';\r\n\r\ninterface PerformanceMetrics {\r\n  loadStartTime: number;\r\n  loadEndTime?: number;\r\n  totalLoadTime?: number;\r\n  pageRenderTimes: { [page: number]: number };\r\n  memoryUsage?: number;\r\n  errors: string[];\r\n}\r\n\r\n// Declare gtag function if it exists\r\ndeclare global {\r\n  function gtag(...args: any[]): void;\r\n}\r\n\r\nexport const usePDFPerformanceMonitoring = () => {\r\n  const metricsRef = useRef<PerformanceMetrics>({\r\n    loadStartTime: 0,\r\n    pageRenderTimes: {},\r\n    errors: []\r\n  });\r\n\r\n  const startLoadTimer = useCallback(() => {\r\n    metricsRef.current = {\r\n      loadStartTime: performance.now(),\r\n      pageRenderTimes: {},\r\n      errors: []\r\n    };\r\n    console.log('ðŸ•’ PDF load timer started');\r\n  }, []);\r\n\r\n  const endLoadTimer = useCallback(() => {\r\n    const endTime = performance.now();\r\n    metricsRef.current.loadEndTime = endTime;\r\n    metricsRef.current.totalLoadTime = endTime - metricsRef.current.loadStartTime;\r\n    \r\n    console.log(`âœ… PDF loaded in ${metricsRef.current.totalLoadTime.toFixed(2)}ms`);\r\n    \r\n    // Log to analytics if available\r\n    if (typeof window !== 'undefined' && 'gtag' in window) {\r\n      (window as any).gtag('event', 'pdf_load_time', {\r\n        custom_parameter_1: metricsRef.current.totalLoadTime,\r\n        event_category: 'performance'\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  const recordPageRenderTime = useCallback((pageNumber: number) => {\r\n    const renderTime = performance.now();\r\n    metricsRef.current.pageRenderTimes[pageNumber] = renderTime;\r\n    console.log(`ðŸ“„ Page ${pageNumber} rendered at ${renderTime.toFixed(2)}ms`);\r\n  }, []);\r\n\r\n  const recordError = useCallback((error: string) => {\r\n    metricsRef.current.errors.push(error);\r\n    console.error('âŒ PDF Error recorded:', error);\r\n    \r\n    // Log to analytics if available\r\n    if (typeof window !== 'undefined' && 'gtag' in window) {\r\n      (window as any).gtag('event', 'pdf_error', {\r\n        custom_parameter_1: error,\r\n        event_category: 'errors'\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  const getMemoryUsage = useCallback(() => {\r\n    if ('memory' in performance) {\r\n      const memory = (performance as any).memory;\r\n      return {\r\n        usedJSHeapSize: memory.usedJSHeapSize,\r\n        totalJSHeapSize: memory.totalJSHeapSize,\r\n        jsHeapSizeLimit: memory.jsHeapSizeLimit\r\n      };\r\n    }\r\n    return null;\r\n  }, []);\r\n\r\n  const logPerformanceReport = useCallback(() => {\r\n    const memory = getMemoryUsage();\r\n    const report = {\r\n      ...metricsRef.current,\r\n      memoryUsage: memory,\r\n      averagePageRenderTime: Object.keys(metricsRef.current.pageRenderTimes).length > 0\r\n        ? Object.values(metricsRef.current.pageRenderTimes).reduce((a, b) => a + b, 0) / Object.keys(metricsRef.current.pageRenderTimes).length\r\n        : 0\r\n    };\r\n\r\n    console.log('ðŸ“Š PDF Performance Report:', report);\r\n    return report;\r\n  }, [getMemoryUsage]);\r\n\r\n  return {\r\n    startLoadTimer,\r\n    endLoadTimer,\r\n    recordPageRenderTime,\r\n    recordError,\r\n    getMemoryUsage,\r\n    logPerformanceReport,\r\n    getMetrics: () => metricsRef.current\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\usePDFUrlProcessor.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\usePageContext.ts","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":24,"column":51,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":24,"endColumn":52,"suggestions":[{"messageId":"removeEscape","fix":{"range":[919,920],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[919,919],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":25,"column":51,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":25,"endColumn":52,"suggestions":[{"messageId":"removeEscape","fix":{"range":[979,980],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[979,979],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useLocation } from 'react-router-dom';\r\n\r\nexport const usePageContext = () => {\r\n  const location = useLocation();\r\n\r\n  const getPageContext = () => {\r\n    const path = location.pathname;\r\n    \r\n    // Map routes to user-friendly context\r\n    const contextMap: Record<string, string> = {\r\n      '/dashboard/learner': 'Dashboard Overview',\r\n      '/dashboard/learner/notes': 'Notes & Study Materials',\r\n      '/dashboard/learner/flashcards': 'Flashcard Management',\r\n      '/dashboard/learner/study': 'Study Sessions',\r\n      '/dashboard/learner/ai-coach': 'AI Learning Coach',\r\n      '/dashboard/learner/goals': 'Learning Goals',\r\n      '/dashboard/learner/analytics': 'Learning Analytics',\r\n      '/dashboard/learner/settings': 'Settings',\r\n      '/dashboard/learner/courses': 'Course Library'\r\n    };\r\n\r\n    // Extract course or module context if present\r\n    const courseMatch = path.match(/\\/courses\\/([^\\/]+)/);\r\n    const moduleMatch = path.match(/\\/modules\\/([^\\/]+)/);\r\n    \r\n    if (courseMatch) {\r\n      return `Course: ${courseMatch[1].replace(/-/g, ' ')}`;\r\n    }\r\n    \r\n    if (moduleMatch) {\r\n      return `Module: ${moduleMatch[1].replace(/-/g, ' ')}`;\r\n    }\r\n\r\n    return contextMap[path] || 'FPK University Platform';\r\n  };\r\n\r\n  return { getPageContext };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useProactiveCoaching.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useProgressTracking.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\usePublicDomainBooks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useQuickStats.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useQuickStatsLive.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useQuizSession.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":223,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6990,6993],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6990,6993],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useCallback } from 'react';\r\nimport { useFlashcards } from './useFlashcards';\r\nimport { useXPIntegration } from './useXPIntegration';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nexport interface QuizCard {\r\n  id: string;\r\n  question: string;\r\n  correctAnswer: string;\r\n  options: string[];\r\n  correctOption: 'A' | 'B' | 'C' | 'D';\r\n  explanation?: string;\r\n  difficulty: number;\r\n  timesIncorrect?: number;\r\n}\r\n\r\nexport interface QuizSessionState {\r\n  isActive: boolean;\r\n  currentCardIndex: number;\r\n  cards: QuizCard[];\r\n  userAnswers: Array<{\r\n    cardId: string;\r\n    userChoice: string;\r\n    correct: boolean;\r\n    attempts: number;\r\n  }>;\r\n  sessionStartTime: number;\r\n}\r\n\r\nexport const useQuizSession = () => {\r\n  const [sessionState, setSessionState] = useState<QuizSessionState>({\r\n    isActive: false,\r\n    currentCardIndex: 0,\r\n    cards: [],\r\n    userAnswers: [],\r\n    sessionStartTime: 0\r\n  });\r\n\r\n  const { flashcards } = useFlashcards();\r\n  const { awardFlashcardStudyXP } = useXPIntegration();\r\n  const { toast } = useToast();\r\n\r\n  const startQuizSession = useCallback(async (topic?: string, limit: number = 5) => {\r\n    console.log('ðŸŽ¯ Starting quiz session:', { topic, limit });\r\n    \r\n    if (!flashcards || flashcards.length === 0) {\r\n      toast({\r\n        title: \"No flashcards found\",\r\n        description: \"Create some flashcards first to start a quiz session!\",\r\n        variant: \"destructive\"\r\n      });\r\n      return 0;\r\n    }\r\n\r\n    // Filter and prioritize struggling cards\r\n    let cardsToQuiz = flashcards.filter(card => {\r\n      const accuracy = card.times_reviewed > 0 \r\n        ? (card.times_correct / card.times_reviewed) * 100 \r\n        : 0;\r\n      \r\n      // Prioritize cards with low accuracy or high difficulty\r\n      return accuracy < 70 || card.difficulty_level >= 3;\r\n    });\r\n\r\n    // If we need more cards, add some regular ones\r\n    if (cardsToQuiz.length < limit) {\r\n      const additionalCards = flashcards.filter(card => \r\n        !cardsToQuiz.includes(card)\r\n      ).slice(0, limit - cardsToQuiz.length);\r\n      cardsToQuiz = [...cardsToQuiz, ...additionalCards];\r\n    }\r\n\r\n    // Take only the requested limit\r\n    cardsToQuiz = cardsToQuiz.slice(0, limit);\r\n\r\n    // Convert to quiz format with multiple choice\r\n    const quizCards: QuizCard[] = cardsToQuiz.map(card => {\r\n      const options = generateMultipleChoiceOptions(card.back_content, flashcards);\r\n      return {\r\n        id: card.id,\r\n        question: card.front_content,\r\n        correctAnswer: card.back_content,\r\n        options: options.choices,\r\n        correctOption: options.correctOption,\r\n        explanation: `The correct answer is: ${card.back_content}`,\r\n        difficulty: card.difficulty_level || 1,\r\n        timesIncorrect: (card.times_reviewed || 0) - (card.times_correct || 0)\r\n      };\r\n    });\r\n\r\n    setSessionState({\r\n      isActive: true,\r\n      currentCardIndex: 0,\r\n      cards: quizCards,\r\n      userAnswers: [],\r\n      sessionStartTime: Date.now()\r\n    });\r\n\r\n    toast({\r\n      title: \"ðŸŽ¯ Quiz Session Started!\",\r\n      description: `Ready to practice with ${quizCards.length} cards. Let's boost your knowledge!`\r\n    });\r\n\r\n    return quizCards.length;\r\n  }, [flashcards, toast]);\r\n\r\n  const submitAnswer = useCallback(async (userChoice: 'A' | 'B' | 'C' | 'D') => {\r\n    if (!sessionState.isActive || sessionState.currentCardIndex >= sessionState.cards.length) {\r\n      return null;\r\n    }\r\n\r\n    const currentCard = sessionState.cards[sessionState.currentCardIndex];\r\n    const correct = userChoice === currentCard.correctOption;\r\n    \r\n    // Check if this is a retry for the same card\r\n    const existingAnswer = sessionState.userAnswers.find(a => a.cardId === currentCard.id);\r\n    const attempts = existingAnswer ? existingAnswer.attempts + 1 : 1;\r\n\r\n    const answerRecord = {\r\n      cardId: currentCard.id,\r\n      userChoice,\r\n      correct,\r\n      attempts\r\n    };\r\n\r\n    // Update or add the answer\r\n    const updatedAnswers = existingAnswer\r\n      ? sessionState.userAnswers.map(a => a.cardId === currentCard.id ? answerRecord : a)\r\n      : [...sessionState.userAnswers, answerRecord];\r\n\r\n    setSessionState(prev => ({\r\n      ...prev,\r\n      userAnswers: updatedAnswers\r\n    }));\r\n\r\n    // Award XP for correct answers\r\n    if (correct && attempts === 1) {\r\n      // Full XP for first try\r\n      await awardFlashcardStudyXP(1, 1, 30);\r\n    } else if (correct && attempts > 1) {\r\n      // Partial XP for eventual success\r\n      await awardFlashcardStudyXP(1, 2, 30);\r\n    }\r\n\r\n    return {\r\n      correct,\r\n      attempts,\r\n      explanation: currentCard.explanation,\r\n      correctAnswer: currentCard.correctAnswer\r\n    };\r\n  }, [sessionState, awardFlashcardStudyXP]);\r\n\r\n  const nextCard = useCallback(() => {\r\n    setSessionState(prev => ({\r\n      ...prev,\r\n      currentCardIndex: prev.currentCardIndex + 1\r\n    }));\r\n  }, []);\r\n\r\n  const endSession = useCallback(async () => {\r\n    const correctOnFirstTry = sessionState.userAnswers.filter(a => a.correct && a.attempts === 1).length;\r\n    const totalCorrect = sessionState.userAnswers.filter(a => a.correct).length;\r\n    const sessionDuration = Math.floor((Date.now() - sessionState.sessionStartTime) / 1000);\r\n\r\n    // Award bonus XP for session completion\r\n    if (totalCorrect > 0) {\r\n      await awardFlashcardStudyXP(totalCorrect, sessionState.cards.length, sessionDuration);\r\n    }\r\n\r\n    const results = {\r\n      totalCards: sessionState.cards.length,\r\n      correctOnFirstTry,\r\n      totalCorrect,\r\n      sessionDuration,\r\n      accuracy: Math.round((totalCorrect / sessionState.cards.length) * 100)\r\n    };\r\n\r\n    setSessionState({\r\n      isActive: false,\r\n      currentCardIndex: 0,\r\n      cards: [],\r\n      userAnswers: [],\r\n      sessionStartTime: 0\r\n    });\r\n\r\n    toast({\r\n      title: \"ðŸŽ‰ Quiz Session Complete!\",\r\n      description: `${correctOnFirstTry}/${sessionState.cards.length} correct on first try. Well done!`\r\n    });\r\n\r\n    return results;\r\n  }, [sessionState, awardFlashcardStudyXP, toast]);\r\n\r\n  const getCurrentCard = useCallback(() => {\r\n    if (!sessionState.isActive || sessionState.currentCardIndex >= sessionState.cards.length) {\r\n      return null;\r\n    }\r\n    return sessionState.cards[sessionState.currentCardIndex];\r\n  }, [sessionState]);\r\n\r\n  const isSessionComplete = sessionState.currentCardIndex >= sessionState.cards.length;\r\n\r\n  return {\r\n    sessionState,\r\n    startQuizSession,\r\n    submitAnswer,\r\n    nextCard,\r\n    endSession,\r\n    getCurrentCard,\r\n    isSessionComplete,\r\n    progress: {\r\n      current: sessionState.currentCardIndex + 1,\r\n      total: sessionState.cards.length,\r\n      percentage: sessionState.cards.length > 0 \r\n        ? Math.round(((sessionState.currentCardIndex + 1) / sessionState.cards.length) * 100)\r\n        : 0\r\n    }\r\n  };\r\n};\r\n\r\n// Enhanced helper function to generate better multiple choice options\r\nfunction generateMultipleChoiceOptions(correctAnswer: string, allFlashcards: any[]): {\r\n  choices: string[];\r\n  correctOption: 'A' | 'B' | 'C' | 'D';\r\n} {\r\n  // Try to use other flashcard answers as distractors for more realistic options\r\n  const otherAnswers = allFlashcards\r\n    ?.map(card => card.back_content)\r\n    .filter(answer => answer !== correctAnswer && answer.length < 100)\r\n    .slice(0, 5) || [];\r\n\r\n  // Fallback distractors if we don't have enough from other cards\r\n  const fallbackDistractors = [\r\n    \"Increases soil acidity levels\",\r\n    \"Reduces atmospheric oxygen\",\r\n    \"Improves water retention capacity\",\r\n    \"Decreases overall plant diversity\",\r\n    \"Enhances carbon storage potential\",\r\n    \"Reduces nutrient availability\",\r\n    \"Improves ecosystem stability\",\r\n    \"Increases thermal regulation\"\r\n  ];\r\n\r\n  // Combine real answers with fallbacks and select 3 distractors\r\n  const allDistractors = [...otherAnswers, ...fallbackDistractors]\r\n    .filter(d => d !== correctAnswer)\r\n    .slice(0, 6)\r\n    .sort(() => Math.random() - 0.5)\r\n    .slice(0, 3);\r\n\r\n  const allOptions = [correctAnswer, ...allDistractors];\r\n  const shuffledOptions = allOptions.sort(() => Math.random() - 0.5);\r\n\r\n  const correctIndex = shuffledOptions.indexOf(correctAnswer);\r\n  const correctOption = ['A', 'B', 'C', 'D'][correctIndex] as 'A' | 'B' | 'C' | 'D';\r\n\r\n  return {\r\n    choices: shuffledOptions,\r\n    correctOption\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useQuizletSearch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useQuoteOfTheDay.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useReadingAnalytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[899,902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[899,902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\nexport interface ReadingSession {\r\n  id: string;\r\n  book_id: string;\r\n  session_start: string;\r\n  session_end: string | null;\r\n  duration_seconds: number;\r\n  pages_read: number;\r\n  start_cfi: string | null;\r\n  end_cfi: string | null;\r\n}\r\n\r\nexport interface ReadingProgress {\r\n  id: string;\r\n  book_id: string;\r\n  completion_percentage: number;\r\n  current_cfi: string | null;\r\n  reading_time_seconds: number;\r\n  last_read_at: string;\r\n}\r\n\r\nexport const useReadingAnalytics = (userId?: string) => {\r\n  const { user } = useAuth();\r\n  const [readingSessions, setReadingSessions] = useState<ReadingSession[]>([]);\r\n  const [readingProgress, setReadingProgress] = useState<ReadingProgress[]>([]);\r\n  const [readingTrends, setReadingTrends] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // Use provided userId or fall back to current user\r\n  const targetUserId = userId || user?.id;\r\n\r\n  useEffect(() => {\r\n    if (!targetUserId) return;\r\n\r\n    const fetchReadingAnalytics = async () => {\r\n      try {\r\n        setLoading(true);\r\n\r\n        // Fetch reading sessions\r\n        const { data: sessionsData, error: sessionsError } = await supabase\r\n          .from('reading_sessions')\r\n          .select('*')\r\n          .eq('user_id', targetUserId)\r\n          .order('session_start', { ascending: false });\r\n\r\n        if (sessionsError) throw sessionsError;\r\n\r\n        // Fetch reading progress\r\n        const { data: progressData, error: progressError } = await supabase\r\n          .from('reading_progress')\r\n          .select('*')\r\n          .eq('user_id', targetUserId)\r\n          .order('last_read_at', { ascending: false });\r\n\r\n        if (progressError) throw progressError;\r\n\r\n        setReadingSessions(sessionsData || []);\r\n        setReadingProgress(progressData || []);\r\n        \r\n        // Process reading trends (simplified)\r\n        const trends = (sessionsData || []).slice(0, 7).map((session, index) => ({\r\n          day: new Date(session.session_start).toLocaleDateString(),\r\n          readingTime: Math.round(session.duration_seconds / 60),\r\n          pagesRead: session.pages_read\r\n        }));\r\n        \r\n        setReadingTrends(trends);\r\n        setError(null);\r\n      } catch (err) {\r\n        console.error('Error fetching reading analytics:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to fetch reading analytics');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchReadingAnalytics();\r\n  }, [targetUserId]);\r\n\r\n  return {\r\n    readingSessions,\r\n    readingProgress,\r\n    readingTrends,\r\n    loading,\r\n    error,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useReadingProgress.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'user'. Either include it or remove the dependency array.","line":200,"column":6,"nodeType":"ArrayExpression","endLine":200,"endColumn":73,"suggestions":[{"desc":"Update the dependencies array to be: [currentSession, awardReadingSessionXP, progress, user, bookId]","fix":{"range":[5975,6042],"text":"[currentSession, awardReadingSessionXP, progress, user, bookId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useXPIntegration } from '@/hooks/useXPIntegration';\r\n\r\ninterface ReadingProgress {\r\n  id: string;\r\n  user_id: string;\r\n  book_id: string;\r\n  current_cfi: string | null;\r\n  chapter_index: number;\r\n  reading_time_seconds: number;\r\n  completion_percentage: number;\r\n  last_read_at: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  progress: number; // Add this for compatibility\r\n}\r\n\r\ninterface ReadingSession {\r\n  id?: string;\r\n  user_id: string;\r\n  book_id: string;\r\n  session_start: string;\r\n  session_end?: string;\r\n  duration_seconds: number;\r\n  pages_read: number;\r\n  start_cfi: string | null;\r\n  end_cfi: string | null;\r\n}\r\n\r\n// Hook for specific book reading progress\r\nexport const useReadingProgress = (bookId: string) => {\r\n  const { user } = useAuth();\r\n  const { awardReadingSessionXP } = useXPIntegration();\r\n  const [progress, setProgress] = useState<ReadingProgress | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [currentSession, setCurrentSession] = useState<ReadingSession | null>(null);\r\n  const sessionStartTime = useRef<Date | null>(null);\r\n  const lastCfi = useRef<string | null>(null);\r\n\r\n  // Load existing progress\r\n  const loadProgress = useCallback(async () => {\r\n    if (!user?.id || !bookId) {\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('reading_progress')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .eq('book_id', bookId)\r\n        .maybeSingle();\r\n\r\n      if (error) {\r\n        console.error('Error loading reading progress:', error);\r\n        return;\r\n      }\r\n\r\n      // Add progress property for compatibility\r\n      if (data) {\r\n        setProgress({\r\n          ...data,\r\n          progress: data.completion_percentage\r\n        });\r\n      }\r\n    } catch (err) {\r\n      console.error('Error in loadProgress:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [user?.id, bookId]);\r\n\r\n  // Save or update progress\r\n  const saveProgress = useCallback(async (\r\n    cfi: string,\r\n    chapterIndex: number = 0,\r\n    completionPercentage: number = 0\r\n  ) => {\r\n    if (!user?.id || !bookId) return;\r\n\r\n    const progressData = {\r\n      user_id: user.id,\r\n      book_id: bookId,\r\n      current_cfi: cfi,\r\n      chapter_index: chapterIndex,\r\n      completion_percentage: Math.min(100, Math.max(0, completionPercentage)),\r\n      last_read_at: new Date().toISOString(),\r\n    };\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('reading_progress')\r\n        .upsert(progressData, {\r\n          onConflict: 'user_id,book_id'\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error saving reading progress:', error);\r\n        return;\r\n      }\r\n\r\n      // Add progress property for compatibility\r\n      setProgress({\r\n        ...data,\r\n        progress: data.completion_percentage\r\n      });\r\n      console.log('ðŸ“– Reading progress saved:', { cfi, chapterIndex, completionPercentage });\r\n    } catch (err) {\r\n      console.error('Error in saveProgress:', err);\r\n    }\r\n  }, [user?.id, bookId]);\r\n\r\n  // Start reading session\r\n  const startSession = useCallback((startCfi: string | null = null) => {\r\n    if (!user?.id || !bookId) return;\r\n\r\n    const now = new Date();\r\n    sessionStartTime.current = now;\r\n    lastCfi.current = startCfi;\r\n\r\n    const session: ReadingSession = {\r\n      user_id: user.id,\r\n      book_id: bookId,\r\n      session_start: now.toISOString(),\r\n      duration_seconds: 0,\r\n      pages_read: 0,\r\n      start_cfi: startCfi,\r\n      end_cfi: null,\r\n    };\r\n\r\n    setCurrentSession(session);\r\n    console.log('ðŸ“š Reading session started');\r\n  }, [user?.id, bookId]);\r\n\r\n  // Enhanced endSession with XP integration\r\n  const endSession = useCallback(async (endCfi: string | null = null) => {\r\n    if (!currentSession || !sessionStartTime.current) return;\r\n\r\n    const endTime = new Date();\r\n    const duration = Math.floor((endTime.getTime() - sessionStartTime.current.getTime()) / 1000);\r\n\r\n    // Only award XP for sessions longer than 30 seconds\r\n    if (duration >= 30) {\r\n      try {\r\n        // Estimate pages read based on duration (rough estimate: 1 page per 2 minutes)\r\n        const estimatedPages = Math.max(1, Math.floor(duration / 120));\r\n        await awardReadingSessionXP(duration, estimatedPages);\r\n        console.log('âœ… Reading session XP awarded:', { duration, estimatedPages });\r\n      } catch (xpError) {\r\n        console.error('Error awarding reading session XP:', xpError);\r\n        // Don't fail the session save if XP fails\r\n      }\r\n    }\r\n\r\n    const sessionData = {\r\n      ...currentSession,\r\n      session_end: endTime.toISOString(),\r\n      duration_seconds: duration,\r\n      end_cfi: endCfi || lastCfi.current,\r\n    };\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('reading_sessions')\r\n        .insert(sessionData);\r\n\r\n      if (error) {\r\n        console.error('Error saving reading session:', error);\r\n        return;\r\n      }\r\n\r\n      // Update total reading time in progress\r\n      if (progress) {\r\n        const newReadingTime = progress.reading_time_seconds + duration;\r\n        await supabase\r\n          .from('reading_progress')\r\n          .update({ reading_time_seconds: newReadingTime })\r\n          .eq('user_id', user!.id)\r\n          .eq('book_id', bookId);\r\n\r\n        setProgress(prev => prev ? {\r\n          ...prev,\r\n          reading_time_seconds: newReadingTime\r\n        } : null);\r\n      }\r\n\r\n      console.log('ðŸ“š Reading session ended:', { duration, endCfi });\r\n    } catch (err) {\r\n      console.error('Error in endSession:', err);\r\n    } finally {\r\n      setCurrentSession(null);\r\n      sessionStartTime.current = null;\r\n      lastCfi.current = null;\r\n    }\r\n  }, [currentSession, progress, user?.id, bookId, awardReadingSessionXP]);\r\n\r\n  // Update current location during reading\r\n  const updateLocation = useCallback((cfi: string, chapterIndex?: number) => {\r\n    lastCfi.current = cfi;\r\n    \r\n    // Debounced save to avoid too frequent updates\r\n    const timeoutId = setTimeout(() => {\r\n      saveProgress(cfi, chapterIndex);\r\n    }, 2000);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [saveProgress]);\r\n\r\n  // Load progress on mount\r\n  useEffect(() => {\r\n    loadProgress();\r\n  }, [loadProgress]);\r\n\r\n  // Auto-end session on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (currentSession) {\r\n        endSession(lastCfi.current);\r\n      }\r\n    };\r\n  }, [currentSession, endSession]);\r\n\r\n  return {\r\n    progress,\r\n    isLoading,\r\n    currentSession,\r\n    loadProgress,\r\n    saveProgress,\r\n    startSession,\r\n    endSession,\r\n    updateLocation,\r\n  };\r\n};\r\n\r\n// New hook for general reading progress (all books)\r\nexport const useGeneralReadingProgress = () => {\r\n  const { user } = useAuth();\r\n  const [data, setData] = useState<ReadingProgress[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  const loadProgress = useCallback(async () => {\r\n    if (!user?.id) {\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { data: progressData, error } = await supabase\r\n        .from('reading_progress')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('last_read_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error loading reading progress:', error);\r\n        return;\r\n      }\r\n\r\n      // Add progress property for compatibility\r\n      const formattedData = progressData?.map(item => ({\r\n        ...item,\r\n        progress: item.completion_percentage\r\n      })) || [];\r\n\r\n      setData(formattedData);\r\n    } catch (err) {\r\n      console.error('Error in loadProgress:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  useEffect(() => {\r\n    loadProgress();\r\n  }, [loadProgress]);\r\n\r\n  return {\r\n    data,\r\n    isLoading,\r\n    refetch: loadProgress\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useRealTimeProcessing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useRealtimeChannel.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[479,482],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[479,482],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[612,615],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[612,615],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useRef\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":27,"column":17,"nodeType":"Identifier","endLine":27,"endColumn":23},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useRef\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":28,"column":25,"nodeType":"Identifier","endLine":28,"endColumn":31},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":33,"column":3,"nodeType":"Identifier","endLine":33,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1704,1707],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1704,1707],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'channelKeyRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'channelKeyRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":89,"column":40,"nodeType":"Identifier","endLine":89,"endColumn":47},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'options.event', 'options.filter', 'options.schema', and 'options.table'. Either include them or remove the dependency array. Mutable values like 'channelKeyRef.current' aren't valid dependencies because mutating them doesn't re-render the component.","line":114,"column":6,"nodeType":"ArrayExpression","endLine":114,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [options.event, options.filter, options.schema, options.table]","fix":{"range":[3958,3981],"text":"[options.event, options.filter, options.schema, options.table]"}}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport type { RealtimeChannel } from '@supabase/supabase-js';\r\n\r\ninterface RealtimeOptions {\r\n  event?: 'INSERT' | 'UPDATE' | 'DELETE' | '*';\r\n  schema?: string;\r\n  table: string;\r\n  filter?: string;\r\n}\r\n\r\n// Global registry to prevent duplicate subscriptions\r\nconst globalChannels = new Map<string, RealtimeChannel>();\r\nconst globalCallbacks = new Map<string, Set<(payload: any) => void>>();\r\n\r\nexport function useRealtimeChannel(\r\n  channelName: string,\r\n  options: RealtimeOptions,\r\n  callback: (payload: any) => void\r\n) {\r\n  // Critical validation: ensure all required parameters are valid\r\n  if (!channelName || typeof channelName !== 'string' || !options?.table || typeof options.table !== 'string') {\r\n    console.warn('Invalid parameters for useRealtimeChannel:', { channelName, options });\r\n    return;\r\n  }\r\n  \r\n  const cbRef = useRef(callback);\r\n  const channelKeyRef = useRef(`${channelName}-${options.table}-${options.event || '*'}-${options.filter || ''}`);\r\n  \r\n  // Update callback reference\r\n  cbRef.current = callback;\r\n\r\n  useEffect(() => {\r\n    const channelKey = channelKeyRef.current;\r\n    \r\n    // Add callback to global registry\r\n    if (!globalCallbacks.has(channelKey)) {\r\n      globalCallbacks.set(channelKey, new Set());\r\n    }\r\n    globalCallbacks.get(channelKey)!.add(cbRef.current);\r\n    \r\n    // Create channel only if it doesn't exist\r\n    if (!globalChannels.has(channelKey)) {\r\n      console.debug(`ðŸ†• Creating new shared channel: ${channelKey}`);\r\n      \r\n      const channel = supabase\r\n        .channel(channelKey)\r\n        .on(\r\n          'postgres_changes' as any,\r\n          {\r\n            event: options.event || '*',\r\n            schema: options.schema || 'public',\r\n            table: options.table,\r\n            filter: options.filter,\r\n          },\r\n          (payload) => {\r\n            // Notify all callbacks for this channel\r\n            const callbacks = globalCallbacks.get(channelKey);\r\n            if (callbacks) {\r\n              callbacks.forEach(cb => {\r\n                try {\r\n                  cb(payload);\r\n                } catch (error) {\r\n                  console.error('Error in realtime callback:', error);\r\n                }\r\n              });\r\n            }\r\n          }\r\n        );\r\n\r\n      // Subscribe once\r\n      channel.subscribe((status) => {\r\n        if (status === 'SUBSCRIBED') {\r\n          console.debug(`âœ… [RT] subscribed â†’ ${options.table}.${options.event || '*'}`);\r\n        } else if (status === 'CHANNEL_ERROR' || status === 'TIMED_OUT' || status === 'CLOSED') {\r\n          console.warn(`âŒ [RT] ${status} â†’ ${options.table}.${options.event || '*'}`);\r\n          // Clean up failed channel\r\n          globalChannels.delete(channelKey);\r\n          globalCallbacks.delete(channelKey);\r\n        }\r\n      });\r\n\r\n      globalChannels.set(channelKey, channel);\r\n    } else {\r\n      console.debug(`â™»ï¸ Reusing existing channel: ${channelKey}`);\r\n    }\r\n\r\n    return () => {\r\n      const channelKey = channelKeyRef.current;\r\n      console.debug(`ðŸ”Œ Cleaning up callback for: ${channelKey}`);\r\n      \r\n      // Remove callback from global registry\r\n      const callbacks = globalCallbacks.get(channelKey);\r\n      if (callbacks) {\r\n        callbacks.delete(cbRef.current);\r\n        \r\n        // If no more callbacks, clean up the channel\r\n        if (callbacks.size === 0) {\r\n          console.debug(`ðŸ—‘ï¸ Removing unused channel: ${channelKey}`);\r\n          const channel = globalChannels.get(channelKey);\r\n          if (channel) {\r\n            try {\r\n              channel.unsubscribe();\r\n              supabase.removeChannel(channel);\r\n            } catch (error) {\r\n              console.warn('Error during cleanup:', error);\r\n            }\r\n          }\r\n          globalChannels.delete(channelKey);\r\n          globalCallbacks.delete(channelKey);\r\n        }\r\n      }\r\n    };\r\n  }, [channelKeyRef.current]);\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useRealtimeDeduplication.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useRealtimeRecommendations.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[592,595],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[592,595],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":105,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":108,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2283,2286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2283,2286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'generateRecommendation'. Either include it or remove the dependency array.","line":119,"column":6,"nodeType":"ArrayExpression","endLine":119,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, triggers, generateRecommendation]","fix":{"range":[4516,4536],"text":"[user.id, triggers, generateRecommendation]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":125,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4739,4742],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4739,4742],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { analyticsEventBus } from '@/services/AnalyticsEventBus';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface AIRecommendation {\r\n  id: string;\r\n  type: 'break_suggestion' | 'difficulty_adjustment' | 'content_format_change' | 'attention_support' | 'energy_boost';\r\n  priority: 'low' | 'medium' | 'high' | 'urgent';\r\n  title: string;\r\n  message: string;\r\n  actionText: string;\r\n  actionData: Record<string, any>;\r\n  triggerReason: string;\r\n  confidence: number;\r\n  expiresAt: string;\r\n  autoApply?: boolean;\r\n  triggerThreshold?: number;\r\n  triggerDirection?: 'above' | 'below';\r\n}\r\n\r\ninterface RecommendationTrigger {\r\n  metric: string;\r\n  threshold: number;\r\n  direction: 'above' | 'below';\r\n  duration?: number; // How long condition must persist\r\n}\r\n\r\nexport const useRealtimeRecommendations = () => {\r\n  const cleanup = useCleanup('useRealtimeRecommendations');\r\n  const { user } = useAuth();\r\n  const [activeRecommendations, setActiveRecommendations] = useState<AIRecommendation[]>([]);\r\n  const [appliedRecommendations, setAppliedRecommendations] = useState<string[]>([]);\r\n  const [triggers, setTriggers] = useState<RecommendationTrigger[]>([]);\r\n  const [currentMetrics, setCurrentMetrics] = useState<Record<string, number>>({});\r\n\r\n  // Initialize recommendation triggers\r\n  useEffect(() => {\r\n    const defaultTriggers: RecommendationTrigger[] = [\r\n      { metric: 'attention_score', threshold: 50, direction: 'below', duration: 120 },\r\n      { metric: 'cognitive_load', threshold: 80, direction: 'above', duration: 180 },\r\n      { metric: 'energy_level', threshold: 30, direction: 'below', duration: 60 },\r\n      { metric: 'slide_duration', threshold: 300, direction: 'above', duration: 0 },\r\n      { metric: 'interaction_frequency', threshold: 0.1, direction: 'below', duration: 180 },\r\n      { metric: 'error_rate', threshold: 0.7, direction: 'above', duration: 0 }\r\n    ];\r\n    \r\n    setTriggers(defaultTriggers);\r\n  }, []);\r\n\r\n  // Monitor metrics and generate recommendations\r\n  const processMetricUpdate = useCallback(async (metric: string, value: number, context: Record<string, any>) => {\r\n    if (!user?.id) return;\r\n\r\n    // Update current metrics\r\n    setCurrentMetrics(prev => ({ ...prev, [metric]: value }));\r\n\r\n    // Check triggers\r\n    const triggeredRecommendations: AIRecommendation[] = [];\r\n\r\n    for (const trigger of triggers) {\r\n      if (trigger.metric === metric) {\r\n        const shouldTrigger = trigger.direction === 'above' \r\n          ? value > trigger.threshold \r\n          : value < trigger.threshold;\r\n\r\n        if (shouldTrigger) {\r\n          const recommendation = await generateRecommendation(trigger, value, context);\r\n          if (recommendation) {\r\n            // Add trigger information to the recommendation for later database storage\r\n            const recommendationWithTrigger = {\r\n              ...recommendation,\r\n              triggerThreshold: trigger.threshold,\r\n              triggerDirection: trigger.direction\r\n            };\r\n            triggeredRecommendations.push(recommendationWithTrigger);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Add new recommendations\r\n    if (triggeredRecommendations.length > 0) {\r\n      setActiveRecommendations(prev => {\r\n        const existing = prev.map(r => r.id);\r\n        const newRecs = triggeredRecommendations.filter(r => !existing.includes(r.id));\r\n        return [...prev, ...newRecs];\r\n      });\r\n\r\n      // Store in database\r\n      for (const rec of triggeredRecommendations) {\r\n        await supabase\r\n          .from('ai_recommendations')\r\n          .insert({\r\n            user_id: user.id,\r\n            recommendation_type: rec.type,\r\n            recommendation_data: {\r\n              title: rec.title,\r\n              message: rec.message,\r\n              actionText: rec.actionText,\r\n              actionData: rec.actionData,\r\n              confidence: rec.confidence,\r\n              priority: rec.priority\r\n            },\r\n            trigger_context: {\r\n              metric,\r\n              value,\r\n              threshold: rec.triggerThreshold,\r\n              direction: rec.triggerDirection,\r\n              ...context\r\n            },\r\n            expires_at: rec.expiresAt\r\n          });\r\n      }\r\n\r\n      console.log(`ðŸ¤– Generated ${triggeredRecommendations.length} real-time recommendations`);\r\n    }\r\n  }, [user?.id, triggers]);\r\n\r\n  // Generate specific recommendation based on trigger\r\n  const generateRecommendation = useCallback(async (\r\n    trigger: RecommendationTrigger, \r\n    value: number, \r\n    context: Record<string, any>\r\n  ): Promise<AIRecommendation | null> => {\r\n    const id = `${trigger.metric}_${Date.now()}`;\r\n    const expiresAt = new Date(Date.now() + 10 * 60 * 1000).toISOString(); // 10 minutes\r\n\r\n    switch (trigger.metric) {\r\n      case 'attention_score':\r\n        return {\r\n          id,\r\n          type: 'attention_support',\r\n          priority: value < 30 ? 'urgent' : 'high',\r\n          title: 'Attention Support Needed',\r\n          message: `Your attention score has dropped to ${Math.round(value)}%. Let's help you refocus!`,\r\n          actionText: 'Take Focus Break',\r\n          actionData: {\r\n            breakType: 'attention_restoration',\r\n            duration: 120, // 2 minutes\r\n            activities: ['deep_breathing', 'eye_exercises', 'quick_meditation']\r\n          },\r\n          triggerReason: 'Low attention detected',\r\n          confidence: 0.85,\r\n          expiresAt,\r\n          autoApply: false\r\n        };\r\n\r\n      case 'cognitive_load':\r\n        return {\r\n          id,\r\n          type: 'difficulty_adjustment',\r\n          priority: 'high',\r\n          title: 'Reduce Cognitive Load',\r\n          message: `The current content seems challenging (${Math.round(value)}% load). Would you like to adjust the difficulty?`,\r\n          actionText: 'Simplify Content',\r\n          actionData: {\r\n            adjustmentType: 'reduce_complexity',\r\n            targetLoad: 50,\r\n            modifications: ['add_hints', 'break_into_steps', 'provide_examples']\r\n          },\r\n          triggerReason: 'High cognitive load detected',\r\n          confidence: 0.78,\r\n          expiresAt\r\n        };\r\n\r\n      case 'energy_level':\r\n        return {\r\n          id,\r\n          type: 'energy_boost',\r\n          priority: 'medium',\r\n          title: 'Energy Boost Recommended',\r\n          message: `Your energy level is at ${Math.round(value)}%. Time for an energy break!`,\r\n          actionText: 'Energize Me',\r\n          actionData: {\r\n            boostType: 'energy_restoration',\r\n            duration: 300, // 5 minutes\r\n            activities: ['energy_bear_interaction', 'movement_break', 'motivational_content']\r\n          },\r\n          triggerReason: 'Low energy detected',\r\n          confidence: 0.82,\r\n          expiresAt\r\n        };\r\n\r\n      case 'slide_duration':\r\n        return {\r\n          id,\r\n          type: 'break_suggestion',\r\n          priority: 'medium',\r\n          title: 'Time for a Break',\r\n          message: `You've been on this slide for ${Math.round(value / 60)} minutes. A short break might help!`,\r\n          actionText: 'Take Break',\r\n          actionData: {\r\n            breakType: 'micro_break',\r\n            duration: 180,\r\n            returnToSlide: true\r\n          },\r\n          triggerReason: 'Extended time on single slide',\r\n          confidence: 0.75,\r\n          expiresAt\r\n        };\r\n\r\n      case 'interaction_frequency':\r\n        return {\r\n          id,\r\n          type: 'content_format_change',\r\n          priority: 'medium',\r\n          title: 'Try Different Format',\r\n          message: 'You seem less engaged with this content. Would you like to try a different format?',\r\n          actionText: 'Change Format',\r\n          actionData: {\r\n            formatOptions: ['interactive_video', 'audio_narration', 'visual_summary'],\r\n            currentFormat: context.contentFormat || 'text'\r\n          },\r\n          triggerReason: 'Low interaction frequency',\r\n          confidence: 0.70,\r\n          expiresAt\r\n        };\r\n\r\n      case 'error_rate':\r\n        return {\r\n          id,\r\n          type: 'difficulty_adjustment',\r\n          priority: 'high',\r\n          title: 'Adjust Difficulty Level',\r\n          message: 'This seems challenging for you right now. Let\\'s make it more manageable.',\r\n          actionText: 'Make Easier',\r\n          actionData: {\r\n            adjustmentType: 'reduce_difficulty',\r\n            errorRate: value,\r\n            supportOptions: ['guided_practice', 'review_fundamentals', 'peer_examples']\r\n          },\r\n          triggerReason: 'High error rate detected',\r\n          confidence: 0.88,\r\n          expiresAt\r\n        };\r\n\r\n      default:\r\n        return null;\r\n    }\r\n  }, []);\r\n\r\n  // Apply recommendation\r\n  const applyRecommendation = useCallback(async (recommendation: AIRecommendation) => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      // Mark as applied\r\n      setAppliedRecommendations(prev => [...prev, recommendation.id]);\r\n      \r\n      // Remove from active recommendations\r\n      setActiveRecommendations(prev => prev.filter(r => r.id !== recommendation.id));\r\n\r\n      // Update in database\r\n      await supabase\r\n        .from('ai_recommendations')\r\n        .update({ applied_at: new Date().toISOString() })\r\n        .eq('user_id', user.id)\r\n        .eq('recommendation_type', recommendation.type);\r\n\r\n      // Publish application event\r\n      analyticsEventBus.publish({\r\n        userId: user.id,\r\n        eventType: 'recommendation_applied',\r\n        metadata: {\r\n          recommendationId: recommendation.id,\r\n          type: recommendation.type,\r\n          actionData: recommendation.actionData,\r\n          triggerReason: recommendation.triggerReason\r\n        },\r\n        source: 'realtime_recommendations'\r\n      });\r\n\r\n      // Execute recommendation action based on type\r\n      await executeRecommendationAction(recommendation);\r\n\r\n      console.log(`âœ… Applied recommendation: ${recommendation.title}`);\r\n    } catch (error) {\r\n      console.error('Error applying recommendation:', error);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  // Dismiss recommendation\r\n  const dismissRecommendation = useCallback(async (recommendationId: string, reason?: string) => {\r\n    if (!user?.id) return;\r\n\r\n    setActiveRecommendations(prev => prev.filter(r => r.id !== recommendationId));\r\n\r\n    // Log dismissal\r\n    analyticsEventBus.publish({\r\n      userId: user.id,\r\n      eventType: 'recommendation_dismissed',\r\n      metadata: {\r\n        recommendationId,\r\n        dismissReason: reason || 'user_dismissed'\r\n      },\r\n      source: 'realtime_recommendations'\r\n    });\r\n\r\n    console.log(`âŒ Dismissed recommendation: ${recommendationId}`);\r\n  }, [user?.id]);\r\n\r\n  // Rate recommendation effectiveness\r\n  const rateRecommendation = useCallback(async (recommendationId: string, rating: number, feedback?: string) => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      // Update recommendation with rating\r\n      await supabase\r\n        .from('ai_recommendations')\r\n        .update({ \r\n          effectiveness_rating: rating,\r\n          // Store feedback in metadata if provided\r\n        })\r\n        .eq('user_id', user.id);\r\n\r\n      // Log rating event\r\n      analyticsEventBus.publish({\r\n        userId: user.id,\r\n        eventType: 'recommendation_rated',\r\n        metadata: {\r\n          recommendationId,\r\n          rating,\r\n          feedback\r\n        },\r\n        source: 'realtime_recommendations'\r\n      });\r\n\r\n      console.log(`â­ Rated recommendation ${recommendationId}: ${rating}/5`);\r\n    } catch (error) {\r\n      console.error('Error rating recommendation:', error);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  // Execute recommendation actions\r\n  const executeRecommendationAction = async (recommendation: AIRecommendation) => {\r\n    switch (recommendation.type) {\r\n      case 'break_suggestion':\r\n        // Trigger break modal or redirect to break activity\r\n        window.dispatchEvent(new CustomEvent('show-break-modal', { \r\n          detail: recommendation.actionData \r\n        }));\r\n        break;\r\n\r\n      case 'difficulty_adjustment':\r\n        // Adjust content difficulty\r\n        window.dispatchEvent(new CustomEvent('adjust-difficulty', { \r\n          detail: recommendation.actionData \r\n        }));\r\n        break;\r\n\r\n      case 'content_format_change':\r\n        // Change content format\r\n        window.dispatchEvent(new CustomEvent('change-content-format', { \r\n          detail: recommendation.actionData \r\n        }));\r\n        break;\r\n\r\n      case 'attention_support':\r\n        // Show attention restoration activities\r\n        window.dispatchEvent(new CustomEvent('show-attention-support', { \r\n          detail: recommendation.actionData \r\n        }));\r\n        break;\r\n\r\n      case 'energy_boost':\r\n        // Trigger energy boosting activities\r\n        window.dispatchEvent(new CustomEvent('show-energy-boost', { \r\n          detail: recommendation.actionData \r\n        }));\r\n        break;\r\n    }\r\n  };\r\n\r\n  // Clean up expired recommendations using cleanupManager\r\n  useEffect(() => {\r\n    cleanup.setInterval(() => {\r\n      const now = new Date();\r\n      setActiveRecommendations(prev => \r\n        prev.filter(rec => new Date(rec.expiresAt) > now)\r\n      );\r\n    }, 60000); // Check every minute\r\n  }, [cleanup]);\r\n\r\n  // Subscribe to analytics events for metric updates\r\n  useEffect(() => {\r\n    const unsubscribe = analyticsEventBus.subscribe({\r\n      id: 'realtime-recommendations',\r\n      eventTypes: ['slide_interaction', 'attention_pattern_detected', 'energy_level_changed'],\r\n      callback: (event) => {\r\n        const { metadata } = event;\r\n        \r\n        // Process different event types\r\n        switch (event.eventType) {\r\n          case 'attention_pattern_detected':\r\n            processMetricUpdate('attention_score', metadata.attentionLevel, metadata);\r\n            break;\r\n          case 'energy_level_changed':\r\n            processMetricUpdate('energy_level', metadata.energyLevel, metadata);\r\n            break;\r\n          case 'slide_interaction':\r\n            processMetricUpdate('interaction_frequency', 1, metadata);\r\n            break;\r\n        }\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [processMetricUpdate]);\r\n\r\n  return {\r\n    activeRecommendations,\r\n    appliedRecommendations,\r\n    currentMetrics,\r\n    applyRecommendation,\r\n    dismissRecommendation,\r\n    rateRecommendation,\r\n    processMetricUpdate\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useResilientEPUBLoader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[922,925],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[922,925],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[968,971],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[968,971],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1084,1087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1084,1087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":90,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2881,2884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2881,2884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'tryLoadWithUrl'. Either include it or remove the dependency array.","line":224,"column":6,"nodeType":"ArrayExpression","endLine":224,"endColumn":42,"suggestions":[{"desc":"Update the dependencies array to be: [book.title, updateProgress, getUrlsToTry, tryLoadWithUrl]","fix":{"range":[7695,7731],"text":"[book.title, updateProgress, getUrlsToTry, tryLoadWithUrl]"}}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { PublicDomainBook } from '@/types/publicDomainBooks';\r\n\r\nexport interface ResilientEPUBProgress {\r\n  stage: 'downloading' | 'processing' | 'ready';\r\n  percentage: number;\r\n  message: string;\r\n  currentUrl?: string;\r\n  attemptNumber?: number;\r\n  bytesLoaded?: number;\r\n  totalBytes?: number;\r\n}\r\n\r\nexport interface ResilientEPUBError {\r\n  type: 'network' | 'timeout' | 'parsing' | 'unknown';\r\n  message: string;\r\n  recoverable: boolean;\r\n  retryCount: number;\r\n  failedUrls: string[];\r\n  lastAttemptUrl?: string;\r\n}\r\n\r\nexport const useResilientEPUBLoader = (book: PublicDomainBook) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [progress, setProgress] = useState<ResilientEPUBProgress | null>(null);\r\n  const [error, setError] = useState<ResilientEPUBError | null>(null);\r\n  const [epubInstance, setEpubInstance] = useState<any>(null);\r\n  const [toc, setToc] = useState<any[]>([]);\r\n  \r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n  const epubModuleRef = useRef<any>(null);\r\n  const failedUrlsRef = useRef<string[]>([]);\r\n  const retryCountRef = useRef(0);\r\n  \r\n  const TIMEOUT_DURATION = 15000; // 15 seconds per attempt\r\n  const MAX_RETRIES = 3;\r\n\r\n  const updateProgress = useCallback((\r\n    stage: ResilientEPUBProgress['stage'],\r\n    percentage: number,\r\n    message: string,\r\n    currentUrl?: string,\r\n    attemptNumber?: number\r\n  ) => {\r\n    setProgress({\r\n      stage,\r\n      percentage,\r\n      message,\r\n      currentUrl,\r\n      attemptNumber\r\n    });\r\n  }, []);\r\n\r\n  const getUrlsToTry = useCallback((): string[] => {\r\n    const urls: string[] = [];\r\n    \r\n    // Primary URL (storage or original)\r\n    if (book.storage_url) {\r\n      urls.push(book.storage_url);\r\n    } else if (book.epub_url) {\r\n      urls.push(book.epub_url);\r\n    }\r\n    \r\n    // Backup URLs for Gutenberg books\r\n    if (book.gutenberg_id) {\r\n      const gutenbergUrls = [\r\n        `https://www.gutenberg.org/ebooks/${book.gutenberg_id}.epub.noimages`,\r\n        `https://www.gutenberg.org/cache/epub/${book.gutenberg_id}/pg${book.gutenberg_id}.epub`,\r\n        `https://www.gutenberg.org/files/${book.gutenberg_id}/${book.gutenberg_id}-0.epub`\r\n      ];\r\n      \r\n      // Add Gutenberg URLs that aren't already in the list\r\n      gutenbergUrls.forEach(url => {\r\n        if (!urls.includes(url)) {\r\n          urls.push(url);\r\n        }\r\n      });\r\n    }\r\n    \r\n    // Proxy URLs as last resort\r\n    if (book.epub_url && !book.storage_url) {\r\n      const proxyUrl = `https://zgcegkmqfgznbpdplscz.supabase.co/functions/v1/epub-proxy?url=${encodeURIComponent(book.epub_url)}`;\r\n      urls.push(proxyUrl);\r\n    }\r\n    \r\n    return urls.filter(url => !failedUrlsRef.current.includes(url));\r\n  }, [book]);\r\n\r\n  const tryLoadWithUrl = async (url: string, attemptNumber: number): Promise<any> => {\r\n    console.log(`ðŸ“– Attempting to load EPUB from: ${url} (Attempt ${attemptNumber})`);\r\n    \r\n    updateProgress('downloading', 20 + (attemptNumber * 10), `Trying source ${attemptNumber}...`, url, attemptNumber);\r\n    \r\n    // Load EPUB.js if not already loaded\r\n    if (!epubModuleRef.current) {\r\n      updateProgress('processing', 30, 'Loading EPUB reader...', url, attemptNumber);\r\n      epubModuleRef.current = await import('epubjs');\r\n    }\r\n    \r\n    const EPubLib = epubModuleRef.current.default;\r\n    \r\n    updateProgress('processing', 50, 'Creating book instance...', url, attemptNumber);\r\n    \r\n    const epubBook = EPubLib(url);\r\n    \r\n    // Set up timeout for this attempt\r\n    const timeoutPromise = new Promise((_, reject) => {\r\n      setTimeout(() => {\r\n        reject(new Error(`Timeout loading from ${url}`));\r\n      }, TIMEOUT_DURATION);\r\n    });\r\n    \r\n    updateProgress('processing', 70, 'Waiting for book to load...', url, attemptNumber);\r\n    \r\n    // Wait for book to be ready\r\n    await Promise.race([epubBook.ready, timeoutPromise]);\r\n    \r\n    updateProgress('processing', 90, 'Loading table of contents...', url, attemptNumber);\r\n    \r\n    // Try to load navigation (non-critical)\r\n    try {\r\n      await Promise.race([\r\n        epubBook.loaded.navigation.then(() => {\r\n          setToc(epubBook.navigation?.toc || []);\r\n        }),\r\n        new Promise((_, reject) => setTimeout(() => reject(new Error('TOC timeout')), 3000))\r\n      ]);\r\n    } catch (navError) {\r\n      console.warn('âš ï¸ Could not load TOC, continuing without it');\r\n      setToc([]);\r\n    }\r\n    \r\n    console.log(`âœ… Successfully loaded EPUB from: ${url}`);\r\n    return epubBook;\r\n  };\r\n\r\n  const loadEPUB = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      setProgress(null);\r\n      setEpubInstance(null);\r\n      setToc([]);\r\n      failedUrlsRef.current = [];\r\n      retryCountRef.current = 0;\r\n      \r\n      // Clean up any previous abort controller\r\n      if (abortControllerRef.current) {\r\n        abortControllerRef.current.abort();\r\n      }\r\n      abortControllerRef.current = new AbortController();\r\n      \r\n      console.log('ðŸš€ Starting resilient EPUB load for:', book.title);\r\n      \r\n      updateProgress('downloading', 10, 'Preparing to load book...');\r\n      \r\n      const urlsToTry = getUrlsToTry();\r\n      \r\n      if (urlsToTry.length === 0) {\r\n        throw new Error('No valid URLs available for this book');\r\n      }\r\n      \r\n      let lastError: Error | null = null;\r\n      \r\n      // Try each URL in sequence\r\n      for (let i = 0; i < urlsToTry.length; i++) {\r\n        const url = urlsToTry[i];\r\n        \r\n        try {\r\n          const epubBook = await tryLoadWithUrl(url, i + 1);\r\n          \r\n          updateProgress('ready', 100, 'Book ready to read!', url);\r\n          \r\n          setEpubInstance(epubBook);\r\n          setIsLoading(false);\r\n          setProgress(null);\r\n          \r\n          return; // Success!\r\n          \r\n        } catch (urlError) {\r\n          console.warn(`âŒ Failed to load from ${url}:`, urlError);\r\n          failedUrlsRef.current.push(url);\r\n          lastError = urlError instanceof Error ? urlError : new Error(String(urlError));\r\n          \r\n          // If not the last URL, continue to next\r\n          if (i < urlsToTry.length - 1) {\r\n            updateProgress('downloading', 30 + (i * 20), `Source ${i + 1} failed, trying next...`);\r\n            await new Promise(resolve => setTimeout(resolve, 500)); // Brief pause between attempts\r\n          }\r\n        }\r\n      }\r\n      \r\n      // All URLs failed\r\n      throw new Error(`All sources failed. Last error: ${lastError?.message || 'Unknown error'}`);\r\n      \r\n    } catch (err) {\r\n      console.error('âŒ Resilient EPUB loading failed:', err);\r\n      \r\n      const errorMessage = err instanceof Error ? err.message : String(err);\r\n      \r\n      // Map the error type to compatible types\r\n      let errorType: 'network' | 'timeout' | 'parsing' | 'unknown' = 'unknown';\r\n      if (errorMessage.includes('timeout') || errorMessage.includes('Timeout')) {\r\n        errorType = 'timeout';\r\n      } else if (errorMessage.includes('Failed to fetch') || errorMessage.includes('NetworkError')) {\r\n        errorType = 'network';\r\n      } else if (errorMessage.includes('parse') || errorMessage.includes('Parse')) {\r\n        errorType = 'parsing';\r\n      }\r\n      \r\n      setError({\r\n        type: errorType,\r\n        message: `Unable to load \"${book.title}\". ${errorMessage}`,\r\n        recoverable: true,\r\n        retryCount: retryCountRef.current,\r\n        failedUrls: [...failedUrlsRef.current],\r\n        lastAttemptUrl: failedUrlsRef.current[failedUrlsRef.current.length - 1]\r\n      });\r\n      \r\n      setIsLoading(false);\r\n      setProgress(null);\r\n    }\r\n  }, [book, updateProgress, getUrlsToTry]);\r\n\r\n  const retryLoad = useCallback(() => {\r\n    failedUrlsRef.current = []; // Reset failed URLs for retry\r\n    retryCountRef.current++;\r\n    setError(null);\r\n    loadEPUB();\r\n  }, [loadEPUB]);\r\n\r\n  const abortLoad = useCallback(() => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n    setIsLoading(false);\r\n    setProgress(null);\r\n    setError(null);\r\n  }, []);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (abortControllerRef.current) {\r\n        abortControllerRef.current.abort();\r\n      }\r\n      if (epubInstance && typeof epubInstance.destroy === 'function') {\r\n        try {\r\n          epubInstance.destroy();\r\n        } catch (err) {\r\n          console.warn('EPUB cleanup error (non-critical):', err);\r\n        }\r\n      }\r\n    };\r\n  }, [epubInstance]);\r\n\r\n  return {\r\n    isLoading,\r\n    progress,\r\n    error,\r\n    epubInstance,\r\n    toc,\r\n    loadEPUB,\r\n    retryLoad,\r\n    abortLoad\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSafeNavigation.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1393,1396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1393,1396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from './useAuth';\r\n\r\n/**\r\n * Hook that provides safe navigation methods that respect authentication state\r\n * and prevent bypassing login requirements through browser history manipulation\r\n */\r\nexport const useSafeNavigation = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { user } = useAuth();\r\n\r\n  /**\r\n   * Safe back navigation that checks authentication before navigating\r\n   * If the user is not authenticated, redirects to login instead of following browser history\r\n   */\r\n  const navigateBack = () => {\r\n    // If user is not authenticated, always go to login\r\n    if (!user) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    // Check if we came from a login/auth page based on referrer or state\r\n    const state = location.state as { from?: string } | null;\r\n    const referrer = state?.from;\r\n\r\n    // If we came from login or registration, go to dashboard instead of back\r\n    if (referrer === '/login' || referrer === '/' || !referrer) {\r\n      navigate('/dashboard');\r\n      return;\r\n    }\r\n\r\n    // For authenticated users with safe referrer, use normal back navigation\r\n    navigate(-1);\r\n  };\r\n\r\n  /**\r\n   * Navigate to a specific route with authentication checks\r\n   */\r\n  const safeNavigate = (to: string, options?: { replace?: boolean; state?: any }) => {\r\n    // If trying to navigate to protected routes without authentication, redirect to login\r\n    const protectedRoutes = ['/dashboard', '/profile', '/settings'];\r\n    const isProtectedRoute = protectedRoutes.some(route => to.startsWith(route));\r\n    \r\n    if (isProtectedRoute && !user) {\r\n      navigate('/login', { state: { from: location.pathname } });\r\n      return;\r\n    }\r\n\r\n    navigate(to, options);\r\n  };\r\n\r\n  /**\r\n   * Navigate to legal pages with proper state tracking\r\n   */\r\n  const navigateToLegal = (page: 'privacy' | 'terms') => {\r\n    const targetPath = page === 'privacy' ? '/privacy' : '/terms';\r\n    navigate(targetPath, { \r\n      state: { from: location.pathname },\r\n      replace: false \r\n    });\r\n  };\r\n\r\n  return {\r\n    navigateBack,\r\n    safeNavigate,\r\n    navigateToLegal,\r\n    navigate, // Keep original navigate for cases where we need it\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSaveToNotes.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[822,825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[822,825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useNotes } from '@/hooks/useNotes';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { ToastAction } from '@/components/ui/toast';\r\nimport React from 'react';\r\n\r\ninterface SaveToNotesData {\r\n  title: string;\r\n  content: string;\r\n  tags: string[];\r\n  originalQuestion?: string;\r\n  aiMode?: string;\r\n  generateFlashcards: boolean;\r\n}\r\n\r\nexport const useSaveToNotes = () => {\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [isGeneratingFlashcards, setIsGeneratingFlashcards] = useState(false);\r\n  const [lastSavedNote, setLastSavedNote] = useState<any>(null);\r\n  const [flashcardGenerationError, setFlashcardGenerationError] = useState<string | null>(null);\r\n  const { createNote } = useNotes();\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const navigate = useNavigate();\r\n\r\n  const openDialog = () => setIsDialogOpen(true);\r\n  const closeDialog = () => {\r\n    setIsDialogOpen(false);\r\n    setFlashcardGenerationError(null);\r\n  };\r\n\r\n  const saveToNotes = async (data: SaveToNotesData) => {\r\n    setIsSaving(true);\r\n    setFlashcardGenerationError(null);\r\n    \r\n    try {\r\n      // Prepare metadata\r\n      const metadata = {\r\n        originalQuestion: data.originalQuestion,\r\n        aiMode: data.aiMode,\r\n        savedAt: new Date().toISOString(),\r\n        source: 'ai-coach'\r\n      };\r\n\r\n      // Create the note with AI Insights category\r\n      const noteData = {\r\n        title: data.title,\r\n        content: data.content,\r\n        tags: ['AI Insights', ...data.tags],\r\n        category: 'ai-insights'\r\n      };\r\n\r\n      createNote(noteData);\r\n\r\n      // Store reference for undo functionality\r\n      setLastSavedNote({\r\n        ...noteData,\r\n        metadata,\r\n        generateFlashcards: data.generateFlashcards\r\n      });\r\n\r\n      // Show note saved confirmation\r\n      toast({\r\n        title: \"Note Saved\",\r\n        description: \"Your AI response has been saved to notes.\",\r\n      });\r\n\r\n      // Generate flashcards if requested\r\n      if (data.generateFlashcards && user) {\r\n        setIsGeneratingFlashcards(true);\r\n        \r\n        try {\r\n          console.log('ðŸŽ¯ Starting flashcard generation for AI Coach content...');\r\n          console.log('Content length:', data.content.length);\r\n          console.log('Content preview:', data.content.substring(0, 100) + '...');\r\n          \r\n          const { data: result, error } = await supabase.functions.invoke('process-file-flashcards', {\r\n            body: {\r\n              content: data.content,\r\n              title: data.title,\r\n              source: 'ai-coach-note',\r\n              userId: user.id,\r\n              previewMode: false // Save directly to database\r\n            }\r\n          });\r\n          \r\n          if (error) {\r\n            console.error('âŒ Edge function error:', error);\r\n            throw new Error(`Flashcard generation failed: ${error.message}`);\r\n          }\r\n\r\n          console.log('âœ… Flashcard generation result:', result);\r\n          \r\n          if (result?.flashcardsGenerated > 0) {\r\n            toast({\r\n              title: \"ðŸŽ‰ Flashcards Created!\",\r\n              description: `Generated ${result.flashcardsGenerated} flashcards from your AI response. Check your Flashcard Manager!`,\r\n              action: (\r\n                <ToastAction\r\n                  altText=\"View flashcards\"\r\n                  onClick={() => navigate('/dashboard/learner/flashcards')}\r\n                >\r\n                  View Flashcards\r\n                </ToastAction>\r\n              )\r\n            });\r\n          } else {\r\n            throw new Error('No flashcards were generated from the content');\r\n          }\r\n          \r\n        } catch (error) {\r\n          console.error('ðŸ’¥ Flashcard generation error:', error);\r\n          const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred';\r\n          setFlashcardGenerationError(errorMessage);\r\n          \r\n          toast({\r\n            title: \"âš ï¸ Flashcard Generation Failed\",\r\n            description: `Note saved successfully, but flashcard generation failed: ${errorMessage}`,\r\n            variant: \"destructive\",\r\n            action: (\r\n              <ToastAction\r\n                altText=\"Retry\"\r\n                onClick={() => retryFlashcardGeneration(data)}\r\n              >\r\n                Retry\r\n              </ToastAction>\r\n            )\r\n          });\r\n        } finally {\r\n          setIsGeneratingFlashcards(false);\r\n        }\r\n      }\r\n\r\n      closeDialog();\r\n    } catch (error) {\r\n      console.error('Error saving to notes:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save note. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  const retryFlashcardGeneration = async (data: SaveToNotesData) => {\r\n    if (!user || !data.generateFlashcards) return;\r\n    \r\n    setIsGeneratingFlashcards(true);\r\n    setFlashcardGenerationError(null);\r\n    \r\n    try {\r\n      console.log('ðŸ”„ Retrying flashcard generation...');\r\n      \r\n      const { data: result, error } = await supabase.functions.invoke('process-file-flashcards', {\r\n        body: {\r\n          content: data.content,\r\n          title: data.title,\r\n          source: 'ai-coach-note',\r\n          userId: user.id,\r\n          previewMode: false\r\n        }\r\n      });\r\n      \r\n      if (error) {\r\n        throw new Error(`Retry failed: ${error.message}`);\r\n      }\r\n\r\n      if (result?.flashcardsGenerated > 0) {\r\n        toast({\r\n          title: \"âœ… Flashcards Generated!\",\r\n          description: `Successfully created ${result.flashcardsGenerated} flashcards on retry.`,\r\n        });\r\n      } else {\r\n        throw new Error('Retry generated no flashcards');\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Retry failed:', error);\r\n      const errorMessage = error instanceof Error ? error.message : 'Retry failed';\r\n      setFlashcardGenerationError(errorMessage);\r\n      \r\n      toast({\r\n        title: \"Retry Failed\",\r\n        description: errorMessage,\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsGeneratingFlashcards(false);\r\n    }\r\n  };\r\n\r\n  const undoSave = () => {\r\n    if (lastSavedNote) {\r\n      toast({\r\n        title: \"Undo completed\",\r\n        description: \"The saved note has been removed.\"\r\n      });\r\n      setLastSavedNote(null);\r\n    }\r\n  };\r\n\r\n  const generateSuggestedTags = (content: string, originalQuestion?: string): string[] => {\r\n    const commonTags: string[] = [];\r\n    const text = `${content} ${originalQuestion || ''}`.toLowerCase();\r\n\r\n    // Subject-based tags\r\n    if (text.includes('history') || text.includes('civil war') || text.includes('revolution')) {\r\n      commonTags.push('History');\r\n    }\r\n    if (text.includes('science') || text.includes('physics') || text.includes('chemistry')) {\r\n      commonTags.push('Science');\r\n    }\r\n    if (text.includes('math') || text.includes('equation') || text.includes('calculation')) {\r\n      commonTags.push('Mathematics');\r\n    }\r\n    if (text.includes('literature') || text.includes('novel') || text.includes('poem')) {\r\n      commonTags.push('Literature');\r\n    }\r\n\r\n    // Type-based tags\r\n    if (text.includes('definition') || text.includes('meaning')) {\r\n      commonTags.push('Definitions');\r\n    }\r\n    if (text.includes('strategy') || text.includes('technique') || text.includes('method')) {\r\n      commonTags.push('Study Strategy');\r\n    }\r\n    if (text.includes('quiz') || text.includes('test') || text.includes('exam')) {\r\n      commonTags.push('Test Prep');\r\n    }\r\n\r\n    return commonTags.slice(0, 3);\r\n  };\r\n\r\n  const generateTitle = (content: string, originalQuestion?: string): string => {\r\n    if (originalQuestion && originalQuestion.length > 0) {\r\n      let title = originalQuestion.replace(/^(what|how|why|when|where|who)\\s+/i, '');\r\n      title = title.charAt(0).toUpperCase() + title.slice(1);\r\n      if (title.length > 60) {\r\n        title = title.substring(0, 57) + '...';\r\n      }\r\n      return title;\r\n    }\r\n\r\n    const sentences = content.split(/[.!?]+/);\r\n    const firstSentence = sentences[0]?.trim();\r\n    \r\n    if (firstSentence && firstSentence.length > 10) {\r\n      let title = firstSentence;\r\n      if (title.length > 60) {\r\n        title = title.substring(0, 57) + '...';\r\n      }\r\n      return title;\r\n    }\r\n\r\n    return 'AI Coach Insight';\r\n  };\r\n\r\n  return {\r\n    isDialogOpen,\r\n    isSaving,\r\n    isGeneratingFlashcards,\r\n    flashcardGenerationError,\r\n    lastSavedNote,\r\n    openDialog,\r\n    closeDialog,\r\n    saveToNotes,\r\n    retryFlashcardGeneration,\r\n    undoSave,\r\n    generateSuggestedTags,\r\n    generateTitle\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSavedCoachChats.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSavedChats'. Either include it or remove the dependency array.","line":249,"column":6,"nodeType":"ArrayExpression","endLine":249,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [loadSavedChats, user]","fix":{"range":[7477,7483],"text":"[loadSavedChats, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface SavedChatMessage {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\ninterface SavedCoachChat {\r\n  id: string;\r\n  user_id: string;\r\n  title: string;\r\n  context_tag: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  message_count?: number;\r\n  preview?: string;\r\n}\r\n\r\nexport const useSavedCoachChats = () => {\r\n  const [savedChats, setSavedChats] = useState<SavedCoachChat[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n\r\n  // Load saved AI coach chats\r\n  const loadSavedChats = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('chat_sessions')\r\n        .select(`\r\n          *,\r\n          chat_messages(id, content)\r\n        `)\r\n        .eq('user_id', user.id)\r\n        .eq('context_tag', 'AI_Coach')\r\n        .order('updated_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n\r\n      const chatsWithMetadata = data?.map(chat => ({\r\n        ...chat,\r\n        message_count: chat.chat_messages?.length || 0,\r\n        preview: chat.chat_messages?.length > 0 \r\n          ? chat.chat_messages[0].content.substring(0, 100) + '...'\r\n          : 'Empty chat'\r\n      })) || [];\r\n\r\n      setSavedChats(chatsWithMetadata);\r\n    } catch (error) {\r\n      console.error('Error loading saved chats:', error);\r\n      toast({\r\n        title: \"Error loading saved chats\",\r\n        description: \"There was a problem loading your saved conversations.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Save current chat messages to database\r\n  const saveCurrentChat = async (messages: SavedChatMessage[], title?: string) => {\r\n    if (!user || messages.length === 0) return null;\r\n\r\n    try {\r\n      // Generate title from first user message or use provided title\r\n      const generatedTitle = title || generateChatTitle(messages) || 'AI Coach Chat';\r\n\r\n      // Create chat session\r\n      const { data: session, error: sessionError } = await supabase\r\n        .from('chat_sessions')\r\n        .insert({\r\n          user_id: user.id,\r\n          title: generatedTitle,\r\n          context_tag: 'AI_Coach'\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (sessionError) throw sessionError;\r\n\r\n      // Save all messages\r\n      const messagesToSave = messages.map(msg => ({\r\n        session_id: session.id,\r\n        role: msg.role,\r\n        content: msg.content,\r\n        timestamp: msg.timestamp\r\n      }));\r\n\r\n      const { error: messagesError } = await supabase\r\n        .from('chat_messages')\r\n        .insert(messagesToSave);\r\n\r\n      if (messagesError) throw messagesError;\r\n\r\n      // Refresh saved chats\r\n      await loadSavedChats();\r\n\r\n      toast({\r\n        title: \"Chat saved successfully\",\r\n        description: `\"${generatedTitle}\" has been saved to your history.`,\r\n        duration: 3000\r\n      });\r\n\r\n      return session;\r\n    } catch (error) {\r\n      console.error('Error saving chat:', error);\r\n      toast({\r\n        title: \"Error saving chat\",\r\n        description: \"There was a problem saving your conversation.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // Load messages from a saved chat\r\n  const loadChatMessages = async (chatId: string): Promise<SavedChatMessage[]> => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('chat_messages')\r\n        .select('*')\r\n        .eq('session_id', chatId)\r\n        .order('timestamp', { ascending: true });\r\n\r\n      if (error) throw error;\r\n\r\n      return data?.map(msg => ({\r\n        id: msg.id,\r\n        role: msg.role as 'user' | 'assistant',\r\n        content: msg.content,\r\n        timestamp: msg.timestamp\r\n      })) || [];\r\n    } catch (error) {\r\n      console.error('Error loading chat messages:', error);\r\n      toast({\r\n        title: \"Error loading chat\",\r\n        description: \"There was a problem loading the conversation.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return [];\r\n    }\r\n  };\r\n\r\n  // Delete a saved chat\r\n  const deleteSavedChat = async (chatId: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('chat_sessions')\r\n        .delete()\r\n        .eq('id', chatId);\r\n\r\n      if (error) throw error;\r\n\r\n      setSavedChats(prev => prev.filter(chat => chat.id !== chatId));\r\n      \r\n      toast({\r\n        title: \"Chat deleted\",\r\n        description: \"The conversation has been removed from your history.\",\r\n        duration: 2000\r\n      });\r\n    } catch (error) {\r\n      console.error('Error deleting chat:', error);\r\n      toast({\r\n        title: \"Error deleting chat\",\r\n        description: \"There was a problem deleting the conversation.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  // Rename a saved chat\r\n  const renameSavedChat = async (chatId: string, newTitle: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('chat_sessions')\r\n        .update({ title: newTitle, updated_at: new Date().toISOString() })\r\n        .eq('id', chatId);\r\n\r\n      if (error) throw error;\r\n\r\n      setSavedChats(prev => \r\n        prev.map(chat => \r\n          chat.id === chatId \r\n            ? { ...chat, title: newTitle, updated_at: new Date().toISOString() }\r\n            : chat\r\n        )\r\n      );\r\n\r\n      toast({\r\n        title: \"Chat renamed\",\r\n        description: `Chat renamed to \"${newTitle}\"`,\r\n        duration: 2000\r\n      });\r\n    } catch (error) {\r\n      console.error('Error renaming chat:', error);\r\n      toast({\r\n        title: \"Error renaming chat\",\r\n        description: \"There was a problem renaming the conversation.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  // Generate a smart title from messages\r\n  const generateChatTitle = (messages: SavedChatMessage[]): string => {\r\n    const firstUserMessage = messages.find(m => m.role === 'user')?.content;\r\n    if (!firstUserMessage) return 'AI Coach Chat';\r\n\r\n    // Extract key topics or subjects\r\n    const content = firstUserMessage.toLowerCase();\r\n    \r\n    // Look for common study subjects\r\n    if (content.includes('math') || content.includes('algebra') || content.includes('calculus')) {\r\n      return 'Math Help Session';\r\n    }\r\n    if (content.includes('science') || content.includes('biology') || content.includes('chemistry') || content.includes('physics')) {\r\n      return 'Science Study Session';\r\n    }\r\n    if (content.includes('history') || content.includes('geography')) {\r\n      return 'History Study Session';\r\n    }\r\n    if (content.includes('english') || content.includes('literature') || content.includes('writing')) {\r\n      return 'English Study Session';\r\n    }\r\n    if (content.includes('quiz') || content.includes('test') || content.includes('exam')) {\r\n      return 'Quiz Practice Session';\r\n    }\r\n    if (content.includes('study') || content.includes('learn')) {\r\n      return 'Study Session';\r\n    }\r\n\r\n    // Use first few words if no topic detected\r\n    const words = firstUserMessage.split(' ').slice(0, 4).join(' ');\r\n    return words.length > 30 ? words.substring(0, 30) + '...' : words;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadSavedChats();\r\n    }\r\n  }, [user]);\r\n\r\n  return {\r\n    savedChats,\r\n    isLoading,\r\n    saveCurrentChat,\r\n    loadChatMessages,\r\n    deleteSavedChat,\r\n    renameSavedChat,\r\n    loadSavedChats\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useScormAnalytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2115,2118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2115,2118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2765,2768],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2765,2768],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":143,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3642,3645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3642,3645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":165,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4245,4248],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4245,4248],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":199,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5007,5010],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5007,5010],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface AnalyticsFilters {\r\n  packageId?: string;\r\n  dateFrom?: string;\r\n  dateTo?: string;\r\n  page?: number;\r\n  pageSize?: number;\r\n  search?: string;\r\n  _timestamp?: number;\r\n}\r\n\r\ninterface KPIs {\r\n  totalPackages: number;\r\n  activeEnrollments: number;\r\n  avgScore: number;\r\n  completionRate: number;\r\n}\r\n\r\ninterface PackagePerformance {\r\n  packageId: string;\r\n  packageTitle: string;\r\n  enrollments: number;\r\n  completions: number;\r\n  completionRate: number;\r\n  avgScore: number;\r\n}\r\n\r\ninterface LearnerProgress {\r\n  userId: string;\r\n  packageId: string;\r\n  packageTitle: string;\r\n  learnerName: string;\r\n  scosCompleted: number;\r\n  scosTotal: number;\r\n  progressPct: number;\r\n  lastActivity: string | null;\r\n}\r\n\r\ninterface TrendData {\r\n  date: string;\r\n  enrollments: number;\r\n  activeLearners: number;\r\n  avgScore: number;\r\n  completionRate: number;\r\n}\r\n\r\nasync function callAnalyticsFunction(type: string, filters: AnalyticsFilters) {\r\n  const { data, error } = await supabase.functions.invoke('scorm-analytics', {\r\n    body: {\r\n      type,\r\n      ...filters\r\n    }\r\n  });\r\n\r\n  if (error) {\r\n    throw new Error(error.message || 'Analytics request failed');\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function useScormKPIs(filters: AnalyticsFilters) {\r\n  const { toast } = useToast();\r\n\r\n  const query = useQuery<KPIs>({\r\n    queryKey: ['scorm-kpis', filters.packageId, filters.dateFrom, filters.dateTo, filters._timestamp],\r\n    queryFn: () => callAnalyticsFunction('kpis', filters),\r\n    staleTime: 0, // Always fetch fresh data\r\n    gcTime: 0, // Don't cache results (replaces cacheTime)\r\n    retry: 1, // Only retry once\r\n    refetchOnMount: true,\r\n    refetchOnWindowFocus: true\r\n  });\r\n\r\n  // Handle errors with useEffect\r\n  React.useEffect(() => {\r\n    if (query.error) {\r\n      console.error('KPI query error:', query.error);\r\n      toast({\r\n        title: \"Failed to load KPIs\",\r\n        description: (query.error as any).message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  }, [query.error, toast]);\r\n\r\n  return query;\r\n}\r\n\r\nexport function usePackagePerformance(filters: AnalyticsFilters) {\r\n  const { toast } = useToast();\r\n\r\n  const query = useQuery<PackagePerformance[]>({\r\n    queryKey: ['package-performance', filters.packageId, filters.dateFrom, filters.dateTo],\r\n    queryFn: () => callAnalyticsFunction('package-performance', filters),\r\n    staleTime: 1000 * 60 * 2, // 2 minutes\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (query.error) {\r\n      toast({\r\n        title: \"Failed to load package performance\",\r\n        description: (query.error as any).message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  }, [query.error, toast]);\r\n\r\n  return query;\r\n}\r\n\r\nexport function useLearnerProgress(filters: AnalyticsFilters) {\r\n  const { toast } = useToast();\r\n\r\n  const query = useQuery<{\r\n    data: LearnerProgress[];\r\n    total: number;\r\n    page: number;\r\n    pageSize: number;\r\n  }>({\r\n    queryKey: [\r\n      'learner-progress', \r\n      filters.packageId, \r\n      filters.dateFrom, \r\n      filters.dateTo,\r\n      filters.page,\r\n      filters.pageSize,\r\n      filters.search\r\n    ],\r\n    queryFn: () => callAnalyticsFunction('learner-progress', filters),\r\n    staleTime: 1000 * 60 * 2, // 2 minutes\r\n    placeholderData: (previousData) => previousData,\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (query.error) {\r\n      toast({\r\n        title: \"Failed to load learner progress\",\r\n        description: (query.error as any).message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  }, [query.error, toast]);\r\n\r\n  return query;\r\n}\r\n\r\nexport function useScormTrends(filters: AnalyticsFilters) {\r\n  const { toast } = useToast();\r\n\r\n  const query = useQuery<TrendData[]>({\r\n    queryKey: ['scorm-trends', filters.packageId, filters.dateFrom, filters.dateTo],\r\n    queryFn: () => callAnalyticsFunction('trends', filters),\r\n    staleTime: 1000 * 60 * 10, // 10 minutes\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (query.error) {\r\n      toast({\r\n        title: \"Failed to load trends\",\r\n        description: (query.error as any).message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  }, [query.error, toast]);\r\n\r\n  return query;\r\n}\r\n\r\nexport function useScormPackagesList() {\r\n  const { toast } = useToast();\r\n\r\n  const query = useQuery({\r\n    queryKey: ['scorm-packages-list'],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('scorm_packages')\r\n        .select('id, title')\r\n        .eq('status', 'ready')\r\n        .order('title');\r\n\r\n      if (error) {\r\n        throw new Error(error.message);\r\n      }\r\n\r\n      return data;\r\n    },\r\n    staleTime: 1000 * 60 * 10, // 10 minutes\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (query.error) {\r\n      toast({\r\n        title: \"Failed to load packages\",\r\n        description: (query.error as any).message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  }, [query.error, toast]);\r\n\r\n  return query;\r\n}\r\n\r\nexport async function exportAnalytics(\r\n  view: 'packages' | 'learners' | 'trends',\r\n  filters: AnalyticsFilters\r\n) {\r\n  const { data, error } = await supabase.functions.invoke('scorm-analytics-export', {\r\n    body: {\r\n      view,\r\n      ...filters\r\n    }\r\n  });\r\n\r\n  if (error) {\r\n    throw new Error(error.message || 'Export failed');\r\n  }\r\n\r\n  // Create and trigger download\r\n  const blob = new Blob([data], { type: 'text/csv' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = `scorm-${view}-${new Date().toISOString().split('T')[0]}.csv`;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  window.URL.revokeObjectURL(url);\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useScormPackages.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[489,492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[489,492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nexport interface ScormPackage {\r\n  id: string;\r\n  org_id?: string;\r\n  title: string;\r\n  description?: string;\r\n  version?: string;\r\n  manifest_path: string;\r\n  zip_path: string;\r\n  extract_path: string;\r\n  status: 'uploading' | 'parsing' | 'ready' | 'error' | 'archived';\r\n  metadata: Record<string, any>;\r\n  scorm_version?: string;\r\n  standard?: 'SCORM 1.2' | 'SCORM 2004';\r\n  is_public?: boolean;\r\n  access_count?: number;\r\n  last_accessed_at?: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  created_by: string;\r\n}\r\n\r\nexport interface ScormSco {\r\n  id: string;\r\n  package_id: string;\r\n  identifier: string;\r\n  title: string;\r\n  launch_href: string;\r\n  parameters?: string;\r\n  mastery_score?: number;\r\n  is_launchable: boolean;\r\n  seq_order: number;\r\n  prerequisites?: string[];\r\n  scorm_type?: string;\r\n  completion_threshold?: number;\r\n  time_limit_action?: string;\r\n  data_from_lms?: string;\r\n  created_at: string;\r\n}\r\n\r\nexport function useScormPackages() {\r\n  const { toast } = useToast();\r\n\r\n  const { data: packages = [], isLoading, error, refetch } = useQuery({\r\n    queryKey: ['scorm-packages'],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('scorm_packages')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching SCORM packages:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as ScormPackage[];\r\n    },\r\n    staleTime: 1000 * 60 * 5, // 5 minutes\r\n  });\r\n\r\n  return {\r\n    packages,\r\n    isLoading,\r\n    error,\r\n    refetch\r\n  };\r\n}\r\n\r\nexport function useScormPackage(packageId: string) {\r\n  const { data: packageData, isLoading, error } = useQuery({\r\n    queryKey: ['scorm-package', packageId],\r\n    queryFn: async () => {\r\n      if (!packageId) return null;\r\n\r\n      const { data, error } = await supabase\r\n        .from('scorm_packages')\r\n        .select('*')\r\n        .eq('id', packageId)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error fetching SCORM package:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as ScormPackage;\r\n    },\r\n    enabled: !!packageId,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n\r\n  return {\r\n    package: packageData,\r\n    isLoading,\r\n    error\r\n  };\r\n}\r\n\r\nexport function useScormScos(packageId: string) {\r\n  const { data: scos = [], isLoading, error } = useQuery({\r\n    queryKey: ['scorm-scos', packageId],\r\n    queryFn: async () => {\r\n      if (!packageId) return [];\r\n\r\n      const { data, error } = await supabase\r\n        .from('scorm_scos')\r\n        .select('*')\r\n        .eq('package_id', packageId)\r\n        .order('seq_order', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('Error fetching SCORM SCOs:', error);\r\n        throw error;\r\n      }\r\n\r\n      return data as ScormSco[];\r\n    },\r\n    enabled: !!packageId,\r\n    staleTime: 1000 * 60 * 5,\r\n  });\r\n\r\n  return {\r\n    scos,\r\n    isLoading,\r\n    error\r\n  };\r\n}\r\n\r\nexport function useScormPackageMutations() {\r\n  const queryClient = useQueryClient();\r\n  const { toast } = useToast();\r\n\r\n  const createPackage = useMutation({\r\n    mutationFn: async (packageData: Omit<ScormPackage, 'id' | 'created_at' | 'updated_at'>) => {\r\n      const { data, error } = await supabase\r\n        .from('scorm_packages')\r\n        .insert([packageData])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['scorm-packages'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"SCORM package created successfully\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error creating package:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create SCORM package\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  });\r\n\r\n  const updatePackage = useMutation({\r\n    mutationFn: async ({ id, ...updates }: Partial<ScormPackage> & { id: string }) => {\r\n      const { data, error } = await supabase\r\n        .from('scorm_packages')\r\n        .update(updates)\r\n        .eq('id', id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['scorm-packages'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"SCORM package updated successfully\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error updating package:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update SCORM package\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  });\r\n\r\n  const deletePackage = useMutation({\r\n    mutationFn: async (packageId: string) => {\r\n      const { error } = await supabase\r\n        .from('scorm_packages')\r\n        .delete()\r\n        .eq('id', packageId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['scorm-packages'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"SCORM package deleted successfully\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error deleting package:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete SCORM package\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  });\r\n\r\n  return {\r\n    createPackage: createPackage.mutate,\r\n    updatePackage: updatePackage.mutate,\r\n    deletePackage: deletePackage.mutate,\r\n    isCreating: createPackage.isPending,\r\n    isUpdating: updatePackage.isPending,\r\n    isDeleting: deletePackage.isPending\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useScrollRestoration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSearchAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSettingsVideoStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSlideAnalytics.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'endSlideView' and 'startAttentionMonitoring'. Either include them or remove the dependency array.","line":67,"column":6,"nodeType":"ArrayExpression","endLine":67,"endColumn":50,"suggestions":[{"desc":"Update the dependencies array to be: [user.id, currentSlide, courseId, lessonId, startAttentionMonitoring, endSlideView]","fix":{"range":[1913,1957],"text":"[user.id, currentSlide, courseId, lessonId, startAttentionMonitoring, endSlideView]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2096,2099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2096,2099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3748,3751],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3748,3751],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":264,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":264,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9187,9190],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9187,9190],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useEffect, useRef } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { analyticsEventBus } from '@/services/AnalyticsEventBus';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface SlideView {\r\n  slideId: string;\r\n  slideTitle: string;\r\n  startTime: number;\r\n  interactions: number;\r\n  attentionScore: number;\r\n  cognitiveLoad: number;\r\n}\r\n\r\nexport const useSlideAnalytics = (\r\n  courseId: string,\r\n  lessonId?: string\r\n) => {\r\n  const cleanup = useCleanup('slide-analytics');\r\n  const { user } = useAuth();\r\n  const [currentSlide, setCurrentSlide] = useState<SlideView | null>(null);\r\n  const [slideHistory, setSlideHistory] = useState<SlideView[]>([]);\r\n  const attentionTimerRef = useRef<string>();\r\n  const inactivityTimerRef = useRef<string>();\r\n  const lastActivityRef = useRef<number>(Date.now());\r\n\r\n  // Track slide view start\r\n  const startSlideView = useCallback((slideId: string, slideTitle: string) => {\r\n    if (!user?.id) return;\r\n\r\n    // End previous slide if exists\r\n    if (currentSlide) {\r\n      endSlideView();\r\n    }\r\n\r\n    const slideView: SlideView = {\r\n      slideId,\r\n      slideTitle,\r\n      startTime: Date.now(),\r\n      interactions: 0,\r\n      attentionScore: 100, // Start at full attention\r\n      cognitiveLoad: 0\r\n    };\r\n\r\n    setCurrentSlide(slideView);\r\n    lastActivityRef.current = Date.now();\r\n\r\n    // Track slide view start event\r\n    analyticsEventBus.publish({\r\n      userId: user.id,\r\n      eventType: 'slide_view_start',\r\n      metadata: {\r\n        courseId,\r\n        lessonId,\r\n        slideId,\r\n        slideTitle,\r\n        timestamp: new Date().toISOString()\r\n      },\r\n      source: 'slide_tracking'\r\n    });\r\n\r\n    // Start attention monitoring\r\n    startAttentionMonitoring();\r\n\r\n    console.log(`ðŸ” Started slide view: ${slideId}`);\r\n  }, [user?.id, courseId, lessonId, currentSlide]);\r\n\r\n  // Track slide interaction\r\n  const trackSlideInteraction = useCallback((interactionType: string, interactionData?: Record<string, any>) => {\r\n    if (!currentSlide || !user?.id) return;\r\n\r\n    lastActivityRef.current = Date.now();\r\n    \r\n    setCurrentSlide(prev => prev ? {\r\n      ...prev,\r\n      interactions: prev.interactions + 1,\r\n      attentionScore: Math.min(100, prev.attentionScore + 2) // Small attention boost\r\n    } : null);\r\n\r\n    // Store slide interaction\r\n    supabase\r\n      .from('slide_analytics')\r\n      .insert({\r\n        user_id: user.id,\r\n        course_id: courseId,\r\n        lesson_id: lessonId,\r\n        slide_id: currentSlide.slideId,\r\n        slide_title: currentSlide.slideTitle,\r\n        event_type: 'interaction',\r\n        interaction_data: {\r\n          type: interactionType,\r\n          ...interactionData,\r\n          timestamp: new Date().toISOString()\r\n        },\r\n        attention_score: currentSlide.attentionScore,\r\n        cognitive_load_indicator: currentSlide.cognitiveLoad\r\n      })\r\n      .then(({ error }) => {\r\n        if (error) console.error('Error tracking slide interaction:', error);\r\n      });\r\n\r\n    // Publish to event bus\r\n    analyticsEventBus.publish({\r\n      userId: user.id,\r\n      eventType: 'slide_interaction',\r\n      metadata: {\r\n        courseId,\r\n        lessonId,\r\n        slideId: currentSlide.slideId,\r\n        interactionType,\r\n        attentionScore: currentSlide.attentionScore,\r\n        ...interactionData\r\n      },\r\n      source: 'slide_tracking'\r\n    });\r\n\r\n    console.log(`ðŸ–±ï¸ Slide interaction: ${interactionType} on ${currentSlide.slideId}`);\r\n  }, [currentSlide, user?.id, courseId, lessonId]);\r\n\r\n  // Track slide completion\r\n  const markSlideComplete = useCallback((completionQuality?: Record<string, any>) => {\r\n    if (!currentSlide || !user?.id) return;\r\n\r\n    const duration = Math.floor((Date.now() - currentSlide.startTime) / 1000);\r\n\r\n    // Store slide completion\r\n    supabase\r\n      .from('slide_analytics')\r\n      .insert({\r\n        user_id: user.id,\r\n        course_id: courseId,\r\n        lesson_id: lessonId,\r\n        slide_id: currentSlide.slideId,\r\n        slide_title: currentSlide.slideTitle,\r\n        event_type: 'completion',\r\n        duration_seconds: duration,\r\n        completion_status: 'completed',\r\n        interaction_data: completionQuality || {},\r\n        attention_score: currentSlide.attentionScore,\r\n        cognitive_load_indicator: currentSlide.cognitiveLoad\r\n      })\r\n      .then(({ error }) => {\r\n        if (error) console.error('Error marking slide complete:', error);\r\n      });\r\n\r\n    // Update lesson progress\r\n    supabase\r\n      .from('lesson_progress_detailed')\r\n      .upsert({\r\n        user_id: user.id,\r\n        course_id: courseId,\r\n        lesson_id: lessonId || 'overview',\r\n        slide_id: currentSlide.slideId,\r\n        progress_percentage: 100,\r\n        time_spent_seconds: duration,\r\n        interaction_count: currentSlide.interactions,\r\n        attention_metrics: {\r\n          finalScore: currentSlide.attentionScore,\r\n          averageScore: currentSlide.attentionScore, // Simplified for now\r\n          peakScore: 100,\r\n          lowScore: Math.max(0, currentSlide.attentionScore - 20)\r\n        },\r\n        learning_velocity: currentSlide.interactions / Math.max(duration / 60, 1), // interactions per minute\r\n        difficulty_perception: currentSlide.cognitiveLoad,\r\n        completion_quality: completionQuality || {}\r\n      }, {\r\n        onConflict: 'user_id,course_id,lesson_id,slide_id'\r\n      })\r\n      .then(({ error }) => {\r\n        if (error) console.error('Error updating detailed progress:', error);\r\n      });\r\n\r\n    console.log(`âœ… Slide completed: ${currentSlide.slideId} in ${duration}s`);\r\n  }, [currentSlide, user?.id, courseId, lessonId]);\r\n\r\n  // End current slide view\r\n  const endSlideView = useCallback(() => {\r\n    if (!currentSlide || !user?.id) return;\r\n\r\n    const duration = Math.floor((Date.now() - currentSlide.startTime) / 1000);\r\n\r\n    // Store slide view end\r\n    supabase\r\n      .from('slide_analytics')\r\n      .insert({\r\n        user_id: user.id,\r\n        course_id: courseId,\r\n        lesson_id: lessonId,\r\n        slide_id: currentSlide.slideId,\r\n        slide_title: currentSlide.slideTitle,\r\n        event_type: 'view_end',\r\n        duration_seconds: duration,\r\n        attention_score: currentSlide.attentionScore,\r\n        cognitive_load_indicator: currentSlide.cognitiveLoad,\r\n        metadata: {\r\n          totalInteractions: currentSlide.interactions,\r\n          viewQuality: calculateViewQuality(currentSlide, duration)\r\n        }\r\n      })\r\n      .then(({ error }) => {\r\n        if (error) console.error('Error ending slide view:', error);\r\n      });\r\n\r\n    // Add to history\r\n    setSlideHistory(prev => [...prev, { ...currentSlide }]);\r\n    \r\n    // Clear current slide\r\n    setCurrentSlide(null);\r\n    \r\n    // Clear timers using cleanupManager\r\n    if (attentionTimerRef.current) cleanup.cleanup(attentionTimerRef.current);\r\n    if (inactivityTimerRef.current) cleanup.cleanup(inactivityTimerRef.current);\r\n\r\n    console.log(`â¹ï¸ Ended slide view: ${currentSlide.slideId} after ${duration}s`);\r\n  }, [currentSlide, user?.id, courseId, lessonId, cleanup]);\r\n\r\n  // Start attention monitoring\r\n  const startAttentionMonitoring = useCallback(() => {\r\n    // Clear existing timers using cleanupManager\r\n    if (attentionTimerRef.current) cleanup.cleanup(attentionTimerRef.current);\r\n    if (inactivityTimerRef.current) cleanup.cleanup(inactivityTimerRef.current);\r\n\r\n    // Monitor attention every 5 seconds using cleanupManager\r\n    attentionTimerRef.current = cleanup.setInterval(() => {\r\n      const timeSinceActivity = Date.now() - lastActivityRef.current;\r\n      \r\n      setCurrentSlide(prev => {\r\n        if (!prev) return null;\r\n\r\n        let attentionDecay = 0;\r\n        let cognitiveLoadIncrease = 0;\r\n\r\n        // Attention decreases with inactivity\r\n        if (timeSinceActivity > 10000) { // 10 seconds of inactivity\r\n          attentionDecay = Math.min(5, timeSinceActivity / 2000); // Max 5 points per check\r\n        }\r\n\r\n        // Cognitive load increases with time spent on slide\r\n        const slideTime = (Date.now() - prev.startTime) / 1000;\r\n        if (slideTime > 60) { // After 1 minute on same slide\r\n          cognitiveLoadIncrease = Math.min(2, slideTime / 30000); // Gradual increase\r\n        }\r\n\r\n        return {\r\n          ...prev,\r\n          attentionScore: Math.max(0, prev.attentionScore - attentionDecay),\r\n          cognitiveLoad: Math.min(100, prev.cognitiveLoad + cognitiveLoadIncrease)\r\n        };\r\n      });\r\n    }, 5000);\r\n\r\n    // Set inactivity timer for extended periods using cleanupManager\r\n    inactivityTimerRef.current = cleanup.setTimeout(() => {\r\n      setCurrentSlide(prev => prev ? {\r\n        ...prev,\r\n        attentionScore: Math.max(0, prev.attentionScore - 20), // Larger penalty for extended inactivity\r\n        cognitiveLoad: Math.min(100, prev.cognitiveLoad + 10)\r\n      } : null);\r\n    }, 30000); // 30 seconds\r\n  }, [cleanup]);\r\n\r\n  // Calculate view quality based on engagement metrics\r\n  const calculateViewQuality = (slide: SlideView, duration: number): Record<string, any> => {\r\n    const engagementRate = slide.interactions / Math.max(duration / 10, 1); // interactions per 10 seconds\r\n    const attentionQuality = slide.attentionScore / 100;\r\n    const cognitiveEffort = 1 - (slide.cognitiveLoad / 100);\r\n    \r\n    return {\r\n      engagementRate,\r\n      attentionQuality,\r\n      cognitiveEffort,\r\n      overallQuality: (engagementRate * 0.4 + attentionQuality * 0.4 + cognitiveEffort * 0.2)\r\n    };\r\n  };\r\n\r\n  // Track user activity for attention monitoring\r\n  useEffect(() => {\r\n    const handleActivity = () => {\r\n      lastActivityRef.current = Date.now();\r\n    };\r\n\r\n    document.addEventListener('click', handleActivity);\r\n    document.addEventListener('keydown', handleActivity);\r\n    document.addEventListener('scroll', handleActivity);\r\n    document.addEventListener('mousemove', handleActivity);\r\n\r\n    return () => {\r\n      document.removeEventListener('click', handleActivity);\r\n      document.removeEventListener('keydown', handleActivity);\r\n      document.removeEventListener('scroll', handleActivity);\r\n      document.removeEventListener('mousemove', handleActivity);\r\n    };\r\n  }, []);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (currentSlide) endSlideView();\r\n    };\r\n  }, [endSlideView, currentSlide]);\r\n\r\n  return {\r\n    currentSlide,\r\n    slideHistory,\r\n    startSlideView,\r\n    trackSlideInteraction,\r\n    markSlideComplete,\r\n    endSlideView,\r\n    isTracking: !!currentSlide\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSpellingCoursePerformance.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1880,1883],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1880,1883],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1924,1927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1924,1927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useCallback } from 'react';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\n/**\r\n * Lightweight performance hook specifically for the spelling course\r\n * to prevent browser freezing issues\r\n */\r\nexport const useSpellingCoursePerformance = (courseId: string, lessonId?: number) => {\r\n  const cleanup = useCleanup('spelling-course-performance');\r\n  const cleanupFunctions = useRef<(() => void)[]>([]);\r\n\r\n  // Safe timer creation with automatic cleanup\r\n  const createTimer = useCallback((callback: () => void, delay: number) => {\r\n    return cleanup.setTimeout(() => {\r\n      try {\r\n        callback();\r\n      } catch (error) {\r\n        console.warn('Timer callback error:', error);\r\n      }\r\n    }, delay);\r\n  }, [cleanup]);\r\n\r\n  // Safe interval creation with automatic cleanup\r\n  const createInterval = useCallback((callback: () => void, delay: number) => {\r\n    // Minimum 2 second intervals to prevent browser strain\r\n    const safeDelay = Math.max(delay, 2000);\r\n    \r\n    return cleanup.setInterval(() => {\r\n      try {\r\n        callback();\r\n      } catch (error) {\r\n        console.warn('Interval callback error:', error);\r\n      }\r\n    }, safeDelay);\r\n  }, [cleanup]);\r\n\r\n  // Register cleanup function\r\n  const registerCleanup = useCallback((cleanupFn: () => void) => {\r\n    cleanupFunctions.current.push(cleanupFn);\r\n  }, []);\r\n\r\n  // Force cleanup all resources\r\n  const forceCleanup = useCallback(() => {\r\n    console.log('ðŸ§¹ Cleaning up spelling course resources');\r\n    \r\n    // Run all registered cleanup functions\r\n    cleanupFunctions.current.forEach(cleanupFn => {\r\n      try {\r\n        cleanupFn();\r\n      } catch (error) {\r\n        console.warn('Error in cleanup function:', error);\r\n      }\r\n    });\r\n    cleanupFunctions.current = [];\r\n\r\n    // Force garbage collection if available\r\n    if ('gc' in window && (window as any).gc) {\r\n      try {\r\n        (window as any).gc();\r\n      } catch (error) {\r\n        console.warn('GC not available:', error);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Cleanup on unmount or lesson change\r\n  useEffect(() => {\r\n    return () => {\r\n      forceCleanup();\r\n    };\r\n  }, [lessonId, forceCleanup]);\r\n\r\n  // Emergency cleanup on page visibility change\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      if (document.hidden) {\r\n        console.log('ðŸ§¹ Page hidden, cleaning up spelling course resources');\r\n        forceCleanup();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n    return () => {\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n      forceCleanup();\r\n    };\r\n  }, [forceCleanup]);\r\n\r\n  return {\r\n    createTimer,\r\n    createInterval,\r\n    registerCleanup,\r\n    forceCleanup,\r\n    isSpellingCourse: courseId === 'empowering-learning-spelling'\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStreakCalculation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStreamingEPUBCore.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[825,828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[825,828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[871,874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[871,874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'handleRetryableError', 'resetRetryCount', and 'retryCountRef'. Either include them or remove the dependency array.","line":94,"column":6,"nodeType":"ArrayExpression","endLine":94,"endColumn":62,"suggestions":[{"desc":"Update the dependencies array to be: [book.title, book.id, getOptimalEPUBUrl, convertProgress, convertError, handleRetryableError, resetRetryCount, retryCountRef]","fix":{"range":[3540,3596],"text":"[book.title, book.id, getOptimalEPUBUrl, convertProgress, convertError, handleRetryableError, resetRetryCount, retryCountRef]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { PublicDomainBook } from '@/types/publicDomainBooks';\r\nimport { \r\n  EnhancedEPUBStreamingLoader, \r\n  EPUBMetadata \r\n} from '@/services/EnhancedEPUBStreamingLoader';\r\nimport { StreamingEPUBProgress, StreamingEPUBError, useStreamingProgressConverter } from './useStreamingProgressConverter';\r\nimport { useStreamingRetryLogic } from './useStreamingRetryLogic';\r\nimport { useEPUBUrlOptimizer } from './useEPUBUrlOptimizer';\r\n\r\nexport const useStreamingEPUBCore = (book: PublicDomainBook) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [progress, setProgress] = useState<StreamingEPUBProgress | null>(null);\r\n  const [error, setError] = useState<StreamingEPUBError | null>(null);\r\n  const [epubInstance, setEpubInstance] = useState<any>(null);\r\n  const [toc, setToc] = useState<any[]>([]);\r\n  const [metadata, setMetadata] = useState<EPUBMetadata | null>(null);\r\n  \r\n  const loaderRef = useRef<EnhancedEPUBStreamingLoader | null>(null);\r\n  const { convertProgress, convertError } = useStreamingProgressConverter();\r\n  const { getOptimalEPUBUrl } = useEPUBUrlOptimizer(book);\r\n\r\n  const loadEPUBInternal = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      setProgress(null);\r\n      setEpubInstance(null);\r\n      setToc([]);\r\n      setMetadata(null);\r\n      \r\n      console.log('ðŸš€ Starting enhanced streaming EPUB load for:', book.title);\r\n      \r\n      // Create enhanced streaming loader\r\n      loaderRef.current = new EnhancedEPUBStreamingLoader(\r\n        (progress) => {\r\n          console.log('ðŸ“Š EPUB Loading Progress:', progress);\r\n          setProgress(convertProgress(progress));\r\n        },\r\n        (error) => {\r\n          console.error('âŒ EPUB Loading Error:', error);\r\n          const convertedError = convertError(error);\r\n          handleRetryableError(convertedError);\r\n        }\r\n      );\r\n\r\n      const epubUrl = getOptimalEPUBUrl();\r\n      const cacheKey = book.id;\r\n      \r\n      console.log('ðŸ“š Loading EPUB from URL:', epubUrl);\r\n      console.log('ðŸ”‘ Using cache key:', cacheKey);\r\n      \r\n      const result = await loaderRef.current.loadEPUB(epubUrl, cacheKey);\r\n      \r\n      if (result.success) {\r\n        console.log('âœ… EPUB loading successful:', result);\r\n        setEpubInstance(result.epubInstance);\r\n        \r\n        if (result.metadata) {\r\n          setMetadata(result.metadata);\r\n          setToc(result.metadata.toc || []);\r\n          console.log('ðŸ“– Metadata loaded:', {\r\n            title: result.metadata.title,\r\n            chaptersCount: result.metadata.spine.length,\r\n            tocItemsCount: result.metadata.toc.length\r\n          });\r\n        }\r\n        \r\n        setIsLoading(false);\r\n        setProgress(null);\r\n        resetRetryCount();\r\n        \r\n        console.log('âœ… Enhanced streaming EPUB loading completed successfully');\r\n      } else {\r\n        console.error('âŒ EPUB loading failed:', result.error);\r\n        if (result.error) {\r\n          handleRetryableError(convertError(result.error));\r\n        }\r\n      }\r\n      \r\n    } catch (err) {\r\n      console.error('âŒ Enhanced streaming EPUB loading error:', err);\r\n      \r\n      const streamingError: StreamingEPUBError = {\r\n        type: 'unknown',\r\n        message: err instanceof Error ? err.message : 'Unknown streaming error',\r\n        recoverable: retryCountRef.current < 2,\r\n        retryCount: retryCountRef.current\r\n      };\r\n      \r\n      handleRetryableError(streamingError);\r\n    }\r\n  }, [book, convertProgress, convertError, getOptimalEPUBUrl]);\r\n\r\n  const {\r\n    retryCountRef,\r\n    handleRetryableError,\r\n    resetRetryCount,\r\n    retryLoad\r\n  } = useStreamingRetryLogic(2, (error) => {\r\n    console.error('âŒ Final EPUB loading error:', error);\r\n    setError(error);\r\n    setIsLoading(false);\r\n    setProgress(null);\r\n  }, loadEPUBInternal);\r\n\r\n  const abortLoad = useCallback(() => {\r\n    console.log('ðŸ›‘ Aborting EPUB load');\r\n    if (loaderRef.current) {\r\n      loaderRef.current.abort();\r\n      loaderRef.current = null;\r\n    }\r\n    setIsLoading(false);\r\n    setProgress(null);\r\n    setError(null);\r\n  }, []);\r\n\r\n  const getChapterContent = useCallback(async (chapterHref: string) => {\r\n    if (!loaderRef.current) {\r\n      throw new Error('Enhanced streaming loader not available');\r\n    }\r\n    \r\n    try {\r\n      console.log('ðŸ“„ Getting chapter content:', chapterHref);\r\n      return await loaderRef.current.getChapterContent(chapterHref);\r\n    } catch (error) {\r\n      console.error('Failed to get enhanced chapter content:', error);\r\n      throw error;\r\n    }\r\n  }, []);\r\n\r\n  const updateReadingPosition = useCallback((chapterIndex: number, readingSpeed?: number) => {\r\n    if (loaderRef.current) {\r\n      console.log('ðŸ“ Updating reading position:', chapterIndex, readingSpeed);\r\n      loaderRef.current.updateReadingPosition(chapterIndex, readingSpeed);\r\n    }\r\n  }, []);\r\n\r\n  const getStreamingStats = useCallback(() => {\r\n    return loaderRef.current?.getStreamingStats() || null;\r\n  }, []);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      abortLoad();\r\n    };\r\n  }, [abortLoad]);\r\n\r\n  return {\r\n    isLoading,\r\n    progress,\r\n    error,\r\n    epubInstance,\r\n    toc,\r\n    metadata,\r\n    loadEPUB: loadEPUBInternal,\r\n    retryLoad,\r\n    abortLoad,\r\n    getChapterContent,\r\n    updateReadingPosition,\r\n    getStreamingStats\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStreamingEPUBLoader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStreamingProgressConverter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStreamingRetryLogic.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStudentProfile.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadProfile'. Either include it or remove the dependency array.","line":364,"column":6,"nodeType":"ArrayExpression","endLine":364,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [loadProfile, user]","fix":{"range":[10849,10855],"text":"[loadProfile, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\n// Advanced Student Modeling Hook - Phase 3 Implementation\r\ninterface KnowledgeState {\r\n  currentUnderstanding: number;\r\n  confidence: number;\r\n  misconceptions: string[];\r\n  gapsIdentified: string[];\r\n  masteredConcepts: string[];\r\n}\r\n\r\ninterface CognitiveLoad {\r\n  currentLoad: number;\r\n  fatigueIndicators: string[];\r\n  optimalChallenge: number;\r\n  attentionSpan: number;\r\n}\r\n\r\ninterface LearningStyle {\r\n  preferredModality: 'visual' | 'auditory' | 'kinesthetic' | 'mixed';\r\n  questioningPreference: 'direct' | 'analogical' | 'systematic' | 'exploratory';\r\n  scaffoldingNeeds: 'high' | 'medium' | 'low';\r\n  pacePreference: 'slow' | 'moderate' | 'fast';\r\n}\r\n\r\ninterface AdaptiveMetrics {\r\n  responseTime: number[];\r\n  questionTypes: string[];\r\n  successfulStrategies: string[];\r\n  strugglingAreas: string[];\r\n}\r\n\r\ninterface StudentProfile {\r\n  id?: string;\r\n  user_id: string;\r\n  knowledge_state: KnowledgeState;\r\n  cognitive_load: CognitiveLoad;\r\n  learning_style: LearningStyle;\r\n  adaptive_metrics: AdaptiveMetrics;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport const useStudentProfile = () => {\r\n  const [profile, setProfile] = useState<StudentProfile | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isUpdating, setIsUpdating] = useState(false);\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n\r\n  // Load student profile\r\n  const loadProfile = async () => {\r\n    if (!user?.id) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('student_profiles')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .single();\r\n\r\n      if (error && error.code !== 'PGRST116') { // PGRST116 = no rows returned\r\n        throw error;\r\n      }\r\n\r\n      if (data) {\r\n        setProfile(data as unknown as StudentProfile);\r\n      } else {\r\n        // Initialize new profile\r\n        await initializeProfile();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading student profile:', error);\r\n      toast({\r\n        title: \"Profile loading error\",\r\n        description: \"There was a problem loading your learning profile.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Initialize new student profile\r\n  const initializeProfile = async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('student_profiles')\r\n        .insert({\r\n          user_id: user.id,\r\n          knowledge_state: {\r\n            currentUnderstanding: 0.5,\r\n            confidence: 0.5,\r\n            misconceptions: [],\r\n            gapsIdentified: [],\r\n            masteredConcepts: []\r\n          },\r\n          cognitive_load: {\r\n            currentLoad: 0.4,\r\n            fatigueIndicators: [],\r\n            optimalChallenge: 0.6,\r\n            attentionSpan: 15\r\n          },\r\n          learning_style: {\r\n            preferredModality: 'mixed',\r\n            questioningPreference: 'exploratory',\r\n            scaffoldingNeeds: 'medium',\r\n            pacePreference: 'moderate'\r\n          },\r\n          adaptive_metrics: {\r\n            responseTime: [],\r\n            questionTypes: [],\r\n            successfulStrategies: [],\r\n            strugglingAreas: []\r\n          }\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProfile(data as unknown as StudentProfile);\r\n      \r\n      toast({\r\n        title: \"Learning Profile Created\",\r\n        description: \"Your personalized learning profile has been initialized!\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Error initializing student profile:', error);\r\n    }\r\n  };\r\n\r\n  // Update understanding level based on interaction\r\n  const updateUnderstanding = async (topic: string, comprehensionLevel: number, confidence: number) => {\r\n    if (!profile || !user?.id) return;\r\n\r\n    setIsUpdating(true);\r\n    try {\r\n      const updatedKnowledge = {\r\n        ...profile.knowledge_state,\r\n        currentUnderstanding: Math.max(0, Math.min(1, comprehensionLevel)),\r\n        confidence: Math.max(0, Math.min(1, confidence))\r\n      };\r\n\r\n      // Add to mastered concepts if understanding is high\r\n      if (comprehensionLevel > 0.8 && !updatedKnowledge.masteredConcepts.includes(topic)) {\r\n        updatedKnowledge.masteredConcepts.push(topic);\r\n      }\r\n\r\n      // Add to gaps if understanding is low\r\n      if (comprehensionLevel < 0.4 && !updatedKnowledge.gapsIdentified.includes(topic)) {\r\n        updatedKnowledge.gapsIdentified.push(topic);\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('student_profiles')\r\n        .update({\r\n          knowledge_state: updatedKnowledge,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProfile(data as unknown as StudentProfile);\r\n    } catch (error) {\r\n      console.error('Error updating understanding:', error);\r\n    } finally {\r\n      setIsUpdating(false);\r\n    }\r\n  };\r\n\r\n  // Update cognitive load based on response patterns\r\n  const updateCognitiveLoad = async (responseTime: number, difficultyLevel: number) => {\r\n    if (!profile || !user?.id) return;\r\n\r\n    try {\r\n      const updatedLoad = {\r\n        ...profile.cognitive_load,\r\n        currentLoad: Math.max(0, Math.min(1, difficultyLevel * 0.2)), // Simple heuristic\r\n      };\r\n\r\n      // Add response time to metrics\r\n      const updatedMetrics = {\r\n        ...profile.adaptive_metrics,\r\n        responseTime: [...profile.adaptive_metrics.responseTime.slice(-9), responseTime] // Keep last 10\r\n      };\r\n\r\n      const { data, error } = await supabase\r\n        .from('student_profiles')\r\n        .update({\r\n          cognitive_load: updatedLoad,\r\n          adaptive_metrics: updatedMetrics,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProfile(data as unknown as StudentProfile);\r\n    } catch (error) {\r\n      console.error('Error updating cognitive load:', error);\r\n    }\r\n  };\r\n\r\n  // Track successful teaching strategy\r\n  const trackSuccessfulStrategy = async (strategy: string, questionType: string) => {\r\n    if (!profile || !user?.id) return;\r\n\r\n    try {\r\n      const updatedMetrics = {\r\n        ...profile.adaptive_metrics,\r\n        successfulStrategies: [\r\n          ...new Set([...profile.adaptive_metrics.successfulStrategies, strategy])\r\n        ].slice(-10), // Keep unique, last 10\r\n        questionTypes: [\r\n          ...profile.adaptive_metrics.questionTypes.slice(-9), \r\n          questionType\r\n        ] // Keep last 10\r\n      };\r\n\r\n      const { data, error } = await supabase\r\n        .from('student_profiles')\r\n        .update({\r\n          adaptive_metrics: updatedMetrics,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProfile(data as unknown as StudentProfile);\r\n    } catch (error) {\r\n      console.error('Error tracking successful strategy:', error);\r\n    }\r\n  };\r\n\r\n  // Add identified misconception\r\n  const addMisconception = async (misconception: string) => {\r\n    if (!profile || !user?.id) return;\r\n\r\n    try {\r\n      const updatedKnowledge = {\r\n        ...profile.knowledge_state,\r\n        misconceptions: [\r\n          ...new Set([...profile.knowledge_state.misconceptions, misconception])\r\n        ].slice(-5) // Keep unique, last 5\r\n      };\r\n\r\n      const { data, error } = await supabase\r\n        .from('student_profiles')\r\n        .update({\r\n          knowledge_state: updatedKnowledge,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProfile(data as unknown as StudentProfile);\r\n    } catch (error) {\r\n      console.error('Error adding misconception:', error);\r\n    }\r\n  };\r\n\r\n  // Update learning style preferences\r\n  const updateLearningStyle = async (updates: Partial<LearningStyle>) => {\r\n    if (!profile || !user?.id) return;\r\n\r\n    setIsUpdating(true);\r\n    try {\r\n      const updatedStyle = {\r\n        ...profile.learning_style,\r\n        ...updates\r\n      };\r\n\r\n      const { data, error } = await supabase\r\n        .from('student_profiles')\r\n        .update({\r\n          learning_style: updatedStyle,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProfile(data as unknown as StudentProfile);\r\n      \r\n      toast({\r\n        title: \"Learning Style Updated\",\r\n        description: \"Your learning preferences have been updated to better personalize your experience.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Error updating learning style:', error);\r\n      toast({\r\n        title: \"Update Error\",\r\n        description: \"There was a problem updating your learning style.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsUpdating(false);\r\n    }\r\n  };\r\n\r\n  // Get learning recommendations based on profile\r\n  const getLearningRecommendations = () => {\r\n    if (!profile) return [];\r\n\r\n    const recommendations = [];\r\n    const { knowledge_state, cognitive_load, learning_style } = profile;\r\n\r\n    // Knowledge-based recommendations\r\n    if (knowledge_state.currentUnderstanding < 0.5) {\r\n      recommendations.push({\r\n        type: 'scaffolding',\r\n        message: 'Let\\'s focus on building foundational understanding with more guided questions.',\r\n        priority: 'high'\r\n      });\r\n    }\r\n\r\n    if (knowledge_state.confidence < 0.4) {\r\n      recommendations.push({\r\n        type: 'confidence',\r\n        message: 'Try starting with easier concepts to build confidence.',\r\n        priority: 'medium'\r\n      });\r\n    }\r\n\r\n    // Cognitive load recommendations\r\n    if (cognitive_load.currentLoad > 0.7) {\r\n      recommendations.push({\r\n        type: 'cognitive_load',\r\n        message: 'Consider taking a break or working on simpler problems.',\r\n        priority: 'high'\r\n      });\r\n    }\r\n\r\n    // Learning style recommendations\r\n    if (learning_style.scaffoldingNeeds === 'high') {\r\n      recommendations.push({\r\n        type: 'scaffolding',\r\n        message: 'I\\'ll provide more step-by-step guidance and examples.',\r\n        priority: 'medium'\r\n      });\r\n    }\r\n\r\n    return recommendations;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadProfile();\r\n    }\r\n  }, [user]);\r\n\r\n  return {\r\n    profile,\r\n    isLoading,\r\n    isUpdating,\r\n    updateUnderstanding,\r\n    updateCognitiveLoad,\r\n    trackSuccessfulStrategy,\r\n    addMisconception,\r\n    updateLearningStyle,\r\n    getLearningRecommendations,\r\n    refreshProfile: loadProfile\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStudyInsights.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useStudySessions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSubscription.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSubscriptionGate.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[241,244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[241,244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useAuth } from './useAuth';\r\nimport { useSubscription } from './useSubscription';\r\nimport { useEffect, useState } from 'react';\r\n\r\ninterface SubscriptionGateState {\r\n  isLoading: boolean;\r\n  hasAccess: boolean;\r\n  subscriptionData: any;\r\n  shouldRedirectToPlanSelection: boolean;\r\n}\r\n\r\nexport const useSubscriptionGate = (): SubscriptionGateState => {\r\n  const { user, loading: authLoading } = useAuth();\r\n  const { subscription, isLoading: subscriptionLoading, refreshSubscription } = useSubscription();\r\n  const [hasCheckedSubscription, setHasCheckedSubscription] = useState(false);\r\n  const [timeoutReached, setTimeoutReached] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (user && !subscriptionLoading && !hasCheckedSubscription) {\r\n      refreshSubscription();\r\n      setHasCheckedSubscription(true);\r\n    }\r\n  }, [user, subscriptionLoading, refreshSubscription, hasCheckedSubscription]);\r\n\r\n  // Add timeout to prevent infinite loading\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      if ((authLoading || subscriptionLoading || !hasCheckedSubscription) && !timeoutReached) {\r\n        console.warn('âš ï¸ Subscription gate timeout reached - stopping loading state');\r\n        setTimeoutReached(true);\r\n      }\r\n    }, 8000); // 8 second timeout\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [authLoading, subscriptionLoading, hasCheckedSubscription, timeoutReached]);\r\n\r\n  const isLoading = (authLoading || subscriptionLoading || !hasCheckedSubscription) && !timeoutReached;\r\n  \r\n  // User has access if they have an active subscription\r\n  const hasAccess = subscription?.subscribed === true;\r\n  \r\n  // Should redirect to plan selection if user is authenticated but has no subscription\r\n  const shouldRedirectToPlanSelection = user && !isLoading && !hasAccess;\r\n\r\n  // Debug logging\r\n  console.log('ðŸ” SubscriptionGate Debug:', {\r\n    user: !!user,\r\n    authLoading,\r\n    subscriptionLoading,\r\n    hasCheckedSubscription,\r\n    isLoading,\r\n    subscription,\r\n    hasAccess,\r\n    shouldRedirectToPlanSelection\r\n  });\r\n\r\n  return {\r\n    isLoading,\r\n    hasAccess,\r\n    subscriptionData: subscription,\r\n    shouldRedirectToPlanSelection\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSubscriptionVideoStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useSystemDiagnostics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1529,1532],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1529,1532],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { systemDiagnostics } from '@/utils/systemDiagnostics';\r\n\r\ninterface SystemHealth {\r\n  overallScore: number;\r\n  issues: Array<{\r\n    category: string;\r\n    issue: string;\r\n    severity: 'low' | 'medium' | 'high' | 'critical';\r\n    status: 'detected' | 'fixed' | 'monitoring';\r\n    details: string;\r\n    recommendation?: string;\r\n  }>;\r\n  memoryUsage: number;\r\n  performanceScore: number;\r\n  networkHealth: number;\r\n  recommendations: string[];\r\n}\r\n\r\nexport const useSystemDiagnostics = () => {\r\n  const [healthData, setHealthData] = useState<SystemHealth | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [lastUpdate, setLastUpdate] = useState<Date | null>(null);\r\n  const [criticalIssues, setCriticalIssues] = useState(0);\r\n\r\n  const runDiagnostics = useCallback(async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const results = await systemDiagnostics.runFullDiagnostics();\r\n      setHealthData(results);\r\n      setLastUpdate(new Date());\r\n      setCriticalIssues(results.issues.filter(i => i.severity === 'critical').length);\r\n    } catch (error) {\r\n      console.error('Failed to run system diagnostics:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Listen for automatic health alerts\r\n  useEffect(() => {\r\n    const handleHealthAlert = (event: CustomEvent) => {\r\n      setHealthData(event.detail);\r\n      setLastUpdate(new Date());\r\n      setCriticalIssues(event.detail.issues.filter((i: any) => i.severity === 'critical').length);\r\n    };\r\n\r\n    window.addEventListener('system-health-alert', handleHealthAlert as EventListener);\r\n    return () => window.removeEventListener('system-health-alert', handleHealthAlert as EventListener);\r\n  }, []);\r\n\r\n  // Initial load\r\n  useEffect(() => {\r\n    runDiagnostics();\r\n  }, [runDiagnostics]);\r\n\r\n  const getHealthStatus = useCallback(() => {\r\n    if (!healthData) return 'unknown';\r\n    if (criticalIssues > 0) return 'critical';\r\n    if (healthData.overallScore < 70) return 'warning';\r\n    if (healthData.overallScore < 90) return 'good';\r\n    return 'excellent';\r\n  }, [healthData, criticalIssues]);\r\n\r\n  const hasIssues = useCallback(() => {\r\n    return healthData?.issues.length ?? 0 > 0;\r\n  }, [healthData]);\r\n\r\n  const getCriticalIssues = useCallback(() => {\r\n    return healthData?.issues.filter(i => i.severity === 'critical') ?? [];\r\n  }, [healthData]);\r\n\r\n  return {\r\n    healthData,\r\n    isLoading,\r\n    lastUpdate,\r\n    criticalIssues,\r\n    runDiagnostics,\r\n    getHealthStatus,\r\n    hasIssues,\r\n    getCriticalIssues\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useTextSelection.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useTextToSpeech.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useThresholdManagement.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[723,726],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[723,726],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[920,923],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[920,923],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2212,2215],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2212,2215],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2757,2760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2757,2760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\nexport interface ThresholdConfig {\r\n  id: string;\r\n  metric_name: string;\r\n  upper_threshold: number;\r\n  lower_threshold: number;\r\n  time_window: string;\r\n  status: 'active' | 'pending' | 'disabled';\r\n  risk_level: 'info' | 'warning' | 'critical';\r\n  user_segment?: string;\r\n  description?: string;\r\n  created_by: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface UserSegment {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  criteria: Record<string, any>;\r\n  user_count: number;\r\n  created_at: string;\r\n}\r\n\r\nexport interface AuditLogEntry {\r\n  id: string;\r\n  action: string;\r\n  threshold_id: string;\r\n  user_id: string;\r\n  changes: Record<string, any>;\r\n  timestamp: string;\r\n  user_email?: string;\r\n}\r\n\r\nexport const useThresholdManagement = () => {\r\n  const { user } = useAuth();\r\n  const queryClient = useQueryClient();\r\n\r\n  // Fetch threshold configurations\r\n  const { data: thresholds = [], isLoading: thresholdsLoading } = useQuery({\r\n    queryKey: ['threshold-configs'],\r\n    queryFn: async (): Promise<ThresholdConfig[]> => {\r\n      const { data, error } = await supabase\r\n        .from('threshold_configs')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return (data || []).map(item => ({\r\n        ...item,\r\n        status: item.status as 'active' | 'pending' | 'disabled',\r\n        risk_level: item.risk_level as 'info' | 'warning' | 'critical'\r\n      }));\r\n    },\r\n  });\r\n\r\n  // Fetch user segments\r\n  const { data: userSegments = [], isLoading: segmentsLoading } = useQuery({\r\n    queryKey: ['user-segments'],\r\n    queryFn: async (): Promise<UserSegment[]> => {\r\n      const { data, error } = await supabase\r\n        .from('user_segments')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return (data || []).map(item => ({\r\n        ...item,\r\n        criteria: item.criteria as Record<string, any>\r\n      }));\r\n    },\r\n  });\r\n\r\n  // Fetch audit log\r\n  const { data: auditLog = [], isLoading: auditLoading } = useQuery({\r\n    queryKey: ['threshold-audit-log'],\r\n    queryFn: async (): Promise<AuditLogEntry[]> => {\r\n      const { data, error } = await supabase\r\n        .from('threshold_audit_log')\r\n        .select('*')\r\n        .order('timestamp', { ascending: false })\r\n        .limit(100);\r\n\r\n      if (error) throw error;\r\n      return (data || []).map(entry => ({\r\n        ...entry,\r\n        changes: entry.changes as Record<string, any>,\r\n        user_email: 'System User' // Since we can't join with profiles, use a default\r\n      }));\r\n    },\r\n  });\r\n\r\n  // Update threshold mutation\r\n  const updateThresholdMutation = useMutation({\r\n    mutationFn: async (threshold: Partial<ThresholdConfig> & { id: string }) => {\r\n      const { data, error } = await supabase\r\n        .from('threshold_configs')\r\n        .update(threshold)\r\n        .eq('id', threshold.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['threshold-configs'] });\r\n      queryClient.invalidateQueries({ queryKey: ['threshold-audit-log'] });\r\n    },\r\n  });\r\n\r\n  // Create segment mutation\r\n  const createSegmentMutation = useMutation({\r\n    mutationFn: async (segment: Omit<UserSegment, 'id' | 'user_count' | 'created_at'>) => {\r\n      const { data, error } = await supabase\r\n        .from('user_segments')\r\n        .insert(segment)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['user-segments'] });\r\n    },\r\n  });\r\n\r\n  // Delete threshold mutation\r\n  const deleteThresholdMutation = useMutation({\r\n    mutationFn: async (thresholdId: string) => {\r\n      const { error } = await supabase\r\n        .from('threshold_configs')\r\n        .delete()\r\n        .eq('id', thresholdId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['threshold-configs'] });\r\n      queryClient.invalidateQueries({ queryKey: ['threshold-audit-log'] });\r\n    },\r\n  });\r\n\r\n  const updateThreshold = (threshold: Partial<ThresholdConfig> & { id: string }) => {\r\n    updateThresholdMutation.mutate(threshold);\r\n  };\r\n\r\n  const createSegment = (segment: Omit<UserSegment, 'id' | 'user_count' | 'created_at'>) => {\r\n    createSegmentMutation.mutate(segment);\r\n  };\r\n\r\n  const deleteThreshold = (thresholdId: string) => {\r\n    deleteThresholdMutation.mutate(thresholdId);\r\n  };\r\n\r\n  return {\r\n    thresholds,\r\n    userSegments,\r\n    auditLog,\r\n    isLoading: thresholdsLoading || segmentsLoading || auditLoading,\r\n    updateThreshold,\r\n    createSegment,\r\n    deleteThreshold,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUnifiedProgressTracking.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1081,1084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1081,1084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'lessonId'. Either include it or remove the dependency array.","line":218,"column":6,"nodeType":"ArrayExpression","endLine":218,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [user?.id, courseId, saveSessionData, cleanup, lessonId]","fix":{"range":[7232,7278],"text":"[user?.id, courseId, saveSessionData, cleanup, lessonId]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { toast } from 'sonner';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface SessionMetrics {\r\n  sessionId: string;\r\n  courseId: string;\r\n  lessonId?: string;\r\n  startTime: number;\r\n  lastActiveTime: number;\r\n  pageViews: number;\r\n  interactions: number;\r\n}\r\n\r\nexport const useUnifiedProgressTracking = (\r\n  courseId: string, \r\n  courseTitle: string, \r\n  lessonId?: string, \r\n  lessonTitle?: string\r\n) => {\r\n  const cleanup = useCleanup('unified-progress-tracking');\r\n  const { user } = useAuth();\r\n  const [sessionMetrics, setSessionMetrics] = useState<SessionMetrics | null>(null);\r\n  const [totalTimeSpent, setTotalTimeSpent] = useState(0);\r\n  const sessionStartRef = useRef<number>(Date.now());\r\n  const lastActivityRef = useRef<number>(Date.now());\r\n\r\n  // Track interaction (any user activity)\r\n  const trackInteraction = useCallback((interactionType: string, data?: Record<string, any>) => {\r\n    if (!sessionMetrics || !user?.id) return;\r\n\r\n    lastActivityRef.current = Date.now();\r\n    setSessionMetrics(prev => prev ? { ...prev, interactions: prev.interactions + 1 } : null);\r\n\r\n    // Log interaction analytics\r\n    supabase\r\n      .from('analytics_metrics')\r\n      .insert({\r\n        user_id: user.id,\r\n        metric_name: `course_interaction.${interactionType}`,\r\n        value: 1,\r\n        metadata: {\r\n          courseId,\r\n          lessonId,\r\n          interactionType,\r\n          sessionId: sessionMetrics.sessionId,\r\n          timestamp: new Date().toISOString(),\r\n          ...data\r\n        }\r\n      })\r\n      .then(({ error }) => {\r\n        if (error) console.error('Error tracking interaction:', error);\r\n      });\r\n  }, [sessionMetrics, user?.id, courseId, lessonId]);\r\n\r\n  // Save session data\r\n  const saveSessionData = useCallback(async (isEndOfSession = false) => {\r\n    if (!sessionMetrics || !user?.id) return;\r\n\r\n    const currentTime = Date.now();\r\n    const sessionDuration = Math.floor((currentTime - sessionStartRef.current) / 1000);\r\n    const activeTime = Math.floor((lastActivityRef.current - sessionStartRef.current) / 1000);\r\n\r\n    try {\r\n      // Save to analytics_metrics\r\n      await supabase\r\n        .from('analytics_metrics')\r\n        .insert({\r\n          user_id: user.id,\r\n          metric_name: isEndOfSession ? 'course_session_end' : 'course_session_progress',\r\n          value: sessionDuration,\r\n          metadata: {\r\n            courseId,\r\n            lessonId,\r\n            courseTitle,\r\n            lessonTitle,\r\n            sessionId: sessionMetrics.sessionId,\r\n            duration_seconds: sessionDuration,\r\n            active_seconds: activeTime,\r\n            page_views: sessionMetrics.pageViews,\r\n            interactions_count: sessionMetrics.interactions,\r\n            session_type: lessonId ? 'lesson' : 'overview',\r\n            timestamp: new Date().toISOString()\r\n          }\r\n        });\r\n\r\n      setTotalTimeSpent(prev => prev + Math.max(activeTime, 0));\r\n      console.log(`ðŸ“Š Session data saved: ${sessionDuration}s total, ${activeTime}s active`);\r\n    } catch (error) {\r\n      console.error('Error saving session data:', error);\r\n    }\r\n  }, [sessionMetrics, user?.id, courseId, lessonId, courseTitle, lessonTitle]);\r\n\r\n  // Track lesson completion\r\n  const trackLessonCompletion = useCallback(async (completedLessonId: string, completedLessonTitle: string) => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const completionTime = new Date().toISOString();\r\n      const sessionTime = Math.floor((Date.now() - sessionStartRef.current) / 1000);\r\n\r\n      // Track in lesson_progress table\r\n      await supabase\r\n        .from('lesson_progress')\r\n        .upsert({\r\n          user_id: user.id,\r\n          course_id: courseId,\r\n          lesson_id: completedLessonId,\r\n          completed: true,\r\n          completed_at: completionTime,\r\n          time_spent_seconds: sessionTime\r\n        }, {\r\n          onConflict: 'user_id,course_id,lesson_id'\r\n        });\r\n\r\n      // Track analytics\r\n      await supabase\r\n        .from('analytics_metrics')\r\n        .insert({\r\n          user_id: user.id,\r\n          metric_name: 'lesson_completion',\r\n          value: 1,\r\n          metadata: {\r\n            courseId,\r\n            lessonId: completedLessonId,\r\n            lessonTitle: completedLessonTitle,\r\n            completionTime,\r\n            sessionTime,\r\n            timestamp: new Date().toISOString()\r\n          }\r\n        });\r\n\r\n      trackInteraction('lesson_completed', {\r\n        lessonId: completedLessonId,\r\n        lessonTitle: completedLessonTitle\r\n      });\r\n\r\n      console.log('âœ… Lesson completion tracked:', completedLessonId);\r\n    } catch (error) {\r\n      console.error('Error tracking lesson completion:', error);\r\n    }\r\n  }, [user?.id, courseId, trackInteraction]);\r\n\r\n  // Track course completion\r\n  const trackCourseCompletion = useCallback(async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      await supabase\r\n        .from('analytics_metrics')\r\n        .insert({\r\n          user_id: user.id,\r\n          metric_name: 'course_completion',\r\n          value: 1,\r\n          metadata: {\r\n            courseId,\r\n            courseTitle,\r\n            completionTime: new Date().toISOString(),\r\n            totalTimeSpent: totalTimeSpent,\r\n            timestamp: new Date().toISOString()\r\n          }\r\n        });\r\n\r\n      trackInteraction('course_completed', { courseTitle });\r\n      console.log('ðŸŽ“ Course completion tracked:', courseId);\r\n    } catch (error) {\r\n      console.error('Error tracking course completion:', error);\r\n    }\r\n  }, [user?.id, courseId, courseTitle, totalTimeSpent, trackInteraction]);\r\n\r\n  // Initialize session - use ref to prevent infinite re-renders\r\n  const sessionIdRef = useRef<string | null>(null);\r\n  \r\n  useEffect(() => {\r\n    if (user?.id && courseId && !sessionIdRef.current) {\r\n      const sessionId = `${courseId}-${lessonId || 'overview'}-${Date.now()}`;\r\n      sessionIdRef.current = sessionId;\r\n      \r\n      const session: SessionMetrics = {\r\n        sessionId,\r\n        courseId,\r\n        lessonId,\r\n        startTime: Date.now(),\r\n        lastActiveTime: Date.now(),\r\n        pageViews: 1,\r\n        interactions: 0,\r\n      };\r\n\r\n      setSessionMetrics(session);\r\n      sessionStartRef.current = Date.now();\r\n      lastActivityRef.current = Date.now();\r\n\r\n      console.log('ðŸŽ¯ Started tracking session:', sessionId);\r\n\r\n      // Set up periodic progress saving using cleanupManager\r\n      cleanup.setInterval(() => {\r\n        saveSessionData(false);\r\n      }, 30000); // Save every 30 seconds\r\n\r\n      // Track user activity\r\n      const handleUserActivity = () => {\r\n        lastActivityRef.current = Date.now();\r\n      };\r\n\r\n      document.addEventListener('click', handleUserActivity);\r\n      document.addEventListener('keydown', handleUserActivity);\r\n      document.addEventListener('scroll', handleUserActivity);\r\n\r\n      // Cleanup will be handled by cleanupManager\r\n    }\r\n    \r\n    // Reset session ref when course changes  \r\n    return () => {\r\n      sessionIdRef.current = null;\r\n    };\r\n  }, [user?.id, courseId, saveSessionData, cleanup]);\r\n\r\n  return {\r\n    trackInteraction,\r\n    trackLessonCompletion,\r\n    trackCourseCompletion,\r\n    totalTimeSpent,\r\n    sessionActive: !!sessionMetrics,\r\n    sessionId: sessionMetrics?.sessionId\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUsageTracking.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1135,1138],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1135,1138],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":168,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5657,5660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5657,5660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializeQuotasMutation'. Either include it or remove the dependency array.","line":238,"column":6,"nodeType":"ArrayExpression","endLine":238,"endColumn":37,"suggestions":[{"desc":"Update the dependencies array to be: [user, quotas, isLoadingQuotas, initializeQuotasMutation]","fix":{"range":[8319,8350],"text":"[user, quotas, isLoadingQuotas, initializeQuotasMutation]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nexport interface UsageQuota {\r\n  id: string;\r\n  user_id: string;\r\n  subscription_tier: string;\r\n  period_start: string;\r\n  period_end: string;\r\n  \r\n  // AI Chat & Voice\r\n  ai_chat_messages_limit: number;\r\n  ai_chat_messages_used: number;\r\n  voice_minutes_limit: number;\r\n  voice_minutes_used: number;\r\n  \r\n  // Knowledge & RAG\r\n  rag_queries_limit: number;\r\n  rag_queries_used: number;\r\n  document_processing_limit: number;\r\n  document_processing_used: number;\r\n  \r\n  // Advanced AI\r\n  flashcard_generation_limit: number;\r\n  flashcard_generation_used: number;\r\n  ai_insights_limit: number;\r\n  ai_insights_used: number;\r\n  \r\n  // Storage\r\n  knowledge_base_storage_mb_limit: number;\r\n  knowledge_base_storage_mb_used: number;\r\n}\r\n\r\nexport interface UsageLog {\r\n  id: string;\r\n  user_id: string;\r\n  feature_type: string;\r\n  usage_amount: number;\r\n  metadata: any;\r\n  timestamp: string;\r\n}\r\n\r\nexport type AIFeatureType = \r\n  | 'ai_chat' \r\n  | 'voice_processing' \r\n  | 'rag_query' \r\n  | 'document_processing' \r\n  | 'flashcard_generation' \r\n  | 'ai_insights';\r\n\r\nexport function useUsageTracking() {\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  // Fetch current usage quotas with real usage data\r\n  const { data: quotas, isLoading: isLoadingQuotas } = useQuery({\r\n    queryKey: ['usage-quotas', user?.id],\r\n    queryFn: async (): Promise<UsageQuota | null> => {\r\n      if (!user) return null;\r\n\r\n      // Get quota data\r\n      const { data: quotaData, error: quotaError } = await supabase\r\n        .from('usage_quotas')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .gte('period_end', new Date().toISOString())\r\n        .maybeSingle();\r\n\r\n      if (quotaError) {\r\n        console.error('Error fetching usage quotas:', quotaError);\r\n        throw quotaError;\r\n      }\r\n\r\n      if (!quotaData) return null;\r\n\r\n      // Get real usage counts from actual data tables\r\n      const [\r\n        { count: flashcardCount },\r\n        { count: fileCount },\r\n        { count: chatCount },\r\n        { data: storageData },\r\n        { count: ragQueryCount },\r\n        { count: aiInsightsCount },\r\n        { count: voiceSessionCount }\r\n      ] = await Promise.all([\r\n        supabase.from('flashcards').select('*', { count: 'exact', head: true }).eq('user_id', user.id),\r\n        supabase.from('file_uploads').select('*', { count: 'exact', head: true }).eq('user_id', user.id),\r\n        supabase.from('chat_sessions').select('*', { count: 'exact', head: true }).eq('user_id', user.id),\r\n        supabase.from('file_uploads').select('file_size').eq('user_id', user.id),\r\n        supabase.from('knowledge_base_usage').select('*', { count: 'exact', head: true }).eq('user_id', user.id),\r\n        supabase.from('notes').select('*', { count: 'exact', head: true }).eq('user_id', user.id).or('category.eq.ai-insights,tags.cs.[\"AI Insights\"]'),\r\n        supabase.from('usage_logs').select('*', { count: 'exact', head: true }).eq('user_id', user.id).eq('feature_type', 'voice_processing')\r\n      ]);\r\n\r\n      // Calculate storage usage in MB\r\n      const storageUsedMB = storageData?.reduce((total, file) => total + (file.file_size || 0), 0) / (1024 * 1024) || 0;\r\n\r\n      // Update quota data with real usage counts\r\n      const updatedQuota: UsageQuota = {\r\n        ...quotaData,\r\n        flashcard_generation_used: flashcardCount || 0,\r\n        document_processing_used: fileCount || 0,\r\n        ai_chat_messages_used: chatCount || 0,\r\n        rag_queries_used: ragQueryCount || 0,\r\n        ai_insights_used: aiInsightsCount || 0,\r\n        voice_minutes_used: voiceSessionCount || 0, // Voice sessions count as minutes for now\r\n        knowledge_base_storage_mb_used: Math.round(storageUsedMB * 100) / 100, // Round to 2 decimal places\r\n      };\r\n\r\n      return updatedQuota;\r\n    },\r\n    enabled: !!user,\r\n    staleTime: 1000 * 30, // 30 seconds for development\r\n  });\r\n\r\n  // Fetch usage logs\r\n  const { data: usageLogs, isLoading: isLoadingLogs } = useQuery({\r\n    queryKey: ['usage-logs', user?.id],\r\n    queryFn: async (): Promise<UsageLog[]> => {\r\n      if (!user) return [];\r\n\r\n      const { data, error } = await supabase\r\n        .from('usage_logs')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .gte('timestamp', new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString()) // Last 30 days\r\n        .order('timestamp', { ascending: false })\r\n        .limit(100);\r\n\r\n      if (error) {\r\n        console.error('Error fetching usage logs:', error);\r\n        throw error;\r\n      }\r\n\r\n      return (data || []) as UsageLog[];\r\n    },\r\n    enabled: !!user,\r\n  });\r\n\r\n  // Initialize quotas for new users\r\n  const initializeQuotasMutation = useMutation({\r\n    mutationFn: async ({ userId, tier }: { userId: string; tier: string }) => {\r\n      const { error } = await supabase.rpc('initialize_user_quotas', {\r\n        p_user_id: userId,\r\n        p_subscription_tier: tier\r\n      });\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['usage-quotas'] });\r\n    },\r\n  });\r\n\r\n  // Track usage mutation\r\n  const trackUsageMutation = useMutation({\r\n    mutationFn: async ({ \r\n      featureType, \r\n      amount = 1, \r\n      metadata = {} \r\n    }: { \r\n      featureType: AIFeatureType; \r\n      amount?: number; \r\n      metadata?: Record<string, any>; \r\n    }) => {\r\n      if (!user) throw new Error('User not authenticated');\r\n\r\n      const { data, error } = await supabase.rpc('track_usage', {\r\n        p_user_id: user.id,\r\n        p_feature_type: featureType,\r\n        p_usage_amount: amount,\r\n        p_metadata: metadata\r\n      });\r\n\r\n      if (error) throw error;\r\n      return data; // Returns boolean indicating if usage is within limits\r\n    },\r\n    onSuccess: (canUse, variables) => {\r\n      // Refresh quotas after tracking usage\r\n      queryClient.invalidateQueries({ queryKey: ['usage-quotas'] });\r\n      queryClient.invalidateQueries({ queryKey: ['usage-logs'] });\r\n\r\n      if (!canUse) {\r\n        toast({\r\n          title: \"Usage Limit Reached\",\r\n          description: `You've reached your ${variables.featureType.replace('_', ' ')} limit for this billing period. Please upgrade your plan to continue.`,\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error tracking usage:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to track usage. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    },\r\n  });\r\n\r\n  // Check if user can use a feature - Always return true for unlimited access\r\n  const canUseFeature = (featureType: AIFeatureType, amount: number = 1): boolean => {\r\n    // Always return true for unlimited access for all users\r\n    return true;\r\n  };\r\n\r\n  // Get usage percentage for a feature\r\n  const getUsagePercentage = (featureType: AIFeatureType): number => {\r\n    if (!quotas) return 0;\r\n\r\n    const fieldMap = {\r\n      ai_chat: { used: quotas.ai_chat_messages_used, limit: quotas.ai_chat_messages_limit },\r\n      voice_processing: { used: quotas.voice_minutes_used, limit: quotas.voice_minutes_limit },\r\n      rag_query: { used: quotas.rag_queries_used, limit: quotas.rag_queries_limit },\r\n      document_processing: { used: quotas.document_processing_used, limit: quotas.document_processing_limit },\r\n      flashcard_generation: { used: quotas.flashcard_generation_used, limit: quotas.flashcard_generation_limit },\r\n      ai_insights: { used: quotas.ai_insights_used, limit: quotas.ai_insights_limit },\r\n    };\r\n\r\n    const field = fieldMap[featureType];\r\n    if (!field || field.limit === -1) return 0;\r\n\r\n    return Math.min((field.used / field.limit) * 100, 100);\r\n  };\r\n\r\n  // Initialize quotas if they don't exist\r\n  useEffect(() => {\r\n    if (user && !quotas && !isLoadingQuotas) {\r\n      initializeQuotasMutation.mutate({ \r\n        userId: user.id, \r\n        tier: 'basic' // Default tier, should be updated when subscription changes\r\n      });\r\n    }\r\n  }, [user, quotas, isLoadingQuotas]);\r\n\r\n  return {\r\n    quotas,\r\n    usageLogs,\r\n    isLoading: isLoadingQuotas || isLoadingLogs,\r\n    trackUsage: trackUsageMutation.mutate,\r\n    isTrackingUsage: trackUsageMutation.isPending,\r\n    canUseFeature,\r\n    getUsagePercentage,\r\n    initializeQuotas: initializeQuotasMutation.mutate,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUser.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserChatAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserGoalsAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserLocation.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'requestLocation'. Either include it or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [requestLocation]","fix":{"range":[2846,2848],"text":"[requestLocation]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from 'react';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport { logger } from '@/utils/logger';\r\n\r\nexport interface LocationData {\r\n  latitude: number;\r\n  longitude: number;\r\n  city?: string;\r\n}\r\n\r\nexport const useUserLocation = () => {\r\n  const [location, setLocation] = useState<LocationData | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [permissionRequested, setPermissionRequested] = useState(false);\r\n\r\n  // Fallback locations for major cities\r\n  const fallbackLocations: Record<string, LocationData> = {\r\n    'new_york': { latitude: 40.7128, longitude: -74.0060, city: 'New York' },\r\n    'london': { latitude: 51.5074, longitude: -0.1278, city: 'London' },\r\n    'tokyo': { latitude: 35.6762, longitude: 139.6503, city: 'Tokyo' },\r\n    'paris': { latitude: 48.8566, longitude: 2.3522, city: 'Paris' },\r\n    'sydney': { latitude: -33.8688, longitude: 151.2093, city: 'Sydney' },\r\n  };\r\n\r\n  const requestLocation = async () => {\r\n    if (!navigator.geolocation) {\r\n      setError('Geolocation is not supported by this browser');\r\n      setLocation(fallbackLocations.new_york);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    setPermissionRequested(true);\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const position = await new Promise<GeolocationPosition>((resolve, reject) => {\r\n        navigator.geolocation.getCurrentPosition(\r\n          resolve,\r\n          reject,\r\n          {\r\n            enableHighAccuracy: false,\r\n            timeout: 10000,\r\n            maximumAge: 300000, // 5 minutes\r\n          }\r\n        );\r\n      });\r\n\r\n      const locationData: LocationData = {\r\n        latitude: position.coords.latitude,\r\n        longitude: position.coords.longitude,\r\n      };\r\n\r\n      setLocation(locationData);\r\n      logger.debug('Successfully obtained user location', 'GEO', locationData);\r\n    } catch (err) {\r\n      logger.warn('Could not get user location', 'GEO', err);\r\n      setError('Could not access your location');\r\n      // Use fallback location\r\n      setLocation(fallbackLocations.new_york);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Check if we have cached location\r\n    try {\r\n      const cachedLocation = safeLocalStorage.getItem<string>('user_location', { fallbackValue: null });\r\n      if (cachedLocation) {\r\n        const parsed = JSON.parse(cachedLocation) as LocationData;\r\n        setLocation(parsed);\r\n        setIsLoading(false);\r\n        logger.debug('Using cached location', 'GEO', parsed);\r\n        return;\r\n      }\r\n    } catch (error) {\r\n      logger.warn('Could not read cached location', 'GEO', error);\r\n    }\r\n\r\n    // Auto-request location on first load\r\n    requestLocation();\r\n  }, []);\r\n\r\n  // Cache location when it changes\r\n  useEffect(() => {\r\n    if (location) {\r\n      try {\r\n        safeLocalStorage.setItem('user_location', JSON.stringify(location));\r\n      } catch (error) {\r\n        logger.warn('Could not cache location', 'GEO', error);\r\n      }\r\n    }\r\n  }, [location]);\r\n\r\n  return {\r\n    location,\r\n    isLoading,\r\n    error,\r\n    permissionRequested,\r\n    requestLocation,\r\n    setLocation: (newLocation: LocationData) => {\r\n      setLocation(newLocation);\r\n      try {\r\n        safeLocalStorage.setItem('user_location', JSON.stringify(newLocation));\r\n      } catch (error) {\r\n        logger.warn('Could not cache location', 'GEO', error);\r\n      }\r\n    }\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserOrganization.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserProfile.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1492,1495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1492,1495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2082,2085],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2082,2085],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":171,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5140,5143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5140,5143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'profileManager'. Either include it or remove the dependency array.","line":241,"column":6,"nodeType":"ArrayExpression","endLine":241,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [profileManager, toast]","fix":{"range":[7063,7070],"text":"[profileManager, toast]"}}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { safeLocalStorage } from '@/utils/safeStorage';\r\nimport type { Database } from '@/integrations/supabase/types';\r\n\r\ntype Profile = Database['public']['Tables']['profiles']['Row'];\r\ntype ProfileUpdate = Database['public']['Tables']['profiles']['Update'];\r\n\r\n// Singleton class to manage profile data globally\r\nclass ProfileManager {\r\n  private static instance: ProfileManager;\r\n  private profile: Profile | null = null;\r\n  private loading: boolean = true;\r\n  private loadingPromise: Promise<Profile | null> | null = null;\r\n  private subscribers: Set<(profile: Profile | null, loading: boolean) => void> = new Set();\r\n\r\n  private constructor() {}\r\n\r\n  static getInstance(): ProfileManager {\r\n    if (!ProfileManager.instance) {\r\n      ProfileManager.instance = new ProfileManager();\r\n    }\r\n    return ProfileManager.instance;\r\n  }\r\n\r\n  subscribe(callback: (profile: Profile | null, loading: boolean) => void) {\r\n    this.subscribers.add(callback);\r\n    // Immediately notify with current state\r\n    callback(this.profile, this.loading);\r\n    \r\n    return () => {\r\n      this.subscribers.delete(callback);\r\n    };\r\n  }\r\n\r\n  private notify() {\r\n    this.subscribers.forEach(callback => {\r\n      callback(this.profile, this.loading);\r\n    });\r\n  }\r\n\r\n  async loadProfile(toast?: any): Promise<Profile | null> {\r\n    // If already loading, return existing promise\r\n    if (this.loadingPromise) {\r\n      return this.loadingPromise;\r\n    }\r\n\r\n    // If already loaded, return cached data\r\n    if (this.profile && !this.loading) {\r\n      return this.profile;\r\n    }\r\n\r\n    this.loading = true;\r\n    this.notify();\r\n\r\n    this.loadingPromise = this.fetchProfile(toast);\r\n    const result = await this.loadingPromise;\r\n    \r\n    this.loading = false;\r\n    this.loadingPromise = null;\r\n    this.notify();\r\n    \r\n    return result;\r\n  }\r\n\r\n  private async fetchProfile(toast?: any): Promise<Profile | null> {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      if (!user) {\r\n        return null;\r\n      }\r\n\r\n      console.log('ðŸ“Š ProfileManager: Loading profile for user:', user.id);\r\n\r\n      const { data, error } = await supabase\r\n        .from('profiles')\r\n        .select('*')\r\n        .eq('id', user.id)\r\n        .maybeSingle();\r\n\r\n      if (error) {\r\n        console.error('Error loading profile:', error);\r\n        if (toast) {\r\n          toast({\r\n            title: \"Error\",\r\n            description: \"Failed to load profile data.\",\r\n            variant: \"destructive\",\r\n          });\r\n        }\r\n        return null;\r\n      }\r\n\r\n      if (!data) {\r\n        console.log('ðŸ“Š ProfileManager: No profile found, creating default profile');\r\n        const defaultProfile: ProfileUpdate = {\r\n          full_name: user.user_metadata?.full_name || '',\r\n          display_name: user.user_metadata?.display_name || user.email?.split('@')[0] || '',\r\n          primary_language: 'English',\r\n          comfort_mode: 'Normal',\r\n          time_format: '12h',\r\n          date_format: 'US',\r\n          font_family: 'System',\r\n          color_contrast: 'Standard',\r\n          dual_language_enabled: false,\r\n          text_size: 3,\r\n          line_spacing: 3,\r\n          push_notifications_enabled: false,\r\n          two_factor_enabled: false,\r\n          speech_to_text_enabled: false,\r\n          email_notifications: {\r\n            new_courses: true,\r\n            weekly_summary: true,\r\n            ai_prompts: false\r\n          },\r\n          app_reminders: {\r\n            study_streak: true,\r\n            module_nudges: true\r\n          },\r\n          calendar_sync: {\r\n            google: false,\r\n            outlook: false\r\n          },\r\n          learning_styles: []\r\n        };\r\n\r\n        const { data: newProfile, error: createError } = await supabase\r\n          .from('profiles')\r\n          .insert({\r\n            id: user.id,\r\n            ...defaultProfile\r\n          })\r\n          .select()\r\n          .single();\r\n\r\n        if (createError) {\r\n          console.error('Error creating profile:', createError);\r\n          if (toast) {\r\n            toast({\r\n              title: \"Error\",\r\n              description: \"Failed to create profile.\",\r\n              variant: \"destructive\",\r\n            });\r\n          }\r\n          return null;\r\n        }\r\n\r\n        console.log('ðŸ“Š ProfileManager: Created new profile:', newProfile);\r\n        this.profile = newProfile;\r\n        return newProfile;\r\n      } else {\r\n        console.log('ðŸ“Š ProfileManager: Loaded existing profile:', data);\r\n        this.profile = data;\r\n        return data;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in ProfileManager.fetchProfile:', error);\r\n      if (toast) {\r\n        toast({\r\n          title: \"Error\",\r\n          description: \"Failed to load profile data.\",\r\n          variant: \"destructive\",\r\n        });\r\n      }\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async updateProfile(updates: ProfileUpdate, toast?: any): Promise<void> {\r\n    if (!this.profile) {\r\n      console.error('âŒ No profile to update');\r\n      return;\r\n    }\r\n\r\n    console.log('ðŸ’¾ ProfileManager: Updating profile with:', updates);\r\n    \r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('profiles')\r\n        .update(updates)\r\n        .eq('id', this.profile.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Error updating profile:', error);\r\n        if (toast) {\r\n          toast({\r\n            title: \"Error\",\r\n            description: \"Failed to save settings.\",\r\n            variant: \"destructive\",\r\n          });\r\n        }\r\n        return;\r\n      }\r\n\r\n      console.log('âœ… ProfileManager: Profile updated successfully:', data);\r\n      this.profile = data;\r\n      this.notify();\r\n      \r\n      if (toast) {\r\n        toast({\r\n          title: \"Settings saved\",\r\n          description: \"Your preferences have been updated successfully.\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in ProfileManager.updateProfile:', error);\r\n      if (toast) {\r\n        toast({\r\n          title: \"Error\",\r\n          description: \"Failed to save settings.\",\r\n          variant: \"destructive\",\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const useUserProfile = () => {\r\n  const [profile, setProfile] = useState<Profile | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const { toast } = useToast();\r\n  const { i18n } = useTranslation();\r\n  const profileManager = ProfileManager.getInstance();\r\n\r\n  useEffect(() => {\r\n    // Subscribe to profile changes\r\n    const unsubscribe = profileManager.subscribe((newProfile, isLoading) => {\r\n      setProfile(newProfile);\r\n      setLoading(isLoading);\r\n    });\r\n\r\n    // Load profile if not already loaded\r\n    profileManager.loadProfile(toast);\r\n\r\n    return unsubscribe;\r\n  }, [toast]);\r\n\r\n  // Sync language when profile loads\r\n  useEffect(() => {\r\n    if (profile && profile.primary_language) {\r\n      const languageMap: { [key: string]: string } = {\r\n        'English': 'en',\r\n        'Spanish': 'es',\r\n        'Chinese': 'zh',\r\n        'Hindi': 'hi',\r\n        'French': 'fr',\r\n        'German': 'de',\r\n      };\r\n      \r\n      const languageCode = languageMap[profile.primary_language] || 'en';\r\n      if (languageCode !== i18n.language) {\r\n        i18n.changeLanguage(languageCode);\r\n        safeLocalStorage.setItem('fpk-language', languageCode);\r\n      }\r\n    }\r\n  }, [profile, i18n]);\r\n\r\n  const updateProfile = async (updates: ProfileUpdate, silent: boolean = false) => {\r\n    setSaving(true);\r\n    await profileManager.updateProfile(updates, silent ? undefined : toast);\r\n    setSaving(false);\r\n  };\r\n\r\n  const changePassword = async (currentPassword: string, newPassword: string) => {\r\n    try {\r\n      const { error } = await supabase.auth.updateUser({\r\n        password: newPassword\r\n      });\r\n\r\n      if (error) {\r\n        toast({\r\n          title: \"Error\",\r\n          description: error.message,\r\n          variant: \"destructive\",\r\n        });\r\n        return false;\r\n      }\r\n\r\n      toast({\r\n        title: \"Password updated\",\r\n        description: \"Your password has been changed successfully.\",\r\n      });\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error changing password:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to change password.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const refetch = () => {\r\n    return profileManager.loadProfile(toast);\r\n  };\r\n\r\n  return {\r\n    profile,\r\n    loading,\r\n    saving,\r\n    updateProfile,\r\n    changePassword,\r\n    refetch,\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserProfileForAdmin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserReadingAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserRole.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUserUploadedBooks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUsers.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1251,1254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1251,1254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2226,2229],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2226,2229],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { User, Role } from '@/types/user';\r\n\r\nexport const useUsers = (searchQuery: string = '', roleFilter: string = 'all') => {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: users = [], isLoading, error } = useQuery({\r\n    queryKey: ['users', searchQuery, roleFilter],\r\n    queryFn: async () => {\r\n      console.log('Fetching users with filters:', { searchQuery, roleFilter });\r\n      \r\n      // Get user profiles with auth user data\r\n      let profileQuery = supabase\r\n        .from('profiles')\r\n        .select(`\r\n          id, \r\n          full_name, \r\n          display_name, \r\n          created_at\r\n        `);\r\n\r\n      if (searchQuery) {\r\n        profileQuery = profileQuery.or(`full_name.ilike.%${searchQuery}%,display_name.ilike.%${searchQuery}%`);\r\n      }\r\n\r\n      const { data: profiles, error: profilesError } = await profileQuery;\r\n      if (profilesError) throw profilesError;\r\n\r\n      // Get auth users data to get real emails - handle potential permission issues gracefully\r\n      let authUsersData: any[] = [];\r\n      try {\r\n        const { data: authUsers, error: authError } = await supabase.auth.admin.listUsers();\r\n        if (authError) {\r\n          console.warn('Auth admin permissions not available, using profile data only:', authError.message);\r\n          authUsersData = [];\r\n        } else {\r\n          authUsersData = authUsers?.users || [];\r\n        }\r\n      } catch (error) {\r\n        console.warn('Auth admin API not available, using profile data only. This is normal for client-side requests.');\r\n        authUsersData = [];\r\n      }\r\n\r\n      // Get user roles\r\n      const { data: roles, error: rolesError } = await supabase\r\n        .from('user_roles')\r\n        .select('user_id, role');\r\n      if (rolesError) throw rolesError;\r\n\r\n      // Combine data\r\n      const usersWithRoles: User[] = profiles?.map(profile => {\r\n        const userRoles = roles?.filter(role => role.user_id === profile.id) || [];\r\n        const authUser = authUsersData.find((user: any) => user.id === profile.id);\r\n        \r\n        return {\r\n          id: profile.id,\r\n          email: authUser?.email || `${profile.full_name?.toLowerCase().replace(/\\s+/g, '.')}@fpkuniversity.com` || `user-${profile.id.slice(0, 8)}@example.com`,\r\n          full_name: profile.full_name || 'Unknown User',\r\n          display_name: profile.display_name || profile.full_name || 'Unknown User',\r\n          created_at: profile.created_at,\r\n          roles: userRoles.map(r => r.role as Role)\r\n        };\r\n      }) || [];\r\n\r\n      // Filter by role if specified\r\n      return usersWithRoles.filter(user => {\r\n        if (roleFilter === 'all') return true;\r\n        return user.roles.includes(roleFilter as Role);\r\n      });\r\n    },\r\n  });\r\n\r\n  const assignRoleMutation = useMutation({\r\n    mutationFn: async ({ userId, role }: { userId: string; role: Role }) => {\r\n      const { error } = await supabase\r\n        .from('user_roles')\r\n        .insert({ user_id: userId, role });\r\n      \r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['users'] });\r\n      toast({\r\n        title: \"Role assigned\",\r\n        description: \"User role has been updated successfully.\",\r\n      });\r\n    },\r\n    onError: () => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to assign role. Please try again.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const removeRoleMutation = useMutation({\r\n    mutationFn: async ({ userId, role }: { userId: string; role: Role }) => {\r\n      const { error } = await supabase\r\n        .from('user_roles')\r\n        .delete()\r\n        .eq('user_id', userId)\r\n        .eq('role', role);\r\n      \r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['users'] });\r\n      toast({\r\n        title: \"Role removed\",\r\n        description: \"User role has been removed successfully.\",\r\n      });\r\n    },\r\n    onError: () => {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to remove role. Please try again.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const assignRole = (userId: string, role: Role) => {\r\n    assignRoleMutation.mutate({ userId, role });\r\n  };\r\n\r\n  const removeRole = (userId: string, role: Role) => {\r\n    removeRoleMutation.mutate({ userId, role });\r\n  };\r\n\r\n  return {\r\n    users,\r\n    isLoading,\r\n    error,\r\n    assignRole,\r\n    removeRole,\r\n    isAssigning: assignRoleMutation.isPending,\r\n    isRemoving: removeRoleMutation.isPending,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useUsersWithMetrics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":172,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6004,6007],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6004,6007],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\ninterface UserWithMetrics {\r\n  id: string;\r\n  name: string;\r\n  email: string;\r\n  roles: string[];\r\n  createdAt: string;\r\n  lastActiveAt: string | null;\r\n  weeklySeconds: number;\r\n  enrollmentCount: number;\r\n  avgProgressPercent: number;\r\n  goalsActive: number;\r\n  goalsCompleted: number;\r\n}\r\n\r\ninterface UseUsersWithMetricsOptions {\r\n  page?: number;\r\n  pageSize?: number;\r\n  search?: string;\r\n  role?: string;\r\n  activity?: string;\r\n  progressBand?: string;\r\n  hasGoals?: string;\r\n  sortBy?: string;\r\n  sortDir?: string;\r\n}\r\n\r\nexport const useUsersWithMetrics = (options: UseUsersWithMetricsOptions = {}) => {\r\n  const {\r\n    page = 1,\r\n    pageSize = 20,\r\n    search = '',\r\n    role = 'all',\r\n    activity = 'all',\r\n    progressBand = 'all',\r\n    hasGoals = 'all',\r\n    sortBy = 'createdAt',\r\n    sortDir = 'desc'\r\n  } = options;\r\n\r\n  return useQuery({\r\n    queryKey: ['users-with-metrics', page, pageSize, search, role, activity, progressBand, hasGoals, sortBy, sortDir],\r\n    queryFn: async () => {\r\n      console.log('Fetching users with metrics, page:', page, 'pageSize:', pageSize, 'role:', role, 'search:', search);\r\n\r\n      // Try to call the edge function first\r\n      try {\r\n        const { data, error } = await supabase.functions.invoke('admin-users-with-metrics', {\r\n          body: {\r\n            page,\r\n            pageSize,\r\n            search,\r\n            role,\r\n            activity,\r\n            progressBand,\r\n            hasGoals,\r\n            sortBy,\r\n            sortDir\r\n          }\r\n        });\r\n\r\n        if (error) {\r\n          console.warn('Edge function failed, falling back to direct query:', error);\r\n          throw error;\r\n        }\r\n\r\n        console.log('Edge function returned:', data);\r\n        return data;\r\n      } catch (error) {\r\n        console.warn('Edge function not available, using fallback query:', error);\r\n        \r\n        // Fallback to direct database queries\r\n        const offset = (page - 1) * pageSize;\r\n        \r\n        // Get profiles with basic filtering\r\n        let profileQuery = supabase\r\n          .from('profiles')\r\n          .select('id, full_name, display_name, created_at');\r\n\r\n        if (search) {\r\n          profileQuery = profileQuery.or(`full_name.ilike.%${search}%,display_name.ilike.%${search}%`);\r\n        }\r\n\r\n        const { data: profiles, error: profilesError } = await profileQuery\r\n          .order('created_at', { ascending: sortDir === 'asc' })\r\n          .range(offset, offset + pageSize - 1);\r\n\r\n        if (profilesError) throw profilesError;\r\n\r\n        // Get additional data for each user\r\n        const usersWithMetrics: UserWithMetrics[] = await Promise.all(\r\n          profiles.map(async (profile) => {\r\n            // Get user roles\r\n            const { data: roles } = await supabase\r\n              .from('user_roles')\r\n              .select('role')\r\n              .eq('user_id', profile.id);\r\n\r\n            // Get enrollment count\r\n            const { count: enrollmentCount } = await supabase\r\n              .from('enrollments')\r\n              .select('*', { count: 'exact', head: true })\r\n              .eq('user_id', profile.id);\r\n\r\n            // Get goal counts\r\n            const { data: goals } = await supabase\r\n              .from('goals')\r\n              .select('status')\r\n              .eq('user_id', profile.id);\r\n\r\n            const goalsActive = goals?.filter(g => g.status === 'active').length || 0;\r\n            const goalsCompleted = goals?.filter(g => g.status === 'completed').length || 0;\r\n\r\n            // Get last activity from various sources\r\n            const activitySources = await Promise.all([\r\n              supabase\r\n                .from('daily_activities')\r\n                .select('created_at')\r\n                .eq('user_id', profile.id)\r\n                .order('created_at', { ascending: false })\r\n                .limit(1)\r\n                .single(),\r\n              supabase\r\n                .from('chat_sessions')\r\n                .select('updated_at')\r\n                .eq('user_id', profile.id)\r\n                .order('updated_at', { ascending: false })\r\n                .limit(1)\r\n                .single(),\r\n              supabase\r\n                .from('reading_sessions')\r\n                .select('session_start')\r\n                .eq('user_id', profile.id)\r\n                .order('session_start', { ascending: false })\r\n                .limit(1)\r\n                .single()\r\n            ]);\r\n\r\n            const lastActivities = activitySources\r\n              .map(result => {\r\n                const data = result.data;\r\n                if (!data) return null;\r\n                if ('created_at' in data) return data.created_at;\r\n                if ('updated_at' in data) return data.updated_at;\r\n                if ('session_start' in data) return data.session_start;\r\n                return null;\r\n              })\r\n              .filter(Boolean)\r\n              .map(date => new Date(date as string))\r\n              .sort((a, b) => b.getTime() - a.getTime());\r\n\r\n            const lastActiveAt = lastActivities.length > 0 ? lastActivities[0].toISOString() : null;\r\n\r\n            // Get weekly time\r\n            const { data: weeklyActivity } = await supabase\r\n              .from('daily_activities')\r\n              .select('duration_minutes')\r\n              .eq('user_id', profile.id)\r\n              .gte('activity_date', new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]);\r\n\r\n            const weeklyMinutes = weeklyActivity?.reduce((sum, activity) => sum + (activity.duration_minutes || 0), 0) || 0;\r\n\r\n            // Get average progress\r\n            const { data: enrollments } = await supabase\r\n              .from('enrollments')\r\n              .select('progress')\r\n              .eq('user_id', profile.id);\r\n\r\n            const progressValues = enrollments?.map(e => {\r\n              const progress = e.progress as any;\r\n              return progress?.completion_percentage || 0;\r\n            }).filter(p => p > 0) || [];\r\n\r\n            const avgProgressPercent = progressValues.length > 0 \r\n              ? Math.round(progressValues.reduce((sum, p) => sum + p, 0) / progressValues.length)\r\n              : 0;\r\n\r\n            // Try to get email from auth\r\n            let email = `${profile.full_name?.toLowerCase().replace(/\\s+/g, '.')}@fpkuniversity.com`;\r\n            try {\r\n              const { data: authUser } = await supabase.auth.admin.getUserById(profile.id);\r\n              if (authUser?.user?.email) {\r\n                email = authUser.user.email;\r\n              }\r\n            } catch (e) {\r\n              // Use fallback email\r\n            }\r\n\r\n            return {\r\n              id: profile.id,\r\n              name: profile.full_name || profile.display_name || 'Unknown User',\r\n              email,\r\n              roles: roles?.map(r => r.role) || [],\r\n              createdAt: profile.created_at,\r\n              lastActiveAt,\r\n              weeklySeconds: weeklyMinutes * 60,\r\n              enrollmentCount: enrollmentCount || 0,\r\n              avgProgressPercent,\r\n              goalsActive,\r\n              goalsCompleted\r\n            };\r\n          })\r\n        );\r\n\r\n        // Apply role filter\r\n        const filteredUsers = role === 'all' \r\n          ? usersWithMetrics \r\n          : usersWithMetrics.filter(user => user.roles.includes(role));\r\n\r\n        // Get total count\r\n        const { count: totalCount } = await supabase\r\n          .from('profiles')\r\n          .select('*', { count: 'exact', head: true });\r\n\r\n        return {\r\n          users: filteredUsers,\r\n          pagination: {\r\n            page,\r\n            pageSize,\r\n            total: totalCount || 0,\r\n            totalPages: Math.ceil((totalCount || 0) / pageSize)\r\n          }\r\n        };\r\n      }\r\n    },\r\n    staleTime: 1000 * 60 * 5, // 5 minutes\r\n    retry: 1\r\n  });\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useViewportAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useVoiceRecording.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'stopRecording'. Either include it or remove the dependency array.","line":79,"column":6,"nodeType":"ArrayExpression","endLine":79,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, stopRecording]","fix":{"range":[2849,2876],"text":"[cleanup, stopRecording]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\nexport const useVoiceRecording = () => {\r\n  const cleanup = useCleanup('voice-recording');\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [recordingDuration, setRecordingDuration] = useState(0);\r\n  const maxRecordingTime = 60; // seconds\r\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\r\n  const chunksRef = useRef<Blob[]>([]);\r\n  const durationIntervalRef = useRef<string>();\r\n\r\n  const startRecording = useCallback(async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ \r\n        audio: {\r\n          sampleRate: 16000, // Lower sample rate for better compatibility\r\n          channelCount: 1,\r\n          echoCancellation: true,\r\n          noiseSuppression: true,\r\n          autoGainControl: true\r\n        } \r\n      });\r\n\r\n      // Check supported MIME types and use the best available\r\n      let mimeType = 'audio/webm;codecs=opus';\r\n      if (!MediaRecorder.isTypeSupported(mimeType)) {\r\n        if (MediaRecorder.isTypeSupported('audio/mp4')) {\r\n          mimeType = 'audio/mp4';\r\n        } else if (MediaRecorder.isTypeSupported('audio/wav')) {\r\n          mimeType = 'audio/wav';\r\n        } else {\r\n          mimeType = ''; // Use default\r\n        }\r\n      }\r\n\r\n      console.log('Using MIME type:', mimeType);\r\n      \r\n      const mediaRecorder = new MediaRecorder(stream, mimeType ? { mimeType } : {});\r\n      \r\n      mediaRecorderRef.current = mediaRecorder;\r\n      chunksRef.current = [];\r\n      setRecordingDuration(0);\r\n\r\n      // Start duration timer using cleanupManager\r\n      durationIntervalRef.current = cleanup.setInterval(() => {\r\n        setRecordingDuration(prev => {\r\n          if (prev >= maxRecordingTime) {\r\n            // Auto-stop when max time reached\r\n            stopRecording();\r\n            return prev;\r\n          }\r\n          return prev + 1;\r\n        });\r\n      }, 1000);\r\n\r\n      mediaRecorder.ondataavailable = (event) => {\r\n        console.log('Data available, size:', event.data.size);\r\n        if (event.data.size > 0) {\r\n          chunksRef.current.push(event.data);\r\n        }\r\n      };\r\n\r\n      mediaRecorder.onerror = (event) => {\r\n        console.error('MediaRecorder error:', event);\r\n      };\r\n\r\n      // Start with larger intervals to ensure we get data\r\n      mediaRecorder.start(1000); // Collect data every 1 second\r\n      setIsRecording(true);\r\n      \r\n      console.log('Recording started with type:', mediaRecorder.mimeType);\r\n    } catch (error) {\r\n      console.error('Error starting recording:', error);\r\n      alert('Unable to access microphone. Please check permissions.');\r\n    }\r\n  }, [maxRecordingTime, cleanup]);\r\n\r\n  const stopRecording = useCallback((): Promise<string> => {\r\n    return new Promise((resolve, reject) => {\r\n      if (!mediaRecorderRef.current || !isRecording) {\r\n        reject(new Error('No active recording'));\r\n        return;\r\n      }\r\n\r\n      // Clear duration timer using cleanupManager\r\n      if (durationIntervalRef.current) {\r\n        cleanup.cleanup(durationIntervalRef.current);\r\n      }\r\n\r\n      mediaRecorderRef.current.onstop = async () => {\r\n        try {\r\n          setIsProcessing(true);\r\n          \r\n          console.log('Recording stopped, chunks collected:', chunksRef.current.length);\r\n          \r\n          // Check if we have any audio data\r\n          if (chunksRef.current.length === 0) {\r\n            throw new Error('No audio data recorded');\r\n          }\r\n          \r\n          // Get the recorded MIME type\r\n          const recordedMimeType = mediaRecorderRef.current?.mimeType || 'audio/webm';\r\n          console.log('Recorded MIME type:', recordedMimeType);\r\n          \r\n          // Create audio blob with proper type\r\n          const audioBlob = new Blob(chunksRef.current, { type: recordedMimeType });\r\n          console.log('Audio blob created, size:', audioBlob.size, 'type:', audioBlob.type);\r\n\r\n          // Validate minimum audio size (should be at least a few KB for meaningful audio)\r\n          if (audioBlob.size < 1000) {\r\n            throw new Error(`Audio recording too short or corrupted (${audioBlob.size} bytes). Please try recording for at least 1-2 seconds.`);\r\n          }\r\n\r\n          // Convert to base64\r\n          const reader = new FileReader();\r\n          reader.onload = async () => {\r\n            try {\r\n              const base64Audio = (reader.result as string).split(',')[1];\r\n              console.log('Base64 audio length:', base64Audio.length);\r\n              \r\n              if (!base64Audio || base64Audio.length < 100) {\r\n                throw new Error('Audio conversion failed - no valid data');\r\n              }\r\n              \r\n              // Send to Supabase Edge Function for transcription\r\n              const { data, error } = await supabase.functions.invoke('voice-to-text', {\r\n                body: { \r\n                  audio: base64Audio,\r\n                  mimeType: recordedMimeType \r\n                }\r\n              });\r\n\r\n              if (error) {\r\n                console.error('Transcription error:', error);\r\n                reject(new Error('Transcription failed: ' + error.message));\r\n                return;\r\n              }\r\n\r\n              console.log('Transcription result:', data);\r\n              setIsProcessing(false);\r\n              setRecordingDuration(0);\r\n              resolve(data.text || '');\r\n            } catch (transcriptionError) {\r\n              console.error('Transcription processing error:', transcriptionError);\r\n              setIsProcessing(false);\r\n              setRecordingDuration(0);\r\n              reject(transcriptionError);\r\n            }\r\n          };\r\n\r\n          reader.onerror = () => {\r\n            setIsProcessing(false);\r\n            setRecordingDuration(0);\r\n            reject(new Error('Failed to process audio file'));\r\n          };\r\n\r\n          reader.readAsDataURL(audioBlob);\r\n        } catch (error) {\r\n          console.error('Stop recording error:', error);\r\n          setIsProcessing(false);\r\n          setRecordingDuration(0);\r\n          reject(error);\r\n        }\r\n      };\r\n\r\n      // Stop recording\r\n      mediaRecorderRef.current.stop();\r\n      \r\n      // Stop all tracks\r\n      mediaRecorderRef.current.stream?.getTracks().forEach(track => track.stop());\r\n      \r\n      setIsRecording(false);\r\n      chunksRef.current = [];\r\n    });\r\n  }, [isRecording, cleanup]);\r\n\r\n  const cancelRecording = useCallback(() => {\r\n    if (mediaRecorderRef.current && isRecording) {\r\n      // Clear duration timer using cleanupManager\r\n      if (durationIntervalRef.current) {\r\n        cleanup.cleanup(durationIntervalRef.current);\r\n      }\r\n\r\n      mediaRecorderRef.current.stop();\r\n      mediaRecorderRef.current.stream?.getTracks().forEach(track => track.stop());\r\n      setIsRecording(false);\r\n      setRecordingDuration(0);\r\n      chunksRef.current = [];\r\n      console.log('Recording cancelled');\r\n    }\r\n  }, [isRecording, cleanup]);\r\n\r\n  const getRemainingTime = useCallback(() => {\r\n    return Math.max(0, maxRecordingTime - recordingDuration);\r\n  }, [maxRecordingTime, recordingDuration]);\r\n\r\n  const getFormattedDuration = useCallback(() => {\r\n    const minutes = Math.floor(recordingDuration / 60);\r\n    const seconds = recordingDuration % 60;\r\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\r\n  }, [recordingDuration]);\r\n\r\n  const getFormattedRemainingTime = useCallback(() => {\r\n    const remaining = getRemainingTime();\r\n    const minutes = Math.floor(remaining / 60);\r\n    const seconds = remaining % 60;\r\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\r\n  }, [getRemainingTime]);\r\n\r\n  return {\r\n    isRecording,\r\n    isProcessing,\r\n    recordingDuration,\r\n    maxRecordingTime,\r\n    startRecording,\r\n    stopRecording,\r\n    cancelRecording,\r\n    getRemainingTime,\r\n    getFormattedDuration,\r\n    getFormattedRemainingTime\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useVoiceRecording.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'cleanup'. Either include it or remove the dependency array.","line":144,"column":6,"nodeType":"ArrayExpression","endLine":144,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [cleanup, isRecording, toast]","fix":{"range":[4603,4623],"text":"[cleanup, isRecording, toast]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nexport const useVoiceRecording = () => {\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [audioLevel, setAudioLevel] = useState(0);\r\n  \r\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\r\n  const streamRef = useRef<MediaStream | null>(null);\r\n  const chunksRef = useRef<Blob[]>([]);\r\n  const { toast } = useToast();\r\n\r\n  const startRecording = useCallback(async () => {\r\n    try {\r\n      // Request microphone access\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        audio: {\r\n          sampleRate: 44100,\r\n          channelCount: 1,\r\n          echoCancellation: true,\r\n          noiseSuppression: true,\r\n          autoGainControl: true\r\n        }\r\n      });\r\n\r\n      streamRef.current = stream;\r\n      chunksRef.current = [];\r\n\r\n      // Create MediaRecorder\r\n      const mediaRecorder = new MediaRecorder(stream, {\r\n        mimeType: 'audio/webm;codecs=opus'\r\n      });\r\n\r\n      mediaRecorderRef.current = mediaRecorder;\r\n\r\n      // Handle data availability\r\n      mediaRecorder.ondataavailable = (event) => {\r\n        if (event.data.size > 0) {\r\n          chunksRef.current.push(event.data);\r\n        }\r\n      };\r\n\r\n      // Start recording\r\n      mediaRecorder.start(100); // Collect data every 100ms\r\n      setIsRecording(true);\r\n\r\n      // Set up audio level monitoring\r\n      const audioContext = new AudioContext();\r\n      const analyser = audioContext.createAnalyser();\r\n      const microphone = audioContext.createMediaStreamSource(stream);\r\n      const dataArray = new Uint8Array(analyser.frequencyBinCount);\r\n\r\n      microphone.connect(analyser);\r\n      analyser.fftSize = 256;\r\n\r\n      const updateLevel = () => {\r\n        if (isRecording) {\r\n          analyser.getByteFrequencyData(dataArray);\r\n          const average = dataArray.reduce((a, b) => a + b) / dataArray.length;\r\n          setAudioLevel(average);\r\n          requestAnimationFrame(updateLevel);\r\n        }\r\n      };\r\n      updateLevel();\r\n\r\n      toast({\r\n        title: \"Recording Started\",\r\n        description: \"Speak clearly into your microphone\",\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('Error starting recording:', error);\r\n      toast({\r\n        title: \"Recording Error\",\r\n        description: \"Could not access microphone. Please check permissions.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  }, [isRecording, toast]);\r\n\r\n  const stopRecording = useCallback(async (): Promise<string | null> => {\r\n    if (!mediaRecorderRef.current || !isRecording) return null;\r\n\r\n    return new Promise((resolve) => {\r\n      const mediaRecorder = mediaRecorderRef.current!;\r\n      \r\n      mediaRecorder.onstop = async () => {\r\n        setIsRecording(false);\r\n        setIsProcessing(true);\r\n        setAudioLevel(0);\r\n\r\n        try {\r\n          // Create blob from recorded chunks\r\n          const audioBlob = new Blob(chunksRef.current, { type: 'audio/webm' });\r\n          \r\n          // Convert to base64\r\n          const arrayBuffer = await audioBlob.arrayBuffer();\r\n          const base64Audio = btoa(\r\n            String.fromCharCode(...new Uint8Array(arrayBuffer))\r\n          );\r\n\r\n          // Send to Supabase function for transcription\r\n          const { data, error } = await supabase.functions.invoke('voice-to-text', {\r\n            body: { audio: base64Audio }\r\n          });\r\n\r\n          if (error) throw error;\r\n\r\n          const transcript = data?.text || '';\r\n          \r\n          if (transcript.trim()) {\r\n            toast({\r\n              title: \"Voice Transcribed\",\r\n              description: `\"${transcript.substring(0, 50)}${transcript.length > 50 ? '...' : ''}\"`,\r\n            });\r\n          } else {\r\n            toast({\r\n              title: \"No Speech Detected\",\r\n              description: \"Try speaking more clearly or closer to the microphone\",\r\n              variant: \"destructive\"\r\n            });\r\n          }\r\n\r\n          resolve(transcript);\r\n\r\n        } catch (error) {\r\n          console.error('Error processing audio:', error);\r\n          toast({\r\n            title: \"Transcription Error\",\r\n            description: \"Could not convert speech to text. Try again.\",\r\n            variant: \"destructive\"\r\n          });\r\n          resolve(null);\r\n        } finally {\r\n          setIsProcessing(false);\r\n          cleanup();\r\n        }\r\n      };\r\n\r\n      mediaRecorder.stop();\r\n    });\r\n  }, [isRecording, toast]);\r\n\r\n  const cleanup = useCallback(() => {\r\n    // Stop all tracks\r\n    if (streamRef.current) {\r\n      streamRef.current.getTracks().forEach(track => track.stop());\r\n      streamRef.current = null;\r\n    }\r\n\r\n    // Reset refs\r\n    mediaRecorderRef.current = null;\r\n    chunksRef.current = [];\r\n    \r\n    // Reset state\r\n    setIsRecording(false);\r\n    setIsProcessing(false);\r\n    setAudioLevel(0);\r\n  }, []);\r\n\r\n  return {\r\n    isRecording,\r\n    isProcessing,\r\n    audioLevel,\r\n    startRecording,\r\n    stopRecording,\r\n    cleanup\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useWeatherData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useWeeklyActivity.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useWidgetChatMessages.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[635,638],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[635,638],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState } from 'react';\r\nimport { useWidgetChatStorage } from './useWidgetChatStorage';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\ninterface WidgetMessage {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: string;\r\n}\r\n\r\nexport const useWidgetChatMessages = (userId?: string) => {\r\n  const [isSending, setIsSending] = useState(false);\r\n  const { messages, addMessage, deleteMessage, clearAllMessages } = useWidgetChatStorage(userId);\r\n  const { toast } = useToast();\r\n\r\n  const sendMessage = async (content: string, context?: any) => {\r\n    if (!content.trim() || isSending) return;\r\n\r\n    setIsSending(true);\r\n\r\n    try {\r\n      // Add user message immediately\r\n      const userMessage = addMessage({\r\n        role: 'user',\r\n        content: content.trim(),\r\n      });\r\n\r\n      // Build lightweight client history (last 6 messages)\r\n      const clientHistory = messages.slice(-6).map(m => ({\r\n        role: m.role,\r\n        content: m.content,\r\n        timestamp: m.timestamp\r\n      }));\r\n\r\n      // Call enhanced AI function for widget context with RAG support\r\n      const { data, error } = await supabase.functions.invoke('ai-study-chat', {\r\n        body: { \r\n          message: content,\r\n          userId: userId,\r\n          sessionId: null, // Widget doesn't use database sessions\r\n          chatMode: 'general', // Widget uses general mode by default\r\n          voiceActive: false,\r\n          isWidget: true, // Flag to identify widget context\r\n          metadata: {\r\n            context: context || 'widget_chat'\r\n          },\r\n          clientHistory\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      // Add AI response\r\n      const aiMessage = addMessage({\r\n        role: 'assistant',\r\n        content: data.response || \"I'm here to help with your learning journey!\",\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('Error sending widget message:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to get a response. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n\r\n  return {\r\n    messages,\r\n    isSending,\r\n    sendMessage,\r\n    deleteMessage,\r\n    clearAllMessages,\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useWidgetChatStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useXPBackfill.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1276,1279],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1276,1279],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { toast } from '@/components/ui/use-toast';\r\n\r\ninterface BackfillResult {\r\n  user_id: string;\r\n  before_xp: number;\r\n  after_xp: number;\r\n  before_level: number;\r\n  after_level: number;\r\n  events_created: number;\r\n  badges_awarded: string[];\r\n  activities_processed: {\r\n    flashcards: number;\r\n    study_sessions: number;\r\n    notes: number;\r\n    goals: number;\r\n    reading_sessions: number;\r\n    file_uploads: number;\r\n  };\r\n}\r\n\r\ninterface DryRunResult {\r\n  dry_run: true;\r\n  user_id: string;\r\n  before_xp: number;\r\n  projected_after_xp: number;\r\n  before_level: number;\r\n  projected_after_level: number;\r\n  events_to_create: number;\r\n  backfill_xp: number;\r\n  activities_found: {\r\n    flashcards: number;\r\n    study_sessions: number;\r\n    notes: number;\r\n    goals: number;\r\n    reading_sessions: number;\r\n    file_uploads: number;\r\n  };\r\n}\r\n\r\ninterface BackfillReport {\r\n  user_id: string;\r\n  current_xp: number;\r\n  current_level: number;\r\n  total_events: number;\r\n  backfill_events: number;\r\n  regular_events: number;\r\n  backfill_xp: number;\r\n  regular_xp: number;\r\n  badges_earned: number;\r\n  recent_events: any[];\r\n}\r\n\r\ntype BackfillResponse = BackfillResult | DryRunResult;\r\n\r\nexport function useXPBackfill() {\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [backfillResult, setBackfillResult] = useState<BackfillResponse | null>(null);\r\n  const [backfillReport, setBackfillReport] = useState<BackfillReport | null>(null);\r\n  const { user } = useAuth();\r\n\r\n  const runBackfill = useCallback(async (dryRun: boolean = false, targetUserId?: string) => {\r\n    if (!user?.id && !targetUserId) return;\r\n\r\n    setIsProcessing(true);\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-backfill', {\r\n        body: {\r\n          action: 'backfill_xp',\r\n          dry_run: dryRun,\r\n          user_id: targetUserId\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      setBackfillResult(data);\r\n\r\n      if (dryRun) {\r\n        toast({\r\n          title: \"Dry Run Complete\",\r\n          description: `Would award ${data.backfill_xp} XP and create ${data.events_to_create} events`,\r\n          duration: 5000,\r\n        });\r\n      } else {\r\n        toast({\r\n          title: \"Backfill Complete!\",\r\n          description: `Awarded ${data.after_xp - data.before_xp} XP and ${data.badges_awarded.length} badges`,\r\n          duration: 5000,\r\n        });\r\n      }\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Backfill failed:', error);\r\n      toast({\r\n        title: \"Backfill Failed\",\r\n        description: \"Failed to process XP backfill. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const runBackfillForAllUsers = useCallback(async (dryRun: boolean = false) => {\r\n    if (!user?.id) return;\r\n\r\n    setIsProcessing(true);\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-backfill', {\r\n        body: {\r\n          action: 'backfill_all_users',\r\n          dry_run: dryRun\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: dryRun ? \"All Users Dry Run Complete\" : \"All Users Backfill Complete!\",\r\n        description: `Processed ${data.users_processed} users, ${dryRun ? 'would award' : 'awarded'} ${data.total_xp_awarded} total XP`,\r\n        duration: 5000,\r\n      });\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('All users backfill failed:', error);\r\n      toast({\r\n        title: \"Backfill Failed\",\r\n        description: \"Failed to process backfill for all users. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const rollbackBackfill = useCallback(async (targetUserId?: string) => {\r\n    if (!user?.id && !targetUserId) return;\r\n\r\n    setIsProcessing(true);\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-backfill', {\r\n        body: {\r\n          action: 'rollback_backfill',\r\n          user_id: targetUserId\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"Rollback Complete\",\r\n        description: `Removed ${data.events_deleted} backfill events`,\r\n        duration: 3000,\r\n      });\r\n\r\n      setBackfillResult(null);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Rollback failed:', error);\r\n      toast({\r\n        title: \"Rollback Failed\",\r\n        description: \"Failed to rollback backfill. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  const getBackfillReport = useCallback(async (targetUserId?: string) => {\r\n    if (!user?.id && !targetUserId) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('xp-backfill', {\r\n        body: {\r\n          action: 'get_backfill_report',\r\n          user_id: targetUserId\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      setBackfillReport(data);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to get backfill report:', error);\r\n      toast({\r\n        title: \"Report Failed\",\r\n        description: \"Failed to generate backfill report. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  }, [user?.id]);\r\n\r\n  return {\r\n    runBackfill,\r\n    runBackfillForAllUsers,\r\n    rollbackBackfill,\r\n    getBackfillReport,\r\n    backfillResult,\r\n    backfillReport,\r\n    isProcessing\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useXPIntegration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useXPProgression.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\hooks\\useXPSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\i18n\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\integrations\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\integrations\\supabase\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\interfaces\\DocumentReader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[913,916],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[913,916],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":92,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2442,2445],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2442,2445],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nexport interface DocumentMetadata {\r\n  title: string;\r\n  author?: string;\r\n  pageCount?: number;\r\n  fileSize?: number;\r\n  format: 'pdf' | 'epub';\r\n  language?: string;\r\n}\r\n\r\nexport interface DocumentLocation {\r\n  page?: number;\r\n  cfi?: string; // For EPUB\r\n  percentage?: number;\r\n}\r\n\r\nexport interface DocumentLoadProgress {\r\n  stage: 'downloading' | 'processing' | 'rendering' | 'ready' | 'error';\r\n  percentage: number;\r\n  message: string;\r\n  bytesLoaded?: number;\r\n  totalBytes?: number;\r\n  estimatedTimeRemaining?: number;\r\n}\r\n\r\nexport interface DocumentLoadError {\r\n  type: 'network' | 'timeout' | 'parsing' | 'rendering' | 'unknown';\r\n  message: string;\r\n  recoverable: boolean;\r\n  retryCount: number;\r\n}\r\n\r\nexport interface DocumentTelemetryEvent {\r\n  type: 'load_start' | 'load_complete' | 'load_error' | 'page_turn' | 'zoom' | 'search' | 'bookmark';\r\n  timestamp: number;\r\n  metadata: Record<string, any>;\r\n  performance?: {\r\n    loadTime?: number;\r\n    renderTime?: number;\r\n    memoryUsage?: number;\r\n  };\r\n}\r\n\r\nexport interface DocumentReaderConfig {\r\n  enableTelemetry: boolean;\r\n  enableOfflineCache: boolean;\r\n  maxCacheSize: number; // MB\r\n  telemetryEndpoint?: string;\r\n  featureFlags: Record<string, boolean>;\r\n  readerVersion: string;\r\n}\r\n\r\nexport interface DocumentReader {\r\n  // Core functionality\r\n  loadDocument(url: string, metadata: DocumentMetadata): Promise<void>;\r\n  unloadDocument(): void;\r\n  \r\n  // Navigation\r\n  goToLocation(location: DocumentLocation): Promise<void>;\r\n  nextPage(): Promise<void>;\r\n  previousPage(): Promise<void>;\r\n  \r\n  // Rendering\r\n  setFontSize(size: number): void;\r\n  setZoom(scale: number): void;\r\n  \r\n  // State\r\n  getCurrentLocation(): DocumentLocation | null;\r\n  getProgress(): number;\r\n  isReady(): boolean;\r\n  \r\n  // Events\r\n  onLoadProgress(callback: (progress: DocumentLoadProgress) => void): void;\r\n  onLoadError(callback: (error: DocumentLoadError) => void): void;\r\n  onLocationChange(callback: (location: DocumentLocation) => void): void;\r\n  onTelemetryEvent(callback: (event: DocumentTelemetryEvent) => void): void;\r\n  \r\n  // Cleanup\r\n  destroy(): void;\r\n}\r\n\r\nexport interface DocumentSource {\r\n  id: string;\r\n  name: string;\r\n  type: 'local' | 'remote' | 'opds' | 'archive';\r\n  baseUrl?: string;\r\n  authRequired: boolean;\r\n}\r\n\r\nexport interface DocumentIngestionService {\r\n  getSources(): DocumentSource[];\r\n  ingestFromSource(sourceId: string, filters?: Record<string, any>): Promise<DocumentMetadata[]>;\r\n  validateDocument(url: string): Promise<{ isValid: boolean; metadata?: DocumentMetadata; error?: string }>;\r\n  cacheDocument(url: string, metadata: DocumentMetadata): Promise<string>; // Returns cache key\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\layouts\\PortalShell.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\auth\\roles.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[118,121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[118,121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[325,328],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[325,328],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[448,451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[448,451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[570,573],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[570,573],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export type AppRole = 'admin' | 'instructor' | 'learner';\r\n\r\nexport function getRoleFromUser(user?: { user_metadata?: any }): AppRole {\r\n  const r = user?.user_metadata?.role;\r\n  if (r === 'admin' || r === 'instructor' || r === 'learner') return r;\r\n  return 'learner';\r\n}\r\n\r\nexport function isAdmin(user?: { user_metadata?: any }): boolean {\r\n  return getRoleFromUser(user) === 'admin';\r\n}\r\n\r\nexport function isInstructor(user?: { user_metadata?: any }): boolean {\r\n  return getRoleFromUser(user) === 'instructor';\r\n}\r\n\r\nexport function hasRole(user: { user_metadata?: any } | undefined, role: AppRole): boolean {\r\n  return getRoleFromUser(user) === role;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\org\\context.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\scorm\\ScormAPIAdapter.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[460,463],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[460,463],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[974,977],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[974,977],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1520,1523],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1520,1523],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1692,1695],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1692,1695],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2208,2211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2208,2211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":83,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2553,2556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2553,2556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2687,2690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2687,2690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2838,2841],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2838,2841],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3049,3052],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3049,3052],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":119,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3563,3566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3563,3566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":134,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4111,4114],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4111,4114],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":140,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4287,4290],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4287,4290],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":155,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4809,4812],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4809,4812],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":170,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5166,5169],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5166,5169],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":172,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5317,5320],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5317,5320],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":178,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5469,5472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5469,5472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createScorm12API } from '@/scorm/runtime/scorm12';\r\nimport { createScorm2004API } from '@/scorm/runtime/scorm2004';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nexport type DebugEventType = 'info' | 'success' | 'error' | 'warning';\r\n\r\nexport interface ScormAPIAdapter {\r\n  initialize: () => void;\r\n  cleanup: () => void;\r\n  getDebugLogs: () => string[];\r\n}\r\n\r\nexport class Scorm12Adapter implements ScormAPIAdapter {\r\n  private api: any;\r\n  private debugLogs: string[] = [];\r\n  private enrollmentId: string;\r\n  private scoId: string;\r\n  private onDebugEvent: (type: DebugEventType, message: string) => void;\r\n\r\n  constructor(\r\n    enrollmentId: string,\r\n    scoId: string,\r\n    onDebugEvent: (type: DebugEventType, message: string) => void\r\n  ) {\r\n    this.enrollmentId = enrollmentId;\r\n    this.scoId = scoId;\r\n    this.onDebugEvent = onDebugEvent;\r\n    this.createAPI();\r\n  }\r\n\r\n  private createAPI() {\r\n    const handleCommit = async (cmiData: any) => {\r\n      try {\r\n        this.onDebugEvent('info', `SCORM 1.2 Commit: ${JSON.stringify(cmiData).substring(0, 100)}...`);\r\n        \r\n        const { error } = await supabase.functions.invoke('scorm-runtime-advanced', {\r\n          body: {\r\n            action: 'commit',\r\n            enrollmentId: this.enrollmentId,\r\n            scoId: this.scoId,\r\n            cmiData\r\n          }\r\n        });\r\n        \r\n        if (error) throw error;\r\n        this.onDebugEvent('success', 'SCORM 1.2 data committed successfully');\r\n      } catch (error: any) {\r\n        this.onDebugEvent('error', `SCORM 1.2 Commit failed: ${error.message}`);\r\n        throw error;\r\n      }\r\n    };\r\n\r\n    const handleFinish = async (cmiData: any) => {\r\n      try {\r\n        this.onDebugEvent('info', 'SCORM 1.2 Finishing session...');\r\n        \r\n        const { error } = await supabase.functions.invoke('scorm-runtime-advanced', {\r\n          body: {\r\n            action: 'terminate',\r\n            enrollmentId: this.enrollmentId,\r\n            scoId: this.scoId,\r\n            cmiData\r\n          }\r\n        });\r\n        \r\n        if (error) throw error;\r\n        this.onDebugEvent('success', 'SCORM 1.2 session finished successfully');\r\n      } catch (error: any) {\r\n        this.onDebugEvent('error', `SCORM 1.2 Finish failed: ${error.message}`);\r\n        throw error;\r\n      }\r\n    };\r\n\r\n    this.api = createScorm12API({}, {\r\n      onCommit: handleCommit,\r\n      onFinish: handleFinish\r\n    });\r\n  }\r\n\r\n  initialize() {\r\n    try {\r\n      // Expose API on window for iframe discovery\r\n      (window as any).API = this.api;\r\n      this.onDebugEvent('success', 'SCORM 1.2 API initialized and exposed on window.API');\r\n    } catch (error: any) {\r\n      this.onDebugEvent('error', `SCORM 1.2 API initialization failed: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  cleanup() {\r\n    delete (window as any).API;\r\n    this.onDebugEvent('info', 'SCORM 1.2 API cleaned up');\r\n  }\r\n\r\n  getDebugLogs() {\r\n    return this.debugLogs;\r\n  }\r\n}\r\n\r\nexport class Scorm2004Adapter implements ScormAPIAdapter {\r\n  private api: any;\r\n  private debugLogs: string[] = [];\r\n  private enrollmentId: string;\r\n  private scoId: string;\r\n  private onDebugEvent: (type: DebugEventType, message: string) => void;\r\n\r\n  constructor(\r\n    enrollmentId: string,\r\n    scoId: string,\r\n    onDebugEvent: (type: DebugEventType, message: string) => void\r\n  ) {\r\n    this.enrollmentId = enrollmentId;\r\n    this.scoId = scoId;\r\n    this.onDebugEvent = onDebugEvent;\r\n    this.createAPI();\r\n  }\r\n\r\n  private createAPI() {\r\n    const handleCommit = async (cmiData: any) => {\r\n      try {\r\n        this.onDebugEvent('info', `SCORM 2004 Commit: ${JSON.stringify(cmiData).substring(0, 100)}...`);\r\n        \r\n        const { error } = await supabase.functions.invoke('scorm-runtime-advanced', {\r\n          body: {\r\n            action: 'commit',\r\n            enrollmentId: this.enrollmentId,\r\n            scoId: this.scoId,\r\n            cmiData\r\n          }\r\n        });\r\n        \r\n        if (error) throw error;\r\n        this.onDebugEvent('success', 'SCORM 2004 data committed successfully');\r\n      } catch (error: any) {\r\n        this.onDebugEvent('error', `SCORM 2004 Commit failed: ${error.message}`);\r\n        throw error;\r\n      }\r\n    };\r\n\r\n    const handleTerminate = async (cmiData: any) => {\r\n      try {\r\n        this.onDebugEvent('info', 'SCORM 2004 Terminating session...');\r\n        \r\n        const { error } = await supabase.functions.invoke('scorm-runtime-advanced', {\r\n          body: {\r\n            action: 'terminate',\r\n            enrollmentId: this.enrollmentId,\r\n            scoId: this.scoId,\r\n            cmiData\r\n          }\r\n        });\r\n        \r\n        if (error) throw error;\r\n        this.onDebugEvent('success', 'SCORM 2004 session terminated successfully');\r\n      } catch (error: any) {\r\n        this.onDebugEvent('error', `SCORM 2004 Terminate failed: ${error.message}`);\r\n        throw error;\r\n      }\r\n    };\r\n\r\n    this.api = createScorm2004API({}, {\r\n      onCommit: handleCommit,\r\n      onTerminate: handleTerminate\r\n    });\r\n  }\r\n\r\n  initialize() {\r\n    try {\r\n      // Expose API on window for iframe discovery\r\n      (window as any).API_1484_11 = this.api;\r\n      this.onDebugEvent('success', 'SCORM 2004 API initialized and exposed on window.API_1484_11');\r\n    } catch (error: any) {\r\n      this.onDebugEvent('error', `SCORM 2004 API initialization failed: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  cleanup() {\r\n    delete (window as any).API_1484_11;\r\n    this.onDebugEvent('info', 'SCORM 2004 API cleaned up');\r\n  }\r\n\r\n  getDebugLogs() {\r\n    return this.debugLogs;\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\scorm\\buildLaunchUrl.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\scorm\\testContentGeneration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\scorm\\urls.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\scorm\\useScormLaunchUrl.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\slug.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\ChoosePlan.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\Contact.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\CoursesPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\EmailConfirm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2282,2285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2282,2285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5832,5835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5832,5835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { CheckCircle, XCircle, Loader2 } from 'lucide-react';\r\nimport { logger } from '@/utils/logger';\r\n\r\nexport const EmailConfirm = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\r\n  const [error, setError] = useState<string>('');\r\n\r\n  useEffect(() => {\r\n    const confirmEmail = async () => {\r\n      try {\r\n        // Enhanced debug logging for SMTP troubleshooting\r\n        const allParams = Object.fromEntries(searchParams.entries());\r\n        const hash = window.location.hash || '';\r\n        const hashParams = new URLSearchParams(hash.replace(/^#/, ''));\r\n        \r\n        console.log('ðŸ” Email confirmation debug:', {\r\n          url: window.location.href,\r\n          queryParams: allParams,\r\n          hashParams: Object.fromEntries(hashParams.entries()),\r\n          userAgent: navigator.userAgent,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n        \r\n        // Handle possible error returned in URL by Supabase (e.g., invalid/expired link)\r\n        const urlErrorDesc = searchParams.get('error_description') || searchParams.get('message');\r\n        const urlErrorCode = searchParams.get('error_code');\r\n        if (urlErrorDesc) {\r\n          logger.auth('Email confirmation error from URL', { urlErrorDesc, urlErrorCode });\r\n          console.error('âŒ Email confirmation failed - URL error:', { urlErrorDesc, urlErrorCode });\r\n          setError(`Email confirmation failed: ${urlErrorDesc}${urlErrorCode ? ` (${urlErrorCode})` : ''}`);\r\n          setStatus('error');\r\n          return;\r\n        }\r\n\r\n        // Preferred flow: verify token_hash for signup/confirmation links\r\n        const tokenHash = searchParams.get('token_hash') || searchParams.get('token');\r\n        const typeParam = (searchParams.get('type') || 'signup') as any;\r\n\r\n        if (tokenHash) {\r\n          console.log('ðŸ”‘ Attempting token verification:', { type: typeParam, hasToken: true });\r\n          logger.auth('Email confirmation via token_hash', { type: typeParam });\r\n          const { error: verifyError } = await supabase.auth.verifyOtp({ token_hash: tokenHash, type: typeParam });\r\n          if (verifyError) {\r\n            console.error('âŒ Token verification failed:', verifyError);\r\n            throw verifyError;\r\n          }\r\n          console.log('âœ… Token verification successful');\r\n          setStatus('success');\r\n          \r\n          // Check for pending invite code and redirect appropriately\r\n          const pendingInviteCode = localStorage.getItem('pendingInviteCode');\r\n          if (pendingInviteCode) {\r\n            setTimeout(() => navigate(`/join?code=${pendingInviteCode}`, { replace: true }), 1500);\r\n          } else {\r\n            setTimeout(() => navigate('/dashboard/learner', { replace: true }), 1500);\r\n          }\r\n          return;\r\n        }\r\n\r\n        // Fallback 1: OAuth/PKCE code param\r\n        const codeParam = searchParams.get('code');\r\n        if (codeParam) {\r\n          console.log('ðŸ”‘ Attempting code exchange');\r\n          logger.auth('Email/OAuth confirmation via exchangeCodeForSession');\r\n          const { error: codeError } = await supabase.auth.exchangeCodeForSession(codeParam);\r\n          if (codeError) {\r\n            console.error('âŒ Code exchange failed:', codeError);\r\n            throw codeError;\r\n          }\r\n          console.log('âœ… Code exchange successful');\r\n          setStatus('success');\r\n          \r\n          // Check for pending invite code and redirect appropriately\r\n          const pendingInviteCode = localStorage.getItem('pendingInviteCode');\r\n          if (pendingInviteCode) {\r\n            setTimeout(() => navigate(`/join?code=${pendingInviteCode}`, { replace: true }), 1500);\r\n          } else {\r\n            setTimeout(() => navigate('/dashboard/learner', { replace: true }), 1500);\r\n          }\r\n          return;\r\n        }\r\n\r\n        // Fallback 2: Hash tokens (e.g., access_token in URL fragment)\r\n        const accessTokenInHash = hashParams.get('access_token');\r\n        const refreshTokenInHash = hashParams.get('refresh_token');\r\n        if (accessTokenInHash && refreshTokenInHash) {\r\n          console.log('ðŸ”‘ Attempting session restoration from hash');\r\n          logger.auth('Email confirmation via setSession (hash tokens)');\r\n          const { error: sessionError } = await supabase.auth.setSession({\r\n            access_token: accessTokenInHash,\r\n            refresh_token: refreshTokenInHash,\r\n          });\r\n          if (sessionError) {\r\n            console.error('âŒ Session restoration failed:', sessionError);\r\n            throw sessionError;\r\n          }\r\n          console.log('âœ… Session restoration successful');\r\n          setStatus('success');\r\n          \r\n          // Check for pending invite code and redirect appropriately\r\n          const pendingInviteCode = localStorage.getItem('pendingInviteCode');\r\n          if (pendingInviteCode) {\r\n            setTimeout(() => navigate(`/join?code=${pendingInviteCode}`, { replace: true }), 1500);\r\n          } else {\r\n            setTimeout(() => navigate('/dashboard/learner', { replace: true }), 1500);\r\n          }\r\n          return;\r\n        }\r\n\r\n        console.error('âŒ No valid confirmation token found');\r\n        throw new Error('Missing confirmation token - this usually indicates the email was not delivered properly');\r\n      } catch (err: any) {\r\n        logger.auth('Email confirmation failed', { error: err.message });\r\n        console.error('âŒ Email confirmation process failed:', err);\r\n        setError(err.message || 'Failed to confirm email');\r\n        setStatus('error');\r\n      }\r\n    };\r\n\r\n    confirmEmail();\r\n  }, [searchParams, navigate]);\r\n\r\n  const handleRetry = () => {\r\n    navigate('/login', { replace: true });\r\n  };\r\n\r\n  if (status === 'loading') {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-secondary/20\">\r\n        <Card className=\"w-full max-w-md\">\r\n          <CardHeader className=\"text-center\">\r\n            <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-2 text-primary\" />\r\n            <CardTitle>Confirming Email</CardTitle>\r\n            <CardDescription>\r\n              Please wait while we verify your email address...\r\n            </CardDescription>\r\n          </CardHeader>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (status === 'success') {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-secondary/20\">\r\n        <Card className=\"w-full max-w-md\">\r\n          <CardHeader className=\"text-center\">\r\n            <CheckCircle className=\"h-8 w-8 mx-auto mb-2 text-green-500\" />\r\n            <CardTitle className=\"text-green-700\">Email Confirmed!</CardTitle>\r\n            <CardDescription>\r\n              Your email has been successfully verified. You'll be redirected to your dashboard shortly.\r\n            </CardDescription>\r\n          </CardHeader>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-secondary/20\">\r\n      <Card className=\"w-full max-w-md\">\r\n        <CardHeader className=\"text-center\">\r\n          <XCircle className=\"h-8 w-8 mx-auto mb-2 text-destructive\" />\r\n          <CardTitle className=\"text-destructive\">Confirmation Failed</CardTitle>\r\n          <CardDescription>\r\n            We couldn't verify your email address.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <Alert variant=\"destructive\">\r\n            <AlertDescription>{error}</AlertDescription>\r\n          </Alert>\r\n          \r\n          <div className=\"space-y-2\">\r\n            <Button onClick={handleRetry} className=\"w-full\">\r\n              Back to Login\r\n            </Button>\r\n            <p className=\"text-sm text-muted-foreground text-center\">\r\n              Try signing up again or contact support if the problem persists.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\Games.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\Index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\JoinOrganization.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2109,2112],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2109,2112],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { useOrgInvitations } from '@/hooks/useOrgInvitations';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Loader2, Users, CheckCircle, XCircle } from 'lucide-react';\r\n\r\nexport function JoinOrganization() {\r\n  const { code: codeFromParams } = useParams();\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { processInvitation, isProcessing } = useOrgInvitations();\r\n  const [status, setStatus] = useState<'loading' | 'success' | 'error' | 'ready'>('loading');\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n\r\n  // Get invitation code from either URL params or query params\r\n  const code = codeFromParams || searchParams.get('code') || searchParams.get('token');\r\n\r\n  useEffect(() => {\r\n    console.log('JoinOrganization: code =', code, 'user =', !!user);\r\n    \r\n    if (!code) {\r\n      console.log('JoinOrganization: No code provided, redirecting to join form');\r\n      navigate('/join', { replace: true });\r\n      return;\r\n    }\r\n\r\n    if (!user) {\r\n      console.log('JoinOrganization: User not authenticated, redirecting to login');\r\n      // Redirect to sign up/login with the invitation code stored\r\n      localStorage.setItem('pendingInvitation', code);\r\n      navigate('/login?redirect=join-organization');\r\n      return;\r\n    }\r\n\r\n    console.log('JoinOrganization: Ready to process invitation');\r\n    setStatus('ready');\r\n  }, [code, user, navigate]);\r\n\r\n  const handleAcceptInvitation = async () => {\r\n    if (!code) return;\r\n\r\n    try {\r\n      await processInvitation({ code });\r\n      setStatus('success');\r\n      \r\n      // Redirect to dashboard after 3 seconds\r\n      setTimeout(() => {\r\n        navigate('/dashboard/learner');\r\n      }, 3000);\r\n    } catch (error: any) {\r\n      setStatus('error');\r\n      setErrorMessage(error.message || 'Failed to accept invitation');\r\n    }\r\n  };\r\n\r\n  if (status === 'loading') {\r\n    return (\r\n      <div className=\"container max-w-md mx-auto mt-8\">\r\n        <Card>\r\n          <CardContent className=\"flex items-center justify-center p-8\">\r\n            <Loader2 className=\"h-8 w-8 animate-spin\" />\r\n            <span className=\"ml-2\">Processing invitation...</span>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (status === 'success') {\r\n    return (\r\n      <div className=\"container max-w-md mx-auto mt-8\">\r\n        <Card>\r\n          <CardHeader className=\"text-center\">\r\n            <CheckCircle className=\"h-16 w-16 text-green-500 mx-auto mb-4\" />\r\n            <CardTitle className=\"text-2xl\">Welcome!</CardTitle>\r\n            <CardDescription>\r\n              You've successfully joined the organization!\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"text-center\">\r\n            <p className=\"text-muted-foreground mb-4\">\r\n              Redirecting to your dashboard...\r\n            </p>\r\n            <Button onClick={() => navigate('/dashboard/instructor')} className=\"w-full\">\r\n              Go to Dashboard\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (status === 'error') {\r\n    return (\r\n      <div className=\"container max-w-md mx-auto mt-8\">\r\n        <Card>\r\n          <CardHeader className=\"text-center\">\r\n            <XCircle className=\"h-16 w-16 text-red-500 mx-auto mb-4\" />\r\n            <CardTitle className=\"text-2xl\">Invalid Invitation</CardTitle>\r\n            <CardDescription>\r\n              This invitation link is not valid\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Alert variant=\"destructive\">\r\n              <AlertDescription>{errorMessage}</AlertDescription>\r\n            </Alert>\r\n            <Button \r\n              onClick={() => navigate('/dashboard')} \r\n              variant=\"outline\" \r\n              className=\"w-full mt-4\"\r\n            >\r\n              Go to Dashboard\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container max-w-md mx-auto mt-8\">\r\n      <Card>\r\n        <CardHeader className=\"text-center\">\r\n          {/* Waterford and Wexford Education and Training Board Logo */}\r\n          <div className=\"flex justify-center mb-4\">\r\n            <img \r\n              src=\"/lovable-uploads/44eb3e77-c5bb-47c8-a643-8320e9261df0.png\" \r\n              alt=\"Waterford and Wexford Education and Training Board\" \r\n              className=\"h-16 w-16 object-contain\"\r\n            />\r\n          </div>\r\n          <CardTitle className=\"text-2xl\">Join Waterford and Wexford ETB</CardTitle>\r\n          <CardDescription>\r\n            You've been invited to join Waterford and Wexford Education and Training Board on FPK University\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <p className=\"text-center text-muted-foreground\">\r\n            Click the button below to accept this invitation and join the organization.\r\n          </p>\r\n          \r\n          <Button \r\n            onClick={handleAcceptInvitation}\r\n            disabled={isProcessing}\r\n            className=\"w-full\"\r\n          >\r\n            {isProcessing ? (\r\n              <>\r\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                Accepting Invitation...\r\n              </>\r\n            ) : (\r\n              'Accept Invitation'\r\n            )}\r\n          </Button>\r\n\r\n          <Button \r\n            onClick={() => navigate('/dashboard')} \r\n            variant=\"outline\" \r\n            className=\"w-full\"\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default JoinOrganization;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\Login.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\OrgLanding.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchOrganization'. Either include it or remove the dependency array.","line":37,"column":6,"nodeType":"ArrayExpression","endLine":37,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [fetchOrganization, orgSlug]","fix":{"range":[1382,1391],"text":"[fetchOrganization, orgSlug]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkMembership'. Either include it or remove the dependency array.","line":43,"column":6,"nodeType":"ArrayExpression","endLine":43,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [user, organization, checkMembership]","fix":{"range":[1489,1509],"text":"[user, organization, checkMembership]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1996,1999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1996,1999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useParams, useNavigate, Link } from 'react-router-dom';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { ArrowLeft, Users, BookOpen, LogIn, UserPlus, Shield, Star } from 'lucide-react';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\nimport { safeSessionStorage } from '@/utils/safeStorage';\r\n\r\ninterface OrganizationData {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  logo_url: string;\r\n  slug: string;\r\n  plan: string;\r\n  seat_cap: number;\r\n  created_at: string;\r\n}\r\n\r\nexport default function OrgLanding() {\r\n  const { orgSlug } = useParams<{ orgSlug: string }>();\r\n  const { user, loading: authLoading } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [organization, setOrganization] = useState<OrganizationData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [isMember, setIsMember] = useState(false);\r\n  const [memberRole, setMemberRole] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (orgSlug) {\r\n      fetchOrganization();\r\n    }\r\n  }, [orgSlug]);\r\n\r\n  useEffect(() => {\r\n    if (user && organization) {\r\n      checkMembership();\r\n    }\r\n  }, [user, organization]);\r\n\r\n  const fetchOrganization = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('organizations')\r\n        .select('id, name, description, logo_url, slug, plan, seat_cap, created_at')\r\n        .eq('slug', orgSlug)\r\n        .single();\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (!data) {\r\n        throw new Error('Organization not found');\r\n      }\r\n\r\n      setOrganization(data);\r\n    } catch (error: any) {\r\n      console.error('Error fetching organization:', error);\r\n      setError('Organization not found or no longer available.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const checkMembership = async () => {\r\n    if (!user || !organization) return;\r\n\r\n    try {\r\n      const { data } = await supabase\r\n        .from('org_members')\r\n        .select('role, status')\r\n        .eq('org_id', organization.id)\r\n        .eq('user_id', user.id)\r\n        .eq('status', 'active')\r\n        .maybeSingle();\r\n\r\n      if (data) {\r\n        setIsMember(true);\r\n        setMemberRole(data.role);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error checking membership:', error);\r\n    }\r\n  };\r\n\r\n  const handleGoToDashboard = () => {\r\n    if (memberRole === 'owner' || memberRole === 'instructor') {\r\n      navigate('/dashboard/instructor');\r\n    } else {\r\n      navigate('/dashboard/learner');\r\n    }\r\n  };\r\n\r\n  const handleAuthWithOrg = (mode: 'login' | 'signup') => {\r\n    // Store org context and redirect to auth\r\n    safeSessionStorage.setItem('orgContext', JSON.stringify({\r\n      orgId: organization?.id,\r\n      orgSlug: organization?.slug,\r\n      orgName: organization?.name\r\n    }), { logErrors: false });\r\n    navigate(`/login?org=${orgSlug}`);\r\n  };\r\n\r\n  const handleJoinWithCode = () => {\r\n    navigate(`/join?org=${orgSlug}`);\r\n  };\r\n\r\n  if (loading || authLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-fpk-purple to-fpk-amber\">\r\n        <div className=\"container mx-auto px-4 py-8\">\r\n          <Skeleton className=\"w-32 h-10 mb-8\" />\r\n          <div className=\"max-w-4xl mx-auto text-center\">\r\n            <Skeleton className=\"w-24 h-24 rounded-full mx-auto mb-6\" />\r\n            <Skeleton className=\"w-96 h-12 mx-auto mb-4\" />\r\n            <Skeleton className=\"w-64 h-6 mx-auto mb-8\" />\r\n            <div className=\"grid gap-4 md:grid-cols-2 max-w-2xl mx-auto\">\r\n              <Skeleton className=\"h-40\" />\r\n              <Skeleton className=\"h-40\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !organization) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-fpk-purple to-fpk-amber flex items-center justify-center p-4\">\r\n        <Card className=\"max-w-md mx-auto shadow-2xl\">\r\n          <CardHeader className=\"text-center\">\r\n            <Shield className=\"w-12 h-12 text-red-500 mx-auto mb-4\" />\r\n            <CardTitle>Organization Not Found</CardTitle>\r\n            <CardDescription>\r\n              The organization you're looking for doesn't exist or is no longer available.\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"text-center\">\r\n            <Button asChild>\r\n              <Link to=\"/\">Return to Home</Link>\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div \r\n      className=\"min-h-screen\"\r\n      style={{\r\n        backgroundImage: 'url(https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/home-page/home-page-background.png)',\r\n        backgroundSize: 'cover',\r\n        backgroundPosition: 'center',\r\n        backgroundRepeat: 'no-repeat',\r\n        backgroundAttachment: 'fixed',\r\n      }}\r\n    >\r\n      <div className=\"min-h-screen bg-gradient-to-br from-fpk-purple/80 to-fpk-amber/80\">\r\n        <div className=\"container mx-auto px-4 py-8\">\r\n          <div className=\"mb-8\">\r\n            <Button variant=\"ghost\" asChild className=\"text-white hover:bg-white/20\">\r\n              <Link to=\"/\">\r\n                <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n                Back to FPK University\r\n              </Link>\r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"max-w-4xl mx-auto text-center\">\r\n            {/* Organization Header */}\r\n            <div className=\"mb-12\">\r\n              {organization.logo_url ? (\r\n                <img\r\n                  src={organization.logo_url}\r\n                  alt={`${organization.name} logo`}\r\n                  className=\"w-24 h-24 rounded-full mx-auto mb-6 border-4 border-white/20 shadow-lg object-cover\"\r\n                />\r\n              ) : (\r\n                <div className=\"w-24 h-24 rounded-full mx-auto mb-6 bg-white/20 flex items-center justify-center border-4 border-white/20\">\r\n                  <Users className=\"w-12 h-12 text-white\" />\r\n                </div>\r\n              )}\r\n              \r\n              <h1 className=\"text-5xl font-bold text-white mb-4\">\r\n                {organization.name}\r\n              </h1>\r\n              \r\n              {organization.description && (\r\n                <p className=\"text-white/80 text-xl leading-relaxed max-w-2xl mx-auto mb-6\">\r\n                  {organization.description}\r\n                </p>\r\n              )}\r\n\r\n              <div className=\"flex items-center justify-center gap-4 flex-wrap\">\r\n                <Badge variant=\"secondary\" className=\"bg-white/20 text-white border-white/20\">\r\n                  {organization.plan.charAt(0).toUpperCase() + organization.plan.slice(1)} Plan\r\n                </Badge>\r\n                <Badge variant=\"secondary\" className=\"bg-white/20 text-white border-white/20\">\r\n                  Up to {organization.seat_cap} Students\r\n                </Badge>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Member Dashboard Access */}\r\n            {user && isMember ? (\r\n              <div className=\"mb-8\">\r\n                <Card className=\"bg-white/10 border-white/20 backdrop-blur-sm max-w-md mx-auto\">\r\n                  <CardContent className=\"p-6 text-center\">\r\n                    <Star className=\"w-12 h-12 text-yellow-400 mx-auto mb-4\" />\r\n                    <h3 className=\"text-xl font-semibold text-white mb-2\">\r\n                      Welcome back!\r\n                    </h3>\r\n                    <p className=\"text-white/80 mb-4\">\r\n                      You're a {memberRole} of {organization.name}\r\n                    </p>\r\n                    <Button \r\n                      onClick={handleGoToDashboard}\r\n                      className=\"bg-fpk-orange hover:bg-fpk-orange/90 text-white\"\r\n                    >\r\n                      Go to Dashboard\r\n                    </Button>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            ) : (\r\n              /* Action Cards for Non-Members */\r\n              <div className=\"grid gap-6 md:grid-cols-2 max-w-2xl mx-auto mb-12\">\r\n                {/* Sign In / Sign Up Card */}\r\n                <Card className=\"bg-white/10 border-white/20 backdrop-blur-sm shadow-2xl hover:bg-white/15 transition-colors\">\r\n                  <CardHeader className=\"text-center pb-4\">\r\n                    <LogIn className=\"w-12 h-12 text-white mx-auto mb-4\" />\r\n                    <CardTitle className=\"text-white text-xl\">Sign In / Create Account</CardTitle>\r\n                    <CardDescription className=\"text-white/80\">\r\n                      Access your account to join this organization or create a new account to get started.\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent className=\"text-center\">\r\n                    <Button \r\n                      onClick={() => handleAuthWithOrg('login')}\r\n                      className=\"w-full bg-fpk-orange hover:bg-fpk-orange/90 text-white font-semibold\"\r\n                    >\r\n                      Sign In / Sign Up\r\n                    </Button>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Join with Invite Code Card */}\r\n                <Card className=\"bg-white/10 border-white/20 backdrop-blur-sm shadow-2xl hover:bg-white/15 transition-colors\">\r\n                  <CardHeader className=\"text-center pb-4\">\r\n                    <UserPlus className=\"w-12 h-12 text-white mx-auto mb-4\" />\r\n                    <CardTitle className=\"text-white text-xl\">Join with Invite Code</CardTitle>\r\n                    <CardDescription className=\"text-white/80\">\r\n                      Have an invitation code from your instructor? Enter it here to join this organization.\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent className=\"text-center\">\r\n                    <Button \r\n                      onClick={handleJoinWithCode}\r\n                      variant=\"outline\"\r\n                      className=\"w-full border-white/30 text-white bg-white/10 hover:bg-white/20 font-semibold\"\r\n                    >\r\n                      Enter Invite Code\r\n                    </Button>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            )}\r\n\r\n            {/* Organization Features */}\r\n            <div className=\"grid gap-6 md:grid-cols-3 max-w-4xl mx-auto\">\r\n              <Card className=\"bg-white/5 border-white/10 backdrop-blur-sm\">\r\n                <CardContent className=\"p-6 text-center\">\r\n                  <BookOpen className=\"w-8 h-8 text-white mx-auto mb-3\" />\r\n                  <h4 className=\"text-white font-semibold mb-2\">Learning Resources</h4>\r\n                  <p className=\"text-white/70 text-sm\">\r\n                    Access curated courses, materials, and assignments tailored to your learning path.\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-white/5 border-white/10 backdrop-blur-sm\">\r\n                <CardContent className=\"p-6 text-center\">\r\n                  <Users className=\"w-8 h-8 text-white mx-auto mb-3\" />\r\n                  <h4 className=\"text-white font-semibold mb-2\">Community Learning</h4>\r\n                  <p className=\"text-white/70 text-sm\">\r\n                    Connect with classmates and instructors in a collaborative learning environment.\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-white/5 border-white/10 backdrop-blur-sm\">\r\n                <CardContent className=\"p-6 text-center\">\r\n                  <Star className=\"w-8 h-8 text-white mx-auto mb-3\" />\r\n                  <h4 className=\"text-white font-semibold mb-2\">Progress Tracking</h4>\r\n                  <p className=\"text-white/70 text-sm\">\r\n                    Monitor your learning progress with detailed analytics and goal tracking.\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Footer Info */}\r\n            <div className=\"mt-12 text-center\">\r\n              <p className=\"text-white/60 text-sm\">\r\n                Powered by FPK University â€¢ A personalized learning platform\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\OrganizationSignup.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkExistingOrganization'. Either include it or remove the dependency array.","line":46,"column":6,"nodeType":"ArrayExpression","endLine":46,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [user, loading, checkExistingOrganization]","fix":{"range":[2007,2022],"text":"[user, loading, checkExistingOrganization]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2888,2891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2888,2891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":126,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4423,4426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4423,4426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":257,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":257,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9258,9261],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9258,9261],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { SUBSCRIPTION_TIERS } from '@/types/organization';\r\nimport { ArrowLeft, Upload, Users, Crown, Star, Zap, Building, Building2 } from 'lucide-react';\r\nimport type { OrgSubscriptionTier } from '@/types/organization';\r\nimport { ensureUniqueSlug } from '@/lib/slug';\r\nimport { EmailVerificationGate } from '@/components/auth/EmailVerificationGate';\r\n\r\nexport default function OrganizationSignup() {\r\n  const [orgData, setOrgData] = useState({\r\n    name: '',\r\n    description: '',\r\n    selectedTier: 'beta' as OrgSubscriptionTier\r\n  });\r\n  const [signUpData, setSignUpData] = useState({\r\n    email: '',\r\n    password: '',\r\n    displayName: '',\r\n    confirmPassword: ''\r\n  });\r\n  const [logoFile, setLogoFile] = useState<File | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [showEmailVerification, setShowEmailVerification] = useState(false);\r\n  const [createdOrgName, setCreatedOrgName] = useState<string>('');\r\n  const { user, loading } = useAuth();\r\n  const { toast } = useToast();\r\n  const navigate = useNavigate();\r\n\r\n  // Redirect authenticated users to instructor dashboard if they already have an org\r\n  useEffect(() => {\r\n    if (user && !loading) {\r\n      // Check if user already owns an organization\r\n      checkExistingOrganization();\r\n    }\r\n  }, [user, loading]);\r\n\r\n  const checkExistingOrganization = async () => {\r\n    try {\r\n      const { data } = await supabase\r\n        .from('organizations')\r\n        .select('id, slug')\r\n        .eq('owner_id', user?.id)\r\n        .maybeSingle();\r\n      \r\n      if (data) {\r\n        toast({\r\n          title: 'Organization exists',\r\n          description: 'You already have an organization. Redirecting to your dashboard.',\r\n        });\r\n        navigate('/dashboard/instructor');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error checking existing organization:', error);\r\n    }\r\n  };\r\n\r\n  const generateSlug = (name: string): string => {\r\n    return name\r\n      .toLowerCase()\r\n      .trim()\r\n      .replace(/[^a-z0-9\\s-]/g, '')\r\n      .replace(/\\s+/g, '-')\r\n      .replace(/-+/g, '-')\r\n      .substring(0, 50);\r\n  };\r\n\r\n  const uploadLogo = async (file: File, currentUser: any): Promise<string | null> => {\r\n    try {\r\n      // Skip upload for new signups - will be handled after email verification\r\n      if (!user) {\r\n        console.log('Skipping logo upload for new signup - will upload after verification');\r\n        return null;\r\n      }\r\n\r\n      const fileExt = file.name.split('.').pop();\r\n      const fileName = `${Date.now()}-${Math.random().toString(36).substring(2)}.${fileExt}`;\r\n      const filePath = `org-logos/${fileName}`;\r\n\r\n      const { error: uploadError } = await supabase.storage\r\n        .from('avatars')\r\n        .upload(filePath, file);\r\n\r\n      if (uploadError) {\r\n        console.error('Upload error:', uploadError);\r\n        return null;\r\n      }\r\n\r\n      const { data } = supabase.storage\r\n        .from('avatars')\r\n        .getPublicUrl(filePath);\r\n\r\n      return data.publicUrl;\r\n    } catch (error) {\r\n      console.error('Error uploading logo:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const handleSignUp = async (): Promise<{ success: boolean; userId?: string }> => {\r\n    try {\r\n      const { data, error } = await supabase.auth.signUp({\r\n        email: signUpData.email,\r\n        password: signUpData.password,\r\n        options: {\r\n          data: {\r\n            full_name: signUpData.displayName,\r\n            display_name: signUpData.displayName,\r\n          },\r\n          emailRedirectTo: `${window.location.origin}/auth/confirm`\r\n        }\r\n      });\r\n\r\n      if (error) throw error;\r\n      return { success: true, userId: data.user?.id };\r\n    } catch (error: any) {\r\n      setError(error.message);\r\n      return { success: false };\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      console.log('ðŸš€ Starting organization creation process...');\r\n      \r\n      // Validation\r\n      if (!orgData.name.trim()) {\r\n        throw new Error('Organization name is required.');\r\n      }\r\n\r\n      let currentUserId: string | undefined;\r\n\r\n      if (!user) {\r\n        console.log('ðŸ‘¤ No existing user, creating new account...');\r\n        // Validate sign up data\r\n        if (!signUpData.email || !signUpData.password || !signUpData.displayName) {\r\n          throw new Error('Please fill in all account fields.');\r\n        }\r\n        if (signUpData.password !== signUpData.confirmPassword) {\r\n          throw new Error('Passwords do not match.');\r\n        }\r\n        if (signUpData.password.length < 6) {\r\n          throw new Error('Password must be at least 6 characters long.');\r\n        }\r\n\r\n        // Sign up the user first\r\n        const signUpResult = await handleSignUp();\r\n        if (!signUpResult.success) {\r\n          console.error('âŒ Sign up failed');\r\n          return;\r\n        }\r\n        currentUserId = signUpResult.userId;\r\n        console.log('âœ… User created with ID:', currentUserId);\r\n        \r\n        // Wait much longer and verify user exists in database\r\n        console.log('â³ Waiting for user to be committed to database...');\r\n        let userExists = false;\r\n        let attempts = 0;\r\n        const maxAttempts = 15;\r\n        \r\n        while (!userExists && attempts < maxAttempts) {\r\n          await new Promise(resolve => setTimeout(resolve, 1500));\r\n          \r\n          // Try to get the user session to verify they exist\r\n          const { data: sessionData } = await supabase.auth.getUser();\r\n          if (sessionData.user && sessionData.user.id === currentUserId) {\r\n            userExists = true;\r\n            console.log('âœ… User confirmed to exist via session');\r\n          } else {\r\n            attempts++;\r\n            console.log(`â³ User not yet available, attempt ${attempts}/${maxAttempts}`);\r\n          }\r\n        }\r\n        \r\n        if (!userExists) {\r\n          throw new Error('User session was not properly established. Please try signing in instead.');\r\n        }\r\n      } else {\r\n        currentUserId = user.id;\r\n        console.log('âœ… Using existing user ID:', currentUserId);\r\n      }\r\n\r\n      if (!currentUserId) {\r\n        throw new Error('Unable to determine user ID.');\r\n      }\r\n\r\n      // Skip logo upload for now to avoid RLS issues\r\n      console.log('âš ï¸ Skipping logo upload to avoid RLS issues');\r\n      const logoUrl: string | null = null;\r\n\r\n      // Generate a unique slug\r\n      console.log('ðŸ”— Generating unique slug for:', orgData.name);\r\n      const slug = await ensureUniqueSlug(orgData.name);\r\n      console.log('âœ… Generated slug:', slug);\r\n\r\n      // Get tier info\r\n      const tierInfo = SUBSCRIPTION_TIERS[orgData.selectedTier];\r\n      console.log('ðŸ“Š Selected tier:', orgData.selectedTier, tierInfo);\r\n\r\n      // Use database function to create organization (bypasses RLS issues)\r\n      console.log('ðŸ¢ Creating organization via database function...');\r\n      const { data: orgId, error: createError } = await supabase\r\n        .rpc('create_organization_with_membership', {\r\n          p_name: orgData.name,\r\n          p_slug: slug,\r\n          p_description: orgData.description || null,\r\n          p_logo_url: logoUrl,\r\n          p_plan: orgData.selectedTier,\r\n          p_seat_cap: tierInfo.seats,\r\n          p_instructor_limit: tierInfo.instructors,\r\n          p_user_id: currentUserId\r\n        });\r\n\r\n      if (createError) {\r\n        console.error('âŒ Organization creation failed:', createError);\r\n        throw new Error(`Failed to create organization: ${createError.message}`);\r\n      }\r\n\r\n      console.log('âœ… Organization created with ID:', orgId);\r\n\r\n      // Check if user email is verified\r\n      const { data: userCheck } = await supabase.auth.getUser();\r\n      const emailVerified = userCheck.user?.email_confirmed_at;\r\n      console.log('ðŸ“§ Email verified:', !!emailVerified);\r\n\r\n      if (!emailVerified && !user) {\r\n        // Show email verification gate for new signups\r\n        console.log('ðŸ“¨ Showing email verification gate');\r\n        setCreatedOrgName(orgData.name);\r\n        setShowEmailVerification(true);\r\n        return;\r\n      }\r\n\r\n      toast({\r\n        title: 'Organization created successfully!',\r\n        description: `Welcome to ${orgData.name}. You can now start adding instructors and learners.`,\r\n      });\r\n\r\n      console.log('ðŸŽ¯ Navigating to instructor dashboard...');\r\n      // Navigate to instructor dashboard\r\n      navigate('/dashboard/instructor');\r\n\r\n    } catch (error: any) {\r\n      console.error('ðŸ’¥ Organization creation error:', error);\r\n      setError(error.message || 'An unexpected error occurred. Please try again.');\r\n      \r\n      toast({\r\n        title: 'Error creating organization',\r\n        description: error.message || 'An unexpected error occurred. Please try again.',\r\n        variant: 'destructive',\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getTierIcon = (tier: OrgSubscriptionTier) => {\r\n    switch (tier) {\r\n      case 'beta': return <Building className=\"w-5 h-5\" />;\r\n      case 'basic': return <Users className=\"w-5 h-5\" />;\r\n      case 'standard': return <Building2 className=\"w-5 h-5\" />;\r\n      case 'premium': return <Crown className=\"w-5 h-5\" />;\r\n      default: return <Building className=\"w-5 h-5\" />;\r\n    }\r\n  };\r\n\r\n  const handleEmailVerified = () => {\r\n    setShowEmailVerification(false);\r\n    toast({\r\n      title: 'Organization created successfully!',\r\n      description: `Welcome to ${createdOrgName}. You can now start adding instructors and learners.`,\r\n    });\r\n    navigate('/dashboard/instructor');\r\n  };\r\n\r\n  if (showEmailVerification) {\r\n    return (\r\n      <EmailVerificationGate\r\n        email={signUpData.email}\r\n        organizationName={createdOrgName}\r\n        onVerified={handleEmailVerified}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-fpk-purple to-fpk-amber\">\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"mb-8\">\r\n          <Button variant=\"ghost\" asChild className=\"text-white hover:bg-white/20\">\r\n            <Link to=\"/\">\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n              Back to Home\r\n            </Link>\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <div className=\"text-center mb-8\">\r\n            <h1 className=\"text-4xl font-bold text-white mb-4\">\r\n              Create Your Organization\r\n            </h1>\r\n            <p className=\"text-white/80 text-lg\">\r\n              Set up your learning organization and start managing students, instructors, and courses.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"grid gap-8 md:grid-cols-2\">\r\n            {/* Organization Details */}\r\n            <Card className=\"shadow-2xl\">\r\n              <CardHeader>\r\n                <CardTitle>Organization Details</CardTitle>\r\n                <CardDescription>\r\n                  Tell us about your organization\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                {error && (\r\n                  <Alert className=\"border-red-200 bg-red-50\">\r\n                    <AlertDescription className=\"text-red-800\">\r\n                      {error}\r\n                    </AlertDescription>\r\n                  </Alert>\r\n                )}\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"org-name\">Organization Name *</Label>\r\n                  <Input\r\n                    id=\"org-name\"\r\n                    placeholder=\"Enter organization name\"\r\n                    value={orgData.name}\r\n                    onChange={(e) => setOrgData({ ...orgData, name: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"org-description\">Description</Label>\r\n                  <Textarea\r\n                    id=\"org-description\"\r\n                    placeholder=\"Describe your organization (optional)\"\r\n                    value={orgData.description}\r\n                    onChange={(e) => setOrgData({ ...orgData, description: e.target.value })}\r\n                    rows={3}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"org-logo\">Organization Logo</Label>\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <Input\r\n                      id=\"org-logo\"\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      onChange={(e) => setLogoFile(e.target.files?.[0] || null)}\r\n                    />\r\n                    <Upload className=\"w-5 h-5 text-muted-foreground\" />\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Upload a logo for your organization (optional)\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Plan Selection */}\r\n            <Card className=\"shadow-2xl\">\r\n              <CardHeader>\r\n                <CardTitle>Choose Your Plan</CardTitle>\r\n                <CardDescription>\r\n                  Select the plan that fits your organization's needs\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  {Object.entries(SUBSCRIPTION_TIERS).map(([tier, info]) => (\r\n                    <Card \r\n                      key={tier}\r\n                      className={`cursor-pointer border-2 transition-colors ${\r\n                        orgData.selectedTier === tier \r\n                          ? 'border-fpk-orange bg-fpk-orange/5' \r\n                          : 'border-gray-200 hover:border-gray-300'\r\n                      }`}\r\n                      onClick={() => setOrgData({ ...orgData, selectedTier: tier as OrgSubscriptionTier })}\r\n                    >\r\n                      <CardContent className=\"p-4\">\r\n                        <div className=\"flex items-center justify-between mb-3\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            {getTierIcon(tier as OrgSubscriptionTier)}\r\n                            <div>\r\n                              <h3 className=\"font-semibold\">{info.name}</h3>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <span className=\"text-2xl font-bold\">\r\n                                  ${info.price}\r\n                                </span>\r\n                                {info.price > 0 && <span className=\"text-muted-foreground\">/month</span>}\r\n                                {'isBeta' in info && info.isBeta && (\r\n                                  <Badge variant=\"secondary\" className=\"bg-green-100 text-green-800\">\r\n                                    Free Beta\r\n                                  </Badge>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"text-right text-sm text-muted-foreground\">\r\n                            <div>{info.seats} students</div>\r\n                            <div>{info.instructors} instructors</div>\r\n                          </div>\r\n                        </div>\r\n                        <ul className=\"text-sm space-y-1\">\r\n                          {info.features.slice(0, 3).map((feature, index) => (\r\n                            <li key={index} className=\"flex items-center gap-2\">\r\n                              <div className=\"w-1.5 h-1.5 bg-fpk-orange rounded-full flex-shrink-0\" />\r\n                              {feature}\r\n                            </li>\r\n                          ))}\r\n                        </ul>\r\n                      </CardContent>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Account Section - Only show if not logged in */}\r\n          {!user && (\r\n            <Card className=\"mt-8 shadow-2xl\">\r\n              <CardHeader>\r\n                <CardTitle>Create Your Account</CardTitle>\r\n                <CardDescription>\r\n                  You'll be the owner of this organization. Already have an account?{' '}\r\n                  <Link to=\"/login\" className=\"text-fpk-orange hover:underline font-medium\">\r\n                    Sign in here\r\n                  </Link>\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"grid gap-4 md:grid-cols-2\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"account-name\">Your Name *</Label>\r\n                  <Input\r\n                    id=\"account-name\"\r\n                    placeholder=\"Enter your full name\"\r\n                    value={signUpData.displayName}\r\n                    onChange={(e) => setSignUpData({ ...signUpData, displayName: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"account-email\">Email *</Label>\r\n                  <Input\r\n                    id=\"account-email\"\r\n                    type=\"email\"\r\n                    placeholder=\"Enter your email\"\r\n                    value={signUpData.email}\r\n                    onChange={(e) => setSignUpData({ ...signUpData, email: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"account-password\">Password *</Label>\r\n                  <Input\r\n                    id=\"account-password\"\r\n                    type=\"password\"\r\n                    placeholder=\"Create a password\"\r\n                    value={signUpData.password}\r\n                    onChange={(e) => setSignUpData({ ...signUpData, password: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"account-confirm\">Confirm Password *</Label>\r\n                  <Input\r\n                    id=\"account-confirm\"\r\n                    type=\"password\"\r\n                    placeholder=\"Confirm your password\"\r\n                    value={signUpData.confirmPassword}\r\n                    onChange={(e) => setSignUpData({ ...signUpData, confirmPassword: e.target.value })}\r\n                    required\r\n                  />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Submit Button */}\r\n          <div className=\"mt-8 text-center\">\r\n            <Button \r\n              onClick={handleSubmit}\r\n              disabled={isLoading}\r\n              size=\"lg\"\r\n              className=\"bg-fpk-orange hover:bg-fpk-orange/90 text-white px-12 py-4 text-lg font-semibold\"\r\n            >\r\n              {isLoading ? 'Creating Organization...' : 'Create Organization'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\PrivacyPolicy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\ResetPassword.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":115,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4781,4784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4781,4784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'searchParams'. Either include it or remove the dependency array.","line":145,"column":6,"nodeType":"ArrayExpression","endLine":145,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [searchParams]","fix":{"range":[5813,5815],"text":"[searchParams]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { Eye, EyeOff, Loader2, ArrowLeft } from 'lucide-react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nexport default function ResetPassword() {\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const [searchParams] = useSearchParams();\r\n  const { toast } = useToast();\r\n  \r\n  const [passwords, setPasswords] = useState({\r\n    newPassword: '',\r\n    confirmPassword: ''\r\n  });\r\n  const [showPassword, setShowPassword] = useState({\r\n    new: false,\r\n    confirm: false\r\n  });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isProcessingToken, setIsProcessingToken] = useState(true);\r\n  const [tokenValid, setTokenValid] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  // Process auth tokens on mount - prevent double processing\r\n  useEffect(() => {\r\n    let hasProcessed = false;\r\n    \r\n    const processTokens = async () => {\r\n      if (hasProcessed) {\r\n        console.log('ðŸ” Skipping token processing - already processed');\r\n        return;\r\n      }\r\n      hasProcessed = true;\r\n      \r\n      console.log('ðŸ” Processing reset tokens...', { \r\n        url: window.location.href,\r\n        hash: window.location.hash,\r\n        search: window.location.search,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n      \r\n      // Check for tokens in URL fragment (hash) - Supabase auth flow\r\n      const hashParams = new URLSearchParams(window.location.hash.substring(1));\r\n      const accessToken = hashParams.get('access_token') || searchParams.get('access_token');\r\n      const refreshToken = hashParams.get('refresh_token') || searchParams.get('refresh_token');\r\n      const type = hashParams.get('type') || searchParams.get('type');\r\n      const errorParam = hashParams.get('error') || searchParams.get('error');\r\n      const errorDescription = hashParams.get('error_description') || searchParams.get('error_description');\r\n      \r\n      console.log('ðŸ” Found tokens:', { \r\n        hasAccess: !!accessToken, \r\n        hasRefresh: !!refreshToken, \r\n        type,\r\n        error: errorParam,\r\n        errorDescription,\r\n        fromHash: !!hashParams.get('access_token'),\r\n        fromSearch: !!searchParams.get('access_token')\r\n      });\r\n      \r\n      // Check for explicit error parameters first\r\n      if (errorParam) {\r\n        console.error('âŒ Auth error in URL:', { error: errorParam, description: errorDescription });\r\n        let errorMessage = 'Password reset link is invalid or has expired.';\r\n        \r\n        if (errorParam === 'access_denied') {\r\n          errorMessage = 'Access denied. The reset link may have expired.';\r\n        } else if (errorDescription && errorDescription.includes('expired')) {\r\n          errorMessage = 'Password reset link has expired. Please request a new one.';\r\n        } else if (errorDescription && errorDescription.includes('invalid')) {\r\n          errorMessage = 'Password reset link is invalid. Please request a new one.';\r\n        }\r\n        \r\n        setError(errorMessage);\r\n        setIsProcessingToken(false);\r\n        setTokenValid(false);\r\n        return;\r\n      }\r\n      \r\n      // If we have access_token and refresh_token (from Supabase verification redirect)\r\n      if (accessToken && refreshToken && type === 'recovery') {\r\n        console.log('âœ… Valid recovery tokens found, attempting session setup');\r\n        try {\r\n          const { data, error } = await supabase.auth.setSession({\r\n            access_token: accessToken,\r\n            refresh_token: refreshToken\r\n          });\r\n          \r\n          if (error) {\r\n            console.error('âŒ Session setup error:', error);\r\n            throw error;\r\n          }\r\n          \r\n          if (data.session) {\r\n            console.log('âœ… Session established for password reset', {\r\n              userId: data.session.user?.id,\r\n              expiresAt: data.session.expires_at,\r\n              tokenExpiry: new Date(data.session.expires_at * 1000).toISOString()\r\n            });\r\n            setTokenValid(true);\r\n            setIsProcessingToken(false);\r\n            \r\n            // Clean up URL\r\n            window.history.replaceState({}, '', window.location.pathname);\r\n            return;\r\n          } else {\r\n            throw new Error('No session returned from setSession');\r\n          }\r\n        } catch (error: any) {\r\n          console.error('âŒ Error setting session:', error);\r\n          \r\n          let errorMessage = 'Failed to validate reset link. Please request a new one.';\r\n          if (error.message?.includes('expired')) {\r\n            errorMessage = 'Password reset link has expired. Please request a new one.';\r\n          } else if (error.message?.includes('invalid')) {\r\n            errorMessage = 'Password reset link is invalid. Please request a new one.';\r\n          }\r\n          \r\n          setError(errorMessage);\r\n          setIsProcessingToken(false);\r\n          setTokenValid(false);\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // No valid tokens found\r\n      console.log('âŒ Invalid or missing tokens');\r\n      setError('Password reset link is invalid or has expired. Please request a new one.');\r\n      setIsProcessingToken(false);\r\n      setTokenValid(false);\r\n    };\r\n\r\n    processTokens();\r\n    \r\n    // Cleanup function to prevent memory leaks\r\n    return () => {\r\n      hasProcessed = true;\r\n    };\r\n  }, []); // Remove searchParams dependency to prevent re-processing\r\n\r\n  const handlePasswordChange = (field: 'newPassword' | 'confirmPassword', value: string) => {\r\n    setPasswords(prev => ({ ...prev, [field]: value }));\r\n    setError('');\r\n  };\r\n\r\n  const validatePasswords = () => {\r\n    if (passwords.newPassword.length < 8) {\r\n      setError('Password must be at least 8 characters long.');\r\n      return false;\r\n    }\r\n    if (passwords.newPassword !== passwords.confirmPassword) {\r\n      setError('Passwords do not match.');\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleResetPassword = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validatePasswords()) return;\r\n    \r\n    setIsLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      console.log('ðŸ” Updating password...');\r\n      const { error } = await supabase.auth.updateUser({ \r\n        password: passwords.newPassword \r\n      });\r\n\r\n      if (error) {\r\n        console.error('âŒ Password update failed:', error);\r\n        setError(error.message || 'Failed to update password. Please try again.');\r\n        return;\r\n      }\r\n\r\n      console.log('âœ… Password updated successfully');\r\n      toast({\r\n        title: 'Password Updated',\r\n        description: 'Your password has been updated successfully. You can now sign in with your new password.',\r\n      });\r\n\r\n      // Clean up URL parameters and redirect to login with success message\r\n      const cleanUrl = window.location.origin + '/login?resetSuccess=true';\r\n      window.history.replaceState({}, '', cleanUrl);\r\n      \r\n      // Redirect to login after a brief delay\r\n      setTimeout(() => {\r\n        navigate('/login', { \r\n          replace: true, \r\n          state: { resetSuccess: true, autoFocusEmail: true }\r\n        });\r\n      }, 2000);\r\n    } catch (err) {\r\n      console.error('âŒ Password reset error:', err);\r\n      setError('An error occurred while updating your password. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRequestNewLink = () => {\r\n    navigate('/login', { state: { showForgotPassword: true } });\r\n  };\r\n\r\n  if (isProcessingToken) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-muted/50\">\r\n        <Card className=\"w-full max-w-md\">\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex flex-col items-center space-y-4\">\r\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n              <p className=\"text-center text-muted-foreground\">\r\n                Processing your password reset request...\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!tokenValid) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-muted/50\">\r\n        <Card className=\"w-full max-w-md\">\r\n          <CardHeader className=\"text-center\">\r\n            <CardTitle className=\"text-destructive\">Reset Link Invalid</CardTitle>\r\n            <CardDescription>\r\n              {error || 'This password reset link is invalid or has expired.'}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <Button onClick={handleRequestNewLink} className=\"w-full\">\r\n              Request New Reset Link\r\n            </Button>\r\n            <Button \r\n              variant=\"ghost\" \r\n              onClick={() => navigate('/login')}\r\n              className=\"w-full\"\r\n            >\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n              Back to Login\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-muted/50\">\r\n      <Card className=\"w-full max-w-md\">\r\n        <CardHeader className=\"text-center\">\r\n          <CardTitle>Reset Your Password</CardTitle>\r\n          <CardDescription>\r\n            Enter your new password below. Make sure it's secure and memorable.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handleResetPassword} className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"newPassword\">New Password</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"newPassword\"\r\n                  type={showPassword.new ? 'text' : 'password'}\r\n                  value={passwords.newPassword}\r\n                  onChange={(e) => handlePasswordChange('newPassword', e.target.value)}\r\n                  placeholder=\"Enter your new password\"\r\n                  required\r\n                  minLength={8}\r\n                  className=\"pr-10\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowPassword(prev => ({ ...prev, new: !prev.new }))}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground\"\r\n                >\r\n                  {showPassword.new ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"confirmPassword\">Confirm New Password</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"confirmPassword\"\r\n                  type={showPassword.confirm ? 'text' : 'password'}\r\n                  value={passwords.confirmPassword}\r\n                  onChange={(e) => handlePasswordChange('confirmPassword', e.target.value)}\r\n                  placeholder=\"Confirm your new password\"\r\n                  required\r\n                  minLength={8}\r\n                  className=\"pr-10\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowPassword(prev => ({ ...prev, confirm: !prev.confirm }))}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground\"\r\n                >\r\n                  {showPassword.confirm ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {error && (\r\n              <div className=\"text-sm text-destructive bg-destructive/10 p-3 rounded-md\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            <Button \r\n              type=\"submit\" \r\n              className=\"w-full\" \r\n              disabled={isLoading}\r\n            >\r\n              {isLoading ? (\r\n                <>\r\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                  Updating Password...\r\n                </>\r\n              ) : (\r\n                'Reset Password'\r\n              )}\r\n            </Button>\r\n\r\n            <Button \r\n              type=\"button\"\r\n              variant=\"ghost\" \r\n              onClick={() => navigate('/login')}\r\n              className=\"w-full\"\r\n            >\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n              Back to Login\r\n            </Button>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\ScormPlayerPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\ScormStudioPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\ScormUploadPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\TermsOfService.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\UploadCourseImages.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[658,661],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[658,661],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { uploadCourseImages } from '@/utils/uploadCourseImages';\r\n\r\nexport default function UploadCourseImages() {\r\n  const [uploading, setUploading] = useState(false);\r\n  const { toast } = useToast();\r\n\r\n  const handleUpload = async () => {\r\n    setUploading(true);\r\n    try {\r\n      const result = await uploadCourseImages();\r\n      \r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Course images uploaded successfully!\"\r\n      });\r\n      \r\n      console.log('Upload results:', result);\r\n    } catch (error: any) {\r\n      toast({\r\n        title: \"Error\", \r\n        description: `Failed to upload images: ${error.message}`,\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4\">\r\n      <Button onClick={handleUpload} disabled={uploading}>\r\n        {uploading ? 'Uploading...' : 'Upload Course Images'}\r\n      </Button>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\AdminDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\AdminUserAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\Analytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\BetaManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1347,1350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1347,1350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4285,4288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4285,4288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport QATestRunner from '@/components/beta/QATestRunner';\r\nimport BetaOnboarding from '@/components/beta/BetaOnboarding';\r\nimport FeedbackSystem from '@/components/beta/FeedbackSystem';\r\nimport SendBetaUpdate from '@/components/admin/SendBetaUpdate';\r\nimport TestFeedbackSystem from '@/components/admin/TestFeedbackSystem';\r\nimport FeedbackCard from '@/components/admin/FeedbackCard';\r\nimport { Users, MessageSquare, Settings, TestTube, Send, CheckCircle, XCircle, Clock } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\n\r\nconst BetaManagement = () => {\r\n  const { user } = useAuth();\r\n  const [selectedFeedback, setSelectedFeedback] = useState<any>(null);\r\n  const [betaOnboardingOpen, setBetaOnboardingOpen] = useState(false);\r\n\r\n  // Fetch beta users with real-time updates\r\n  const { data: betaUsers, refetch: refetchUsers } = useQuery({\r\n    queryKey: ['beta-users'],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('profiles')\r\n        .select('*')\r\n        .eq('beta_access', true);\r\n      \r\n      if (error) throw error;\r\n      return data || [];\r\n    }\r\n  });\r\n\r\n  // Real-time subscription for beta user changes\r\n  useEffect(() => {\r\n    const channel = supabase\r\n      .channel('beta-users-updates')\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'profiles',\r\n          filter: 'beta_access=eq.true'\r\n        },\r\n        (payload) => {\r\n          console.log('Real-time beta user update:', payload);\r\n          refetchUsers();\r\n          if (payload.eventType === 'INSERT') {\r\n            toast.success('New beta user added!');\r\n          } else if (payload.eventType === 'UPDATE') {\r\n            toast.info('Beta user updated');\r\n          }\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [refetchUsers]);\r\n\r\n  // Fetch feedback submissions with real-time updates\r\n  const { data: feedbackList, refetch: refetchFeedback } = useQuery({\r\n    queryKey: ['beta-feedback'],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from('contact_submissions')\r\n        .select('*')\r\n        .like('category', 'beta_%')\r\n        .order('created_at', { ascending: false });\r\n      \r\n      if (error) throw error;\r\n      return data || [];\r\n    }\r\n  });\r\n\r\n  // Real-time subscription for feedback submissions\r\n  useEffect(() => {\r\n    const channel = supabase\r\n      .channel('beta-feedback-updates')\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'contact_submissions',\r\n          filter: 'category=like.beta_%'\r\n        },\r\n        (payload) => {\r\n          console.log('Real-time feedback update:', payload);\r\n          refetchFeedback();\r\n          toast.success('New beta feedback received!');\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [refetchFeedback]);\r\n\r\n  const grantBetaAccess = async (email: string) => {\r\n    try {\r\n      // First get the user ID from auth.users\r\n      const { data: authData, error: authError } = await supabase\r\n        .from('profiles')\r\n        .select('id')\r\n        .eq('id', user?.id)\r\n        .single();\r\n\r\n      if (authError) throw authError;\r\n\r\n      // Grant beta access\r\n      const { error } = await supabase\r\n        .from('profiles')\r\n        .upsert({\r\n          id: authData.id,\r\n          beta_access: true,\r\n          beta_invite_code: 'ADMIN_GRANTED'\r\n        } as any);\r\n\r\n      if (error) throw error;\r\n      \r\n      toast.success('Beta access granted successfully');\r\n      refetchUsers();\r\n    } catch (error) {\r\n      toast.error('Failed to grant beta access');\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const updateFeedbackStatus = async (feedbackId: string, status: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('contact_submissions')\r\n        .update({ status })\r\n        .eq('id', feedbackId);\r\n\r\n      if (error) throw error;\r\n      \r\n      toast.success('Feedback status updated');\r\n      refetchFeedback();\r\n    } catch (error) {\r\n      toast.error('Failed to update feedback status');\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'resolved':\r\n        return <CheckCircle className=\"w-4 h-4 text-green-600\" />;\r\n      case 'in_progress':\r\n        return <Clock className=\"w-4 h-4 text-blue-600\" />;\r\n      case 'closed':\r\n        return <XCircle className=\"w-4 h-4 text-gray-600\" />;\r\n      default:\r\n        return <MessageSquare className=\"w-4 h-4 text-orange-600\" />;\r\n    }\r\n  };\r\n\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Beta Program Management</h1>\r\n          <p className=\"text-muted-foreground\">Manage beta users, feedback, and platform testing</p>\r\n        </div>\r\n        <Badge variant=\"destructive\" className=\"text-lg px-4 py-2\">\r\n          BETA ADMIN\r\n        </Badge>\r\n      </div>\r\n\r\n      <Tabs defaultValue=\"overview\" className=\"space-y-6\">\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"users\">Beta Users</TabsTrigger>\r\n          <TabsTrigger value=\"feedback\">Feedback</TabsTrigger>\r\n          <TabsTrigger value=\"testing\">QA Testing</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Beta Users</CardTitle>\r\n                <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">{betaUsers?.length || 0}</div>\r\n                <p className=\"text-xs text-muted-foreground\">Active beta testers</p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Feedback Items</CardTitle>\r\n                <MessageSquare className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">{feedbackList?.length || 0}</div>\r\n                <p className=\"text-xs text-muted-foreground\">Total submissions</p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Pending Issues</CardTitle>\r\n                <Clock className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">\r\n                  {feedbackList?.filter(f => f.status === 'new').length || 0}\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground\">Needs attention</p>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Quick Actions</CardTitle>\r\n                <CardDescription>Common beta management tasks</CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <SendBetaUpdate />\r\n                <Button \r\n                  variant=\"outline\" \r\n                  className=\"w-full\"\r\n                  onClick={() => {\r\n                    setBetaOnboardingOpen(true);\r\n                  }}\r\n                >\r\n                  <TestTube className=\"w-4 h-4 mr-2\" />\r\n                  Preview Onboarding Flow\r\n                </Button>\r\n                <BetaOnboarding \r\n                  autoShow={false} \r\n                  forceShow={betaOnboardingOpen}\r\n                  onComplete={() => setBetaOnboardingOpen(false)}\r\n                />\r\n                <TestFeedbackSystem />\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Recent Feedback</CardTitle>\r\n                <CardDescription>Latest submissions from beta users</CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  {feedbackList?.slice(0, 5).map((feedback) => (\r\n                    <div key={feedback.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        {getStatusIcon(feedback.status)}\r\n                        <div>\r\n                          <div className=\"font-medium text-sm\">{feedback.name}</div>\r\n                          <div className=\"text-xs text-muted-foreground truncate max-w-48\">\r\n                            {feedback.message}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <Badge variant=\"outline\" className=\"text-xs\">\r\n                        {feedback.category.replace('beta_', '')}\r\n                      </Badge>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"users\" className=\"space-y-6\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Beta User Management</CardTitle>\r\n              <CardDescription>Manage access and permissions for beta testers</CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-6\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-sm font-medium\">Grant Beta Access</label>\r\n                    <div className=\"flex space-x-2\">\r\n                      <Input placeholder=\"user@example.com\" />\r\n                      <Button onClick={() => grantBetaAccess('')}>\r\n                        Grant Access\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <h3 className=\"font-medium\">Current Beta Users</h3>\r\n                  <div className=\"space-y-2\">\r\n                    {betaUsers?.map((user) => (\r\n                      <div key={user.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                            <Users className=\"w-4 h-4 text-primary\" />\r\n                          </div>\r\n                          <div>\r\n                            <div className=\"font-medium\">{user.full_name || 'Beta User'}</div>\r\n                            <div className=\"text-sm text-muted-foreground\">{user.id}</div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-2\">\r\n                          <Badge variant=\"outline\">{user.beta_invite_code || 'MANUAL'}</Badge>\r\n                          {user.onboarding_completed && (\r\n                            <Badge variant=\"secondary\">Onboarded</Badge>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"feedback\" className=\"space-y-6\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Beta Feedback Management</CardTitle>\r\n              <CardDescription>Review and respond to feedback from beta users</CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {feedbackList?.map((feedback) => (\r\n                  <FeedbackCard\r\n                    key={feedback.id}\r\n                    feedback={feedback}\r\n                    onStatusUpdate={updateFeedbackStatus}\r\n                  />\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"testing\" className=\"space-y-6\">\r\n          <QATestRunner />\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BetaManagement;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\CourseManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1202,1205],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1202,1205],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2757,2760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2757,2760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Plus, Edit2, Trash2, RefreshCw } from 'lucide-react';\r\nimport { useCourses } from '@/hooks/useCourses';\r\nimport { useUserRole } from '@/hooks/useUserRole';\r\nimport { useQueryClient } from '@tanstack/react-query';\r\n\r\nconst CourseManager = () => {\r\n  const { t } = useTranslation();\r\n  const { isAdmin, isLoading: roleLoading } = useUserRole();\r\n  const { courses, isLoading, error, createCourse, updateCourse, deleteCourse, refetch } = useCourses();\r\n  const navigate = useNavigate();\r\n  const [editingCourse, setEditingCourse] = useState<any>(null);\r\n  const [isCreating, setIsCreating] = useState(false);\r\n  const [isRefreshing, setIsRefreshing] = useState(false);\r\n  const queryClient = useQueryClient();\r\n\r\n  // Force refresh courses cache on component mount to get latest slug data\r\n  useEffect(() => {\r\n    queryClient.invalidateQueries({ queryKey: ['courses'] });\r\n  }, [queryClient]);\r\n\r\n  const handleRefresh = async () => {\r\n    setIsRefreshing(true);\r\n    await queryClient.invalidateQueries({ queryKey: ['courses'] });\r\n    await refetch();\r\n    setIsRefreshing(false);\r\n  };\r\n\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    description: '',\r\n    slug: '',\r\n    instructor_name: '',\r\n    difficulty_level: 'beginner',\r\n    duration_minutes: 0,\r\n    featured: false,\r\n    status: 'draft' as 'draft' | 'published' | 'archived'\r\n  });\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      if (editingCourse) {\r\n        await updateCourse({ id: editingCourse.id, ...formData });\r\n      } else {\r\n        await createCourse(formData);\r\n      }\r\n      \r\n      resetForm();\r\n    } catch (error) {\r\n      console.error('Error saving course:', error);\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      title: '',\r\n      description: '',\r\n      slug: '',\r\n      instructor_name: '',\r\n      difficulty_level: 'beginner',\r\n      duration_minutes: 0,\r\n      featured: false,\r\n      status: 'draft'\r\n    });\r\n    setEditingCourse(null);\r\n    setIsCreating(false);\r\n  };\r\n\r\n  const handleEdit = (course: any) => {\r\n    setEditingCourse(course);\r\n    setFormData({\r\n      title: course.title || '',\r\n      description: course.description || '',\r\n      slug: course.slug || '',\r\n      instructor_name: course.instructor_name || '',\r\n      difficulty_level: course.difficulty_level || 'beginner',\r\n      duration_minutes: course.duration_minutes || 0,\r\n      featured: course.featured || false,\r\n      status: course.status || 'draft'\r\n    });\r\n    setIsCreating(true);\r\n  };\r\n\r\n  const handleDelete = async (courseId: string) => {\r\n    if (window.confirm('Are you sure you want to delete this course?')) {\r\n      try {\r\n        await deleteCourse(courseId);\r\n      } catch (error) {\r\n        console.error('Error deleting course:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  if (roleLoading) {\r\n    return <div className=\"flex items-center justify-center p-4 md:p-8\">Loading...</div>;\r\n  }\r\n\r\n  if (!isAdmin) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-4 md:p-8\">\r\n        <div className=\"text-center\">\r\n          <h2 className=\"text-lg md:text-xl font-semibold text-gray-900\">Access Denied</h2>\r\n          <p className=\"text-sm md:text-base text-gray-600\">You don't have permission to access this page.</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isLoading) {\r\n    return <div className=\"flex items-center justify-center p-4 md:p-8\">Loading courses...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-4 md:p-8\">\r\n        <div className=\"text-center\">\r\n          <h2 className=\"text-lg md:text-xl font-semibold text-red-600\">Error</h2>\r\n          <p className=\"text-sm md:text-base text-gray-600\">{error.message || 'Failed to load courses'}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-4 md:p-6 space-y-4 md:space-y-6\">\r\n      <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl md:text-3xl font-bold text-gray-900\">{t('admin.courses.title')}</h1>\r\n          <p className=\"text-sm md:text-base text-gray-600\">{t('admin.courses.description')}</p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button \r\n            variant=\"outline\" \r\n            onClick={handleRefresh}\r\n            disabled={isRefreshing}\r\n            className=\"w-full sm:w-auto min-h-[44px] touch-manipulation\"\r\n          >\r\n            <RefreshCw className={`h-4 w-4 mr-2 ${isRefreshing ? 'animate-spin' : ''}`} />\r\n            Refresh\r\n          </Button>\r\n          <Button onClick={() => setIsCreating(true)} className=\"w-full sm:w-auto min-h-[44px] touch-manipulation\">\r\n            <Plus className=\"h-4 w-4 mr-2\" />\r\n            New Course\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {isCreating && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg md:text-xl\">{editingCourse ? 'Edit Course' : 'Create New Course'}</CardTitle>\r\n            <CardDescription className=\"text-sm md:text-base\">\r\n              {editingCourse ? 'Update course information' : 'Add a new course to the platform'}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <form onSubmit={handleSubmit} className=\"space-y-4 md:space-y-6\">\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <Label htmlFor=\"title\" className=\"text-sm md:text-base\">Title</Label>\r\n                  <Input\r\n                    id=\"title\"\r\n                    value={formData.title}\r\n                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                    required\r\n                    className=\"mt-1 min-h-[44px] text-sm md:text-base\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"slug\" className=\"text-sm md:text-base\">Slug</Label>\r\n                  <Input\r\n                    id=\"slug\"\r\n                    value={formData.slug}\r\n                    onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\r\n                    placeholder=\"course-url-slug\"\r\n                    required\r\n                    className=\"mt-1 min-h-[44px] text-sm md:text-base\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <Label htmlFor=\"description\" className=\"text-sm md:text-base\">Description</Label>\r\n                <Textarea\r\n                  id=\"description\"\r\n                  value={formData.description}\r\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                  rows={3}\r\n                  className=\"mt-1 text-sm md:text-base\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <Label htmlFor=\"instructor\" className=\"text-sm md:text-base\">Instructor</Label>\r\n                  <Input\r\n                    id=\"instructor\"\r\n                    value={formData.instructor_name}\r\n                    onChange={(e) => setFormData({ ...formData, instructor_name: e.target.value })}\r\n                    className=\"mt-1 min-h-[44px] text-sm md:text-base\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"difficulty\" className=\"text-sm md:text-base\">Difficulty</Label>\r\n                  <Select value={formData.difficulty_level} onValueChange={(value) => setFormData({ ...formData, difficulty_level: value })}>\r\n                    <SelectTrigger className=\"mt-1 min-h-[44px] text-sm md:text-base\">\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"beginner\">Beginner</SelectItem>\r\n                      <SelectItem value=\"intermediate\">Intermediate</SelectItem>\r\n                      <SelectItem value=\"advanced\">Advanced</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"duration\" className=\"text-sm md:text-base\">Duration (minutes)</Label>\r\n                  <Input\r\n                    id=\"duration\"\r\n                    type=\"number\"\r\n                    value={formData.duration_minutes}\r\n                    onChange={(e) => setFormData({ ...formData, duration_minutes: parseInt(e.target.value) || 0 })}\r\n                    className=\"mt-1 min-h-[44px] text-sm md:text-base\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <Switch\r\n                    id=\"featured\"\r\n                    checked={formData.featured}\r\n                    onCheckedChange={(checked) => setFormData({ ...formData, featured: checked })}\r\n                  />\r\n                  <Label htmlFor=\"featured\" className=\"text-sm md:text-base\">Featured Course</Label>\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"status\" className=\"text-sm md:text-base\">Status</Label>\r\n                  <Select value={formData.status} onValueChange={(value: 'draft' | 'published' | 'archived') => setFormData({ ...formData, status: value })}>\r\n                    <SelectTrigger className=\"mt-1 min-h-[44px] text-sm md:text-base\">\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"draft\">Draft</SelectItem>\r\n                      <SelectItem value=\"published\">Published</SelectItem>\r\n                      <SelectItem value=\"archived\">Archived</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col sm:flex-row sm:justify-end gap-2 sm:space-x-2 pt-4\">\r\n                <Button type=\"button\" variant=\"outline\" onClick={resetForm} className=\"min-h-[44px] text-sm md:text-base touch-manipulation\">\r\n                  Cancel\r\n                </Button>\r\n                <Button type=\"submit\" className=\"min-h-[44px] text-sm md:text-base touch-manipulation\">\r\n                  {editingCourse ? 'Update Course' : 'Create Course'}\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-6\">\r\n        {courses.map((course) => (\r\n          <Card key={course.id} className=\"flex flex-col\">\r\n            <CardHeader className=\"pb-3\">\r\n              <div className=\"flex justify-between items-start gap-2\">\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <CardTitle className=\"text-base md:text-lg leading-tight break-words\">{course.title}</CardTitle>\r\n                  <CardDescription className=\"text-xs md:text-sm mt-1 line-clamp-2\">{course.description}</CardDescription>\r\n                </div>\r\n                <div className=\"flex space-x-1 flex-shrink-0\">\r\n                  <Button size=\"sm\" variant=\"ghost\" onClick={() => handleEdit(course)} className=\"h-8 w-8 p-0 touch-manipulation\">\r\n                    <Edit2 className=\"h-3 w-3\" />\r\n                  </Button>\r\n                  <Button size=\"sm\" variant=\"ghost\" onClick={() => handleDelete(course.id)} className=\"h-8 w-8 p-0 touch-manipulation\">\r\n                    <Trash2 className=\"h-3 w-3\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"pt-0 flex-1 flex flex-col\">\r\n              <div className=\"space-y-2 flex-1\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <span className=\"text-xs md:text-sm text-gray-600\">Status:</span>\r\n                  <Badge variant={course.status === 'published' ? 'default' : 'secondary'} className=\"text-xs\">\r\n                    {course.status}\r\n                  </Badge>\r\n                </div>\r\n                {course.instructor_name && (\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"text-xs md:text-sm text-gray-600\">Instructor:</span>\r\n                    <span className=\"text-xs md:text-sm truncate ml-2\">{course.instructor_name}</span>\r\n                  </div>\r\n                )}\r\n                {course.duration_minutes && (\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"text-xs md:text-sm text-gray-600\">Duration:</span>\r\n                    <span className=\"text-xs md:text-sm\">{course.duration_minutes} mins</span>\r\n                  </div>\r\n                )}\r\n                {course.featured && (\r\n                  <Badge variant=\"outline\" className=\"w-full justify-center text-xs\">\r\n                    Featured\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n              <div className=\"pt-3 space-y-2\">\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\" \r\n                  className=\"w-full min-h-[36px] text-xs md:text-sm touch-manipulation\"\r\n                  onClick={() => {\r\n                    if (!course.slug) {\r\n                      alert('Course slug is missing. Please edit the course and add a slug first.');\r\n                      return;\r\n                    }\r\n                    navigate(`/dashboard/admin/courses/${course.slug}/modules`);\r\n                  }}\r\n                >\r\n                  Manage Modules\r\n                </Button>\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\" \r\n                  className=\"w-full min-h-[36px] text-xs md:text-sm touch-manipulation\"\r\n                  onClick={() => {\r\n                    if (!course.slug) {\r\n                      alert('Course slug is missing. Please edit the course and add a slug first.');\r\n                      return;\r\n                    }\r\n                    navigate(`/dashboard/admin/courses/${course.slug}/lessons`);\r\n                  }}\r\n                >\r\n                  Manage Lessons\r\n                </Button>\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\" \r\n                  className=\"w-full min-h-[36px] text-xs md:text-sm touch-manipulation\"\r\n                  onClick={() => {\r\n                    if (!course.slug) {\r\n                      alert('Course slug is missing. Please edit the course and add a slug first.');\r\n                      return;\r\n                    }\r\n                    navigate(`/dashboard/learner/course/${course.slug}`);\r\n                  }}\r\n                >\r\n                  Preview Course\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n\r\n      {courses.length === 0 && (\r\n        <div className=\"text-center py-8 md:py-12\">\r\n          <h3 className=\"text-base md:text-lg font-medium text-gray-900 mb-2\">No courses yet</h3>\r\n          <p className=\"text-sm md:text-base text-gray-600 mb-4\">Get started by creating your first course.</p>\r\n          <Button onClick={() => setIsCreating(true)} className=\"min-h-[44px] text-sm md:text-base touch-manipulation\">\r\n            <Plus className=\"h-4 w-4 mr-2\" />\r\n            Create First Course\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CourseManager;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\InstructorConsole.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\ModuleManagerPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\OrganizationDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":109,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4077,4080],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4077,4080],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useParams, Link } from 'react-router-dom';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { \r\n  ArrowLeft, \r\n  Building2, \r\n  Users, \r\n  Calendar,\r\n  Settings,\r\n  Mail,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  Clock\r\n} from 'lucide-react';\r\nimport { useOrganization } from '@/hooks/useOrganization';\r\nimport { OrganizationActionsDropdown } from '@/components/admin/OrganizationActionsDropdown';\r\nimport { format } from 'date-fns';\r\n\r\nexport default function OrganizationDetail() {\r\n  const { id } = useParams<{ id: string }>();\r\n  const { data: organization, isLoading, error } = useOrganization(id || '');\r\n\r\n  const getTierVariant = (tier: string) => {\r\n    switch (tier) {\r\n      case 'basic': return 'secondary';\r\n      case 'standard': return 'default';\r\n      case 'premium': return 'destructive';\r\n      default: return 'outline';\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'active': return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\r\n      case 'suspended': return <AlertCircle className=\"h-4 w-4 text-orange-600\" />;\r\n      case 'inactive': return <Clock className=\"h-4 w-4 text-gray-600\" />;\r\n      default: return <AlertCircle className=\"h-4 w-4 text-gray-600\" />;\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">Loading organization...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!id || error || !organization) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <h2 className=\"text-lg font-semibold mb-2\">Organization not found</h2>\r\n          <p className=\"text-muted-foreground mb-4\">The organization you're looking for doesn't exist.</p>\r\n          <Button asChild>\r\n            <Link to=\"/dashboard/admin/organizations\">\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              Back to Organizations\r\n            </Link>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto py-6 space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Button variant=\"outline\" size=\"sm\" asChild>\r\n            <Link to=\"/dashboard/admin/organizations\">\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              Back\r\n            </Link>\r\n          </Button>\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold\">{organization.name}</h1>\r\n            <p className=\"text-muted-foreground\">Organization Details</p>\r\n          </div>\r\n        </div>\r\n        <OrganizationActionsDropdown organization={organization} />\r\n      </div>\r\n\r\n      {/* Status and Key Info Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Status</CardTitle>\r\n            {getStatusIcon(organization.status)}\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold capitalize\">{organization.status}</div>\r\n            {organization.suspended_at && (\r\n              <p className=\"text-xs text-muted-foreground mt-1\">\r\n                Suspended {format(new Date(organization.suspended_at), 'MMM d, yyyy')}\r\n              </p>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Subscription</CardTitle>\r\n            <Settings className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Badge variant={getTierVariant(organization.plan) as any} className=\"text-sm\">\r\n              {organization.plan.toUpperCase()}\r\n            </Badge>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Seat Usage</CardTitle>\r\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {organization.seats_used}/{organization.seat_cap}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {Math.round((organization.seats_used / organization.seat_cap) * 100)}% utilized\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Instructor Usage</CardTitle>\r\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {organization.instructors_used || 0}/{organization.instructor_limit || 1}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {Math.round(((organization.instructors_used || 0) / (organization.instructor_limit || 1)) * 100)}% utilized\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Created</CardTitle>\r\n            <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-lg font-semibold\">\r\n              {format(new Date(organization.created_at), 'MMM d, yyyy')}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {format(new Date(organization.created_at), 'h:mm a')}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Detailed Information */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Organization Details */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Building2 className=\"h-5 w-5\" />\r\n              Organization Information\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Organization Name</label>\r\n              <p className=\"text-lg font-semibold\">{organization.name}</p>\r\n            </div>\r\n            \r\n            {organization.description && (\r\n              <div>\r\n                <label className=\"text-sm font-medium text-muted-foreground\">Description</label>\r\n                <p className=\"text-sm\">{organization.description}</p>\r\n              </div>\r\n            )}\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Owner ID</label>\r\n              <p className=\"text-sm font-mono\">{organization.owner_id}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium text-muted-foreground\">Organization ID</label>\r\n              <p className=\"text-sm font-mono\">{organization.id}</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Suspension Details */}\r\n        {organization.status === 'suspended' && organization.suspended_reason && (\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2 text-orange-600\">\r\n                <AlertCircle className=\"h-5 w-5\" />\r\n                Suspension Details\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"text-sm font-medium text-muted-foreground\">Reason</label>\r\n                <p className=\"text-sm\">{organization.suspended_reason}</p>\r\n              </div>\r\n              \r\n              {organization.suspended_at && (\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-muted-foreground\">Suspended On</label>\r\n                  <p className=\"text-sm\">{format(new Date(organization.suspended_at), 'MMMM d, yyyy h:mm a')}</p>\r\n                </div>\r\n              )}\r\n\r\n              {organization.suspended_by && (\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-muted-foreground\">Suspended By</label>\r\n                  <p className=\"text-sm font-mono\">{organization.suspended_by}</p>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Quick Actions */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Quick Actions</CardTitle>\r\n            <CardDescription>Common administrative actions for this organization</CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n            <Button variant=\"outline\" className=\"w-full justify-start\" asChild>\r\n              <Link to={`/dashboard/admin/organizations/${organization.id}/members`}>\r\n                <Users className=\"h-4 w-4 mr-2\" />\r\n                Manage Members\r\n              </Link>\r\n            </Button>\r\n            \r\n            <Button variant=\"outline\" className=\"w-full justify-start\" asChild>\r\n              <Link to={`/dashboard/admin/organizations/${organization.id}/analytics`}>\r\n                <Calendar className=\"h-4 w-4 mr-2\" />\r\n                View Analytics\r\n              </Link>\r\n            </Button>\r\n            \r\n            <Button variant=\"outline\" className=\"w-full justify-start\">\r\n              <Mail className=\"h-4 w-4 mr-2\" />\r\n              Send Notification\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\OrganizationManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5896,5899],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5896,5899],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6063,6066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6063,6066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Input } from '@/components/ui/input';\r\nimport { \r\n  Table, \r\n  TableBody, \r\n  TableCell, \r\n  TableHead, \r\n  TableHeader, \r\n  TableRow \r\n} from '@/components/ui/table';\r\nimport { \r\n  Building2, \r\n  Users, \r\n  Search, \r\n  Eye, \r\n  MoreHorizontal,\r\n  Calendar,\r\n  TrendingUp\r\n} from 'lucide-react';\r\nimport { useAdminOrganizations } from '@/hooks/useAdminOrganizations';\r\nimport { OrganizationActionsDropdown } from '@/components/admin/OrganizationActionsDropdown';\r\nimport { format } from 'date-fns';\r\nimport { Link } from 'react-router-dom';\r\n\r\nexport default function OrganizationManagement() {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const { organizations, isLoading } = useAdminOrganizations();\r\n\r\n  console.log('ðŸ” OrganizationManagement Component - Organizations:', organizations, 'Loading:', isLoading);\r\n\r\n  const filteredOrganizations = organizations?.filter(org =>\r\n    org.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n    org.description?.toLowerCase().includes(searchQuery.toLowerCase())\r\n  ) || [];\r\n\r\n  const getTierVariant = (tier: string) => {\r\n    switch (tier) {\r\n      case 'basic': return 'secondary';\r\n      case 'standard': return 'default';\r\n      case 'premium': return 'destructive';\r\n      default: return 'outline';\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">Loading organizations...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto py-6 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Organization Management</h1>\r\n          <p className=\"text-muted-foreground\">Manage and monitor all organizations</p>\r\n        </div>\r\n        <Badge variant=\"outline\" className=\"text-lg px-3 py-1\">\r\n          {organizations?.length || 0} Organizations\r\n        </Badge>\r\n      </div>\r\n\r\n      {/* Summary Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Organizations</CardTitle>\r\n            <Building2 className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{organizations?.length || 0}</div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Students</CardTitle>\r\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {organizations?.reduce((sum, org) => sum + org.seats_used, 0) || 0}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Seat Utilization</CardTitle>\r\n            <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {organizations && organizations.length > 0\r\n                ? Math.round(\r\n                     (organizations.reduce((sum, org) => sum + org.seats_used, 0) /\r\n                      organizations.reduce((sum, org) => sum + org.seat_cap, 0)) * 100\r\n                  )\r\n                : 0}%\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Search and Filters */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"relative flex-1\">\r\n              <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Search organizations...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      {/* Organizations Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>All Organizations</CardTitle>\r\n          <CardDescription>\r\n            Complete list of organizations and their details\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead>Organization</TableHead>\r\n                <TableHead>Owner</TableHead>\r\n                <TableHead>Subscription</TableHead>\r\n                <TableHead>Seats</TableHead>\r\n                <TableHead>Created</TableHead>\r\n                <TableHead>Actions</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {filteredOrganizations.map((org) => (\r\n                <TableRow key={org.id}>\r\n                  <TableCell>\r\n                    <div>\r\n                      <div className=\"font-medium\">{org.name}</div>\r\n                      {org.description && (\r\n                        <div className=\"text-sm text-muted-foreground\">\r\n                          {org.description}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <div className=\"text-sm\">{(org as any).owner_name || org.owner_id}</div>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Badge variant={getTierVariant(org.plan) as any}>\r\n                      {org.plan.toUpperCase()}\r\n                    </Badge>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <div className=\"flex items-center\">\r\n                      <Users className=\"h-4 w-4 mr-1\" />\r\n                      <span>{org.seats_used}/{org.seat_cap}</span>\r\n                    </div>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <div className=\"flex items-center text-sm text-muted-foreground\">\r\n                      <Calendar className=\"h-4 w-4 mr-1\" />\r\n                      {format(new Date(org.created_at), 'MMM d, yyyy')}\r\n                    </div>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Button\r\n                        size=\"sm\"\r\n                        variant=\"outline\"\r\n                        asChild\r\n                      >\r\n                        <Link to={`/dashboard/admin/organizations/${org.id}`}>\r\n                          <Eye className=\"h-4 w-4 mr-1\" />\r\n                          View\r\n                        </Link>\r\n                      </Button>\r\n                      <OrganizationActionsDropdown organization={org} />\r\n                    </div>\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n            </TableBody>\r\n          </Table>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\ThresholdManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\admin\\UserManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\auth\\EnhancedAuth.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'validateInviteCode'. Either include it or remove the dependency array.","line":48,"column":6,"nodeType":"ArrayExpression","endLine":48,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [location.search, validateInviteCode]","fix":{"range":[1998,2015],"text":"[location.search, validateInviteCode]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useLocation, Link } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { GraduationCap, Users, BookOpen, Eye, EyeOff } from 'lucide-react';\r\nimport type { Role } from '@/types/user';\r\n\r\ninterface InviteLinkData {\r\n  organization_id: string;\r\n  organization_name: string;\r\n  invited_by: string;\r\n  invitation_code: string;\r\n}\r\n\r\nexport default function EnhancedAuth() {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [fullName, setFullName] = useState('');\r\n  const [displayName, setDisplayName] = useState('');\r\n  const [selectedRole, setSelectedRole] = useState<Role>('learner');\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [inviteData, setInviteData] = useState<InviteLinkData | null>(null);\r\n  \r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { toast } = useToast();\r\n  const { user } = useAuth();\r\n\r\n  // Check for invite link in URL params\r\n  useEffect(() => {\r\n    const searchParams = new URLSearchParams(location.search);\r\n    const inviteCode = searchParams.get('invite');\r\n    \r\n    if (inviteCode) {\r\n      // Validate invite code and get organization info\r\n      validateInviteCode(inviteCode);\r\n    }\r\n  }, [location.search]);\r\n\r\n  // Redirect authenticated users\r\n  useEffect(() => {\r\n    if (user) {\r\n      navigate('/dashboard');\r\n    }\r\n  }, [user, navigate]);\r\n\r\n  const validateInviteCode = async (code: string) => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('org_invites')\r\n        .select(`\r\n          org_id,\r\n          code,\r\n          created_by,\r\n          organizations (name)\r\n        `)\r\n        .eq('code', code)\r\n        .eq('status', 'pending')\r\n        .gt('expires_at', new Date().toISOString())\r\n        .single();\r\n\r\n      if (error || !data) {\r\n        toast({\r\n          title: \"Invalid Invite\",\r\n          description: \"This invitation link is invalid or has expired.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return;\r\n      }\r\n\r\n      setInviteData({\r\n        organization_id: data.org_id,\r\n        organization_name: data.organizations?.name || 'Unknown Organization',\r\n        invited_by: data.created_by,\r\n        invitation_code: code\r\n      });\r\n      \r\n      // Auto-set role to student for invited users\r\n      setSelectedRole('learner');\r\n      \r\n      toast({\r\n        title: \"Invitation Found!\",\r\n        description: `You've been invited to join ${data.organizations?.name}`,\r\n      });\r\n    } catch (error) {\r\n      console.error('Error validating invite code:', error);\r\n    }\r\n  };\r\n\r\n  const handleSignIn = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const { error } = await supabase.auth.signInWithPassword({\r\n        email,\r\n        password,\r\n      });\r\n\r\n      if (error) {\r\n        if (error.message === 'Email not confirmed') {\r\n          toast({\r\n            title: \"Email Not Confirmed\",\r\n            description: \"Please check your email and click the confirmation link before signing in.\",\r\n            variant: \"destructive\"\r\n          });\r\n        } else {\r\n          toast({\r\n            title: \"Sign In Failed\",\r\n            description: error.message,\r\n            variant: \"destructive\"\r\n          });\r\n        }\r\n        return;\r\n      }\r\n\r\n      toast({\r\n        title: \"Welcome back!\",\r\n        description: \"You have been signed in successfully.\",\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"An unexpected error occurred. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSignUp = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const redirectUrl = `${window.location.origin}/auth/callback${inviteData ? `?invite=${inviteData.invitation_code}` : ''}`;\r\n      \r\n      const { error } = await supabase.auth.signUp({\r\n        email,\r\n        password,\r\n        options: {\r\n          emailRedirectTo: redirectUrl,\r\n          data: {\r\n            full_name: fullName,\r\n            display_name: displayName,\r\n            pending_role: selectedRole,\r\n            invitation_code: inviteData?.invitation_code || null\r\n          }\r\n        }\r\n      });\r\n\r\n      if (error) {\r\n        toast({\r\n          title: \"Sign Up Failed\",\r\n          description: error.message,\r\n          variant: \"destructive\"\r\n        });\r\n        return;\r\n      }\r\n\r\n      toast({\r\n        title: \"Check Your Email\",\r\n        description: \"We sent you a confirmation email. Please click the link to verify your account.\",\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"An unexpected error occurred. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const roleOptions = [\r\n    {\r\n      value: 'learner' as Role,\r\n      title: 'Student/Learner',\r\n      description: 'I want to learn and take courses',\r\n      icon: GraduationCap,\r\n      color: 'bg-blue-500'\r\n    },\r\n    {\r\n      value: 'instructor' as Role,\r\n      title: 'Instructor/Parent',\r\n      description: 'I want to teach or manage students',\r\n      icon: Users,\r\n      color: 'bg-green-500'\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <Card className=\"w-full max-w-md\">\r\n        <CardHeader className=\"text-center\">\r\n          <div className=\"flex items-center justify-center mb-4\">\r\n            <BookOpen className=\"h-8 w-8 text-primary mr-2\" />\r\n            <h1 className=\"text-2xl font-bold\">FPK University</h1>\r\n          </div>\r\n          \r\n          {inviteData && (\r\n            <div className=\"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n              <div className=\"flex items-center justify-center mb-2\">\r\n                <Users className=\"h-4 w-4 text-blue-600 mr-2\" />\r\n                <Badge variant=\"secondary\">Organization Invite</Badge>\r\n              </div>\r\n              <p className=\"text-sm text-blue-800\">\r\n                You're invited to join <strong>{inviteData.organization_name}</strong>\r\n              </p>\r\n            </div>\r\n          )}\r\n        </CardHeader>\r\n\r\n        <CardContent>\r\n          <Tabs defaultValue=\"signin\" className=\"w-full\">\r\n            <TabsList className=\"grid w-full grid-cols-2\">\r\n              <TabsTrigger value=\"signin\">Sign In</TabsTrigger>\r\n              <TabsTrigger value=\"signup\">Sign Up</TabsTrigger>\r\n            </TabsList>\r\n\r\n            <TabsContent value=\"signin\">\r\n              <form onSubmit={handleSignIn} className=\"space-y-4\">\r\n                <CardHeader className=\"px-0\">\r\n                  <CardTitle>Welcome Back</CardTitle>\r\n                  <CardDescription>\r\n                    Sign in to your FPK University account\r\n                  </CardDescription>\r\n                </CardHeader>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <div>\r\n                    <Label htmlFor=\"signin-email\">Email</Label>\r\n                    <Input\r\n                      id=\"signin-email\"\r\n                      type=\"email\"\r\n                      value={email}\r\n                      onChange={(e) => setEmail(e.target.value)}\r\n                      placeholder=\"Enter your email\"\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <Label htmlFor=\"signin-password\">Password</Label>\r\n                    <div className=\"relative\">\r\n                      <Input\r\n                        id=\"signin-password\"\r\n                        type={showPassword ? \"text\" : \"password\"}\r\n                        value={password}\r\n                        onChange={(e) => setPassword(e.target.value)}\r\n                        placeholder=\"Enter your password\"\r\n                        required\r\n                      />\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"absolute right-0 top-0 h-full px-3\"\r\n                        onClick={() => setShowPassword(!showPassword)}\r\n                      >\r\n                        {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n                    {isLoading ? 'Signing In...' : 'Sign In'}\r\n                  </Button>\r\n                </div>\r\n              </form>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"signup\">\r\n              <form onSubmit={handleSignUp} className=\"space-y-4\">\r\n                <CardHeader className=\"px-0\">\r\n                  <CardTitle>Create Account</CardTitle>\r\n                  <CardDescription>\r\n                    {inviteData \r\n                      ? `Join ${inviteData.organization_name} on FPK University`\r\n                      : 'Get started with FPK University'\r\n                    }\r\n                  </CardDescription>\r\n                </CardHeader>\r\n\r\n                <div className=\"space-y-4\">\r\n                  {!inviteData && (\r\n                    <>\r\n                      <div>\r\n                        <Label>I am a...</Label>\r\n                        <RadioGroup\r\n                          value={selectedRole}\r\n                          onValueChange={(value) => setSelectedRole(value as Role)}\r\n                          className=\"mt-2\"\r\n                        >\r\n                          {roleOptions.map((option) => {\r\n                            const Icon = option.icon;\r\n                            return (\r\n                              <div key={option.value} className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50\">\r\n                                <RadioGroupItem value={option.value} id={option.value} />\r\n                                <div className={`p-2 rounded-md ${option.color} text-white`}>\r\n                                  <Icon className=\"h-4 w-4\" />\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                  <Label htmlFor={option.value} className=\"cursor-pointer font-medium\">\r\n                                    {option.title}\r\n                                  </Label>\r\n                                  <p className=\"text-sm text-gray-600\">{option.description}</p>\r\n                                </div>\r\n                              </div>\r\n                            );\r\n                          })}\r\n                        </RadioGroup>\r\n                      </div>\r\n                      <Separator />\r\n                    </>\r\n                  )}\r\n\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label htmlFor=\"fullName\">Full Name</Label>\r\n                      <Input\r\n                        id=\"fullName\"\r\n                        type=\"text\"\r\n                        value={fullName}\r\n                        onChange={(e) => setFullName(e.target.value)}\r\n                        placeholder=\"John Doe\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <Label htmlFor=\"displayName\">Display Name</Label>\r\n                      <Input\r\n                        id=\"displayName\"\r\n                        type=\"text\"\r\n                        value={displayName}\r\n                        onChange={(e) => setDisplayName(e.target.value)}\r\n                        placeholder=\"John\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <Label htmlFor=\"signup-email\">Email</Label>\r\n                    <Input\r\n                      id=\"signup-email\"\r\n                      type=\"email\"\r\n                      value={email}\r\n                      onChange={(e) => setEmail(e.target.value)}\r\n                      placeholder=\"Enter your email\"\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <Label htmlFor=\"signup-password\">Password</Label>\r\n                    <div className=\"relative\">\r\n                      <Input\r\n                        id=\"signup-password\"\r\n                        type={showPassword ? \"text\" : \"password\"}\r\n                        value={password}\r\n                        onChange={(e) => setPassword(e.target.value)}\r\n                        placeholder=\"Create a password\"\r\n                        required\r\n                        minLength={6}\r\n                      />\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"absolute right-0 top-0 h-full px-3\"\r\n                        onClick={() => setShowPassword(!showPassword)}\r\n                      >\r\n                        {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n                      </Button>\r\n                    </div>\r\n                    <p className=\"text-xs text-gray-600 mt-1\">\r\n                      Password must be at least 6 characters long\r\n                    </p>\r\n                  </div>\r\n\r\n                  <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n                    {isLoading ? 'Creating Account...' : 'Create Account'}\r\n                  </Button>\r\n                </div>\r\n              </form>\r\n            </TabsContent>\r\n          </Tabs>\r\n\r\n          <div className=\"mt-6 text-center text-sm\">\r\n            <Link to=\"/\" className=\"text-primary hover:underline\">\r\n              â† Back to Home\r\n            </Link>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\EmpoweringLearningHandwritingCoursePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\EmpoweringLearningNumeracyCoursePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\EmpoweringLearningReadingCoursePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\EmpoweringLearningSpellingCoursePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\EmpoweringLearningStatePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\GeometryCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3036,3039],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3036,3039],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { useInteractiveCourseProgress } from '@/hooks/useInteractiveCourseProgress';\r\nimport { useCourseEnrollment } from '@/hooks/useCourseEnrollment';\r\nimport { useInteractiveCourseEnrollmentBridge } from '@/hooks/useInteractiveCourseEnrollmentBridge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight, X } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport CourseOverviewVideo from '@/components/course/CourseOverviewVideo';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\nimport { AdditionalResourcesSection } from '@/components/course/resources/AdditionalResourcesSection';\r\nimport { StudentGuidesAccordion } from '@/components/course/resources/StudentGuidesAccordion';\r\nimport { EnhancedCourseInfoAccordion } from '@/components/course/resources/EnhancedCourseInfoAccordion';\r\n\r\n// Import background image\r\nimport interactiveGeometryBg from '@/assets/interactive-geometry-fundamentals-bg.jpg';\r\n\r\n// Import lesson components\r\nimport { PointsLinesPlanesMicroLesson } from '@/components/micro-lessons/points-lines-planes/PointsLinesPlanesMicroLesson';\r\nimport { TriangleMicroLesson } from '@/components/micro-lessons/triangles/TriangleMicroLesson';\r\nimport { QuadrilateralsMicroLesson } from '@/components/micro-lessons/quadrilaterals/QuadrilateralsMicroLesson';\r\nimport { CirclesMicroLesson } from '@/components/micro-lessons/circles/CirclesMicroLesson';\r\nimport { TransformationsMicroLesson } from '@/components/micro-lessons/transformations/TransformationsMicroLesson';\r\nimport { ThreeDShapesMicroLesson } from '@/components/micro-lessons/3d-shapes/ThreeDShapesMicroLesson';\r\nimport { CoordinateGeometryMicroLesson } from '@/components/micro-lessons/coordinate-geometry/CoordinateGeometryMicroLesson';\r\nimport { VectorsMicroLesson } from '@/components/micro-lessons/vectors/VectorsMicroLesson';\r\nimport { GeometryReviewLesson } from '@/components/course/geometry-lessons/GeometryReviewLesson';\r\nimport { GeometryReviewAndRecap } from '@/components/course/geometry-lessons/GeometryReviewAndRecap';\r\nimport { GeometryCompletionLesson } from '@/components/course/geometry-lessons/GeometryCompletionLesson';\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\n// Moved outside component to prevent recreation on every render\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"Points, Lines, and Planes\", description: \"Learn the fundamental building blocks of geometry\", component: PointsLinesPlanesMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 2, title: \"Triangles\", description: \"Explore triangle types, properties, and theorems\", component: TriangleMicroLesson, unit: \"Unit 2: Polygons\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 3, title: \"Quadrilaterals\", description: \"Study squares, rectangles, parallelograms, and more\", component: QuadrilateralsMicroLesson, unit: \"Unit 2: Polygons\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 4, title: \"Circles\", description: \"Master circle properties, parts, and calculations\", component: CirclesMicroLesson, unit: \"Unit 3: Circles\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 5, title: \"Transformations\", description: \"Learn about reflection, rotation, translation, and scaling\", component: TransformationsMicroLesson, unit: \"Unit 5: Transformations\", unitColor: \"bg-red-100 text-red-700\" },\r\n  { id: 6, title: \"3D Shapes and Volume\", description: \"Explore three-dimensional geometry and volume calculations\", component: ThreeDShapesMicroLesson, unit: \"Unit 4: Measurements\", unitColor: \"bg-orange-100 text-orange-700\" },\r\n  { id: 7, title: \"Coordinate Geometry\", description: \"Apply geometry concepts to the coordinate plane\", component: CoordinateGeometryMicroLesson, unit: \"Unit 5: Transformations\", unitColor: \"bg-red-100 text-red-700\" },\r\n  { id: 8, title: \"Vectors and Vector Geometry\", description: \"Master vectors, operations, and geometric applications\", component: VectorsMicroLesson, unit: \"Unit 6: Advanced Concepts\", unitColor: \"bg-indigo-100 text-indigo-700\" },\r\n  { id: 9, title: \"Geometry Review & Recap\", description: \"Comprehensive recap of all 8 lessons completed\", component: GeometryReviewAndRecap, unit: \"Course Review\", unitColor: \"bg-emerald-100 text-emerald-700\" },\r\n  { id: 10, title: \"Course Completion & Celebration\", description: \"Celebrate your achievement and explore next steps\", component: GeometryCompletionLesson, unit: \"Course Completion\", unitColor: \"bg-amber-100 text-amber-700\" }\r\n];\r\n\r\nexport const GeometryCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  const [accordionOpen, setAccordionOpen] = useState<string | undefined>(undefined);\r\n\r\n  // Use analytics and progress hooks\r\n  const courseId = 'geometry';\r\n  const courseTitle = 'Interactive Geometry Fundamentals';\r\n  const {\r\n    completedLessons,\r\n    isLessonCompleted,\r\n    calculateProgress,\r\n    saveLessonCompletion,\r\n    progressData\r\n  } = useInteractiveCourseProgress(courseId);\r\n  \r\n  const { enrollInCourse, isEnrolling } = useCourseEnrollment();\r\n  const isEnrolled = progressData?.enrollment !== null;\r\n  \r\n  useInteractiveCourseEnrollmentBridge();\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    } else {\r\n      // Reset to course overview when no lesson ID is present\r\n      setCurrentLesson(null);\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = async (lessonId: number) => {\r\n    const lesson = lessons.find(l => l.id === lessonId);\r\n    if (lesson) {\r\n      await saveLessonCompletion(lessonId, lesson.title);\r\n    }\r\n  };\r\n\r\n  // Memoize navigation handlers to prevent unnecessary re-renders\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/geometry/${nextLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handlePrevLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson > 1) {\r\n      const prevLesson = currentLesson - 1;\r\n      setCurrentLesson(prevLesson);\r\n      navigate(`/courses/geometry/${prevLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/geometry/${lessonId}`);\r\n    // Scroll to top of the page\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  // Memoize expensive calculations\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || isLessonCompleted(lessonId - 1);\r\n  }, [isLessonCompleted]);\r\n\r\n  const progress = useMemo(() => calculateProgress(lessons.length), [calculateProgress]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"geometry\"\r\n          courseTitle=\"Interactive Geometry Fundamentals\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\" style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${interactiveGeometryBg})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundAttachment: 'fixed'\r\n          }}>\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Interactive Geometry Fundamentals\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              {/* Course Title and Description */}\r\n              <div className=\"text-center space-y-4\">\r\n                <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Interactive Geometry Fundamentals</h1>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium\">\r\n                  Master the essential concepts of geometry, from basic shapes and angles to advanced proofs and transformations. Build a solid foundation in spatial reasoning and mathematical thinking.\r\n                </p>\r\n                \r\n                {/* Course badges */}\r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~8 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Users className=\"w-4 h-4 mr-2\" />\r\n                    Beginner to Intermediate\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white mt-1 text-center font-medium\">\r\n                    {completedLessons.size} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Voice Controls */}\r\n              <div className=\"mb-8\">\r\n                <CourseOverviewTTS \r\n                  courseTitle=\"Interactive Geometry Fundamentals\"\r\n                  courseDescription=\"Master the essential concepts of geometry, from basic shapes and angles to advanced proofs and transformations. Build a solid foundation in spatial reasoning and mathematical thinking.\"\r\n                  lessons={lessons}\r\n                />\r\n              </div>\r\n\r\n              {/* Video Overview */}\r\n                <CourseOverviewVideo \r\n                  videoUrl=\"https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/enhanced-geometry/Geometry__The_Shape_of_Everything.mp4\" \r\n                  title=\"Interactive Geometry Fundamentals Overview\"\r\n                />\r\n\r\n              {/* Study Materials Section */}\r\n              <AdditionalResourcesSection>\r\n                <StudentGuidesAccordion \r\n                  guideCount={21}\r\n                  courseId=\"geometry\"\r\n                  description=\"Explore our comprehensive collection of student guides organized by module. Click any image to view in detail or open in a new tab.\"\r\n                />\r\n              </AdditionalResourcesSection>\r\n\r\n              {/* Enhanced Course Information */}\r\n              <div className=\"max-w-4xl mx-auto\">\r\n                <EnhancedCourseInfoAccordion\r\n                  title=\"Enhanced Comprehensive Geometry Course\"\r\n                  introduction=\"Welcome to the Enhanced Comprehensive Geometry Course! This course has been specially designed to provide a thorough understanding of geometric concepts from basic principles to advanced topics. What makes this course unique is the inclusion of detailed teaching moments and comprehensive problem-solving instructions throughout each module.\"\r\n                  features={[\r\n                    {\r\n                      title: \"Enhanced Teaching Moments\",\r\n                      description: \"Throughout each module, you'll find special 'Teaching Moment' sections that provide deeper insights, historical context, real-world applications, and conceptual connections to help you truly understand the material beyond mere formulas and procedures.\"\r\n                    },\r\n                    {\r\n                      title: \"Detailed Problem-Solving Approaches\",\r\n                      description: \"Each topic includes step-by-step problem-solving frameworks that guide you through the process of tackling different types of geometric problems, building your analytical skills and confidence.\"\r\n                    },\r\n                    {\r\n                      title: \"Comprehensive Examples\",\r\n                      description: \"Worked examples demonstrate the application of concepts and problem-solving techniques, showing the thought process behind each step.\"\r\n                    },\r\n                    {\r\n                      title: \"Practice Problems with Guidance\",\r\n                      description: \"Each module includes practice problems with detailed guidance on how to approach them, including step-by-step solution paths.\"\r\n                    },\r\n                    {\r\n                      title: \"Visual Resources\",\r\n                      description: \"The course includes diagrams and visual aids to help illustrate geometric concepts and relationships.\"\r\n                    },\r\n                    {\r\n                      title: \"Presentation Slides\",\r\n                      description: \"Summary slides for each module highlight key concepts and formulas for quick reference and review.\"\r\n                    }\r\n                  ]}\r\n                  modules={[\r\n                    { number: 1, title: \"Lines, Angles & Polygons\", description: \"Fundamental concepts that form the building blocks of geometry\" },\r\n                    { number: 2, title: \"Triangles and Triangle Properties\", description: \"In-depth exploration of the most fundamental shape in geometry\" },\r\n                    { number: 3, title: \"Quadrilaterals and Polygons\", description: \"Properties and applications of four-sided and many-sided shapes\" },\r\n                    { number: 4, title: \"Circles and Circle Properties\", description: \"Understanding the perfect shape and its unique properties\" },\r\n                    { number: 5, title: \"Transformations in Geometry\", description: \"How shapes move, rotate, reflect, and resize in the plane\" },\r\n                    { number: 6, title: \"Three-Dimensional Geometry\", description: \"Extending geometric concepts into the third dimension\" },\r\n                    { number: 7, title: \"Coordinate Geometry\", description: \"Combining algebra and geometry through the coordinate system\" },\r\n                    { number: 8, title: \"Vectors and Vector Geometry\", description: \"Advanced tools for analyzing direction and magnitude in geometry\" }\r\n                  ]}\r\n                  accordionOpen={accordionOpen}\r\n                  onAccordionChange={setAccordionOpen}\r\n                />\r\n              </div>\r\n\r\n              {/* Lessons Grid */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto\">\r\n                {lessons.map((lesson) => {\r\n                  const isCompleted = isLessonCompleted(lesson.id);\r\n                  const isAccessible = isLessonAccessible(lesson.id);\r\n\r\n                  return (\r\n                    <Card \r\n                      key={lesson.id}\r\n                      className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg ${\r\n                        !isAccessible ? 'opacity-50' : ''\r\n                      } ${isCompleted ? 'border-primary/50 bg-primary/5' : ''}`}\r\n                      onClick={() => isAccessible && setCurrentLesson(lesson.id)}\r\n                    >\r\n                      <CardHeader className=\"pb-3\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"flex items-center space-x-3\">\r\n                            <div className={`p-2 rounded-lg ${\r\n                              isCompleted \r\n                                ? 'bg-primary text-primary-foreground' \r\n                                : 'bg-white/10 text-white border-white/20 hover:bg-white/20'\r\n                            }`}>\r\n                              {isCompleted ? <Award className=\"w-5 h-5\" /> : <BookOpen className=\"w-5 h-5\" />}\r\n                            </div>\r\n                            <div>\r\n                              <Badge className={lesson.unitColor}>\r\n                                Lesson {lesson.id}\r\n                              </Badge>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <CardTitle className=\"text-lg mt-2\">{lesson.title}</CardTitle>\r\n                      </CardHeader>\r\n                      <CardContent>\r\n                        <p className=\"text-sm text-white mb-3\">{lesson.description}</p>\r\n                        <Badge variant=\"outline\" className={lesson.unitColor}>\r\n                          {lesson.unit}\r\n                        </Badge>\r\n                      </CardContent>\r\n                    </Card>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const currentLessonData = lessons.find(l => l.id === currentLesson);\r\n  \r\n  if (!currentLessonData) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Lesson Not Found</h2>\r\n            <p className=\"text-white mb-4 font-medium\">\r\n              The requested lesson could not be found.\r\n            </p>\r\n            <Button onClick={() => setCurrentLesson(null)}>\r\n              Back to Course Overview\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasNext = currentLesson < lessons.length;\r\n  const hasPrev = currentLesson > 1;\r\n  const LessonComponent = currentLessonData.component;\r\n\r\n  return (\r\n    <VoiceSettingsProvider>\r\n      <InteractiveCourseWrapper \r\n        courseId=\"geometry\"\r\n        courseTitle=\"Interactive Geometry Fundamentals\"\r\n        currentLesson={currentLesson}\r\n        totalLessons={lessons.length}\r\n      >\r\n        <div className=\"min-h-screen bg-background\" style={{\r\n          backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${interactiveGeometryBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundAttachment: 'fixed'\r\n        }}>\r\n          <CourseHeader \r\n            onBackToCourses={() => navigate('/dashboard/learner/courses')}\r\n            onDashboard={handleDashboard}\r\n            courseTitle=\"Interactive Geometry Fundamentals\"\r\n          />\r\n          \r\n          <div className=\"container mx-auto px-4 py-8 max-w-6xl\">\r\n            <div className=\"flex items-center gap-4 mb-6\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  console.log('ðŸ”˜ Back to Overview button clicked');\r\n                  setCurrentLesson(null);\r\n                }}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Back to Overview\r\n              </Button>\r\n              <Badge className={currentLessonData.unitColor}>\r\n                {currentLessonData.unit}\r\n              </Badge>\r\n            </div>\r\n\r\n            {/* Navigation */}\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handlePrevLesson}\r\n                disabled={!hasPrev}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Previous Lesson\r\n              </Button>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-sm text-white font-medium\">\r\n                  Lesson {currentLesson} of {lessons.length}\r\n                </span>\r\n              </div>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handleNextLesson}\r\n                disabled={!hasNext}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                Next Lesson\r\n                <ChevronRight className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Lesson Content */}\r\n            <InteractiveLessonWrapper\r\n              courseId=\"geometry\"\r\n              lessonId={currentLesson}\r\n              lessonTitle={currentLessonData.title}\r\n              onComplete={() => handleLessonComplete(currentLesson)}\r\n              onNext={hasNext ? handleNextLesson : undefined}\r\n              hasNext={hasNext}\r\n              totalLessons={lessons.length}\r\n            >\r\n              <LessonComponent \r\n                onComplete={() => handleLessonComplete(currentLesson)}\r\n                onNext={hasNext ? handleNextLesson : undefined}\r\n                hasNext={hasNext}\r\n              />\r\n            </InteractiveLessonWrapper>\r\n          </div>\r\n        </div>\r\n      </InteractiveCourseWrapper>\r\n    </VoiceSettingsProvider>\r\n  );\r\n};\r\n\r\nexport default GeometryCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\InteractiveAlgebraCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2501,2504],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2501,2504],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { useInteractiveCourseProgress } from '@/hooks/useInteractiveCourseProgress';\r\nimport { useCourseEnrollment } from '@/hooks/useCourseEnrollment';\r\nimport { useInteractiveCourseEnrollmentBridge } from '@/hooks/useInteractiveCourseEnrollmentBridge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight, X, Calculator, Target, Brain } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\nimport { StandardCourseAudioSection } from '@/components/course/StandardCourseAudioSection';\r\nimport { StandardLessonAudioButtons } from '@/components/course/StandardLessonAudioButtons';\r\n\r\n// Import background image\r\nimport algebraBg from '@/assets/linear-equations-background.jpg';\r\n\r\n// Import micro-lesson components\r\nimport { AlgebraIntroductionMicroLesson } from '@/components/micro-lessons/algebra/AlgebraIntroductionMicroLesson';\r\nimport { AlgebraVariablesMicroLesson } from '@/components/micro-lessons/algebra/AlgebraVariablesMicroLesson';\r\nimport { AlgebraSimpleEquationsMicroLesson } from '@/components/micro-lessons/algebra/AlgebraSimpleEquationsMicroLesson';\r\nimport { AlgebraLinearGraphingMicroLesson } from '@/components/micro-lessons/algebra/AlgebraLinearGraphingMicroLesson';\r\nimport { AlgebraSystemsEquationsMicroLesson } from '@/components/micro-lessons/algebra/AlgebraSystemsEquationsMicroLesson';\r\nimport { AlgebraQuadraticsMicroLesson } from '@/components/micro-lessons/algebra/AlgebraQuadraticsMicroLesson';\r\nimport { AlgebraApplicationsMicroLesson } from '@/components/micro-lessons/algebra/AlgebraApplicationsMicroLesson';\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\n// Moved outside component to prevent recreation on every render\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"Introduction to Algebra\", description: \"Learn fundamental algebra concepts, variables, constants, and order of operations\", component: AlgebraIntroductionMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 2, title: \"Working with Variables\", description: \"Master like terms, distributive property, and simplifying expressions\", component: AlgebraVariablesMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 3, title: \"Solving Simple Equations\", description: \"Learn to solve linear equations using balance method and inverse operations\", component: AlgebraSimpleEquationsMicroLesson, unit: \"Unit 2: Equations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 4, title: \"Linear Equations and Graphing\", description: \"Understand coordinate planes, graphing lines, slope, and y-intercept\", component: AlgebraLinearGraphingMicroLesson, unit: \"Unit 2: Equations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 5, title: \"Systems of Equations\", description: \"Solve systems using substitution and elimination methods\", component: AlgebraSystemsEquationsMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 6, title: \"Quadratic Equations\", description: \"Learn to solve quadratics by factoring and using the quadratic formula\", component: AlgebraQuadraticsMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 7, title: \"Advanced Applications\", description: \"Apply algebra to real-world problems in science, business, and technology\", component: AlgebraApplicationsMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" }\r\n];\r\n\r\nconst InteractiveAlgebraCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  const [accordionOpen, setAccordionOpen] = useState<string | undefined>(undefined);\r\n\r\n  // Use analytics and progress hooks\r\n  const courseId = 'interactive-algebra';\r\n  const courseTitle = 'Interactive Algebra';\r\n  const {\r\n    completedLessons,\r\n    isLessonCompleted,\r\n    calculateProgress,\r\n    saveLessonCompletion,\r\n    progressData\r\n  } = useInteractiveCourseProgress(courseId);\r\n  \r\n  const { enrollInCourse, isEnrolling } = useCourseEnrollment();\r\n  const isEnrolled = progressData?.enrollment !== null;\r\n  \r\n  useInteractiveCourseEnrollmentBridge();\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    } else {\r\n      setCurrentLesson(null);\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = async (lessonId: number) => {\r\n    const lesson = lessons.find(l => l.id === lessonId);\r\n    if (lesson) {\r\n      await saveLessonCompletion(lessonId, lesson.title);\r\n    }\r\n  };\r\n\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/interactive-algebra/${nextLesson}`);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/interactive-algebra/${lessonId}`);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || isLessonCompleted(lessonId - 1);\r\n  }, [isLessonCompleted]);\r\n\r\n  const progress = useMemo(() => calculateProgress(lessons.length), [calculateProgress]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"interactive-algebra\"\r\n          courseTitle=\"Interactive Algebra\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\" style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${algebraBg})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundAttachment: 'fixed'\r\n          }}>\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Interactive Algebra\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              {/* Course Title and Description */}\r\n              <div className=\"text-center space-y-4\">\r\n                <div className=\"flex justify-center items-center gap-3 mb-4\">\r\n                  <Calculator className=\"w-12 h-12 text-blue-400\" />\r\n                  <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Interactive Algebra</h1>\r\n                  <Brain className=\"w-12 h-12 text-blue-400\" />\r\n                </div>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium\">\r\n                  Master algebra fundamentals through interactive lessons and step-by-step problem solving. Learn to work with variables, solve equations, and apply algebra to real-world situations.\r\n                </p>\r\n                \r\n                {/* Course badges */}\r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~5 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Target className=\"w-4 h-4 mr-2\" />\r\n                    Problem Solving\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white mt-1 text-center font-medium\">\r\n                    {completedLessons.size} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Listen to Course Overview Section */}\r\n              <div className=\"mb-8\">\r\n                <StandardCourseAudioSection\r\n                  courseTitle=\"Interactive Algebra\"\r\n                  courseDescription=\"Master algebra fundamentals through interactive lessons and step-by-step problem solving. Learn to work with variables, solve equations, and apply algebra to real-world situations.\"\r\n                />\r\n              </div>\r\n\r\n              {/* Individual Lesson Audio Buttons */}\r\n              <div className=\"mb-8\">\r\n                <StandardLessonAudioButtons lessons={lessons} />\r\n              </div>\r\n\r\n              {/* Enhanced Course Information */}\r\n              <div className=\"max-w-4xl mx-auto\">\r\n                <Accordion \r\n                  type=\"single\" \r\n                  collapsible \r\n                  className=\"w-full space-y-4\"\r\n                  value={accordionOpen}\r\n                  onValueChange={setAccordionOpen}\r\n                >\r\n                  <AccordionItem value=\"course-info\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-white/30 hover:bg-white/40 px-4 py-3 rounded-lg text-white border border-white/20\">\r\n                      Course Overview &amp; Learning Objectives\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"prose prose-gray max-w-none text-sm relative\">\r\n                      <div className=\"space-y-6 pr-12\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Why Learn Algebra?</h3>\r\n                          <p className=\"text-white leading-relaxed\">\r\n                            Algebra is the foundation of higher mathematics and critical thinking. It teaches you to recognize patterns, solve problems systematically, and model real-world situations mathematically. These skills are essential for STEM careers, logical reasoning, and everyday problem-solving.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">What You'll Master</h3>\r\n                          <ul className=\"space-y-2 text-white\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Algebraic Foundations:</strong> Variables, constants, expressions, and the language of algebra</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Equation Solving:</strong> Linear and quadratic equations using multiple methods</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Graphing Skills:</strong> Coordinate planes, linear relationships, and parabolas</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Systems:</strong> Solving multiple equations simultaneously</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Real-World Applications:</strong> Using algebra in science, business, and technology</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Interactive Learning Experience</h3>\r\n                          <p className=\"text-white mb-3\">This course uses a micro-lesson approach with:</p>\r\n                          <ul className=\"space-y-1 text-white\">\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Step-by-step explanations with visual examples</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Interactive practice problems with immediate feedback</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Real-world applications and problem-solving strategies</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Progressive difficulty that builds confidence</li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n\r\n              {/* Lessons Grid */}\r\n              <div className=\"max-w-6xl mx-auto\">\r\n                <h2 className=\"text-2xl font-bold text-white mb-8 text-center\">Course Lessons</h2>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  {lessons.map((lesson) => {\r\n                    const isAccessible = isLessonAccessible(lesson.id);\r\n                    const isCompleted = isLessonCompleted(lesson.id);\r\n                    \r\n                    return (\r\n                      <Card \r\n                        key={lesson.id}\r\n                        className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg bg-card/65 backdrop-blur-sm border-border ${\r\n                          !isAccessible ? 'opacity-50' : ''\r\n                        } ${isCompleted ? 'border-primary/50' : 'border-border'}`}\r\n                        onClick={() => isAccessible && handleLessonSelect(lesson.id)}\r\n                      >\r\n                        <CardHeader className=\"pb-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <Badge variant=\"outline\" className={lesson.unitColor}>\r\n                              {lesson.unit}\r\n                            </Badge>\r\n                            {isCompleted && <Award className=\"w-5 h-5 text-primary\" />}\r\n                          </div>\r\n                          <CardTitle className=\"text-lg\">{lesson.title}</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                          <p className=\"text-muted-foreground text-sm mb-4\">{lesson.description}</p>\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-xs text-muted-foreground\">Lesson {lesson.id}</span>\r\n                            {!isAccessible && (\r\n                              <span className=\"text-xs text-muted-foreground\">Complete previous lesson</span>\r\n                            )}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const currentLessonData = lessons.find(l => l.id === currentLesson);\r\n  \r\n  if (!currentLessonData) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Lesson Not Found</h2>\r\n            <p className=\"text-white mb-4 font-medium\">\r\n              The requested lesson could not be found.\r\n            </p>\r\n            <Button onClick={() => setCurrentLesson(null)}>\r\n              Back to Course Overview\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasNext = currentLesson < lessons.length;\r\n  const LessonComponent = currentLessonData.component;\r\n\r\n  return (\r\n    <VoiceSettingsProvider>\r\n      <InteractiveCourseWrapper \r\n        courseId=\"interactive-algebra\"\r\n        courseTitle=\"Interactive Algebra\"\r\n        currentLesson={currentLesson}\r\n        totalLessons={lessons.length}\r\n      >\r\n        <div className=\"min-h-screen bg-background\" style={{\r\n          backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${algebraBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundAttachment: 'fixed'\r\n        }}>\r\n          <CourseHeader \r\n            onDashboard={handleDashboard} \r\n            onBackToCourses={handleBackToCourses}\r\n            title={`Lesson ${currentLessonData.id}: ${currentLessonData.title}`}\r\n          />\r\n\r\n          <div className=\"container mx-auto px-4 py-8\">\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <Button \r\n                variant=\"outline\" \r\n                onClick={() => setCurrentLesson(null)}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Back to Course\r\n              </Button>\r\n              \r\n              <div className=\"text-center\">\r\n                <Badge className={currentLessonData.unitColor}>\r\n                  {currentLessonData.unit}\r\n                </Badge>\r\n                <h1 className=\"text-2xl font-bold text-white mt-2\">\r\n                  {currentLessonData.title}\r\n                </h1>\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-sm text-white\">\r\n                  {currentLesson} of {lessons.length}\r\n                </span>\r\n                <Progress value={(currentLesson / lessons.length) * 100} className=\"w-20 h-2\" />\r\n              </div>\r\n            </div>\r\n\r\n            <InteractiveLessonWrapper\r\n              courseId=\"interactive-algebra\"\r\n              lessonId={currentLesson}\r\n              lessonTitle={currentLessonData.title}\r\n              onComplete={() => handleLessonComplete(currentLessonData.id)}\r\n              onNext={handleNextLesson}\r\n              hasNext={hasNext}\r\n            >\r\n              <LessonComponent \r\n                onComplete={() => handleLessonComplete(currentLessonData.id)}\r\n                onNext={handleNextLesson}\r\n                hasNext={hasNext}\r\n              />\r\n            </InteractiveLessonWrapper>\r\n          </div>\r\n        </div>\r\n      </InteractiveCourseWrapper>\r\n    </VoiceSettingsProvider>\r\n  );\r\n};\r\n\r\nexport default InteractiveAlgebraCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\InteractiveELTCoursePage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'lessons.length'. Either include it or remove the dependency array.","line":73,"column":6,"nodeType":"ArrayExpression","endLine":73,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [lessonId, lessons.length]","fix":{"range":[4568,4578],"text":"[lessonId, lessons.length]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { BookOpen, Brain, CheckCircle, PlayCircle, Trophy, ArrowLeft, Users, Lightbulb, Target, GraduationCap, FileText, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { useInteractiveCourseProgress } from '@/hooks/useInteractiveCourseProgress';\r\nimport { useInteractiveCourseEnrollmentBridge } from '@/hooks/useInteractiveCourseEnrollmentBridge';\r\nimport { useCourseEnrollment } from '@/hooks/useCourseEnrollment';\r\nimport { ErrorBoundary, CourseFallback } from '@/components/common/ErrorBoundary';\r\nimport CourseOverviewVideo from '@/components/course/CourseOverviewVideo';\r\nimport {\r\n  AdditionalResourcesSection,\r\n  StudentGuidesAccordion,\r\n  CourseOverviewAccordion,\r\n  EnhancedCourseInfoAccordion,\r\n  InstructorMaterialsAccordion\r\n} from '@/components/course/resources';\r\n\r\n// Import micro-lesson components\r\nimport { UnderstandingNeurodiversityMicroLesson } from '@/components/micro-lessons/elt/understanding-neurodiversity/UnderstandingNeurodiversityMicroLesson';\r\nimport { ExecutiveFunctioningMicroLesson } from '@/components/micro-lessons/elt/executive-functioning/ExecutiveFunctioningMicroLesson';\r\nimport { StudyTechniquesMicroLesson } from '@/components/micro-lessons/elt/study-techniques/StudyTechniquesMicroLesson';\r\nimport { StrengthsSelfAdvocacyMicroLesson } from '@/components/micro-lessons/elt/strengths-self-advocacy/StrengthsSelfAdvocacyMicroLesson';\r\nimport { RealWorldApplicationMicroLesson } from '@/components/micro-lessons/elt/real-world-application/RealWorldApplicationMicroLesson';\r\nimport { SelfAssessmentMicroLesson } from '@/components/micro-lessons/elt/assessments/SelfAssessmentMicroLesson';\r\nimport { InteractiveWorksheetsMicroLesson } from '@/components/micro-lessons/elt/interactive-worksheets/InteractiveWorksheetsMicroLesson';\r\nimport { CaseStudiesMicroLesson } from '@/components/micro-lessons/elt/case-studies/CaseStudiesMicroLesson';\r\nimport { InstructorResourcesMicroLesson } from '@/components/micro-lessons/elt/instructor-resources/InstructorResourcesMicroLesson';\r\nimport { AdvancedExecutiveFunctioningMicroLesson } from '@/components/micro-lessons/elt/advanced-modules/AdvancedExecutiveFunctioningMicroLesson';\r\nimport { AdvancedStudyTechniquesMicroLesson } from '@/components/micro-lessons/elt/advanced-modules/AdvancedStudyTechniquesMicroLesson';\r\nimport { EnhancedAssessmentsMicroLesson } from '@/components/micro-lessons/elt/enhanced-assessments/EnhancedAssessmentsMicroLesson';\r\nimport { ExpandedWorksheetsMicroLesson } from '@/components/micro-lessons/elt/expanded-worksheets/ExpandedWorksheetsMicroLesson';\r\nimport { InstructorDashboardMicroLesson } from '@/components/micro-lessons/elt/instructor-dashboard/InstructorDashboardMicroLesson';\r\nimport eltBackground from '@/assets/elt-background.jpg';\r\n\r\nconst InteractiveELTCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams<{ lessonId?: string }>();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  \r\n  // Use analytics and progress hooks\r\n  const courseId = 'elt-empowering-learning-techniques';\r\n  const courseTitle = 'ELT: Empowering Learning Techniques';\r\n  const {\r\n    completedLessons,\r\n    isLessonCompleted,\r\n    calculateProgress,\r\n    getNextLesson,\r\n    getLearningStats,\r\n    saveLessonCompletion,\r\n    progressData\r\n  } = useInteractiveCourseProgress(courseId);\r\n  \r\n  // Course enrollment functionality\r\n  const { enrollInCourse, isEnrolling } = useCourseEnrollment();\r\n  const isEnrolled = progressData?.enrollment !== null;\r\n  \r\n  // Handle URL parameters for lesson navigation\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lessonNumber = parseInt(lessonId, 10);\r\n      if (!isNaN(lessonNumber) && lessonNumber >= 1 && lessonNumber <= lessons.length) {\r\n        setCurrentLesson(lessonNumber);\r\n      }\r\n    }\r\n  }, [lessonId]);\r\n\r\n  // Bridge old enrollment system with new analytics - delayed\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      console.log('ðŸ”— Initializing ELT course enrollment bridge');\r\n    }, 5000);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, []);\r\n  \r\n  useInteractiveCourseEnrollmentBridge();\r\n\r\n  // Scroll to top when lesson changes\r\n  useEffect(() => {\r\n    if (currentLesson !== null) {\r\n      window.scrollTo(0, 0);\r\n    }\r\n  }, [currentLesson]);\r\n\r\n  const lessons = [\r\n    {\r\n      id: 1,\r\n      title: \"Understanding Neurodiversity and Your Unique Brain\",\r\n      description: \"Discover how your brain works differently and why that's your greatest asset\",\r\n      component: UnderstandingNeurodiversityMicroLesson,\r\n      icon: Brain\r\n    },\r\n    {\r\n      id: 2,\r\n      title: \"Self-Assessment & Learning Discovery\", \r\n      description: \"Complete interactive assessments to understand your unique learning profile\",\r\n      component: SelfAssessmentMicroLesson,\r\n      icon: CheckCircle\r\n    },\r\n    {\r\n      id: 3,\r\n      title: \"Mastering Executive Functioning Skills\",\r\n      description: \"Build organizational systems that work with your brain, not against it\",\r\n      component: ExecutiveFunctioningMicroLesson,\r\n      icon: Target\r\n    },\r\n    {\r\n      id: 4,\r\n      title: \"Interactive Learning Tools & Templates\",\r\n      description: \"Master practical worksheets and planners for effective learning\",\r\n      component: InteractiveWorksheetsMicroLesson,\r\n      icon: FileText\r\n    },\r\n    {\r\n      id: 5,\r\n      title: \"Effective Study and Information Retention Techniques\",\r\n      description: \"Learn evidence-based methods tailored for neurodiverse learners\",\r\n      component: StudyTechniquesMicroLesson,\r\n      icon: BookOpen\r\n    },\r\n    {\r\n      id: 6,\r\n      title: \"Turning Weaknesses into Strengths & Self-Advocacy\",\r\n      description: \"Transform challenges into competitive advantages and advocate for your needs\",\r\n      component: StrengthsSelfAdvocacyMicroLesson,\r\n      icon: Lightbulb\r\n    },\r\n    {\r\n      id: 7,\r\n      title: \"Real-World Application and Lifelong Learning\",\r\n      description: \"Apply your new skills across all areas of life and continue growing\",\r\n      component: RealWorldApplicationMicroLesson,\r\n      icon: GraduationCap\r\n    },\r\n    {\r\n      id: 8,\r\n      title: \"Case Studies & Success Stories\",\r\n      description: \"Explore real-world examples and success stories from neurodiverse learners\",\r\n      component: CaseStudiesMicroLesson,\r\n      icon: Users\r\n    },\r\n    {\r\n      id: 9,\r\n      title: \"Advanced Executive Functioning Mastery\",\r\n      description: \"Master advanced organizational systems and executive functioning strategies\",\r\n      component: AdvancedExecutiveFunctioningMicroLesson,\r\n      icon: Trophy\r\n    },\r\n    {\r\n      id: 10,\r\n      title: \"Advanced Study Techniques\",\r\n      description: \"Explore sophisticated study methods and memory enhancement techniques\",\r\n      component: AdvancedStudyTechniquesMicroLesson,\r\n      icon: BookOpen\r\n    },\r\n    {\r\n      id: 11,\r\n      title: \"Expanded Interactive Worksheets\",\r\n      description: \"Access comprehensive worksheets and practical tools for all learning scenarios\",\r\n      component: ExpandedWorksheetsMicroLesson,\r\n      icon: FileText\r\n    },\r\n    {\r\n      id: 12,\r\n      title: \"Enhanced Assessment Suite\",\r\n      description: \"Complete comprehensive assessments to track your learning progress\",\r\n      component: EnhancedAssessmentsMicroLesson,\r\n      icon: CheckCircle\r\n    },\r\n    {\r\n      id: 13,\r\n      title: \"Instructor Resources & Teaching Methods\",\r\n      description: \"Comprehensive resources for educators working with neurodiverse learners\",\r\n      component: InstructorResourcesMicroLesson,\r\n      icon: GraduationCap\r\n    },\r\n    {\r\n      id: 14,\r\n      title: \"Instructor Dashboard & Analytics\",\r\n      description: \"Advanced tools for tracking student progress and optimizing instruction\",\r\n      component: InstructorDashboardMicroLesson,\r\n      icon: Trophy\r\n    }\r\n  ];\r\n\r\n  const handleEnrollInCourse = () => {\r\n    enrollInCourse.mutate(courseId);\r\n  };\r\n\r\n  const handleLessonComplete = async (lessonId: number) => {\r\n    const lesson = lessons.find(l => l.id === lessonId);\r\n    if (lesson) {\r\n      await saveLessonCompletion(lessonId, lesson.title);\r\n    }\r\n  };\r\n\r\n  const handleNextLesson = () => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      setCurrentLesson(currentLesson + 1);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const handlePrevLesson = () => {\r\n    if (currentLesson !== null && currentLesson > 1) {\r\n      setCurrentLesson(currentLesson - 1);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const handleBackToCourses = () => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  };\r\n\r\n  const handleDashboard = () => {\r\n    navigate('/dashboard/learner');\r\n  };\r\n\r\n  const isLessonAccessible = (lessonId: number) => {\r\n    return lessonId === 1 || isLessonCompleted(lessonId - 1);\r\n  };\r\n\r\n  const overallProgress = calculateProgress(lessons.length);\r\n  const isAllLessonsCompleted = completedLessons.size === lessons.length;\r\n  const learningStats = getLearningStats();\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <ErrorBoundary fallback={CourseFallback}>\r\n        <VoiceSettingsProvider>\r\n          <InteractiveCourseWrapper\r\n            courseId={courseId}\r\n            courseTitle={courseTitle}\r\n            currentLesson={currentLesson}\r\n            totalLessons={lessons.length}\r\n          >\r\n          <div \r\n            className=\"min-h-screen relative\"\r\n            style={{\r\n              backgroundImage: `url(${eltBackground})`,\r\n              backgroundSize: 'cover',\r\n              backgroundPosition: 'center',\r\n              backgroundRepeat: 'no-repeat',\r\n              backgroundAttachment: 'fixed'\r\n            }}\r\n          >\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"ELT: Empowering Learning Techniques\"\r\n            />\r\n           \r\n          <div className=\"container mx-auto px-4 py-8 space-y-8 relative z-10\">\r\n            {/* Course Title and Description */}\r\n            <div className=\"text-center space-y-4\">\r\n              <h1 className=\"text-4xl font-bold text-foreground drop-shadow-lg bg-background/80 backdrop-blur-sm rounded-lg p-4 mx-auto inline-block\">\r\n                ELT: Empowering Learning Techniques\r\n              </h1>\r\n              <p className=\"text-xl text-foreground max-w-3xl mx-auto bg-background/80 backdrop-blur-sm rounded-lg p-4 drop-shadow-lg\">\r\n                Master evidence-based learning strategies specifically designed for neurodiverse minds. Transform how you learn, study, and succeed in any academic environment.\r\n              </p>\r\n              \r\n              {/* Course badges */}\r\n              <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                <Badge variant=\"outline\" className=\"text-sm px-3 py-1 bg-background/80 backdrop-blur-sm\">\r\n                  <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                  14 Modules\r\n                </Badge>\r\n                <Badge variant=\"outline\" className=\"text-sm px-3 py-1 bg-background/80 backdrop-blur-sm\">\r\n                  <Brain className=\"w-4 h-4 mr-2\" />\r\n                  Evidence-Based\r\n                </Badge>\r\n                <Badge variant=\"outline\" className=\"text-sm px-3 py-1 bg-background/80 backdrop-blur-sm\">\r\n                  <CheckCircle className=\"w-4 h-4 mr-2\" />\r\n                  Interactive\r\n                </Badge>\r\n              </div>\r\n\r\n              {/* Enrollment Button */}\r\n              {!isEnrolled && (\r\n                <div className=\"flex justify-center\">\r\n                  <Button \r\n                    onClick={handleEnrollInCourse}\r\n                    disabled={isEnrolling}\r\n                    size=\"lg\"\r\n                    className=\"bg-gradient-to-r from-primary to-primary-glow text-primary-foreground hover:from-primary-glow hover:to-primary shadow-lg\"\r\n                  >\r\n                    {isEnrolling ? 'Enrolling...' : 'Enroll in Course'}\r\n                  </Button>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Progress Bar */}\r\n            <div className=\"max-w-2xl mx-auto\">\r\n              <div className=\"flex justify-between items-center mb-2\">\r\n                <span className=\"text-sm font-medium\">Course Progress</span>\r\n                <span className=\"text-sm text-muted-foreground\">{Math.round(overallProgress)}%</span>\r\n              </div>\r\n              <Progress value={overallProgress} className=\"h-3\" />\r\n              <p className=\"text-xs text-muted-foreground mt-1 text-center\">\r\n                {completedLessons.size} of {lessons.length} modules completed\r\n              </p>\r\n              {learningStats.totalTimeSpent > 0 && (\r\n                <p className=\"text-xs text-muted-foreground text-center\">\r\n                  Total time spent: {Math.floor(learningStats.totalTimeSpent / 60)}h {learningStats.totalTimeSpent % 60}m\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Voice Controls */}\r\n            <div className=\"mb-8\">\r\n              <CourseOverviewTTS \r\n                courseTitle=\"ELT: Empowering Learning Techniques\"\r\n                courseDescription=\"Master evidence-based learning strategies specifically designed for neurodiverse minds. Transform how you learn, study, and succeed in any academic environment.\"\r\n                lessons={lessons}\r\n              />\r\n            </div>\r\n\r\n            {/* Course Overview Video */}\r\n            <CourseOverviewVideo \r\n              videoUrl=\"https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/elt-course/Neurodiverse_Learners_Guide.mp4\"\r\n              title=\"ELT Course Introduction: Empowering Neurodiverse Learners\"\r\n            />\r\n\r\n            {/* Additional Resources Section */}\r\n            <AdditionalResourcesSection>\r\n              {/* StudentGuidesAccordion temporarily removed for content review */}\r\n              {/* \r\n              <StudentGuidesAccordion \r\n                guideCount={15}\r\n                courseId=\"elt-empowering-learning-techniques\"\r\n                description=\"Access comprehensive student guides, worksheets, and self-assessment tools designed for neurodiverse learners.\"\r\n              />\r\n              */}\r\n              \r\n              <CourseOverviewAccordion\r\n                whyMasterContent={{\r\n                  title: \"Why Master ELT?\",\r\n                  description: \"Master these techniques to unlock your full learning potential and succeed in any academic or professional environment.\"\r\n                }}\r\n                whatYouMasterContent={{\r\n                  title: \"What You'll Master\",\r\n                  objectives: [\r\n                    { title: \"Self-Awareness\", description: \"Identify your unique learning style and cognitive strengths\" },\r\n                    { title: \"Executive Systems\", description: \"Develop personalized executive functioning systems\" },\r\n                    { title: \"Study Mastery\", description: \"Apply evidence-based study techniques for better retention\" },\r\n                    { title: \"Strength Focus\", description: \"Transform perceived weaknesses into competitive advantages\" },\r\n                    { title: \"Self-Advocacy\", description: \"Build self-advocacy skills for academic and professional success\" },\r\n                    { title: \"Lifelong Learning\", description: \"Create sustainable lifelong learning habits\" }\r\n                  ]\r\n                }}\r\n              />\r\n              \r\n              <EnhancedCourseInfoAccordion \r\n                introduction=\"This comprehensive course uses cutting-edge research in neuroscience and educational psychology to provide learning strategies that work specifically for neurodiverse minds.\"\r\n                features={[\r\n                  { title: \"Evidence-Based Techniques\", description: \"All strategies are backed by current research in neuroscience and educational psychology\" },\r\n                  { title: \"Personalized Learning Approaches\", description: \"Adapt methods to work with your unique brain and learning style\" },\r\n                  { title: \"Real-World Applications\", description: \"Practical tools you can use immediately in academic and professional settings\" }\r\n                ]}\r\n                modules={[\r\n                  { number: 1, title: \"Understanding Neurodiversity\", description: \"Discover your unique brain and cognitive strengths\" },\r\n                  { number: 2, title: \"Executive Functioning\", description: \"Build organizational systems that work with your brain\" },\r\n                  { number: 3, title: \"Study Techniques\", description: \"Master evidence-based methods for better learning\" },\r\n                  { number: 4, title: \"Self-Advocacy\", description: \"Transform challenges into strengths and advocate effectively\" },\r\n                  { number: 5, title: \"Real-World Application\", description: \"Apply your skills for lifelong success\" }\r\n                ]}\r\n              />\r\n              \r\n              <InstructorMaterialsAccordion \r\n                resources={[\r\n                  {\r\n                    title: \"Instructor Guide - ELT Teaching Methods\",\r\n                    description: \"Complete guide for educators on implementing ELT strategies\",\r\n                    type: \"guide\",\r\n                    content: {\r\n                      sections: [\r\n                        {\r\n                          title: \"Understanding Neurodiversity in the Classroom\",\r\n                          items: [\r\n                            {\r\n                              title: \"Recognizing Neurodiverse Learners\",\r\n                              description: \"Identify signs and characteristics of different learning styles and neurological differences\",\r\n                              details: [\r\n                                \"ADHD traits: difficulty with sustained attention, hyperactivity, impulsivity\",\r\n                                \"Dyslexia indicators: reading challenges, phonological processing difficulties\",\r\n                                \"Autism spectrum traits: sensory sensitivities, need for routine, detail-focused thinking\",\r\n                                \"Executive function challenges: organization, time management, working memory\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              title: \"Creating an Inclusive Environment\",\r\n                              description: \"Strategies for building a classroom that supports all learners\",\r\n                              details: [\r\n                                \"Flexible seating arrangements and quiet zones\",\r\n                                \"Clear visual schedules and expectations\",\r\n                                \"Multiple ways to demonstrate learning\",\r\n                                \"Sensory-friendly classroom modifications\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          title: \"Teaching Methodologies\",\r\n                          items: [\r\n                            {\r\n                              title: \"Multi-Sensory Learning Approaches\",\r\n                              description: \"Engage multiple senses to enhance learning retention\",\r\n                              details: [\r\n                                \"Visual: mind maps, diagrams, color-coding systems\",\r\n                                \"Auditory: recordings, discussions, verbal instructions\",\r\n                                \"Kinesthetic: hands-on activities, movement breaks\",\r\n                                \"Tactile: manipulatives, textured materials\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              title: \"Scaffolding and Support Systems\",\r\n                              description: \"Provide appropriate levels of support that can be gradually removed\",\r\n                              details: [\r\n                                \"Break complex tasks into smaller steps\",\r\n                                \"Provide templates and graphic organizers\",\r\n                                \"Use peer support and collaborative learning\",\r\n                                \"Offer multiple check-in points during activities\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          title: \"Assessment and Progress Monitoring\",\r\n                          items: [\r\n                            {\r\n                              title: \"Alternative Assessment Methods\",\r\n                              description: \"Diverse ways to measure student understanding and progress\",\r\n                              details: [\r\n                                \"Portfolio-based assessments\",\r\n                                \"Oral presentations instead of written tests\",\r\n                                \"Project-based demonstrations\",\r\n                                \"Self-assessment and reflection tools\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              title: \"Accommodations and Modifications\",\r\n                              description: \"Adjustments to support neurodiverse learners without changing learning objectives\",\r\n                              details: [\r\n                                \"Extended time for assignments and tests\",\r\n                                \"Alternative formats for materials\",\r\n                                \"Assistive technology integration\",\r\n                                \"Quiet testing environments\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    title: \"Assessment Rubrics and Tools\",\r\n                    description: \"Comprehensive assessment materials for tracking student progress\",\r\n                    type: \"resource\",\r\n                    content: {\r\n                      rubrics: [\r\n                        {\r\n                          title: \"Learning Strategy Implementation Rubric\",\r\n                          criteria: [\r\n                            {\r\n                              criterion: \"Self-Awareness\",\r\n                              excellent: \"Consistently identifies personal learning strengths and challenges; effectively articulates learning preferences\",\r\n                              proficient: \"Usually identifies learning strengths and challenges; can describe most learning preferences\", \r\n                              developing: \"Sometimes identifies learning strengths; basic awareness of learning preferences\",\r\n                              inadequate: \"Rarely identifies learning strengths; minimal awareness of learning preferences\"\r\n                            },\r\n                            {\r\n                              criterion: \"Strategy Application\",\r\n                              excellent: \"Independently selects and applies appropriate learning strategies; adapts strategies based on context\",\r\n                              proficient: \"Usually selects appropriate strategies with minimal guidance; applies strategies consistently\",\r\n                              developing: \"Sometimes selects appropriate strategies with guidance; inconsistent application\",\r\n                              inadequate: \"Rarely selects appropriate strategies; requires significant support for application\"\r\n                            },\r\n                            {\r\n                              criterion: \"Executive Functioning\",\r\n                              excellent: \"Demonstrates strong organization and time management; effectively plans and monitors progress\",\r\n                              proficient: \"Shows good organizational skills; usually manages time effectively\",\r\n                              developing: \"Basic organizational skills; needs some support with time management\",\r\n                              inadequate: \"Poor organizational skills; requires significant support with time management\"\r\n                            },\r\n                            {\r\n                              criterion: \"Self-Advocacy\",\r\n                              excellent: \"Confidently communicates needs; proactively seeks appropriate support and accommodations\",\r\n                              proficient: \"Usually communicates needs clearly; seeks support when needed\",\r\n                              developing: \"Sometimes communicates needs; occasionally seeks support\",\r\n                              inadequate: \"Difficulty communicating needs; rarely seeks support\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          title: \"Academic Progress Monitoring Rubric\", \r\n                          criteria: [\r\n                            {\r\n                              criterion: \"Information Processing\",\r\n                              excellent: \"Efficiently processes and synthesizes information from multiple sources; demonstrates deep understanding\",\r\n                              proficient: \"Processes information well; shows good understanding of material\",\r\n                              developing: \"Processes information with some support; basic understanding evident\",\r\n                              inadequate: \"Difficulty processing information; requires significant support for comprehension\"\r\n                            },\r\n                            {\r\n                              criterion: \"Study Technique Mastery\",\r\n                              excellent: \"Independently uses various study techniques effectively; adapts methods based on material type\",\r\n                              proficient: \"Uses several study techniques effectively; some adaptation of methods\",\r\n                              developing: \"Uses basic study techniques; limited adaptation\",\r\n                              inadequate: \"Relies on ineffective study methods; needs guidance to use appropriate techniques\"\r\n                            },\r\n                            {\r\n                              criterion: \"Academic Performance\",\r\n                              excellent: \"Consistently meets or exceeds academic goals; shows continuous improvement\",\r\n                              proficient: \"Usually meets academic goals; demonstrates steady progress\",\r\n                              developing: \"Sometimes meets academic goals; shows some improvement\",\r\n                              inadequate: \"Rarely meets academic goals; minimal progress evident\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    }\r\n                  }\r\n                ]}\r\n              />\r\n            </AdditionalResourcesSection>\r\n\r\n            {/* Course Introduction */}\r\n            <div className=\"bg-card p-6 rounded-lg shadow-sm border max-w-4xl mx-auto\">\r\n              <h2 className=\"text-2xl font-bold text-foreground mb-4\">Welcome to Empowering Learning Techniques</h2>\r\n              <p className=\"text-muted-foreground leading-relaxed\">\r\n                This comprehensive course is designed specifically for neurodiverse learners who want to unlock their full potential. \r\n                Based on the latest research in neuroscience and educational psychology, you'll discover evidence-based techniques \r\n                that work WITH your brain, not against it. Each module builds upon the previous one, creating a complete framework \r\n                for academic and lifelong success.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Lessons Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto\">\r\n              {lessons.map((lesson) => {\r\n                const isCompleted = isLessonCompleted(lesson.id);\r\n                const isAccessible = isLessonAccessible(lesson.id);\r\n                const Icon = lesson.icon;\r\n\r\n                return (\r\n                  <Card \r\n                    key={lesson.id}\r\n                    className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg bg-card/65 backdrop-blur-sm border-border ${\r\n                      !isAccessible ? 'opacity-50' : ''\r\n                    } ${isCompleted ? 'border-primary/50' : 'border-border'}`}\r\n                    onClick={() => isAccessible && setCurrentLesson(lesson.id)}\r\n                  >\r\n                    <CardHeader className=\"pb-3\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className={`p-2 rounded-lg ${\r\n                            isCompleted \r\n                              ? 'bg-primary text-primary-foreground' \r\n                              : 'bg-muted text-muted-foreground'\r\n                          }`}>\r\n                            {isCompleted ? <CheckCircle className=\"w-5 h-5\" /> : <Icon className=\"w-5 h-5\" />}\r\n                          </div>\r\n                          <div>\r\n                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                              Module {lesson.id}\r\n                            </Badge>\r\n                          </div>\r\n                        </div>\r\n                        {isCompleted && (\r\n                          <Badge variant=\"default\" className=\"text-xs\">\r\n                            Completed\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                      <CardTitle className=\"text-lg\">{lesson.title}</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                      <p className=\"text-sm text-muted-foreground mb-4\">\r\n                        {lesson.description}\r\n                      </p>\r\n                      <Button \r\n                        variant={isCompleted ? \"secondary\" : \"default\"}\r\n                        className=\"w-full\"\r\n                        disabled={!isAccessible}\r\n                      >\r\n                        {lesson.id === 1 ? \"Start Module\" : isCompleted ? \"Review Module\" : isAccessible ? \"Start Module\" : \"Locked\"}\r\n                      </Button>\r\n                    </CardContent>\r\n                  </Card>\r\n                );\r\n              })}\r\n            </div>\r\n\r\n            {/* Completion Message */}\r\n            {isAllLessonsCompleted && (\r\n              <div className=\"max-w-2xl mx-auto text-center space-y-4 p-6 bg-primary/10 rounded-lg border border-primary/20\">\r\n                <Trophy className=\"w-12 h-12 text-primary mx-auto\" />\r\n                <h3 className=\"text-2xl font-bold text-primary\">Congratulations! ðŸŽ‰</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  You've completed the ELT: Empowering Learning Techniques course. \r\n                  You're now equipped with evidence-based strategies to excel in any learning environment!\r\n                </p>\r\n                <Button onClick={handleBackToCourses} className=\"mt-4\">\r\n                  Back to My Courses\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        </InteractiveCourseWrapper>\r\n        </VoiceSettingsProvider>\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const lesson = lessons.find(l => l.id === currentLesson);\r\n  if (!lesson) return null;\r\n\r\n  const LessonComponent = lesson.component;\r\n  const hasNext = currentLesson < lessons.length;\r\n  const hasPrev = currentLesson > 1;\r\n\r\n  return (\r\n    <ErrorBoundary fallback={CourseFallback}>\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId={courseId}\r\n          courseTitle={courseTitle}\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n        <div \r\n          className=\"min-h-screen relative\"\r\n          style={{\r\n            backgroundImage: `url(${eltBackground})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundRepeat: 'no-repeat',\r\n            backgroundAttachment: 'fixed'\r\n          }}\r\n        >\r\n          {/* Lesson Header */}\r\n          <div className=\"bg-card/95 backdrop-blur-sm border-b sticky top-0 z-20 relative\">\r\n            <div className=\"container mx-auto px-4 py-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => setCurrentLesson(null)}\r\n                    className=\"flex items-center\"\r\n                  >\r\n                    <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n                    Back to Course\r\n                  </Button>\r\n                  <div>\r\n                    <h1 className=\"text-xl font-bold\">Module {currentLesson}: {lesson.title}</h1>\r\n                    <p className=\"text-sm text-muted-foreground\">ELT: Empowering Learning Techniques</p>\r\n                  </div>\r\n                </div>\r\n                <Badge variant=\"outline\">\r\n                  {currentLesson} of {lessons.length}\r\n                </Badge>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Navigation */}\r\n          <div className=\"container mx-auto px-4 py-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handlePrevLesson}\r\n                disabled={!hasPrev}\r\n                className=\"flex items-center gap-2 bg-card/80 hover:bg-card disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Previous Lesson\r\n              </Button>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-sm text-muted-foreground font-medium\">\r\n                  Lesson {currentLesson} of {lessons.length}\r\n                </span>\r\n              </div>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handleNextLesson}\r\n                disabled={!hasNext}\r\n                className=\"flex items-center gap-2 bg-card/80 hover:bg-card disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                Next Lesson\r\n                <ChevronRight className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Lesson Content */}\r\n          <div className=\"container mx-auto px-4 py-8\">\r\n            <InteractiveLessonWrapper\r\n              courseId={courseId}\r\n              lessonId={currentLesson}\r\n              lessonTitle={lesson.title}\r\n              onComplete={() => handleLessonComplete(currentLesson)}\r\n              onNext={handleNextLesson}\r\n              hasNext={hasNext}\r\n              suppressWrapperCompletion={true}\r\n            >\r\n              <LessonComponent\r\n                onComplete={() => handleLessonComplete(currentLesson)}\r\n                onNext={handleNextLesson}\r\n                hasNext={hasNext}\r\n              />\r\n            </InteractiveLessonWrapper>\r\n          </div>\r\n        </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\nexport default InteractiveELTCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\InteractiveEconomicsCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2394,2397],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2394,2397],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight, X } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\nimport { StandardCourseAudioSection } from '@/components/course/StandardCourseAudioSection';\r\nimport { StandardLessonAudioButtons } from '@/components/course/StandardLessonAudioButtons';\r\n\r\n// Import background image\r\nimport economicsBg from '@/assets/economics-background.jpg';\r\n\r\n// Import lesson components\r\nimport { EconomicsIntroductionMicroLesson } from '@/components/micro-lessons/economics/EconomicsIntroductionMicroLesson';\r\nimport { EconomicsSupplyDemandMicroLesson } from '@/components/micro-lessons/economics/EconomicsSupplyDemandMicroLesson';\r\nimport { EconomicsMarketStructuresMicroLesson } from '@/components/micro-lessons/economics/EconomicsMarketStructuresMicroLesson';\r\nimport { EconomicsIndicatorsMicroLesson } from '@/components/micro-lessons/economics/EconomicsIndicatorsMicroLesson';\r\nimport { EconomicsMonetaryPolicyMicroLesson } from '@/components/micro-lessons/economics/EconomicsMonetaryPolicyMicroLesson';\r\nimport { EconomicsFiscalPolicyMicroLesson } from '@/components/micro-lessons/economics/EconomicsFiscalPolicyMicroLesson';\r\nimport { EconomicsInternationalTradeMicroLesson } from '@/components/micro-lessons/economics/EconomicsInternationalTradeMicroLesson';\r\nimport { EconomicsGrowthDevelopmentMicroLesson } from '@/components/micro-lessons/economics/EconomicsGrowthDevelopmentMicroLesson';\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\n// Moved outside component to prevent recreation on every render\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"Introduction to Economics\", description: \"Learn the fundamental concepts of economics and economic thinking\", component: EconomicsIntroductionMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 2, title: \"Supply and Demand\", description: \"Understand market forces and price determination mechanisms\", component: EconomicsSupplyDemandMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 3, title: \"Market Structures\", description: \"Explore different types of market competition and behavior\", component: EconomicsMarketStructuresMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 4, title: \"Economic Indicators\", description: \"Analyze key metrics that measure economic health and performance\", component: EconomicsIndicatorsMicroLesson, unit: \"Unit 2: Measurement\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 5, title: \"Monetary Policy\", description: \"Study central banking and money supply management strategies\", component: EconomicsMonetaryPolicyMicroLesson, unit: \"Unit 2: Measurement\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 6, title: \"Fiscal Policy\", description: \"Understand government spending and taxation policies\", component: EconomicsFiscalPolicyMicroLesson, unit: \"Unit 3: Policy & Growth\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 7, title: \"International Trade\", description: \"Explore global economic relationships and trade principles\", component: EconomicsInternationalTradeMicroLesson, unit: \"Unit 3: Policy & Growth\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 8, title: \"Economic Growth & Development\", description: \"Analyze factors driving economic progress and development\", component: EconomicsGrowthDevelopmentMicroLesson, unit: \"Unit 3: Policy & Growth\", unitColor: \"bg-purple-100 text-purple-700\" }\r\n];\r\n\r\nexport const InteractiveEconomicsCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  const [completedLessons, setCompletedLessons] = useState<number[]>([]);\r\n  const [accordionOpen, setAccordionOpen] = useState<string | undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    } else {\r\n      // Reset to course overview when no lesson ID is present\r\n      setCurrentLesson(null);\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = (lessonId: number) => {\r\n    if (!completedLessons.includes(lessonId)) {\r\n      setCompletedLessons(prev => [...prev, lessonId]);\r\n    }\r\n  };\r\n\r\n  // Memoize navigation handlers to prevent unnecessary re-renders\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/introduction-modern-economics/${nextLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handlePrevLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson > 1) {\r\n      const prevLesson = currentLesson - 1;\r\n      setCurrentLesson(prevLesson);\r\n      navigate(`/courses/introduction-modern-economics/${prevLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/introduction-modern-economics/${lessonId}`);\r\n    // Scroll to top of the page\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  // Memoize expensive calculations\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || completedLessons.includes(lessonId - 1);\r\n  }, [completedLessons]);\r\n\r\n  const progress = useMemo(() => (completedLessons.length / lessons.length) * 100, [completedLessons.length]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"introduction-modern-economics\"\r\n          courseTitle=\"Introduction to Modern Economics\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\" style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${economicsBg})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundAttachment: 'fixed'\r\n          }}>\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Introduction to Modern Economics\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              {/* Course Title and Description */}\r\n              <div className=\"text-center space-y-4\">\r\n                <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Introduction to Modern Economics</h1>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium\">\r\n                  Master the fundamental principles of modern economics, from basic market mechanisms to complex policy analysis. Build a solid foundation in economic thinking and real-world applications.\r\n                </p>\r\n                \r\n                {/* Course badges */}\r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~6 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Users className=\"w-4 h-4 mr-2\" />\r\n                    Beginner to Intermediate\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white mt-1 text-center font-medium\">\r\n                    {completedLessons.length} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Listen to Course Overview Section */}\r\n              <div className=\"mb-8\">\r\n                <StandardCourseAudioSection\r\n                  courseTitle=\"Introduction to Modern Economics\"\r\n                  courseDescription=\"Master the fundamental principles of modern economics, from basic market mechanisms to complex policy analysis. Build a solid foundation in economic thinking and real-world applications.\"\r\n                />\r\n              </div>\r\n\r\n              {/* Individual Lesson Audio Buttons */}\r\n              <div className=\"mb-8\">\r\n                <StandardLessonAudioButtons lessons={lessons} />\r\n              </div>\r\n\r\n              {/* Course Overview Section */}\r\n              <div className=\"mb-8 max-w-4xl mx-auto\">\r\n                <Accordion \r\n                  type=\"single\" \r\n                  collapsible \r\n                  className=\"w-full space-y-4\"\r\n                  value={accordionOpen}\r\n                  onValueChange={setAccordionOpen}\r\n                >\r\n                  <AccordionItem value=\"course-info\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-white/30 hover:bg-white/40 px-4 py-3 rounded-lg text-white border border-white/20\">\r\n                      Course Overview &amp; Learning Objectives\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"bg-white/30 backdrop-blur-sm border border-white/10 rounded-lg p-6 mt-2\">\r\n                      <div className=\"space-y-6 text-white\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">Why Learn Economics?</h3>\r\n                          <p className=\"leading-relaxed text-white/90\">\r\n                            Economics affects every aspect of our lives, from personal financial decisions to global policy. Understanding economic principles helps you make better decisions and understand how markets, governments, and societies function.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">What You'll Master</h3>\r\n                          <ul className=\"space-y-2\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Market Mechanics:</strong> Supply, demand, and price determination</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Economic Indicators:</strong> GDP, inflation, unemployment, and other key metrics</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Policy Analysis:</strong> Monetary and fiscal policy impacts</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Global Economics:</strong> International trade and economic development</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n\r\n              {/* Lesson Grid */}\r\n              <div className=\"max-w-6xl mx-auto\">\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                  {lessons.map((lesson) => {\r\n                    const isCompleted = completedLessons.includes(lesson.id);\r\n                    const isAccessible = isLessonAccessible(lesson.id);\r\n                    \r\n                    return (\r\n                      <Card \r\n                        key={lesson.id} \r\n                        className={`relative overflow-hidden transition-all duration-300 cursor-pointer group h-48 ${\r\n                          !isAccessible \r\n                            ? 'opacity-50 cursor-not-allowed bg-muted/50' \r\n                            : isCompleted \r\n                              ? 'ring-2 ring-green-500 bg-green-50/50 dark:bg-green-950/30' \r\n                              : 'hover:shadow-lg hover:-translate-y-1 bg-card/95 backdrop-blur-sm'\r\n                        }`}\r\n                        onClick={() => isAccessible && handleLessonSelect(lesson.id)}\r\n                      >\r\n                        <CardHeader className=\"pb-2\">\r\n                          <div className=\"flex items-start justify-between mb-2\">\r\n                            <Badge variant=\"secondary\" className={`text-xs px-2 py-1 ${lesson.unitColor} font-medium`}>\r\n                              {lesson.unit}\r\n                            </Badge>\r\n                            <div className=\"flex items-center gap-1\">\r\n                              <span className=\"text-sm font-bold text-muted-foreground\">\r\n                                {lesson.id}\r\n                              </span>\r\n                              {isCompleted && (\r\n                                <Award className=\"h-4 w-4 text-green-500\" />\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                          <CardTitle className=\"text-lg font-semibold line-clamp-2 text-foreground group-hover:text-primary transition-colors\">\r\n                            {lesson.title}\r\n                          </CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"pt-0\">\r\n                          <p className=\"text-sm text-muted-foreground line-clamp-3 leading-relaxed\">\r\n                            {lesson.description}\r\n                          </p>\r\n                          \r\n                          <div className=\"absolute bottom-4 right-4\">\r\n                            <div className={`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-colors ${\r\n                              isCompleted \r\n                                ? 'bg-green-500 text-white' \r\n                                : isAccessible \r\n                                  ? 'bg-primary text-primary-foreground group-hover:bg-primary/80' \r\n                                  : 'bg-muted text-muted-foreground'\r\n                            }`}>\r\n                              {isCompleted ? 'âœ“' : lesson.id}\r\n                            </div>\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Enhanced Course Information */}\r\n              <div className=\"max-w-4xl mx-auto\">\r\n                <Accordion \r\n                  type=\"single\" \r\n                  collapsible \r\n                  className=\"w-full space-y-4\"\r\n                  value={accordionOpen}\r\n                  onValueChange={setAccordionOpen}\r\n                >\r\n                  <AccordionItem value=\"enhanced-course-info\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-blue-50 dark:bg-blue-950/30 hover:bg-blue-100 dark:hover:bg-blue-900/40 px-4 py-3 rounded-lg text-blue-900 dark:text-blue-100\">\r\n                      Enhanced Economics Course Information\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"prose prose-gray max-w-none text-sm relative\">\r\n                      <div className=\"space-y-6 pr-12\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">Course Overview</h3>\r\n                          <p className=\"text-white leading-relaxed\">\r\n                            This comprehensive economics course provides a thorough introduction to modern economic principles and their real-world applications. From basic market mechanisms to complex policy analysis, you'll develop the analytical skills needed to understand and evaluate economic phenomena.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">Learning Objectives</h3>\r\n                          <ul className=\"space-y-2 text-white\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span>Understand fundamental economic concepts including scarcity, opportunity cost, and trade-offs</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span>Analyze supply and demand dynamics and their impact on market prices</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span>Evaluate different market structures and their characteristics</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span>Interpret key economic indicators and their significance</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span>Understand monetary and fiscal policy tools and their effects</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span>Analyze international trade principles and global economic relationships</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">Course Structure</h3>\r\n                          <p className=\"text-white mb-3\">The course is organized into three progressive units:</p>\r\n                          <div className=\"space-y-3\">\r\n                            <div className=\"bg-blue-50/10 p-3 rounded-lg\">\r\n                              <h4 className=\"font-semibold text-blue-200 mb-2\">Unit 1: Economic Foundations</h4>\r\n                              <p className=\"text-white text-sm\">Introduction to Economics, Supply and Demand, Market Structures</p>\r\n                            </div>\r\n                            <div className=\"bg-green-50/10 p-3 rounded-lg\">\r\n                              <h4 className=\"font-semibold text-green-200 mb-2\">Unit 2: Economic Measurement</h4>\r\n                              <p className=\"text-white text-sm\">Economic Indicators, Monetary Policy</p>\r\n                            </div>\r\n                            <div className=\"bg-purple-50/10 p-3 rounded-lg\">\r\n                              <h4 className=\"font-semibold text-purple-200 mb-2\">Unit 3: Policy & Growth</h4>\r\n                              <p className=\"text-white text-sm\">Fiscal Policy, International Trade, Economic Growth & Development</p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const selectedLesson = lessons.find(lesson => lesson.id === currentLesson);\r\n  if (selectedLesson) {\r\n    const LessonComponent = selectedLesson.component;\r\n    \r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"introduction-modern-economics\"\r\n          courseTitle=\"Introduction to Modern Economics\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <InteractiveLessonWrapper\r\n            courseId=\"introduction-modern-economics\"\r\n            lessonId={currentLesson}\r\n            lessonTitle={selectedLesson.title}\r\n            onComplete={() => handleLessonComplete(currentLesson)}\r\n            onNext={currentLesson < lessons.length ? handleNextLesson : undefined}\r\n            hasNext={currentLesson < lessons.length}\r\n          >\r\n            <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\">\r\n              <div className=\"container mx-auto px-4 py-8\">\r\n                <div className=\"mb-6 flex items-center justify-between\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => setCurrentLesson(null)}\r\n                    className=\"flex items-center gap-2\"\r\n                  >\r\n                    <ChevronLeft className=\"w-4 h-4\" />\r\n                    Back to Course\r\n                  </Button>\r\n                  \r\n                  <div className=\"flex items-center gap-4\">\r\n                    {currentLesson > 1 && (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        onClick={handlePrevLesson}\r\n                        className=\"flex items-center gap-2\"\r\n                      >\r\n                        <ChevronLeft className=\"w-4 h-4\" />\r\n                        Previous\r\n                      </Button>\r\n                    )}\r\n                    \r\n                    {currentLesson < lessons.length && (\r\n                      <Button\r\n                        onClick={handleNextLesson}\r\n                        className=\"flex items-center gap-2\"\r\n                      >\r\n                        Next\r\n                        <ChevronRight className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                \r\n                <LessonComponent />\r\n              </div>\r\n            </div>\r\n          </InteractiveLessonWrapper>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default InteractiveEconomicsCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\InteractiveLinearEquationsCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2100,2103],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2100,2103],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight, X, Calculator, Target, TrendingUp } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\n\r\n// Import background image\r\nimport linearEquationsBg from '@/assets/linear-equations-unique-bg.jpg';\r\n\r\n// Import lesson components\r\nimport { LinearEquationsIntroductionMicroLesson } from '@/components/micro-lessons/linear-equations/LinearEquationsIntroductionMicroLesson';\r\nimport { SOAPMethodMicroLesson } from '@/components/micro-lessons/linear-equations/SOAPMethodMicroLesson';\r\nimport { MultiStepEquationsMicroLesson } from '@/components/micro-lessons/linear-equations/MultiStepEquationsMicroLesson';\r\nimport { GraphingLinearEquationsMicroLesson } from '@/components/micro-lessons/linear-equations/GraphingLinearEquationsMicroLesson';\r\nimport { SpecialCasesMicroLesson } from '@/components/micro-lessons/linear-equations/SpecialCasesMicroLesson';\r\nimport { WordProblemsMicroLesson } from '@/components/micro-lessons/linear-equations/WordProblemsMicroLesson';\r\nimport { LinearEquationsMasteryMicroLesson } from '@/components/micro-lessons/linear-equations/LinearEquationsMasteryMicroLesson';\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\n// Moved outside component to prevent recreation on every render\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"Introduction to Linear Equations\", description: \"Learn what linear equations are and understand the balance concept\", component: LinearEquationsIntroductionMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 2, title: \"The SOAP Method\", description: \"Master the systematic approach to solving linear equations step-by-step\", component: SOAPMethodMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 3, title: \"Multi-Step Equations\", description: \"Tackle complex equations with distribution and combining like terms\", component: MultiStepEquationsMicroLesson, unit: \"Unit 2: Advanced Solving\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 4, title: \"Graphing Linear Equations\", description: \"Visualize equations on the coordinate plane and understand slopes\", component: GraphingLinearEquationsMicroLesson, unit: \"Unit 2: Advanced Solving\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 5, title: \"Special Cases\", description: \"Identify equations with no solution or infinite solutions\", component: SpecialCasesMicroLesson, unit: \"Unit 3: Applications\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 6, title: \"Word Problems\", description: \"Apply linear equation skills to solve real-world problems\", component: WordProblemsMicroLesson, unit: \"Unit 3: Applications\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 7, title: \"Linear Equations Mastery\", description: \"Complete challenging problems and celebrate your mathematical journey\", component: LinearEquationsMasteryMicroLesson, unit: \"Unit 3: Applications\", unitColor: \"bg-green-100 text-green-700\" }\r\n];\r\n\r\nconst InteractiveLinearEquationsCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  const [completedLessons, setCompletedLessons] = useState<number[]>([]);\r\n  const [accordionOpen, setAccordionOpen] = useState<string | undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    } else {\r\n      // Reset to course overview when no lesson ID is present\r\n      setCurrentLesson(null);\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = (lessonId: number) => {\r\n    if (!completedLessons.includes(lessonId)) {\r\n      setCompletedLessons(prev => [...prev, lessonId]);\r\n    }\r\n  };\r\n\r\n  // Memoize navigation handlers to prevent unnecessary re-renders\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/interactive-linear-equations/${nextLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handlePrevLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson > 1) {\r\n      const prevLesson = currentLesson - 1;\r\n      setCurrentLesson(prevLesson);\r\n      navigate(`/courses/interactive-linear-equations/${prevLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/interactive-linear-equations/${lessonId}`);\r\n    // Scroll to top of the page\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourseOverview = useCallback(() => {\r\n    navigate('/courses/interactive-linear-equations');\r\n  }, [navigate]);\r\n\r\n  // Memoize expensive calculations\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || completedLessons.includes(lessonId - 1);\r\n  }, [completedLessons]);\r\n\r\n  const progress = useMemo(() => (completedLessons.length / lessons.length) * 100, [completedLessons.length]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"interactive-linear-equations\"\r\n          courseTitle=\"Interactive Linear Equations\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\" style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${linearEquationsBg})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundAttachment: 'fixed'\r\n          }}>\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Interactive Linear Equations\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              {/* Course Title and Description */}\r\n              <div className=\"text-center space-y-4\">\r\n                <div className=\"flex justify-center items-center gap-3 mb-4\">\r\n                  <Calculator className=\"w-12 h-12 text-blue-400\" />\r\n                  <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Interactive Linear Equations</h1>\r\n                  <Target className=\"w-12 h-12 text-purple-400\" />\r\n                </div>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium\">\r\n                  Master the fundamentals of linear equations through interactive lessons and step-by-step problem solving. Build a strong algebraic foundation for advanced mathematics.\r\n                </p>\r\n                \r\n                {/* Course badges */}\r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~5 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Calculator className=\"w-4 h-4 mr-2\" />\r\n                    Algebra Foundation\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white mt-1 text-center font-medium\">\r\n                    {completedLessons.length} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Voice Controls */}\r\n              <div className=\"mb-8\">\r\n                <CourseOverviewTTS \r\n                  courseTitle=\"Interactive Linear Equations\"\r\n                  courseDescription=\"Master the fundamentals of linear equations through interactive lessons and step-by-step problem solving. Build a strong algebraic foundation for advanced mathematics.\"\r\n                  lessons={lessons}\r\n                />\r\n              </div>\r\n\r\n              {/* Enhanced Course Information */}\r\n              <div className=\"max-w-4xl mx-auto\">\r\n                <Accordion \r\n                  type=\"single\" \r\n                  collapsible \r\n                  className=\"w-full space-y-4\"\r\n                  value={accordionOpen}\r\n                  onValueChange={setAccordionOpen}\r\n                >\r\n                  <AccordionItem value=\"course-info\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-blue-50 dark:bg-blue-950/30 hover:bg-blue-100 dark:hover:bg-blue-900/40 px-4 py-3 rounded-lg text-blue-900 dark:text-blue-100\">\r\n                      Course Overview & Learning Objectives\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"prose prose-gray max-w-none text-sm relative\">\r\n                      <div className=\"space-y-6 pr-12\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Why Linear Equations Matter</h3>\r\n                          <p className=\"text-white leading-relaxed\">\r\n                            Linear equations are the foundation of algebra and essential for success in higher mathematics, science, engineering, and many real-world applications. This course provides you with the tools and confidence to solve linear equations systematically and understand their graphical representations.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">What You'll Learn</h3>\r\n                          <ul className=\"space-y-2 text-white\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Linear Equation Fundamentals:</strong> Understanding what linear equations are and the balance concept</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>SOAP Solving Method:</strong> A systematic approach to solve any linear equation step-by-step</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Multi-Step Equations:</strong> Working with distribution, combining like terms, and complex problems</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Graphing Skills:</strong> Visualizing linear equations on coordinate planes and understanding slopes</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Special Cases:</strong> Identifying equations with no solution or infinitely many solutions</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Word Problems:</strong> Applying linear equation skills to solve real-world problems</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Interactive Learning Features</h3>\r\n                          <p className=\"text-white mb-3\">Throughout this course, you'll experience:</p>\r\n                          <ul className=\"space-y-1 text-white\">\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Step-by-step interactive problem solving</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Visual representations and graphing tools</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Practice problems with immediate feedback</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Real-world applications and word problems</li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n\r\n              {/* Lessons Grid */}\r\n              <div className=\"max-w-6xl mx-auto\">\r\n                <h2 className=\"text-2xl font-bold text-white mb-8 text-center\">Course Lessons</h2>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  {lessons.map((lesson) => {\r\n                    const isAccessible = isLessonAccessible(lesson.id);\r\n                    const isCompleted = completedLessons.includes(lesson.id);\r\n                    \r\n                    return (\r\n                      <Card \r\n                        key={lesson.id}\r\n                        className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg bg-card/65 backdrop-blur-sm border-border ${\r\n                          !isAccessible ? 'opacity-50' : ''\r\n                        } ${isCompleted ? 'border-primary/50' : 'border-border'}`}\r\n                        onClick={() => isAccessible && handleLessonSelect(lesson.id)}\r\n                      >\r\n                        <CardHeader className=\"pb-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <Badge variant=\"outline\" className={lesson.unitColor}>\r\n                              {lesson.unit}\r\n                            </Badge>\r\n                            {isCompleted && <Award className=\"w-5 h-5 text-primary\" />}\r\n                          </div>\r\n                          <CardTitle className=\"text-lg\">{lesson.title}</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                          <p className=\"text-muted-foreground text-sm mb-4\">{lesson.description}</p>\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-xs text-muted-foreground\">Lesson {lesson.id}</span>\r\n                            {!isAccessible && (\r\n                              <span className=\"text-xs text-muted-foreground\">Complete previous lesson</span>\r\n                            )}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const currentLessonData = lessons.find(l => l.id === currentLesson);\r\n  \r\n  if (!currentLessonData) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Lesson Not Found</h2>\r\n            <p className=\"text-white mb-4 font-medium\">\r\n              The requested lesson could not be found.\r\n            </p>\r\n            <Button onClick={() => setCurrentLesson(null)}>\r\n              Back to Course Overview\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasNext = currentLesson < lessons.length;\r\n  const hasPrev = currentLesson > 1;\r\n\r\n  const LessonComponent = currentLessonData.component;\r\n\r\n  return (\r\n    <VoiceSettingsProvider>\r\n      <InteractiveCourseWrapper \r\n        courseId=\"interactive-linear-equations\"\r\n        courseTitle=\"Interactive Linear Equations\"\r\n        currentLesson={currentLesson}\r\n        totalLessons={lessons.length}\r\n      >\r\n        <div className=\"min-h-screen bg-background\" style={{\r\n          backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${linearEquationsBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundAttachment: 'fixed'\r\n        }}>\r\n          <CourseHeader \r\n            onDashboard={handleDashboard}\r\n            onBackToCourses={handleBackToCourses}\r\n            courseTitle=\"Interactive Linear Equations\"\r\n          />\r\n\r\n          <div className=\"container mx-auto px-4 py-6\">\r\n            <InteractiveLessonWrapper\r\n              courseId=\"interactive-linear-equations\"\r\n              lessonId={currentLesson}\r\n              lessonTitle={currentLessonData.title}\r\n              totalLessons={lessons.length}\r\n            >\r\n              <LessonComponent\r\n                onComplete={() => handleLessonComplete(currentLesson)}\r\n                onNext={hasNext ? handleNextLesson : undefined}\r\n                hasNext={hasNext}\r\n              />\r\n            </InteractiveLessonWrapper>\r\n          </div>\r\n        </div>\r\n      </InteractiveCourseWrapper>\r\n    </VoiceSettingsProvider>\r\n  );\r\n};\r\n\r\nexport default InteractiveLinearEquationsCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\InteractiveNeurodiversityCoursePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\InteractiveScienceCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3259,3262],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3259,3262],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { useInteractiveCourseProgress } from '@/hooks/useInteractiveCourseProgress';\r\nimport { useCourseEnrollment } from '@/hooks/useCourseEnrollment';\r\nimport { useInteractiveCourseEnrollmentBridge } from '@/hooks/useInteractiveCourseEnrollmentBridge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport CourseOverviewVideo from '@/components/course/CourseOverviewVideo';\r\nimport { StandardCourseAudioSection } from '@/components/course/StandardCourseAudioSection';\r\nimport { StandardLessonAudioButtons } from '@/components/course/StandardLessonAudioButtons';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\n\r\n// Import background image\r\nimport scienceCourseBg from '@/assets/science-course-background.jpg';\r\n\r\n// Import micro-lesson components\r\nimport { ScientificMethodMicroLesson } from '@/components/micro-lessons/science/scientific-method/ScientificMethodMicroLesson';\r\nimport { ImportanceOfScienceMicroLesson } from '@/components/micro-lessons/science/importance-of-science/ImportanceOfScienceMicroLesson';\r\nimport { CellStructureMicroLesson } from '@/components/micro-lessons/science/cell-structure/CellStructureMicroLesson';\r\nimport { GeneticsDNAMicroLesson } from '@/components/micro-lessons/science/genetics-dna/GeneticsDNAMicroLesson';\r\nimport { AtomsMoleculesMicroLesson } from '@/components/micro-lessons/science/atoms-molecules/AtomsMoleculesMicroLesson';\r\nimport { PeriodicTableMicroLesson } from '@/components/micro-lessons/science/periodic-table/PeriodicTableMicroLesson';\r\nimport { ForcesMotionMicroLesson } from '@/components/micro-lessons/science/forces-motion/ForcesMotionMicroLesson';\r\nimport { EnergyWorkMicroLesson } from '@/components/micro-lessons/science/energy-work/EnergyWorkMicroLesson';\r\nimport { ReviewSummaryMicroLesson } from '@/components/micro-lessons/science/review-summary/ReviewSummaryMicroLesson';\r\nimport { FurtherExplorationMicroLesson } from '@/components/micro-lessons/science/further-exploration/FurtherExplorationMicroLesson';\r\nimport { ShortAnswerQuestionsMicroLesson } from '@/components/micro-lessons/science/short-answer-questions/ShortAnswerQuestionsMicroLesson';\r\nimport { StudyGuideMicroLesson } from '@/components/micro-lessons/science/study-guide/StudyGuideMicroLesson';\r\n\r\n// All lessons are now converted to micro-lessons!\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\n// Moved outside component to prevent recreation on every render\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"The Scientific Method\", description: \"Learn the fundamental steps of scientific inquiry and how to apply them\", component: ScientificMethodMicroLesson, unit: \"Unit 1: The Scientific Method\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 2, title: \"The Importance of Science\", description: \"Discover how science shapes our understanding of the world\", component: ImportanceOfScienceMicroLesson, unit: \"Unit 1: The Scientific Method\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 3, title: \"Cell Structure and Function\", description: \"Explore the basic building blocks of all living organisms\", component: CellStructureMicroLesson, unit: \"Unit 2: Biology\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 4, title: \"Genetics and DNA\", description: \"Understand heredity and the molecular basis of life\", component: GeneticsDNAMicroLesson, unit: \"Unit 2: Biology\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 5, title: \"Atoms and Molecules\", description: \"Learn about the fundamental particles that make up matter\", component: AtomsMoleculesMicroLesson, unit: \"Unit 3: Chemistry\", unitColor: \"bg-red-100 text-red-700\" },\r\n  { id: 6, title: \"The Periodic Table\", description: \"Master the organization of chemical elements\", component: PeriodicTableMicroLesson, unit: \"Unit 3: Chemistry\", unitColor: \"bg-red-100 text-red-700\" },\r\n  { id: 7, title: \"Forces and Motion\", description: \"Discover the principles that govern how objects move\", component: ForcesMotionMicroLesson, unit: \"Unit 4: Physics\", unitColor: \"bg-yellow-100 text-yellow-700\" },\r\n  { id: 8, title: \"Energy and Work\", description: \"Understand different forms of energy and how work is done\", component: EnergyWorkMicroLesson, unit: \"Unit 4: Physics\", unitColor: \"bg-yellow-100 text-yellow-700\" },\r\n  { id: 9, title: \"Review and Summary\", description: \"Consolidate your learning with comprehensive review\", component: ReviewSummaryMicroLesson, unit: \"Unit 5: Conclusion\", unitColor: \"bg-gray-100 text-gray-700\" },\r\n  { id: 10, title: \"Further Exploration\", description: \"Explore advanced topics and real-world applications\", component: FurtherExplorationMicroLesson, unit: \"Unit 5: Conclusion\", unitColor: \"bg-gray-100 text-gray-700\" },\r\n  { id: 11, title: \"Short-Answer Questions\", description: \"Test your knowledge with focused practice questions\", component: ShortAnswerQuestionsMicroLesson, unit: \"Unit 6: Study Guide\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 12, title: \"Complete Study Guide\", description: \"Comprehensive guide for mastering all course concepts\", component: StudyGuideMicroLesson, unit: \"Unit 6: Study Guide\", unitColor: \"bg-purple-100 text-purple-700\" }\r\n];\r\n\r\nexport const InteractiveScienceCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n\r\n  // Use analytics and progress hooks\r\n  const courseId = 'interactive-science';\r\n  const courseTitle = 'Interactive Science';\r\n  const {\r\n    completedLessons,\r\n    isLessonCompleted,\r\n    calculateProgress,\r\n    saveLessonCompletion,\r\n    progressData\r\n  } = useInteractiveCourseProgress(courseId);\r\n  \r\n  const { enrollInCourse, isEnrolling } = useCourseEnrollment();\r\n  const isEnrolled = progressData?.enrollment !== null;\r\n  \r\n  useInteractiveCourseEnrollmentBridge();\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = (lessonId: number) => {\r\n    if (!completedLessons.has(lessonId)) {\r\n      const lesson = lessons.find(l => l.id === lessonId);\r\n      if (lesson) {\r\n        saveLessonCompletion(lessonId, lesson.title);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Memoize navigation handlers to prevent unnecessary re-renders\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/interactive-science/${nextLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handlePrevLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson > 1) {\r\n      const prevLesson = currentLesson - 1;\r\n      setCurrentLesson(prevLesson);\r\n      navigate(`/courses/interactive-science/${prevLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/interactive-science/${lessonId}`);\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  // Memoize expensive calculations\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || completedLessons.has(lessonId - 1);\r\n  }, [completedLessons]);\r\n\r\n  const progress = useMemo(() => (completedLessons.size / lessons.length) * 100, [completedLessons.size]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"interactive-science\"\r\n          courseTitle=\"Interactive Introduction to Science\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div \r\n            className=\"min-h-screen bg-cover bg-center bg-fixed\"\r\n            style={{ backgroundImage: `url(${scienceCourseBg})` }}\r\n          >\r\n            <div className=\"min-h-screen bg-gradient-to-br from-black/60 to-black/40\">\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Introduction to Science\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              {/* Course Title and Description */}\r\n              <div className=\"text-center space-y-4\">\r\n              <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Interactive Introduction to Science</h1>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium drop-shadow\">\r\n                  Get to grips with the basics of biology, chemistry, and physics. Learn the scientific method and explore the building blocks of life and matter.\r\n                </p>\r\n                \r\n                {/* Course badges */}\r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"outline\" className=\"text-sm px-3 py-1 bg-white/80 text-gray-900 border-white/50 font-semibold\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"outline\" className=\"text-sm px-3 py-1 bg-white/80 text-gray-900 border-white/50 font-semibold\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~6 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"outline\" className=\"text-sm px-3 py-1 bg-white/80 text-gray-900 border-white/50 font-semibold\">\r\n                    <Users className=\"w-4 h-4 mr-2\" />\r\n                    Beginner\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white/90 mt-1 text-center font-medium drop-shadow\">\r\n                    {completedLessons.size} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Listen to Course Overview Section */}\r\n              <div className=\"mb-8\">\r\n                <StandardCourseAudioSection\r\n                  courseTitle=\"Introduction to Science\"\r\n                  courseDescription=\"Get to grips with the basics of biology, chemistry, and physics. Learn the scientific method and explore the building blocks of life and matter.\"\r\n                />\r\n              </div>\r\n\r\n              {/* Individual Lesson Audio Buttons */}\r\n              <div className=\"mb-8\">\r\n                <StandardLessonAudioButtons lessons={lessons} />\r\n              </div>\r\n\r\n              {/* Course Overview Section */}\r\n              <div className=\"mb-8 max-w-4xl mx-auto\">\r\n                <Accordion type=\"single\" collapsible className=\"w-full\">\r\n                  <AccordionItem value=\"course-overview\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-white/30 hover:bg-white/40 px-4 py-3 rounded-lg text-white border border-white/20\">\r\n                      Course Overview &amp; Learning Objectives\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"bg-white/30 backdrop-blur-sm border border-white/10 rounded-lg p-6 mt-2\">\r\n                      <div className=\"space-y-6 text-white\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">Why Learn Science?</h3>\r\n                          <p className=\"leading-relaxed text-white/90\">\r\n                            Science provides the tools to understand the natural world around us. From the smallest atoms to the largest ecosystems, scientific knowledge helps us make informed decisions and solve real-world problems.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">What You'll Master</h3>\r\n                          <ul className=\"space-y-2\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Scientific Method:</strong> Learn systematic approaches to investigation and discovery</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Biology Fundamentals:</strong> Understand cells, genetics, and the building blocks of life</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Chemistry Basics:</strong> Explore atoms, molecules, and the periodic table</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Physics Principles:</strong> Master forces, motion, energy, and work</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n\r\n              {/* Video Overview */}\r\n              <CourseOverviewVideo \r\n                videoUrl=\"https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/A_Guide_to_the_Sciences.mp4\" \r\n                title=\"Introduction to Science\"\r\n              />\r\n\r\n              {/* Lessons Grid */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto\">\r\n                {lessons.map((lesson) => {\r\n                  const isCompleted = completedLessons.has(lesson.id);\r\n                  const isAccessible = isLessonAccessible(lesson.id);\r\n\r\n                  return (\r\n                    <Card \r\n                      key={lesson.id}\r\n                      className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg bg-white/90 backdrop-blur-sm border-white/30 ${\r\n                        !isAccessible ? 'opacity-50' : ''\r\n                      } ${isCompleted ? 'border-primary/50 bg-white/95' : ''}`}\r\n                      onClick={() => isAccessible && setCurrentLesson(lesson.id)}\r\n                    >\r\n                      <CardHeader className=\"pb-3\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"flex items-center space-x-3\">\r\n                            <div className={`p-2 rounded-lg ${\r\n                              isCompleted \r\n                                ? 'bg-primary text-primary-foreground' \r\n                                : 'bg-muted text-muted-foreground'\r\n                            }`}>\r\n                              {isCompleted ? <Award className=\"w-5 h-5\" /> : <BookOpen className=\"w-5 h-5\" />}\r\n                            </div>\r\n                            <div>\r\n                              <Badge className={lesson.unitColor}>\r\n                                Lesson {lesson.id}\r\n                              </Badge>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <CardTitle className=\"text-lg mt-2\">{lesson.title}</CardTitle>\r\n                      </CardHeader>\r\n                      <CardContent>\r\n                        <p className=\"text-sm text-muted-foreground mb-3\">{lesson.description}</p>\r\n                        <Badge variant=\"outline\" className={lesson.unitColor}>\r\n                          {lesson.unit}\r\n                        </Badge>\r\n                      </CardContent>\r\n                    </Card>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const currentLessonData = lessons.find(l => l.id === currentLesson);\r\n  \r\n  if (!currentLessonData) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Lesson Not Found</h2>\r\n            <p className=\"text-muted-foreground mb-4\">\r\n              The requested lesson could not be found.\r\n            </p>\r\n            <Button onClick={() => setCurrentLesson(null)}>\r\n              Back to Course Overview\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasNext = currentLesson < lessons.length;\r\n  const hasPrev = currentLesson > 1;\r\n  const LessonComponent = currentLessonData.component;\r\n\r\n  return (\r\n    <VoiceSettingsProvider>\r\n      <InteractiveCourseWrapper \r\n        courseId=\"interactive-science\"\r\n        courseTitle=\"Introduction to Science\"\r\n        currentLesson={currentLesson}\r\n        totalLessons={lessons.length}\r\n      >\r\n        <div \r\n          className=\"min-h-screen bg-cover bg-center bg-fixed\"\r\n          style={{ backgroundImage: `url(${scienceCourseBg})` }}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-black/60 to-black/40\">\r\n            <CourseHeader \r\n              onBackToCourses={handleBackToCourses}\r\n              onDashboard={handleDashboard}\r\n              courseTitle=\"Introduction to Science\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 max-w-6xl\">\r\n              <div className=\"flex items-center gap-4 mb-6\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => {\r\n                    console.log('ðŸ”˜ Back to Overview button clicked');\r\n                    setCurrentLesson(null);\r\n                  }}\r\n                  className=\"flex items-center gap-2 bg-white/10 text-white border-white/30 hover:bg-white/20\"\r\n                >\r\n                  <ChevronLeft className=\"h-4 w-4\" />\r\n                  Back to Overview\r\n                </Button>\r\n              <Badge className={currentLessonData.unitColor}>\r\n                {currentLessonData.unit}\r\n              </Badge>\r\n            </div>\r\n\r\n            {/* Navigation */}\r\n              <div className=\"flex justify-between items-center mb-6\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={handlePrevLesson}\r\n                  disabled={!hasPrev}\r\n                  className=\"flex items-center gap-2 bg-white/10 text-white border-white/30 hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  <ChevronLeft className=\"h-4 w-4\" />\r\n                  Previous Lesson\r\n                </Button>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-sm text-white/80 font-medium\">\r\n                    Lesson {currentLesson} of {lessons.length}\r\n                  </span>\r\n                </div>\r\n\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={handleNextLesson}\r\n                  disabled={!hasNext}\r\n                  className=\"flex items-center gap-2 bg-white/10 text-white border-white/30 hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  Next Lesson\r\n                  <ChevronRight className=\"h-4 w-4\" />\r\n                </Button>\r\n              </div>\r\n\r\n            {/* Lesson Content */}\r\n            <InteractiveLessonWrapper\r\n              courseId=\"interactive-science\"\r\n              lessonId={currentLesson}\r\n              lessonTitle={currentLessonData.title}\r\n              onComplete={() => handleLessonComplete(currentLesson)}\r\n              onNext={hasNext ? handleNextLesson : undefined}\r\n              hasNext={hasNext}\r\n              totalLessons={lessons.length}\r\n            >\r\n              <LessonComponent />\r\n            </InteractiveLessonWrapper>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        </InteractiveCourseWrapper>\r\n    </VoiceSettingsProvider>\r\n  );\r\n};\r\n\r\nexport default InteractiveScienceCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\InteractiveTrigonometryCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2273,2276],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2273,2276],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight, X, Calculator, Target, Brain } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\nimport { StandardCourseAudioSection } from '@/components/course/StandardCourseAudioSection';\r\nimport { StandardLessonAudioButtons } from '@/components/course/StandardLessonAudioButtons';\r\n\r\n// Import background image\r\nimport trigBg from '@/assets/trigonometry-background.jpg';\r\n\r\n// Import micro-lesson components\r\nimport TrigonometryIntroductionMicroLesson from '@/components/micro-lessons/trigonometry/TrigonometryIntroductionMicroLesson';\r\nimport TrigonometryRatiosMicroLesson from '@/components/micro-lessons/trigonometry/TrigonometryRatiosMicroLesson';\r\nimport TrigonometryUnitCircleMicroLesson from '@/components/micro-lessons/trigonometry/TrigonometryUnitCircleMicroLesson';\r\nimport TrigonometryGraphingMicroLesson from '@/components/micro-lessons/trigonometry/TrigonometryGraphingMicroLesson';\r\nimport TrigonometryIdentitiesMicroLesson from '@/components/micro-lessons/trigonometry/TrigonometryIdentitiesMicroLesson';\r\nimport TrigonometryEquationsMicroLesson from '@/components/micro-lessons/trigonometry/TrigonometryEquationsMicroLesson';\r\nimport TrigonometryApplicationsMicroLesson from '@/components/micro-lessons/trigonometry/TrigonometryApplicationsMicroLesson';\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"Introduction to Trigonometry\", description: \"Discover the basics of trigonometry, angles, and right triangles\", component: TrigonometryIntroductionMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 2, title: \"Trigonometric Ratios\", description: \"Master SOHCAHTOA and the six trigonometric functions\", component: TrigonometryRatiosMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 3, title: \"The Unit Circle\", description: \"Understand the unit circle and reference angles\", component: TrigonometryUnitCircleMicroLesson, unit: \"Unit 2: Circle\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 4, title: \"Graphing Trig Functions\", description: \"Learn to graph sine, cosine, and tangent functions\", component: TrigonometryGraphingMicroLesson, unit: \"Unit 2: Circle\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 5, title: \"Trigonometric Identities\", description: \"Explore fundamental trigonometric identities and proofs\", component: TrigonometryIdentitiesMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 6, title: \"Solving Trig Equations\", description: \"Master techniques for solving trigonometric equations\", component: TrigonometryEquationsMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 7, title: \"Real-World Applications\", description: \"Apply trigonometry to engineering, physics, and technology\", component: TrigonometryApplicationsMicroLesson, unit: \"Unit 4: Applications\", unitColor: \"bg-orange-100 text-orange-700\" }\r\n];\r\n\r\nconst InteractiveTrigonometryCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  const [completedLessons, setCompletedLessons] = useState<number[]>([]);\r\n  const [accordionOpen, setAccordionOpen] = useState<string | undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    } else {\r\n      setCurrentLesson(null);\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = (lessonId: number) => {\r\n    if (!completedLessons.includes(lessonId)) {\r\n      setCompletedLessons(prev => [...prev, lessonId]);\r\n    }\r\n  };\r\n\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/interactive-trigonometry/${nextLesson}`);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/interactive-trigonometry/${lessonId}`);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || completedLessons.includes(lessonId - 1);\r\n  }, [completedLessons]);\r\n\r\n  const progress = useMemo(() => (completedLessons.length / lessons.length) * 100, [completedLessons.length]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"interactive-trigonometry\"\r\n          courseTitle=\"Interactive Trigonometry\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\" style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${trigBg})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundAttachment: 'fixed'\r\n          }}>\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Interactive Trigonometry\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              <div className=\"text-center space-y-4\">\r\n                <div className=\"flex justify-center items-center gap-3 mb-4\">\r\n                  <Calculator className=\"w-12 h-12 text-purple-400\" />\r\n                  <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Interactive Trigonometry</h1>\r\n                  <Brain className=\"w-12 h-12 text-purple-400\" />\r\n                </div>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium\">\r\n                  Master trigonometric functions, the unit circle, identities, and real-world applications through interactive lessons and step-by-step problem solving.\r\n                </p>\r\n                \r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~6 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Target className=\"w-4 h-4 mr-2\" />\r\n                    Functions & Applications\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white mt-1 text-center font-medium\">\r\n                    {completedLessons.length} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Listen to Course Overview Section */}\r\n              <div className=\"mb-8\">\r\n                <StandardCourseAudioSection\r\n                  courseTitle=\"Interactive Trigonometry\"\r\n                  courseDescription=\"Master trigonometric functions, the unit circle, identities, and real-world applications through interactive lessons and step-by-step problem solving.\"\r\n                />\r\n              </div>\r\n\r\n              {/* Individual Lesson Audio Buttons */}\r\n              <div className=\"mb-8\">\r\n                <StandardLessonAudioButtons lessons={lessons} />\r\n              </div>\r\n\r\n              {/* Course Overview Section */}\r\n              <div className=\"mb-8 max-w-4xl mx-auto\">\r\n                <Accordion \r\n                  type=\"single\" \r\n                  collapsible \r\n                  className=\"w-full space-y-4\"\r\n                  value={accordionOpen}\r\n                  onValueChange={setAccordionOpen}\r\n                >\r\n                  <AccordionItem value=\"course-info\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-white/30 hover:bg-white/40 px-4 py-3 rounded-lg text-white border border-white/20\">\r\n                      Course Overview &amp; Learning Objectives\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"bg-white/30 backdrop-blur-sm border border-white/10 rounded-lg p-6 mt-2\">\r\n                      <div className=\"space-y-6 text-white\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">Why Learn Trigonometry?</h3>\r\n                          <p className=\"leading-relaxed text-white/90\">\r\n                            Trigonometry is essential for engineering, physics, computer graphics, and many other fields. It provides the mathematical foundation for understanding waves, rotations, and periodic phenomena in the real world.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3\">What You'll Master</h3>\r\n                          <ul className=\"space-y-2\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Trigonometric Ratios:</strong> Sine, cosine, tangent and their applications</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Unit Circle:</strong> Reference angles and special values</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Function Graphing:</strong> Visualizing trigonometric functions and transformations</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Real-World Applications:</strong> Engineering, physics, and technology problems</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n\r\n              {/* Lessons Grid */}\r\n              <div className=\"max-w-6xl mx-auto\">\r\n                <h2 className=\"text-2xl font-bold text-white mb-8 text-center\">Course Lessons</h2>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  {lessons.map((lesson) => {\r\n                    const isAccessible = isLessonAccessible(lesson.id);\r\n                    const isCompleted = completedLessons.includes(lesson.id);\r\n                    \r\n                    return (\r\n                      <Card \r\n                        key={lesson.id}\r\n                        className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg bg-card/65 backdrop-blur-sm border-border ${\r\n                          !isAccessible ? 'opacity-50' : ''\r\n                        } ${isCompleted ? 'border-primary/50' : 'border-border'}`}\r\n                        onClick={() => isAccessible && handleLessonSelect(lesson.id)}\r\n                      >\r\n                        <CardHeader className=\"pb-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <Badge variant=\"outline\" className={lesson.unitColor}>\r\n                              {lesson.unit}\r\n                            </Badge>\r\n                            {isCompleted && <Award className=\"w-5 h-5 text-primary\" />}\r\n                          </div>\r\n                          <CardTitle className=\"text-lg\">{lesson.title}</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                          <p className=\"text-muted-foreground text-sm mb-4\">{lesson.description}</p>\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-xs text-muted-foreground\">Lesson {lesson.id}</span>\r\n                            {!isAccessible && (\r\n                              <span className=\"text-xs text-muted-foreground\">Complete previous lesson</span>\r\n                            )}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const currentLessonData = lessons.find(l => l.id === currentLesson);\r\n  \r\n  if (!currentLessonData) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Lesson Not Found</h2>\r\n            <Button onClick={() => setCurrentLesson(null)}>\r\n              Back to Course Overview\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasNext = currentLesson < lessons.length;\r\n  const LessonComponent = currentLessonData.component;\r\n\r\n  return (\r\n    <VoiceSettingsProvider>\r\n      <InteractiveCourseWrapper \r\n        courseId=\"interactive-trigonometry\"\r\n        courseTitle=\"Interactive Trigonometry\"\r\n        currentLesson={currentLesson}\r\n        totalLessons={lessons.length}\r\n      >\r\n        <div className=\"min-h-screen bg-background\" style={{\r\n          backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${trigBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundAttachment: 'fixed'\r\n        }}>\r\n          <CourseHeader \r\n            onDashboard={handleDashboard} \r\n            onBackToCourses={handleBackToCourses}\r\n            title={`Lesson ${currentLessonData.id}: ${currentLessonData.title}`}\r\n          />\r\n\r\n          <div className=\"container mx-auto px-4 py-8\">\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <Button \r\n                variant=\"outline\" \r\n                onClick={() => setCurrentLesson(null)}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Back to Course\r\n              </Button>\r\n              \r\n              <div className=\"text-center\">\r\n                <Badge className={currentLessonData.unitColor}>\r\n                  {currentLessonData.unit}\r\n                </Badge>\r\n                <h1 className=\"text-2xl font-bold text-white mt-2\">\r\n                  Lesson {currentLessonData.id}: {currentLessonData.title}\r\n                </h1>\r\n              </div>\r\n\r\n              <div className=\"w-24\" />\r\n            </div>\r\n\r\n            <InteractiveLessonWrapper\r\n              courseId=\"interactive-trigonometry\"\r\n              lessonId={currentLesson}\r\n              lessonTitle={currentLessonData.title}\r\n              onComplete={() => handleLessonComplete(currentLesson!)}\r\n              onNext={hasNext ? handleNextLesson : undefined}\r\n              hasNext={hasNext}\r\n            >\r\n              <LessonComponent />\r\n            </InteractiveLessonWrapper>\r\n          </div>\r\n        </div>\r\n      </InteractiveCourseWrapper>\r\n    </VoiceSettingsProvider>\r\n  );\r\n};\r\n\r\nexport default InteractiveTrigonometryCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\LogicCriticalThinkingCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2351,2354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2351,2354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight, X, Brain, Target, Lightbulb } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\nimport { StandardCourseAudioSection } from '@/components/course/StandardCourseAudioSection';\r\nimport { StandardLessonAudioButtons } from '@/components/course/StandardLessonAudioButtons';\r\n\r\n// Import background image\r\nimport logicBg from '@/assets/logic-background.jpg';\r\n\r\n// Import micro-lesson components\r\nimport { LogicIntroductionMicroLesson } from '@/components/micro-lessons/logic/LogicIntroductionMicroLesson';\r\nimport { LogicArgumentsMicroLesson } from '@/components/micro-lessons/logic/LogicArgumentsMicroLesson';\r\nimport { LogicIdentificationMicroLesson } from '@/components/micro-lessons/logic/LogicIdentificationMicroLesson';\r\nimport { LogicEvaluationMicroLesson } from '@/components/micro-lessons/logic/LogicEvaluationMicroLesson';\r\nimport { LogicDeductiveMicroLesson } from '@/components/micro-lessons/logic/LogicDeductiveMicroLesson';\r\nimport { LogicFormsMicroLesson } from '@/components/micro-lessons/logic/LogicFormsMicroLesson';\r\nimport { LogicComplexMicroLesson } from '@/components/micro-lessons/logic/LogicComplexMicroLesson';\r\nimport { LogicTestingMicroLesson } from '@/components/micro-lessons/logic/LogicTestingMicroLesson';\r\nimport { LogicInductiveMicroLesson } from '@/components/micro-lessons/logic/LogicInductiveMicroLesson';\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\n// Moved outside component to prevent recreation on every render\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"What is Critical Thinking?\", description: \"Explore the foundations of rational thought and learn to distinguish between automatic thinking and deliberate reasoning\", component: LogicIntroductionMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 2, title: \"Arguments vs. Opinions\", description: \"Learn to identify and differentiate between arguments, opinions, and personal beliefs\", component: LogicArgumentsMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 3, title: \"Identifying Arguments in Context\", description: \"Practice recognizing arguments in real-world scenarios and everyday conversations\", component: LogicIdentificationMicroLesson, unit: \"Unit 1: Foundations\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 4, title: \"Evaluating Argument Quality\", description: \"Develop skills to assess the strength and validity of different arguments\", component: LogicEvaluationMicroLesson, unit: \"Unit 2: Analysis\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 5, title: \"What is Deductive Reasoning?\", description: \"Master the principles of deductive logic and logical inference\", component: LogicDeductiveMicroLesson, unit: \"Unit 2: Analysis\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 6, title: \"Basic Logical Forms\", description: \"Learn fundamental logical structures and patterns of reasoning\", component: LogicFormsMicroLesson, unit: \"Unit 2: Analysis\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 7, title: \"Complex Deductive Arguments\", description: \"Tackle advanced deductive reasoning and multi-step logical arguments\", component: LogicComplexMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 8, title: \"Testing Deductive Arguments\", description: \"Apply systematic methods to validate and verify logical arguments\", component: LogicTestingMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 9, title: \"The Nature of Inductive Arguments\", description: \"Understand inductive reasoning and its role in critical thinking\", component: LogicInductiveMicroLesson, unit: \"Unit 3: Advanced\", unitColor: \"bg-purple-100 text-purple-700\" }\r\n];\r\n\r\nconst LogicCriticalThinkingCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  const [completedLessons, setCompletedLessons] = useState<number[]>([]);\r\n  const [accordionOpen, setAccordionOpen] = useState<string | undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    } else {\r\n      setCurrentLesson(null);\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = (lessonId: number) => {\r\n    if (!completedLessons.includes(lessonId)) {\r\n      setCompletedLessons(prev => [...prev, lessonId]);\r\n    }\r\n  };\r\n\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/logic-critical-thinking/${nextLesson}`);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/logic-critical-thinking/${lessonId}`);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || completedLessons.includes(lessonId - 1);\r\n  }, [completedLessons]);\r\n\r\n  const progress = useMemo(() => (completedLessons.length / lessons.length) * 100, [completedLessons.length]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"logic-critical-thinking\"\r\n          courseTitle=\"Logic and Critical Thinking\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\" style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${logicBg})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundAttachment: 'fixed'\r\n          }}>\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Logic and Critical Thinking\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              {/* Course Title and Description */}\r\n              <div className=\"text-center space-y-4\">\r\n                <div className=\"flex justify-center items-center gap-3 mb-4\">\r\n                  <Brain className=\"w-12 h-12 text-purple-400\" />\r\n                  <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Logic and Critical Thinking</h1>\r\n                  <Lightbulb className=\"w-12 h-12 text-purple-400\" />\r\n                </div>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium\">\r\n                  Master the art of rational thinking and logical reasoning. Develop critical thinking skills \r\n                  to analyze arguments, identify fallacies, and make sound decisions in academic and personal contexts.\r\n                </p>\r\n                \r\n                {/* Course badges */}\r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~4 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Target className=\"w-4 h-4 mr-2\" />\r\n                    Critical Analysis\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white mt-1 text-center font-medium\">\r\n                    {completedLessons.length} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Listen to Course Overview Section */}\r\n              <div className=\"mb-8\">\r\n                <StandardCourseAudioSection\r\n                  courseTitle=\"Logic and Critical Thinking\"\r\n                  courseDescription=\"Master the art of rational thinking and logical reasoning. Develop critical thinking skills to analyze arguments, identify fallacies, and make sound decisions in academic and personal contexts.\"\r\n                />\r\n              </div>\r\n\r\n              {/* Individual Lesson Audio Buttons */}\r\n              <div className=\"mb-8\">\r\n                <StandardLessonAudioButtons lessons={lessons} />\r\n              </div>\r\n\r\n              {/* Enhanced Course Information */}\r\n              <div className=\"max-w-4xl mx-auto\">\r\n                <Accordion \r\n                  type=\"single\" \r\n                  collapsible \r\n                  className=\"w-full space-y-4\"\r\n                  value={accordionOpen}\r\n                  onValueChange={setAccordionOpen}\r\n                >\r\n                  <AccordionItem value=\"course-info\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-white/30 hover:bg-white/40 px-4 py-3 rounded-lg text-white border border-white/20\">\r\n                      Course Overview &amp; Learning Objectives\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"prose prose-gray max-w-none text-sm relative\">\r\n                      <div className=\"space-y-6 pr-12\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Why Learn Critical Thinking?</h3>\r\n                          <p className=\"text-white leading-relaxed\">\r\n                            Critical thinking is the foundation of good decision-making, academic success, and effective communication. It helps you evaluate information objectively, avoid logical fallacies, and construct persuasive arguments based on evidence and reason.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">What You'll Master</h3>\r\n                          <ul className=\"space-y-2 text-white\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Critical Analysis:</strong> Distinguish between facts, opinions, and arguments</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Argument Evaluation:</strong> Assess the strength and validity of reasoning</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Deductive Reasoning:</strong> Master logical forms and valid inference patterns</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Inductive Reasoning:</strong> Understand probabilistic reasoning and pattern recognition</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Real-World Application:</strong> Apply logical thinking to everyday decisions and academic work</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Interactive Learning Experience</h3>\r\n                          <p className=\"text-white mb-3\">This course uses a micro-lesson approach with:</p>\r\n                          <ul className=\"space-y-1 text-white\">\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Clear explanations of logical concepts and principles</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Real-world examples from news, advertisements, and conversations</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Practice exercises to test your understanding</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Progressive difficulty building from basic to advanced reasoning</li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n\r\n              {/* Lessons Grid */}\r\n              <div className=\"max-w-6xl mx-auto\">\r\n                <h2 className=\"text-2xl font-bold text-white mb-8 text-center\">Course Lessons</h2>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  {lessons.map((lesson) => {\r\n                    const isAccessible = isLessonAccessible(lesson.id);\r\n                    const isCompleted = completedLessons.includes(lesson.id);\r\n                    \r\n                    return (\r\n                      <Card \r\n                        key={lesson.id}\r\n                        className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg bg-card/65 backdrop-blur-sm border-border ${\r\n                          !isAccessible ? 'opacity-50' : ''\r\n                        } ${isCompleted ? 'border-primary/50' : 'border-border'}`}\r\n                        onClick={() => isAccessible && handleLessonSelect(lesson.id)}\r\n                      >\r\n                        <CardHeader className=\"pb-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <Badge variant=\"outline\" className={lesson.unitColor}>\r\n                              {lesson.unit}\r\n                            </Badge>\r\n                            {isCompleted && <Award className=\"w-5 h-5 text-primary\" />}\r\n                          </div>\r\n                          <CardTitle className=\"text-lg\">{lesson.title}</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                          <p className=\"text-muted-foreground text-sm mb-4\">{lesson.description}</p>\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-xs text-muted-foreground\">Lesson {lesson.id}</span>\r\n                            {!isAccessible && (\r\n                              <span className=\"text-xs text-muted-foreground\">Complete previous lesson</span>\r\n                            )}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const currentLessonData = lessons.find(l => l.id === currentLesson);\r\n  \r\n  if (!currentLessonData) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Lesson Not Found</h2>\r\n            <p className=\"text-white mb-4 font-medium\">\r\n              The requested lesson could not be found.\r\n            </p>\r\n            <Button onClick={() => setCurrentLesson(null)}>\r\n              Back to Course Overview\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasNext = currentLesson < lessons.length;\r\n  const LessonComponent = currentLessonData.component;\r\n\r\n  return (\r\n    <VoiceSettingsProvider>\r\n      <InteractiveCourseWrapper \r\n        courseId=\"logic-critical-thinking\"\r\n        courseTitle=\"Logic and Critical Thinking\"\r\n        currentLesson={currentLesson}\r\n        totalLessons={lessons.length}\r\n      >\r\n        <div className=\"min-h-screen bg-background\" style={{\r\n          backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${logicBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundAttachment: 'fixed'\r\n        }}>\r\n          <CourseHeader \r\n            onDashboard={handleDashboard} \r\n            onBackToCourses={handleBackToCourses}\r\n            title={`Lesson ${currentLessonData.id}: ${currentLessonData.title}`}\r\n          />\r\n\r\n          <div className=\"container mx-auto px-4 py-8\">\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <Button \r\n                variant=\"outline\" \r\n                onClick={() => setCurrentLesson(null)}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Back to Course\r\n              </Button>\r\n              \r\n              <div className=\"text-center\">\r\n                <Badge className={currentLessonData.unitColor}>\r\n                  {currentLessonData.unit}\r\n                </Badge>\r\n                <h1 className=\"text-2xl font-bold text-white mt-2\">\r\n                  Lesson {currentLessonData.id}: {currentLessonData.title}\r\n                </h1>\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-sm text-white\">\r\n                  {currentLesson} of {lessons.length}\r\n                </span>\r\n                <Progress value={(currentLesson / lessons.length) * 100} className=\"w-20 h-2\" />\r\n              </div>\r\n            </div>\r\n\r\n            <InteractiveLessonWrapper\r\n              courseId=\"logic-critical-thinking\"\r\n              lessonId={currentLesson}\r\n              lessonTitle={currentLessonData.title}\r\n              onComplete={() => handleLessonComplete(currentLessonData.id)}\r\n              onNext={handleNextLesson}\r\n              hasNext={hasNext}\r\n              totalLessons={lessons.length}\r\n            >\r\n              <LessonComponent \r\n                onComplete={() => handleLessonComplete(currentLessonData.id)}\r\n                onNext={handleNextLesson}\r\n                hasNext={hasNext}\r\n              />\r\n            </InteractiveLessonWrapper>\r\n          </div>\r\n        </div>\r\n      </InteractiveCourseWrapper>\r\n    </VoiceSettingsProvider>\r\n  );\r\n};\r\n\r\nexport default LogicCriticalThinkingCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\courses\\MoneyManagementCoursePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2094,2097],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2094,2097],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { InteractiveCourseWrapper } from '@/components/course/InteractiveCourseWrapper';\r\nimport { InteractiveLessonWrapper } from '@/components/course/InteractiveLessonWrapper';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BookOpen, Clock, Users, Award, ChevronLeft, ChevronRight, X, DollarSign, TrendingUp, PiggyBank } from 'lucide-react';\r\nimport CourseHeader from '@/components/course/CourseHeader';\r\nimport { VoiceSettingsProvider } from '@/contexts/VoiceSettingsContext';\r\nimport CourseOverviewTTS from '@/components/course/CourseOverviewTTS';\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\r\n\r\n// Import background image\r\nimport moneyManagementBg from '@/assets/money-management-background.jpg';\r\n\r\n// Import lesson components\r\nimport { FinancialFoundationsMicroLesson } from '@/components/micro-lessons/money-management/FinancialFoundationsMicroLesson';\r\nimport { BankingAccountsMicroLesson } from '@/components/micro-lessons/money-management/BankingAccountsMicroLesson';\r\nimport { BudgetingMasteryMicroLesson } from '@/components/micro-lessons/money-management/BudgetingMasteryMicroLesson';\r\nimport { SavingStrategiesMicroLesson } from '@/components/micro-lessons/money-management/SavingStrategiesMicroLesson';\r\nimport { InvestingBasicsMicroLesson } from '@/components/micro-lessons/money-management/InvestingBasicsMicroLesson';\r\nimport { CreditDebtPlanningMicroLesson } from '@/components/micro-lessons/money-management/CreditDebtPlanningMicroLesson';\r\nimport { MoneyManagementGameMicroLesson } from '@/components/micro-lessons/money-management/MoneyManagementGameMicroLesson';\r\n\r\ninterface Lesson {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  component: React.ComponentType<any>;\r\n  unit: string;\r\n  unitColor: string;\r\n}\r\n\r\n// Moved outside component to prevent recreation on every render\r\nconst lessons: Lesson[] = [\r\n  { id: 1, title: \"Financial Foundations\", description: \"Learn basic financial concepts, money values, and needs vs wants\", component: FinancialFoundationsMicroLesson, unit: \"Unit 1: Basics\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 2, title: \"Banking and Accounts\", description: \"Understand banking basics, account types, and safety practices\", component: BankingAccountsMicroLesson, unit: \"Unit 1: Basics\", unitColor: \"bg-green-100 text-green-700\" },\r\n  { id: 3, title: \"Budgeting Mastery\", description: \"Create budgets, track expenses, and manage income effectively\", component: BudgetingMasteryMicroLesson, unit: \"Unit 2: Planning\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 4, title: \"Smart Saving Strategies\", description: \"Explore savings accounts, compound interest, and goal setting\", component: SavingStrategiesMicroLesson, unit: \"Unit 2: Planning\", unitColor: \"bg-blue-100 text-blue-700\" },\r\n  { id: 5, title: \"Introduction to Investing\", description: \"Learn basic investment concepts and long-term wealth building\", component: InvestingBasicsMicroLesson, unit: \"Unit 3: Growth\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 6, title: \"Credit, Debt, and Future Planning\", description: \"Understand credit scores, responsible borrowing, and financial goals\", component: CreditDebtPlanningMicroLesson, unit: \"Unit 3: Growth\", unitColor: \"bg-purple-100 text-purple-700\" },\r\n  { id: 7, title: \"Financial Decision-Making Game\", description: \"Apply your knowledge in an interactive money management simulation\", component: MoneyManagementGameMicroLesson, unit: \"Unit 3: Growth\", unitColor: \"bg-purple-100 text-purple-700\" }\r\n];\r\n\r\nconst MoneyManagementCoursePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { lessonId } = useParams();\r\n  const [currentLesson, setCurrentLesson] = useState<number | null>(null);\r\n  const [completedLessons, setCompletedLessons] = useState<number[]>([]);\r\n  const [accordionOpen, setAccordionOpen] = useState<string | undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (lessonId) {\r\n      const lesson = parseInt(lessonId);\r\n      if (lesson >= 1 && lesson <= lessons.length) {\r\n        setCurrentLesson(lesson);\r\n      }\r\n    } else {\r\n      // Reset to course overview when no lesson ID is present\r\n      setCurrentLesson(null);\r\n    }\r\n  }, [lessonId]);\r\n\r\n  const handleLessonComplete = (lessonId: number) => {\r\n    if (!completedLessons.includes(lessonId)) {\r\n      setCompletedLessons(prev => [...prev, lessonId]);\r\n    }\r\n  };\r\n\r\n  // Memoize navigation handlers to prevent unnecessary re-renders\r\n  const handleNextLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson < lessons.length) {\r\n      const nextLesson = currentLesson + 1;\r\n      setCurrentLesson(nextLesson);\r\n      navigate(`/courses/money-management-teens/${nextLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handlePrevLesson = useCallback(() => {\r\n    if (currentLesson !== null && currentLesson > 1) {\r\n      const prevLesson = currentLesson - 1;\r\n      setCurrentLesson(prevLesson);\r\n      navigate(`/courses/money-management-teens/${prevLesson}`);\r\n      // Scroll to top of the page\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [currentLesson, navigate]);\r\n\r\n  const handleLessonSelect = useCallback((lessonId: number) => {\r\n    setCurrentLesson(lessonId);\r\n    navigate(`/courses/money-management-teens/${lessonId}`);\r\n    // Scroll to top of the page\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  }, [navigate]);\r\n\r\n  const handleBackToCourses = useCallback(() => {\r\n    console.log('ðŸ“ Navigating back to courses');\r\n    navigate('/dashboard/learner/courses');\r\n  }, [navigate]);\r\n\r\n  const handleDashboard = useCallback(() => {\r\n    navigate('/dashboard/learner');\r\n  }, [navigate]);\r\n\r\n  // Memoize expensive calculations\r\n  const isLessonAccessible = useCallback((lessonId: number) => {\r\n    return lessonId === 1 || completedLessons.includes(lessonId - 1);\r\n  }, [completedLessons]);\r\n\r\n  const progress = useMemo(() => (completedLessons.length / lessons.length) * 100, [completedLessons.length]);\r\n\r\n  // Course overview (lesson selection)\r\n  if (currentLesson === null) {\r\n    return (\r\n      <VoiceSettingsProvider>\r\n        <InteractiveCourseWrapper\r\n          courseId=\"money-management-teens\"\r\n          courseTitle=\"Money Management for Teens\"\r\n          currentLesson={currentLesson}\r\n          totalLessons={lessons.length}\r\n        >\r\n          <div className=\"min-h-screen bg-gradient-to-br from-background to-muted/20\" style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${moneyManagementBg})`,\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            backgroundAttachment: 'fixed'\r\n          }}>\r\n            <CourseHeader \r\n              onDashboard={handleDashboard} \r\n              onBackToCourses={handleBackToCourses}\r\n              courseTitle=\"Money Management for Teens\"\r\n            />\r\n          \r\n            <div className=\"container mx-auto px-4 py-8 space-y-8\">\r\n              {/* Course Title and Description */}\r\n              <div className=\"text-center space-y-4\">\r\n                <div className=\"flex justify-center items-center gap-3 mb-4\">\r\n                  <DollarSign className=\"w-12 h-12 text-green-400\" />\r\n                  <h1 className=\"text-4xl font-bold text-white drop-shadow-lg\">Money Management for Teens</h1>\r\n                  <TrendingUp className=\"w-12 h-12 text-green-400\" />\r\n                </div>\r\n                <p className=\"text-xl text-white max-w-3xl mx-auto font-medium\">\r\n                  Build essential financial literacy skills for life success. Learn budgeting, saving, banking, and smart money decisions to secure your financial future.\r\n                </p>\r\n                \r\n                {/* Course badges */}\r\n                <div className=\"flex justify-center gap-4 flex-wrap\">\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                    {lessons.length} Lessons\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <Clock className=\"w-4 h-4 mr-2\" />\r\n                    ~5 Hours\r\n                  </Badge>\r\n                  <Badge variant=\"secondary\" className=\"text-sm px-3 py-1 bg-white/90 text-gray-800 border-white/20\">\r\n                    <PiggyBank className=\"w-4 h-4 mr-2\" />\r\n                    Financial Literacy\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={progress} className=\"h-2 mb-2\" />\r\n                  <p className=\"text-xs text-white mt-1 text-center font-medium\">\r\n                    {completedLessons.length} of {lessons.length} lessons completed\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Voice Controls */}\r\n              <div className=\"mb-8\">\r\n                <CourseOverviewTTS \r\n                  courseTitle=\"Money Management for Teens\"\r\n                  courseDescription=\"Build essential financial literacy skills for life success. Learn budgeting, saving, banking, and smart money decisions to secure your financial future.\"\r\n                  lessons={lessons}\r\n                />\r\n              </div>\r\n\r\n              {/* Enhanced Course Information */}\r\n              <div className=\"max-w-4xl mx-auto\">\r\n                <Accordion \r\n                  type=\"single\" \r\n                  collapsible \r\n                  className=\"w-full space-y-4\"\r\n                  value={accordionOpen}\r\n                  onValueChange={setAccordionOpen}\r\n                >\r\n                  <AccordionItem value=\"course-info\">\r\n                    <AccordionTrigger className=\"flex items-center justify-center text-center text-xl font-semibold bg-green-50 dark:bg-green-950/30 hover:bg-green-100 dark:hover:bg-green-900/40 px-4 py-3 rounded-lg text-green-900 dark:text-green-100\">\r\n                      Course Overview & Learning Objectives\r\n                    </AccordionTrigger>\r\n                    <AccordionContent className=\"prose prose-gray max-w-none text-sm relative\">\r\n                      <div className=\"space-y-6 pr-12\">\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Why Financial Literacy Matters for Teens</h3>\r\n                          <p className=\"text-white leading-relaxed\">\r\n                            Financial literacy is one of the most important life skills you can develop as a teenager. This course provides practical, real-world knowledge that will help you make smart money decisions throughout your life, from managing your first job's paycheck to planning for major purchases and your financial future.\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">What You'll Learn</h3>\r\n                          <ul className=\"space-y-2 text-white\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Financial Foundations:</strong> Understanding money, making smart spending decisions, and distinguishing between needs and wants</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Banking Essentials:</strong> How to open and manage bank accounts, use ATMs safely, and understand banking fees</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Budgeting Skills:</strong> Creating and maintaining a budget, tracking expenses, and using budgeting tools and apps</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Saving Strategies:</strong> Understanding compound interest, setting financial goals, and building emergency funds</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Investment Basics:</strong> Introduction to investing concepts, risk vs. return, and long-term wealth building</span>\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                              <span className=\"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0\"></span>\r\n                              <span><strong>Credit and Debt:</strong> Understanding credit scores, responsible borrowing, and avoiding debt traps</span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h3 className=\"text-lg font-semibold mb-3 text-white\">Real-World Applications</h3>\r\n                          <p className=\"text-white mb-3\">Throughout this course, you'll work with:</p>\r\n                          <ul className=\"space-y-1 text-white\">\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Interactive budget calculators and planning tools</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Real-world scenarios and case studies</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Practical exercises using actual financial products and services</li>\r\n                            <li className=\"flex gap-3\"><span className=\"font-medium text-foreground\">â€¢</span> Goal-setting frameworks for short and long-term financial objectives</li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </AccordionContent>\r\n                  </AccordionItem>\r\n                </Accordion>\r\n              </div>\r\n\r\n              {/* Lessons Grid */}\r\n              <div className=\"max-w-6xl mx-auto\">\r\n                <h2 className=\"text-2xl font-bold text-white mb-8 text-center\">Course Lessons</h2>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  {lessons.map((lesson) => {\r\n                    const isAccessible = isLessonAccessible(lesson.id);\r\n                    const isCompleted = completedLessons.includes(lesson.id);\r\n                    \r\n                    return (\r\n                      <Card \r\n                        key={lesson.id}\r\n                        className={`relative transition-all duration-200 cursor-pointer hover:shadow-lg bg-card/65 backdrop-blur-sm border-border ${\r\n                          !isAccessible ? 'opacity-50' : ''\r\n                        } ${isCompleted ? 'border-primary/50' : 'border-border'}`}\r\n                        onClick={() => isAccessible && handleLessonSelect(lesson.id)}\r\n                      >\r\n                        <CardHeader className=\"pb-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <Badge variant=\"outline\" className={lesson.unitColor}>\r\n                              {lesson.unit}\r\n                            </Badge>\r\n                            {isCompleted && <Award className=\"w-5 h-5 text-primary\" />}\r\n                          </div>\r\n                          <CardTitle className=\"text-lg\">{lesson.title}</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                          <p className=\"text-muted-foreground text-sm mb-4\">{lesson.description}</p>\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-xs text-muted-foreground\">Lesson {lesson.id}</span>\r\n                            {!isAccessible && (\r\n                              <span className=\"text-xs text-muted-foreground\">Complete previous lesson</span>\r\n                            )}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </InteractiveCourseWrapper>\r\n      </VoiceSettingsProvider>\r\n    );\r\n  }\r\n\r\n  // Individual lesson view\r\n  const currentLessonData = lessons.find(l => l.id === currentLesson);\r\n  \r\n  if (!currentLessonData) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Lesson Not Found</h2>\r\n            <p className=\"text-white mb-4 font-medium\">\r\n              The requested lesson could not be found.\r\n            </p>\r\n            <Button onClick={() => setCurrentLesson(null)}>\r\n              Back to Course Overview\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const hasNext = currentLesson < lessons.length;\r\n  const hasPrev = currentLesson > 1;\r\n\r\n  const LessonComponent = currentLessonData.component;\r\n\r\n  return (\r\n    <VoiceSettingsProvider>\r\n      <InteractiveCourseWrapper \r\n        courseId=\"money-management-teens\"\r\n        courseTitle=\"Money Management for Teens\"\r\n        currentLesson={currentLesson}\r\n        totalLessons={lessons.length}\r\n      >\r\n        <div className=\"min-h-screen bg-background\" style={{\r\n          backgroundImage: `linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${moneyManagementBg})`,\r\n          backgroundSize: 'cover',\r\n          backgroundPosition: 'center',\r\n          backgroundAttachment: 'fixed'\r\n        }}>\r\n          <CourseHeader \r\n            onBackToCourses={() => navigate('/dashboard/learner/courses')}\r\n            onDashboard={handleDashboard}\r\n            courseTitle=\"Money Management for Teens\"\r\n          />\r\n          \r\n          <div className=\"container mx-auto px-4 py-8 max-w-6xl\">\r\n            <div className=\"flex items-center gap-4 mb-6\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setCurrentLesson(null)}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Back to Overview\r\n              </Button>\r\n              <Badge className={currentLessonData.unitColor}>\r\n                {currentLessonData.unit}\r\n              </Badge>\r\n            </div>\r\n\r\n            {/* Navigation */}\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handlePrevLesson}\r\n                disabled={!hasPrev}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n                Previous Lesson\r\n              </Button>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-sm text-white font-medium\">\r\n                  Lesson {currentLesson} of {lessons.length}\r\n                </span>\r\n              </div>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handleNextLesson}\r\n                disabled={!hasNext}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                Next Lesson\r\n                <ChevronRight className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Lesson Progress Card */}\r\n            <Card className=\"mb-6 bg-white/10 backdrop-blur-sm border-white/20\">\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-10 h-10 bg-primary/20 rounded-full flex items-center justify-center\">\r\n                    <Clock className=\"w-5 h-5 text-primary\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"text-lg font-semibold text-white\">\r\n                      Lesson {currentLesson}: {currentLessonData.title}\r\n                    </h3>\r\n                    <div className=\"flex items-center gap-4 text-sm text-white/80 mt-1\">\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <Clock className=\"w-4 h-4\" />\r\n                        0:06\r\n                      </span>\r\n                      <span className=\"flex items-center gap-1\">\r\n                        ðŸ“ˆ Engagement: 0%\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Listen to Lesson */}\r\n            <Card className=\"mb-6 bg-white/10 backdrop-blur-sm border-white/20\">\r\n              <CardContent className=\"p-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <DollarSign className=\"w-5 h-5 text-primary\" />\r\n                    <span className=\"text-white font-medium\">Listen to Lesson</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-white\">\r\n                      âš™ï¸\r\n                    </Button>\r\n                    <Button className=\"bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600 text-white\">\r\n                      â–¶ï¸ Read Lesson\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Lesson Content */}\r\n            <InteractiveLessonWrapper\r\n              courseId=\"money-management-teens\"\r\n              lessonId={currentLesson}\r\n              lessonTitle={currentLessonData.title}\r\n              onComplete={() => handleLessonComplete(currentLesson)}\r\n              onNext={hasNext ? handleNextLesson : undefined}\r\n              hasNext={hasNext}\r\n              totalLessons={lessons.length}\r\n            >\r\n              <LessonComponent \r\n                onComplete={() => handleLessonComplete(currentLesson)}\r\n                onNext={hasNext ? handleNextLesson : undefined}\r\n                hasNext={hasNext}\r\n              />\r\n            </InteractiveLessonWrapper>\r\n          </div>\r\n        </div>\r\n      </InteractiveCourseWrapper>\r\n    </VoiceSettingsProvider>\r\n  );\r\n};\r\n\r\nexport default MoneyManagementCoursePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\AIStudyCoach.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\DynamicCourse.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\FlashcardManagerPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\Gamification.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\Goals.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\InstructorDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\LearnerHome.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\LearningAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\LearningStateCourse.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\LearningStateEmbed.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\Library.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'clearResults' and 'handleSearch'. Either include them or remove the dependency array.","line":77,"column":6,"nodeType":"ArrayExpression","endLine":77,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [clearResults, handleSearch, searchQuery]","fix":{"range":[2887,2900],"text":"[clearResults, handleSearch, searchQuery]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { ToggleGroup, ToggleGroupItem } from '@/components/ui/toggle-group';\r\nimport { Search, BookOpen, Filter, Grid, List, Upload, Users, Globe, HelpCircle } from 'lucide-react';\r\nimport { FirstVisitVideoModal } from '@/components/common/FirstVisitVideoModal';\r\nimport { useFirstVisitVideo } from '@/hooks/useFirstVisitVideo';\r\nimport { PageHelpTrigger } from '@/components/common/PageHelpTrigger';\r\nimport { usePublicDomainBooks } from '@/hooks/usePublicDomainBooks';\r\nimport { useOpenLibrarySearch } from '@/hooks/useOpenLibrarySearch';\r\nimport LibraryWithMonitoring from '@/components/library/LibraryWithMonitoring';\r\nimport PublicDomainBooksSection from '@/components/library/PublicDomainBooksSection';\r\nimport UserUploadsSection from '@/components/library/UserUploadsSection';\r\nimport ApprovedStorageBooksSection from '@/components/library/ApprovedStorageBooksSection';\r\nimport CommunityLibraryContent from '@/components/library/CommunityLibraryContent';\r\nimport { ErrorBoundary } from '@/components/ErrorBoundary';\r\n\r\ntype ViewMode = 'grid' | 'list';\r\n\r\nconst Library = () => {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [viewMode, setViewMode] = useState<ViewMode>('grid');\r\n  const [activeTab, setActiveTab] = useState('public-domain');\r\n\r\n  // Video guide modal state\r\n  const { hasSeenVideo, shouldShowAuto, markVideoAsSeen } = useFirstVisitVideo('library_intro_seen');\r\n  const [isVideoModalOpen, setIsVideoModalOpen] = useState(false);\r\n\r\n  // Show video modal automatically on first visit\r\n  useEffect(() => {\r\n    if (shouldShowAuto()) {\r\n      setIsVideoModalOpen(true);\r\n    }\r\n  }, [shouldShowAuto]);\r\n\r\n  const handleCloseVideoModal = () => {\r\n    setIsVideoModalOpen(false);\r\n    markVideoAsSeen();\r\n  };\r\n\r\n  const handleShowVideoManually = () => {\r\n    setIsVideoModalOpen(true);\r\n  };\r\n  \r\n  const { books: publicDomainBooks, isLoading: pdLoading } = usePublicDomainBooks();\r\n  const { \r\n    books: searchResults, \r\n    isLoading: searchLoading, \r\n    searchBooks,\r\n    clearResults \r\n  } = useOpenLibrarySearch();\r\n\r\n  // Handle search\r\n  const handleSearch = async (query: string) => {\r\n    if (query.trim()) {\r\n      await searchBooks(query);\r\n      setActiveTab('search-results');\r\n    } else {\r\n      clearResults();\r\n    }\r\n  };\r\n\r\n  // Auto-search when query changes (debounced)\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      if (searchQuery.trim()) {\r\n        handleSearch(searchQuery);\r\n      } else {\r\n        clearResults();\r\n      }\r\n    }, 500);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [searchQuery]);\r\n\r\n  const renderPublicDomainSection = () => (\r\n    <ErrorBoundary>\r\n      <PublicDomainBooksSection viewMode={viewMode} />\r\n    </ErrorBoundary>\r\n  );\r\n\r\n  const renderSearchResults = () => {\r\n    if (searchLoading) {\r\n      return (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\r\n          {Array.from({ length: 8 }).map((_, i) => (\r\n            <Card key={i} className=\"animate-pulse\">\r\n              <div className=\"aspect-[3/4] bg-gray-200\"></div>\r\n              <CardContent className=\"p-3\">\r\n                <div className=\"h-4 bg-gray-200 rounded mb-2\"></div>\r\n                <div className=\"h-3 bg-gray-200 rounded\"></div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (!searchResults?.length) {\r\n      return (\r\n        <div className=\"text-center py-12\">\r\n          <Search className=\"h-16 w-16 text-muted-foreground mx-auto mb-4\" />\r\n          <h3 className=\"text-lg font-semibold mb-2\">\r\n            {searchQuery ? 'No results found' : 'Search the library'}\r\n          </h3>\r\n          <p className=\"text-muted-foreground\">\r\n            {searchQuery \r\n              ? `No books found for \"${searchQuery}\". Try a different search term.`\r\n              : 'Enter a search term to find books from millions of titles.'\r\n            }\r\n          </p>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <p className=\"text-sm text-muted-foreground\">\r\n          Found {searchResults.length} results for \"{searchQuery}\"\r\n        </p>\r\n        <div className={viewMode === 'grid' \r\n          ? \"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\"\r\n          : \"space-y-4\"\r\n        }>\r\n          {searchResults.map((book) => (\r\n            <Card key={book.key} className=\"hover:shadow-md transition-shadow\">\r\n              {viewMode === 'grid' ? (\r\n                <div>\r\n                  <div className=\"aspect-[3/4] bg-gray-100 flex items-center justify-center\">\r\n                    {book.cover_i ? (\r\n                      <img\r\n                        src={`https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg`}\r\n                        alt={book.title}\r\n                        className=\"w-full h-full object-cover\"\r\n                      />\r\n                    ) : (\r\n                      <BookOpen className=\"h-12 w-12 text-gray-400\" />\r\n                    )}\r\n                  </div>\r\n                  <CardContent className=\"p-3\">\r\n                    <h3 className=\"font-semibold text-sm line-clamp-2 mb-1\">\r\n                      {book.title}\r\n                    </h3>\r\n                    <p className=\"text-xs text-muted-foreground line-clamp-1\">\r\n                      {book.author_name?.[0] || 'Unknown Author'}\r\n                    </p>\r\n                    {book.first_publish_year && (\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {book.first_publish_year}\r\n                      </p>\r\n                    )}\r\n                  </CardContent>\r\n                </div>\r\n              ) : (\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex gap-4\">\r\n                    <div className=\"w-16 h-20 bg-gray-100 flex items-center justify-center flex-shrink-0\">\r\n                      {book.cover_i ? (\r\n                        <img\r\n                          src={`https://covers.openlibrary.org/b/id/${book.cover_i}-S.jpg`}\r\n                          alt={book.title}\r\n                          className=\"w-full h-full object-cover\"\r\n                        />\r\n                      ) : (\r\n                        <BookOpen className=\"h-8 w-8 text-gray-400\" />\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <h3 className=\"font-semibold text-sm line-clamp-2 mb-1\">\r\n                        {book.title}\r\n                      </h3>\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {book.author_name?.[0] || 'Unknown Author'}\r\n                      </p>\r\n                      {book.first_publish_year && (\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          Published: {book.first_publish_year}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              )}\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <LibraryWithMonitoring>\r\n      <div className=\"container mx-auto p-4 sm:p-6 space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"space-y-4\">\r\n          <div>\r\n            <div className=\"flex flex-col items-center gap-2\">\r\n              <h1 className=\"text-3xl font-bold text-gray-900\">Library</h1>\r\n              <PageHelpTrigger onOpen={handleShowVideoManually} />\r\n            </div>\r\n            <p className=\"text-muted-foreground text-center mt-2\">\r\n              Discover, read, and organize your digital book collection\r\n            </p>\r\n          </div>\r\n\r\n          {/* Search Bar */}\r\n          <div className=\"relative max-w-2xl\">\r\n            <Search className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\r\n            <Input\r\n              type=\"text\"\r\n              placeholder=\"Search millions of books...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-10 pr-4 py-2\"\r\n            />\r\n          </div>\r\n\r\n          {/* Controls */}\r\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <Button variant=\"outline\" size=\"sm\">\r\n                <Filter className=\"h-4 w-4 mr-2\" />\r\n                Filters\r\n              </Button>\r\n            </div>\r\n            \r\n            <ToggleGroup \r\n              type=\"single\" \r\n              value={viewMode} \r\n              onValueChange={(value) => value && setViewMode(value as ViewMode)}\r\n              className=\"border rounded-md\"\r\n            >\r\n              <ToggleGroupItem value=\"grid\" aria-label=\"Grid view\">\r\n                <Grid className=\"h-4 w-4\" />\r\n                <span className=\"ml-2 hidden sm:inline\">Grid</span>\r\n              </ToggleGroupItem>\r\n              <ToggleGroupItem value=\"list\" aria-label=\"List view\">\r\n                <List className=\"h-4 w-4\" />\r\n                <span className=\"ml-2 hidden sm:inline\">List</span>\r\n              </ToggleGroupItem>\r\n            </ToggleGroup>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Library Tabs */}\r\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n          <TabsList className=\"grid w-full grid-cols-2 lg:grid-cols-3\">\r\n            <TabsTrigger value=\"public-domain\" className=\"flex items-center gap-2\">\r\n              <Globe className=\"h-4 w-4\" />\r\n              <span className=\"hidden sm:inline\">Public Domain</span>\r\n              <span className=\"sm:hidden\">Public</span>\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"uploads\" className=\"flex items-center gap-2\">\r\n              <Upload className=\"h-4 w-4\" />\r\n              <span className=\"hidden sm:inline\">Your Uploads</span>\r\n              <span className=\"sm:hidden\">Uploads</span>\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"search-results\" className=\"flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4\" />\r\n              <span className=\"hidden sm:inline\">Search Results</span>\r\n              <span className=\"sm:hidden\">Search</span>\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"public-domain\" className=\"mt-6\">\r\n            {renderPublicDomainSection()}\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"uploads\" className=\"mt-6\">\r\n            <ErrorBoundary>\r\n              <UserUploadsSection viewMode={viewMode} />\r\n            </ErrorBoundary>\r\n          </TabsContent>\r\n\r\n\r\n          <TabsContent value=\"search-results\" className=\"mt-6\">\r\n            {renderSearchResults()}\r\n          </TabsContent>\r\n        </Tabs>\r\n\r\n        {/* Video Guide Modal */}\r\n        <FirstVisitVideoModal\r\n          isOpen={isVideoModalOpen}\r\n          onClose={handleCloseVideoModal}\r\n          title=\"How to Use Library\"\r\n          videoUrl=\"https://www.youtube.com/embed/9t5czXP0UBk?si=gAemx4af6QQFl5Xa\"\r\n        />\r\n      </div>\r\n    </LibraryWithMonitoring>\r\n  );\r\n};\r\n\r\nexport default Library;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\LiveLearningHub.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\MyCourses.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":472,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":472,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19827,19830],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19827,19830],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { BookOpen, Clock, User, Search, Filter, HelpCircle, Plus, Loader2, ChevronDown } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { useCourses } from '@/hooks/useCourses';\r\nimport { useEnrollmentProgress } from '@/hooks/useEnrollmentProgress';\r\nimport { useAutoEnrollPreloadedCourses } from '@/hooks/useAutoEnrollPreloadedCourses';\r\nimport { useCourseEnrollment } from '@/hooks/useCourseEnrollment';\r\nimport { useNativeCourses, useNativeEnrollments, useNativeEnrollmentMutations } from '@/hooks/useNativeCourses';\r\nimport { useOrganizationCourses } from '@/hooks/useOrganizationCourses';\r\nimport { useUserPrimaryOrganization } from '@/hooks/useUserOrganization';\r\nimport { NativeCourseCard } from '@/components/native-courses/NativeCourseCard';\r\nimport { StyledCourseCard } from '@/components/common/StyledCourseCard';\r\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from '@/components/ui/collapsible';\r\n\r\n// Import course card background\r\nimport geometryCourseCardBg from '@/assets/geometry-course-card-bg.jpg';\r\nimport courseMoneyManagement from '@/assets/course-money-management.jpg';\r\nimport courseSpellingReading from '@/assets/course-spelling-reading.jpg';\r\nimport courseAlgebra from '@/assets/course-algebra.jpg';\r\nimport courseHandwritingBg from '@/assets/course-handwriting-bg.jpg';\r\nimport courseNeurodiversityBg from '@/assets/course-neurodiversity-bg.jpg';\r\nimport learningStateBg from '@/assets/learning-state-course-bg.jpg';\r\nimport empoweringSpellingBg from '@/assets/empowering-spelling-unique-bg.jpg';\r\nimport courseLinearEquationsBg from '@/assets/course-linear-equations-bg.jpg';\r\nimport courseTrigonometryBg from '@/assets/course-trigonometry-bg.jpg';\r\nimport courseEconomicsBg from '@/assets/course-economics-bg.jpg';\r\nimport courseLogicBg from '@/assets/course-logic-bg.jpg';\r\nimport courseScienceBg from '@/assets/course-science-bg.jpg';\r\nimport eltBackground from '@/assets/elt-background.jpg';\r\nimport { useFirstVisitVideo } from '@/hooks/useFirstVisitVideo';\r\nimport { FirstVisitVideoModal } from '@/components/common/FirstVisitVideoModal';\r\nimport { PageHelpTrigger } from '@/components/common/PageHelpTrigger';\r\nimport { Link } from 'react-router-dom';\r\n\r\n// Hard-coded Interactive Courses\r\nconst INTERACTIVE_LINEAR_EQUATIONS_COURSE = {\r\n  id: 'interactive-linear-equations',\r\n  title: 'Interactive Linear Equations',\r\n  description: 'Master solving linear equations through interactive lessons and practice problems. Learn step-by-step problem solving with immediate feedback.',\r\n  thumbnail_url: courseLinearEquationsBg,\r\n  difficulty_level: 'beginner',\r\n  duration_minutes: 240,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\nconst INTERACTIVE_TRIGONOMETRY_COURSE = {\r\n  id: 'interactive-trigonometry',\r\n  title: 'Interactive Trigonometry',\r\n  description: 'Master trigonometry through interactive lessons, visual demonstrations, and practical applications. From basic SOHCAHTOA to complex real-world problem solving.',\r\n  thumbnail_url: courseTrigonometryBg,\r\n  difficulty_level: 'intermediate',\r\n  duration_minutes: 300,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\nconst INTERACTIVE_ALGEBRA_COURSE = {\r\n  id: 'interactive-algebra',\r\n  title: 'Interactive Algebra',\r\n  description: 'Master algebra fundamentals through interactive lessons and practice problems. Learn algebraic expressions, equations, and problem-solving techniques.',\r\n  thumbnail_url: courseAlgebra,\r\n  difficulty_level: 'beginner',\r\n  duration_minutes: 320,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\nconst LOGIC_CRITICAL_THINKING_COURSE = {\r\n  id: 'logic-critical-thinking',\r\n  title: 'Logic and Critical Thinking',\r\n  description: 'Develop essential reasoning skills through systematic study of logic and critical thinking. Learn to analyze arguments, identify fallacies, and construct sound reasoning.',\r\n  thumbnail_url: courseLogicBg,\r\n  difficulty_level: 'beginner',\r\n  duration_minutes: 400,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\nconst NEURODIVERSITY_STRENGTHS_COURSE = {\r\n  id: 'neurodiversity-strengths-based-approach',\r\n  title: 'Neurodiversity: A Strengths-Based Approach',\r\n  description: 'Your guide to leveraging your unique brain for academic success. Discover how neurodivergence is an asset and learn to harness your cognitive superpowers.',\r\n  thumbnail_url: courseNeurodiversityBg,\r\n  difficulty_level: 'beginner',\r\n  duration_minutes: 360,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\nconst INTRODUCTION_TO_SCIENCE_COURSE = {\r\n  id: 'interactive-science',\r\n  title: 'Introduction to Science',\r\n  description: 'Get to grips with the basics of biology, chemistry, and physics. Learn the scientific method and explore the building blocks of life and matter.',\r\n  thumbnail_url: courseScienceBg,\r\n  difficulty_level: 'beginner',\r\n  duration_minutes: 360,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\nconst ELT_EMPOWERING_LEARNING_TECHNIQUES_COURSE = {\r\n  id: 'elt-empowering-learning-techniques',\r\n  title: 'ELT: Empowering Learning Techniques',\r\n  description: 'Master evidence-based learning strategies specifically designed for neurodiverse minds. Transform how you learn, study, and succeed in any academic environment.',\r\n  thumbnail_url: eltBackground,\r\n  difficulty_level: 'beginner',\r\n  duration_minutes: 240,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\nconst GEOMETRY_FUNDAMENTALS_COURSE = {\r\n  id: 'geometry',\r\n  title: 'Interactive Geometry Fundamentals',\r\n  description: 'Master the essential concepts of geometry, from basic shapes and angles to advanced proofs and transformations. Build a solid foundation in spatial reasoning and mathematical thinking.',\r\n  thumbnail_url: geometryCourseCardBg,\r\n  difficulty_level: 'beginner',\r\n  duration_minutes: 480,\r\n  instructor_name: 'FPK University',\r\n  featured: true,\r\n  status: 'published'\r\n};\r\n\r\n// Additional static courses for display\r\nconst additionalCourses = [\r\n  {\r\n    id: 'money-management-teens',\r\n    title: 'Money Management for Teens',\r\n    description: 'Learn essential financial skills including budgeting, saving, investing, and credit management. Build a strong foundation for financial success.',\r\n    instructor_name: 'FPK University',\r\n    duration_minutes: 360,\r\n    difficulty_level: 'beginner',\r\n    featured: true,\r\n    is_free: true,\r\n    price: 0,\r\n    tags: ['Life Skills', 'Personal Finance', 'Budgeting', 'Investing'],\r\n    thumbnail_url: courseMoneyManagement,\r\n  }\r\n];\r\n\r\nconst EMPOWERING_LEARNING_READING_COURSE = {\r\n  id: 'empowering-learning-reading',\r\n  title: 'Empowering Learning for Reading',\r\n  description: 'Master reading through visual memory techniques and optimal learning states. A comprehensive program designed for visual learners to overcome reading challenges.',\r\n  instructor_name: 'FPK University',\r\n  duration_minutes: 120,\r\n  difficulty_level: 'beginner',\r\n  featured: true,\r\n  is_free: true,\r\n  price: 0,\r\n  tags: ['Language Arts', 'Reading', 'Visual Learning', 'Memory Techniques'],\r\n  thumbnail_url: courseSpellingReading,\r\n  status: 'published'\r\n};\r\n\r\nconst EMPOWERING_LEARNING_NUMERACY_COURSE = {\r\n  id: 'empowering-learning-numeracy',\r\n  title: 'Empowering Learning for Numeracy',\r\n  description: 'Master mathematics through visual memory techniques and number triangles. Learn addition, subtraction, multiplication and division using proven visual learning methods.',\r\n  instructor_name: 'FPK University',\r\n  duration_minutes: 120,\r\n  difficulty_level: 'beginner',\r\n  featured: true,\r\n  is_free: true,\r\n  price: 0,\r\n  tags: ['Mathematics', 'Numeracy', 'Visual Learning', 'Number Triangles'],\r\n  thumbnail_url: courseSpellingReading,\r\n  status: 'published'\r\n};\r\n\r\nconst MONEY_MANAGEMENT_COURSE = {\r\n  id: 'money-management-teens',\r\n  title: 'Money Management for Teens',\r\n  description: 'Learn essential financial skills including budgeting, saving, investing, and credit management. Build a strong foundation for financial success.',\r\n  instructor_name: 'FPK University',\r\n  duration_minutes: 360,\r\n  difficulty_level: 'beginner',\r\n  featured: true,\r\n  is_free: true,\r\n  price: 0,\r\n  tags: ['Life Skills', 'Personal Finance', 'Budgeting', 'Investing'],\r\n  thumbnail_url: courseMoneyManagement,\r\n  status: 'published'\r\n};\r\n\r\n// FPK University Games data\r\nconst FPK_GAMES = [\r\n  {\r\n    id: 'prompt-play-palette',\r\n    name: 'Imagination Builder',\r\n    image: 'https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/game-cards/imagination-builder.jpg',\r\n    url: 'https://prompt-play-palette.lovable.app/'\r\n  },\r\n  {\r\n    id: 'addition-journey-quest',\r\n    name: 'Addition Journey Quest',\r\n    image: 'https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/game-cards/addition-journey.jpg',\r\n    url: 'https://addition-journey-quest.lovable.app/'\r\n  },\r\n  {\r\n    id: 'wizard-word-battle',\r\n    name: 'Word Wizard Dual',\r\n    image: 'https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/game-cards/word-wizard.jpg',\r\n    url: 'https://preview--wizard-word-battle.lovable.app/'\r\n  },\r\n  {\r\n    id: 'learn-escape-prodigy',\r\n    name: 'Learner Escape',\r\n    image: 'https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/game-cards/learn-escape.jpg',\r\n    url: 'https://learn-escape-prodigy.lovable.app/'\r\n  },\r\n  {\r\n    id: 'eco-genesis-forest-realm',\r\n    name: 'Ecoâ€‘Genesis: Forest Realm',\r\n    image: 'https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/game-cards/eco-genesis',\r\n    url: 'https://eco-genesis-forest-realm.lovable.app/'\r\n  },\r\n  {\r\n    id: 'energybear-calm-game',\r\n    name: 'EnergyBear: Calm & Focus',\r\n    image: 'https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/game-cards/energy-bear.jpg',\r\n    url: 'https://energybear-calm-game.lovable.app/'\r\n  },\r\n  {\r\n    id: 'mind-explorer-game',\r\n    name: 'Emotion Detective',\r\n    image: 'https://zgcegkmqfgznbpdplscz.supabase.co/storage/v1/object/public/course-files/game-cards/emotion-detective.jpg',\r\n    url: 'https://mind-explorer-game.lovable.app/'\r\n  }\r\n];\r\n\r\nconst EMPOWERING_LEARNING_HANDWRITING_COURSE = {\r\n  id: 'empowering-learning-handwriting',\r\n  title: 'Empowering Learning: Handwriting',\r\n  description: 'Master handwriting techniques through systematic practice and understanding. Develop fluency, readability, and confidence in written communication.',\r\n  instructor_name: 'FPK University',\r\n  duration_minutes: 180,\r\n  difficulty_level: 'beginner',\r\n  featured: true,\r\n  is_free: true,\r\n  price: 0,\r\n  tags: ['Writing Skills', 'Handwriting', 'Motor Skills', 'Education'],\r\n  thumbnail_url: courseHandwritingBg,\r\n  status: 'published'\r\n};\r\n\r\nconst MyCourses = () => {\r\n  const { t } = useTranslation('dashboard');\r\n  \r\n  // Get user's organization membership\r\n  const { organization: userOrganization } = useUserPrimaryOrganization();\r\n  \r\n  // Fetch courses based on organization membership\r\n  const { courses, isLoading, error } = useCourses({\r\n    organizationId: userOrganization?.organization_id,\r\n  });\r\n  const { enrollments, getCourseProgress } = useEnrollmentProgress();\r\n  const { enrollInCourse: enrollInInteractiveCourse, isEnrolling: isCourseEnrolling } = useCourseEnrollment();\r\n  \r\n  // Native courses\r\n  const { data: nativeCourses = [], isLoading: nativeCoursesLoading } = useNativeCourses({\r\n    organizationId: userOrganization?.organization_id,\r\n  });\r\n  const { data: nativeEnrollments = [] } = useNativeEnrollments();\r\n  const { enrollInCourse } = useNativeEnrollmentMutations();\r\n  \r\n  // Track enrollment state per course\r\n  const [enrollingCourseIds, setEnrollingCourseIds] = useState<Set<string>>(new Set());\r\n  \r\n  // Handle native course enrollment with per-course state tracking\r\n  const handleNativeCourseEnroll = async (courseId: string) => {\r\n    setEnrollingCourseIds(prev => new Set([...prev, courseId]));\r\n    try {\r\n      await enrollInCourse.mutateAsync(courseId);\r\n    } catch (error) {\r\n      console.error('Failed to enroll in native course:', error);\r\n    } finally {\r\n      setEnrollingCourseIds(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.delete(courseId);\r\n        return newSet;\r\n      });\r\n    }\r\n  };\r\n\r\n  // Organization-specific courses if user is in an organization\r\n  const { data: orgCourses } = useOrganizationCourses(userOrganization?.organization_id || '');\r\n  \r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [difficultyFilter, setDifficultyFilter] = useState('all');\r\n  const [showVideoModal, setShowVideoModal] = useState(false);\r\n  const [isGamesOpen, setIsGamesOpen] = useState(false);\r\n  \r\n  // Video storage hook\r\n  const { shouldShowAuto, markVideoAsSeen } = useFirstVisitVideo('mycourses_intro_seen');\r\n\r\n  // Auto-enroll in preloaded courses\r\n  useAutoEnrollPreloadedCourses();\r\n\r\n  // Show video modal on first visit\r\n  useEffect(() => {\r\n    if (shouldShowAuto() && !isLoading && courses.length > 0) {\r\n      setShowVideoModal(true);\r\n    }\r\n  }, [shouldShowAuto, isLoading, courses.length]);\r\n\r\n  const handleCloseVideo = () => {\r\n    setShowVideoModal(false);\r\n    markVideoAsSeen();\r\n  };\r\n\r\n  const handleShowVideoManually = () => {\r\n    setShowVideoModal(true);\r\n  };\r\n\r\n  const enrolledCourseIds = enrollments.map(e => e.course_id);\r\n  \r\n\r\nconst EL_SPELLING_READING_COURSE = {\r\n  id: 'el-spelling-reading',\r\n  title: 'EL Spelling & Reading',\r\n  description: 'Master spelling and reading through visual memory techniques and optimal learning states. A comprehensive program designed for visual learners.',\r\n  instructor_name: 'FPK University',\r\n  duration_minutes: 120,\r\n  difficulty_level: 'beginner',\r\n  featured: true,\r\n  is_free: true,\r\n  price: 0,\r\n  tags: ['Language Arts', 'Spelling', 'Reading', 'Visual Learning', 'Memory Techniques'],\r\n  thumbnail_url: empoweringSpellingBg,\r\n  status: 'published'\r\n};\r\n\r\nconst EMPOWERING_LEARNING_STATE_COURSE = {\r\n  id: 'empowering-learning-state',\r\n  title: 'Empowering Learning State',\r\n  description: 'Master the optimal learning state through calming techniques and brain integration methods. Learn essential techniques to achieve the most effective learning state.',\r\n  instructor_name: 'FPK University',\r\n  duration_minutes: 180,\r\n  difficulty_level: 'beginner',\r\n  featured: true,\r\n  is_free: true,\r\n  price: 0,\r\n  tags: ['Learning Skills', 'Brain Integration', 'Focus Enhancement', 'Calming Techniques'],\r\n  thumbnail_url: learningStateBg,\r\n  status: 'published'\r\n};\r\n\r\n  // Combine global and organization courses - ensuring handwriting course is prioritized\r\n  const allAvailableCourses = [\r\n    EMPOWERING_LEARNING_HANDWRITING_COURSE, // Prioritize handwriting course at the top\r\n    EL_SPELLING_READING_COURSE, // Add the primary EL Spelling & Reading course\r\n    EMPOWERING_LEARNING_STATE_COURSE, // Add the new Learning State course\r\n    ELT_EMPOWERING_LEARNING_TECHNIQUES_COURSE, // Add the new ELT course\r\n    ...courses,\r\n    ...(orgCourses?.assignedCourses || []),\r\n    ...(orgCourses?.organizationOwnedCourses || []),\r\n    INTERACTIVE_LINEAR_EQUATIONS_COURSE, // Add hardcoded courses\r\n    INTERACTIVE_TRIGONOMETRY_COURSE,\r\n    INTERACTIVE_ALGEBRA_COURSE,\r\n    LOGIC_CRITICAL_THINKING_COURSE,\r\n    NEURODIVERSITY_STRENGTHS_COURSE,\r\n    INTRODUCTION_TO_SCIENCE_COURSE,\r\n    GEOMETRY_FUNDAMENTALS_COURSE,\r\n    EMPOWERING_LEARNING_READING_COURSE,\r\n    EMPOWERING_LEARNING_NUMERACY_COURSE,\r\n    MONEY_MANAGEMENT_COURSE,\r\n  ].filter((course, index, self) => \r\n    // Remove duplicates by id\r\n    index === self.findIndex(c => c.id === course.id)\r\n  );\r\n  \r\n  const enrolledCourses = allAvailableCourses.filter(course => \r\n    enrolledCourseIds.includes(course.id)\r\n  );\r\n  const availableCourses = allAvailableCourses.filter(course => \r\n    !enrolledCourseIds.includes(course.id) && course.status === 'published'\r\n  );\r\n\r\n  // Native course filtering\r\n  const enrolledNativeCourseIds = nativeEnrollments.map(e => e.course_id);\r\n  \r\n  // Combine global and organization native courses\r\n  const allAvailableNativeCourses = [\r\n    ...nativeCourses,\r\n    ...(orgCourses?.assignedNativeCourses || []),\r\n    ...(orgCourses?.organizationOwnedNativeCourses || []),\r\n  ].filter((course, index, self) => \r\n    // Remove duplicates by id\r\n    index === self.findIndex(c => c.id === course.id)\r\n  );\r\n  \r\n  const enrolledNativeCourses = allAvailableNativeCourses.filter(course => enrolledNativeCourseIds.includes(course.id));\r\n  const availableNativeCourses = allAvailableNativeCourses.filter(course => \r\n    !enrolledNativeCourseIds.includes(course.id)\r\n  );\r\n\r\n  const filteredCourses = (courseList: typeof courses) => {\r\n    return courseList.filter(course => {\r\n      const matchesSearch = course.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                           course.description?.toLowerCase().includes(searchTerm.toLowerCase());\r\n      const matchesDifficulty = difficultyFilter === 'all' || course.difficulty_level === difficultyFilter;\r\n      return matchesSearch && matchesDifficulty;\r\n    }).sort((a, b) => {\r\n      // Empowering Learning courses should be first\r\n      const empoweringLearningIds = ['empowering-learning-handwriting', 'empowering-learning-numeracy', 'empowering-learning-reading', 'empowering-learning-spelling', 'empowering-learning-state'];\r\n      const aIsEmpowering = empoweringLearningIds.includes(a.id);\r\n      const bIsEmpowering = empoweringLearningIds.includes(b.id);\r\n      \r\n      if (aIsEmpowering && !bIsEmpowering) return -1;\r\n      if (!aIsEmpowering && bIsEmpowering) return 1;\r\n      \r\n      // Then other courses by name\r\n      return 0;\r\n    });\r\n  };\r\n\r\n  const filteredNativeCourses = (courseList: typeof nativeCourses) => {\r\n    return courseList.filter(course => {\r\n      const matchesSearch = course.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                           course.summary?.toLowerCase().includes(searchTerm.toLowerCase());\r\n      return matchesSearch;\r\n    });\r\n  };\r\n\r\n  const switchToAvailableTab = () => {\r\n    const tabElement = document.querySelector('[data-state=\"inactive\"][value=\"available\"]') as HTMLElement;\r\n    if (tabElement) {\r\n      tabElement.click();\r\n    }\r\n  };\r\n\r\n  if (isLoading || nativeCoursesLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-8\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading your courses...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-8\">\r\n        <div className=\"text-center\">\r\n          <h2 className=\"text-xl font-semibold text-red-600\">Error</h2>\r\n          <p className=\"text-gray-600\">{error.message || 'Failed to load courses'}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const CourseCard = ({ course, isEnrolled = false }: { course: any; isEnrolled?: boolean }) => {\r\n    const progress = isEnrolled ? getCourseProgress(course.id) : null;\r\n    const isEmpoweringLearningState = course.id === 'empowering-learning-state';\r\n    const isEmpoweringLearningSpelling = course.id === 'el-spelling-reading';\r\n    const isEmpoweringLearningReading = course.id === 'empowering-learning-reading';\r\n    const isEmpoweringLearningNumeracy = course.id === 'empowering-learning-numeracy';\r\n    const isEmpoweringLearningHandwriting = course.id === 'empowering-learning-handwriting';\r\n    const isInteractiveLinearEquations = course.id === 'interactive-linear-equations';\r\n    const isInteractiveTrigonometry = course.id === 'interactive-trigonometry';\r\n    const isInteractiveAlgebra = course.id === 'interactive-algebra';\r\n    const isIntroductionModernEconomics = course.id === 'introduction-modern-economics';\r\n    const isLogicCriticalThinking = course.id === 'logic-critical-thinking';\r\n    const isNeurodiversityStrengths = course.id === 'neurodiversity-strengths-based-approach';\r\n    const isIntroductionToScience = course.id === 'interactive-science';\r\n    const isGeometryFundamentals = course.id === 'geometry';\r\n    const isELTEmpoweringLearning = course.id === 'elt-empowering-learning-techniques';\r\n\r\n    // Handle enrollment for hardcoded courses\r\n    const handleEnrollment = async () => {\r\n      if (!isEnrolled) {\r\n        try {\r\n          console.log('Enrolling in course:', course.id);\r\n          await enrollInInteractiveCourse.mutateAsync(course.id);\r\n          \r\n          // After successful enrollment, switch to My Courses tab\r\n          setTimeout(() => {\r\n            const enrolledTab = document.querySelector('[data-state=\"inactive\"][value=\"enrolled\"]') as HTMLElement;\r\n            if (enrolledTab) {\r\n              enrolledTab.click();\r\n            }\r\n          }, 1000);\r\n        } catch (error) {\r\n          console.error('Failed to enroll in course:', course.id, error);\r\n          toast.error(`Failed to enroll in ${course.title}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    // Get display title for the course\r\n    const getDisplayTitle = () => {\r\n      if (isEmpoweringLearningSpelling) {\r\n        return course.title;\r\n      }\r\n      return course.title;\r\n    };\r\n\r\n    // Get course type for styling\r\n    const getCourseType = () => {\r\n      if (isEmpoweringLearningState) return 'Learning Skills Course';\r\n      if (isEmpoweringLearningSpelling) return 'Spelling Course';\r\n      if (isEmpoweringLearningReading) return 'Reading Course';\r\n      if (isEmpoweringLearningNumeracy) return 'Mathematics Course';\r\n      if (isEmpoweringLearningHandwriting) return 'Writing Course';\r\n      if (isInteractiveLinearEquations || isInteractiveTrigonometry || isInteractiveAlgebra) return 'Interactive Course';\r\n      if (isIntroductionModernEconomics) return 'Interactive Course';\r\n      if (isLogicCriticalThinking) return 'Philosophy Course';\r\n      if (isNeurodiversityStrengths) return 'Foundation Course';\r\n      if (isIntroductionToScience) return 'Science Course';\r\n      if (isGeometryFundamentals) return 'Math Course';\r\n      return 'Full Course Curriculum';\r\n    };\r\n\r\n    // Get color theme based on course\r\n    // NOTE: Removed color theme system in favor of AI-generated images\r\n\r\n    // Fixed course route logic\r\n    const getCourseRoute = () => {\r\n      if (isEmpoweringLearningState) {\r\n        return '/courses/empowering-learning-state';\r\n      }\r\n      \r\n      if (isEmpoweringLearningSpelling) {\r\n        return '/courses/el-spelling-reading';\r\n      }\r\n      \r\n      if (isEmpoweringLearningReading) {\r\n        return '/courses/empowering-learning-reading';\r\n      }\r\n      \r\n      if (isEmpoweringLearningNumeracy) {\r\n        return '/courses/empowering-learning-numeracy';\r\n      }\r\n      \r\n      if (isEmpoweringLearningHandwriting) {\r\n        return '/courses/empowering-learning-handwriting';\r\n      }\r\n      \r\n      if (isInteractiveLinearEquations) {\r\n        return '/courses/interactive-linear-equations';\r\n      }\r\n      \r\n      if (isInteractiveTrigonometry) {\r\n        return '/courses/interactive-trigonometry';\r\n      }\r\n      \r\n      if (isInteractiveAlgebra) {\r\n        return '/courses/interactive-algebra';\r\n      }\r\n      \r\n      if (isIntroductionModernEconomics) {\r\n        return '/courses/introduction-modern-economics';\r\n      }\r\n      \r\n      if (isLogicCriticalThinking) {\r\n        return '/courses/logic-critical-thinking';\r\n      }\r\n      \r\n      if (isNeurodiversityStrengths) {\r\n        return '/courses/neurodiversity-strengths-based-approach';\r\n      }\r\n      \r\n      if (isIntroductionToScience) {\r\n        return '/courses/interactive-science';\r\n      }\r\n      \r\n      if (isGeometryFundamentals) {\r\n        return '/courses/geometry';\r\n      }\r\n      \r\n      if (course.id === 'money-management-teens') {\r\n        return '/courses/money-management-teens';\r\n      }\r\n      \r\n      if (isELTEmpoweringLearning) {\r\n        return '/courses/elt-empowering-learning-techniques';\r\n      }\r\n      \r\n      const identifier = course.slug || course.id;\r\n      return `/dashboard/learner/course/${identifier}`;\r\n    };\r\n\r\n    return (\r\n      <StyledCourseCard\r\n        id={course.id}\r\n        title={getDisplayTitle()}\r\n        description={course.description}\r\n        courseType={getCourseType()}\r\n        isEnrolled={isEnrolled}\r\n        progress={progress?.completion_percentage || 0}\r\n        duration={course.duration_minutes}\r\n        instructor={course.instructor_name}\r\n        route={isEnrolled ? getCourseRoute() : undefined}\r\n        isCompleted={progress?.completed || false}\r\n        onEnroll={!isEnrolled ? handleEnrollment : undefined}\r\n        isEnrolling={!isEnrolled ? isCourseEnrolling : false}\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6 pl-2 pr-6 md:pl-4 md:pr-8 lg:pl-6 lg:pr-10\">\r\n      <div className=\"bg-white/40 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg\">\r\n        <div className=\"flex flex-col items-center gap-2 mb-4\">\r\n          <h1 className=\"text-3xl font-bold text-white\">{t('myCourses.title')}</h1>\r\n          <PageHelpTrigger onOpen={handleShowVideoManually} />\r\n        </div>\r\n        <p className=\"text-white text-center mb-6\">{t('myCourses.description')}</p>\r\n      </div>\r\n\r\n      <FirstVisitVideoModal\r\n        isOpen={showVideoModal}\r\n        onClose={handleCloseVideo}\r\n        title=\"How to Use My Courses\"\r\n        videoUrl=\"https://www.youtube.com/embed/aTzBu_VJ2gM?si=UcVUJGmUwbEbDGvy\"\r\n      />\r\n\r\n      {/* Search and Filters */}\r\n      <div className=\"flex flex-col sm:flex-row gap-4\">\r\n        <div className=\"relative flex-1\">\r\n          <Search className=\"h-4 w-4 absolute left-3 top-3 text-gray-400\" />\r\n          <Input\r\n            placeholder=\"Search courses...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            className=\"pl-10\"\r\n          />\r\n        </div>\r\n        <Select value={difficultyFilter} onValueChange={setDifficultyFilter}>\r\n          <SelectTrigger className=\"w-full sm:w-48\">\r\n            <Filter className=\"h-4 w-4 mr-2\" />\r\n            <SelectValue placeholder=\"Filter by difficulty\" />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            <SelectItem value=\"all\">All Levels</SelectItem>\r\n            <SelectItem value=\"beginner\">Beginner</SelectItem>\r\n            <SelectItem value=\"intermediate\">Intermediate</SelectItem>\r\n            <SelectItem value=\"advanced\">Advanced</SelectItem>\r\n          </SelectContent>\r\n        </Select>\r\n      </div>\r\n\r\n      {/* FPK University Games Dropdown */}\r\n      <div className=\"space-y-4\">\r\n        <Collapsible open={isGamesOpen} onOpenChange={setIsGamesOpen}>\r\n          <CollapsibleTrigger asChild>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"w-full justify-between bg-white/10 backdrop-blur-sm border-white/20 text-white hover:bg-white/20 transition-all duration-200\"\r\n            >\r\n              <span className=\"text-lg font-semibold\">ðŸŽ® FPK University Games</span>\r\n              <ChevronDown className={`h-5 w-5 transition-transform duration-200 ${isGamesOpen ? 'rotate-180' : ''}`} />\r\n            </Button>\r\n          </CollapsibleTrigger>\r\n          <CollapsibleContent className=\"space-y-4 pt-4\">\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-4 gap-3 md:gap-4\">\r\n              {FPK_GAMES.map((game) => (\r\n                <Card key={game.id} className=\"overflow-hidden hover:shadow-lg transition-all duration-200 bg-white/90 backdrop-blur-sm border-white/20\">\r\n                  <div className=\"relative\">\r\n                    <img \r\n                      src={game.image} \r\n                      alt={game.name}\r\n                      className=\"w-full h-64 md:h-72 lg:h-64 object-contain bg-gray-100\"\r\n                    />\r\n                  </div>\r\n                  <CardContent className=\"p-4\">\r\n                    <h3 className=\"font-semibold text-lg mb-2 text-gray-800\">{game.name}</h3>\r\n                    <Button \r\n                      onClick={() => window.open(game.url, '_blank')}\r\n                      className=\"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-medium\"\r\n                    >\r\n                      Play Game\r\n                    </Button>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          </CollapsibleContent>\r\n        </Collapsible>\r\n      </div>\r\n\r\n      <Tabs defaultValue=\"enrolled\" className=\"space-y-6\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"enrolled\">\r\n            My Courses ({enrolledCourses.length + enrolledNativeCourses.length})\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"available\">\r\n            Available Courses ({availableCourses.length + availableNativeCourses.length})\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"enrolled\" className=\"space-y-6\">\r\n          {(filteredCourses(enrolledCourses).length > 0 || filteredNativeCourses(enrolledNativeCourses).length > 0) ? (\r\n            <div className=\"space-y-8\">\r\n              {/* All Courses */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4\">\r\n                {/* Native Courses */}\r\n                {filteredNativeCourses(enrolledNativeCourses).map((course) => {\r\n                  const enrollment = nativeEnrollments.find(e => e.course_id === course.id);\r\n                  return (\r\n                    <NativeCourseCard \r\n                      key={course.id} \r\n                      course={course} \r\n                      enrollment={enrollment}\r\n                    />\r\n                  );\r\n                })}\r\n                \r\n                {/* Regular Courses */}\r\n                {filteredCourses(enrolledCourses).map((course) => (\r\n                  <CourseCard key={course.id} course={course} isEnrolled={true} />\r\n                ))}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-12\">\r\n              <BookOpen className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                {searchTerm ? 'No courses match your search' : 'No enrolled courses yet'}\r\n              </h3>\r\n              <p className=\"text-gray-600 mb-4\">\r\n                {searchTerm \r\n                  ? 'Try adjusting your search terms or filters'\r\n                  : 'Discover and enroll in courses to start your learning journey.'\r\n                }\r\n              </p>\r\n              {!searchTerm && (\r\n                <Button onClick={switchToAvailableTab}>\r\n                  Browse Available Courses\r\n                </Button>\r\n              )}\r\n            </div>\r\n          )}\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"available\" className=\"space-y-6\">\r\n          {(filteredCourses(availableCourses).length > 0 || filteredNativeCourses(availableNativeCourses).length > 0) ? (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4\">\r\n              {/* Available Native Courses */}\r\n              {filteredNativeCourses(availableNativeCourses).map((course) => (\r\n                <NativeCourseCard \r\n                  key={course.id} \r\n                  course={course}\r\n                  onEnroll={() => handleNativeCourseEnroll(course.id)}\r\n                  isEnrolling={enrollingCourseIds.has(course.id)}\r\n                />\r\n              ))}\r\n              \r\n              {/* Available Regular Courses */}\r\n              {filteredCourses(availableCourses)\r\n                .map((course) => (\r\n                  <CourseCard key={course.id} course={course} isEnrolled={false} />\r\n                ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-12\">\r\n              <BookOpen className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                {searchTerm ? 'No courses match your search' : 'No available courses'}\r\n              </h3>\r\n              <p className=\"text-gray-600\">\r\n                {searchTerm \r\n                  ? 'Try adjusting your search terms or filters'\r\n                  : 'New courses will appear here when they become available.'\r\n                }\r\n              </p>\r\n            </div>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MyCourses;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\Notes.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\Settings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2794,2797],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2794,2797],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3331,3334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3331,3334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":109,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3973,3976],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3973,3976],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4593,4596],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4593,4596],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":152,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5147,5150],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5147,5150],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":167,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5597,5600],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5597,5600],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":263,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8459,8462],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8459,8462],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":264,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":264,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8522,8525],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8522,8525],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":265,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8585,8588],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8585,8588],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport SettingsHeader from '@/components/settings/SettingsHeader';\r\nimport ProfileSection from '@/components/settings/ProfileSection';\r\nimport SecuritySection from '@/components/settings/SecuritySection';\r\nimport NotificationSection from '@/components/settings/NotificationSection';\r\nimport AccessibilitySettings from '@/components/settings/AccessibilitySettings';\r\nimport LanguageSettings from '@/components/settings/LanguageSettings';\r\nimport IntegrationSection from '@/components/settings/IntegrationSection';\r\nimport { DataManagement } from '@/components/DataManagement';\r\nimport { useFirstVisitVideo } from '@/hooks/useFirstVisitVideo';\r\nimport { FirstVisitVideoModal } from '@/components/common/FirstVisitVideoModal';\r\nimport { PageHelpTrigger } from '@/components/common/PageHelpTrigger';\r\nimport { User, Shield, Bell, Eye, Globe, Zap, FileText } from 'lucide-react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useUserProfile } from '@/hooks/useUserProfile';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nconst Settings = () => {\r\n  const { user } = useAuth();\r\n  const { profile, loading, saving, updateProfile, changePassword } = useUserProfile();\r\n  const { toast } = useToast();\r\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\r\n  const [showVideoModal, setShowVideoModal] = useState(false);\r\n  \r\n  // Video storage hook\r\n  const { shouldShowAuto, markVideoAsSeen } = useFirstVisitVideo('settings_intro_seen');\r\n\r\n  // Show video modal on first visit (only when not loading)\r\n  useEffect(() => {\r\n    if (shouldShowAuto() && !loading && profile) {\r\n      setShowVideoModal(true);\r\n    }\r\n  }, [shouldShowAuto, loading, profile]);\r\n\r\n  const handleCloseVideo = () => {\r\n    setShowVideoModal(false);\r\n    markVideoAsSeen();\r\n  };\r\n\r\n  const handleShowVideoManually = () => {\r\n    setShowVideoModal(true);\r\n  };\r\n\r\n  // Load profile data into local state for form management\r\n  useEffect(() => {\r\n    if (profile) {\r\n      setHasUnsavedChanges(false);\r\n    }\r\n  }, [profile]);\r\n\r\n  // Auto-save function with debouncing\r\n  useEffect(() => {\r\n    if (!hasUnsavedChanges || !profile) return;\r\n\r\n    const timeoutId = setTimeout(async () => {\r\n      try {\r\n        await updateProfile({}, true); // Silent update\r\n        setHasUnsavedChanges(false);\r\n      } catch (error) {\r\n        console.error('Auto-save failed:', error);\r\n      }\r\n    }, 2000);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [hasUnsavedChanges, profile, updateProfile]);\r\n\r\n  const handleFormChange = async (key: string, value: any) => {\r\n    setHasUnsavedChanges(true);\r\n    try {\r\n      await updateProfile({ [key]: value }, true);\r\n      setHasUnsavedChanges(false);\r\n    } catch (error) {\r\n      console.error('Failed to update profile:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save changes. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleEmailNotificationChange = async (key: string, value: boolean) => {\r\n    const currentNotifications = (profile?.email_notifications as any) || {};\r\n    const updates = {\r\n      email_notifications: {\r\n        ...currentNotifications,\r\n        [key]: value\r\n      }\r\n    };\r\n    setHasUnsavedChanges(true);\r\n    try {\r\n      await updateProfile(updates, true);\r\n      setHasUnsavedChanges(false);\r\n    } catch (error) {\r\n      console.error('Failed to update notifications:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save notification settings.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleAppReminderChange = async (key: string, value: boolean) => {\r\n    const currentReminders = (profile?.app_reminders as any) || {};\r\n    const updates = {\r\n      app_reminders: {\r\n        ...currentReminders,\r\n        [key]: value\r\n      }\r\n    };\r\n    setHasUnsavedChanges(true);\r\n    try {\r\n      await updateProfile(updates, true);\r\n      setHasUnsavedChanges(false);\r\n    } catch (error) {\r\n      console.error('Failed to update reminders:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save reminder settings.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleCalendarSyncChange = async (key: string, value: boolean) => {\r\n    const currentSync = (profile?.calendar_sync as any) || {};\r\n    const updates = {\r\n      calendar_sync: {\r\n        ...currentSync,\r\n        [key]: value\r\n      }\r\n    };\r\n    setHasUnsavedChanges(true);\r\n    try {\r\n      await updateProfile(updates, true);\r\n      setHasUnsavedChanges(false);\r\n    } catch (error) {\r\n      console.error('Failed to update calendar sync:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save calendar settings.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleAccessibilityChange = async (key: string, value: any) => {\r\n    setHasUnsavedChanges(true);\r\n    try {\r\n      await updateProfile({ [key]: value }, true);\r\n      setHasUnsavedChanges(false);\r\n    } catch (error) {\r\n      console.error('Failed to update accessibility:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save accessibility settings.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleLanguageChange = async (key: string, value: any) => {\r\n    setHasUnsavedChanges(true);\r\n    try {\r\n      await updateProfile({ [key]: value }, true);\r\n      setHasUnsavedChanges(false);\r\n    } catch (error) {\r\n      console.error('Failed to update language:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save language settings.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handlePasswordChange = async (currentPassword: string, newPassword: string): Promise<boolean> => {\r\n    try {\r\n      await changePassword(currentPassword, newPassword);\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Password changed successfully.\",\r\n      });\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Password change failed:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to change password. Please check your current password.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const handleRestoreDefaults = async () => {\r\n    try {\r\n      const defaultSettings = {\r\n        font_family: 'System',\r\n        text_size: 3,\r\n        line_spacing: 3,\r\n        color_contrast: 'Standard',\r\n        comfort_mode: 'Normal',\r\n        speech_to_text_enabled: false,\r\n        primary_language: 'English',\r\n        dual_language_enabled: false,\r\n        time_format: '12h',\r\n        date_format: 'US',\r\n        timezone: 'America/New_York',\r\n        push_notifications_enabled: true,\r\n        email_notifications: {\r\n          new_courses: true,\r\n          weekly_summary: true,\r\n          ai_prompts: false\r\n        },\r\n        app_reminders: {\r\n          study_streak: true,\r\n          module_nudges: true\r\n        },\r\n        calendar_sync: {\r\n          google: false,\r\n          outlook: false\r\n        }\r\n      };\r\n      \r\n      await updateProfile(defaultSettings);\r\n      setHasUnsavedChanges(false);\r\n      toast({\r\n        title: \"Settings Restored\",\r\n        description: \"All settings have been restored to their default values.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to restore defaults:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to restore default settings.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"mobile-page-container\">\r\n        <div className=\"mobile-section-spacing\">\r\n          <div className=\"flex items-center justify-center p-8\">\r\n            <div className=\"text-center\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n              <p>Loading settings...</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Provide safe defaults for all data\r\n  const emailNotifications = (profile?.email_notifications as any) || {};\r\n  const appReminders = (profile?.app_reminders as any) || {};\r\n  const calendarSync = (profile?.calendar_sync as any) || {};\r\n  \r\n  const profileData = {\r\n    full_name: profile?.full_name || '',\r\n    display_name: profile?.display_name || '',\r\n    bio: profile?.bio || '',\r\n    avatar_url: profile?.avatar_url || '',\r\n    learning_styles: profile?.learning_styles || [],\r\n    two_factor_enabled: profile?.two_factor_enabled || false,\r\n    push_notifications_enabled: profile?.push_notifications_enabled ?? true,\r\n    email_notifications: {\r\n      new_courses: emailNotifications.new_courses ?? true,\r\n      weekly_summary: emailNotifications.weekly_summary ?? true,\r\n      ai_prompts: emailNotifications.ai_prompts ?? false\r\n    },\r\n    app_reminders: {\r\n      study_streak: appReminders.study_streak ?? true,\r\n      module_nudges: appReminders.module_nudges ?? true\r\n    },\r\n    calendar_sync: {\r\n      google: calendarSync.google ?? false,\r\n      outlook: calendarSync.outlook ?? false\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"mobile-page-container\">\r\n      <div className=\"mobile-section-spacing\">\r\n        <div className=\"flex flex-col items-center gap-2 mb-4\">\r\n          <h1 className=\"text-3xl font-bold text-foreground\">Settings</h1>\r\n          <PageHelpTrigger onOpen={handleShowVideoManually} />\r\n        </div>\r\n        <p className=\"text-muted-foreground text-center mb-6\">\r\n          Customize your learning experience and account preferences\r\n        </p>\r\n\r\n        <FirstVisitVideoModal\r\n          isOpen={showVideoModal}\r\n          onClose={handleCloseVideo}\r\n          title=\"How to Use Settings\"\r\n          videoUrl=\"https://www.youtube.com/embed/IjLiH-NWIto?si=UaS_tXWSHzaizyZB\"\r\n        />\r\n        \r\n        <Card className=\"mobile-card border-0 shadow-sm\">\r\n          <CardContent className=\"mobile-card-padding\">\r\n            <Tabs defaultValue=\"profile\" className=\"mobile-section-spacing\">\r\n              {/* Mobile-Optimized Tab Navigation */}\r\n              <div className=\"overflow-x-auto -mx-3 px-3 sm:mx-0 sm:px-0\">\r\n                <TabsList className=\"mobile-tab-list min-w-max\">\r\n                  <TabsTrigger value=\"profile\" className=\"mobile-tab-trigger\">\r\n                    <User className=\"h-4 w-4 mr-2 flex-shrink-0\" />\r\n                    <span className=\"whitespace-nowrap\">Profile</span>\r\n                  </TabsTrigger>\r\n                  <TabsTrigger value=\"security\" className=\"mobile-tab-trigger\">\r\n                    <Shield className=\"h-4 w-4 mr-2 flex-shrink-0\" />\r\n                    <span className=\"whitespace-nowrap\">Security</span>\r\n                  </TabsTrigger>\r\n                  <TabsTrigger value=\"notifications\" className=\"mobile-tab-trigger\">\r\n                    <Bell className=\"h-4 w-4 mr-2 flex-shrink-0\" />\r\n                    <span className=\"whitespace-nowrap\">Notifications</span>\r\n                  </TabsTrigger>\r\n                  <TabsTrigger value=\"accessibility\" className=\"mobile-tab-trigger\">\r\n                    <Eye className=\"h-4 w-4 mr-2 flex-shrink-0\" />\r\n                    <span className=\"whitespace-nowrap\">Accessibility</span>\r\n                  </TabsTrigger>\r\n                  <TabsTrigger value=\"language\" className=\"mobile-tab-trigger\">\r\n                    <Globe className=\"h-4 w-4 mr-2 flex-shrink-0\" />\r\n                    <span className=\"whitespace-nowrap\">Language</span>\r\n                  </TabsTrigger>\r\n                  <TabsTrigger value=\"integrations\" className=\"mobile-tab-trigger\">\r\n                    <Zap className=\"h-4 w-4 mr-2 flex-shrink-0\" />\r\n                    <span className=\"whitespace-nowrap\">Integrations</span>\r\n                  </TabsTrigger>\r\n                  <TabsTrigger value=\"data\" className=\"mobile-tab-trigger\">\r\n                    <FileText className=\"h-4 w-4 mr-2 flex-shrink-0\" />\r\n                    <span className=\"whitespace-nowrap\">Data</span>\r\n                  </TabsTrigger>\r\n                </TabsList>\r\n              </div>\r\n\r\n              <TabsContent value=\"profile\" className=\"mt-0\">\r\n                <ProfileSection\r\n                  formData={profileData}\r\n                  userEmail={user?.email || ''}\r\n                  onFormChange={handleFormChange}\r\n                />\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"security\" className=\"mt-0\">\r\n                <SecuritySection\r\n                  formData={profileData}\r\n                  onFormChange={handleFormChange}\r\n                  onPasswordChange={handlePasswordChange}\r\n                />\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"notifications\" className=\"mt-0\">\r\n                <NotificationSection\r\n                  formData={profileData}\r\n                  onFormChange={handleFormChange}\r\n                  onEmailNotificationChange={handleEmailNotificationChange}\r\n                  onAppReminderChange={handleAppReminderChange}\r\n                />\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"accessibility\" className=\"mt-0\">\r\n                <AccessibilitySettings\r\n                  fontFamily={profile?.font_family || 'System'}\r\n                  textSize={profile?.text_size || 3}\r\n                  lineSpacing={profile?.line_spacing || 3}\r\n                  colorContrast={profile?.color_contrast || 'Standard'}\r\n                  comfortMode={profile?.comfort_mode || 'Normal'}\r\n                  speechToTextEnabled={profile?.speech_to_text_enabled || false}\r\n                  onChange={handleAccessibilityChange}\r\n                />\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"language\" className=\"mt-0\">\r\n                <LanguageSettings\r\n                  primaryLanguage={profile?.primary_language || 'English'}\r\n                  dualLanguageEnabled={profile?.dual_language_enabled || false}\r\n                  timeFormat={profile?.time_format || '12h'}\r\n                  dateFormat={profile?.date_format || 'US'}\r\n                  timezone={profile?.timezone || 'America/New_York'}\r\n                  onChange={handleLanguageChange}\r\n                />\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"integrations\" className=\"mt-0\">\r\n                <IntegrationSection\r\n                  formData={profileData}\r\n                  onCalendarSyncChange={handleCalendarSyncChange}\r\n                />\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"data\" className=\"mt-0\">\r\n                <DataManagement />\r\n              </TabsContent>\r\n            </Tabs>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Settings;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\Subscription.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\SubscriptionSuccess.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\UserSubscription.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\org\\settings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2134,2137],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2134,2137],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Settings, Save, Building2 } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { useForm } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport { z } from 'zod';\r\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\r\n\r\nconst orgSettingsSchema = z.object({\r\n  name: z.string().min(1, 'Organization name is required'),\r\n  description: z.string().optional(),\r\n  logo_url: z.string().optional(),\r\n  plan: z.enum(['basic', 'standard', 'premium', 'beta']),\r\n  seat_cap: z.number().min(1, 'Seat capacity must be at least 1'),\r\n  instructor_limit: z.number().min(1, 'Instructor limit must be at least 1'),\r\n  // Additional settings\r\n  invites_enabled: z.boolean(),\r\n  join_policy: z.enum(['open', 'invite_only', 'closed']),\r\n  default_role: z.enum(['student', 'instructor']),\r\n});\r\n\r\ntype OrgSettingsFormData = z.infer<typeof orgSettingsSchema>;\r\n\r\nexport default function OrgSettingsPage() {\r\n  const { currentOrg, getUserRole } = useOrgContext();\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n  const userRole = getUserRole();\r\n\r\n  const form = useForm<OrgSettingsFormData>({\r\n    resolver: zodResolver(orgSettingsSchema),\r\n    defaultValues: {\r\n      name: currentOrg?.organizations?.name || '',\r\n      description: '',\r\n      logo_url: '',\r\n      plan: (currentOrg?.organizations?.plan as any) || 'basic',\r\n      seat_cap: 50,\r\n      instructor_limit: 20,\r\n      invites_enabled: true,\r\n      join_policy: 'invite_only',\r\n      default_role: 'student',\r\n    },\r\n  });\r\n\r\n  const updateSettingsMutation = useMutation({\r\n    mutationFn: async (data: Partial<OrgSettingsFormData>) => {\r\n      if (!currentOrg) throw new Error('No organization selected');\r\n      \r\n      const { error } = await supabase\r\n        .from('organizations')\r\n        .update({\r\n          name: data.name,\r\n          description: data.description,\r\n          logo_url: data.logo_url,\r\n          seat_cap: data.seat_cap,\r\n          instructor_limit: data.instructor_limit,\r\n          updated_at: new Date().toISOString(),\r\n        })\r\n        .eq('id', currentOrg.organization_id);\r\n      \r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['user-organizations'] });\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Organization settings updated successfully.\",\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error('Error updating settings:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update organization settings.\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const onSubmit = (data: OrgSettingsFormData) => {\r\n    updateSettingsMutation.mutate(data);\r\n  };\r\n\r\n  if (!currentOrg) {\r\n    return (\r\n      <div className=\"container mx-auto p-6\">\r\n        <div className=\"text-center\">\r\n          <h1 className=\"text-2xl font-bold mb-4\">No Organization Selected</h1>\r\n          <p className=\"text-muted-foreground\">Please select an organization to view settings.</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const isOwner = userRole === 'owner';\r\n  const canEdit = isOwner;\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6 space-y-6\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <Settings className=\"h-8 w-8\" />\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Organization Settings</h1>\r\n          <p className=\"text-muted-foreground\">Manage your organization configuration</p>\r\n        </div>\r\n      </div>\r\n\r\n      <Form {...form}>\r\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\r\n          {/* Basic Information */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Building2 className=\"h-5 w-5\" />\r\n                Basic Information\r\n              </CardTitle>\r\n              <CardDescription>\r\n                Update your organization's basic details\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <FormField\r\n                control={form.control}\r\n                name=\"name\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Organization Name</FormLabel>\r\n                    <FormControl>\r\n                      <Input {...field} disabled={!canEdit} />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"description\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Description</FormLabel>\r\n                    <FormControl>\r\n                      <Textarea \r\n                        {...field} \r\n                        disabled={!canEdit}\r\n                        placeholder=\"Describe your organization...\"\r\n                        rows={3}\r\n                      />\r\n                    </FormControl>\r\n                    <FormDescription>\r\n                      A brief description of your organization\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"logo_url\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Logo URL</FormLabel>\r\n                    <FormControl>\r\n                      <Input \r\n                        {...field} \r\n                        disabled={!canEdit}\r\n                        placeholder=\"https://example.com/logo.png\"\r\n                      />\r\n                    </FormControl>\r\n                    <FormDescription>\r\n                      URL to your organization's logo image\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Capacity Settings */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Capacity & Limits</CardTitle>\r\n              <CardDescription>\r\n                Configure seat and instructor limits\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"grid md:grid-cols-2 gap-4\">\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"seat_cap\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>Student Seat Capacity</FormLabel>\r\n                      <FormControl>\r\n                        <Input \r\n                          {...field}\r\n                          type=\"number\"\r\n                          disabled={!isOwner}\r\n                          onChange={(e) => field.onChange(parseInt(e.target.value, 10))}\r\n                        />\r\n                      </FormControl>\r\n                      <FormDescription>\r\n                        Maximum number of students\r\n                      </FormDescription>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"instructor_limit\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>Instructor Limit</FormLabel>\r\n                      <FormControl>\r\n                        <Input \r\n                          {...field}\r\n                          type=\"number\"\r\n                          disabled={!isOwner}\r\n                          onChange={(e) => field.onChange(parseInt(e.target.value, 10))}\r\n                        />\r\n                      </FormControl>\r\n                      <FormDescription>\r\n                        Maximum number of instructors\r\n                      </FormDescription>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Access Control */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Access Control</CardTitle>\r\n              <CardDescription>\r\n                Manage how users can join your organization\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <FormField\r\n                control={form.control}\r\n                name=\"invites_enabled\"\r\n                render={({ field }) => (\r\n                  <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-4\">\r\n                    <div className=\"space-y-0.5\">\r\n                      <FormLabel className=\"text-base\">Enable Invitations</FormLabel>\r\n                      <FormDescription>\r\n                        Allow creating invitation links for new members\r\n                      </FormDescription>\r\n                    </div>\r\n                    <FormControl>\r\n                      <Switch\r\n                        checked={field.value}\r\n                        onCheckedChange={field.onChange}\r\n                        disabled={!canEdit}\r\n                      />\r\n                    </FormControl>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"join_policy\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Join Policy</FormLabel>\r\n                    <Select\r\n                      onValueChange={field.onChange}\r\n                      defaultValue={field.value}\r\n                      disabled={!canEdit}\r\n                    >\r\n                      <FormControl>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select join policy\" />\r\n                        </SelectTrigger>\r\n                      </FormControl>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"open\">Open - Anyone can join</SelectItem>\r\n                        <SelectItem value=\"invite_only\">Invite Only</SelectItem>\r\n                        <SelectItem value=\"closed\">Closed - No new members</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <FormDescription>\r\n                      How new members can join your organization\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"default_role\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Default Role</FormLabel>\r\n                    <Select\r\n                      onValueChange={field.onChange}\r\n                      defaultValue={field.value}\r\n                      disabled={!canEdit}\r\n                    >\r\n                      <FormControl>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select default role\" />\r\n                        </SelectTrigger>\r\n                      </FormControl>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"student\">Student</SelectItem>\r\n                        <SelectItem value=\"instructor\">Instructor</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <FormDescription>\r\n                      Default role assigned to new members\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {canEdit && (\r\n            <div className=\"flex justify-end\">\r\n              <Button\r\n                type=\"submit\"\r\n                disabled={updateSettingsMutation.isPending}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <Save className=\"h-4 w-4\" />\r\n                {updateSettingsMutation.isPending ? 'Saving...' : 'Save Settings'}\r\n              </Button>\r\n            </div>\r\n          )}\r\n\r\n          {!canEdit && (\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <p className=\"text-center text-muted-foreground\">\r\n                  Only organization owners can modify these settings.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </form>\r\n      </Form>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\org\\subscription.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\dashboard\\organizations\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\AnalyticsOverview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\AssignmentsManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\CoursesManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\GoalsManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":173,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5994,5997],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5994,5997],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":176,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6147,6150],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6147,6150],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Flag, Plus, Search, Filter, Target, TrendingUp } from 'lucide-react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\n\r\nexport default function GoalsManagement() {\r\n  const { currentOrg } = useOrgContext();\r\n\r\n  if (!currentOrg) {\r\n    return (\r\n      <div className=\"container max-w-6xl mx-auto py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <p className=\"text-muted-foreground\">No organization selected</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Mock goals data for demonstration\r\n  const mockGoals = [\r\n    {\r\n      id: '1',\r\n      title: 'Improve Organization-wide Learning Completion Rate',\r\n      description: 'Increase course completion rate to 90% across all students',\r\n      targetValue: 90,\r\n      currentValue: 78,\r\n      category: 'learning',\r\n      priority: 'high',\r\n      dueDate: '2024-03-31',\r\n      assignedStudents: 15,\r\n      status: 'active'\r\n    },\r\n    {\r\n      id: '2',\r\n      title: 'Enhance Student Engagement Metrics',\r\n      description: 'Achieve 95% weekly active student participation',\r\n      targetValue: 95,\r\n      currentValue: 82,\r\n      category: 'engagement',\r\n      priority: 'medium',\r\n      dueDate: '2024-02-29',\r\n      assignedStudents: 12,\r\n      status: 'active'\r\n    },\r\n    {\r\n      id: '3',\r\n      title: 'Reduce Course Dropout Rate',\r\n      description: 'Maintain course dropout rate below 10%',\r\n      targetValue: 10,\r\n      currentValue: 8,\r\n      category: 'retention',\r\n      priority: 'high',\r\n      dueDate: '2024-06-30',\r\n      assignedStudents: 20,\r\n      status: 'achieved'\r\n    }\r\n  ];\r\n\r\n  const getCategoryColor = (category: string) => {\r\n    switch (category) {\r\n      case 'learning': return 'default';\r\n      case 'engagement': return 'secondary';\r\n      case 'retention': return 'outline';\r\n      default: return 'secondary';\r\n    }\r\n  };\r\n\r\n  const getPriorityColor = (priority: string) => {\r\n    switch (priority) {\r\n      case 'high': return 'destructive';\r\n      case 'medium': return 'default';\r\n      case 'low': return 'secondary';\r\n      default: return 'secondary';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container max-w-6xl mx-auto py-8 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold tracking-tight\">Goals</h1>\r\n          <p className=\"text-muted-foreground mt-2\">\r\n            Set and track organizational learning goals for your students\r\n          </p>\r\n        </div>\r\n        <Button>\r\n          <Plus className=\"w-4 h-4 mr-2\" />\r\n          Create Goal\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Flag className=\"w-4 h-4 text-muted-foreground\" />\r\n              <span className=\"text-sm font-medium\">Total Goals</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2\">3</div>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Target className=\"w-4 h-4 text-muted-foreground\" />\r\n              <span className=\"text-sm font-medium\">Active Goals</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2 text-blue-600\">2</div>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <TrendingUp className=\"w-4 h-4 text-muted-foreground\" />\r\n              <span className=\"text-sm font-medium\">Achieved</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2 text-green-600\">1</div>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm font-medium\">Avg Progress</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2\">83%</div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Search and Filters */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"relative flex-1\">\r\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n              <Input \r\n                placeholder=\"Search goals...\" \r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n            <Button variant=\"outline\">\r\n              <Filter className=\"w-4 h-4 mr-2\" />\r\n              Filters\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      {/* Goals List */}\r\n      <div className=\"space-y-4\">\r\n        {mockGoals.map((goal) => {\r\n          const progressPercentage = goal.category === 'retention' \r\n            ? Math.max(0, 100 - (goal.currentValue / goal.targetValue * 100))\r\n            : (goal.currentValue / goal.targetValue) * 100;\r\n          \r\n          return (\r\n            <Card key={goal.id}>\r\n              <CardHeader className=\"pb-3\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"space-y-2\">\r\n                    <CardTitle className=\"text-lg\">{goal.title}</CardTitle>\r\n                    <CardDescription>{goal.description}</CardDescription>\r\n                    <div className=\"flex gap-2\">\r\n                      <Badge variant={getCategoryColor(goal.category) as any}>\r\n                        {goal.category}\r\n                      </Badge>\r\n                      <Badge variant={getPriorityColor(goal.priority) as any}>\r\n                        {goal.priority} priority\r\n                      </Badge>\r\n                      <Badge variant={goal.status === 'achieved' ? 'default' : 'secondary'}>\r\n                        {goal.status}\r\n                      </Badge>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                  <div>\r\n                    <div className=\"text-sm font-medium\">Target</div>\r\n                    <div className=\"text-lg font-bold\">\r\n                      {goal.targetValue}{goal.category === 'retention' ? '% max' : '%'}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div>\r\n                    <div className=\"text-sm font-medium\">Current</div>\r\n                    <div className=\"text-lg font-bold\">\r\n                      {goal.currentValue}{goal.category === 'retention' ? '% current' : '%'}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div>\r\n                    <div className=\"text-sm font-medium\">Progress</div>\r\n                    <div className=\"text-lg font-bold mb-1\">\r\n                      {Math.round(progressPercentage)}%\r\n                    </div>\r\n                    <div className=\"w-full bg-muted rounded-full h-2\">\r\n                      <div \r\n                        className={`h-2 rounded-full ${\r\n                          progressPercentage >= 100 ? 'bg-green-500' : \r\n                          progressPercentage >= 75 ? 'bg-blue-500' : \r\n                          progressPercentage >= 50 ? 'bg-yellow-500' : 'bg-red-500'\r\n                        }`}\r\n                        style={{ width: `${Math.min(100, progressPercentage)}%` }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex gap-2\">\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      View Details\r\n                    </Button>\r\n                    <Button size=\"sm\">\r\n                      Edit Goal\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"mt-4 pt-4 border-t flex items-center justify-between\">\r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    Due: {new Date(goal.dueDate).toLocaleDateString()} â€¢ \r\n                    Assigned to {goal.assignedStudents} students\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\NotesManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":139,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5482,5485],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5482,5485],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":142,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5679,5682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5679,5682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Notebook, Plus, Search, Filter, FileText, Users } from 'lucide-react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\nimport { useOrgNotes } from '@/hooks/useOrgNotes';\r\nimport CreateNoteDialog from '@/components/instructor/CreateNoteDialog';\r\nimport CreateFolderDialog from '@/components/instructor/CreateFolderDialog';\r\n\r\nexport default function NotesManagement() {\r\n  const { currentOrg } = useOrgContext();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const { notes, isLoading } = useOrgNotes(searchQuery);\r\n\r\n  if (!currentOrg) {\r\n    return (\r\n      <div className=\"container max-w-6xl mx-auto py-8\">\r\n        <Card>\r\n          <CardContent className=\"p-8 text-center\">\r\n            <p className=\"text-muted-foreground\">No organization selected</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const getCategoryColor = (category?: string) => {\r\n    if (!category) return 'secondary';\r\n    switch (category) {\r\n      case 'progress-report': return 'default';\r\n      case 'teaching-resource': return 'secondary';\r\n      case 'curriculum': return 'outline';\r\n      default: return 'secondary';\r\n    }\r\n  };\r\n\r\n  const getVisibilityColor = (visibility_scope: string) => {\r\n    switch (visibility_scope) {\r\n      case 'organization': return 'default';\r\n      case 'student': return 'default';\r\n      case 'private': return 'destructive';\r\n      default: return 'secondary';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container max-w-6xl mx-auto py-8 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold tracking-tight\">Notes</h1>\r\n          <p className=\"text-muted-foreground mt-2\">\r\n            Manage instructional notes and resources for your organization\r\n          </p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <CreateNoteDialog />\r\n          <CreateFolderDialog />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Notebook className=\"w-4 h-4 text-muted-foreground\" />\r\n              <span className=\"text-sm font-medium\">Total Notes</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2\">{notes.length}</div>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Users className=\"w-4 h-4 text-muted-foreground\" />\r\n              <span className=\"text-sm font-medium\">Shared Notes</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2 text-blue-600\">{notes.filter(n => n.visibility_scope === 'org-public').length}</div>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <FileText className=\"w-4 h-4 text-muted-foreground\" />\r\n              <span className=\"text-sm font-medium\">Private Notes</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2\">{notes.filter(n => n.visibility_scope === 'student-only').length}</div>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm font-medium\">This Week</span>\r\n            </div>\r\n            <div className=\"text-2xl font-bold mt-2 text-green-600\">{notes.filter(n => {\r\n              const createdAt = new Date(n.created_at);\r\n              const weekAgo = new Date();\r\n              weekAgo.setDate(weekAgo.getDate() - 7);\r\n              return createdAt >= weekAgo;\r\n            }).length}</div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Search and Filters */}\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"relative flex-1\">\r\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n              <Input \r\n              placeholder=\"Search notes...\" \r\n              className=\"pl-10\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              />\r\n            </div>\r\n            <Button variant=\"outline\">\r\n              <Filter className=\"w-4 h-4 mr-2\" />\r\n              Filters\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      {/* Notes Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n        {notes.map((note) => (\r\n          <Card key={note.id} className=\"flex flex-col\">\r\n            <CardHeader className=\"pb-3\">\r\n              <div className=\"space-y-2\">\r\n                <CardTitle className=\"text-lg line-clamp-2\">{note.title}</CardTitle>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  <Badge variant={getCategoryColor(note.category) as any}>\r\n                    {note.category ? note.category.replace('-', ' ') : 'general'}\r\n                  </Badge>\r\n                  <Badge variant={getVisibilityColor(note.visibility_scope) as any}>\r\n                    {note.visibility_scope === 'org-public' ? 'shared' : 'private'}\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            \r\n            <CardContent className=\"flex-1 flex flex-col\">\r\n              <CardDescription className=\"line-clamp-3 mb-4\">\r\n                {note.content}\r\n              </CardDescription>\r\n              \r\n              <div className=\"flex flex-wrap gap-1 mb-4\">\r\n              {note.tags?.map((tag) => (\r\n                <Badge key={tag} variant=\"outline\" className=\"text-xs\">\r\n                  #{tag}\r\n                </Badge>\r\n              ))}\r\n              </div>\r\n              \r\n              <div className=\"mt-auto space-y-3\">\r\n                <div className=\"text-xs text-muted-foreground\">\r\n                  Created: {new Date(note.created_at).toLocaleDateString()}\r\n                  <br />\r\n                  Updated: {new Date(note.updated_at).toLocaleDateString()}\r\n                </div>\r\n                \r\n                {note.visibility_scope === 'org-public' && (\r\n                  <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\r\n                    <Users className=\"w-3 h-3\" />\r\n                    Shared with organization\r\n                  </div>\r\n                )}\r\n                \r\n                <div className=\"flex gap-2\">\r\n                  <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\r\n                    Edit\r\n                  </Button>\r\n                  <Button size=\"sm\" className=\"flex-1\">\r\n                    View\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Empty state */}\r\n      {notes.length === 0 && !isLoading && (\r\n        <Card>\r\n          <CardContent className=\"text-center py-12\">\r\n            <Notebook className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n            <h3 className=\"text-lg font-semibold mb-2\">No Notes Created</h3>\r\n            <p className=\"text-muted-foreground mb-4\">\r\n              Create instructional notes to organize your teaching materials.\r\n            </p>\r\n            <CreateNoteDialog />\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\OrgBrandingSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\OrganizationSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\StudentProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\instructor\\StudentsManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\org\\assignments.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\org\\courses.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":114,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3384,3387],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3384,3387],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { \r\n  Dialog, \r\n  DialogContent, \r\n  DialogDescription, \r\n  DialogHeader, \r\n  DialogTitle, \r\n  DialogTrigger \r\n} from '@/components/ui/dialog';\r\nimport { \r\n  DropdownMenu, \r\n  DropdownMenuContent, \r\n  DropdownMenuItem, \r\n  DropdownMenuTrigger \r\n} from '@/components/ui/dropdown-menu';\r\nimport { \r\n  BookOpen, \r\n  Plus, \r\n  Search, \r\n  MoreHorizontal, \r\n  Eye, \r\n  Edit, \r\n  Trash2,\r\n  Users,\r\n  Play,\r\n  Pause,\r\n  BarChart\r\n} from 'lucide-react';\r\nimport { useOrgCourses, OrgCourse } from '@/hooks/useOrgCourses';\r\nimport { useForm } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport { z } from 'zod';\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\r\n\r\nconst courseSchema = z.object({\r\n  title: z.string().min(1, 'Title is required'),\r\n  description: z.string().optional(),\r\n  level: z.enum(['beginner', 'intermediate', 'advanced']).optional(),\r\n});\r\n\r\ntype CourseFormData = z.infer<typeof courseSchema>;\r\n\r\nexport default function CoursesPage() {\r\n  const { currentOrg, getUserRole } = useOrgContext();\r\n  const userRole = getUserRole();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [showCreateDialog, setShowCreateDialog] = useState(false);\r\n  const [editingCourse, setEditingCourse] = useState<OrgCourse | null>(null);\r\n\r\n  const {\r\n    courses,\r\n    isLoading,\r\n    createCourse,\r\n    updateCourse,\r\n    deleteCourse,\r\n    togglePublish,\r\n    isCreating,\r\n    isUpdating,\r\n    isDeleting,\r\n    isTogglingPublish,\r\n  } = useOrgCourses();\r\n\r\n  const form = useForm<CourseFormData>({\r\n    resolver: zodResolver(courseSchema),\r\n    defaultValues: {\r\n      title: '',\r\n      description: '',\r\n      level: 'beginner',\r\n    },\r\n  });\r\n\r\n  if (!currentOrg) {\r\n    return (\r\n      <div className=\"container mx-auto p-6\">\r\n        <div className=\"text-center\">\r\n          <h1 className=\"text-2xl font-bold mb-4\">No Organization Selected</h1>\r\n          <p className=\"text-muted-foreground\">Please select an organization to view courses.</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const canManageCourses = userRole === 'owner' || userRole === 'instructor';\r\n  \r\n  const filteredCourses = courses.filter(course => \r\n    course.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n    course.description?.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  const handleCreateCourse = (data: CourseFormData) => {\r\n    createCourse({\r\n      title: data.title,\r\n      description: data.description,\r\n      level: data.level,\r\n      published: false,\r\n    });\r\n    \r\n    form.reset();\r\n    setShowCreateDialog(false);\r\n  };\r\n\r\n  const handleEditCourse = (course: OrgCourse) => {\r\n    setEditingCourse(course);\r\n    form.reset({\r\n      title: course.title,\r\n      description: course.description || '',\r\n      level: (course.level as any) || 'beginner',\r\n    });\r\n  };\r\n\r\n  const handleUpdateCourse = (data: CourseFormData) => {\r\n    if (!editingCourse) return;\r\n    \r\n    updateCourse({\r\n      id: editingCourse.id,\r\n      title: data.title,\r\n      description: data.description,\r\n      level: data.level,\r\n    });\r\n    \r\n    form.reset();\r\n    setEditingCourse(null);\r\n  };\r\n\r\n  const handleTogglePublish = (course: OrgCourse) => {\r\n    togglePublish({\r\n      courseId: course.id,\r\n      published: !course.published,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6 space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <BookOpen className=\"h-8 w-8\" />\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold\">Courses</h1>\r\n            <p className=\"text-muted-foreground\">\r\n              Manage your organization's courses\r\n            </p>\r\n          </div>\r\n        </div>\r\n        \r\n        {canManageCourses && (\r\n          <Button onClick={() => setShowCreateDialog(true)} className=\"flex items-center gap-2\">\r\n            <Plus className=\"h-4 w-4\" />\r\n            Create Course\r\n          </Button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid md:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Courses</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{courses.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">All courses</p>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Published</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{courses.filter(c => c.published).length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Available to students</p>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Draft</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{courses.filter(c => !c.published).length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">In development</p>\r\n          </CardContent>\r\n        </Card>\r\n        \r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Enrollments</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">0</div>\r\n            <p className=\"text-xs text-muted-foreground\">Across all courses</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Search Bar */}\r\n      <div className=\"flex items-center gap-4\">\r\n        <div className=\"relative flex-1 max-w-sm\">\r\n          <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\r\n          <Input\r\n            placeholder=\"Search courses...\"\r\n            value={searchQuery}\r\n            onChange={(e) => setSearchQuery(e.target.value)}\r\n            className=\"pl-10\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Courses Grid */}\r\n      <div className=\"space-y-4\">\r\n        {isLoading ? (\r\n          <div className=\"text-center py-8\">\r\n            <p className=\"text-muted-foreground\">Loading courses...</p>\r\n          </div>\r\n        ) : filteredCourses.length === 0 ? (\r\n          <div className=\"text-center py-8\">\r\n            <BookOpen className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n            <h3 className=\"text-lg font-semibold mb-2\">No Courses Found</h3>\r\n            <p className=\"text-muted-foreground mb-4\">\r\n              {searchQuery ? 'No courses match your search.' : 'Start by creating your first course.'}\r\n            </p>\r\n            {canManageCourses && !searchQuery && (\r\n              <Button onClick={() => setShowCreateDialog(true)}>\r\n                <Plus className=\"h-4 w-4 mr-2\" />\r\n                Create Course\r\n              </Button>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {filteredCourses.map((course) => (\r\n              <Card key={course.id} className=\"hover:shadow-md transition-shadow\">\r\n                <CardHeader>\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <CardTitle className=\"line-clamp-2\">{course.title}</CardTitle>\r\n                      <CardDescription className=\"line-clamp-3 mt-2\">\r\n                        {course.description || 'No description provided'}\r\n                      </CardDescription>\r\n                    </div>\r\n                    {canManageCourses && (\r\n                      <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                          <Button variant=\"ghost\" size=\"sm\">\r\n                            <MoreHorizontal className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent>\r\n                          <DropdownMenuItem onClick={() => handleEditCourse(course)}>\r\n                            <Edit className=\"h-4 w-4 mr-2\" />\r\n                            Edit Course\r\n                          </DropdownMenuItem>\r\n                          <DropdownMenuItem onClick={() => handleTogglePublish(course)}>\r\n                            {course.published ? (\r\n                              <>\r\n                                <Pause className=\"h-4 w-4 mr-2\" />\r\n                                Unpublish\r\n                              </>\r\n                            ) : (\r\n                              <>\r\n                                <Play className=\"h-4 w-4 mr-2\" />\r\n                                Publish\r\n                              </>\r\n                            )}\r\n                          </DropdownMenuItem>\r\n                          <DropdownMenuItem\r\n                            onClick={() => deleteCourse(course.id)}\r\n                            className=\"text-destructive\"\r\n                          >\r\n                            <Trash2 className=\"h-4 w-4 mr-2\" />\r\n                            Delete Course\r\n                          </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                      </DropdownMenu>\r\n                    )}\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge variant={course.published ? \"default\" : \"secondary\"}>\r\n                        {course.published ? 'Published' : 'Draft'}\r\n                      </Badge>\r\n                      {course.level && (\r\n                        <Badge variant=\"outline\" className=\"capitalize\">\r\n                          {course.level}\r\n                        </Badge>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\r\n                      <div className=\"flex items-center gap-1\">\r\n                        <Users className=\"h-3 w-3\" />\r\n                        0\r\n                      </div>\r\n                      <div className=\"flex items-center gap-1\">\r\n                        <BarChart className=\"h-3 w-3\" />\r\n                        0%\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Create/Edit Course Dialog */}\r\n      <Dialog \r\n        open={showCreateDialog || !!editingCourse} \r\n        onOpenChange={(open) => {\r\n          if (!open) {\r\n            setShowCreateDialog(false);\r\n            setEditingCourse(null);\r\n            form.reset();\r\n          }\r\n        }}\r\n      >\r\n        <DialogContent className=\"sm:max-w-[425px]\">\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {editingCourse ? 'Edit Course' : 'Create New Course'}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {editingCourse ? 'Update course information.' : 'Add a new course to your organization.'}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <Form {...form}>\r\n            <form \r\n              onSubmit={form.handleSubmit(editingCourse ? handleUpdateCourse : handleCreateCourse)} \r\n              className=\"space-y-4\"\r\n            >\r\n              <FormField\r\n                control={form.control}\r\n                name=\"title\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Course Title</FormLabel>\r\n                    <FormControl>\r\n                      <Input {...field} placeholder=\"Enter course title\" />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"description\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Description</FormLabel>\r\n                    <FormControl>\r\n                      <Textarea \r\n                        {...field} \r\n                        placeholder=\"Describe the course content...\"\r\n                        rows={3}\r\n                      />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"level\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Difficulty Level</FormLabel>\r\n                    <Select onValueChange={field.onChange} value={field.value}>\r\n                      <FormControl>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select difficulty\" />\r\n                        </SelectTrigger>\r\n                      </FormControl>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"beginner\">Beginner</SelectItem>\r\n                        <SelectItem value=\"intermediate\">Intermediate</SelectItem>\r\n                        <SelectItem value=\"advanced\">Advanced</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <div className=\"flex justify-end space-x-2\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  onClick={() => {\r\n                    setShowCreateDialog(false);\r\n                    setEditingCourse(null);\r\n                    form.reset();\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n                <Button type=\"submit\" disabled={isCreating || isUpdating}>\r\n                  {editingCourse \r\n                    ? (isUpdating ? 'Updating...' : 'Update Course')\r\n                    : (isCreating ? 'Creating...' : 'Create Course')\r\n                  }\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          </Form>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\org\\goals.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\org\\students.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\organizations\\OrgCreatePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2208,2211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2208,2211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { \r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Building2, ArrowLeft } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nconst OrgCreatePage = () => {\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    description: '',\r\n    plan: 'beta'\r\n  });\r\n\r\n  const handleInputChange = (field: string, value: string) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const generateSlug = (name: string) => {\r\n    return name\r\n      .toLowerCase()\r\n      .replace(/[^a-z0-9\\s-]/g, '')\r\n      .replace(/\\s+/g, '-')\r\n      .trim();\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!formData.name.trim()) {\r\n      toast({\r\n        title: \"Name Required\",\r\n        description: \"Please enter an organization name.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const slug = generateSlug(formData.name);\r\n      \r\n      const { data, error } = await supabase.rpc('create_organization_with_membership', {\r\n        p_name: formData.name.trim(),\r\n        p_slug: slug,\r\n        p_description: formData.description.trim() || null,\r\n        p_plan: formData.plan\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"Organization Created!\",\r\n        description: \"Your organization has been created successfully.\",\r\n      });\r\n\r\n      // Navigate to instructor dashboard with the new org\r\n      navigate(`/dashboard/instructor?org=${data}`);\r\n      \r\n    } catch (error: any) {\r\n      console.error('Error creating organization:', error);\r\n      toast({\r\n        title: \"Creation Failed\",\r\n        description: error.message || \"Failed to create organization. Please try again.\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-4\">\r\n        <Button variant=\"ghost\" size=\"sm\" onClick={() => navigate('/org')}>\r\n          <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n          Back to Organizations\r\n        </Button>\r\n      </div>\r\n\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n          <Building2 className=\"h-8 w-8\" />\r\n          Create Organization\r\n        </h1>\r\n        <p className=\"text-muted-foreground mt-2\">\r\n          Set up your new organization and start inviting members.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Creation Form */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Organization Details</CardTitle>\r\n          <CardDescription>\r\n            Provide basic information about your organization\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            {/* Organization Name */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"name\">Organization Name *</Label>\r\n              <Input\r\n                id=\"name\"\r\n                value={formData.name}\r\n                onChange={(e) => handleInputChange('name', e.target.value)}\r\n                placeholder=\"Enter organization name\"\r\n                disabled={isLoading}\r\n                required\r\n              />\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                This will be displayed to members and in invitations.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Description */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"description\">Description</Label>\r\n              <Textarea\r\n                id=\"description\"\r\n                value={formData.description}\r\n                onChange={(e) => handleInputChange('description', e.target.value)}\r\n                placeholder=\"Describe your organization (optional)\"\r\n                disabled={isLoading}\r\n                rows={3}\r\n              />\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Optional: Help members understand what your organization is about.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Plan Selection */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"plan\">Plan</Label>\r\n              <Select\r\n                value={formData.plan}\r\n                onValueChange={(value) => handleInputChange('plan', value)}\r\n                disabled={isLoading}\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Select a plan\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"beta\">Beta (Free)</SelectItem>\r\n                  <SelectItem value=\"basic\">Basic</SelectItem>\r\n                  <SelectItem value=\"standard\">Standard</SelectItem>\r\n                  <SelectItem value=\"premium\">Premium</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Choose the plan that best fits your organization's needs.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex gap-4\">\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                onClick={() => navigate('/org')}\r\n                disabled={isLoading}\r\n                className=\"flex-1\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                type=\"submit\"\r\n                disabled={isLoading}\r\n                className=\"flex-1\"\r\n              >\r\n                {isLoading ? 'Creating...' : 'Create Organization'}\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Plan Features Info */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Plan Features</CardTitle>\r\n          <CardDescription>\r\n            Compare what's included with each plan\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid gap-4\">\r\n            <div className=\"p-4 bg-green-50 rounded-lg\">\r\n              <h4 className=\"font-semibold text-green-800\">Beta (Free)</h4>\r\n              <p className=\"text-sm text-green-700\">\r\n                Perfect for getting started â€¢ Up to 50 members â€¢ Basic features\r\n              </p>\r\n            </div>\r\n            <div className=\"p-4 bg-blue-50 rounded-lg\">\r\n              <h4 className=\"font-semibold text-blue-800\">Basic & Standard</h4>\r\n              <p className=\"text-sm text-blue-700\">\r\n                Enhanced features â€¢ More members â€¢ Advanced analytics\r\n              </p>\r\n            </div>\r\n            <div className=\"p-4 bg-purple-50 rounded-lg\">\r\n              <h4 className=\"font-semibold text-purple-800\">Premium</h4>\r\n              <p className=\"text-sm text-purple-700\">\r\n                Full features â€¢ Unlimited members â€¢ Priority support\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrgCreatePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\organizations\\OrgHub.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1652,1655],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1652,1655],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2242,2245],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2242,2245],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2619,2622],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2619,2622],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { \r\n  Table, \r\n  TableBody, \r\n  TableCell, \r\n  TableHead, \r\n  TableHeader, \r\n  TableRow \r\n} from '@/components/ui/table';\r\nimport { \r\n  Building2, \r\n  Users, \r\n  Plus, \r\n  ArrowUpRight, \r\n  UserMinus,\r\n  Calendar,\r\n  Send\r\n} from 'lucide-react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\nimport { useOrgInvitations } from '@/hooks/useOrgInvitations';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nconst OrgHub = () => {\r\n  const { organizations, isLoading } = useOrgContext();\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const [inviteCode, setInviteCode] = useState('');\r\n  const [isJoining, setIsJoining] = useState(false);\r\n\r\n  const handleJoinWithCode = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!inviteCode.trim()) {\r\n      toast({\r\n        title: \"Invalid Code\",\r\n        description: \"Please enter a valid invitation code.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsJoining(true);\r\n    try {\r\n      const { data, error } = await supabase.rpc('accept_invite', {\r\n        p_code: inviteCode.trim()\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      const result = data as any;\r\n      if (result?.success) {\r\n        toast({\r\n          title: \"Successfully Joined!\",\r\n          description: \"You have been added to the organization.\",\r\n        });\r\n        \r\n        // Route based on role\r\n        const role = result.role;\r\n        if (role === 'owner' || role === 'instructor') {\r\n          navigate(`/dashboard/instructor?org=${result.org_id}`);\r\n        } else {\r\n          navigate(`/dashboard/learner?org=${result.org_id}`);\r\n        }\r\n      } else {\r\n        throw new Error(result?.error || 'Failed to join organization');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error joining organization:', error);\r\n      toast({\r\n        title: \"Failed to Join\",\r\n        description: error.message || \"Please check your invitation code and try again.\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsJoining(false);\r\n      setInviteCode('');\r\n    }\r\n  };\r\n\r\n  const handleOpenOrganization = (org: any) => {\r\n    const role = org.role;\r\n    if (role === 'owner' || role === 'instructor') {\r\n      navigate(`/dashboard/instructor?org=${org.organization_id}`);\r\n    } else {\r\n      navigate(`/dashboard/learner?org=${org.organization_id}`);\r\n    }\r\n  };\r\n\r\n  const handleLeaveOrganization = async (orgId: string) => {\r\n    // This would need to be implemented in the backend\r\n    toast({\r\n      title: \"Feature Coming Soon\",\r\n      description: \"Leave organization functionality will be available soon.\",\r\n    });\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"h-8 bg-muted animate-pulse rounded\" />\r\n        <div className=\"grid gap-6 md:grid-cols-2\">\r\n          <div className=\"h-64 bg-muted animate-pulse rounded-lg\" />\r\n          <div className=\"h-64 bg-muted animate-pulse rounded-lg\" />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Header */}\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold text-white\">Organizations</h1>\r\n        <p className=\"text-white mt-2\">\r\n          Manage your organizations, join new ones, or create your own.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Action Cards Grid */}\r\n      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n        {/* My Organizations */}\r\n        <Card className=\"md:col-span-2\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Building2 className=\"h-5 w-5\" />\r\n              My Organizations\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Organizations you belong to and your role in each\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {organizations.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <Building2 className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                <p className=\"text-muted-foreground mb-4\">\r\n                  You're not a member of any organizations yet.\r\n                </p>\r\n                <Button onClick={() => navigate('/org/create')}>\r\n                  Create Your First Organization\r\n                </Button>\r\n              </div>\r\n            ) : (\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Name</TableHead>\r\n                    <TableHead>Role</TableHead>\r\n                    <TableHead>Plan</TableHead>\r\n                    <TableHead>Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {organizations.map((org) => (\r\n                    <TableRow key={org.organization_id}>\r\n                      <TableCell className=\"font-medium\">\r\n                        {org.organizations.name}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge variant={\r\n                          org.role === 'owner' ? 'default' : \r\n                          org.role === 'instructor' ? 'secondary' : 'outline'\r\n                        }>\r\n                          {org.role}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge variant=\"outline\">\r\n                          {org.organizations.plan}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Button\r\n                            size=\"sm\"\r\n                            onClick={() => handleOpenOrganization(org)}\r\n                          >\r\n                            <ArrowUpRight className=\"h-4 w-4 mr-1\" />\r\n                            Open\r\n                          </Button>\r\n                          {org.role !== 'owner' && (\r\n                            <Button\r\n                              size=\"sm\"\r\n                              variant=\"outline\"\r\n                              onClick={() => handleLeaveOrganization(org.organization_id)}\r\n                            >\r\n                              <UserMinus className=\"h-4 w-4 mr-1\" />\r\n                              Leave\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Join with Code */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Send className=\"h-5 w-5\" />\r\n              Join with Code\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Enter an invitation code to join an organization\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <form onSubmit={handleJoinWithCode} className=\"space-y-4\">\r\n              <div>\r\n                <Label htmlFor=\"inviteCode\">Invitation Code</Label>\r\n                <Input\r\n                  id=\"inviteCode\"\r\n                  value={inviteCode}\r\n                  onChange={(e) => setInviteCode(e.target.value)}\r\n                  placeholder=\"Enter your invitation code\"\r\n                  disabled={isJoining}\r\n                />\r\n              </div>\r\n              <Button type=\"submit\" className=\"w-full\" disabled={isJoining}>\r\n                {isJoining ? 'Joining...' : 'Join Organization'}\r\n              </Button>\r\n            </form>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Bottom Action Cards */}\r\n      <div className=\"grid gap-6 md:grid-cols-2\">\r\n        {/* Create Organization */}\r\n        <Card className=\"cursor-pointer hover:shadow-md transition-shadow\" \r\n              onClick={() => navigate('/org/create')}>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Plus className=\"h-5 w-5\" />\r\n              Create Organization\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Start your own organization and invite members\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Button className=\"w-full\">\r\n              Create New Organization\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Invitations */}\r\n        <Card className=\"cursor-pointer hover:shadow-md transition-shadow\"\r\n              onClick={() => navigate('/org/invitations')}>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Calendar className=\"h-5 w-5\" />\r\n              Pending Invitations\r\n            </CardTitle>\r\n            <CardDescription>\r\n              View and manage your pending organization invitations\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Button variant=\"outline\" className=\"w-full\">\r\n              View Invitations\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrgHub;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\organizations\\OrgInstructorDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\organizations\\OrgInvitationsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3457,3460],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3457,3460],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { \r\n  Table, \r\n  TableBody, \r\n  TableCell, \r\n  TableHead, \r\n  TableHeader, \r\n  TableRow \r\n} from '@/components/ui/table';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Calendar, ArrowLeft, Check, X, Mail } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst OrgInvitationsPage = () => {\r\n  const navigate = useNavigate();\r\n  \r\n  // Mock data - in a real app, this would come from an API\r\n  const pendingInvitations = [\r\n    // This would be populated from a real API call\r\n    // For now, we'll show empty state\r\n  ];\r\n\r\n  const handleAcceptInvitation = (invitationId: string) => {\r\n    // This would handle accepting an invitation\r\n    console.log('Accept invitation:', invitationId);\r\n  };\r\n\r\n  const handleDeclineInvitation = (invitationId: string) => {\r\n    // This would handle declining an invitation\r\n    console.log('Decline invitation:', invitationId);\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-4\">\r\n        <Button variant=\"ghost\" size=\"sm\" onClick={() => navigate('/org')}>\r\n          <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n          Back to Organizations\r\n        </Button>\r\n      </div>\r\n\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n          <Calendar className=\"h-8 w-8\" />\r\n          Pending Invitations\r\n        </h1>\r\n        <p className=\"text-muted-foreground mt-2\">\r\n          View and manage your pending organization invitations.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Invitations */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Organization Invitations</CardTitle>\r\n          <CardDescription>\r\n            Invitations waiting for your response\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {pendingInvitations.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <Mail className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n              <h3 className=\"text-lg font-semibold mb-2\">No Pending Invitations</h3>\r\n              <p className=\"text-muted-foreground mb-4\">\r\n                You don't have any pending organization invitations at the moment.\r\n              </p>\r\n              <div className=\"space-y-2\">\r\n                <Button onClick={() => navigate('/org/join')}>\r\n                  Join with Invitation Code\r\n                </Button>\r\n                <br />\r\n                <Button variant=\"outline\" onClick={() => navigate('/org/create')}>\r\n                  Create Your Own Organization\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Organization</TableHead>\r\n                  <TableHead>Role</TableHead>\r\n                  <TableHead>Invited By</TableHead>\r\n                  <TableHead>Received</TableHead>\r\n                  <TableHead>Expires</TableHead>\r\n                  <TableHead>Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {pendingInvitations.map((invitation: any) => (\r\n                  <TableRow key={invitation.id}>\r\n                    <TableCell className=\"font-medium\">\r\n                      {invitation.organizationName}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Badge variant=\"outline\">\r\n                        {invitation.role}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell>{invitation.invitedBy}</TableCell>\r\n                    <TableCell>{invitation.receivedAt}</TableCell>\r\n                    <TableCell>\r\n                      <Badge variant=\"destructive\">\r\n                        {invitation.expiresAt}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          onClick={() => handleAcceptInvitation(invitation.id)}\r\n                        >\r\n                          <Check className=\"h-4 w-4 mr-1\" />\r\n                          Accept\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleDeclineInvitation(invitation.id)}\r\n                        >\r\n                          <X className=\"h-4 w-4 mr-1\" />\r\n                          Decline\r\n                        </Button>\r\n                      </div>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Help Information */}\r\n      <Alert>\r\n        <Calendar className=\"h-4 w-4\" />\r\n        <AlertDescription>\r\n          <strong>About Invitations:</strong>\r\n          <br />\r\n          Organization invitations are typically sent via email and may have expiration dates. \r\n          If you have an invitation code, you can also join directly using the \"Join with Code\" option.\r\n        </AlertDescription>\r\n      </Alert>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrgInvitationsPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\organizations\\OrgJoin.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1368,1371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1368,1371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1813,1816],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1813,1816],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1847,1850],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1847,1850],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2107,2110],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2107,2110],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2173,2176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2173,2176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2476,2479],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2476,2479],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":76,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2534,2537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2534,2537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2608,2611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2608,2611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":88,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2815,2818],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2815,2818],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":90,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2878,2881],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2878,2881],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":92,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2950,2953],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2950,2953],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3074,3077],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3074,3077],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3206,3209],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3206,3209],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3251,3254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3251,3254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nexport default function OrgJoin() {\r\n  const [inviteCode, setInviteCode] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { toast } = useToast();\r\n  const navigate = useNavigate();\r\n\r\n  const handleJoinOrg = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!inviteCode.trim()) {\r\n      toast({\r\n        title: 'Error',\r\n        description: 'Please enter an invitation code.',\r\n        variant: 'destructive',\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      // Get current user first\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) {\r\n        throw new Error('Please sign in to join an organization.');\r\n      }\r\n\r\n      // Find the invitation by code using type assertion since types aren't updated\r\n      const { data: invitation, error: inviteError } = await supabase\r\n        .from('org_invites' as any)\r\n        .select(`\r\n          *,\r\n          organizations (\r\n            id,\r\n            name\r\n          )\r\n        `)\r\n        .eq('code', inviteCode.trim())\r\n        .gt('expires_at', new Date().toISOString())\r\n        .single();\r\n\r\n      if (inviteError || !invitation) {\r\n        throw new Error('Invalid invitation code or expired invitation.');\r\n      }\r\n\r\n      // Check if invitation has reached max uses\r\n      if ((invitation as any).uses_count >= (invitation as any).max_uses) {\r\n        throw new Error('This invitation code has already been used the maximum number of times.');\r\n      }\r\n\r\n      // Check if user is already a member\r\n      const { data: existingMember } = await supabase\r\n        .from('org_members' as any)\r\n        .select('id')\r\n        .eq('org_id', (invitation as any).org_id)\r\n        .eq('user_id', user.id)\r\n        .maybeSingle();\r\n\r\n      if (existingMember) {\r\n        throw new Error('You are already a member of this organization.');\r\n      }\r\n\r\n      // Add user as member\r\n      const { error: memberError } = await supabase\r\n        .from('org_members' as any)\r\n        .insert({\r\n          org_id: (invitation as any).org_id,\r\n          user_id: user.id,\r\n          role: (invitation as any).role,\r\n          status: 'active'\r\n        });\r\n\r\n      if (memberError) {\r\n        throw memberError;\r\n      }\r\n\r\n      // Update invitation usage\r\n      await supabase\r\n        .from('org_invites' as any)\r\n        .update({\r\n          uses_count: ((invitation as any).uses_count || 0) + 1\r\n        })\r\n        .eq('id', (invitation as any).id);\r\n\r\n      toast({\r\n        title: 'Success!',\r\n        description: `You have successfully joined ${(invitation as any).organizations.name}.`,\r\n      });\r\n      \r\n      // Navigate to the organization portal\r\n      navigate(`/org/${(invitation as any).org_id}`);\r\n      \r\n    } catch (error: any) {\r\n      toast({\r\n        title: 'Error joining organization',\r\n        description: error.message || 'Invalid invitation code or expired invitation.',\r\n        variant: 'destructive',\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center p-4\">\r\n      <Card className=\"w-full max-w-md\">\r\n        <CardHeader>\r\n          <CardTitle>Join Organization</CardTitle>\r\n          <CardDescription>\r\n            Enter your invitation code to join an organization.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handleJoinOrg} className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"inviteCode\">Invitation Code</Label>\r\n              <Input\r\n                id=\"inviteCode\"\r\n                type=\"text\"\r\n                placeholder=\"Enter invitation code\"\r\n                value={inviteCode}\r\n                onChange={(e) => setInviteCode(e.target.value)}\r\n                disabled={isLoading}\r\n              />\r\n            </div>\r\n            <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n              {isLoading ? 'Joining...' : 'Join Organization'}\r\n            </Button>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\organizations\\OrgJoinPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2518,2521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2518,2521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":88,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3108,3111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3108,3111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Send, ArrowLeft, CheckCircle, AlertCircle, Loader2 } from 'lucide-react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nconst OrgJoinPage = () => {\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const { user, loading } = useAuth();\r\n  const [searchParams] = useSearchParams();\r\n  const [inviteCode, setInviteCode] = useState('');\r\n  const [isJoining, setIsJoining] = useState(false);\r\n\r\n  // Check authentication and get code from URL parameters\r\n  useEffect(() => {\r\n    if (!loading && !user) {\r\n      // Store the invite code and redirect to login\r\n      const codeFromUrl = searchParams.get('code') || searchParams.get('token');\r\n      if (codeFromUrl) {\r\n        localStorage.setItem('pendingInviteCode', codeFromUrl);\r\n      }\r\n      navigate('/login', { \r\n        state: { \r\n          returnUrl: '/join' + (codeFromUrl ? `?code=${codeFromUrl}` : '') \r\n        } \r\n      });\r\n      return;\r\n    }\r\n\r\n    // Get code from URL parameters on mount\r\n    const codeFromUrl = searchParams.get('code') || searchParams.get('token');\r\n    if (codeFromUrl) {\r\n      setInviteCode(codeFromUrl);\r\n    } else {\r\n      // Check if there's a pending invite code from localStorage\r\n      const pendingCode = localStorage.getItem('pendingInviteCode');\r\n      if (pendingCode) {\r\n        setInviteCode(pendingCode);\r\n        localStorage.removeItem('pendingInviteCode');\r\n      }\r\n    }\r\n  }, [searchParams, navigate, user, loading]);\r\n\r\n  const handleJoinOrganization = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!inviteCode.trim()) {\r\n      toast({\r\n        title: \"Invalid Code\",\r\n        description: \"Please enter a valid invitation code.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsJoining(true);\r\n    try {\r\n      const { data, error } = await supabase.rpc('accept_invite', {\r\n        p_code: inviteCode.trim()\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      const result = data as any;\r\n      if (result?.success) {\r\n        toast({\r\n          title: \"Successfully Joined!\",\r\n          description: \"You have been added to the organization.\",\r\n        });\r\n        \r\n        // Route based on role\r\n        const role = result.role;\r\n        if (role === 'owner' || role === 'instructor') {\r\n          navigate(`/dashboard/instructor?org=${result.org_id}`);\r\n        } else {\r\n          navigate(`/dashboard/learner?org=${result.org_id}`);\r\n        }\r\n      } else {\r\n        throw new Error(result?.error || 'Failed to join organization');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error joining organization:', error);\r\n      \r\n      let errorMessage = \"Please check your invitation code and try again.\";\r\n      \r\n      if (error.message?.includes('Invalid or expired')) {\r\n        errorMessage = \"This invitation code is invalid or has expired.\";\r\n      } else if (error.message?.includes('already a member')) {\r\n        errorMessage = \"You are already a member of this organization.\";\r\n      } else if (error.message?.includes('maximum capacity')) {\r\n        errorMessage = \"This organization has reached its member limit.\";\r\n      }\r\n      \r\n      toast({\r\n        title: \"Failed to Join\",\r\n        description: errorMessage,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsJoining(false);\r\n    }\r\n  };\r\n\r\n  // Show loading while checking authentication\r\n  if (loading) {\r\n    return (\r\n      <div className=\"max-w-md mx-auto space-y-6 flex items-center justify-center min-h-[50vh]\">\r\n        <div className=\"text-center\">\r\n          <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-4\" />\r\n          <p className=\"text-muted-foreground\">Checking authentication...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Don't render anything if not authenticated (will redirect)\r\n  if (!user) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-md mx-auto space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-4\">\r\n        <Button variant=\"ghost\" size=\"sm\" onClick={() => navigate('/org')}>\r\n          <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n          Back\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"text-center\">\r\n        <h1 className=\"text-3xl font-bold flex items-center justify-center gap-2\">\r\n          <Send className=\"h-8 w-8\" />\r\n          Join Organization\r\n        </h1>\r\n        <p className=\"text-muted-foreground mt-2\">\r\n          Enter your invitation code to join an organization.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Join Form */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Invitation Code</CardTitle>\r\n          <CardDescription>\r\n            Enter the code you received from the organization\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handleJoinOrganization} className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"inviteCode\">Code</Label>\r\n              <Input\r\n                id=\"inviteCode\"\r\n                value={inviteCode}\r\n                onChange={(e) => setInviteCode(e.target.value)}\r\n                placeholder=\"Enter invitation code\"\r\n                disabled={isJoining}\r\n                className=\"text-center font-mono\"\r\n              />\r\n            </div>\r\n\r\n            <Button \r\n              type=\"submit\" \r\n              className=\"w-full\" \r\n              disabled={isJoining || !inviteCode.trim()}\r\n            >\r\n              {isJoining ? 'Joining...' : 'Join Organization'}\r\n            </Button>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Help Information */}\r\n      <div className=\"space-y-4\">\r\n        <Alert>\r\n          <CheckCircle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            <strong>What happens next?</strong>\r\n            <br />\r\n            Once you join, you'll be redirected to the appropriate dashboard based on your assigned role in the organization.\r\n          </AlertDescription>\r\n        </Alert>\r\n\r\n        <Alert>\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            <strong>Don't have an invitation code?</strong>\r\n            <br />\r\n            Ask an organization owner or instructor to send you an invitation. They can create one from their organization management dashboard.\r\n          </AlertDescription>\r\n        </Alert>\r\n      </div>\r\n\r\n      {/* Alternative Actions */}\r\n      <div className=\"text-center space-y-2\">\r\n        <p className=\"text-sm text-muted-foreground\">\r\n          Don't have an organization yet?\r\n        </p>\r\n        <Button variant=\"outline\" onClick={() => navigate('/org/create')}>\r\n          Create Your Own Organization\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrgJoinPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\organizations\\OrgPortalHome.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2818,2821],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2818,2821],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Loader2 } from 'lucide-react';\r\nimport { \r\n  Users, \r\n  BookOpen, \r\n  Target, \r\n  TrendingUp, \r\n  Calendar,\r\n  Award\r\n} from 'lucide-react';\r\nimport { useOrgContext } from '@/components/organizations/OrgContext';\r\nimport { useOrgStatistics } from '@/hooks/useOrgStatistics';\r\nimport { useOrgAnalytics } from '@/hooks/useOrgAnalytics';\r\n\r\nexport default function OrgPortalHome() {\r\n  const { currentOrg } = useOrgContext();\r\n  const { data: statistics, isLoading: statsLoading, error: statsError } = useOrgStatistics();\r\n  const { analytics, isLoading: analyticsLoading } = useOrgAnalytics();\r\n\r\n  if (!currentOrg) {\r\n    return (\r\n      <div className=\"container mx-auto py-8\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Welcome to Organizations</CardTitle>\r\n            <CardDescription>\r\n              Join or create an organization to get started.\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"flex space-x-4\">\r\n              <Button>Create Organization</Button>\r\n              <Button variant=\"outline\">Join with Code</Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (statsLoading || analyticsLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[400px]\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (statsError) {\r\n    return (\r\n      <div className=\"container mx-auto py-8\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Error Loading Statistics</CardTitle>\r\n            <CardDescription>\r\n              Unable to load organization statistics. Please try again later.\r\n            </CardDescription>\r\n          </CardHeader>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const stats = [\r\n    { \r\n      label: 'Active Students', \r\n      value: statistics?.studentCount?.toString() || '0', \r\n      icon: Users, \r\n      color: 'text-blue-600' \r\n    },\r\n    { \r\n      label: 'Course Assignments', \r\n      value: statistics?.courseAssignments?.toString() || '0', \r\n      icon: BookOpen, \r\n      color: 'text-green-600' \r\n    },\r\n    { \r\n      label: 'Active Goals', \r\n      value: statistics?.activeGoals?.toString() || '0', \r\n      icon: Target, \r\n      color: 'text-purple-600' \r\n    },\r\n    { \r\n      label: 'Completion Rate', \r\n      value: `${statistics?.completionRate || 0}%`, \r\n      icon: TrendingUp, \r\n      color: 'text-orange-600' \r\n    },\r\n  ];\r\n\r\n  const recentActivity: any[] = [];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Welcome Section */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Welcome back!</h1>\r\n          <p className=\"text-muted-foreground mt-2\">\r\n            Here's what's happening in {currentOrg.organizations.name}\r\n          </p>\r\n        </div>\r\n        <Badge variant=\"secondary\" className=\"capitalize\">\r\n          {currentOrg.organizations.subscription_tier} Plan\r\n        </Badge>\r\n      </div>\r\n\r\n      {/* Stats Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        {stats.map((stat, index) => (\r\n          <Card key={index}>\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">{stat.label}</CardTitle>\r\n              <stat.icon className={`h-4 w-4 ${stat.color}`} />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">{stat.value}</div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Progress Overview */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center space-x-2\">\r\n              <TrendingUp className=\"h-5 w-5\" />\r\n              <span>Progress Overview</span>\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Current completion rates across all courses\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"text-center py-8\">\r\n              <TrendingUp className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\r\n              <p className=\"text-sm text-muted-foreground\">No progress data available yet</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Recent Activity */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center space-x-2\">\r\n              <Calendar className=\"h-5 w-5\" />\r\n              <span>Recent Activity</span>\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Latest updates from your organization\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n           <div className=\"space-y-4\">\r\n              {recentActivity.length > 0 ? (\r\n                recentActivity.map((activity, index) => (\r\n                  <div key={index} className=\"flex items-start space-x-3\">\r\n                    <div className=\"w-2 h-2 bg-primary rounded-full mt-2\" />\r\n                    <div className=\"flex-1 space-y-1\">\r\n                      <p className=\"text-sm font-medium leading-none\">\r\n                        {activity.student_name}: {activity.activity}\r\n                      </p>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        {new Date(activity.timestamp).toLocaleString()}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"text-center py-8\">\r\n                  <Calendar className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\r\n                  <p className=\"text-sm text-muted-foreground\">No recent activity</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Quick Actions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Quick Actions</CardTitle>\r\n          <CardDescription>\r\n            Common tasks for organization management\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex flex-wrap gap-4\">\r\n            <Button className=\"flex items-center space-x-2\">\r\n              <Users className=\"h-4 w-4\" />\r\n              <span>Invite Members</span>\r\n            </Button>\r\n            <Button variant=\"outline\" className=\"flex items-center space-x-2\">\r\n              <BookOpen className=\"h-4 w-4\" />\r\n              <span>Assign Course</span>\r\n            </Button>\r\n            <Button variant=\"outline\" className=\"flex items-center space-x-2\">\r\n              <Target className=\"h-4 w-4\" />\r\n              <span>Create Goal</span>\r\n            </Button>\r\n            <Button variant=\"outline\" className=\"flex items-center space-x-2\">\r\n              <Award className=\"h-4 w-4\" />\r\n              <span>View Reports</span>\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\scorm\\ScormAssignments.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\scorm\\ScormPackages.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\scorm\\ScormPlayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\scorm\\ScormStudio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\pages\\system\\Forbidden.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[418,421],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[418,421],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useNavigate, useLocation } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { ShieldX, ArrowLeft, Home } from 'lucide-react';\r\n\r\nexport default function Forbidden() {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const fromPath = (location.state as any)?.from?.pathname || '/scorm/studio';\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\r\n      <Card className=\"w-full max-w-md\">\r\n        <CardHeader className=\"text-center\">\r\n          <div className=\"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10\">\r\n            <ShieldX className=\"h-8 w-8 text-destructive\" />\r\n          </div>\r\n          <CardTitle className=\"text-2xl font-semibold\">403 â€” Access Forbidden</CardTitle>\r\n          <CardDescription className=\"text-muted-foreground\">\r\n            You don't have permission to access this area. SCORM Studio is restricted to administrators only.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"text-sm text-muted-foreground bg-muted p-3 rounded-lg\">\r\n            <strong>Attempted to access:</strong> {fromPath}\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => navigate(-1)}\r\n              className=\"flex-1\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              Go Back\r\n            </Button>\r\n            <Button\r\n              onClick={() => navigate('/')}\r\n              className=\"flex-1\"\r\n            >\r\n              <Home className=\"h-4 w-4 mr-2\" />\r\n              Home\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\analytics\\ScormAnalytics.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2376,2379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2376,2379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { \r\n  BarChart3, Users, Package, TrendingUp, Download, Search,\r\n  Calendar, Filter, RefreshCw, AlertCircle, Eye, ArrowUpRight\r\n} from 'lucide-react';\r\nimport {\r\n  useScormKPIs,\r\n  usePackagePerformance,\r\n  useLearnerProgress,\r\n  useScormTrends,\r\n  useScormPackagesList,\r\n  exportAnalytics\r\n} from '@/hooks/useScormAnalytics';\r\nimport { \r\n  useScormSummary\r\n} from '@/hooks/scorm/useScormAnalytics';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, BarChart, Bar, AreaChart, Area } from 'recharts';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nexport const ScormAnalytics: React.FC = () => {\r\n  const { toast } = useToast();\r\n  const [filters, setFilters] = useState({\r\n    packageId: undefined as string | undefined,\r\n    dateRange: '30',\r\n    search: '',\r\n    page: 1,\r\n    pageSize: 25\r\n  });\r\n\r\n  // Calculate date range\r\n  const dateRange = useMemo(() => {\r\n    const days = parseInt(filters.dateRange);\r\n    const dateTo = new Date().toISOString();\r\n    const dateFrom = new Date(Date.now() - days * 24 * 60 * 60 * 1000).toISOString();\r\n    return { dateFrom, dateTo };\r\n  }, [filters.dateRange]);\r\n\r\n  // Data hooks\r\n  const kpisQuery = useScormSummary({});\r\n  const performanceQuery = useScormSummary({ packageId: filters.packageId });\r\n  const progressQuery = useLearnerProgress({ \r\n    packageId: filters.packageId\r\n  });\r\n  const trendsQuery = useScormTrends({ ...filters, ...dateRange });\r\n  const packagesQuery = useScormPackagesList();\r\n\r\n  const handleExport = async (view: 'packages' | 'learners' | 'trends') => {\r\n    try {\r\n      await exportAnalytics(view, { ...filters, ...dateRange });\r\n      toast({\r\n        title: \"Export Started\",\r\n        description: \"Your analytics data is being prepared for download.\",\r\n      });\r\n    } catch (error: any) {\r\n      toast({\r\n        title: \"Export Failed\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const updateFilters = (updates: Partial<typeof filters>) => {\r\n    setFilters(prev => ({ ...prev, ...updates, page: 1 }));\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Filters */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Filter className=\"h-5 w-5\" />\r\n            Analytics Filters\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <div>\r\n              <Label htmlFor=\"package-select\">Package</Label>\r\n              <Select\r\n                value={filters.packageId || 'all'}\r\n                onValueChange={(value) => updateFilters({ packageId: value === 'all' ? undefined : value })}\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"All Packages\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Packages</SelectItem>\r\n                  {packagesQuery.data?.map((pkg) => (\r\n                    <SelectItem key={pkg.id} value={pkg.id}>\r\n                      {pkg.title}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"date-range\">Date Range</Label>\r\n              <Select\r\n                value={filters.dateRange}\r\n                onValueChange={(value) => updateFilters({ dateRange: value })}\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"7\">Last 7 days</SelectItem>\r\n                  <SelectItem value=\"30\">Last 30 days</SelectItem>\r\n                  <SelectItem value=\"90\">Last 90 days</SelectItem>\r\n                  <SelectItem value=\"365\">Last year</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"search\">Search Learners</Label>\r\n              <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                <Input\r\n                  id=\"search\"\r\n                  placeholder=\"Search by name or email...\"\r\n                  value={filters.search}\r\n                  onChange={(e) => updateFilters({ search: e.target.value })}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* KPIs */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Packages</p>\r\n                {kpisQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">{kpisQuery.data?.totalPackages || 0}</p>\r\n                )}\r\n              </div>\r\n              <Package className=\"h-8 w-8 text-primary\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Active Enrollments</p>\r\n                {kpisQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">{kpisQuery.data?.totalEnrollments || 0}</p>\r\n                )}\r\n              </div>\r\n              <Users className=\"h-8 w-8 text-blue-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Completion Rate</p>\r\n                {kpisQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">\r\n                    {kpisQuery.data?.totalEnrollments \r\n                      ? Math.round((kpisQuery.data.completed / kpisQuery.data.totalEnrollments) * 100)\r\n                      : 0}%\r\n                  </p>\r\n                )}\r\n              </div>\r\n              <TrendingUp className=\"h-8 w-8 text-green-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Avg Score</p>\r\n                {kpisQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">{Math.round(kpisQuery.data?.avgScore || 0)}%</p>\r\n                )}\r\n              </div>\r\n              <BarChart3 className=\"h-8 w-8 text-purple-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <Tabs defaultValue=\"packages\" className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"packages\">Package Performance</TabsTrigger>\r\n          <TabsTrigger value=\"learners\">Learner Progress</TabsTrigger>\r\n          <TabsTrigger value=\"trends\">Trends</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"packages\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between\">\r\n              <CardTitle>Package Performance</CardTitle>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => handleExport('packages')}\r\n                disabled={performanceQuery.isLoading}\r\n              >\r\n                <Download className=\"h-4 w-4 mr-2\" />\r\n                Export\r\n              </Button>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {performanceQuery.isLoading ? (\r\n                <div className=\"space-y-3\">\r\n                  {[...Array(5)].map((_, i) => (\r\n                    <div key={i} className=\"h-16 bg-muted animate-pulse rounded\" />\r\n                  ))}\r\n                </div>\r\n              ) : performanceQuery.data?.packages?.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <AlertCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                  <h3 className=\"text-lg font-semibold mb-2\">No Data Available</h3>\r\n                  <p className=\"text-muted-foreground\">No packages found for the selected criteria.</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-4\">\r\n                  {performanceQuery.data?.packages?.map((pkg) => (\r\n                    <div key={pkg.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\r\n                      <div className=\"flex-1\">\r\n                        <h4 className=\"font-medium\">{pkg.title}</h4>\r\n                        <div className=\"flex items-center gap-4 mt-2 text-sm text-muted-foreground\">\r\n                          <span>{pkg.enrollment_count} enrollments</span>\r\n                          <span>{pkg.completions} completions</span>\r\n                          <Badge variant={pkg.completion_rate > 70 ? 'default' : 'secondary'}>\r\n                            {pkg.completion_rate}% completion\r\n                          </Badge>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <p className=\"text-2xl font-bold\">{Math.round(pkg.avg_score)}%</p>\r\n                        <p className=\"text-sm text-muted-foreground\">avg score</p>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"learners\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between\">\r\n              <CardTitle>Learner Progress</CardTitle>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => handleExport('learners')}\r\n                disabled={progressQuery.isLoading}\r\n              >\r\n                <Download className=\"h-4 w-4 mr-2\" />\r\n                Export\r\n              </Button>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {progressQuery.isLoading ? (\r\n                <div className=\"space-y-3\">\r\n                  {[...Array(10)].map((_, i) => (\r\n                    <div key={i} className=\"h-12 bg-muted animate-pulse rounded\" />\r\n                  ))}\r\n                </div>\r\n              ) : progressQuery.data?.data?.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <AlertCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                  <h3 className=\"text-lg font-semibold mb-2\">No Progress Data</h3>\r\n                  <p className=\"text-muted-foreground\">No learner progress found for the selected criteria.</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-3\">\r\n                  {progressQuery.data?.data?.map((learner) => (\r\n                    <div key={`${learner.userId}-${learner.packageId}`} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <div>\r\n                            <p className=\"font-medium\">{learner.learnerName}</p>\r\n                            <p className=\"text-sm text-muted-foreground\">{learner.packageTitle}</p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-4\">\r\n                        <div className=\"text-center\">\r\n                          <p className=\"text-sm font-medium\">{learner.progressPct}%</p>\r\n                          <p className=\"text-xs text-muted-foreground\">\r\n                            {learner.scosCompleted}/{learner.scosTotal} SCOs\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            {learner.lastActivity \r\n                              ? formatDistanceToNow(new Date(learner.lastActivity), { addSuffix: true })\r\n                              : 'Never'\r\n                            }\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                  \r\n                  {/* Pagination - removed since useLearnerProgress returns simple array */}\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"trends\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between\">\r\n              <CardTitle>Analytics Trends</CardTitle>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => handleExport('trends')}\r\n                disabled={trendsQuery.isLoading}\r\n              >\r\n                <Download className=\"h-4 w-4 mr-2\" />\r\n                Export\r\n              </Button>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {trendsQuery.isLoading ? (\r\n                <div className=\"h-80 bg-muted animate-pulse rounded\" />\r\n              ) : trendsQuery.data?.length === 0 ? (\r\n                <div className=\"text-center py-16\">\r\n                  <AlertCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                  <h3 className=\"text-lg font-semibold mb-2\">No Trend Data</h3>\r\n                  <p className=\"text-muted-foreground\">No activity found for the selected period.</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-6\">\r\n                  <div className=\"h-80\">\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                      <LineChart data={trendsQuery.data}>\r\n                        <CartesianGrid strokeDasharray=\"3 3\" />\r\n                        <XAxis dataKey=\"date\" />\r\n                        <YAxis />\r\n                        <Tooltip />\r\n                        <Line type=\"monotone\" dataKey=\"enrollments\" stroke=\"#8884d8\" name=\"Enrollments\" />\r\n                        <Line type=\"monotone\" dataKey=\"activeLearners\" stroke=\"#82ca9d\" name=\"Active Learners\" />\r\n                      </LineChart>\r\n                    </ResponsiveContainer>\r\n                  </div>\r\n\r\n                  <div className=\"h-80\">\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                      <AreaChart data={trendsQuery.data}>\r\n                        <CartesianGrid strokeDasharray=\"3 3\" />\r\n                        <XAxis dataKey=\"date\" />\r\n                        <YAxis />\r\n                        <Tooltip />\r\n                        <Area type=\"monotone\" dataKey=\"avgScore\" stroke=\"#ffc658\" fill=\"#ffc658\" name=\"Avg Score %\" />\r\n                      </AreaChart>\r\n                    </ResponsiveContainer>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\ingest\\manifest-parser.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[206,209],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[206,209],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[579,582],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[579,582],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[736,739],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[736,739],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[759,762],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[759,762],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1321,1324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1321,1324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1347,1350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1347,1350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":135,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3677,3680],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3677,3680],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":145,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4246,4249],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4246,4249],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":153,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4425,4428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4425,4428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4960,4963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4960,4963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":186,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5694,5697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5694,5697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":200,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6146,6149],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6146,6149],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":200,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6152,6155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6152,6155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":204,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6251,6254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6251,6254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":212,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":212,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6537,6540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6537,6540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":222,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6988,6991],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6988,6991],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":227,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7200,7203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7200,7203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8102,8105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8102,8105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":248,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":248,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8334,8337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8334,8337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":312,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":312,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10576,10579],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10576,10579],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":346,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":346,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11820,11823],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11820,11823],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":348,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11915,11918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11915,11918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":352,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":352,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12067,12070],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12067,12070],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":363,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12438,12441],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12438,12441],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":24,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { XMLParser } from 'fast-xml-parser';\r\n\r\nexport interface ManifestResource {\r\n  identifier: string;\r\n  type: string;\r\n  href: string;\r\n  scormType?: string;\r\n  adlcpScormType?: string;\r\n  metadata?: any;\r\n}\r\n\r\nexport interface ManifestItem {\r\n  identifier: string;\r\n  title: string;\r\n  identifierref?: string;\r\n  isVisible?: boolean;\r\n  parameters?: string;\r\n  masteryScore?: number;\r\n  prerequisites?: string[];\r\n  children?: ManifestItem[];\r\n  resourceHref?: string;\r\n  completionThreshold?: number;\r\n  timeLimitAction?: string;\r\n  dataFromLMS?: string;\r\n  sequencing?: any;\r\n}\r\n\r\nexport interface ManifestOrganization {\r\n  identifier: string;\r\n  title: string;\r\n  structure?: string;\r\n  items: ManifestItem[];\r\n  objectives?: any[];\r\n  sequencing?: any;\r\n}\r\n\r\nexport interface ParsedManifest {\r\n  version: string;\r\n  standard: 'SCORM 1.2' | 'SCORM 2004';\r\n  identifier: string;\r\n  title: string;\r\n  description?: string;\r\n  organizations: ManifestOrganization[];\r\n  resources: ManifestResource[];\r\n  scos: Array<{\r\n    id: string;\r\n    identifier: string;\r\n    title: string;\r\n    launch_href: string;\r\n    parameters?: string;\r\n    mastery_score?: number;\r\n    prerequisites?: string[];\r\n    seq_order: number;\r\n    resourceType?: string;\r\n    scormType?: string;\r\n    isLaunchable: boolean;\r\n    sequencing?: any;\r\n  }>;\r\n  metadata?: any;\r\n  defaultOrganization?: string;\r\n  schemaLocation?: string;\r\n  validation: {\r\n    isValid: boolean;\r\n    errors: string[];\r\n    warnings: string[];\r\n  };\r\n}\r\n\r\nexport class ScormManifestParser {\r\n  private xmlParser: XMLParser;\r\n\r\n  constructor() {\r\n    this.xmlParser = new XMLParser({\r\n      ignoreAttributes: false,\r\n      attributeNamePrefix: '@',\r\n      textNodeName: '#text',\r\n      parseAttributeValue: true,\r\n      trimValues: true,\r\n      alwaysCreateTextNode: false,\r\n      processEntities: true,\r\n      htmlEntities: true\r\n    });\r\n  }\r\n\r\n  public parseManifest(xmlContent: string): ParsedManifest {\r\n    try {\r\n      const parsedXml = this.xmlParser.parse(xmlContent);\r\n      const manifest = parsedXml.manifest || parsedXml['imscp:manifest'];\r\n\r\n      if (!manifest) {\r\n        throw new Error('No manifest element found in XML');\r\n      }\r\n\r\n      const validation = this.validateManifest(manifest);\r\n      const standard = this.detectStandard(manifest);\r\n      const version = this.extractVersion(manifest, standard);\r\n\r\n      // Extract basic manifest info\r\n      const identifier = manifest['@identifier'] || 'unknown';\r\n      const title = this.extractTitle(manifest) || 'Untitled Package';\r\n      const description = this.extractDescription(manifest);\r\n\r\n      // Parse organizations\r\n      const organizations = this.parseOrganizations(manifest.organizations, standard);\r\n      \r\n      // Parse resources\r\n      const resources = this.parseResources(manifest.resources);\r\n      \r\n      // Extract SCOs by matching items with resources\r\n      const scos = this.extractScos(organizations, resources, standard);\r\n\r\n      // Extract metadata\r\n      const metadata = this.extractMetadata(manifest);\r\n\r\n      return {\r\n        version,\r\n        standard,\r\n        identifier,\r\n        title,\r\n        description,\r\n        organizations,\r\n        resources,\r\n        scos,\r\n        metadata,\r\n        defaultOrganization: manifest.organizations?.['@default'] || organizations[0]?.identifier,\r\n        schemaLocation: manifest['@schemaLocation'] || manifest['@xsi:schemaLocation'],\r\n        validation\r\n      };\r\n    } catch (error) {\r\n      console.error('Manifest parsing error:', error);\r\n      throw new Error(`Failed to parse manifest: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  private detectStandard(manifest: any): 'SCORM 1.2' | 'SCORM 2004' {\r\n    // Check namespaces and schema locations\r\n    const xmlNamespaces = Object.keys(manifest).filter(key => key.startsWith('@xmlns'));\r\n    const schemaLocation = manifest['@schemaLocation'] || manifest['@xsi:schemaLocation'] || '';\r\n\r\n    // SCORM 2004 indicators\r\n    if (xmlNamespaces.some(ns => manifest[ns]?.includes('imsss')) ||\r\n        schemaLocation.includes('imsss') ||\r\n        schemaLocation.includes('2004') ||\r\n        manifest.organizations?.organization?.sequencing ||\r\n        manifest.resources?.resource?.some((r: any) => r['@adlcp:scormType'])) {\r\n      return 'SCORM 2004';\r\n    }\r\n\r\n    // SCORM 1.2 indicators or default\r\n    return 'SCORM 1.2';\r\n  }\r\n\r\n  private extractVersion(manifest: any, standard: 'SCORM 1.2' | 'SCORM 2004'): string {\r\n    if (standard === 'SCORM 2004') {\r\n      const schemaLocation = manifest['@schemaLocation'] || manifest['@xsi:schemaLocation'] || '';\r\n      if (schemaLocation.includes('2004_4th')) return '2004 4th Edition';\r\n      if (schemaLocation.includes('2004_3rd')) return '2004 3rd Edition';\r\n      if (schemaLocation.includes('2004')) return '2004';\r\n    }\r\n    \r\n    return manifest['@version'] || (standard === 'SCORM 1.2' ? '1.2' : '2004');\r\n  }\r\n\r\n  private extractTitle(manifest: any): string {\r\n    // Try multiple paths for title\r\n    const metadata = manifest.metadata;\r\n    if (metadata?.lom?.general?.title) {\r\n      const title = metadata.lom.general.title;\r\n      return title.langstring?.[\"#text\"] || title.langstring || title[\"#text\"] || title;\r\n    }\r\n    \r\n    if (metadata?.title) {\r\n      return metadata.title[\"#text\"] || metadata.title;\r\n    }\r\n\r\n    // Fallback to organization title\r\n    const orgs = manifest.organizations?.organization;\r\n    if (orgs) {\r\n      const firstOrg = Array.isArray(orgs) ? orgs[0] : orgs;\r\n      return firstOrg?.title?.[\"#text\"] || firstOrg?.title || firstOrg?.[\"@title\"];\r\n    }\r\n\r\n    return 'Untitled SCORM Package';\r\n  }\r\n\r\n  private extractDescription(manifest: any): string | undefined {\r\n    const metadata = manifest.metadata;\r\n    if (metadata?.lom?.general?.description) {\r\n      const desc = metadata.lom.general.description;\r\n      return desc.langstring?.[\"#text\"] || desc.langstring || desc[\"#text\"] || desc;\r\n    }\r\n    \r\n    if (metadata?.description) {\r\n      return metadata.description[\"#text\"] || metadata.description;\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n\r\n  private extractMetadata(manifest: any): any {\r\n    return manifest.metadata || {};\r\n  }\r\n\r\n  private parseOrganizations(organizationsNode: any, standard: 'SCORM 1.2' | 'SCORM 2004'): ManifestOrganization[] {\r\n    if (!organizationsNode) return [];\r\n\r\n    const orgs = organizationsNode.organization;\r\n    if (!orgs) return [];\r\n\r\n    const orgArray = Array.isArray(orgs) ? orgs : [orgs];\r\n    \r\n    return orgArray.map((org: any, index: number) => ({\r\n      identifier: org['@identifier'] || `org_${index}`,\r\n      title: org.title?.[\"#text\"] || org.title || org[\"@title\"] || `Organization ${index + 1}`,\r\n      structure: org['@structure'] || 'hierarchical',\r\n      items: this.parseItems(org.item, standard),\r\n      objectives: org.objectives || [],\r\n      sequencing: standard === 'SCORM 2004' ? org.sequencing : undefined\r\n    }));\r\n  }\r\n\r\n  private parseItems(itemsNode: any, standard: 'SCORM 1.2' | 'SCORM 2004', level = 0): ManifestItem[] {\r\n    if (!itemsNode) return [];\r\n\r\n    const items = Array.isArray(itemsNode) ? itemsNode : [itemsNode];\r\n    \r\n    return items.map((item: any, index: number) => ({\r\n      identifier: item['@identifier'] || `item_${level}_${index}`,\r\n      title: item.title?.[\"#text\"] || item.title || item[\"@title\"] || `Item ${index + 1}`,\r\n      identifierref: item['@identifierref'],\r\n      isVisible: item['@isvisible'] !== 'false', // Default to true\r\n      parameters: item['@parameters'],\r\n      masteryScore: item.masteryScore ? parseFloat(item.masteryScore) : undefined,\r\n      prerequisites: item.prerequisites?.split(',').map((p: string) => p.trim()) || [],\r\n      children: this.parseItems(item.item, standard, level + 1),\r\n      sequencing: standard === 'SCORM 2004' ? item.sequencing : undefined,\r\n      completionThreshold: item.completionThreshold ? parseFloat(item.completionThreshold) : undefined,\r\n      timeLimitAction: item.timeLimitAction,\r\n      dataFromLMS: item.dataFromLMS\r\n    }));\r\n  }\r\n\r\n  private parseResources(resourcesNode: any): ManifestResource[] {\r\n    if (!resourcesNode?.resource) return [];\r\n\r\n    const resources = Array.isArray(resourcesNode.resource) ? resourcesNode.resource : [resourcesNode.resource];\r\n    \r\n    return resources.map((resource: any) => ({\r\n      identifier: resource['@identifier'] || '',\r\n      type: resource['@type'] || 'webcontent',\r\n      href: resource['@href'] || resource['@xml:base'] || '',\r\n      scormType: resource['@scormtype'] || resource['@adlcp:scormType'],\r\n      adlcpScormType: resource['@adlcp:scormType'],\r\n      metadata: resource.metadata\r\n    }));\r\n  }\r\n\r\n  private extractScos(\r\n    organizations: ManifestOrganization[], \r\n    resources: ManifestResource[], \r\n    standard: 'SCORM 1.2' | 'SCORM 2004'\r\n  ): ParsedManifest['scos'] {\r\n    const scos: ParsedManifest['scos'] = [];\r\n    let seqOrder = 1;\r\n\r\n    const processItems = (items: ManifestItem[], orgId: string) => {\r\n      items.forEach((item) => {\r\n        if (item.identifierref) {\r\n          const resource = resources.find(r => r.identifier === item.identifierref);\r\n          if (resource) {\r\n            const isLaunchable = this.isLaunchableResource(resource, standard);\r\n            \r\n            scos.push({\r\n              id: `${orgId}_${item.identifier}`,\r\n              identifier: item.identifier,\r\n              title: item.title,\r\n              launch_href: resource.href,\r\n              parameters: item.parameters,\r\n              mastery_score: item.masteryScore,\r\n              prerequisites: item.prerequisites || [],\r\n              seq_order: seqOrder++,\r\n              resourceType: resource.type,\r\n              scormType: resource.scormType || resource.adlcpScormType,\r\n              isLaunchable,\r\n              sequencing: item.sequencing\r\n            });\r\n          }\r\n        }\r\n        \r\n        // Process child items recursively\r\n        if (item.children && item.children.length > 0) {\r\n          processItems(item.children, orgId);\r\n        }\r\n      });\r\n    };\r\n\r\n    organizations.forEach(org => {\r\n      processItems(org.items, org.identifier);\r\n    });\r\n\r\n    return scos;\r\n  }\r\n\r\n  private isLaunchableResource(resource: ManifestResource, standard: 'SCORM 1.2' | 'SCORM 2004'): boolean {\r\n    if (standard === 'SCORM 1.2') {\r\n      return resource.scormType === 'sco' || resource.type === 'webcontent';\r\n    } else {\r\n      return resource.adlcpScormType === 'sco' || resource.scormType === 'sco';\r\n    }\r\n  }\r\n\r\n  private validateManifest(manifest: any): { isValid: boolean; errors: string[]; warnings: string[] } {\r\n    const errors: string[] = [];\r\n    const warnings: string[] = [];\r\n\r\n    // Basic structure validation\r\n    if (!manifest['@identifier']) {\r\n      errors.push('Manifest missing required identifier attribute');\r\n    }\r\n\r\n    if (!manifest.organizations) {\r\n      errors.push('Manifest missing organizations element');\r\n    }\r\n\r\n    if (!manifest.resources) {\r\n      errors.push('Manifest missing resources element');\r\n    }\r\n\r\n    // Organizations validation\r\n    if (manifest.organizations && !manifest.organizations.organization) {\r\n      errors.push('Organizations element contains no organization');\r\n    }\r\n\r\n    // Resources validation\r\n    if (manifest.resources && !manifest.resources.resource) {\r\n      warnings.push('Resources element contains no resource');\r\n    }\r\n\r\n    // Check for broken references\r\n    if (manifest.organizations?.organization) {\r\n      const orgs = Array.isArray(manifest.organizations.organization) ? \r\n        manifest.organizations.organization : [manifest.organizations.organization];\r\n      \r\n      const resources = manifest.resources?.resource || [];\r\n      const resourceIds = Array.isArray(resources) ? \r\n        resources.map((r: any) => r['@identifier']) : [resources['@identifier']];\r\n\r\n      const checkItemRefs = (items: any[]) => {\r\n        if (!items) return;\r\n        const itemArray = Array.isArray(items) ? items : [items];\r\n        \r\n        itemArray.forEach((item: any) => {\r\n          if (item['@identifierref'] && !resourceIds.includes(item['@identifierref'])) {\r\n            errors.push(`Item '${item['@identifier']}' references unknown resource '${item['@identifierref']}'`);\r\n          }\r\n          \r\n          if (item.item) {\r\n            checkItemRefs(item.item);\r\n          }\r\n        });\r\n      };\r\n\r\n      orgs.forEach((org: any) => {\r\n        if (org.item) {\r\n          checkItemRefs(org.item);\r\n        }\r\n      });\r\n    }\r\n\r\n    return {\r\n      isValid: errors.length === 0,\r\n      errors,\r\n      warnings\r\n    };\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const manifestParser = new ScormManifestParser();\r\n\r\n// Convenience function\r\nexport function parseScormManifest(xmlContent: string): ParsedManifest {\r\n  return manifestParser.parseManifest(xmlContent);\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\player\\AdvancedScormPlayer.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1893,1896],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1893,1896],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":154,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6575,6578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6575,6578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":203,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8307,8310],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8307,8310],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-self-assign","severity":2,"message":"'iframeRef.current.src' is assigned to itself.","line":238,"column":31,"nodeType":"MemberExpression","messageId":"selfAssignment","endLine":238,"endColumn":52}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { \r\n  Play, Pause, RotateCcw, X, ChevronLeft, ChevronRight, Clock, \r\n  CheckCircle, AlertCircle, Settings, Terminal, Menu, MenuIcon, Loader2\r\n} from 'lucide-react';\r\nimport { useScormPackage, useScormScos } from '@/hooks/useScormPackages';\r\nimport { Scorm12Adapter, Scorm2004Adapter, ScormAPIAdapter, DebugEventType } from '@/lib/scorm/ScormAPIAdapter';\r\nimport { ContentTypeIssueBanner, RuntimeIssueBanner } from '@/components/scorm/ErrorBanners';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { buildGenerateUrl } from '@/lib/scorm/urls';\r\nimport { useScormLaunchUrl } from '@/lib/scorm/useScormLaunchUrl';\r\nimport ScormIframe from '@/components/scorm/ScormIframe';\r\n\r\ninterface AdvancedScormPlayerProps {\r\n  mode?: 'preview' | 'launch';\r\n}\r\n\r\nexport const AdvancedScormPlayer: React.FC<AdvancedScormPlayerProps> = ({ mode = 'preview' }) => {\r\n  console.log('ðŸš€ AdvancedScormPlayer component initializing, mode:', mode);\r\n  const { packageId, scoId, enrollmentId: urlEnrollmentId } = useParams();\r\n  console.log('ðŸ“Š URL params:', { packageId, scoId, enrollmentId: urlEnrollmentId });\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const iframeRef = useRef<HTMLIFrameElement>(null);\r\n  const scormAdapterRef = useRef<ScormAPIAdapter | null>(null);\r\n  \r\n  // State management\r\n  const [currentScoIndex, setCurrentScoIndex] = useState(0);\r\n  const [urlProcessed, setUrlProcessed] = useState(false);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [sessionData, setSessionData] = useState<any>({});\r\n  const [showDebugConsole, setShowDebugConsole] = useState(false);\r\n  const [debugLogs, setDebugLogs] = useState<string[]>([]);\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  const [contentTypeWarning, setContentTypeWarning] = useState<string | null>(null);\r\n  const [runtimeError, setRuntimeError] = useState<string | null>(null);\r\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n  const [isLoadingContent, setIsLoadingContent] = useState(false);\r\n\r\n  // Data fetching\r\n  const { package: scormPackage, isLoading: packageLoading } = useScormPackage(packageId || '');\r\n  const { scos, isLoading: scosLoading } = useScormScos(packageId || '');\r\n  \r\n  console.log('ðŸ“¦ Package loading status:', { packageLoading, scormPackage: !!scormPackage });\r\n  console.log('ðŸ“‹ SCOs loading status:', { scosLoading, scosCount: scos.length });\r\n\r\n  // Current SCO - safe access with fallback\r\n  const currentSco = scos?.[currentScoIndex];\r\n  const isScorm2004 = scormPackage?.metadata?.manifest?.standard === 'SCORM 2004';\r\n  const effectiveEnrollmentId = urlEnrollmentId || (mode === 'launch' ? 'preview' : undefined);\r\n  \r\n  // Launch URL generation using smart path resolution\r\n  const launchUrl = useScormLaunchUrl(packageId || '', currentSco);\r\n\r\n  const handleDebugEvent = useCallback((type: DebugEventType, message: string) => {\r\n    const timestamp = new Date().toLocaleTimeString();\r\n    const icon = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';\r\n    setDebugLogs(prev => [...prev.slice(-49), `[${timestamp}] ${icon} ${message}`]);\r\n  }, []);\r\n\r\n  const addDebugLog = useCallback((message: string) => {\r\n    handleDebugEvent('info', message);\r\n  }, [handleDebugEvent]);\r\n\r\n  // URL processing and SCO selection\r\n  useEffect(() => {\r\n    if (!scos.length || urlProcessed) return;\r\n    \r\n    try {\r\n      console.log('ðŸ”„ Processing URL parameters:', { scoId, packageId, scosLength: scos.length });\r\n      \r\n      if (scoId) {\r\n        // Find SCO by ID if provided in URL\r\n        const scoIndex = scos.findIndex(sco => sco.id === scoId);\r\n        if (scoIndex !== -1) {\r\n          setCurrentScoIndex(scoIndex);\r\n          console.log('âœ… Selected SCO from URL:', scos[scoIndex].title);\r\n          addDebugLog(`Selected SCO from URL: ${scos[scoIndex].title}`);\r\n        } else {\r\n          console.warn('âš ï¸ SCO ID not found, using first SCO');\r\n          addDebugLog(`SCO ID not found, using first SCO`);\r\n          setCurrentScoIndex(0);\r\n          // Redirect to first SCO\r\n          if (packageId && scos[0]) {\r\n            navigate(`/scorm/preview/${packageId}/${scos[0].id}`, { replace: true });\r\n          }\r\n        }\r\n      } else if (scos.length > 0) {\r\n        // No SCO ID provided, redirect to first SCO\r\n        setCurrentScoIndex(0);\r\n        console.log('ðŸ”„ No SCO ID provided, redirecting to first SCO:', scos[0].title);\r\n        addDebugLog(`No SCO ID provided, redirecting to first SCO: ${scos[0].title}`);\r\n        if (packageId) {\r\n          navigate(`/scorm/preview/${packageId}/${scos[0].id}`, { replace: true });\r\n        }\r\n      }\r\n      setUrlProcessed(true);\r\n    } catch (error) {\r\n      console.error('âŒ URL processing error:', error);\r\n      addDebugLog(`URL processing error: ${error}`);\r\n      setCurrentScoIndex(0);\r\n      setUrlProcessed(true);\r\n    }\r\n  }, [scos, scoId, packageId, navigate, urlProcessed, addDebugLog]);\r\n\r\n  // Initialize SCORM API adapter\r\n  useEffect(() => {\r\n    if (!currentSco || !packageId || !urlProcessed) {\r\n      console.log('ðŸ”„ Skipping API initialization:', { \r\n        hasCurrentSco: !!currentSco,\r\n        hasPackageId: !!packageId,\r\n        urlProcessed \r\n      });\r\n      return;\r\n    }\r\n\r\n    // Cleanup previous adapter\r\n    if (scormAdapterRef.current) {\r\n      scormAdapterRef.current.cleanup();\r\n    }\r\n\r\n    try {\r\n      const enrollmentIdToUse = effectiveEnrollmentId || 'preview';\r\n      console.log('ðŸŽ¯ Initializing SCORM API:', { \r\n        scoTitle: currentSco.title,\r\n        enrollmentId: enrollmentIdToUse,\r\n        isScorm2004 \r\n      });\r\n      \r\n      // Create appropriate adapter based on SCORM version\r\n      if (isScorm2004) {\r\n        scormAdapterRef.current = new Scorm2004Adapter(\r\n          enrollmentIdToUse,\r\n          currentSco.id,\r\n          handleDebugEvent\r\n        );\r\n      } else {\r\n        scormAdapterRef.current = new Scorm12Adapter(\r\n          enrollmentIdToUse,\r\n          currentSco.id,\r\n          handleDebugEvent\r\n        );\r\n      }\r\n\r\n      // Initialize the API\r\n      scormAdapterRef.current.initialize();\r\n      setIsInitialized(true);\r\n      setRuntimeError(null);\r\n    } catch (error: any) {\r\n      handleDebugEvent('error', `SCORM API initialization failed: ${error.message}`);\r\n      setRuntimeError(`API initialization failed: ${error.message}`);\r\n      setIsInitialized(false);\r\n    }\r\n\r\n    // Cleanup on unmount or SCO change\r\n    return () => {\r\n      if (scormAdapterRef.current) {\r\n        scormAdapterRef.current.cleanup();\r\n      }\r\n    };\r\n  }, [currentSco, packageId, effectiveEnrollmentId, isScorm2004, handleDebugEvent, urlProcessed]);\r\n\r\n  const generateContent = async () => {\r\n    setIsLoadingContent(true);\r\n    \r\n    try {\r\n      handleDebugEvent('info', 'Starting content generation...');\r\n      \r\n      const response = await fetch(buildGenerateUrl(), {\r\n        method: 'POST',\r\n        headers: { \r\n          'Content-Type': 'application/json', \r\n          'Authorization': `Bearer ${(await supabase.auth.getSession()).data.session?.access_token || ''}` \r\n        },\r\n        body: JSON.stringify({ packageId })\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (response.ok && (data?.success || data?.ok)) {\r\n        toast({\r\n          title: \"Content Generated\",\r\n          description: \"âœ… SCORM content generated successfully!\",\r\n        });\r\n        handleDebugEvent('success', 'Content generation completed successfully');\r\n        \r\n        // Force iframe reload with the new content\r\n        if (iframeRef.current && launchUrl) {\r\n          setIsLoadingContent(false);\r\n          iframeRef.current.src = `${launchUrl}&refresh=${Date.now()}`;\r\n        }\r\n        \r\n        // Clear any content type warnings\r\n        setContentTypeWarning(null);\r\n      } else {\r\n        throw new Error(data?.error || 'Content generation failed');\r\n      }\r\n    } catch (error: any) {\r\n      handleDebugEvent('error', `Content generation failed: ${error.message}`);\r\n      toast({\r\n        title: \"Generation Failed\",\r\n        description: `âŒ Content generation failed: ${error.message}`,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsLoadingContent(false);\r\n    }\r\n  };\r\n\r\n  // Handle iframe loading - removed content validation fetch\r\n  const handleIframeLoad = useCallback(() => {\r\n    if (!currentSco || !launchUrl) return;\r\n    \r\n    handleDebugEvent('success', `SCORM iframe loaded: ${currentSco.title}`);\r\n    handleDebugEvent('info', `Launch URL: ${launchUrl}`);\r\n    setContentTypeWarning(null);\r\n  }, [currentSco, launchUrl, handleDebugEvent]);\r\n\r\n  const handleScoNavigation = (index: number) => {\r\n    if (index >= 0 && index < scos.length) {\r\n      const targetSco = scos[index];\r\n      console.log('ðŸ§­ Navigating to SCO:', { index, title: targetSco.title });\r\n      navigate(`/scorm/preview/${packageId}/${targetSco.id}`, { replace: true });\r\n      setIsInitialized(false);\r\n      setSidebarCollapsed(true); // Close sidebar on mobile\r\n    }\r\n  };\r\n\r\n  const handleRestart = () => {\r\n    setSessionData({});\r\n    setIsInitialized(false);\r\n    if (iframeRef.current) {\r\n      iframeRef.current.src = iframeRef.current.src;\r\n    }\r\n    addDebugLog('SCO restarted');\r\n  };\r\n\r\n  const handleExit = () => {\r\n    addDebugLog('Exiting player');\r\n    if (mode === 'preview') {\r\n      navigate('/dashboard/scorm/packages');\r\n    } else {\r\n      navigate('/dashboard');\r\n    }\r\n  };\r\n\r\n  if (packageLoading || scosLoading || !urlProcessed) {\r\n    console.log('â³ SCORM Player waiting for data:', { packageLoading, scosLoading, packageId, urlProcessed });\r\n    return (\r\n      <div className=\"flex items-center justify-center h-screen bg-background\">\r\n        <div className=\"text-center space-y-4\">\r\n          <div className=\"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto\"></div>\r\n          <p className=\"text-sm text-muted-foreground\">Loading SCORM package...</p>\r\n          {!urlProcessed && <p className=\"text-xs text-muted-foreground\">Processing URL parameters...</p>}\r\n          <p className=\"text-xs text-muted-foreground\">Package ID: {packageId}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!scormPackage || !scos.length || !currentSco) {\r\n    console.log('âŒ SCORM Player data missing:', { \r\n      scormPackage: !!scormPackage, \r\n      scosLength: scos.length, \r\n      currentSco: !!currentSco,\r\n      packageId \r\n    });\r\n    return (\r\n      <div className=\"flex items-center justify-center h-screen bg-background\">\r\n        <div className=\"text-center space-y-4\">\r\n          <p className=\"text-lg font-semibold\">\r\n            {!scormPackage ? 'SCORM package not found' : \r\n             !scos.length ? 'No learning content available' : \r\n             'Invalid content selection'}\r\n          </p>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            {!scormPackage ? `Package ID: ${packageId}` :\r\n             !scos.length ? 'This package contains no SCOs' :\r\n             'The selected SCO is not available'}\r\n          </p>\r\n          <Button onClick={handleExit}>Back to Packages</Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  console.log('âœ… SCORM Player rendering with data:', { \r\n    packageTitle: scormPackage.title, \r\n    scosCount: scos.length,\r\n    currentScoIndex,\r\n    launchUrl: !!launchUrl\r\n  });\r\n\r\n  return (\r\n    <div className=\"h-screen flex flex-col bg-background\">\r\n      {/* Header */}\r\n      <div className=\"border-b bg-card p-2 sm:p-4\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-2 sm:gap-4\">\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={handleExit}>\r\n              <X className=\"h-4 w-4\" />\r\n            </Button>\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"sm\" \r\n              className=\"md:hidden\"\r\n              onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n            >\r\n              <MenuIcon className=\"h-4 w-4\" />\r\n            </Button>\r\n            <div className=\"min-w-0 flex-1\">\r\n              <h1 className=\"font-semibold text-sm sm:text-base truncate\">{scormPackage.title}</h1>\r\n              <p className=\"text-xs sm:text-sm text-muted-foreground hidden sm:block\">\r\n                {mode === 'preview' ? 'Preview Mode' : 'Learning Mode'} â€¢{' '}\r\n                SCO {currentScoIndex + 1} of {scos.length} â€¢{' '}\r\n                {isScorm2004 ? 'SCORM 2004' : 'SCORM 1.2'}\r\n              </p>\r\n              <p className=\"text-xs text-muted-foreground sm:hidden\">\r\n                SCO {currentScoIndex + 1}/{scos.length}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-2\">\r\n            <Badge variant={isInitialized ? \"default\" : \"secondary\"} className=\"hidden sm:inline-flex\">\r\n              {isInitialized ? 'API Ready' : 'Initializing...'}\r\n            </Badge>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setShowDebugConsole(!showDebugConsole)}\r\n              className=\"hidden sm:inline-flex\"\r\n            >\r\n              <Terminal className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1 flex relative\">\r\n        {/* TOC Sidebar */}\r\n        <div className={`${sidebarCollapsed ? 'hidden' : 'block'} w-64 md:w-64 border-r bg-card p-2 sm:p-4 ${sidebarCollapsed ? '' : 'absolute md:relative z-10 h-full md:h-auto'} md:block`}>\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"font-semibold text-sm sm:text-base\">Course Contents</h3>\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"sm\"\r\n              className=\"md:hidden\"\r\n              onClick={() => setSidebarCollapsed(true)}\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            {scos.map((sco, index) => (\r\n              <div \r\n                key={sco.id}\r\n                className={`p-2 sm:p-3 rounded-lg cursor-pointer transition-colors ${\r\n                  index === currentScoIndex \r\n                    ? 'bg-primary text-primary-foreground' \r\n                    : 'hover:bg-accent'\r\n                }`}\r\n                onClick={() => {\r\n                  handleScoNavigation(index);\r\n                  setSidebarCollapsed(true); // Close sidebar on mobile after selection\r\n                }}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-xs sm:text-sm font-medium truncate\">{sco.title}</span>\r\n                  {sco.is_launchable && (\r\n                    <CheckCircle className=\"h-3 w-3 sm:h-4 sm:w-4 text-green-600 flex-shrink-0 ml-2\" />\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content Area */}\r\n        <div className=\"flex-1 flex flex-col\">\r\n          {/* Error Banners */}\r\n          <div className=\"p-4 pb-0\">\r\n            {contentTypeWarning && (\r\n              <ContentTypeIssueBanner\r\n                error={contentTypeWarning}\r\n                onGenerate={generateContent}\r\n                onDismiss={() => setContentTypeWarning(null)}\r\n              />\r\n            )}\r\n            \r\n            {runtimeError && (\r\n              <RuntimeIssueBanner\r\n                error={runtimeError}\r\n                diagnostics={debugLogs.slice(-5)}\r\n                onDismiss={() => setRuntimeError(null)}\r\n              />\r\n            )}\r\n          </div>\r\n          \r\n          {/* Content Frame */}\r\n          <div className=\"flex-1 p-4\">\r\n            <Card className=\"h-full\">\r\n              <CardContent className=\"p-0 h-full relative\">\r\n                {/* Loading Overlay */}\r\n                {isLoadingContent && (\r\n                  <div className=\"absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-10\">\r\n                    <div className=\"text-center\">\r\n                      <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-2\" />\r\n                      <p className=\"text-sm text-muted-foreground\">Generating SCORM content...</p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                {launchUrl ? (\r\n                  <ScormIframe\r\n                    launchUrl={launchUrl}\r\n                    onLoaded={() => {\r\n                      console.log(\"SCORM iframe loaded\", launchUrl);\r\n                      handleIframeLoad();\r\n                    }}\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center justify-center h-full bg-muted/50\">\r\n                    <div className=\"text-center\">\r\n                      <AlertCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                      <p className=\"text-lg font-medium text-muted-foreground mb-2\">No Launch URL</p>\r\n                      <p className=\"text-sm text-muted-foreground\">Unable to generate launch URL for this SCO</p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Debug Console */}\r\n          {showDebugConsole && (\r\n            <div className=\"border-t p-4 bg-card max-h-48 overflow-auto\">\r\n              <h4 className=\"font-semibold mb-2\">SCORM Debug Console</h4>\r\n              <div className=\"text-xs font-mono space-y-1\">\r\n                {debugLogs.map((log, index) => (\r\n                  <div key={index} className=\"text-muted-foreground\">{log}</div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Controls */}\r\n          <div className=\"border-t p-2 sm:p-4\">\r\n            <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2\">\r\n              <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\"\r\n                  disabled={currentScoIndex === 0}\r\n                  onClick={() => handleScoNavigation(currentScoIndex - 1)}\r\n                  className=\"flex-1 sm:flex-none\"\r\n                >\r\n                  <ChevronLeft className=\"h-4 w-4 sm:mr-1\" />\r\n                  <span className=\"hidden sm:inline\">Previous</span>\r\n                </Button>\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\"\r\n                  disabled={currentScoIndex === scos.length - 1}\r\n                  onClick={() => handleScoNavigation(currentScoIndex + 1)}\r\n                  className=\"flex-1 sm:flex-none\"\r\n                >\r\n                  <span className=\"hidden sm:inline\">Next</span>\r\n                  <ChevronRight className=\"h-4 w-4 sm:ml-1\" />\r\n                </Button>\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-1 sm:gap-2 overflow-x-auto\">\r\n                <Button variant=\"outline\" size=\"sm\" onClick={handleRestart} className=\"whitespace-nowrap\">\r\n                  <RotateCcw className=\"h-4 w-4 sm:mr-1\" />\r\n                  <span className=\"hidden sm:inline\">Restart</span>\r\n                </Button>\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\" \r\n                  onClick={() => {\r\n                    // Force refresh by reloading the iframe with current launch URL\r\n                    if (iframeRef.current && launchUrl) {\r\n                      iframeRef.current.src = `${launchUrl}&refresh=${Date.now()}`;\r\n                      addDebugLog('ðŸ”„ Manual iframe refresh triggered');\r\n                    }\r\n                  }}\r\n                  className=\"whitespace-nowrap\"\r\n                >\r\n                  ðŸ”„ <span className=\"hidden sm:inline\">Refresh</span>\r\n                </Button>\r\n                <Button variant=\"outline\" size=\"sm\" onClick={handleExit} className=\"whitespace-nowrap\">\r\n                  <span className=\"hidden sm:inline\">Exit Course</span>\r\n                  <span className=\"sm:hidden\">Exit</span>\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\player\\ScormDebugConsole.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[530,533],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[530,533],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[554,557],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[554,557],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Trash2, Terminal, Activity, Clock } from 'lucide-react';\r\n\r\nexport interface ScormDebugConsoleProps {\r\n  debugLogs: Array<{\r\n    timestamp: string;\r\n    level: 'info' | 'warn' | 'error' | 'debug';\r\n    category: string;\r\n    message: string;\r\n    data?: any;\r\n  }>;\r\n  cmiData: any;\r\n  apiCallCount: number;\r\n  sessionDuration: number;\r\n  onClearLogs: () => void;\r\n}\r\n\r\nexport const ScormDebugConsole: React.FC<ScormDebugConsoleProps> = ({\r\n  debugLogs,\r\n  cmiData,\r\n  apiCallCount,\r\n  sessionDuration,\r\n  onClearLogs\r\n}) => {\r\n  const formatTime = (seconds: number): string => {\r\n    const hours = Math.floor(seconds / 3600);\r\n    const minutes = Math.floor((seconds % 3600) / 60);\r\n    const secs = seconds % 60;\r\n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  const getLevelColor = (level: string) => {\r\n    switch (level) {\r\n      case 'error': return 'text-red-600 bg-red-50';\r\n      case 'warn': return 'text-yellow-600 bg-yellow-50';\r\n      case 'info': return 'text-blue-600 bg-blue-50';\r\n      case 'debug': return 'text-gray-600 bg-gray-50';\r\n      default: return 'text-gray-600 bg-gray-50';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"border-t bg-card\">\r\n      <div className=\"p-4\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Terminal className=\"h-4 w-4\" />\r\n            <h3 className=\"font-semibold\">Debug Console</h3>\r\n          </div>\r\n          <div className=\"flex items-center gap-4 text-sm\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Activity className=\"h-3 w-3\" />\r\n              <span>API Calls: {apiCallCount}</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Clock className=\"h-3 w-3\" />\r\n              <span>Session: {formatTime(sessionDuration)}</span>\r\n            </div>\r\n            <Button variant=\"outline\" size=\"sm\" onClick={onClearLogs}>\r\n              <Trash2 className=\"h-3 w-3 mr-1\" />\r\n              Clear\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n          {/* Debug Logs */}\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm\">Debug Logs</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"p-0\">\r\n              <ScrollArea className=\"h-64\">\r\n                <div className=\"p-4 space-y-2\">\r\n                  {debugLogs.length === 0 ? (\r\n                    <p className=\"text-sm text-muted-foreground\">No logs yet...</p>\r\n                  ) : (\r\n                    debugLogs.slice(-50).map((log, index) => (\r\n                      <div key={index} className=\"text-xs border-l-2 border-border pl-2\">\r\n                        <div className=\"flex items-center gap-2 mb-1\">\r\n                          <Badge variant=\"secondary\" className={`text-xs ${getLevelColor(log.level)}`}>\r\n                            {log.level.toUpperCase()}\r\n                          </Badge>\r\n                          <span className=\"text-muted-foreground\">\r\n                            {log.category}\r\n                          </span>\r\n                          <span className=\"text-muted-foreground ml-auto\">\r\n                            {new Date(log.timestamp).toLocaleTimeString()}\r\n                          </span>\r\n                        </div>\r\n                        <p className=\"text-foreground\">{log.message}</p>\r\n                        {log.data && (\r\n                          <pre className=\"text-xs text-muted-foreground mt-1 bg-muted p-1 rounded\">\r\n                            {JSON.stringify(log.data, null, 2)}\r\n                          </pre>\r\n                        )}\r\n                      </div>\r\n                    ))\r\n                  )}\r\n                </div>\r\n              </ScrollArea>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* CMI Data */}\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-sm\">CMI Data</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"p-0\">\r\n              <ScrollArea className=\"h-64\">\r\n                <div className=\"p-4\">\r\n                  {Object.keys(cmiData).length === 0 ? (\r\n                    <p className=\"text-sm text-muted-foreground\">No CMI data available...</p>\r\n                  ) : (\r\n                    <pre className=\"text-xs bg-muted p-2 rounded overflow-x-auto\">\r\n                      {JSON.stringify(cmiData, null, 2)}\r\n                    </pre>\r\n                  )}\r\n                </div>\r\n              </ScrollArea>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\player\\ScormPlayerPro.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1899,1902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1899,1902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2210,2213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2210,2213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3822,3825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3822,3825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":162,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":162,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6509,6512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6509,6512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":212,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":212,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8219,8222],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8219,8222],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'currentSco'. Either include it or remove the dependency array.","line":220,"column":6,"nodeType":"ArrayExpression","endLine":220,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [addDebugLog, currentSco, effectiveEnrollmentId, toast]","fix":{"range":[8444,8503],"text":"[addDebugLog, currentSco, effectiveEnrollmentId, toast]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":222,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8560,8563],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8560,8563],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":256,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":256,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9524,9527],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9524,9527],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'currentSco'. Either include it or remove the dependency array.","line":259,"column":6,"nodeType":"ArrayExpression","endLine":259,"endColumn":85,"suggestions":[{"desc":"Update the dependencies array to be: [addDebugLog, handleCommit, currentSco, effectiveEnrollmentId, mode, toast]","fix":{"range":[9626,9705],"text":"[addDebugLog, handleCommit, currentSco, effectiveEnrollmentId, mode, toast]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":294,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10981,10984],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10981,10984],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":319,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":319,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11956,11959],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11956,11959],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":355,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":355,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13162,13165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13162,13165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-self-assign","severity":2,"message":"'iframeRef.current.src' is assigned to itself.","line":399,"column":31,"nodeType":"MemberExpression","messageId":"selfAssignment","endLine":399,"endColumn":52},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":425,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":425,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15439,15442],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15439,15442],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useCallback, useMemo } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { \r\n  Play, Pause, RotateCcw, X, ChevronLeft, ChevronRight, Clock, \r\n  CheckCircle, AlertCircle, Settings, Terminal, Menu, Maximize,\r\n  Volume2, VolumeX, BookOpen, Target, Award, Timer\r\n} from 'lucide-react';\r\nimport { createScorm12API } from '@/scorm/runtime/scorm12';\r\nimport { createScorm2004API } from '@/scorm/runtime/scorm2004';\r\nimport { useScormPackage, useScormScos } from '@/hooks/useScormPackages';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { ScormDebugConsole } from '@/scorm/player/ScormDebugConsole';\r\nimport { functionsBase } from '@/lib/scorm/urls';\r\nimport { buildLaunchUrl } from '@/lib/scorm/buildLaunchUrl';\r\nimport ScormIframe from '@/components/scorm/ScormIframe';\r\nimport { useCleanup } from '@/utils/cleanupManager';\r\n\r\ninterface ScormPlayerProProps {\r\n  mode?: 'preview' | 'launch' | 'review';\r\n  enrollmentId?: string;\r\n}\r\n\r\nexport const ScormPlayerPro: React.FC<ScormPlayerProProps> = ({ \r\n  mode = 'preview',\r\n  enrollmentId \r\n}) => {\r\n  const cleanup = useCleanup('ScormPlayerPro');\r\n  const { packageId, scoId, enrollmentId: urlEnrollmentId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const iframeRef = useRef<HTMLIFrameElement>(null);\r\n  const sessionStartTime = useRef<number>(Date.now());\r\n  \r\n  // State management\r\n  const [currentScoIndex, setCurrentScoIndex] = useState(0);\r\n  const [urlProcessed, setUrlProcessed] = useState(false);\r\n  const [sessionData, setSessionData] = useState<any>({});\r\n  const [showDebugConsole, setShowDebugConsole] = useState(false);\r\n  const [showTOC, setShowTOC] = useState(true);\r\n  const [debugLogs, setDebugLogs] = useState<Array<{\r\n    timestamp: string;\r\n    level: 'info' | 'warn' | 'error' | 'debug';\r\n    category: string;\r\n    message: string;\r\n    data?: any;\r\n  }>>([]);\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  const [isFullscreen, setIsFullscreen] = useState(false);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [sessionTime, setSessionTime] = useState(0);\r\n  const [currentScore, setCurrentScore] = useState<number | null>(null);\r\n  const [completionStatus, setCompletionStatus] = useState<string>('not attempted');\r\n  const [apiCallCount, setApiCallCount] = useState(0);\r\n\r\n  // Data fetching\r\n  const { package: scormPackage, isLoading: packageLoading } = useScormPackage(packageId || '');\r\n  const { scos, isLoading: scosLoading } = useScormScos(packageId || '');\r\n  const currentSco = scos?.[currentScoIndex];\r\n  \r\n  // Use enrollmentId from URL if in launch mode, otherwise use prop\r\n  const effectiveEnrollmentId = urlEnrollmentId || enrollmentId;\r\n\r\n  // Determine SCORM standard\r\n  const isScorm2004 = scormPackage?.scorm_version === '2004' || scormPackage?.standard === 'SCORM 2004';\r\n  const scormVersion = isScorm2004 ? 'SCORM 2004' : 'SCORM 1.2';\r\n\r\n  // Progress calculation\r\n  const progressPercentage = useMemo(() => {\r\n    if (!scos.length) return 0;\r\n    const completedScos = scos.filter(sco => {\r\n      const status = sessionData[sco.id]?.status || 'not attempted';\r\n      return status === 'completed' || status === 'passed';\r\n    });\r\n    return Math.round((completedScos.length / scos.length) * 100);\r\n  }, [scos, sessionData]);\r\n\r\n  // Enhanced debug logging\r\n  const addDebugLog = useCallback((\r\n    level: 'info' | 'warn' | 'error' | 'debug',\r\n    category: string,\r\n    message: string,\r\n    data?: any\r\n  ) => {\r\n    const logEntry = {\r\n      timestamp: new Date().toISOString(),\r\n      level,\r\n      category,\r\n      message,\r\n      data\r\n    };\r\n    \r\n    setDebugLogs(prev => [...prev.slice(-99), logEntry]);\r\n    \r\n    // Log to browser console as well\r\n    console.log(`[SCORM ${level.toUpperCase()}] ${category}: ${message}`, data || '');\r\n  }, []);\r\n\r\n  // URL processing and SCO selection\r\n  useEffect(() => {\r\n    if (!scos.length || urlProcessed) return;\r\n    \r\n    try {\r\n      if (scoId) {\r\n        // Find SCO by ID if provided in URL\r\n        const scoIndex = scos.findIndex(sco => sco.id === scoId);\r\n        if (scoIndex !== -1) {\r\n          setCurrentScoIndex(scoIndex);\r\n          addDebugLog('info', 'navigation', `Selected SCO from URL: ${scos[scoIndex].title}`, { scoId, scoIndex });\r\n        } else {\r\n          addDebugLog('warn', 'navigation', `SCO ID not found, using first SCO`, { scoId });\r\n          setCurrentScoIndex(0);\r\n          // Redirect to first SCO\r\n          if (packageId && scos[0]) {\r\n            navigate(`/scorm/preview/${packageId}/${scos[0].id}`, { replace: true });\r\n          }\r\n        }\r\n      } else if (scos.length > 0) {\r\n        // No SCO ID provided, redirect to first SCO\r\n        setCurrentScoIndex(0);\r\n        addDebugLog('info', 'navigation', `No SCO ID provided, redirecting to first SCO: ${scos[0].title}`);\r\n        if (packageId) {\r\n          navigate(`/scorm/preview/${packageId}/${scos[0].id}`, { replace: true });\r\n        }\r\n      }\r\n      setUrlProcessed(true);\r\n    } catch (error) {\r\n      addDebugLog('error', 'navigation', 'URL processing error', error);\r\n      setCurrentScoIndex(0);\r\n      setUrlProcessed(true);\r\n    }\r\n  }, [scos, scoId, packageId, navigate, urlProcessed, addDebugLog]);\r\n\r\n  // Session timer\r\n  useEffect(() => {\r\n    const timerId = cleanup.setInterval(() => {\r\n      setSessionTime(Math.floor((Date.now() - sessionStartTime.current) / 1000));\r\n    }, 1000);\r\n    return () => {\r\n      cleanup.cleanup(timerId);\r\n    };\r\n  }, [cleanup]);\r\n\r\n  // Format session time\r\n  const formatTime = (seconds: number): string => {\r\n    const hours = Math.floor(seconds / 3600);\r\n    const minutes = Math.floor((seconds % 3600) / 60);\r\n    const secs = seconds % 60;\r\n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  // Launch URL generation using buildLaunchUrl  \r\n  const launchUrl = currentSco && packageId ? \r\n    buildLaunchUrl(functionsBase, packageId, currentSco.launch_href || 'index.html') : \r\n    '';\r\n\r\n  // Enhanced SCORM API handlers with analytics\r\n  const handleCommit = useCallback(async (cmiData: any) => {\r\n    try {\r\n      addDebugLog('info', 'api', 'Committing CMI data...', { elements: Object.keys(cmiData).length });\r\n      \r\n      const startTime = Date.now();\r\n      if (!currentSco) {\r\n        addDebugLog('error', 'api', 'No current SCO available for commit');\r\n        throw new Error('No current SCO available');\r\n      }\r\n\r\n      const { data, error } = await supabase.functions.invoke('scorm-runtime-production', {\r\n        body: { \r\n          action: 'commit',\r\n          enrollmentId: effectiveEnrollmentId || 'preview',\r\n          scoId: currentSco.id,\r\n          cmiData\r\n        }\r\n      });\r\n      \r\n      const duration = Date.now() - startTime;\r\n      setApiCallCount(prev => prev + 1);\r\n      \r\n      if (error) {\r\n        addDebugLog('error', 'api', 'Commit failed', { error, duration });\r\n        throw error;\r\n      }\r\n      \r\n      addDebugLog('info', 'api', `Data committed successfully (${duration}ms)`);\r\n      \r\n      // Update local session data\r\n      if (currentSco) {\r\n        setSessionData(prev => ({\r\n          ...prev,\r\n          [currentSco.id]: {\r\n            ...prev[currentSco.id],\r\n            ...cmiData,\r\n            lastCommit: new Date().toISOString()\r\n          }\r\n        }));\r\n        \r\n        // Update progress indicators\r\n        if (cmiData['cmi.core.score.raw'] || cmiData['cmi.score.raw']) {\r\n          setCurrentScore(parseFloat(cmiData['cmi.core.score.raw'] || cmiData['cmi.score.raw']));\r\n        }\r\n        \r\n        if (cmiData['cmi.core.lesson_status'] || cmiData['cmi.completion_status']) {\r\n          setCompletionStatus(cmiData['cmi.core.lesson_status'] || cmiData['cmi.completion_status']);\r\n        }\r\n      }\r\n      \r\n    } catch (error: any) {\r\n      addDebugLog('error', 'api', `Commit error: ${error.message}`, error);\r\n      toast({\r\n        title: \"Commit Error\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  }, [effectiveEnrollmentId, currentSco?.id, addDebugLog, toast]);\r\n\r\n  const handleFinish = useCallback(async (cmiData: any) => {\r\n    try {\r\n      addDebugLog('info', 'api', 'Terminating SCORM session...');\r\n      \r\n      // Final commit\r\n      await handleCommit(cmiData);\r\n      \r\n      if (!currentSco) {\r\n        addDebugLog('error', 'api', 'No current SCO available for termination');\r\n        return;\r\n      }\r\n\r\n      // Terminate session\r\n      const { error } = await supabase.functions.invoke('scorm-runtime-production', {\r\n        body: { \r\n          action: 'terminate',\r\n          enrollmentId: effectiveEnrollmentId || 'preview',\r\n          scoId: currentSco.id,\r\n          cmiData\r\n        }\r\n      });\r\n      \r\n      if (error) throw error;\r\n      \r\n      addDebugLog('info', 'api', 'Session terminated successfully');\r\n      setIsInitialized(false);\r\n      \r\n      if (mode === 'launch') {\r\n        toast({\r\n          title: \"Session Complete\",\r\n          description: \"Your progress has been saved successfully.\",\r\n        });\r\n      }\r\n      \r\n    } catch (error: any) {\r\n      addDebugLog('error', 'api', `Termination error: ${error.message}`, error);\r\n    }\r\n  }, [handleCommit, mode, toast, effectiveEnrollmentId, currentSco?.id, addDebugLog]);\r\n\r\n  // Enhanced SCORM API initialization with postMessage bridge\r\n  useEffect(() => {\r\n    if (!currentSco || !iframeRef.current?.contentWindow || !urlProcessed) return;\r\n\r\n    const initializeAPI = async () => {\r\n      try {\r\n        addDebugLog('info', 'player', `Initializing ${scormVersion} API for SCO: ${currentSco.title}`);\r\n        \r\n        // Initialize runtime session\r\n        const { data: initData, error } = await supabase.functions.invoke('scorm-runtime-production', {\r\n          body: {\r\n            action: 'initialize',\r\n            enrollmentId: effectiveEnrollmentId || 'preview',\r\n            scoId: currentSco.id\r\n          }\r\n        });\r\n\r\n        if (error) {\r\n          addDebugLog('error', 'player', 'Failed to initialize runtime session', error);\r\n          return;\r\n        }\r\n\r\n        // Create appropriate API based on SCORM version\r\n        const apiHandlers = {\r\n          onCommit: handleCommit,\r\n          [isScorm2004 ? 'onTerminate' : 'onFinish']: handleFinish\r\n        };\r\n\r\n        const api = isScorm2004 \r\n          ? createScorm2004API(initData?.cmiData, apiHandlers)\r\n          : createScorm12API(initData?.cmiData, apiHandlers);\r\n\r\n        // Inject API into iframe\r\n        const iframe = iframeRef.current?.contentWindow as any;\r\n        if (iframe) {\r\n          // Set the appropriate API object\r\n          if (isScorm2004) {\r\n            iframe.API_1484_11 = api;\r\n          } else {\r\n            iframe.API = api;\r\n          }\r\n          \r\n          // Enhanced postMessage bridge for cross-origin scenarios\r\n          const messageHandler = (event: MessageEvent) => {\r\n            if (event.source !== iframe) return;\r\n            \r\n            const { type, method, args, id } = event.data;\r\n            \r\n            if (type === 'scorm-api-call' && method && api[method]) {\r\n              try {\r\n                addDebugLog('debug', 'api', `${method} called via postMessage`, args);\r\n                const result = api[method](...(args || []));\r\n                iframe.postMessage({ \r\n                  type: 'scorm-api-response', \r\n                  id, \r\n                  result \r\n                }, '*');\r\n                setApiCallCount(prev => prev + 1);\r\n              } catch (error: any) {\r\n                addDebugLog('error', 'api', `postMessage API error: ${error.message}`, { method, args });\r\n                iframe.postMessage({ \r\n                  type: 'scorm-api-error', \r\n                  id, \r\n                  error: error.message \r\n                }, '*');\r\n              }\r\n            }\r\n          };\r\n\r\n          window.addEventListener('message', messageHandler);\r\n          \r\n          // Cleanup\r\n          return () => {\r\n            window.removeEventListener('message', messageHandler);\r\n          };\r\n        }\r\n\r\n        addDebugLog('info', 'player', `${scormVersion} API initialized successfully`);\r\n        setIsInitialized(true);\r\n        \r\n        // Load existing runtime data if resuming\r\n        if (initData?.cmiData && Object.keys(initData.cmiData).length > 0) {\r\n          addDebugLog('info', 'player', 'Resuming with existing runtime data', { \r\n            elementCount: Object.keys(initData.cmiData).length \r\n          });\r\n          \r\n          if (currentSco) {\r\n            setSessionData(prev => ({\r\n              ...prev,\r\n              [currentSco.id]: initData.cmiData\r\n            }));\r\n          }\r\n        }\r\n        \r\n      } catch (error: any) {\r\n        addDebugLog('error', 'player', 'API initialization failed', error);\r\n        toast({\r\n          title: \"Initialization Error\",\r\n          description: error.message,\r\n          variant: \"destructive\",\r\n        });\r\n      }\r\n    };\r\n\r\n    // Delay to ensure iframe is fully loaded\r\n    const timer = setTimeout(initializeAPI, 1500);\r\n    return () => clearTimeout(timer);\r\n  }, [currentSco, isScorm2004, scormVersion, handleCommit, handleFinish, effectiveEnrollmentId, addDebugLog, toast, urlProcessed]);\r\n\r\n  // Navigation handlers\r\n  const handleScoNavigation = useCallback((index: number) => {\r\n    if (index >= 0 && index < scos.length && index !== currentScoIndex) {\r\n      const targetSco = scos[index];\r\n      addDebugLog('info', 'navigation', `Navigating to SCO ${index + 1}: ${targetSco.title}`);\r\n      \r\n      // Update URL to reflect navigation\r\n      if (packageId && targetSco) {\r\n        navigate(`/scorm/preview/${packageId}/${targetSco.id}`, { replace: true });\r\n      }\r\n      \r\n      setCurrentScoIndex(index);\r\n      setIsInitialized(false);\r\n      setApiCallCount(0);\r\n    }\r\n  }, [scos, currentScoIndex, addDebugLog, navigate, packageId]);\r\n\r\n  const handleRestart = useCallback(() => {\r\n    addDebugLog('info', 'player', 'Restarting current SCO');\r\n    setSessionData(prev => ({\r\n      ...prev,\r\n      [currentSco?.id || '']: {}\r\n    }));\r\n    setIsInitialized(false);\r\n    setApiCallCount(0);\r\n    setCurrentScore(null);\r\n    setCompletionStatus('not attempted');\r\n    \r\n    if (iframeRef.current) {\r\n      iframeRef.current.src = iframeRef.current.src;\r\n    }\r\n  }, [currentSco?.id, addDebugLog]);\r\n\r\n  const handleExit = useCallback(() => {\r\n    addDebugLog('info', 'player', 'Exiting SCORM player');\r\n    \r\n    if (mode === 'preview') {\r\n      navigate(-1);\r\n    } else {\r\n      navigate('/dashboard/scorm/studio');\r\n    }\r\n  }, [mode, navigate, addDebugLog]);\r\n\r\n  // Fullscreen toggle\r\n  const toggleFullscreen = useCallback(() => {\r\n    if (!document.fullscreenElement) {\r\n      document.documentElement.requestFullscreen();\r\n      setIsFullscreen(true);\r\n    } else {\r\n      document.exitFullscreen();\r\n      setIsFullscreen(false);\r\n    }\r\n  }, []);\r\n\r\n  // Get SCO status icon and color\r\n  const getScoStatus = useCallback((sco: any, index: number) => {\r\n    const status = sessionData[sco.id]?.status || 'not attempted';\r\n    const isCurrent = index === currentScoIndex;\r\n    \r\n    switch (status) {\r\n      case 'completed':\r\n      case 'passed':\r\n        return { icon: CheckCircle, color: 'text-green-600', bgColor: 'bg-green-50' };\r\n      case 'failed':\r\n        return { icon: AlertCircle, color: 'text-red-600', bgColor: 'bg-red-50' };\r\n      case 'incomplete':\r\n        return { icon: Clock, color: 'text-yellow-600', bgColor: 'bg-yellow-50' };\r\n      default:\r\n        return { \r\n          icon: BookOpen, \r\n          color: isCurrent ? 'text-primary' : 'text-gray-400', \r\n          bgColor: isCurrent ? 'bg-primary/10' : 'bg-gray-50' \r\n        };\r\n    }\r\n  }, [sessionData, currentScoIndex]);\r\n\r\n  if (packageLoading || scosLoading || !urlProcessed) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p>Loading SCORM package...</p>\r\n          {!urlProcessed && <p className=\"text-sm text-muted-foreground mt-2\">Processing URL parameters...</p>}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!scormPackage || !scos.length || !currentSco) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-screen\">\r\n        <div className=\"text-center\">\r\n          <AlertCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n          <h2 className=\"text-lg font-semibold mb-2\">\r\n            {!scormPackage ? 'Package Not Found' : \r\n             !scos.length ? 'No SCOs Available' : \r\n             'Invalid SCO Selection'}\r\n          </h2>\r\n          <p className=\"text-muted-foreground mb-4\">\r\n            {!scormPackage ? 'The requested SCORM package could not be loaded.' :\r\n             !scos.length ? 'This SCORM package contains no learning content.' :\r\n             'The selected learning object is not available.'}\r\n          </p>\r\n          <Button onClick={handleExit}>Return to Studio</Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-screen flex flex-col bg-background\">\r\n      {/* Enhanced Header */}\r\n      <div className=\"border-b bg-card shadow-sm\">\r\n        <div className=\"px-4 py-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2 lg:gap-4 flex-1 min-w-0\">\r\n              <Button variant=\"ghost\" size=\"sm\" onClick={handleExit}>\r\n                <X className=\"h-4 w-4\" />\r\n              </Button>\r\n              <div className=\"flex items-center gap-2 flex-1 min-w-0\">\r\n                <Button \r\n                  variant=\"ghost\" \r\n                  size=\"sm\" \r\n                  onClick={() => setShowTOC(!showTOC)}\r\n                  className=\"lg:hidden\"\r\n                >\r\n                  <Menu className=\"h-4 w-4\" />\r\n                </Button>\r\n                <div className=\"min-w-0 flex-1\">\r\n                  <h1 className=\"font-semibold text-sm lg:text-lg truncate\">{scormPackage.title}</h1>\r\n                  <div className=\"flex items-center gap-2 lg:gap-4 text-xs lg:text-sm text-muted-foreground flex-wrap\">\r\n                    <span className=\"hidden sm:inline\">{mode === 'preview' ? 'Preview Mode' : 'Learning Mode'}</span>\r\n                    <span className=\"hidden sm:inline\">â€¢</span>\r\n                    <span>SCO {currentScoIndex + 1}/{scos.length}</span>\r\n                    <span className=\"hidden lg:inline\">â€¢</span>\r\n                    <span className=\"hidden lg:inline\">{scormVersion}</span>\r\n                    <span className=\"hidden md:inline\">â€¢</span>\r\n                    <span className=\"hidden md:flex items-center gap-1\">\r\n                      <Timer className=\"h-3 w-3\" />\r\n                      {formatTime(sessionTime)}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center gap-1 lg:gap-2 flex-shrink-0\">\r\n              {/* Progress and Score Display */}\r\n              <div className=\"hidden lg:flex items-center gap-4 text-sm\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Progress value={progressPercentage} className=\"w-16 lg:w-20\" />\r\n                  <span className=\"text-xs lg:text-sm\">{progressPercentage}%</span>\r\n                </div>\r\n                \r\n                {currentScore !== null && (\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <Award className=\"h-3 w-3 lg:h-4 lg:w-4 text-yellow-600\" />\r\n                    <span className=\"text-xs lg:text-sm\">{currentScore}%</span>\r\n                  </div>\r\n                )}\r\n                \r\n                <Badge \r\n                  variant={completionStatus === 'completed' || completionStatus === 'passed' ? 'default' : 'secondary'}\r\n                  className=\"text-xs\"\r\n                >\r\n                  {completionStatus}\r\n                </Badge>\r\n              </div>\r\n\r\n              {/* Mobile Progress */}\r\n              <div className=\"flex lg:hidden items-center gap-1\">\r\n                <Progress value={progressPercentage} className=\"w-12\" />\r\n                <span className=\"text-xs\">{progressPercentage}%</span>\r\n              </div>\r\n\r\n              {/* API Status */}\r\n              <Badge \r\n                variant={isInitialized ? \"default\" : \"secondary\"}\r\n                className=\"text-xs hidden sm:flex\"\r\n              >\r\n                {isInitialized ? 'Ready' : 'Init...'}\r\n              </Badge>\r\n              \r\n              {/* Controls */}\r\n              <div className=\"flex items-center gap-1\">\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => setIsMuted(!isMuted)}\r\n                  className=\"hidden sm:flex\"\r\n                >\r\n                  {isMuted ? <VolumeX className=\"h-4 w-4\" /> : <Volume2 className=\"h-4 w-4\" />}\r\n                </Button>\r\n                \r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={toggleFullscreen}\r\n                  className=\"hidden sm:flex\"\r\n                >\r\n                  <Maximize className=\"h-4 w-4\" />\r\n                </Button>\r\n                \r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => setShowDebugConsole(!showDebugConsole)}\r\n                >\r\n                  <Terminal className=\"h-3 w-3 lg:h-4 lg:w-4\" />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1 flex overflow-hidden\">\r\n        {/* Enhanced Mobile-Responsive TOC Sidebar */}\r\n        {showTOC && (\r\n          <div className={`${showTOC ? 'w-80' : 'w-0'} lg:w-80 border-r bg-card flex flex-col transition-all duration-200 ${showTOC ? 'absolute lg:relative z-10 lg:z-0' : 'hidden lg:flex'} h-full lg:h-auto`}>\r\n            <div className=\"p-3 lg:p-4 border-b\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h3 className=\"font-semibold text-sm lg:text-base\">Course Contents</h3>\r\n                <Button \r\n                  variant=\"ghost\" \r\n                  size=\"sm\" \r\n                  onClick={() => setShowTOC(false)}\r\n                  className=\"lg:hidden\"\r\n                >\r\n                  <X className=\"h-4 w-4\" />\r\n                </Button>\r\n              </div>\r\n              <div className=\"text-xs lg:text-sm text-muted-foreground mt-1\">\r\n                Progress: {progressPercentage}% Complete\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex-1 overflow-y-auto p-2\">\r\n              <div className=\"space-y-1\">\r\n                {scos.map((sco, index) => {\r\n                  const status = getScoStatus(sco, index);\r\n                  const StatusIcon = status.icon;\r\n                  const isCurrent = index === currentScoIndex;\r\n                  \r\n                  return (\r\n                    <div \r\n                      key={sco.id}\r\n                      className={`p-2 lg:p-3 rounded-lg cursor-pointer transition-all hover:bg-accent ${\r\n                        isCurrent ? 'bg-primary text-primary-foreground shadow-sm' : status.bgColor\r\n                      }`}\r\n                      onClick={() => {\r\n                        handleScoNavigation(index);\r\n                        // Close sidebar on mobile after selection\r\n                        if (window.innerWidth < 1024) {\r\n                          setShowTOC(false);\r\n                        }\r\n                      }}\r\n                    >\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2 lg:gap-3 flex-1 min-w-0\">\r\n                          <StatusIcon className={`h-3 w-3 lg:h-4 lg:w-4 flex-shrink-0 ${isCurrent ? 'text-primary-foreground' : status.color}`} />\r\n                          <div className=\"min-w-0 flex-1\">\r\n                            <p className={`text-xs lg:text-sm font-medium truncate ${isCurrent ? 'text-primary-foreground' : ''}`}>\r\n                              {sco.title}\r\n                            </p>\r\n                            <p className={`text-xs ${isCurrent ? 'text-primary-foreground/80' : 'text-muted-foreground'} hidden lg:block`}>\r\n                              SCO {index + 1} â€¢ {sco.scorm_type?.toUpperCase() || 'SCO'}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        {sco.mastery_score && (\r\n                          <div className={`text-xs ${isCurrent ? 'text-primary-foreground/80' : 'text-muted-foreground'} hidden lg:block`}>\r\n                            <Target className=\"h-3 w-3 inline mr-1\" />\r\n                            {sco.mastery_score}%\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Main Content Area */}\r\n        <div className=\"flex-1 flex flex-col\">\r\n          {/* Content Frame */}\r\n          <div className=\"flex-1 p-2 lg:p-4\">\r\n            <Card className=\"h-full\">\r\n              <CardContent className=\"p-0 h-full\">\r\n                <ScormIframe\r\n                  launchUrl={launchUrl}\r\n                  onLoaded={() => {\r\n                    console.log(\"SCORM iframe loaded in ScormPlayerPro\", launchUrl);\r\n                    addDebugLog('info', 'player', 'SCORM iframe loaded successfully');\r\n                  }}\r\n                />\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Enhanced Debug Console */}\r\n          {showDebugConsole && (\r\n            <ScormDebugConsole\r\n              debugLogs={debugLogs}\r\n              cmiData={currentSco ? sessionData[currentSco.id] || {} : {}}\r\n              apiCallCount={apiCallCount}\r\n              sessionDuration={sessionTime}\r\n              onClearLogs={() => setDebugLogs([])}\r\n            />\r\n          )}\r\n\r\n          {/* Enhanced Mobile-Responsive Controls */}\r\n          <div className=\"border-t p-2 lg:p-4 bg-card\">\r\n            <div className=\"flex items-center justify-between flex-wrap gap-2\">\r\n              <div className=\"flex items-center gap-1 lg:gap-2\">\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\"\r\n                  disabled={currentScoIndex === 0}\r\n                  onClick={() => handleScoNavigation(currentScoIndex - 1)}\r\n                  className=\"text-xs lg:text-sm\"\r\n                >\r\n                  <ChevronLeft className=\"h-3 w-3 lg:h-4 lg:w-4 mr-1\" />\r\n                  <span className=\"hidden sm:inline\">Previous</span>\r\n                  <span className=\"sm:hidden\">Prev</span>\r\n                </Button>\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\"\r\n                  disabled={currentScoIndex === scos.length - 1}\r\n                  onClick={() => handleScoNavigation(currentScoIndex + 1)}\r\n                  className=\"text-xs lg:text-sm\"\r\n                >\r\n                  <span className=\"hidden sm:inline\">Next</span>\r\n                  <span className=\"sm:hidden\">Next</span>\r\n                  <ChevronRight className=\"h-3 w-3 lg:h-4 lg:w-4 ml-1\" />\r\n                </Button>\r\n              </div>\r\n              \r\n              {/* Middle: Current SCO Info */}\r\n              <div className=\"hidden md:flex items-center gap-4 text-sm text-muted-foreground\">\r\n                <span className=\"truncate max-w-48\">{currentSco?.title}</span>\r\n                {currentSco?.mastery_score && (\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <Target className=\"h-3 w-3\" />\r\n                    Target: {currentSco.mastery_score}%\r\n                  </span>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-1 lg:gap-2\">\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\" \r\n                  onClick={handleRestart}\r\n                  className=\"text-xs lg:text-sm\"\r\n                >\r\n                  <RotateCcw className=\"h-3 w-3 lg:h-4 lg:w-4 mr-1\" />\r\n                  <span className=\"hidden sm:inline\">Restart SCO</span>\r\n                  <span className=\"sm:hidden\">Restart</span>\r\n                </Button>\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\" \r\n                  onClick={handleExit}\r\n                  className=\"text-xs lg:text-sm\"\r\n                >\r\n                  <span className=\"hidden sm:inline\">Exit Course</span>\r\n                  <span className=\"sm:hidden\">Exit</span>\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\qa\\TestPackages.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\runtime\\scorm12.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[79,82],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[79,82],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[99,102],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[99,102],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// SCORM 1.2 API Implementation\r\nexport function createScorm12API(initialData: any = {}, handlers: any = {}) {\r\n  const cmiData = { ...initialData };\r\n  let initialized = false;\r\n  let terminated = false;\r\n  let errorCode = \"0\";\r\n  let errorMessage = \"\";\r\n\r\n  const setError = (code: string, message: string) => {\r\n    errorCode = code;\r\n    errorMessage = message;\r\n  };\r\n\r\n  const validateInitialized = () => {\r\n    if (!initialized) {\r\n      setError(\"301\", \"Not initialized\");\r\n      return false;\r\n    }\r\n    if (terminated) {\r\n      setError(\"101\", \"Already terminated\");\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const API = {\r\n    LMSInitialize: (parameter: string) => {\r\n      if (parameter !== \"\" && parameter !== null) {\r\n        setError(\"201\", \"Invalid argument\");\r\n        return \"false\";\r\n      }\r\n      \r\n      if (initialized) {\r\n        setError(\"101\", \"Already initialized\");\r\n        return \"false\";\r\n      }\r\n\r\n      initialized = true;\r\n      terminated = false;\r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    LMSFinish: (parameter: string) => {\r\n      if (parameter !== \"\" && parameter !== null) {\r\n        setError(\"201\", \"Invalid argument\");\r\n        return \"false\";\r\n      }\r\n\r\n      if (!validateInitialized()) {\r\n        return \"false\";\r\n      }\r\n\r\n      terminated = true;\r\n      initialized = false;\r\n      \r\n      // Call finish handler if provided\r\n      if (handlers.onFinish) {\r\n        handlers.onFinish(cmiData);\r\n      }\r\n      \r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    LMSGetValue: (element: string) => {\r\n      if (!validateInitialized()) {\r\n        return \"\";\r\n      }\r\n\r\n      if (!element || typeof element !== 'string') {\r\n        setError(\"201\", \"Invalid argument\");\r\n        return \"\";\r\n      }\r\n\r\n      // Handle SCORM 1.2 CMI elements\r\n      const value = cmiData[element];\r\n      \r\n      if (value === undefined) {\r\n        // Return appropriate defaults for SCORM 1.2\r\n        switch (element) {\r\n          case \"cmi.core.lesson_status\":\r\n            return \"not attempted\";\r\n          case \"cmi.core.lesson_location\":\r\n            return \"\";\r\n          case \"cmi.core.score.raw\":\r\n            return \"\";\r\n          case \"cmi.core.score.max\":\r\n            return \"100\";\r\n          case \"cmi.core.score.min\":\r\n            return \"0\";\r\n          case \"cmi.core.session_time\":\r\n            return \"00:00:00\";\r\n          case \"cmi.core.total_time\":\r\n            return \"00:00:00\";\r\n          case \"cmi.suspend_data\":\r\n            return \"\";\r\n          case \"cmi.launch_data\":\r\n            return \"\";\r\n          case \"cmi.comments\":\r\n            return \"\";\r\n          case \"cmi.student_id\":\r\n            return \"student_001\";\r\n          case \"cmi.student_name\":\r\n            return \"Student, Test\";\r\n          default:\r\n            setError(\"401\", \"Not implemented error\");\r\n            return \"\";\r\n        }\r\n      }\r\n\r\n      setError(\"0\", \"No error\");\r\n      return value.toString();\r\n    },\r\n\r\n    LMSSetValue: (element: string, value: string) => {\r\n      if (!validateInitialized()) {\r\n        return \"false\";\r\n      }\r\n\r\n      if (!element || typeof element !== 'string') {\r\n        setError(\"201\", \"Invalid argument\");\r\n        return \"false\";\r\n      }\r\n\r\n      // Validate writeable elements in SCORM 1.2\r\n      const writeableElements = [\r\n        \"cmi.core.lesson_status\",\r\n        \"cmi.core.lesson_location\", \r\n        \"cmi.core.score.raw\",\r\n        \"cmi.core.score.max\",\r\n        \"cmi.core.score.min\",\r\n        \"cmi.core.session_time\",\r\n        \"cmi.suspend_data\",\r\n        \"cmi.comments\"\r\n      ];\r\n\r\n      if (!writeableElements.includes(element)) {\r\n        setError(\"402\", \"Invalid set value, element is read only\");\r\n        return \"false\";\r\n      }\r\n\r\n      // Validate lesson_status values\r\n      if (element === \"cmi.core.lesson_status\") {\r\n        const validStatuses = [\"passed\", \"completed\", \"failed\", \"incomplete\", \"browsed\", \"not attempted\"];\r\n        if (!validStatuses.includes(value)) {\r\n          setError(\"405\", \"Incorrect data type\");\r\n          return \"false\";\r\n        }\r\n      }\r\n\r\n      // Store the value\r\n      cmiData[element] = value;\r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    LMSCommit: (parameter: string) => {\r\n      if (parameter !== \"\" && parameter !== null) {\r\n        setError(\"201\", \"Invalid argument\");\r\n        return \"false\";\r\n      }\r\n\r\n      if (!validateInitialized()) {\r\n        return \"false\";\r\n      }\r\n\r\n      // Call commit handler if provided\r\n      if (handlers.onCommit) {\r\n        handlers.onCommit(cmiData);\r\n      }\r\n\r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    LMSGetLastError: () => {\r\n      return errorCode;\r\n    },\r\n\r\n    LMSGetErrorString: (errorCode: string) => {\r\n      const errorStrings: { [key: string]: string } = {\r\n        \"0\": \"No error\",\r\n        \"101\": \"General exception\",\r\n        \"201\": \"Invalid argument error\",\r\n        \"202\": \"Element cannot have children\",\r\n        \"203\": \"Element not an array - cannot have count\",\r\n        \"301\": \"Not initialized\",\r\n        \"401\": \"Not implemented error\",\r\n        \"402\": \"Invalid set value, element is read only\",\r\n        \"403\": \"Element is write only\",\r\n        \"404\": \"Incorrect data type\",\r\n        \"405\": \"Incorrect data type\"\r\n      };\r\n      \r\n      return errorStrings[errorCode] || \"Unknown error\";\r\n    },\r\n\r\n    LMSGetDiagnostic: (errorCode: string) => {\r\n      return `SCORM 1.2 API Diagnostic for error ${errorCode}`;\r\n    }\r\n  };\r\n\r\n  return API;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\runtime\\scorm2004.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[82,85],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[82,85],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[102,105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[102,105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// SCORM 2004 API Implementation\r\nexport function createScorm2004API(initialData: any = {}, handlers: any = {}) {\r\n  const cmiData = { ...initialData };\r\n  let initialized = false;\r\n  let terminated = false;\r\n  let errorCode = \"0\";\r\n  let errorMessage = \"\";\r\n\r\n  const setError = (code: string, message: string) => {\r\n    errorCode = code;\r\n    errorMessage = message;\r\n  };\r\n\r\n  const validateInitialized = () => {\r\n    if (!initialized) {\r\n      setError(\"142\", \"Termination before initialization\");\r\n      return false;\r\n    }\r\n    if (terminated) {\r\n      setError(\"143\", \"Termination after termination\");\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const API_1484_11 = {\r\n    Initialize: (parameter: string) => {\r\n      if (parameter !== \"\" && parameter !== null) {\r\n        setError(\"201\", \"General argument error\");\r\n        return \"false\";\r\n      }\r\n      \r\n      if (initialized) {\r\n        setError(\"103\", \"Already initialized\");\r\n        return \"false\";\r\n      }\r\n\r\n      initialized = true;\r\n      terminated = false;\r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    Terminate: (parameter: string) => {\r\n      if (parameter !== \"\" && parameter !== null) {\r\n        setError(\"201\", \"General argument error\");\r\n        return \"false\";\r\n      }\r\n\r\n      if (!validateInitialized()) {\r\n        return \"false\";\r\n      }\r\n\r\n      terminated = true;\r\n      initialized = false;\r\n      \r\n      // Call terminate handler if provided\r\n      if (handlers.onTerminate) {\r\n        handlers.onTerminate(cmiData);\r\n      }\r\n      \r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    GetValue: (element: string) => {\r\n      if (!validateInitialized()) {\r\n        return \"\";\r\n      }\r\n\r\n      if (!element || typeof element !== 'string') {\r\n        setError(\"201\", \"General argument error\");\r\n        return \"\";\r\n      }\r\n\r\n      // Handle SCORM 2004 CMI elements\r\n      const value = cmiData[element];\r\n      \r\n      if (value === undefined) {\r\n        // Return appropriate defaults for SCORM 2004\r\n        switch (element) {\r\n          case \"cmi.completion_status\":\r\n            return \"incomplete\";\r\n          case \"cmi.success_status\":\r\n            return \"unknown\";\r\n          case \"cmi.location\":\r\n            return \"\";\r\n          case \"cmi.score.raw\":\r\n            return \"\";\r\n          case \"cmi.score.max\":\r\n            return \"100\";\r\n          case \"cmi.score.min\":\r\n            return \"0\";\r\n          case \"cmi.score.scaled\":\r\n            return \"\";\r\n          case \"cmi.session_time\":\r\n            return \"PT0H0M0S\";\r\n          case \"cmi.total_time\":\r\n            return \"PT0H0M0S\";\r\n          case \"cmi.suspend_data\":\r\n            return \"\";\r\n          case \"cmi.launch_data\":\r\n            return \"\";\r\n          case \"cmi.learner_id\":\r\n            return \"learner_001\";\r\n          case \"cmi.learner_name\":\r\n            return \"Learner, Test\";\r\n          case \"cmi.mode\":\r\n            return \"normal\";\r\n          case \"cmi.credit\":\r\n            return \"credit\";\r\n          case \"cmi.entry\":\r\n            return \"ab-initio\";\r\n          case \"cmi.progress_measure\":\r\n            return \"\";\r\n          default:\r\n            setError(\"401\", \"Undefined data model element\");\r\n            return \"\";\r\n        }\r\n      }\r\n\r\n      setError(\"0\", \"No error\");\r\n      return value.toString();\r\n    },\r\n\r\n    SetValue: (element: string, value: string) => {\r\n      if (!validateInitialized()) {\r\n        return \"false\";\r\n      }\r\n\r\n      if (!element || typeof element !== 'string') {\r\n        setError(\"201\", \"General argument error\");\r\n        return \"false\";\r\n      }\r\n\r\n      // Validate writeable elements in SCORM 2004\r\n      const writeableElements = [\r\n        \"cmi.completion_status\",\r\n        \"cmi.success_status\",\r\n        \"cmi.location\", \r\n        \"cmi.score.raw\",\r\n        \"cmi.score.max\",\r\n        \"cmi.score.min\",\r\n        \"cmi.score.scaled\",\r\n        \"cmi.session_time\",\r\n        \"cmi.suspend_data\",\r\n        \"cmi.progress_measure\",\r\n        \"cmi.exit\"\r\n      ];\r\n\r\n      if (!writeableElements.includes(element)) {\r\n        setError(\"404\", \"Data model element not writeable\");\r\n        return \"false\";\r\n      }\r\n\r\n      // Validate completion_status values\r\n      if (element === \"cmi.completion_status\") {\r\n        const validStatuses = [\"completed\", \"incomplete\", \"not_attempted\", \"unknown\"];\r\n        if (!validStatuses.includes(value)) {\r\n          setError(\"406\", \"Data model element type mismatch\");\r\n          return \"false\";\r\n        }\r\n      }\r\n\r\n      // Validate success_status values\r\n      if (element === \"cmi.success_status\") {\r\n        const validStatuses = [\"passed\", \"failed\", \"unknown\"];\r\n        if (!validStatuses.includes(value)) {\r\n          setError(\"406\", \"Data model element type mismatch\");\r\n          return \"false\";\r\n        }\r\n      }\r\n\r\n      // Validate score.scaled (must be between -1 and 1)\r\n      if (element === \"cmi.score.scaled\") {\r\n        const scaledValue = parseFloat(value);\r\n        if (isNaN(scaledValue) || scaledValue < -1 || scaledValue > 1) {\r\n          setError(\"407\", \"Data model element value out of range\");\r\n          return \"false\";\r\n        }\r\n      }\r\n\r\n      // Store the value\r\n      cmiData[element] = value;\r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    Commit: (parameter: string) => {\r\n      if (parameter !== \"\" && parameter !== null) {\r\n        setError(\"201\", \"General argument error\");\r\n        return \"false\";\r\n      }\r\n\r\n      if (!validateInitialized()) {\r\n        return \"false\";\r\n      }\r\n\r\n      // Call commit handler if provided\r\n      if (handlers.onCommit) {\r\n        handlers.onCommit(cmiData);\r\n      }\r\n\r\n      setError(\"0\", \"No error\");\r\n      return \"true\";\r\n    },\r\n\r\n    GetLastError: () => {\r\n      return errorCode;\r\n    },\r\n\r\n    GetErrorString: (errorCode: string) => {\r\n      const errorStrings: { [key: string]: string } = {\r\n        \"0\": \"No error\",\r\n        \"101\": \"General exception\",\r\n        \"102\": \"General initialization failure\",\r\n        \"103\": \"Already initialized\",\r\n        \"104\": \"Content instance terminated\",\r\n        \"111\": \"General termination failure\",\r\n        \"112\": \"Termination before initialization\",\r\n        \"113\": \"Termination after termination\",\r\n        \"122\": \"Retrieve data before initialization\",\r\n        \"123\": \"Retrieve data after termination\",\r\n        \"132\": \"Store data before initialization\",\r\n        \"133\": \"Store data after termination\",\r\n        \"142\": \"Commit before initialization\",\r\n        \"143\": \"Commit after termination\",\r\n        \"201\": \"General argument error\",\r\n        \"301\": \"General get failure\",\r\n        \"351\": \"General set failure\",\r\n        \"391\": \"General commit failure\",\r\n        \"401\": \"Undefined data model element\",\r\n        \"402\": \"Unimplemented data model element\",\r\n        \"403\": \"Data model element value not initialized\",\r\n        \"404\": \"Data model element is read only\",\r\n        \"405\": \"Data model element is write only\",\r\n        \"406\": \"Data model element type mismatch\",\r\n        \"407\": \"Data model element value out of range\",\r\n        \"408\": \"Data model dependency not established\"\r\n      };\r\n      \r\n      return errorStrings[errorCode] || \"Unknown error\";\r\n    },\r\n\r\n    GetDiagnostic: (errorCode: string) => {\r\n      return `SCORM 2004 API Diagnostic for error ${errorCode}`;\r\n    }\r\n  };\r\n\r\n  return API_1484_11;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\security\\sanitization.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2331,2334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2331,2334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2337,2340],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2337,2340],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2590,2593],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2590,2593],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2691,2694],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2691,2694],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":92,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2978,2981],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2978,2981],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3167,3170],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3167,3170],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// SCORM Security Utilities\r\n\r\nconst ALLOWED_PROTOCOLS = ['http:', 'https:', 'data:', 'blob:'];\r\nconst BLOCKED_EXTENSIONS = ['.exe', '.bat', '.cmd', '.scr', '.com', '.pif', '.vbs', '.js'];\r\n\r\n/**\r\n * Sanitize launch href to prevent security issues\r\n */\r\nexport function sanitizeLaunchHref(href: string): string {\r\n  if (!href) return '';\r\n  \r\n  try {\r\n    // Handle relative URLs\r\n    if (!href.includes('://')) {\r\n      // Remove any directory traversal attempts\r\n      const cleaned = href.replace(/\\.\\./g, '').replace(/\\/\\.\\//g, '/');\r\n      // Ensure it doesn't start with / to prevent absolute path access\r\n      return cleaned.startsWith('/') ? cleaned.substring(1) : cleaned;\r\n    }\r\n    \r\n    // Handle absolute URLs\r\n    const url = new URL(href);\r\n    \r\n    // Check protocol\r\n    if (!ALLOWED_PROTOCOLS.includes(url.protocol)) {\r\n      throw new Error(`Protocol ${url.protocol} not allowed`);\r\n    }\r\n    \r\n    // Check for blocked extensions\r\n    const pathname = url.pathname.toLowerCase();\r\n    if (BLOCKED_EXTENSIONS.some(ext => pathname.endsWith(ext))) {\r\n      throw new Error(`File extension not allowed: ${pathname}`);\r\n    }\r\n    \r\n    // For security, only allow same-origin URLs or explicitly whitelisted domains\r\n    if (url.protocol === 'http:' || url.protocol === 'https:') {\r\n      const currentOrigin = typeof window !== 'undefined' ? window.location.origin : '';\r\n      if (url.origin !== currentOrigin) {\r\n        console.warn(`External URL blocked: ${href}`);\r\n        return ''; // Block external URLs unless explicitly whitelisted\r\n      }\r\n    }\r\n    \r\n    return url.toString();\r\n  } catch (error) {\r\n    console.error('Invalid launch href:', href, error);\r\n    return ''; // Return empty string for invalid URLs\r\n  }\r\n}\r\n\r\n/**\r\n * Sanitize SCORM parameters\r\n */\r\nexport function sanitizeParameters(params: string): string {\r\n  if (!params) return '';\r\n  \r\n  // Remove potentially dangerous characters and scripts\r\n  return params\r\n    .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\r\n    .replace(/<[^>]+>/g, '') // Remove HTML tags\r\n    .replace(/javascript:/gi, '')\r\n    .replace(/vbscript:/gi, '')\r\n    .replace(/on\\w+\\s*=/gi, '') // Remove event handlers\r\n    .trim();\r\n}\r\n\r\n/**\r\n * Validate and sanitize manifest data\r\n */\r\nexport function sanitizeManifestData(manifest: any): any {\r\n  if (!manifest || typeof manifest !== 'object') {\r\n    return {};\r\n  }\r\n  \r\n  const sanitized = { ...manifest };\r\n  \r\n  // Sanitize organizations\r\n  if (sanitized.organizations) {\r\n    sanitized.organizations = sanitized.organizations.map((org: any) => ({\r\n      ...org,\r\n      title: sanitizeText(org.title),\r\n      items: org.items?.map((item: any) => ({\r\n        ...item,\r\n        title: sanitizeText(item.title),\r\n        parameters: sanitizeParameters(item.parameters || '')\r\n      })) || []\r\n    }));\r\n  }\r\n  \r\n  // Sanitize resources\r\n  if (sanitized.resources) {\r\n    sanitized.resources = sanitized.resources.map((resource: any) => ({\r\n      ...resource,\r\n      href: sanitizeLaunchHref(resource.href)\r\n    }));\r\n  }\r\n  \r\n  // Sanitize SCOs\r\n  if (sanitized.scos) {\r\n    sanitized.scos = sanitized.scos.map((sco: any) => ({\r\n      ...sco,\r\n      title: sanitizeText(sco.title),\r\n      launch_href: sanitizeLaunchHref(sco.launch_href),\r\n      parameters: sanitizeParameters(sco.parameters || '')\r\n    }));\r\n  }\r\n  \r\n  return sanitized;\r\n}\r\n\r\n/**\r\n * Sanitize text content\r\n */\r\nexport function sanitizeText(text: string): string {\r\n  if (!text) return '';\r\n  \r\n  return text\r\n    .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\r\n    .replace(/<[^>]+>/g, '') // Remove HTML tags\r\n    .replace(/&lt;script\\b[^&]*(?:(?!&lt;\\/script&gt;)&[^&]*)*&lt;\\/script&gt;/gi, '')\r\n    .trim();\r\n}\r\n\r\n/**\r\n * Generate Content Security Policy header value\r\n */\r\nexport function generateCSPHeader(allowInlineStyles = true): string {\r\n  const directives = [\r\n    \"default-src 'self'\",\r\n    \"script-src 'self' 'unsafe-inline'\", // SCORM content often requires inline scripts\r\n    allowInlineStyles ? \"style-src 'self' 'unsafe-inline'\" : \"style-src 'self'\",\r\n    \"img-src 'self' data: blob:\",\r\n    \"font-src 'self' data:\",\r\n    \"connect-src 'self'\",\r\n    \"media-src 'self' blob:\",\r\n    \"object-src 'none'\",\r\n    \"base-uri 'self'\",\r\n    \"form-action 'self'\",\r\n    \"frame-ancestors 'none'\", // Prevent embedding in other sites\r\n    \"upgrade-insecure-requests\"\r\n  ];\r\n  \r\n  return directives.join('; ');\r\n}\r\n\r\n/**\r\n * Validate file upload security\r\n */\r\nexport function validateScormUpload(file: File): { valid: boolean; error?: string } {\r\n  // Check file type\r\n  if (file.type !== 'application/zip' && !file.name.toLowerCase().endsWith('.zip')) {\r\n    return { valid: false, error: 'Only ZIP files are allowed' };\r\n  }\r\n  \r\n  // Check file size (max 100MB)\r\n  const maxSize = 100 * 1024 * 1024;\r\n  if (file.size > maxSize) {\r\n    return { valid: false, error: 'File size must be less than 100MB' };\r\n  }\r\n  \r\n  // Check filename for malicious patterns\r\n  const filename = file.name.toLowerCase();\r\n  if (filename.includes('..') || filename.includes('/') || filename.includes('\\\\')) {\r\n    return { valid: false, error: 'Invalid filename' };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Rate limiting utility for SCORM API calls\r\n */\r\nexport class ScormRateLimiter {\r\n  private calls: Map<string, number[]> = new Map();\r\n  private readonly maxCalls: number;\r\n  private readonly windowMs: number;\r\n  \r\n  constructor(maxCalls = 100, windowMs = 1000) {\r\n    this.maxCalls = maxCalls;\r\n    this.windowMs = windowMs;\r\n  }\r\n  \r\n  isAllowed(sessionId: string): boolean {\r\n    const now = Date.now();\r\n    const calls = this.calls.get(sessionId) || [];\r\n    \r\n    // Remove old calls outside the window\r\n    const recentCalls = calls.filter(time => now - time < this.windowMs);\r\n    \r\n    if (recentCalls.length >= this.maxCalls) {\r\n      return false;\r\n    }\r\n    \r\n    // Add current call\r\n    recentCalls.push(now);\r\n    this.calls.set(sessionId, recentCalls);\r\n    \r\n    return true;\r\n  }\r\n  \r\n  cleanup(): void {\r\n    const now = Date.now();\r\n    for (const [sessionId, calls] of this.calls.entries()) {\r\n      const recentCalls = calls.filter(time => now - time < this.windowMs);\r\n      if (recentCalls.length === 0) {\r\n        this.calls.delete(sessionId);\r\n      } else {\r\n        this.calls.set(sessionId, recentCalls);\r\n      }\r\n    }\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\studio\\ScormStudio.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":211,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8888,8891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8888,8891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { \r\n  Upload, Package, Play, Settings, BarChart3, \r\n  FileText, Clock, Users, ChevronRight, Plus,\r\n  Search, Filter, MoreVertical, Eye, Edit, Trash2, AlertCircle\r\n} from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { ScormAnalytics } from '@/scorm/analytics/ScormAnalytics';\r\nimport { \r\n  useScormSummary, \r\n  useScormPackages, \r\n  exportToCSV,\r\n  type PackageMetric \r\n} from '@/hooks/scorm/useScormAnalytics';\r\n\r\nexport const ScormStudio: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const pageSize = 10;\r\n\r\n  // Get real analytics data for the header KPIs\r\n  const summaryQuery = useScormSummary({});\r\n  \r\n  // Get packages data\r\n  const packagesQuery = useScormPackages({\r\n    limit: pageSize,\r\n    offset: (currentPage - 1) * pageSize,\r\n    search: searchTerm,\r\n    status: statusFilter\r\n  });\r\n\r\n  const handleExportPackages = () => {\r\n    if (summaryQuery.data?.packages) {\r\n      exportToCSV(summaryQuery.data.packages, 'scorm-packages');\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'ready': return 'bg-green-100 text-green-800';\r\n      case 'parsing': return 'bg-blue-100 text-blue-800';\r\n      case 'uploading': return 'bg-yellow-100 text-yellow-800';\r\n      case 'error': return 'bg-red-100 text-red-800';\r\n      case 'archived': return 'bg-gray-100 text-gray-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header KPIs */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Packages</p>\r\n                {summaryQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">{summaryQuery.data?.totalPackages || 0}</p>\r\n                )}\r\n              </div>\r\n              <Package className=\"h-8 w-8 text-primary\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Active Enrollments</p>\r\n                {summaryQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">{summaryQuery.data?.totalEnrollments || 0}</p>\r\n                )}\r\n              </div>\r\n              <Users className=\"h-8 w-8 text-blue-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Avg Score</p>\r\n                {summaryQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">{summaryQuery.data?.avgScore || 0}%</p>\r\n                )}\r\n              </div>\r\n              <BarChart3 className=\"h-8 w-8 text-green-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">Avg Score</p>\r\n                {summaryQuery.isLoading ? (\r\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded\" />\r\n                ) : (\r\n                  <p className=\"text-2xl font-bold\">{summaryQuery.data?.avgScore || 0}%</p>\r\n                )}\r\n              </div>\r\n              <Clock className=\"h-8 w-8 text-purple-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Main Content with Tabs */}\r\n      <Tabs defaultValue=\"packages\" className=\"space-y-4\">\r\n        <TabsList className=\"grid w-full grid-cols-5\">\r\n          <TabsTrigger value=\"packages\">Packages</TabsTrigger>\r\n          <TabsTrigger value=\"upload\">Upload</TabsTrigger>\r\n          <TabsTrigger value=\"catalog\">Catalog</TabsTrigger>\r\n          <TabsTrigger value=\"analytics\">Analytics</TabsTrigger>\r\n          <TabsTrigger value=\"qa\">QA Tests</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"packages\" className=\"space-y-4\">\r\n          {/* Filters */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center justify-between\">\r\n                <span>SCORM Packages</span>\r\n                <div className=\"flex gap-2\">\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={handleExportPackages}>\r\n                    <FileText className=\"h-4 w-4 mr-2\" />\r\n                    Export CSV\r\n                  </Button>\r\n                  <Button onClick={() => navigate('/dashboard/scorm/upload')}>\r\n                    <Upload className=\"h-4 w-4 mr-2\" />\r\n                    Upload Package\r\n                  </Button>\r\n                </div>\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"relative flex-1\">\r\n                  <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\r\n                  <Input\r\n                    placeholder=\"Search packages...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    className=\"pl-9\"\r\n                  />\r\n                </div>\r\n                <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                  <SelectTrigger className=\"w-[180px]\">\r\n                    <SelectValue placeholder=\"All Status\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">All Status</SelectItem>\r\n                    <SelectItem value=\"ready\">Ready</SelectItem>\r\n                    <SelectItem value=\"parsing\">Parsing</SelectItem>\r\n                    <SelectItem value=\"uploading\">Uploading</SelectItem>\r\n                    <SelectItem value=\"error\">Error</SelectItem>\r\n                    <SelectItem value=\"archived\">Archived</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Packages List */}\r\n          <Card>\r\n            <CardContent className=\"p-0\">\r\n              {packagesQuery.isLoading ? (\r\n                <div className=\"p-6\">\r\n                  <div className=\"space-y-3\">\r\n                    {[...Array(5)].map((_, i) => (\r\n                      <div key={i} className=\"h-16 bg-muted animate-pulse rounded\" />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              ) : packagesQuery.data?.packages.length === 0 ? (\r\n                <div className=\"text-center py-12\">\r\n                  <Package className=\"mx-auto h-12 w-12 text-muted-foreground mb-4\" />\r\n                  <h3 className=\"text-lg font-semibold mb-2\">No SCORM packages found</h3>\r\n                  <p className=\"text-muted-foreground mb-4\">\r\n                    {searchTerm || statusFilter !== 'all' \r\n                      ? \"No packages match your search criteria.\" \r\n                      : \"Upload your first SCORM package to get started.\"}\r\n                  </p>\r\n                  <Button onClick={() => navigate('/dashboard/scorm/upload')}>\r\n                    <Upload className=\"mr-2 h-4 w-4\" />\r\n                    Upload Package\r\n                  </Button>\r\n                </div>\r\n              ) : (\r\n                <div className=\"p-6\">\r\n                  <div className=\"space-y-4\">\r\n                    {packagesQuery.data?.packages.map((pkg: any) => (\r\n                      <div key={pkg.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"p-2 bg-primary/10 rounded-lg\">\r\n                              <Package className=\"h-5 w-5 text-primary\" />\r\n                            </div>\r\n                            <div>\r\n                              <h4 className=\"font-medium\">{pkg.title}</h4>\r\n                              <p className=\"text-sm text-muted-foreground\">\r\n                                {pkg.description || 'No description provided'}\r\n                              </p>\r\n                              <div className=\"flex items-center gap-2 mt-1\">\r\n                                <Badge className={getStatusColor(pkg.status)}>\r\n                                  {pkg.status}\r\n                                </Badge>\r\n                                <span className=\"text-xs text-muted-foreground\">\r\n                                  Updated {formatDistanceToNow(new Date(pkg.updated_at), { addSuffix: true })}\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Button \r\n                            variant=\"outline\" \r\n                            size=\"sm\"\r\n                            onClick={() => navigate(`/dashboard/scorm/packages/${pkg.id}`)}\r\n                          >\r\n                            <Eye className=\"mr-1 h-3 w-3\" />\r\n                            View\r\n                          </Button>\r\n                          <Button \r\n                            variant=\"outline\" \r\n                            size=\"sm\"\r\n                            onClick={() => navigate(`/scorm/player/${pkg.id}`)}\r\n                          >\r\n                            <Play className=\"mr-1 h-3 w-3\" />\r\n                            Launch\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n\r\n                  {/* Pagination */}\r\n                  {packagesQuery.data && packagesQuery.data.total > pageSize && (\r\n                    <div className=\"flex items-center justify-between pt-4 mt-4 border-t\">\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Showing {((currentPage - 1) * pageSize) + 1} to{' '}\r\n                        {Math.min(currentPage * pageSize, packagesQuery.data.total)} of{' '}\r\n                        {packagesQuery.data.total} results\r\n                      </p>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          disabled={currentPage === 1}\r\n                          onClick={() => setCurrentPage(currentPage - 1)}\r\n                        >\r\n                          Previous\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          disabled={currentPage * pageSize >= packagesQuery.data.total}\r\n                          onClick={() => setCurrentPage(currentPage + 1)}\r\n                        >\r\n                          Next\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"upload\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardContent className=\"p-12 text-center\">\r\n              <Upload className=\"mx-auto h-12 w-12 text-muted-foreground mb-4\" />\r\n              <h3 className=\"text-lg font-semibold mb-2\">Upload SCORM Package</h3>\r\n              <p className=\"text-muted-foreground mb-4\">\r\n                Upload and deploy SCORM 1.2 or SCORM 2004 packages to your learning platform.\r\n              </p>\r\n              <Button onClick={() => navigate('/dashboard/scorm/upload')}>\r\n                <Upload className=\"mr-2 h-4 w-4\" />\r\n                Start Upload\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"catalog\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardContent className=\"p-12 text-center\">\r\n              <Package className=\"mx-auto h-12 w-12 text-muted-foreground mb-4\" />\r\n              <h3 className=\"text-lg font-semibold mb-2\">Package Catalog</h3>\r\n              <p className=\"text-muted-foreground mb-4\">\r\n                Browse and manage your SCORM package library with advanced filtering and search.\r\n              </p>\r\n              <Button onClick={() => navigate('/dashboard/scorm/packages')}>\r\n                <Eye className=\"mr-2 h-4 w-4\" />\r\n                Browse Catalog\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"analytics\" className=\"space-y-4\">\r\n          <ScormAnalytics />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"qa\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Settings className=\"h-5 w-5\" />\r\n                QA Tests & Dev Tools\r\n                <Badge variant=\"secondary\">Admin Only</Badge>\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                <p className=\"text-muted-foreground\">\r\n                  Development and quality assurance tools for SCORM package testing.\r\n                </p>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <Card>\r\n                    <CardContent className=\"p-4\">\r\n                      <h4 className=\"font-medium mb-2\">Package Validation</h4>\r\n                      <p className=\"text-sm text-muted-foreground mb-3\">\r\n                        Validate SCORM package structure and manifest files.\r\n                      </p>\r\n                      <Button variant=\"outline\" size=\"sm\">Run Validation</Button>\r\n                    </CardContent>\r\n                  </Card>\r\n                  <Card>\r\n                    <CardContent className=\"p-4\">\r\n                      <h4 className=\"font-medium mb-2\">Runtime Testing</h4>\r\n                      <p className=\"text-sm text-muted-foreground mb-3\">\r\n                        Test SCORM runtime API calls and data persistence.\r\n                      </p>\r\n                      <Button variant=\"outline\" size=\"sm\">Test Runtime</Button>\r\n                    </CardContent>\r\n                  </Card>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\scorm\\upload\\ScormUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4475,4478],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4475,4478],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback } from 'react';\r\nimport { useDropzone } from 'react-dropzone';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { \r\n  Upload, FileText, CheckCircle, XCircle, \r\n  AlertCircle, ArrowLeft, Package \r\n} from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\ninterface UploadFile {\r\n  file: File;\r\n  progress: number;\r\n  status: 'pending' | 'uploading' | 'parsing' | 'success' | 'error';\r\n  error?: string;\r\n  packageId?: string;\r\n}\r\n\r\nexport const ScormUpload: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const [files, setFiles] = useState<UploadFile[]>([]);\r\n  const [title, setTitle] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const [isPublic, setIsPublic] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  const onDrop = useCallback((acceptedFiles: File[]) => {\r\n    const newFiles = acceptedFiles.map(file => ({\r\n      file,\r\n      progress: 0,\r\n      status: 'pending' as const\r\n    }));\r\n    setFiles(prev => [...prev, ...newFiles]);\r\n  }, []);\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    accept: {\r\n      'application/zip': ['.zip'],\r\n      'application/x-zip-compressed': ['.zip']\r\n    },\r\n    multiple: false,\r\n    disabled: isUploading\r\n  });\r\n\r\n  const removeFile = (index: number) => {\r\n    setFiles(prev => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const uploadFile = async (fileData: UploadFile, index: number) => {\r\n    try {\r\n      // Update status to uploading\r\n      setFiles(prev => prev.map((f, i) => \r\n        i === index ? { ...f, status: 'uploading', progress: 10 } : f\r\n      ));\r\n\r\n      // Upload to storage\r\n      const fileName = `${Date.now()}_${fileData.file.name}`;\r\n      const { data: uploadData, error: uploadError } = await supabase.storage\r\n        .from('scorm-packages')\r\n        .upload(fileName, fileData.file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      // Update progress\r\n      setFiles(prev => prev.map((f, i) => \r\n        i === index ? { ...f, progress: 50 } : f\r\n      ));\r\n\r\n      // Get current user\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) {\r\n        throw new Error('User not authenticated');\r\n      }\r\n\r\n      // Create package record\r\n      const packageData = {\r\n        title: title || fileData.file.name.replace('.zip', ''),\r\n        description: description || '',\r\n        zip_path: uploadData.path,\r\n        manifest_path: '',\r\n        extract_path: '',\r\n        status: 'uploading' as const,\r\n        is_public: isPublic,\r\n        created_by: user.id,\r\n        metadata: {\r\n          originalFileName: fileData.file.name,\r\n          fileSize: fileData.file.size,\r\n          uploadedAt: new Date().toISOString()\r\n        }\r\n      };\r\n\r\n      const { data: packageResult, error: packageError } = await supabase\r\n        .from('scorm_packages')\r\n        .insert([packageData])\r\n        .select()\r\n        .single();\r\n\r\n      if (packageError) throw packageError;\r\n\r\n      // Update progress\r\n      setFiles(prev => prev.map((f, i) => \r\n        i === index ? { \r\n          ...f, \r\n          progress: 70, \r\n          status: 'parsing',\r\n          packageId: packageResult.id \r\n        } : f\r\n      ));\r\n\r\n      // Parse the package\r\n      const { data: parseResult, error: parseError } = await supabase.functions\r\n        .invoke('scorm-parser-production', {\r\n          body: {\r\n            packageId: packageResult.id,\r\n            filePath: uploadData.path\r\n          }\r\n        });\r\n\r\n      if (parseError) throw parseError;\r\n\r\n      // Final success\r\n      setFiles(prev => prev.map((f, i) => \r\n        i === index ? { \r\n          ...f, \r\n          progress: 100, \r\n          status: 'success'\r\n        } : f\r\n      ));\r\n\r\n      toast({\r\n        title: \"Upload Successful\",\r\n        description: `${fileData.file.name} has been uploaded and parsed successfully.`,\r\n      });\r\n\r\n    } catch (error: any) {\r\n      console.error('Upload error:', error);\r\n      setFiles(prev => prev.map((f, i) => \r\n        i === index ? { \r\n          ...f, \r\n          status: 'error',\r\n          error: error.message \r\n        } : f\r\n      ));\r\n\r\n      toast({\r\n        title: \"Upload Failed\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleUpload = async () => {\r\n    if (files.length === 0) {\r\n      toast({\r\n        title: \"No Files Selected\",\r\n        description: \"Please select a SCORM package to upload.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n\r\n    try {\r\n      // Upload all files\r\n      await Promise.all(\r\n        files.map((file, index) => uploadFile(file, index))\r\n      );\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'success':\r\n        return <CheckCircle className=\"h-5 w-5 text-green-600\" />;\r\n      case 'error':\r\n        return <XCircle className=\"h-5 w-5 text-red-600\" />;\r\n      case 'uploading':\r\n      case 'parsing':\r\n        return <div className=\"h-5 w-5 animate-spin rounded-full border-2 border-primary border-t-transparent\" />;\r\n      default:\r\n        return <FileText className=\"h-5 w-5 text-muted-foreground\" />;\r\n    }\r\n  };\r\n\r\n  const allSuccess = files.length > 0 && files.every(f => f.status === 'success');\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      {/* Header */}\r\n      <div className=\"border-b bg-card\">\r\n        <div className=\"container mx-auto px-6 py-4\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => navigate(-1)}>\r\n              <ArrowLeft className=\"h-4 w-4\" />\r\n            </Button>\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold\">Upload SCORM Package</h1>\r\n              <p className=\"text-muted-foreground\">Upload and parse your SCORM content packages</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"container mx-auto px-6 py-6 max-w-4xl\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n          {/* Upload Area */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Upload className=\"h-5 w-5\" />\r\n                Select SCORM Package\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div\r\n                {...getRootProps()}\r\n                className={`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${\r\n                  isDragActive \r\n                    ? 'border-primary bg-primary/5' \r\n                    : 'border-muted-foreground/25 hover:border-primary/50'\r\n                } ${isUploading ? 'pointer-events-none opacity-50' : ''}`}\r\n              >\r\n                <input {...getInputProps()} />\r\n                <Package className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                {isDragActive ? (\r\n                  <p className=\"text-lg font-medium\">Drop the SCORM package here...</p>\r\n                ) : (\r\n                  <>\r\n                    <p className=\"text-lg font-medium mb-2\">\r\n                      Drop your SCORM package here, or click to select\r\n                    </p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      Supports ZIP files containing SCORM 1.2 or SCORM 2004 content\r\n                    </p>\r\n                  </>\r\n                )}\r\n              </div>\r\n\r\n              {/* File List */}\r\n              {files.length > 0 && (\r\n                <div className=\"mt-6 space-y-3\">\r\n                  {files.map((fileData, index) => (\r\n                    <div key={index} className=\"flex items-center gap-3 p-3 border rounded-lg\">\r\n                      {getStatusIcon(fileData.status)}\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"font-medium truncate\">{fileData.file.name}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          {(fileData.file.size / 1024 / 1024).toFixed(2)} MB\r\n                        </p>\r\n                        {fileData.status === 'uploading' || fileData.status === 'parsing' ? (\r\n                          <Progress value={fileData.progress} className=\"mt-2\" />\r\n                        ) : null}\r\n                        {fileData.error && (\r\n                          <p className=\"text-sm text-red-600 mt-1\">{fileData.error}</p>\r\n                        )}\r\n                      </div>\r\n                      {fileData.status === 'pending' && (\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => removeFile(index)}\r\n                        >\r\n                          Remove\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Package Details */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Package Details</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div>\r\n                <Label htmlFor=\"title\">Title</Label>\r\n                <Input\r\n                  id=\"title\"\r\n                  value={title}\r\n                  onChange={(e) => setTitle(e.target.value)}\r\n                  placeholder=\"Enter package title (optional)\"\r\n                  disabled={isUploading}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <Label htmlFor=\"description\">Description</Label>\r\n                <Textarea\r\n                  id=\"description\"\r\n                  value={description}\r\n                  onChange={(e) => setDescription(e.target.value)}\r\n                  placeholder=\"Enter package description (optional)\"\r\n                  rows={3}\r\n                  disabled={isUploading}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <Label htmlFor=\"public\">Make Public</Label>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Allow others to view and launch this package\r\n                  </p>\r\n                </div>\r\n                <Switch\r\n                  id=\"public\"\r\n                  checked={isPublic}\r\n                  onCheckedChange={setIsPublic}\r\n                  disabled={isUploading}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"pt-4 border-t\">\r\n                <Button\r\n                  onClick={handleUpload}\r\n                  disabled={files.length === 0 || isUploading}\r\n                  className=\"w-full\"\r\n                >\r\n                  {isUploading ? (\r\n                    <>\r\n                      <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent mr-2\" />\r\n                      Processing...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Upload className=\"h-4 w-4 mr-2\" />\r\n                      Upload Package\r\n                    </>\r\n                  )}\r\n                </Button>\r\n\r\n                {allSuccess && (\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    className=\"w-full mt-2\"\r\n                    onClick={() => navigate('/dashboard/scorm/studio')}\r\n                  >\r\n                    Return to Studio\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Tips */}\r\n        <Card className=\"mt-6\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <AlertCircle className=\"h-5 w-5\" />\r\n              Upload Tips\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <ul className=\"space-y-2 text-sm text-muted-foreground\">\r\n              <li>â€¢ Ensure your SCORM package is a valid ZIP file with imsmanifest.xml</li>\r\n              <li>â€¢ Maximum file size is 500MB per package</li>\r\n              <li>â€¢ Supports both SCORM 1.2 and SCORM 2004 specifications</li>\r\n              <li>â€¢ Package parsing may take a few minutes for large files</li>\r\n              <li>â€¢ Public packages can be viewed by anyone with the link</li>\r\n            </ul>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\AIInsightsEngine.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[481,484],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[481,484],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":156,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5156,5159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5156,5159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":227,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7278,7281],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7278,7281],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { analyticsEventBus, AnalyticsEvent } from './AnalyticsEventBus';\r\nimport { cleanupManager } from '@/utils/cleanupManager';\r\n\r\nexport interface LearningInsight {\r\n  id: string;\r\n  type: 'performance' | 'pattern' | 'recommendation' | 'motivation' | 'anomaly';\r\n  title: string;\r\n  message: string;\r\n  confidence: number;\r\n  priority: 'low' | 'medium' | 'high';\r\n  actionable: boolean;\r\n  metadata: Record<string, any>;\r\n  timestamp: string;\r\n}\r\n\r\nexport interface AnomalyAlert {\r\n  id: string;\r\n  metric: string;\r\n  value: number;\r\n  threshold: number;\r\n  severity: 'info' | 'warning' | 'critical';\r\n  message: string;\r\n  timestamp: string;\r\n  resolved: boolean;\r\n}\r\n\r\nclass AIInsightsEngine {\r\n  private insights: LearningInsight[] = [];\r\n  private anomalies: AnomalyAlert[] = [];\r\n  private analysisTimers: Map<string, NodeJS.Timeout> = new Map();\r\n\r\n  constructor() {\r\n    this.initializeInsightGeneration();\r\n  }\r\n\r\n  private initializeInsightGeneration() {\r\n    // Subscribe to analytics events for real-time analysis\r\n    analyticsEventBus.subscribe({\r\n      id: 'ai-insights-engine',\r\n      eventTypes: ['*'],\r\n      callback: (event) => this.analyzeEvent(event)\r\n    });\r\n\r\n    // Schedule periodic deep analysis\r\n    this.schedulePeriodicAnalysis();\r\n    console.log('ðŸ¤– AI Insights Engine initialized');\r\n  }\r\n\r\n  private analyzeEvent(event: AnalyticsEvent) {\r\n    // Trigger analysis with debouncing to avoid overwhelming the system\r\n    const analysisKey = `${event.userId}-${event.eventType}`;\r\n    \r\n    if (this.analysisTimers.has(analysisKey)) {\r\n      clearTimeout(this.analysisTimers.get(analysisKey)!);\r\n    }\r\n\r\n    const timer = setTimeout(() => {\r\n      this.performEventAnalysis(event);\r\n      this.analysisTimers.delete(analysisKey);\r\n    }, 5000); // 5-second debounce\r\n\r\n    this.analysisTimers.set(analysisKey, timer);\r\n  }\r\n\r\n  private async performEventAnalysis(event: AnalyticsEvent) {\r\n    try {\r\n      // Detect anomalies in real-time\r\n      await this.detectAnomalies(event);\r\n      \r\n      // Generate contextual insights\r\n      await this.generateContextualInsights(event);\r\n    } catch (error) {\r\n      console.error('Error in event analysis:', error);\r\n    }\r\n  }\r\n\r\n  private async detectAnomalies(event: AnalyticsEvent) {\r\n    const metricValue = this.extractMetricValue(event);\r\n    if (metricValue === null) return;\r\n\r\n    // Get historical data for comparison\r\n    const historicalData = await analyticsEventBus.getTimeSeriesData(event.eventType, '7d');\r\n    \r\n    if (historicalData.length < 10) return; // Need enough data for analysis\r\n\r\n    const values = historicalData.map(d => d.value);\r\n    const mean = values.reduce((sum, val) => sum + val, 0) / values.length;\r\n    const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;\r\n    const stdDev = Math.sqrt(variance);\r\n\r\n    // Simple anomaly detection using standard deviation\r\n    const threshold = mean + (2 * stdDev); // 2 sigma threshold\r\n    const isAnomaly = metricValue > threshold || metricValue < (mean - 2 * stdDev);\r\n\r\n    if (isAnomaly) {\r\n      const anomaly: AnomalyAlert = {\r\n        id: crypto.randomUUID(),\r\n        metric: event.eventType,\r\n        value: metricValue,\r\n        threshold,\r\n        severity: this.calculateSeverity(metricValue, mean, stdDev),\r\n        message: this.generateAnomalyMessage(event.eventType, metricValue, mean),\r\n        timestamp: new Date().toISOString(),\r\n        resolved: false\r\n      };\r\n\r\n      this.anomalies.unshift(anomaly);\r\n      console.log('ðŸš¨ Anomaly detected:', anomaly);\r\n\r\n      // Store anomaly in database\r\n      await this.storeAnomaly(anomaly, event.userId);\r\n    }\r\n  }\r\n\r\n  private calculateSeverity(value: number, mean: number, stdDev: number): 'info' | 'warning' | 'critical' {\r\n    const deviations = Math.abs(value - mean) / stdDev;\r\n    \r\n    if (deviations >= 3) return 'critical';\r\n    if (deviations >= 2) return 'warning';\r\n    return 'info';\r\n  }\r\n\r\n  private generateAnomalyMessage(eventType: string, value: number, mean: number): string {\r\n    const isHigh = value > mean;\r\n    const eventName = eventType.replace(/_/g, ' ').toLowerCase();\r\n    \r\n    if (isHigh) {\r\n      return `Unusually high ${eventName} detected (${value.toFixed(1)} vs average ${mean.toFixed(1)})`;\r\n    } else {\r\n      return `Unusually low ${eventName} detected (${value.toFixed(1)} vs average ${mean.toFixed(1)})`;\r\n    }\r\n  }\r\n\r\n  private async generateContextualInsights(event: AnalyticsEvent) {\r\n    try {\r\n      // Call the existing AI study insights function\r\n      const { data, error } = await supabase.functions.invoke('generate-study-insights', {\r\n        body: {\r\n          userId: event.userId,\r\n          context: {\r\n            recentEvent: event,\r\n            eventType: event.eventType,\r\n            metadata: event.metadata\r\n          }\r\n        }\r\n      });\r\n\r\n      if (error) {\r\n        console.error('Error generating AI insights:', error);\r\n        return;\r\n      }\r\n\r\n      if (data?.insights) {\r\n        const insights: LearningInsight[] = data.insights.map((insight: any) => ({\r\n          id: crypto.randomUUID(),\r\n          type: insight.type || 'recommendation',\r\n          title: insight.title,\r\n          message: insight.message,\r\n          confidence: insight.confidence || 0.8,\r\n          priority: insight.priority || 'medium',\r\n          actionable: insight.actionable !== false,\r\n          metadata: insight.metadata || {},\r\n          timestamp: new Date().toISOString()\r\n        }));\r\n\r\n        insights.forEach(insight => {\r\n          this.insights.unshift(insight);\r\n        });\r\n\r\n        // Keep only recent insights\r\n        this.insights = this.insights.slice(0, 100);\r\n        \r\n        console.log('ðŸ’¡ Generated contextual insights:', insights.length);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in generateContextualInsights:', error);\r\n    }\r\n  }\r\n\r\n  private analysisIntervalId?: string;\r\n\r\n  private schedulePeriodicAnalysis() {\r\n    // Clear any existing interval\r\n    if (this.analysisIntervalId) {\r\n      cleanupManager.cleanup(this.analysisIntervalId);\r\n    }\r\n    \r\n    // Run deep analysis every hour\r\n    this.analysisIntervalId = cleanupManager.setInterval(async () => {\r\n      try {\r\n        await this.performDeepAnalysis();\r\n      } catch (error) {\r\n        console.error('Error in periodic analysis:', error);\r\n      }\r\n    }, 60 * 60 * 1000, 'AIInsightsEngine'); // 1 hour\r\n  }\r\n\r\n  /**\r\n   * Clean up resources and stop periodic analysis\r\n   */\r\n  destroy() {\r\n    if (this.analysisIntervalId) {\r\n      cleanupManager.cleanup(this.analysisIntervalId);\r\n      this.analysisIntervalId = undefined;\r\n    }\r\n  }\r\n\r\n  private async performDeepAnalysis() {\r\n    console.log('ðŸ” Performing deep learning analytics...');\r\n    \r\n    try {\r\n      const { data, error } = await supabase.functions.invoke('generate-study-insights', {\r\n        body: {\r\n          analysisType: 'deep',\r\n          timeRange: '7d'\r\n        }\r\n      });\r\n\r\n      if (error) {\r\n        console.error('Error in deep analysis:', error);\r\n        return;\r\n      }\r\n\r\n      if (data?.insights) {\r\n        const deepInsights: LearningInsight[] = data.insights.map((insight: any) => ({\r\n          id: crypto.randomUUID(),\r\n          type: insight.type || 'pattern',\r\n          title: insight.title,\r\n          message: insight.message,\r\n          confidence: insight.confidence || 0.9,\r\n          priority: insight.priority || 'medium',\r\n          actionable: insight.actionable !== false,\r\n          metadata: { ...insight.metadata, source: 'deep_analysis' },\r\n          timestamp: new Date().toISOString()\r\n        }));\r\n\r\n        deepInsights.forEach(insight => {\r\n          this.insights.unshift(insight);\r\n        });\r\n\r\n        console.log('ðŸ§  Deep analysis complete:', deepInsights.length, 'insights generated');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in performDeepAnalysis:', error);\r\n    }\r\n  }\r\n\r\n  private extractMetricValue(event: AnalyticsEvent): number | null {\r\n    switch (event.eventType) {\r\n      case 'xp_earned':\r\n        return event.metadata.amount || 0;\r\n      case 'reading_session_end':\r\n        return event.metadata.duration || 0;\r\n      case 'flashcard_reviewed':\r\n        return event.metadata.correct ? 1 : 0;\r\n      case 'study_session_complete':\r\n        return event.metadata.performance?.accuracy || 0;\r\n      default:\r\n        return 1;\r\n    }\r\n  }\r\n\r\n  private async storeAnomaly(anomaly: AnomalyAlert, userId: string) {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('anomaly_alerts')\r\n        .insert({\r\n          id: anomaly.id,\r\n          user_id: userId,\r\n          metric_name: anomaly.metric,\r\n          value: anomaly.value,\r\n          threshold: anomaly.threshold,\r\n          severity: anomaly.severity,\r\n          message: anomaly.message,\r\n          resolved: anomaly.resolved\r\n        });\r\n\r\n      if (error) {\r\n        console.error('Error storing anomaly:', error);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in storeAnomaly:', error);\r\n    }\r\n  }\r\n\r\n  getRecentInsights(limit = 10): LearningInsight[] {\r\n    return this.insights.slice(0, limit);\r\n  }\r\n\r\n  getActiveAnomalies(): AnomalyAlert[] {\r\n    return this.anomalies.filter(a => !a.resolved);\r\n  }\r\n\r\n  async resolveAnomaly(anomalyId: string): Promise<void> {\r\n    const anomaly = this.anomalies.find(a => a.id === anomalyId);\r\n    if (anomaly) {\r\n      anomaly.resolved = true;\r\n      \r\n      // Update in database\r\n      await supabase\r\n        .from('anomaly_alerts')\r\n        .update({ resolved: true, resolved_at: new Date().toISOString() })\r\n        .eq('id', anomalyId);\r\n    }\r\n  }\r\n\r\n  disconnect() {\r\n    // Clean up timers\r\n    this.analysisTimers.forEach(timer => clearTimeout(timer));\r\n    this.analysisTimers.clear();\r\n  }\r\n}\r\n\r\nexport const aiInsightsEngine = new AIInsightsEngine();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\AnalyticsEventBus.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[204,207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[204,207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[534,537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[534,537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[748,751],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[748,751],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":180,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5612,5615],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5612,5615],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { supabase } from '@/integrations/supabase/client';\r\n\r\nexport interface AnalyticsEvent {\r\n  id: string;\r\n  userId: string;\r\n  eventType: string;\r\n  timestamp: string;\r\n  metadata: Record<string, any>;\r\n  source: string;\r\n  sessionId?: string;\r\n}\r\n\r\nexport interface EventSubscriber {\r\n  id: string;\r\n  eventTypes: string[];\r\n  callback: (event: AnalyticsEvent) => void;\r\n}\r\n\r\nexport interface TimeSeriesMetric {\r\n  metric_name: string;\r\n  value: number;\r\n  timestamp: string;\r\n  user_id: string;\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\nclass AnalyticsEventBus {\r\n  private subscribers: Map<string, EventSubscriber> = new Map();\r\n  private eventHistory: AnalyticsEvent[] = [];\r\n  private maxHistorySize = 1000;\r\n  private realtimeChannel: any = null;\r\n\r\n  constructor() {\r\n    this.initializeRealtimeChannel();\r\n  }\r\n\r\n  private initializeRealtimeChannel() {\r\n    this.realtimeChannel = supabase\r\n      .channel('analytics-events')\r\n      .on('broadcast', { event: 'analytics_event' }, (payload) => {\r\n        this.handleRealtimeEvent(payload.payload);\r\n      })\r\n      .subscribe();\r\n\r\n    console.log('ðŸ“Š Analytics realtime channel initialized');\r\n  }\r\n\r\n  private handleRealtimeEvent(event: AnalyticsEvent) {\r\n    // Add to local history\r\n    this.eventHistory.unshift(event);\r\n    if (this.eventHistory.length > this.maxHistorySize) {\r\n      this.eventHistory.pop();\r\n    }\r\n\r\n    // Notify local subscribers\r\n    this.subscribers.forEach(subscriber => {\r\n      if (subscriber.eventTypes.includes(event.eventType) || subscriber.eventTypes.includes('*')) {\r\n        try {\r\n          subscriber.callback(event);\r\n        } catch (error) {\r\n          console.error(`Error in analytics subscriber ${subscriber.id}:`, error);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  subscribe(subscriber: EventSubscriber): () => void {\r\n    this.subscribers.set(subscriber.id, subscriber);\r\n    console.log(`ðŸ“Š Analytics subscriber registered: ${subscriber.id}`);\r\n    \r\n    return () => {\r\n      this.subscribers.delete(subscriber.id);\r\n      console.log(`ðŸ“Š Analytics subscriber unregistered: ${subscriber.id}`);\r\n    };\r\n  }\r\n\r\n  async publish(event: Omit<AnalyticsEvent, 'id' | 'timestamp'>): Promise<void> {\r\n    const fullEvent: AnalyticsEvent = {\r\n      ...event,\r\n      id: crypto.randomUUID(),\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    try {\r\n      // Store in time-series table for high-frequency metrics\r\n      await this.storeTimeSeriesMetric(fullEvent);\r\n\r\n      // Broadcast to realtime channel\r\n      await this.realtimeChannel.send({\r\n        type: 'broadcast',\r\n        event: 'analytics_event',\r\n        payload: fullEvent\r\n      });\r\n\r\n      console.log(`ðŸ“Š Analytics event published: ${event.eventType}`, fullEvent);\r\n    } catch (error) {\r\n      console.error('Error publishing analytics event:', error);\r\n      // Fallback to local handling if realtime fails\r\n      this.handleRealtimeEvent(fullEvent);\r\n    }\r\n  }\r\n\r\n  private async storeTimeSeriesMetric(event: AnalyticsEvent): Promise<void> {\r\n    const metricValue = this.extractMetricValue(event);\r\n    if (metricValue === null) return;\r\n\r\n    const metric = {\r\n      user_id: event.userId,\r\n      metric_name: event.eventType,\r\n      value: metricValue,\r\n      timestamp: event.timestamp,\r\n      metadata: event.metadata\r\n    };\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('analytics_metrics')\r\n        .insert(metric);\r\n\r\n      if (error) {\r\n        console.error('Error storing time-series metric:', error);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in storeTimeSeriesMetric:', error);\r\n    }\r\n  }\r\n\r\n  private extractMetricValue(event: AnalyticsEvent): number | null {\r\n    // Extract numeric values from common event types\r\n    switch (event.eventType) {\r\n      case ANALYTICS_EVENTS.XP_EARNED:\r\n        return event.metadata.amount || 0;\r\n      case ANALYTICS_EVENTS.READING_SESSION_END:\r\n        return event.metadata.duration || 0;\r\n      case ANALYTICS_EVENTS.FLASHCARD_REVIEWED:\r\n        return event.metadata.correct ? 1 : 0;\r\n      case ANALYTICS_EVENTS.STUDY_SESSION_COMPLETE:\r\n        return event.metadata.performance?.accuracy || 0;\r\n      case ANALYTICS_EVENTS.DISCOVERY_WIDGET_VIEW:\r\n      case ANALYTICS_EVENTS.DISCOVERY_WIDGET_CLICK:\r\n      case ANALYTICS_EVENTS.WEATHER_WIDGET_VIEW:\r\n      case ANALYTICS_EVENTS.WEATHER_CHART_INTERACT:\r\n      case ANALYTICS_EVENTS.WEATHER_LESSON_GENERATE:\r\n        return 1; // Count interaction events\r\n      default:\r\n        return 1; // Default metric value for counting events\r\n    }\r\n  }\r\n\r\n  getEventHistory(): AnalyticsEvent[] {\r\n    return [...this.eventHistory];\r\n  }\r\n\r\n  getEventsByType(eventType: string, limit = 50): AnalyticsEvent[] {\r\n    return this.eventHistory\r\n      .filter(event => event.eventType === eventType)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  async getTimeSeriesData(metricName: string, timeRange: string = '24h'): Promise<TimeSeriesMetric[]> {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('analytics_metrics')\r\n        .select('*')\r\n        .eq('metric_name', metricName)\r\n        .gte('timestamp', new Date(Date.now() - this.parseTimeRange(timeRange)).toISOString())\r\n        .order('timestamp', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('Error fetching time-series data:', error);\r\n        return [];\r\n      }\r\n\r\n      return (data || []).map(item => ({\r\n        metric_name: item.metric_name,\r\n        value: Number(item.value),\r\n        timestamp: item.timestamp,\r\n        user_id: item.user_id,\r\n        metadata: (item.metadata as Record<string, any>) || {}\r\n      }));\r\n    } catch (error) {\r\n      console.error('Error in getTimeSeriesData:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  private parseTimeRange(range: string): number {\r\n    const unit = range.slice(-1);\r\n    const value = parseInt(range.slice(0, -1));\r\n    \r\n    switch (unit) {\r\n      case 'h': return value * 60 * 60 * 1000;\r\n      case 'd': return value * 24 * 60 * 60 * 1000;\r\n      case 'w': return value * 7 * 24 * 60 * 60 * 1000;\r\n      default: return 24 * 60 * 60 * 1000; // Default to 24 hours\r\n    }\r\n  }\r\n\r\n  disconnect() {\r\n    if (this.realtimeChannel) {\r\n      supabase.removeChannel(this.realtimeChannel);\r\n      this.realtimeChannel = null;\r\n    }\r\n  }\r\n}\r\n\r\nexport const analyticsEventBus = new AnalyticsEventBus();\r\n\r\n// Standard event types\r\nexport const ANALYTICS_EVENTS = {\r\n  READING_SESSION_START: 'reading_session_start',\r\n  READING_SESSION_END: 'reading_session_end',\r\n  STUDY_SESSION_COMPLETE: 'study_session_complete',\r\n  FLASHCARD_REVIEWED: 'flashcard_reviewed',\r\n  MODULE_COMPLETED: 'module_completed',\r\n  GOAL_CREATED: 'goal_created',\r\n  GOAL_COMPLETED: 'goal_completed',\r\n  NOTE_CREATED: 'note_created',\r\n  FILE_UPLOADED: 'file_uploaded',\r\n  XP_EARNED: 'xp_earned',\r\n  STREAK_UPDATED: 'streak_updated',\r\n  BADGE_EARNED: 'badge_earned',\r\n  // Discovery widget events\r\n  DISCOVERY_WIDGET_VIEW: 'discovery.widget.view',\r\n  DISCOVERY_WIDGET_CLICK: 'discovery.widget.click',\r\n  // Weather widget events\r\n  WEATHER_WIDGET_VIEW: 'weather.widget.view',\r\n  WEATHER_CHART_INTERACT: 'weather.chart.interact',\r\n  WEATHER_LESSON_GENERATE: 'weather.lesson.generate'\r\n} as const;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\BrowsingPatternsAnalyzer.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[560,563],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[560,563],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1566,1569],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1566,1569],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * Browsing patterns analyzer for intelligent background prefetching\r\n */\r\n\r\nimport { PublicDomainBook } from '@/types/publicDomainBooks';\r\nimport { performanceService } from './PerformanceOptimizationService';\r\nimport { indexedDBCache } from './IndexedDBCacheService';\r\n\r\ninterface BrowsingSession {\r\n  sessionId: string;\r\n  startTime: number;\r\n  books: BrowsingEvent[];\r\n  patterns: string[];\r\n}\r\n\r\ninterface BrowsingEvent {\r\n  bookId: string;\r\n  action: 'view' | 'click' | 'read' | 'search';\r\n  timestamp: number;\r\n  duration?: number;\r\n  metadata?: any;\r\n}\r\n\r\ninterface PrefetchPrediction {\r\n  bookId: string;\r\n  confidence: number;\r\n  reason: string;\r\n  priority: 'high' | 'medium' | 'low';\r\n}\r\n\r\nclass BrowsingPatternsAnalyzer {\r\n  private currentSession: BrowsingSession;\r\n  private sessionHistory: BrowsingSession[] = [];\r\n  private behaviorPatterns: Map<string, number> = new Map();\r\n  private prefetchQueue: Set<string> = new Set();\r\n  private isAnalyzing = false;\r\n\r\n  constructor() {\r\n    this.currentSession = this.createNewSession();\r\n    this.loadBrowsingHistory();\r\n  }\r\n\r\n  private createNewSession(): BrowsingSession {\r\n    return {\r\n      sessionId: this.generateSessionId(),\r\n      startTime: Date.now(),\r\n      books: [],\r\n      patterns: []\r\n    };\r\n  }\r\n\r\n  private generateSessionId(): string {\r\n    return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  /**\r\n   * Record a browsing event for pattern analysis\r\n   */\r\n  recordEvent(bookId: string, action: 'view' | 'click' | 'read' | 'search', metadata?: any): void {\r\n    const event: BrowsingEvent = {\r\n      bookId,\r\n      action,\r\n      timestamp: Date.now(),\r\n      metadata\r\n    };\r\n\r\n    this.currentSession.books.push(event);\r\n    \r\n    // Trigger pattern analysis if we have enough events\r\n    if (this.currentSession.books.length >= 3) {\r\n      this.analyzeCurrentSession();\r\n    }\r\n\r\n    console.log('ðŸ“Š Recorded browsing event:', { bookId, action, sessionLength: this.currentSession.books.length });\r\n  }\r\n\r\n  /**\r\n   * Analyze current session for patterns and trigger prefetching\r\n   */\r\n  private async analyzeCurrentSession(): Promise<void> {\r\n    if (this.isAnalyzing) return;\r\n    this.isAnalyzing = true;\r\n\r\n    try {\r\n      const patterns = this.extractSessionPatterns();\r\n      this.currentSession.patterns = patterns;\r\n\r\n      // Generate prefetch predictions\r\n      const predictions = await this.generatePrefetchPredictions();\r\n      \r\n      // Execute high-priority prefetches\r\n      const highPriorityBooks = predictions\r\n        .filter(p => p.priority === 'high' && p.confidence > 0.7)\r\n        .slice(0, 3); // Limit to avoid overwhelming the network\r\n\r\n      await this.executePrefetching(highPriorityBooks);\r\n      \r\n      // Update behavior patterns for future sessions\r\n      this.updateBehaviorPatterns(patterns);\r\n\r\n    } catch (error) {\r\n      console.error('Pattern analysis error:', error);\r\n    } finally {\r\n      this.isAnalyzing = false;\r\n    }\r\n  }\r\n\r\n  private extractSessionPatterns(): string[] {\r\n    const events = this.currentSession.books;\r\n    const patterns: string[] = [];\r\n\r\n    // Pattern 1: Author preference\r\n    const authors = new Map<string, number>();\r\n    events.forEach(event => {\r\n      if (event.metadata?.author) {\r\n        authors.set(event.metadata.author, (authors.get(event.metadata.author) || 0) + 1);\r\n      }\r\n    });\r\n\r\n    const favoriteAuthor = Array.from(authors.entries())\r\n      .sort(([, a], [, b]) => b - a)[0];\r\n    \r\n    if (favoriteAuthor && favoriteAuthor[1] >= 2) {\r\n      patterns.push(`author:${favoriteAuthor[0]}`);\r\n    }\r\n\r\n    // Pattern 2: Subject interest\r\n    const subjects = new Map<string, number>();\r\n    events.forEach(event => {\r\n      if (event.metadata?.subjects) {\r\n        event.metadata.subjects.forEach((subject: string) => {\r\n          subjects.set(subject, (subjects.get(subject) || 0) + 1);\r\n        });\r\n      }\r\n    });\r\n\r\n    const topSubject = Array.from(subjects.entries())\r\n      .sort(([, a], [, b]) => b - a)[0];\r\n    \r\n    if (topSubject && topSubject[1] >= 2) {\r\n      patterns.push(`subject:${topSubject[0]}`);\r\n    }\r\n\r\n    // Pattern 3: Reading behavior\r\n    const readingEvents = events.filter(e => e.action === 'read');\r\n    if (readingEvents.length >= 2) {\r\n      patterns.push('active_reader');\r\n    }\r\n\r\n    // Pattern 4: Search behavior\r\n    const searchEvents = events.filter(e => e.action === 'search');\r\n    if (searchEvents.length >= 3) {\r\n      patterns.push('active_searcher');\r\n    }\r\n\r\n    return patterns;\r\n  }\r\n\r\n  private async generatePrefetchPredictions(): Promise<PrefetchPrediction[]> {\r\n    const predictions: PrefetchPrediction[] = [];\r\n    const recentEvents = this.currentSession.books.slice(-5); // Last 5 events\r\n\r\n    // Prediction 1: Similar books by same author\r\n    const viewedBooks = recentEvents.filter(e => e.action === 'view' || e.action === 'read');\r\n    for (const event of viewedBooks) {\r\n      if (event.metadata?.author) {\r\n        predictions.push({\r\n          bookId: `similar_author:${event.metadata.author}`,\r\n          confidence: 0.8,\r\n          reason: `User showed interest in ${event.metadata.author}`,\r\n          priority: 'high'\r\n        });\r\n      }\r\n    }\r\n\r\n    // Prediction 2: Books in same subject areas\r\n    const subjectInterests = this.extractSubjectInterests(recentEvents);\r\n    subjectInterests.forEach(subject => {\r\n      predictions.push({\r\n        bookId: `subject:${subject}`,\r\n        confidence: 0.6,\r\n        reason: `User browsing ${subject} books`,\r\n        priority: 'medium'\r\n      });\r\n    });\r\n\r\n    // Prediction 3: Sequential reading patterns\r\n    if (this.detectSequentialReading(recentEvents)) {\r\n      predictions.push({\r\n        bookId: 'next_in_series',\r\n        confidence: 0.9,\r\n        reason: 'Sequential reading pattern detected',\r\n        priority: 'high'\r\n      });\r\n    }\r\n\r\n    return predictions;\r\n  }\r\n\r\n  private extractSubjectInterests(events: BrowsingEvent[]): string[] {\r\n    const subjectCounts = new Map<string, number>();\r\n    \r\n    events.forEach(event => {\r\n      if (event.metadata?.subjects) {\r\n        event.metadata.subjects.forEach((subject: string) => {\r\n          subjectCounts.set(subject, (subjectCounts.get(subject) || 0) + 1);\r\n        });\r\n      }\r\n    });\r\n\r\n    return Array.from(subjectCounts.entries())\r\n      .filter(([, count]) => count >= 2)\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 3)\r\n      .map(([subject]) => subject);\r\n  }\r\n\r\n  private detectSequentialReading(events: BrowsingEvent[]): boolean {\r\n    const readEvents = events.filter(e => e.action === 'read');\r\n    return readEvents.length >= 2 && \r\n           readEvents.every(e => e.duration && e.duration > 60000); // More than 1 minute reading\r\n  }\r\n\r\n  private async executePrefetching(predictions: PrefetchPrediction[]): Promise<void> {\r\n    console.log('ðŸš€ Executing intelligent prefetching for', predictions.length, 'predictions');\r\n\r\n    for (const prediction of predictions) {\r\n      try {\r\n        // Skip if already prefetched\r\n        if (this.prefetchQueue.has(prediction.bookId)) continue;\r\n\r\n        this.prefetchQueue.add(prediction.bookId);\r\n        \r\n        // Use performance service for actual prefetching\r\n        // This is a simplified version - in practice, you'd match predictions to actual books\r\n        console.log(`ðŸ“š Prefetching based on: ${prediction.reason} (confidence: ${prediction.confidence})`);\r\n        \r\n        // Add small delay between prefetches to avoid overwhelming the browser\r\n        await new Promise(resolve => setTimeout(resolve, 200));\r\n\r\n      } catch (error) {\r\n        console.warn('Prefetch failed for:', prediction.bookId, error);\r\n      }\r\n    }\r\n  }\r\n\r\n  private updateBehaviorPatterns(patterns: string[]): void {\r\n    patterns.forEach(pattern => {\r\n      const current = this.behaviorPatterns.get(pattern) || 0;\r\n      this.behaviorPatterns.set(pattern, current + 1);\r\n    });\r\n\r\n    // Save to persistent storage\r\n    this.saveBrowsingHistory();\r\n  }\r\n\r\n  /**\r\n   * Get intelligent prefetch suggestions for the current user\r\n   */\r\n  async getPrefetchSuggestions(availableBooks: PublicDomainBook[]): Promise<PublicDomainBook[]> {\r\n    const patterns = Array.from(this.behaviorPatterns.entries())\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 5);\r\n\r\n    const suggestions: PublicDomainBook[] = [];\r\n\r\n    for (const [pattern, frequency] of patterns) {\r\n      if (pattern.startsWith('author:')) {\r\n        const author = pattern.replace('author:', '');\r\n        const authorBooks = availableBooks.filter(book => \r\n          book.author.toLowerCase().includes(author.toLowerCase())\r\n        ).slice(0, 2);\r\n        suggestions.push(...authorBooks);\r\n      }\r\n      \r\n      if (pattern.startsWith('subject:')) {\r\n        const subject = pattern.replace('subject:', '');\r\n        const subjectBooks = availableBooks.filter(book =>\r\n          book.subjects?.some(s => s.toLowerCase().includes(subject.toLowerCase()))\r\n        ).slice(0, 2);\r\n        suggestions.push(...subjectBooks);\r\n      }\r\n    }\r\n\r\n    // Remove duplicates and limit results\r\n    const uniqueSuggestions = suggestions.filter((book, index, array) =>\r\n      array.findIndex(b => b.id === book.id) === index\r\n    );\r\n\r\n    return uniqueSuggestions.slice(0, 8);\r\n  }\r\n\r\n  /**\r\n   * Start a new browsing session\r\n   */\r\n  startNewSession(): void {\r\n    if (this.currentSession.books.length > 0) {\r\n      this.sessionHistory.push(this.currentSession);\r\n      this.saveBrowsingHistory();\r\n    }\r\n    \r\n    this.currentSession = this.createNewSession();\r\n    console.log('ðŸ“Š Started new browsing session:', this.currentSession.sessionId);\r\n  }\r\n\r\n  /**\r\n   * Get browsing analytics\r\n   */\r\n  getAnalytics() {\r\n    return {\r\n      currentSession: {\r\n        id: this.currentSession.sessionId,\r\n        duration: Date.now() - this.currentSession.startTime,\r\n        eventCount: this.currentSession.books.length,\r\n        patterns: this.currentSession.patterns\r\n      },\r\n      historicalSessions: this.sessionHistory.length,\r\n      totalEvents: this.sessionHistory.reduce((sum, session) => sum + session.books.length, 0) + this.currentSession.books.length,\r\n      behaviorPatterns: Object.fromEntries(this.behaviorPatterns),\r\n      prefetchQueue: this.prefetchQueue.size\r\n    };\r\n  }\r\n\r\n  private async loadBrowsingHistory(): Promise<void> {\r\n    try {\r\n      const saved = await indexedDBCache.get('browsing:history');\r\n      if (saved) {\r\n        this.sessionHistory = saved.sessions || [];\r\n        this.behaviorPatterns = new Map(saved.patterns || []);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to load browsing history:', error);\r\n    }\r\n  }\r\n\r\n  private async saveBrowsingHistory(): Promise<void> {\r\n    try {\r\n      await indexedDBCache.set('browsing:history', {\r\n        sessions: this.sessionHistory.slice(-10), // Keep last 10 sessions\r\n        patterns: Array.from(this.behaviorPatterns.entries()),\r\n        lastUpdated: Date.now()\r\n      }, 'metadata');\r\n    } catch (error) {\r\n      console.warn('Failed to save browsing history:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear browsing history and patterns\r\n   */\r\n  clearHistory(): void {\r\n    this.sessionHistory = [];\r\n    this.behaviorPatterns.clear();\r\n    this.prefetchQueue.clear();\r\n    this.currentSession = this.createNewSession();\r\n    this.saveBrowsingHistory();\r\n    console.log('ðŸ§¹ Browsing history cleared');\r\n  }\r\n}\r\n\r\n// Global browsing patterns analyzer instance\r\nexport const browsingPatternsAnalyzer = new BrowsingPatternsAnalyzer();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\DocumentIngestionService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[289,292],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[289,292],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[423,426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[423,426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[481,484],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[481,484],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[512,515],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[512,515],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[707,710],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[707,710],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[933,936],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[933,936],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[964,967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[964,967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2234,2237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2234,2237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2495,2498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2495,2498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2526,2529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2526,2529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2895,2898],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2895,2898],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3415,3418],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3415,3418],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":170,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5433,5436],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5433,5436],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { DocumentMetadata, DocumentSource, DocumentIngestionService } from '@/interfaces/DocumentReader';\r\nimport { OPDSService } from './opdsService';\r\n\r\nexport interface IngestionSource {\r\n  id: string;\r\n  name: string;\r\n  type: 'opds' | 'archive' | 'local';\r\n  config: Record<string, any>;\r\n  enabled: boolean;\r\n  processor: SourceProcessor;\r\n}\r\n\r\nexport interface SourceProcessor {\r\n  validate(config: Record<string, any>): Promise<boolean>;\r\n  ingest(config: Record<string, any>, filters?: Record<string, any>): Promise<DocumentMetadata[]>;\r\n  getMetadata(url: string): Promise<DocumentMetadata | null>;\r\n}\r\n\r\nclass OPDSProcessor implements SourceProcessor {\r\n  async validate(config: Record<string, any>): Promise<boolean> {\r\n    try {\r\n      const response = await fetch(config.feedUrl, { method: 'HEAD' });\r\n      return response.ok;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async ingest(config: Record<string, any>, filters?: Record<string, any>): Promise<DocumentMetadata[]> {\r\n    try {\r\n      const feed = await OPDSService.fetchOPDSFeed();\r\n      let entries = feed.entries;\r\n\r\n      // Apply filters\r\n      if (filters?.subjects?.length) {\r\n        entries = entries.filter(entry => \r\n          entry.subjects?.some(subject => \r\n            filters.subjects.includes(subject.toLowerCase())\r\n          )\r\n        );\r\n      }\r\n\r\n      return entries.map(entry => {\r\n        const book = OPDSService.convertToPublicDomainBook(entry);\r\n        if (!book) return null;\r\n        \r\n        // Convert PublicDomainBook to DocumentMetadata\r\n        return {\r\n          title: book.title,\r\n          author: book.author,\r\n          format: 'epub' as const, // Most OPDS books are EPUB\r\n          language: book.language,\r\n          fileSize: book.file_size\r\n        } as DocumentMetadata;\r\n      }).filter(book => book !== null) as DocumentMetadata[];\r\n    } catch (error) {\r\n      console.error('OPDS ingestion failed:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async getMetadata(url: string): Promise<DocumentMetadata | null> {\r\n    // Implementation would depend on the URL format\r\n    return null;\r\n  }\r\n}\r\n\r\nclass InternetArchiveProcessor implements SourceProcessor {\r\n  async validate(config: Record<string, any>): Promise<boolean> {\r\n    try {\r\n      const response = await fetch(`${config.baseUrl}/metadata/${config.identifier}`, { method: 'HEAD' });\r\n      return response.ok;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async ingest(config: Record<string, any>, filters?: Record<string, any>): Promise<DocumentMetadata[]> {\r\n    try {\r\n      // Implementation for Internet Archive API\r\n      const searchQuery = this.buildSearchQuery(filters);\r\n      const response = await fetch(`${config.baseUrl}/advancedsearch.php?q=${encodeURIComponent(searchQuery)}&output=json`);\r\n      const data = await response.json();\r\n      \r\n      return data.docs?.map((doc: any) => ({\r\n        title: doc.title,\r\n        author: doc.creator,\r\n        format: this.detectFormat(doc.format),\r\n        fileSize: doc.size,\r\n        language: doc.language\r\n      })) || [];\r\n    } catch (error) {\r\n      console.error('Internet Archive ingestion failed:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async getMetadata(url: string): Promise<DocumentMetadata | null> {\r\n    // Extract identifier from URL and fetch metadata\r\n    return null;\r\n  }\r\n\r\n  private buildSearchQuery(filters?: Record<string, any>): string {\r\n    const conditions = ['mediatype:texts'];\r\n    \r\n    if (filters?.format) {\r\n      conditions.push(`format:${filters.format}`);\r\n    }\r\n    \r\n    if (filters?.subjects?.length) {\r\n      conditions.push(`subject:(${filters.subjects.join(' OR ')})`);\r\n    }\r\n    \r\n    return conditions.join(' AND ');\r\n  }\r\n\r\n  private detectFormat(formats: string | string[]): 'pdf' | 'epub' {\r\n    const formatList = Array.isArray(formats) ? formats : [formats];\r\n    return formatList.some(f => f.toLowerCase().includes('epub')) ? 'epub' : 'pdf';\r\n  }\r\n}\r\n\r\nexport class ModularIngestionService implements DocumentIngestionService {\r\n  private sources: Map<string, IngestionSource> = new Map();\r\n\r\n  constructor() {\r\n    this.initializeDefaultSources();\r\n  }\r\n\r\n  private initializeDefaultSources(): void {\r\n    const defaultSources: IngestionSource[] = [\r\n      {\r\n        id: 'gutenberg',\r\n        name: 'Project Gutenberg',\r\n        type: 'opds',\r\n        config: {\r\n          feedUrl: 'https://www.gutenberg.org/ebooks/search.opds/',\r\n          subjects: ['neurodiversity', 'psychology', 'education', 'science']\r\n        },\r\n        enabled: true,\r\n        processor: new OPDSProcessor()\r\n      },\r\n      {\r\n        id: 'internet_archive',\r\n        name: 'Internet Archive',\r\n        type: 'archive',\r\n        config: {\r\n          baseUrl: 'https://archive.org',\r\n          subjects: ['psychology', 'education', 'accessibility']\r\n        },\r\n        enabled: false, // Disabled by default\r\n        processor: new InternetArchiveProcessor()\r\n      }\r\n    ];\r\n\r\n    defaultSources.forEach(source => this.sources.set(source.id, source));\r\n  }\r\n\r\n  getSources(): DocumentSource[] {\r\n    return Array.from(this.sources.values()).map(source => ({\r\n      id: source.id,\r\n      name: source.name,\r\n      type: source.type as 'local' | 'remote' | 'opds' | 'archive',\r\n      baseUrl: source.config.baseUrl,\r\n      authRequired: false\r\n    }));\r\n  }\r\n\r\n  async ingestFromSource(sourceId: string, filters?: Record<string, any>): Promise<DocumentMetadata[]> {\r\n    const source = this.sources.get(sourceId);\r\n    if (!source || !source.enabled) {\r\n      throw new Error(`Source '${sourceId}' not found or disabled`);\r\n    }\r\n\r\n    console.log(`ðŸ“¥ Starting ingestion from ${source.name}...`);\r\n    \r\n    try {\r\n      const isValid = await source.processor.validate(source.config);\r\n      if (!isValid) {\r\n        throw new Error(`Source validation failed for ${source.name}`);\r\n      }\r\n\r\n      const documents = await source.processor.ingest(source.config, filters);\r\n      console.log(`ðŸ“¥ Ingested ${documents.length} documents from ${source.name}`);\r\n      \r\n      return documents;\r\n    } catch (error) {\r\n      console.error(`ðŸ“¥ Ingestion failed for ${source.name}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async validateDocument(url: string): Promise<{ isValid: boolean; metadata?: DocumentMetadata; error?: string }> {\r\n    try {\r\n      const response = await fetch(url, { method: 'HEAD' });\r\n      if (!response.ok) {\r\n        return { isValid: false, error: `HTTP ${response.status}` };\r\n      }\r\n\r\n      const contentType = response.headers.get('content-type');\r\n      const contentLength = response.headers.get('content-length');\r\n      \r\n      let format: 'pdf' | 'epub' = 'pdf';\r\n      if (contentType?.includes('epub') || url.includes('.epub')) {\r\n        format = 'epub';\r\n      }\r\n\r\n      const metadata: DocumentMetadata = {\r\n        title: url.split('/').pop() || 'Unknown',\r\n        format,\r\n        fileSize: contentLength ? parseInt(contentLength) : undefined\r\n      };\r\n\r\n      return { isValid: true, metadata };\r\n    } catch (error) {\r\n      return { isValid: false, error: error instanceof Error ? error.message : 'Unknown error' };\r\n    }\r\n  }\r\n\r\n  async cacheDocument(url: string, metadata: DocumentMetadata): Promise<string> {\r\n    const cacheKey = `doc_${this.hashUrl(url)}`;\r\n    \r\n    try {\r\n      if ('caches' in window) {\r\n        const cache = await caches.open('documents-v1');\r\n        await cache.add(url);\r\n        console.log(`ðŸ’¾ Cached document: ${metadata.title}`);\r\n      }\r\n      \r\n      return cacheKey;\r\n    } catch (error) {\r\n      console.warn(`ðŸ’¾ Failed to cache document: ${metadata.title}`, error);\r\n      return cacheKey;\r\n    }\r\n  }\r\n\r\n  addSource(source: IngestionSource): void {\r\n    this.sources.set(source.id, source);\r\n    console.log(`âž• Added ingestion source: ${source.name}`);\r\n  }\r\n\r\n  removeSource(sourceId: string): void {\r\n    this.sources.delete(sourceId);\r\n    console.log(`âž– Removed ingestion source: ${sourceId}`);\r\n  }\r\n\r\n  enableSource(sourceId: string, enabled: boolean = true): void {\r\n    const source = this.sources.get(sourceId);\r\n    if (source) {\r\n      source.enabled = enabled;\r\n      console.log(`${enabled ? 'âœ…' : 'âŒ'} ${enabled ? 'Enabled' : 'Disabled'} source: ${source.name}`);\r\n    }\r\n  }\r\n\r\n  private hashUrl(url: string): string {\r\n    let hash = 0;\r\n    for (let i = 0; i < url.length; i++) {\r\n      const char = url.charCodeAt(i);\r\n      hash = ((hash << 5) - hash) + char;\r\n      hash = hash & hash;\r\n    }\r\n    return Math.abs(hash).toString(36);\r\n  }\r\n}\r\n\r\nexport const documentIngestionService = new ModularIngestionService();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\DocumentTelemetryService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1759,1762],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1759,1762],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1817,1820],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1817,1820],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":58,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1881,1884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1881,1884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2240,2243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2240,2243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2718,2721],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2718,2721],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":135,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4007,4010],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4007,4010],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { DocumentTelemetryEvent, DocumentReaderConfig } from '@/interfaces/DocumentReader';\r\nimport { cleanupManager } from '@/utils/cleanupManager';\r\n\r\nexport class DocumentTelemetryService {\r\n  private config: DocumentReaderConfig;\r\n  private eventQueue: DocumentTelemetryEvent[] = [];\r\n  private sessionId: string;\r\n  private isOnline: boolean = navigator.onLine;\r\n  private maxQueueSize = 100;\r\n  private flushIntervalId?: string;\r\n\r\n  constructor(config: DocumentReaderConfig) {\r\n    this.config = config;\r\n    this.sessionId = this.generateSessionId();\r\n    \r\n    // Listen for online/offline events\r\n    cleanupManager.addEventListener(window, 'online', () => {\r\n      this.isOnline = true;\r\n      this.flushEventQueue();\r\n    }, 'DocumentTelemetryService');\r\n    \r\n    cleanupManager.addEventListener(window, 'offline', () => {\r\n      this.isOnline = false;\r\n    }, 'DocumentTelemetryService');\r\n    \r\n    // Auto-flush queue periodically\r\n    this.flushIntervalId = cleanupManager.setInterval(() => {\r\n      if (this.isOnline && this.eventQueue.length > 0) {\r\n        this.flushEventQueue();\r\n      }\r\n    }, 30000, 'DocumentTelemetryService'); // Every 30 seconds\r\n  }\r\n\r\n  /**\r\n   * Clean up resources and stop periodic flushing\r\n   */\r\n  destroy() {\r\n    if (this.flushIntervalId) {\r\n      cleanupManager.cleanup(this.flushIntervalId);\r\n      this.flushIntervalId = undefined;\r\n    }\r\n  }\r\n\r\n  trackEvent(event: DocumentTelemetryEvent): void {\r\n    if (!this.config.enableTelemetry) return;\r\n\r\n    const enrichedEvent = {\r\n      ...event,\r\n      sessionId: this.sessionId,\r\n      userAgent: navigator.userAgent,\r\n      viewport: {\r\n        width: window.innerWidth,\r\n        height: window.innerHeight\r\n      },\r\n      connection: (navigator as any).connection ? {\r\n        effectiveType: (navigator as any).connection.effectiveType,\r\n        downlink: (navigator as any).connection.downlink\r\n      } : undefined\r\n    };\r\n\r\n    this.eventQueue.push(enrichedEvent);\r\n    \r\n    // Immediate flush for critical events\r\n    if (event.type === 'load_error' || this.eventQueue.length >= this.maxQueueSize) {\r\n      this.flushEventQueue();\r\n    }\r\n  }\r\n\r\n  trackPerformance(name: string, startTime: number, metadata?: Record<string, any>): void {\r\n    const endTime = performance.now();\r\n    const duration = endTime - startTime;\r\n    \r\n    this.trackEvent({\r\n      type: 'load_complete',\r\n      timestamp: Date.now(),\r\n      metadata: {\r\n        performanceName: name,\r\n        duration,\r\n        ...metadata\r\n      },\r\n      performance: {\r\n        loadTime: duration,\r\n        memoryUsage: this.getMemoryUsage()\r\n      }\r\n    });\r\n  }\r\n\r\n  trackError(error: Error, context: string, metadata?: Record<string, any>): void {\r\n    this.trackEvent({\r\n      type: 'load_error',\r\n      timestamp: Date.now(),\r\n      metadata: {\r\n        error: error.message,\r\n        stack: error.stack,\r\n        context,\r\n        ...metadata\r\n      }\r\n    });\r\n  }\r\n\r\n  private async flushEventQueue(): Promise<void> {\r\n    if (this.eventQueue.length === 0 || !this.config.telemetryEndpoint) return;\r\n\r\n    const events = [...this.eventQueue];\r\n    this.eventQueue = [];\r\n\r\n    try {\r\n      await fetch(this.config.telemetryEndpoint, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          events,\r\n          timestamp: Date.now(),\r\n          version: this.config.readerVersion\r\n        })\r\n      });\r\n      \r\n      console.log(`ðŸ“Š Flushed ${events.length} telemetry events`);\r\n    } catch (error) {\r\n      // Put events back in queue if send failed\r\n      this.eventQueue.unshift(...events);\r\n      console.warn('ðŸ“Š Failed to send telemetry events:', error);\r\n    }\r\n  }\r\n\r\n  private generateSessionId(): string {\r\n    return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  private getMemoryUsage(): number | undefined {\r\n    if ('memory' in performance) {\r\n      const memory = (performance as any).memory;\r\n      return memory.usedJSHeapSize;\r\n    }\r\n    return undefined;\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\EnhancedEPUBStreamingLoader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[552,555],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[552,555],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[933,936],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[933,936],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":130,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3915,3918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3915,3918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * Enhanced EPUB Streaming Loader\r\n * Implements metadata-first loading and chapter-level streaming\r\n */\r\n\r\nimport { EPUBMetadataExtractor } from './epub/EPUBMetadataExtractor';\r\nimport { EPUBInstanceCreator } from './epub/EPUBInstanceCreator';\r\nimport { EPUBChapterManager } from './epub/EPUBChapterManager';\r\nimport {\r\n  EPUBStreamingProgress,\r\n  EPUBStreamingError,\r\n  EPUBMetadata\r\n} from './epub/EPUBStreamingTypes';\r\n\r\nclass EnhancedEPUBStreamingLoader {\r\n  private abortController: AbortController | null = null;\r\n  private epubInstance: any = null;\r\n  private metadata: EPUBMetadata | null = null;\r\n  private chapterManager: EPUBChapterManager | null = null;\r\n\r\n  constructor(\r\n    private onProgress?: (progress: EPUBStreamingProgress) => void,\r\n    private onError?: (error: EPUBStreamingError) => void\r\n  ) {}\r\n\r\n  async loadEPUB(url: string, cacheKey: string): Promise<{\r\n    success: boolean;\r\n    epubInstance?: any;\r\n    metadata?: EPUBMetadata;\r\n    error?: EPUBStreamingError;\r\n  }> {\r\n    try {\r\n      this.abortController = new AbortController();\r\n      \r\n      this.onProgress?.({\r\n        stage: 'metadata',\r\n        percentage: 5,\r\n        message: 'Loading EPUB metadata...'\r\n      });\r\n\r\n      // Step 1: Load metadata first\r\n      const metadataResult = await EPUBMetadataExtractor.extractMetadata(url, cacheKey);\r\n      if (!metadataResult.success) {\r\n        return { success: false, error: metadataResult.error };\r\n      }\r\n\r\n      this.metadata = metadataResult.metadata!;\r\n\r\n      this.onProgress?.({\r\n        stage: 'structure',\r\n        percentage: 25,\r\n        message: 'Creating EPUB structure...',\r\n        totalChapters: this.metadata.spine.length\r\n      });\r\n\r\n      // Step 2: Create EPUB instance with streaming configuration\r\n      const epubResult = await EPUBInstanceCreator.createStreamingEPUB(\r\n        url,\r\n        this.abortController,\r\n        (percentage, message) => {\r\n          this.onProgress?.({\r\n            stage: 'structure',\r\n            percentage,\r\n            message\r\n          });\r\n        }\r\n      );\r\n\r\n      if (!epubResult.success) {\r\n        return { success: false, error: epubResult.error };\r\n      }\r\n\r\n      this.epubInstance = epubResult.epubInstance;\r\n      this.chapterManager = new EPUBChapterManager(this.epubInstance, this.metadata);\r\n\r\n      // Step 3: Preload initial chapters\r\n      await this.preloadInitialChapters();\r\n\r\n      this.onProgress?.({\r\n        stage: 'ready',\r\n        percentage: 100,\r\n        message: 'EPUB ready with streaming support',\r\n        totalChapters: this.metadata.spine.length,\r\n        chaptersLoaded: this.chapterManager.getStats().preloadedChapters\r\n      });\r\n\r\n      console.log('âœ… EPUB loaded with enhanced streaming');\r\n      return { \r\n        success: true, \r\n        epubInstance: this.epubInstance,\r\n        metadata: this.metadata \r\n      };\r\n\r\n    } catch (error) {\r\n      const streamingError: EPUBStreamingError = {\r\n        type: 'unknown',\r\n        message: error instanceof Error ? error.message : 'Unknown streaming error',\r\n        recoverable: true,\r\n        retryCount: 0,\r\n        context: 'main_load'\r\n      };\r\n\r\n      this.onError?.(streamingError);\r\n      return { success: false, error: streamingError };\r\n    }\r\n  }\r\n\r\n  private async preloadInitialChapters(): Promise<void> {\r\n    if (!this.metadata || !this.chapterManager) return;\r\n\r\n    this.onProgress?.({\r\n      stage: 'preloading',\r\n      percentage: 60,\r\n      message: 'Preloading initial chapters...',\r\n      totalChapters: this.metadata.spine.length\r\n    });\r\n\r\n    await this.chapterManager.preloadInitialChapters((loaded, total) => {\r\n      this.onProgress?.({\r\n        stage: 'preloading',\r\n        percentage: 85,\r\n        message: `Preloaded ${loaded} chapters`,\r\n        chaptersLoaded: loaded,\r\n        totalChapters: total\r\n      });\r\n    });\r\n  }\r\n\r\n  async getChapterContent(href: string): Promise<any> {\r\n    if (!this.chapterManager) {\r\n      throw new Error('Chapter manager not initialized');\r\n    }\r\n    return await this.chapterManager.getChapterContent(href);\r\n  }\r\n\r\n  async preloadNextChapters(currentChapterIndex: number): Promise<void> {\r\n    if (this.chapterManager) {\r\n      await this.chapterManager.preloadNextChapters(currentChapterIndex);\r\n    }\r\n  }\r\n\r\n  updateReadingPosition(chapterIndex: number, readingSpeed?: number): void {\r\n    if (this.chapterManager) {\r\n      this.chapterManager.updateReadingPosition(chapterIndex, readingSpeed);\r\n    }\r\n  }\r\n\r\n  abort(): void {\r\n    if (this.abortController) {\r\n      this.abortController.abort();\r\n      this.abortController = null;\r\n    }\r\n\r\n    if (this.chapterManager) {\r\n      this.chapterManager.cleanup();\r\n      this.chapterManager = null;\r\n    }\r\n\r\n    if (this.epubInstance && typeof this.epubInstance.destroy === 'function') {\r\n      this.epubInstance.destroy();\r\n      this.epubInstance = null;\r\n    }\r\n  }\r\n\r\n  getStreamingStats() {\r\n    const chapterStats = this.chapterManager?.getStats() || {\r\n      preloadedChapters: 0,\r\n      queuedChapters: 0,\r\n      currentPosition: 0,\r\n      readingSpeed: 250,\r\n      preloadDistance: 3\r\n    };\r\n\r\n    return {\r\n      ...chapterStats,\r\n      metadata: this.metadata\r\n    };\r\n  }\r\n}\r\n\r\nexport { EnhancedEPUBStreamingLoader };\r\nexport type {\r\n  EPUBStreamingProgress,\r\n  EPUBStreamingError,\r\n  EPUBMetadata\r\n} from './epub/EPUBStreamingTypes';\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\FeatureFlagService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\IndexedDBCacheService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[155,158],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[155,158],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2366,2369],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2366,2369],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3507,3510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3507,3510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":319,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":319,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9328,9331],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9328,9331],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * IndexedDB Cache Service\r\n * Provides smart caching for book metadata, covers, and content\r\n */\r\n\r\ninterface CacheEntry {\r\n  id: string;\r\n  data: any;\r\n  timestamp: number;\r\n  lastAccessed: number;\r\n  size: number;\r\n  type: 'metadata' | 'cover' | 'content' | 'toc';\r\n}\r\n\r\ninterface CacheStats {\r\n  totalSize: number;\r\n  entryCount: number;\r\n  hitRate: number;\r\n  lastCleanup: number;\r\n}\r\n\r\nclass IndexedDBCacheService {\r\n  private dbName = 'BookCacheDB';\r\n  private version = 1;\r\n  private db: IDBDatabase | null = null;\r\n  private isInitialized = false;\r\n  private maxCacheSize = 100 * 1024 * 1024; // 100MB\r\n  private maxEntryAge = 7 * 24 * 60 * 60 * 1000; // 7 days\r\n  private stats: CacheStats = {\r\n    totalSize: 0,\r\n    entryCount: 0,\r\n    hitRate: 0,\r\n    lastCleanup: 0\r\n  };\r\n\r\n  async initialize(): Promise<boolean> {\r\n    if (this.isInitialized) return true;\r\n\r\n    try {\r\n      console.log('ðŸ—„ï¸ Initializing IndexedDB cache service...');\r\n      \r\n      this.db = await this.openDatabase();\r\n      await this.loadStats();\r\n      await this.performMaintenanceIfNeeded();\r\n      \r\n      this.isInitialized = true;\r\n      console.log('âœ… IndexedDB cache service initialized');\r\n      return true;\r\n    } catch (error) {\r\n      console.error('âŒ Failed to initialize IndexedDB cache:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private openDatabase(): Promise<IDBDatabase> {\r\n    return new Promise((resolve, reject) => {\r\n      const request = indexedDB.open(this.dbName, this.version);\r\n      \r\n      request.onerror = () => reject(request.error);\r\n      request.onsuccess = () => resolve(request.result);\r\n      \r\n      request.onupgradeneeded = (event) => {\r\n        const db = (event.target as IDBOpenDBRequest).result;\r\n        \r\n        // Create object stores\r\n        if (!db.objectStoreNames.contains('cache')) {\r\n          const cacheStore = db.createObjectStore('cache', { keyPath: 'id' });\r\n          cacheStore.createIndex('type', 'type', { unique: false });\r\n          cacheStore.createIndex('timestamp', 'timestamp', { unique: false });\r\n          cacheStore.createIndex('lastAccessed', 'lastAccessed', { unique: false });\r\n        }\r\n        \r\n        if (!db.objectStoreNames.contains('stats')) {\r\n          db.createObjectStore('stats', { keyPath: 'id' });\r\n        }\r\n      };\r\n    });\r\n  }\r\n\r\n  async get(key: string): Promise<any | null> {\r\n    if (!this.isInitialized || !this.db) return null;\r\n\r\n    try {\r\n      const transaction = this.db.transaction(['cache'], 'readwrite');\r\n      const store = transaction.objectStore('cache');\r\n      const request = store.get(key);\r\n\r\n      return new Promise((resolve) => {\r\n        request.onsuccess = async () => {\r\n          const entry: CacheEntry | undefined = request.result;\r\n          \r\n          if (!entry) {\r\n            resolve(null);\r\n            return;\r\n          }\r\n\r\n          // Check if entry is expired\r\n          const now = Date.now();\r\n          if (now - entry.timestamp > this.maxEntryAge) {\r\n            await this.delete(key);\r\n            resolve(null);\r\n            return;\r\n          }\r\n\r\n          // Update last accessed time\r\n          entry.lastAccessed = now;\r\n          store.put(entry);\r\n\r\n          console.log(`ðŸŽ¯ Cache hit for key: ${key}`);\r\n          resolve(entry.data);\r\n        };\r\n\r\n        request.onerror = () => resolve(null);\r\n      });\r\n    } catch (error) {\r\n      console.warn('Cache get error:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async set(key: string, data: any, type: CacheEntry['type'] = 'content'): Promise<boolean> {\r\n    if (!this.isInitialized || !this.db) return false;\r\n\r\n    try {\r\n      const size = this.calculateSize(data);\r\n      \r\n      // Check if we need to make space\r\n      if (this.stats.totalSize + size > this.maxCacheSize) {\r\n        await this.evictOldEntries(size);\r\n      }\r\n\r\n      const entry: CacheEntry = {\r\n        id: key,\r\n        data,\r\n        timestamp: Date.now(),\r\n        lastAccessed: Date.now(),\r\n        size,\r\n        type\r\n      };\r\n\r\n      const transaction = this.db.transaction(['cache'], 'readwrite');\r\n      const store = transaction.objectStore('cache');\r\n      \r\n      return new Promise((resolve) => {\r\n        const request = store.put(entry);\r\n        \r\n        request.onsuccess = () => {\r\n          this.stats.totalSize += size;\r\n          this.stats.entryCount++;\r\n          console.log(`ðŸ’¾ Cached ${type} for key: ${key} (${this.formatSize(size)})`);\r\n          resolve(true);\r\n        };\r\n\r\n        request.onerror = () => resolve(false);\r\n      });\r\n    } catch (error) {\r\n      console.warn('Cache set error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async delete(key: string): Promise<boolean> {\r\n    if (!this.isInitialized || !this.db) return false;\r\n\r\n    try {\r\n      const transaction = this.db.transaction(['cache'], 'readwrite');\r\n      const store = transaction.objectStore('cache');\r\n      \r\n      // Get entry size first\r\n      const getRequest = store.get(key);\r\n      \r\n      return new Promise((resolve) => {\r\n        getRequest.onsuccess = () => {\r\n          const entry: CacheEntry | undefined = getRequest.result;\r\n          \r\n          const deleteRequest = store.delete(key);\r\n          \r\n          deleteRequest.onsuccess = () => {\r\n            if (entry) {\r\n              this.stats.totalSize -= entry.size;\r\n              this.stats.entryCount--;\r\n            }\r\n            console.log(`ðŸ—‘ï¸ Deleted cache entry: ${key}`);\r\n            resolve(true);\r\n          };\r\n\r\n          deleteRequest.onerror = () => resolve(false);\r\n        };\r\n\r\n        getRequest.onerror = () => resolve(false);\r\n      });\r\n    } catch (error) {\r\n      console.warn('Cache delete error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async clear(): Promise<boolean> {\r\n    if (!this.isInitialized || !this.db) return false;\r\n\r\n    try {\r\n      const transaction = this.db.transaction(['cache'], 'readwrite');\r\n      const store = transaction.objectStore('cache');\r\n      \r\n      return new Promise((resolve) => {\r\n        const request = store.clear();\r\n        \r\n        request.onsuccess = () => {\r\n          this.stats.totalSize = 0;\r\n          this.stats.entryCount = 0;\r\n          console.log('ðŸ§¹ Cache cleared');\r\n          resolve(true);\r\n        };\r\n\r\n        request.onerror = () => resolve(false);\r\n      });\r\n    } catch (error) {\r\n      console.warn('Cache clear error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private async evictOldEntries(spaceNeeded: number): Promise<void> {\r\n    if (!this.db) return;\r\n\r\n    console.log('ðŸ§¹ Evicting old cache entries...');\r\n\r\n    const transaction = this.db.transaction(['cache'], 'readwrite');\r\n    const store = transaction.objectStore('cache');\r\n    const index = store.index('lastAccessed');\r\n    \r\n    const request = index.openCursor();\r\n    let freedSpace = 0;\r\n\r\n    return new Promise((resolve) => {\r\n      request.onsuccess = (event) => {\r\n        const cursor = (event.target as IDBRequest).result;\r\n        \r\n        if (cursor && freedSpace < spaceNeeded) {\r\n          const entry: CacheEntry = cursor.value;\r\n          \r\n          // Delete old or large entries first\r\n          const age = Date.now() - entry.lastAccessed;\r\n          if (age > this.maxEntryAge / 2 || entry.size > 5 * 1024 * 1024) {\r\n            cursor.delete();\r\n            freedSpace += entry.size;\r\n            this.stats.totalSize -= entry.size;\r\n            this.stats.entryCount--;\r\n          }\r\n          \r\n          cursor.continue();\r\n        } else {\r\n          console.log(`âœ… Freed ${this.formatSize(freedSpace)} of cache space`);\r\n          resolve();\r\n        }\r\n      };\r\n\r\n      request.onerror = () => resolve();\r\n    });\r\n  }\r\n\r\n  private async loadStats(): Promise<void> {\r\n    if (!this.db) return;\r\n\r\n    try {\r\n      const transaction = this.db.transaction(['stats'], 'readonly');\r\n      const store = transaction.objectStore('stats');\r\n      const request = store.get('main');\r\n\r\n      return new Promise((resolve) => {\r\n        request.onsuccess = () => {\r\n          if (request.result) {\r\n            this.stats = { ...this.stats, ...request.result.data };\r\n          }\r\n          resolve();\r\n        };\r\n\r\n        request.onerror = () => resolve();\r\n      });\r\n    } catch (error) {\r\n      console.warn('Failed to load cache stats:', error);\r\n    }\r\n  }\r\n\r\n  private async saveStats(): Promise<void> {\r\n    if (!this.db) return;\r\n\r\n    try {\r\n      const transaction = this.db.transaction(['stats'], 'readwrite');\r\n      const store = transaction.objectStore('stats');\r\n      \r\n      store.put({\r\n        id: 'main',\r\n        data: this.stats,\r\n        updated: Date.now()\r\n      });\r\n    } catch (error) {\r\n      console.warn('Failed to save cache stats:', error);\r\n    }\r\n  }\r\n\r\n  private async performMaintenanceIfNeeded(): Promise<void> {\r\n    const now = Date.now();\r\n    const timeSinceLastCleanup = now - this.stats.lastCleanup;\r\n    \r\n    // Perform maintenance every 24 hours\r\n    if (timeSinceLastCleanup > 24 * 60 * 60 * 1000) {\r\n      console.log('ðŸ”§ Performing cache maintenance...');\r\n      \r\n      await this.evictOldEntries(0); // Clean up expired entries\r\n      this.stats.lastCleanup = now;\r\n      await this.saveStats();\r\n      \r\n      console.log('âœ… Cache maintenance completed');\r\n    }\r\n  }\r\n\r\n  private calculateSize(data: any): number {\r\n    try {\r\n      return new Blob([JSON.stringify(data)]).size;\r\n    } catch {\r\n      return 1024; // Default 1KB if calculation fails\r\n    }\r\n  }\r\n\r\n  private formatSize(bytes: number): string {\r\n    const units = ['B', 'KB', 'MB', 'GB'];\r\n    let size = bytes;\r\n    let unitIndex = 0;\r\n    \r\n    while (size >= 1024 && unitIndex < units.length - 1) {\r\n      size /= 1024;\r\n      unitIndex++;\r\n    }\r\n    \r\n    return `${size.toFixed(1)} ${units[unitIndex]}`;\r\n  }\r\n\r\n  getStats(): CacheStats {\r\n    return { ...this.stats };\r\n  }\r\n\r\n  async getCachedKeys(type?: CacheEntry['type']): Promise<string[]> {\r\n    if (!this.isInitialized || !this.db) return [];\r\n\r\n    try {\r\n      const transaction = this.db.transaction(['cache'], 'readonly');\r\n      const store = transaction.objectStore('cache');\r\n      \r\n      let request: IDBRequest;\r\n      if (type) {\r\n        const index = store.index('type');\r\n        request = index.getAllKeys(type);\r\n      } else {\r\n        request = store.getAllKeys();\r\n      }\r\n\r\n      return new Promise((resolve) => {\r\n        request.onsuccess = () => resolve(request.result as string[]);\r\n        request.onerror = () => resolve([]);\r\n      });\r\n    } catch (error) {\r\n      console.warn('Failed to get cached keys:', error);\r\n      return [];\r\n    }\r\n  }\r\n}\r\n\r\n// Global instance\r\nexport const indexedDBCache = new IndexedDBCacheService();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\MuseumService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\NASAService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\PerformanceOptimizationService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4989,4992],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4989,4992],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":143,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5386,5389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5386,5389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":147,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5519,5522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5519,5522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":151,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5675,5678],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5675,5678],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * Performance Optimization Service\r\n * Refactored into smaller, focused components\r\n */\r\n\r\nimport { indexedDBCache } from './IndexedDBCacheService';\r\nimport { CacheConfigManager, CacheConfig, PrefetchConfig } from './performance/CacheConfigManager';\r\nimport { PrefetchManager } from './performance/PrefetchManager';\r\nimport { PerformanceMetricsTracker, PerformanceMetrics } from './performance/PerformanceMetricsTracker';\r\nimport { ImageOptimizer } from './performance/ImageOptimizer';\r\nimport { sloMonitoringService } from './monitoring/SLOMonitoringService';\r\n\r\nclass PerformanceOptimizationService {\r\n  private cacheConfigManager = new CacheConfigManager();\r\n  private prefetchManager = new PrefetchManager();\r\n  private metricsTracker = new PerformanceMetricsTracker();\r\n  private imageOptimizer = new ImageOptimizer();\r\n\r\n  constructor() {\r\n    this.initializePerformance();\r\n  }\r\n\r\n  /**\r\n   * Initialize performance optimizations with IndexedDB support\r\n   */\r\n  private async initializePerformance(): Promise<void> {\r\n    console.log('ðŸš€ Initializing enhanced performance service...');\r\n\r\n    // Initialize IndexedDB cache\r\n    const cacheReady = await indexedDBCache.initialize();\r\n    if (!cacheReady) {\r\n      console.warn('âš ï¸ IndexedDB cache initialization failed, using memory cache only');\r\n    }\r\n\r\n    this.cacheConfigManager.initializePreconnections();\r\n    this.setupEnhancedCacheHeaders();\r\n    await this.metricsTracker.loadPerformanceMetrics();\r\n\r\n    console.log('âœ… Enhanced performance service initialized with monitoring');\r\n  }\r\n\r\n  /**\r\n   * Setup enhanced cache headers with IndexedDB integration\r\n   */\r\n  private setupEnhancedCacheHeaders(): void {\r\n    const originalFetch = window.fetch;\r\n    const cacheConfig = this.cacheConfigManager.getCacheConfig();\r\n    const prefetchConfig = this.cacheConfigManager.getPrefetchConfig();\r\n    \r\n    window.fetch = async (input, init = {}) => {\r\n      const url = typeof input === 'string' ? input : (input instanceof Request ? input.url : input.href);\r\n      \r\n      // Check IndexedDB cache first for book assets\r\n      if (this.cacheConfigManager.isBookAsset(url)) {\r\n        const cacheKey = this.cacheConfigManager.generateCacheKey(url);\r\n        const cached = await indexedDBCache.get(cacheKey);\r\n        \r\n        if (cached) {\r\n          console.log('ðŸŽ¯ IndexedDB cache hit for:', url.substring(0, 50) + '...');\r\n          this.metricsTracker.incrementCacheHit();\r\n          \r\n          // Return cached response\r\n          return new Response(cached.data, {\r\n            status: 200,\r\n            headers: cached.headers || {}\r\n          });\r\n        }\r\n      }\r\n\r\n      // Add enhanced cache headers\r\n      init.headers = {\r\n        ...init.headers,\r\n        'Cache-Control': `public, max-age=${cacheConfig.maxAge}, stale-while-revalidate=${cacheConfig.staleWhileRevalidate}`,\r\n        'X-Performance-Optimized': 'true',\r\n        'X-Streaming-Supported': prefetchConfig.streamingEnabled ? 'true' : 'false'\r\n      };\r\n\r\n      this.metricsTracker.incrementNetworkRequest();\r\n      const startTime = performance.now();\r\n\r\n      try {\r\n        const response = await originalFetch(input, init);\r\n        \r\n        // Cache successful responses in IndexedDB\r\n        if (response.ok && this.cacheConfigManager.isBookAsset(url)) {\r\n          const cacheKey = this.cacheConfigManager.generateCacheKey(url);\r\n          const responseClone = response.clone();\r\n          \r\n          // Cache response data\r\n          const data = await responseClone.arrayBuffer();\r\n          await indexedDBCache.set(cacheKey, {\r\n            data,\r\n            headers: Object.fromEntries(response.headers.entries()),\r\n            cachedAt: Date.now()\r\n          }, 'content');\r\n          \r\n          this.metricsTracker.addBytesSaved(data.byteLength);\r\n        }\r\n\r\n        const loadTime = performance.now() - startTime;\r\n        this.metricsTracker.updateAverageLoadTime(loadTime);\r\n\r\n        // Track performance metrics for monitoring\r\n        if (url.includes('.epub') || url.includes('.pdf')) {\r\n          sloMonitoringService['webVitalsTracker'].recordCustomMetric('document_load_time', loadTime);\r\n        }\r\n\r\n        return response;\r\n      } catch (error) {\r\n        console.warn('Fetch failed, checking cache fallback:', error);\r\n        \r\n        // Try cache fallback for critical resources\r\n        if (this.cacheConfigManager.isBookAsset(url)) {\r\n          const cacheKey = this.cacheConfigManager.generateCacheKey(url);\r\n          const cached = await indexedDBCache.get(cacheKey);\r\n          \r\n          if (cached) {\r\n            console.log('ðŸ”„ Using cache fallback for:', url.substring(0, 50) + '...');\r\n            return new Response(cached.data, {\r\n              status: 200,\r\n              headers: cached.headers || {}\r\n            });\r\n          }\r\n        }\r\n        \r\n        throw error;\r\n      }\r\n    };\r\n  }\r\n\r\n  // Delegate methods to component managers\r\n  async prefetchPopularBooks(books: any[]): Promise<void> {\r\n    const prefetchConfig = this.cacheConfigManager.getPrefetchConfig();\r\n    const successRate = await this.prefetchManager.prefetchPopularBooks(\r\n      books, \r\n      prefetchConfig.popularBooksCount, \r\n      prefetchConfig.streamingEnabled\r\n    );\r\n    this.metricsTracker.setStreamingSuccessRate(successRate);\r\n  }\r\n\r\n  async getPrefetchedBook(bookId: string): Promise<any | null> {\r\n    return this.prefetchManager.getPrefetchedBook(bookId);\r\n  }\r\n\r\n  async cacheSearchResults(query: string, results: any[]): Promise<void> {\r\n    return this.prefetchManager.cacheSearchResults(query, results);\r\n  }\r\n\r\n  async getCachedSearchResults(query: string): Promise<any | null> {\r\n    return this.prefetchManager.getCachedSearchResults(query);\r\n  }\r\n\r\n  async prefetchSearchResults(queries: string[]): Promise<void> {\r\n    return this.prefetchManager.prefetchSearchResults(queries);\r\n  }\r\n\r\n  optimizeImageLoading(img: HTMLImageElement, src: string): void {\r\n    this.imageOptimizer.optimizeImageLoading(img, src);\r\n  }\r\n\r\n  async preloadCriticalResources(): Promise<void> {\r\n    return this.imageOptimizer.preloadCriticalResources();\r\n  }\r\n\r\n  /**\r\n   * Get enhanced performance metrics with monitoring data\r\n   */\r\n  async getMetrics() {\r\n    const cacheStats = indexedDBCache.getStats();\r\n    const prefetchStats = this.prefetchManager.getPrefetchStats();\r\n    const performanceMetrics = this.metricsTracker.getMetrics();\r\n    const cacheConfig = this.cacheConfigManager.getCacheConfig();\r\n    const prefetchConfig = this.cacheConfigManager.getPrefetchConfig();\r\n    const monitoringData = sloMonitoringService.getDashboardData();\r\n    \r\n    return {\r\n      ...prefetchStats,\r\n      preconnectDomains: this.cacheConfigManager.getPreconnectDomains().length,\r\n      indexedDBStats: cacheStats,\r\n      performance: performanceMetrics,\r\n      config: {\r\n        prefetch: prefetchConfig,\r\n        cache: cacheConfig\r\n      },\r\n      streamingEnabled: prefetchConfig.streamingEnabled,\r\n      monitoring: {\r\n        sloStatus: monitoringData.sloStatus,\r\n        webVitals: monitoringData.webVitals,\r\n        alerts: monitoringData.alerts\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clear all caches\r\n   */\r\n  async clearCaches(): Promise<void> {\r\n    this.prefetchManager.clearCaches();\r\n    await indexedDBCache.clear();\r\n    this.metricsTracker.resetMetrics();\r\n    \r\n    console.log('ðŸ§¹ All caches cleared');\r\n  }\r\n}\r\n\r\n// Global instance\r\nexport const performanceService = new PerformanceOptimizationService();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\QuoteService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\SearchIndexService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\StreamingPDFLoader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1154,1157],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1154,1157],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1456,1459],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1456,1459],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":118,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3692,3695],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3692,3695],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":159,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5001,5004],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5001,5004],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":205,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":205,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6478,6481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6478,6481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":289,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":289,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8912,8915],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8912,8915],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":319,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":319,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10021,10024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10021,10024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * Streaming PDF Loader with Byte-Range Requests\r\n * Implements progressive PDF loading for better performance\r\n */\r\n\r\nimport { indexedDBCache } from './IndexedDBCacheService';\r\n\r\nexport interface PDFStreamingProgress {\r\n  stage: 'initializing' | 'downloading' | 'processing' | 'ready';\r\n  percentage: number;\r\n  message: string;\r\n  bytesLoaded?: number;\r\n  totalBytes?: number;\r\n  pagesLoaded?: number;\r\n  totalPages?: number;\r\n  chunkSize?: number;\r\n}\r\n\r\nexport interface PDFStreamingError {\r\n  type: 'network' | 'timeout' | 'parsing' | 'range_not_supported' | 'unknown';\r\n  message: string;\r\n  recoverable: boolean;\r\n  retryCount: number;\r\n}\r\n\r\nclass StreamingPDFLoader {\r\n  private abortController: AbortController | null = null;\r\n  private chunkSize = 256 * 1024; // 256KB default chunk size\r\n  private maxChunkSize = 2 * 1024 * 1024; // 2MB max chunk size\r\n  private minChunkSize = 64 * 1024; // 64KB min chunk size\r\n  private connectionSpeed: 'slow' | 'medium' | 'fast' = 'medium';\r\n  private rangeSupported = false;\r\n  private totalSize = 0;\r\n  private loadedChunks = new Map<number, ArrayBuffer>();\r\n  private pageCache = new Map<number, any>();\r\n\r\n  constructor(\r\n    private onProgress?: (progress: PDFStreamingProgress) => void,\r\n    private onError?: (error: PDFStreamingError) => void\r\n  ) {\r\n    this.detectConnectionSpeed();\r\n  }\r\n\r\n  async loadPDF(url: string, cacheKey: string): Promise<{\r\n    success: boolean;\r\n    pdfDocument?: any;\r\n    error?: PDFStreamingError;\r\n  }> {\r\n    try {\r\n      this.abortController = new AbortController();\r\n      \r\n      // Check cache first\r\n      const cachedPDF = await indexedDBCache.get(`pdf:${cacheKey}`);\r\n      if (cachedPDF) {\r\n        console.log('ðŸ“„ Using cached PDF:', cacheKey);\r\n        this.onProgress?.({\r\n          stage: 'ready',\r\n          percentage: 100,\r\n          message: 'PDF loaded from cache'\r\n        });\r\n        return { success: true, pdfDocument: cachedPDF };\r\n      }\r\n\r\n      this.onProgress?.({\r\n        stage: 'initializing',\r\n        percentage: 5,\r\n        message: 'Checking PDF streaming capabilities...'\r\n      });\r\n\r\n      // Test range request support\r\n      await this.testRangeSupport(url);\r\n      \r\n      if (this.rangeSupported) {\r\n        return await this.loadWithStreaming(url, cacheKey);\r\n      } else {\r\n        return await this.loadTraditional(url, cacheKey);\r\n      }\r\n\r\n    } catch (error) {\r\n      const streamingError: PDFStreamingError = {\r\n        type: 'unknown',\r\n        message: error instanceof Error ? error.message : 'Unknown streaming error',\r\n        recoverable: true,\r\n        retryCount: 0\r\n      };\r\n\r\n      this.onError?.(streamingError);\r\n      return { success: false, error: streamingError };\r\n    }\r\n  }\r\n\r\n  private async testRangeSupport(url: string): Promise<void> {\r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'HEAD',\r\n        signal: this.abortController?.signal,\r\n        headers: { 'Range': 'bytes=0-1' }\r\n      });\r\n\r\n      this.rangeSupported = response.status === 206 || response.headers.get('Accept-Ranges') === 'bytes';\r\n      this.totalSize = parseInt(response.headers.get('Content-Length') || '0', 10);\r\n      \r\n      console.log('ðŸ“„ PDF Range support:', this.rangeSupported ? 'YES' : 'NO');\r\n      console.log('ðŸ“„ PDF Total size:', this.formatSize(this.totalSize));\r\n\r\n      // Adjust chunk size based on file size and connection\r\n      this.adjustChunkSize();\r\n\r\n    } catch (error) {\r\n      console.warn('Range support test failed:', error);\r\n      this.rangeSupported = false;\r\n    }\r\n  }\r\n\r\n  private async loadWithStreaming(url: string, cacheKey: string): Promise<{\r\n    success: boolean;\r\n    pdfDocument?: any;\r\n    error?: PDFStreamingError;\r\n  }> {\r\n    try {\r\n      this.onProgress?.({\r\n        stage: 'downloading',\r\n        percentage: 10,\r\n        message: 'Starting progressive PDF download...',\r\n        chunkSize: this.chunkSize\r\n      });\r\n\r\n      // Load initial chunk to get PDF structure\r\n      const initialChunk = await this.loadChunk(url, 0, this.chunkSize);\r\n      this.loadedChunks.set(0, initialChunk);\r\n\r\n      this.onProgress?.({\r\n        stage: 'processing',\r\n        percentage: 25,\r\n        message: 'Processing PDF structure...',\r\n        bytesLoaded: this.chunkSize,\r\n        totalBytes: this.totalSize\r\n      });\r\n\r\n      // Initialize PDF.js with streaming capability\r\n      const pdfjsLib = await import('pdfjs-dist');\r\n      \r\n      // Create custom loading task with streaming\r\n      const loadingTask = pdfjsLib.getDocument({\r\n        data: initialChunk,\r\n        httpHeaders: {},\r\n        withCredentials: false,\r\n        cMapUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@4.8.69/cmaps/`,\r\n        cMapPacked: true,\r\n        enableXfa: false,\r\n        // Custom range reader for streaming\r\n        rangeChunkSize: this.chunkSize,\r\n        disableRange: false,\r\n        disableStream: false\r\n      });\r\n\r\n      // Set up progressive loading\r\n      loadingTask.onProgress = (progress: any) => {\r\n        const percentage = Math.min(90, 25 + (progress.loaded / progress.total) * 65);\r\n        this.onProgress?.({\r\n          stage: 'processing',\r\n          percentage,\r\n          message: `Loading PDF... ${Math.round(percentage)}%`,\r\n          bytesLoaded: progress.loaded,\r\n          totalBytes: progress.total\r\n        });\r\n      };\r\n\r\n      const pdfDocument = await loadingTask.promise;\r\n\r\n      // Cache the PDF structure\r\n      await indexedDBCache.set(`pdf:${cacheKey}`, {\r\n        numPages: pdfDocument.numPages,\r\n        fingerprint: pdfDocument.fingerprints?.[0],\r\n        loadedAt: Date.now()\r\n      }, 'metadata');\r\n\r\n      this.onProgress?.({\r\n        stage: 'ready',\r\n        percentage: 100,\r\n        message: 'PDF ready with streaming support',\r\n        totalPages: pdfDocument.numPages\r\n      });\r\n\r\n      console.log('âœ… PDF loaded with streaming support');\r\n      return { success: true, pdfDocument };\r\n\r\n    } catch (error) {\r\n      console.error('âŒ Streaming PDF load failed:', error);\r\n      \r\n      const streamingError: PDFStreamingError = {\r\n        type: error.message?.includes('range') ? 'range_not_supported' : 'parsing',\r\n        message: `Streaming load failed: ${error.message}`,\r\n        recoverable: true,\r\n        retryCount: 0\r\n      };\r\n\r\n      return { success: false, error: streamingError };\r\n    }\r\n  }\r\n\r\n  private async loadTraditional(url: string, cacheKey: string): Promise<{\r\n    success: boolean;\r\n    pdfDocument?: any;\r\n    error?: PDFStreamingError;\r\n  }> {\r\n    try {\r\n      this.onProgress?.({\r\n        stage: 'downloading',\r\n        percentage: 10,\r\n        message: 'Downloading PDF (traditional method)...'\r\n      });\r\n\r\n      const response = await fetch(url, {\r\n        signal: this.abortController?.signal\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const arrayBuffer = await response.arrayBuffer();\r\n\r\n      this.onProgress?.({\r\n        stage: 'processing',\r\n        percentage: 60,\r\n        message: 'Processing PDF document...',\r\n        bytesLoaded: arrayBuffer.byteLength,\r\n        totalBytes: arrayBuffer.byteLength\r\n      });\r\n\r\n      const pdfjsLib = await import('pdfjs-dist');\r\n      const pdfDocument = await pdfjsLib.getDocument({\r\n        data: arrayBuffer,\r\n        cMapUrl: `https://cdn.jsdelivr.net/npm/pdfjs-dist@4.8.69/cmaps/`,\r\n        cMapPacked: true\r\n      }).promise;\r\n\r\n      // Cache the PDF\r\n      await indexedDBCache.set(`pdf:${cacheKey}`, {\r\n        data: arrayBuffer,\r\n        numPages: pdfDocument.numPages,\r\n        fingerprint: pdfDocument.fingerprints?.[0],\r\n        loadedAt: Date.now()\r\n      }, 'content');\r\n\r\n      this.onProgress?.({\r\n        stage: 'ready',\r\n        percentage: 100,\r\n        message: 'PDF ready',\r\n        totalPages: pdfDocument.numPages\r\n      });\r\n\r\n      return { success: true, pdfDocument };\r\n\r\n    } catch (error) {\r\n      const streamingError: PDFStreamingError = {\r\n        type: error.name === 'AbortError' ? 'timeout' : 'network',\r\n        message: `Traditional load failed: ${error.message}`,\r\n        recoverable: true,\r\n        retryCount: 0\r\n      };\r\n\r\n      return { success: false, error: streamingError };\r\n    }\r\n  }\r\n\r\n  private async loadChunk(url: string, start: number, size: number): Promise<ArrayBuffer> {\r\n    const end = Math.min(start + size - 1, this.totalSize - 1);\r\n    \r\n    const response = await fetch(url, {\r\n      headers: {\r\n        'Range': `bytes=${start}-${end}`\r\n      },\r\n      signal: this.abortController?.signal\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to load chunk: ${response.status}`);\r\n    }\r\n\r\n    return await response.arrayBuffer();\r\n  }\r\n\r\n  private detectConnectionSpeed(): void {\r\n    // Use Network Information API if available\r\n    if ('connection' in navigator) {\r\n      const connection = (navigator as any).connection;\r\n      const effectiveType = connection?.effectiveType;\r\n      \r\n      if (effectiveType === 'slow-2g' || effectiveType === '2g') {\r\n        this.connectionSpeed = 'slow';\r\n      } else if (effectiveType === '3g') {\r\n        this.connectionSpeed = 'medium';\r\n      } else {\r\n        this.connectionSpeed = 'fast';\r\n      }\r\n    }\r\n\r\n    console.log('ðŸŒ Detected connection speed:', this.connectionSpeed);\r\n  }\r\n\r\n  private adjustChunkSize(): void {\r\n    // Adjust chunk size based on file size and connection speed\r\n    if (this.totalSize < 1024 * 1024) { // < 1MB\r\n      this.chunkSize = this.minChunkSize;\r\n    } else if (this.totalSize < 10 * 1024 * 1024) { // < 10MB\r\n      this.chunkSize = this.connectionSpeed === 'slow' ? 128 * 1024 : 256 * 1024;\r\n    } else { // >= 10MB\r\n      this.chunkSize = this.connectionSpeed === 'slow' ? 256 * 1024 : \r\n                     this.connectionSpeed === 'medium' ? 512 * 1024 : \r\n                     this.maxChunkSize;\r\n    }\r\n\r\n    console.log('ðŸ“„ Adjusted chunk size:', this.formatSize(this.chunkSize));\r\n  }\r\n\r\n  async preloadPage(pdfDocument: any, pageNumber: number): Promise<boolean> {\r\n    try {\r\n      const cacheKey = `page:${pdfDocument.fingerprints?.[0]}:${pageNumber}`;\r\n      \r\n      // Check if already cached\r\n      const cached = await indexedDBCache.get(cacheKey);\r\n      if (cached) return true;\r\n\r\n      // Load and cache page\r\n      const page = await pdfDocument.getPage(pageNumber);\r\n      await indexedDBCache.set(cacheKey, {\r\n        pageNumber,\r\n        rotation: page.rotate,\r\n        viewport: page.getViewport({ scale: 1 }).clone(),\r\n        loadedAt: Date.now()\r\n      }, 'content');\r\n\r\n      this.pageCache.set(pageNumber, page);\r\n      return true;\r\n\r\n    } catch (error) {\r\n      console.warn(`Failed to preload page ${pageNumber}:`, error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  abort(): void {\r\n    if (this.abortController) {\r\n      this.abortController.abort();\r\n      this.abortController = null;\r\n    }\r\n    \r\n    this.loadedChunks.clear();\r\n    this.pageCache.clear();\r\n  }\r\n\r\n  private formatSize(bytes: number): string {\r\n    const units = ['B', 'KB', 'MB', 'GB'];\r\n    let size = bytes;\r\n    let unitIndex = 0;\r\n    \r\n    while (size >= 1024 && unitIndex < units.length - 1) {\r\n      size /= 1024;\r\n      unitIndex++;\r\n    }\r\n    \r\n    return `${size.toFixed(1)} ${units[unitIndex]}`;\r\n  }\r\n\r\n  getLoadedChunks(): number[] {\r\n    return Array.from(this.loadedChunks.keys());\r\n  }\r\n\r\n  getCachedPages(): number[] {\r\n    return Array.from(this.pageCache.keys());\r\n  }\r\n}\r\n\r\nexport { StreamingPDFLoader };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\UniversalDocumentReader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\WeatherService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\engines\\EnhancedPDFReader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[346,349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[346,349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { \r\n  DocumentReader, \r\n  DocumentMetadata, \r\n  DocumentLocation, \r\n  DocumentLoadProgress, \r\n  DocumentLoadError,\r\n  DocumentTelemetryEvent,\r\n  DocumentReaderConfig \r\n} from '@/interfaces/DocumentReader';\r\n\r\nexport class EnhancedPDFReader implements DocumentReader {\r\n  private config: DocumentReaderConfig;\r\n  private currentDocument: any = null;\r\n  private currentLocation: DocumentLocation | null = null;\r\n  private isDocumentReady: boolean = false;\r\n\r\n  // Event callbacks\r\n  private onLoadProgressCallback?: (progress: DocumentLoadProgress) => void;\r\n  private onLoadErrorCallback?: (error: DocumentLoadError) => void;\r\n  private onLocationChangeCallback?: (location: DocumentLocation) => void;\r\n  private onTelemetryEventCallback?: (event: DocumentTelemetryEvent) => void;\r\n\r\n  constructor(config: DocumentReaderConfig) {\r\n    this.config = config;\r\n    console.log('ðŸ“„ Enhanced PDF Reader initialized');\r\n  }\r\n\r\n  async loadDocument(url: string, metadata: DocumentMetadata): Promise<void> {\r\n    try {\r\n      this.isDocumentReady = false;\r\n      \r\n      this.onLoadProgressCallback?.({\r\n        stage: 'downloading',\r\n        percentage: 25,\r\n        message: 'Loading PDF document...'\r\n      });\r\n\r\n      // Enhanced PDF loading logic would go here\r\n      // For now, we'll simulate the loading process\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n      this.onLoadProgressCallback?.({\r\n        stage: 'ready',\r\n        percentage: 100,\r\n        message: 'PDF ready to view'\r\n      });\r\n\r\n      this.isDocumentReady = true;\r\n      this.currentLocation = { page: 1, percentage: 0 };\r\n    } catch (error) {\r\n      this.onLoadErrorCallback?.({\r\n        type: 'unknown',\r\n        message: error instanceof Error ? error.message : 'Unknown error',\r\n        recoverable: true,\r\n        retryCount: 0\r\n      });\r\n    }\r\n  }\r\n\r\n  unloadDocument(): void {\r\n    this.currentDocument = null;\r\n    this.currentLocation = null;\r\n    this.isDocumentReady = false;\r\n  }\r\n\r\n  async goToLocation(location: DocumentLocation): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    this.currentLocation = location;\r\n    this.onLocationChangeCallback?.(location);\r\n  }\r\n\r\n  async nextPage(): Promise<void> {\r\n    if (!this.isDocumentReady || !this.currentLocation) throw new Error('Document not ready');\r\n    const newPage = (this.currentLocation.page || 1) + 1;\r\n    await this.goToLocation({ page: newPage });\r\n  }\r\n\r\n  async previousPage(): Promise<void> {\r\n    if (!this.isDocumentReady || !this.currentLocation) throw new Error('Document not ready');\r\n    const newPage = Math.max((this.currentLocation.page || 1) - 1, 1);\r\n    await this.goToLocation({ page: newPage });\r\n  }\r\n\r\n  setFontSize(size: number): void {\r\n    // Enhanced PDF font size logic\r\n  }\r\n\r\n  setZoom(scale: number): void {\r\n    // Enhanced PDF zoom logic\r\n  }\r\n\r\n  getCurrentLocation(): DocumentLocation | null {\r\n    return this.currentLocation;\r\n  }\r\n\r\n  getProgress(): number {\r\n    return this.currentLocation?.percentage || 0;\r\n  }\r\n\r\n  isReady(): boolean {\r\n    return this.isDocumentReady;\r\n  }\r\n\r\n  onLoadProgress(callback: (progress: DocumentLoadProgress) => void): void {\r\n    this.onLoadProgressCallback = callback;\r\n  }\r\n\r\n  onLoadError(callback: (error: DocumentLoadError) => void): void {\r\n    this.onLoadErrorCallback = callback;\r\n  }\r\n\r\n  onLocationChange(callback: (location: DocumentLocation) => void): void {\r\n    this.onLocationChangeCallback = callback;\r\n  }\r\n\r\n  onTelemetryEvent(callback: (event: DocumentTelemetryEvent) => void): void {\r\n    this.onTelemetryEventCallback = callback;\r\n  }\r\n\r\n  destroy(): void {\r\n    this.unloadDocument();\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\engines\\OptimizedEPUBReader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[348,351],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[348,351],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { \r\n  DocumentReader, \r\n  DocumentMetadata, \r\n  DocumentLocation, \r\n  DocumentLoadProgress, \r\n  DocumentLoadError,\r\n  DocumentTelemetryEvent,\r\n  DocumentReaderConfig \r\n} from '@/interfaces/DocumentReader';\r\n\r\nexport class OptimizedEPUBReader implements DocumentReader {\r\n  private config: DocumentReaderConfig;\r\n  private currentDocument: any = null;\r\n  private currentLocation: DocumentLocation | null = null;\r\n  private isDocumentReady: boolean = false;\r\n\r\n  // Event callbacks\r\n  private onLoadProgressCallback?: (progress: DocumentLoadProgress) => void;\r\n  private onLoadErrorCallback?: (error: DocumentLoadError) => void;\r\n  private onLocationChangeCallback?: (location: DocumentLocation) => void;\r\n  private onTelemetryEventCallback?: (event: DocumentTelemetryEvent) => void;\r\n\r\n  constructor(config: DocumentReaderConfig) {\r\n    this.config = config;\r\n    console.log('ðŸ“š Optimized EPUB Reader initialized');\r\n  }\r\n\r\n  async loadDocument(url: string, metadata: DocumentMetadata): Promise<void> {\r\n    try {\r\n      this.isDocumentReady = false;\r\n      \r\n      this.onLoadProgressCallback?.({\r\n        stage: 'downloading',\r\n        percentage: 25,\r\n        message: 'Loading EPUB document...'\r\n      });\r\n\r\n      // Optimized EPUB loading logic would go here\r\n      await new Promise(resolve => setTimeout(resolve, 1200));\r\n\r\n      this.onLoadProgressCallback?.({\r\n        stage: 'ready',\r\n        percentage: 100,\r\n        message: 'EPUB ready to read'\r\n      });\r\n\r\n      this.isDocumentReady = true;\r\n      this.currentLocation = { cfi: 'epubcfi(/6/2[cover]!/4)', percentage: 0 };\r\n    } catch (error) {\r\n      this.onLoadErrorCallback?.({\r\n        type: 'unknown',\r\n        message: error instanceof Error ? error.message : 'Unknown error',\r\n        recoverable: true,\r\n        retryCount: 0\r\n      });\r\n    }\r\n  }\r\n\r\n  unloadDocument(): void {\r\n    this.currentDocument = null;\r\n    this.currentLocation = null;\r\n    this.isDocumentReady = false;\r\n  }\r\n\r\n  async goToLocation(location: DocumentLocation): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    this.currentLocation = location;\r\n    this.onLocationChangeCallback?.(location);\r\n  }\r\n\r\n  async nextPage(): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    // EPUB navigation logic would go here\r\n    this.onLocationChangeCallback?.(this.currentLocation!);\r\n  }\r\n\r\n  async previousPage(): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    // EPUB navigation logic would go here\r\n    this.onLocationChangeCallback?.(this.currentLocation!);\r\n  }\r\n\r\n  setFontSize(size: number): void {\r\n    // Optimized EPUB font size logic\r\n  }\r\n\r\n  setZoom(scale: number): void {\r\n    // EPUB zoom logic (if applicable)\r\n  }\r\n\r\n  getCurrentLocation(): DocumentLocation | null {\r\n    return this.currentLocation;\r\n  }\r\n\r\n  getProgress(): number {\r\n    return this.currentLocation?.percentage || 0;\r\n  }\r\n\r\n  isReady(): boolean {\r\n    return this.isDocumentReady;\r\n  }\r\n\r\n  onLoadProgress(callback: (progress: DocumentLoadProgress) => void): void {\r\n    this.onLoadProgressCallback = callback;\r\n  }\r\n\r\n  onLoadError(callback: (error: DocumentLoadError) => void): void {\r\n    this.onLoadErrorCallback = callback;\r\n  }\r\n\r\n  onLocationChange(callback: (location: DocumentLocation) => void): void {\r\n    this.onLocationChangeCallback = callback;\r\n  }\r\n\r\n  onTelemetryEvent(callback: (event: DocumentTelemetryEvent) => void): void {\r\n    this.onTelemetryEventCallback = callback;\r\n  }\r\n\r\n  destroy(): void {\r\n    this.unloadDocument();\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\engines\\StandardEPUBReader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[347,350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[347,350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { \r\n  DocumentReader, \r\n  DocumentMetadata, \r\n  DocumentLocation, \r\n  DocumentLoadProgress, \r\n  DocumentLoadError,\r\n  DocumentTelemetryEvent,\r\n  DocumentReaderConfig \r\n} from '@/interfaces/DocumentReader';\r\n\r\nexport class StandardEPUBReader implements DocumentReader {\r\n  private config: DocumentReaderConfig;\r\n  private currentDocument: any = null;\r\n  private currentLocation: DocumentLocation | null = null;\r\n  private isDocumentReady: boolean = false;\r\n\r\n  // Event callbacks\r\n  private onLoadProgressCallback?: (progress: DocumentLoadProgress) => void;\r\n  private onLoadErrorCallback?: (error: DocumentLoadError) => void;\r\n  private onLocationChangeCallback?: (location: DocumentLocation) => void;\r\n  private onTelemetryEventCallback?: (event: DocumentTelemetryEvent) => void;\r\n\r\n  constructor(config: DocumentReaderConfig) {\r\n    this.config = config;\r\n    console.log('ðŸ“š Standard EPUB Reader initialized');\r\n  }\r\n\r\n  async loadDocument(url: string, metadata: DocumentMetadata): Promise<void> {\r\n    try {\r\n      this.isDocumentReady = false;\r\n      \r\n      this.onLoadProgressCallback?.({\r\n        stage: 'downloading',\r\n        percentage: 25,\r\n        message: 'Loading EPUB document...'\r\n      });\r\n\r\n      // Standard EPUB loading logic would go here\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n      this.onLoadProgressCallback?.({\r\n        stage: 'ready',\r\n        percentage: 100,\r\n        message: 'EPUB ready to read'\r\n      });\r\n\r\n      this.isDocumentReady = true;\r\n      this.currentLocation = { cfi: 'epubcfi(/6/2[cover]!/4)', percentage: 0 };\r\n    } catch (error) {\r\n      this.onLoadErrorCallback?.({\r\n        type: 'unknown',\r\n        message: error instanceof Error ? error.message : 'Unknown error',\r\n        recoverable: true,\r\n        retryCount: 0\r\n      });\r\n    }\r\n  }\r\n\r\n  unloadDocument(): void {\r\n    this.currentDocument = null;\r\n    this.currentLocation = null;\r\n    this.isDocumentReady = false;\r\n  }\r\n\r\n  async goToLocation(location: DocumentLocation): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    this.currentLocation = location;\r\n    this.onLocationChangeCallback?.(location);\r\n  }\r\n\r\n  async nextPage(): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    // EPUB navigation logic would go here\r\n    this.onLocationChangeCallback?.(this.currentLocation!);\r\n  }\r\n\r\n  async previousPage(): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    // EPUB navigation logic would go here\r\n    this.onLocationChangeCallback?.(this.currentLocation!);\r\n  }\r\n\r\n  setFontSize(size: number): void {\r\n    // Standard EPUB font size logic\r\n  }\r\n\r\n  setZoom(scale: number): void {\r\n    // EPUB zoom logic (if applicable)\r\n  }\r\n\r\n  getCurrentLocation(): DocumentLocation | null {\r\n    return this.currentLocation;\r\n  }\r\n\r\n  getProgress(): number {\r\n    return this.currentLocation?.percentage || 0;\r\n  }\r\n\r\n  isReady(): boolean {\r\n    return this.isDocumentReady;\r\n  }\r\n\r\n  onLoadProgress(callback: (progress: DocumentLoadProgress) => void): void {\r\n    this.onLoadProgressCallback = callback;\r\n  }\r\n\r\n  onLoadError(callback: (error: DocumentLoadError) => void): void {\r\n    this.onLoadErrorCallback = callback;\r\n  }\r\n\r\n  onLocationChange(callback: (location: DocumentLocation) => void): void {\r\n    this.onLocationChangeCallback = callback;\r\n  }\r\n\r\n  onTelemetryEvent(callback: (event: DocumentTelemetryEvent) => void): void {\r\n    this.onTelemetryEventCallback = callback;\r\n  }\r\n\r\n  destroy(): void {\r\n    this.unloadDocument();\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\engines\\StandardPDFReader.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[346,349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[346,349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { \r\n  DocumentReader, \r\n  DocumentMetadata, \r\n  DocumentLocation, \r\n  DocumentLoadProgress, \r\n  DocumentLoadError,\r\n  DocumentTelemetryEvent,\r\n  DocumentReaderConfig \r\n} from '@/interfaces/DocumentReader';\r\n\r\nexport class StandardPDFReader implements DocumentReader {\r\n  private config: DocumentReaderConfig;\r\n  private currentDocument: any = null;\r\n  private currentLocation: DocumentLocation | null = null;\r\n  private isDocumentReady: boolean = false;\r\n\r\n  // Event callbacks\r\n  private onLoadProgressCallback?: (progress: DocumentLoadProgress) => void;\r\n  private onLoadErrorCallback?: (error: DocumentLoadError) => void;\r\n  private onLocationChangeCallback?: (location: DocumentLocation) => void;\r\n  private onTelemetryEventCallback?: (event: DocumentTelemetryEvent) => void;\r\n\r\n  constructor(config: DocumentReaderConfig) {\r\n    this.config = config;\r\n    console.log('ðŸ“„ Standard PDF Reader initialized');\r\n  }\r\n\r\n  async loadDocument(url: string, metadata: DocumentMetadata): Promise<void> {\r\n    try {\r\n      this.isDocumentReady = false;\r\n      \r\n      this.onLoadProgressCallback?.({\r\n        stage: 'downloading',\r\n        percentage: 25,\r\n        message: 'Loading PDF document...'\r\n      });\r\n\r\n      // Standard PDF loading logic would go here\r\n      await new Promise(resolve => setTimeout(resolve, 800));\r\n\r\n      this.onLoadProgressCallback?.({\r\n        stage: 'ready',\r\n        percentage: 100,\r\n        message: 'PDF ready to view'\r\n      });\r\n\r\n      this.isDocumentReady = true;\r\n      this.currentLocation = { page: 1, percentage: 0 };\r\n    } catch (error) {\r\n      this.onLoadErrorCallback?.({\r\n        type: 'unknown',\r\n        message: error instanceof Error ? error.message : 'Unknown error',\r\n        recoverable: true,\r\n        retryCount: 0\r\n      });\r\n    }\r\n  }\r\n\r\n  unloadDocument(): void {\r\n    this.currentDocument = null;\r\n    this.currentLocation = null;\r\n    this.isDocumentReady = false;\r\n  }\r\n\r\n  async goToLocation(location: DocumentLocation): Promise<void> {\r\n    if (!this.isDocumentReady) throw new Error('Document not ready');\r\n    this.currentLocation = location;\r\n    this.onLocationChangeCallback?.(location);\r\n  }\r\n\r\n  async nextPage(): Promise<void> {\r\n    if (!this.isDocumentReady || !this.currentLocation) throw new Error('Document not ready');\r\n    const newPage = (this.currentLocation.page || 1) + 1;\r\n    await this.goToLocation({ page: newPage });\r\n  }\r\n\r\n  async previousPage(): Promise<void> {\r\n    if (!this.isDocumentReady || !this.currentLocation) throw new Error('Document not ready');\r\n    const newPage = Math.max((this.currentLocation.page || 1) - 1, 1);\r\n    await this.goToLocation({ page: newPage });\r\n  }\r\n\r\n  setFontSize(size: number): void {\r\n    // Standard PDF font size logic\r\n  }\r\n\r\n  setZoom(scale: number): void {\r\n    // Standard PDF zoom logic\r\n  }\r\n\r\n  getCurrentLocation(): DocumentLocation | null {\r\n    return this.currentLocation;\r\n  }\r\n\r\n  getProgress(): number {\r\n    return this.currentLocation?.percentage || 0;\r\n  }\r\n\r\n  isReady(): boolean {\r\n    return this.isDocumentReady;\r\n  }\r\n\r\n  onLoadProgress(callback: (progress: DocumentLoadProgress) => void): void {\r\n    this.onLoadProgressCallback = callback;\r\n  }\r\n\r\n  onLoadError(callback: (error: DocumentLoadError) => void): void {\r\n    this.onLoadErrorCallback = callback;\r\n  }\r\n\r\n  onLocationChange(callback: (location: DocumentLocation) => void): void {\r\n    this.onLocationChangeCallback = callback;\r\n  }\r\n\r\n  onTelemetryEvent(callback: (event: DocumentTelemetryEvent) => void): void {\r\n    this.onTelemetryEventCallback = callback;\r\n  }\r\n\r\n  destroy(): void {\r\n    this.unloadDocument();\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\epub\\EPUBChapterManager.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[177,180],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[177,180],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[267,270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[267,270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[518,521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[518,521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2318,2321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2318,2321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { indexedDBCache } from '../IndexedDBCacheService';\r\nimport { EPUBMetadata } from './EPUBStreamingTypes';\r\n\r\nexport class EPUBChapterManager {\r\n  private epubInstance: any;\r\n  private metadata: EPUBMetadata;\r\n  private chapterQueue = new Map<string, Promise<any>>();\r\n  private preloadedChapters = new Set<string>();\r\n  private currentReadingPosition = 0;\r\n  private readingSpeed = 250; // words per minute (default)\r\n  private preloadDistance = 3; // chapters to preload ahead\r\n\r\n  constructor(epubInstance: any, metadata: EPUBMetadata) {\r\n    this.epubInstance = epubInstance;\r\n    this.metadata = metadata;\r\n  }\r\n\r\n  async preloadInitialChapters(onProgress?: (loaded: number, total: number) => void): Promise<void> {\r\n    if (!this.metadata || !this.epubInstance) return;\r\n\r\n    const chaptersToPreload = Math.min(this.preloadDistance, this.metadata.spine.length);\r\n    const preloadPromises: Promise<void>[] = [];\r\n\r\n    for (let i = 0; i < chaptersToPreload; i++) {\r\n      const chapter = this.metadata.spine[i];\r\n      if (chapter) {\r\n        preloadPromises.push(this.preloadChapter(chapter.href, i));\r\n      }\r\n    }\r\n\r\n    await Promise.allSettled(preloadPromises);\r\n    \r\n    if (onProgress) {\r\n      onProgress(this.preloadedChapters.size, this.metadata.spine.length);\r\n    }\r\n  }\r\n\r\n  private async preloadChapter(href: string, index: number): Promise<void> {\r\n    try {\r\n      const cacheKey = `chapter:${this.metadata?.identifier}:${href}`;\r\n      \r\n      // Check cache first\r\n      const cached = await indexedDBCache.get(cacheKey);\r\n      if (cached) {\r\n        this.preloadedChapters.add(href);\r\n        return;\r\n      }\r\n\r\n      // Load chapter content\r\n      const chapterPromise = this.epubInstance.load(href);\r\n      this.chapterQueue.set(href, chapterPromise);\r\n      \r\n      const chapterContent = await chapterPromise;\r\n      \r\n      // Cache chapter content\r\n      await indexedDBCache.set(cacheKey, {\r\n        href,\r\n        content: chapterContent,\r\n        index,\r\n        loadedAt: Date.now()\r\n      }, 'content');\r\n\r\n      this.preloadedChapters.add(href);\r\n      console.log(`ðŸ“„ Preloaded chapter ${index + 1}: ${href}`);\r\n\r\n    } catch (error) {\r\n      console.warn(`Failed to preload chapter ${href}:`, error);\r\n    }\r\n  }\r\n\r\n  async getChapterContent(href: string): Promise<any> {\r\n    try {\r\n      const cacheKey = `chapter:${this.metadata?.identifier}:${href}`;\r\n      \r\n      // Check cache first\r\n      const cached = await indexedDBCache.get(cacheKey);\r\n      if (cached) {\r\n        console.log('ðŸ“„ Using cached chapter:', href);\r\n        return cached.content;\r\n      }\r\n\r\n      // Check if already loading\r\n      const existingPromise = this.chapterQueue.get(href);\r\n      if (existingPromise) {\r\n        return await existingPromise;\r\n      }\r\n\r\n      // Load chapter on demand\r\n      console.log('ðŸ“„ Loading chapter on demand:', href);\r\n      const chapterPromise = this.epubInstance.load(href);\r\n      this.chapterQueue.set(href, chapterPromise);\r\n      \r\n      const content = await chapterPromise;\r\n      \r\n      // Cache the content\r\n      await indexedDBCache.set(cacheKey, {\r\n        href,\r\n        content,\r\n        loadedAt: Date.now()\r\n      }, 'content');\r\n\r\n      return content;\r\n\r\n    } catch (error) {\r\n      console.error('Failed to get chapter content:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async preloadNextChapters(currentChapterIndex: number): Promise<void> {\r\n    if (!this.metadata) return;\r\n\r\n    const startIndex = currentChapterIndex + 1;\r\n    const endIndex = Math.min(startIndex + this.preloadDistance, this.metadata.spine.length);\r\n\r\n    const preloadPromises: Promise<void>[] = [];\r\n\r\n    for (let i = startIndex; i < endIndex; i++) {\r\n      const chapter = this.metadata.spine[i];\r\n      if (chapter && !this.preloadedChapters.has(chapter.href)) {\r\n        preloadPromises.push(this.preloadChapter(chapter.href, i));\r\n      }\r\n    }\r\n\r\n    await Promise.allSettled(preloadPromises);\r\n    console.log(`ðŸš€ Preloaded ${preloadPromises.length} upcoming chapters`);\r\n  }\r\n\r\n  updateReadingPosition(chapterIndex: number, readingSpeed?: number): void {\r\n    this.currentReadingPosition = chapterIndex;\r\n    \r\n    if (readingSpeed) {\r\n      this.readingSpeed = readingSpeed;\r\n    }\r\n\r\n    // Adaptively preload based on reading speed\r\n    const fastReader = this.readingSpeed > 300;\r\n    this.preloadDistance = fastReader ? 5 : 3;\r\n\r\n    // Trigger background preloading\r\n    this.preloadNextChapters(chapterIndex);\r\n  }\r\n\r\n  getStats() {\r\n    return {\r\n      preloadedChapters: this.preloadedChapters.size,\r\n      queuedChapters: this.chapterQueue.size,\r\n      currentPosition: this.currentReadingPosition,\r\n      readingSpeed: this.readingSpeed,\r\n      preloadDistance: this.preloadDistance\r\n    };\r\n  }\r\n\r\n  cleanup(): void {\r\n    this.chapterQueue.clear();\r\n    this.preloadedChapters.clear();\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\epub\\EPUBInstanceCreator.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[359,362],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[359,362],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { EPUBStreamingError } from './EPUBStreamingTypes';\r\nimport { logger } from '@/utils/logger';\r\n\r\nexport class EPUBInstanceCreator {\r\n  static async createStreamingEPUB(\r\n    url: string, \r\n    abortController: AbortController,\r\n    onProgress?: (percentage: number, message: string) => void\r\n  ): Promise<{\r\n    success: boolean;\r\n    epubInstance?: any;\r\n    error?: EPUBStreamingError;\r\n  }> {\r\n    try {\r\n      onProgress?.(30, 'Creating streaming EPUB instance...');\r\n\r\n      const epubModule = await import('epubjs');\r\n      const EPubLib = epubModule.default;\r\n\r\n      // Create EPUB with basic configuration\r\n      const epub = EPubLib(url, {\r\n        openAs: 'epub'\r\n      });\r\n\r\n      onProgress?.(60, 'Preparing book for reading...');\r\n      \r\n      // Wait for book to be ready with proper error boundaries\r\n      await Promise.race([\r\n        epub.ready,\r\n        new Promise((_, reject) => {\r\n          abortController.signal.addEventListener('abort', () => {\r\n            reject(new Error(`Book loading timed out`));\r\n          });\r\n        })\r\n      ]);\r\n      \r\n      logger.epub('EPUB instance ready');\r\n      \r\n      onProgress?.(50, 'EPUB structure loaded, preparing streaming...');\r\n\r\n      return { success: true, epubInstance: epub };\r\n\r\n    } catch (error) {\r\n      const structureError: EPUBStreamingError = {\r\n        type: 'streaming',\r\n        message: `Failed to create streaming EPUB: ${error instanceof Error ? error.message : 'Unknown error'}`,\r\n        recoverable: true,\r\n        retryCount: 0,\r\n        context: 'epub_creation'\r\n      };\r\n\r\n      return { success: false, error: structureError };\r\n    }\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\epub\\EPUBMetadataExtractor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2697,2700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2697,2700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { indexedDBCache } from '../IndexedDBCacheService';\r\nimport { performanceService } from '../PerformanceOptimizationService';\r\nimport { EPUBMetadata, EPUBStreamingError } from './EPUBStreamingTypes';\r\n\r\nexport class EPUBMetadataExtractor {\r\n  static async extractMetadata(url: string, cacheKey: string): Promise<{\r\n    success: boolean;\r\n    metadata?: EPUBMetadata;\r\n    error?: EPUBStreamingError;\r\n  }> {\r\n    try {\r\n      // Check cache first\r\n      const cachedMetadata = await indexedDBCache.get(`epub-meta:${cacheKey}`);\r\n      if (cachedMetadata && this.isMetadataFresh(cachedMetadata)) {\r\n        console.log('ðŸ“š Using cached EPUB metadata:', cacheKey);\r\n        return { success: true, metadata: cachedMetadata };\r\n      }\r\n\r\n      // Try prefetched metadata from performance service\r\n      const prefetchedBook = await performanceService.getPrefetchedBook(cacheKey);\r\n      if (prefetchedBook?.metadata) {\r\n        console.log('ðŸš€ Using prefetched EPUB metadata:', cacheKey);\r\n        return { success: true, metadata: prefetchedBook.metadata };\r\n      }\r\n\r\n      // Load EPUB.js\r\n      const epubModule = await import('epubjs');\r\n      const EPubLib = epubModule.default;\r\n\r\n      // Create temporary EPUB instance for metadata extraction\r\n      const tempEpub = EPubLib(url);\r\n      \r\n      // Extract metadata with longer timeout (30s instead of 10s)\r\n      const metadataPromise = this.extractFromEpub(tempEpub);\r\n      const timeoutPromise = new Promise((_, reject) => {\r\n        setTimeout(() => reject(new Error('Metadata extraction timeout')), 30000);\r\n      });\r\n\r\n      const metadata = await Promise.race([metadataPromise, timeoutPromise]) as EPUBMetadata;\r\n\r\n      // Cache metadata\r\n      await indexedDBCache.set(`epub-meta:${cacheKey}`, metadata, 'metadata');\r\n\r\n      // Cleanup temporary instance\r\n      if (tempEpub && typeof tempEpub.destroy === 'function') {\r\n        tempEpub.destroy();\r\n      }\r\n\r\n      return { success: true, metadata };\r\n\r\n    } catch (error) {\r\n      console.error('âŒ EPUB metadata loading failed:', error);\r\n      \r\n      // Try fallback metadata extraction\r\n      const fallbackResult = await this.extractFallbackMetadata(url, cacheKey);\r\n      if (fallbackResult.success) {\r\n        return fallbackResult;\r\n      }\r\n      \r\n      const metadataError: EPUBStreamingError = {\r\n        type: 'metadata',\r\n        message: `Failed to load EPUB metadata: ${error instanceof Error ? error.message : 'Unknown error'}`,\r\n        recoverable: true,\r\n        retryCount: 0,\r\n        context: 'metadata_extraction'\r\n      };\r\n\r\n      return { success: false, error: metadataError };\r\n    }\r\n  }\r\n\r\n  private static async extractFromEpub(epub: any): Promise<EPUBMetadata> {\r\n    await epub.ready;\r\n    \r\n    // Wait for all metadata to load\r\n    await Promise.all([\r\n      epub.loaded.metadata,\r\n      epub.loaded.navigation,\r\n      epub.loaded.spine,\r\n      epub.loaded.resources\r\n    ]);\r\n\r\n    const metadata: EPUBMetadata = {\r\n      title: epub.metadata.title || 'Unknown Title',\r\n      author: epub.metadata.creator || 'Unknown Author',\r\n      identifier: epub.metadata.identifier || '',\r\n      language: epub.metadata.language || 'en',\r\n      description: epub.metadata.description,\r\n      subjects: epub.metadata.subject ? [epub.metadata.subject] : [],\r\n      rights: epub.metadata.rights,\r\n      publisher: epub.metadata.publisher,\r\n      coverHref: epub.cover,\r\n      toc: epub.navigation.toc || [],\r\n      spine: epub.spine.spineItems || [],\r\n      resources: epub.resources || {},\r\n      loadedAt: Date.now()\r\n    };\r\n\r\n    console.log('ðŸ“– EPUB metadata extracted:', {\r\n      title: metadata.title,\r\n      chapters: metadata.spine.length,\r\n      tocItems: metadata.toc.length\r\n    });\r\n\r\n    return metadata;\r\n  }\r\n\r\n  private static async extractFallbackMetadata(url: string, cacheKey: string): Promise<{\r\n    success: boolean;\r\n    metadata?: EPUBMetadata;\r\n    error?: EPUBStreamingError;\r\n  }> {\r\n    try {\r\n      console.log('ðŸ”„ Attempting fallback metadata extraction...');\r\n      \r\n      // Create a basic metadata object with minimal requirements\r\n      const fallbackMetadata: EPUBMetadata = {\r\n        title: 'Loading Book...',\r\n        author: 'Unknown Author',\r\n        identifier: cacheKey,\r\n        language: 'en',\r\n        toc: [],\r\n        spine: [],\r\n        resources: {},\r\n        loadedAt: Date.now()\r\n      };\r\n\r\n      // Cache the fallback metadata temporarily\r\n      await indexedDBCache.set(`epub-meta:${cacheKey}`, fallbackMetadata, 'metadata');\r\n\r\n      console.log('âœ… Fallback metadata created');\r\n      return { success: true, metadata: fallbackMetadata };\r\n\r\n    } catch (error) {\r\n      const fallbackError: EPUBStreamingError = {\r\n        type: 'metadata',\r\n        message: 'Both primary and fallback metadata extraction failed',\r\n        recoverable: false,\r\n        retryCount: 0,\r\n        context: 'fallback_metadata'\r\n      };\r\n\r\n      return { success: false, error: fallbackError };\r\n    }\r\n  }\r\n\r\n  private static isMetadataFresh(metadata: EPUBMetadata): boolean {\r\n    const age = Date.now() - metadata.loadedAt;\r\n    return age < 24 * 60 * 60 * 1000; // 24 hours\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\epub\\EPUBStreamingTypes.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":8,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":11,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[785,788],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[785,788],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[802,805],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[802,805],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[840,843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[840,843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nexport interface EPUBStreamingProgress {\r\n  stage: 'metadata' | 'structure' | 'preloading' | 'streaming' | 'ready';\r\n  percentage: number;\r\n  message: string;\r\n  chaptersLoaded?: number;\r\n  totalChapters?: number;\r\n  bytesLoaded?: number;\r\n  totalBytes?: number;\r\n  readingSpeed?: number;\r\n  estimatedTimeRemaining?: number;\r\n}\r\n\r\nexport interface EPUBStreamingError {\r\n  type: 'network' | 'timeout' | 'parsing' | 'metadata' | 'streaming' | 'unknown';\r\n  message: string;\r\n  recoverable: boolean;\r\n  retryCount: number;\r\n  context?: string;\r\n}\r\n\r\nexport interface EPUBMetadata {\r\n  title: string;\r\n  author: string;\r\n  identifier: string;\r\n  language: string;\r\n  description?: string;\r\n  subjects?: string[];\r\n  rights?: string;\r\n  publisher?: string;\r\n  coverHref?: string;\r\n  toc: any[];\r\n  spine: any[];\r\n  resources: { [key: string]: any };\r\n  loadedAt: number;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\goalsService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\monitoring\\ConversionFunnelTracker.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[225,228],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[225,228],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[493,496],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[493,496],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3514,3517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3514,3517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3704,3707],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3704,3707],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4077,4080],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4077,4080],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":160,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4502,4505],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4502,4505],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * User Experience Analytics - Conversion Funnel Tracking\r\n * Tracks search-to-read conversion funnel and user journey\r\n */\r\n\r\ninterface FunnelStep {\r\n  step: string;\r\n  timestamp: number;\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\ninterface ConversionEvent {\r\n  userId?: string;\r\n  sessionId: string;\r\n  eventType: 'search' | 'view_results' | 'book_detail' | 'start_reading' | 'complete_reading';\r\n  bookId?: string;\r\n  query?: string;\r\n  timestamp: number;\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\ninterface FunnelMetrics {\r\n  totalSearches: number;\r\n  searchToView: number;\r\n  viewToDetail: number;\r\n  detailToRead: number;\r\n  readToComplete: number;\r\n  conversionRates: {\r\n    searchToRead: number;\r\n    searchToComplete: number;\r\n    viewToRead: number;\r\n  };\r\n}\r\n\r\nexport class ConversionFunnelTracker {\r\n  private sessions: Map<string, FunnelStep[]> = new Map();\r\n  private events: ConversionEvent[] = [];\r\n  private sessionId: string;\r\n\r\n  constructor() {\r\n    this.sessionId = this.generateSessionId();\r\n    this.initializeTracking();\r\n  }\r\n\r\n  /**\r\n   * Initialize conversion tracking\r\n   */\r\n  private initializeTracking(): void {\r\n    // Track page visibility changes\r\n    document.addEventListener('visibilitychange', () => {\r\n      if (document.hidden) {\r\n        this.trackEvent('session_pause', {});\r\n      } else {\r\n        this.trackEvent('session_resume', {});\r\n      }\r\n    });\r\n\r\n    // Track beforeunload for session end\r\n    window.addEventListener('beforeunload', () => {\r\n      this.trackEvent('session_end', {});\r\n    });\r\n\r\n    console.log('ðŸ”„ Conversion funnel tracking initialized');\r\n  }\r\n\r\n  /**\r\n   * Track search initiation\r\n   */\r\n  trackSearch(query: string, searchType: 'instant' | 'full' = 'full'): void {\r\n    this.addFunnelStep('search', { query, searchType });\r\n    this.recordEvent('search', { query, searchType });\r\n  }\r\n\r\n  /**\r\n   * Track search results viewing\r\n   */\r\n  trackSearchResults(query: string, resultCount: number, loadTime?: number): void {\r\n    this.addFunnelStep('view_results', { query, resultCount, loadTime });\r\n    this.recordEvent('view_results', { query, resultCount, loadTime });\r\n  }\r\n\r\n  /**\r\n   * Track book detail viewing\r\n   */\r\n  trackBookDetail(bookId: string, source: 'search' | 'recommendation' | 'browse' = 'search'): void {\r\n    this.addFunnelStep('book_detail', { bookId, source });\r\n    this.recordEvent('book_detail', { bookId, source });\r\n  }\r\n\r\n  /**\r\n   * Track reading session start\r\n   */\r\n  trackReadingStart(bookId: string, format: 'epub' | 'pdf', loadTime?: number): void {\r\n    this.addFunnelStep('start_reading', { bookId, format, loadTime });\r\n    this.recordEvent('start_reading', { bookId, format, loadTime });\r\n  }\r\n\r\n  /**\r\n   * Track reading session progress\r\n   */\r\n  trackReadingProgress(bookId: string, progress: number, timeSpent: number): void {\r\n    this.addFunnelStep('reading_progress', { bookId, progress, timeSpent });\r\n  }\r\n\r\n  /**\r\n   * Track reading completion\r\n   */\r\n  trackReadingComplete(bookId: string, totalTime: number, completionRate: number): void {\r\n    this.addFunnelStep('complete_reading', { bookId, totalTime, completionRate });\r\n    this.recordEvent('complete_reading', { bookId, totalTime, completionRate });\r\n  }\r\n\r\n  /**\r\n   * Track drop-off points\r\n   */\r\n  trackDropOff(step: string, reason?: string): void {\r\n    this.addFunnelStep('drop_off', { step, reason });\r\n  }\r\n\r\n  /**\r\n   * Track user engagement events\r\n   */\r\n  trackEngagement(action: string, metadata: Record<string, any> = {}): void {\r\n    this.addFunnelStep('engagement', { action, ...metadata });\r\n  }\r\n\r\n  /**\r\n   * Add funnel step\r\n   */\r\n  private addFunnelStep(step: string, metadata: Record<string, any> = {}): void {\r\n    const currentSteps = this.sessions.get(this.sessionId) || [];\r\n    currentSteps.push({\r\n      step,\r\n      timestamp: Date.now(),\r\n      metadata\r\n    });\r\n    this.sessions.set(this.sessionId, currentSteps);\r\n  }\r\n\r\n  /**\r\n   * Record conversion event\r\n   */\r\n  private recordEvent(eventType: ConversionEvent['eventType'], metadata: Record<string, any> = {}): void {\r\n    const event: ConversionEvent = {\r\n      sessionId: this.sessionId,\r\n      eventType,\r\n      timestamp: Date.now(),\r\n      metadata,\r\n      ...metadata // Include bookId, query etc. from metadata\r\n    };\r\n\r\n    this.events.push(event);\r\n    console.log(`ðŸ“Š Funnel event: ${eventType}`, metadata);\r\n  }\r\n\r\n  /**\r\n   * Track generic event\r\n   */\r\n  trackEvent(eventType: string, metadata: Record<string, any>): void {\r\n    this.addFunnelStep(eventType, metadata);\r\n  }\r\n\r\n  /**\r\n   * Calculate conversion metrics\r\n   */\r\n  getConversionMetrics(): FunnelMetrics {\r\n    const searchEvents = this.events.filter(e => e.eventType === 'search');\r\n    const viewEvents = this.events.filter(e => e.eventType === 'view_results');\r\n    const detailEvents = this.events.filter(e => e.eventType === 'book_detail');\r\n    const readEvents = this.events.filter(e => e.eventType === 'start_reading');\r\n    const completeEvents = this.events.filter(e => e.eventType === 'complete_reading');\r\n\r\n    const totalSearches = searchEvents.length;\r\n    const searchToView = viewEvents.length;\r\n    const viewToDetail = detailEvents.length;\r\n    const detailToRead = readEvents.length;\r\n    const readToComplete = completeEvents.length;\r\n\r\n    return {\r\n      totalSearches,\r\n      searchToView,\r\n      viewToDetail,\r\n      detailToRead,\r\n      readToComplete,\r\n      conversionRates: {\r\n        searchToRead: totalSearches > 0 ? (detailToRead / totalSearches) * 100 : 0,\r\n        searchToComplete: totalSearches > 0 ? (readToComplete / totalSearches) * 100 : 0,\r\n        viewToRead: searchToView > 0 ? (detailToRead / searchToView) * 100 : 0\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get funnel visualization data\r\n   */\r\n  getFunnelData(): { step: string; count: number; conversionRate: number }[] {\r\n    const metrics = this.getConversionMetrics();\r\n    const steps = [\r\n      { step: 'Search', count: metrics.totalSearches, conversionRate: 100 },\r\n      { step: 'View Results', count: metrics.searchToView, conversionRate: metrics.totalSearches > 0 ? (metrics.searchToView / metrics.totalSearches) * 100 : 0 },\r\n      { step: 'Book Detail', count: metrics.viewToDetail, conversionRate: metrics.searchToView > 0 ? (metrics.viewToDetail / metrics.searchToView) * 100 : 0 },\r\n      { step: 'Start Reading', count: metrics.detailToRead, conversionRate: metrics.viewToDetail > 0 ? (metrics.detailToRead / metrics.viewToDetail) * 100 : 0 },\r\n      { step: 'Complete Reading', count: metrics.readToComplete, conversionRate: metrics.detailToRead > 0 ? (metrics.readToComplete / metrics.detailToRead) * 100 : 0 }\r\n    ];\r\n\r\n    return steps;\r\n  }\r\n\r\n  /**\r\n   * Get session timeline\r\n   */\r\n  getSessionTimeline(sessionId: string = this.sessionId): FunnelStep[] {\r\n    return this.sessions.get(sessionId) || [];\r\n  }\r\n\r\n  /**\r\n   * Get drop-off analysis\r\n   */\r\n  getDropOffAnalysis(): Record<string, number> {\r\n    const dropOffs: Record<string, number> = {};\r\n    \r\n    this.sessions.forEach((steps) => {\r\n      for (let i = 0; i < steps.length - 1; i++) {\r\n        const currentStep = steps[i].step;\r\n        const nextStep = steps[i + 1].step;\r\n        \r\n        // If there's a significant time gap, consider it a drop-off\r\n        const timeDiff = steps[i + 1].timestamp - steps[i].timestamp;\r\n        if (timeDiff > 300000) { // 5 minutes\r\n          dropOffs[currentStep] = (dropOffs[currentStep] || 0) + 1;\r\n        }\r\n      }\r\n    });\r\n\r\n    return dropOffs;\r\n  }\r\n\r\n  /**\r\n   * Generate session ID\r\n   */\r\n  private generateSessionId(): string {\r\n    return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  /**\r\n   * Get all events\r\n   */\r\n  getEvents(): ConversionEvent[] {\r\n    return [...this.events];\r\n  }\r\n\r\n  /**\r\n   * Clear session data\r\n   */\r\n  clearSession(): void {\r\n    this.sessions.clear();\r\n    this.events.length = 0;\r\n    this.sessionId = this.generateSessionId();\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\monitoring\\SLOMonitoringService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":235,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":235,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6542,6545],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6542,6545],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * SLO Monitoring Service\r\n * Automated performance alerts and SLO monitoring\r\n */\r\n\r\nimport { WebVitalsTracker } from './WebVitalsTracker';\r\nimport { ConversionFunnelTracker } from './ConversionFunnelTracker';\r\nimport { cleanupManager } from '@/utils/cleanupManager';\r\n\r\ninterface SLOTarget {\r\n  metric: string;\r\n  target: number;\r\n  threshold: number;\r\n  timeWindow: number; // in milliseconds\r\n  alertOnBreach: boolean;\r\n}\r\n\r\ninterface AlertRule {\r\n  id: string;\r\n  name: string;\r\n  condition: (value: number, target: number) => boolean;\r\n  severity: 'info' | 'warning' | 'critical';\r\n  cooldown: number; // in milliseconds\r\n  lastTriggered?: number;\r\n}\r\n\r\ninterface MonitoringAlert {\r\n  id: string;\r\n  rule: string;\r\n  metric: string;\r\n  value: number;\r\n  target: number;\r\n  severity: 'info' | 'warning' | 'critical';\r\n  timestamp: number;\r\n  acknowledged: boolean;\r\n}\r\n\r\nexport class SLOMonitoringService {\r\n  private webVitalsTracker: WebVitalsTracker;\r\n  private conversionTracker: ConversionFunnelTracker;\r\n  private sloTargets: Map<string, SLOTarget> = new Map();\r\n  private alertRules: Map<string, AlertRule> = new Map();\r\n  private alerts: MonitoringAlert[] = [];\r\n  private monitoringIntervalId?: string;\r\n\r\n  constructor() {\r\n    this.webVitalsTracker = new WebVitalsTracker(this.handlePerformanceAlert.bind(this));\r\n    this.conversionTracker = new ConversionFunnelTracker();\r\n    this.initializeSLOs();\r\n    this.initializeAlertRules();\r\n    this.startMonitoring();\r\n  }\r\n\r\n  /**\r\n   * Initialize SLO targets\r\n   */\r\n  private initializeSLOs(): void {\r\n    // Performance SLOs\r\n    this.sloTargets.set('page_load_time', {\r\n      metric: 'page_load_time',\r\n      target: 1000, // 1 second\r\n      threshold: 1500, // Alert if > 1.5 seconds\r\n      timeWindow: 300000, // 5 minutes\r\n      alertOnBreach: true\r\n    });\r\n\r\n    this.sloTargets.set('LCP', {\r\n      metric: 'LCP',\r\n      target: 2500,\r\n      threshold: 4000,\r\n      timeWindow: 300000,\r\n      alertOnBreach: true\r\n    });\r\n\r\n    this.sloTargets.set('FID', {\r\n      metric: 'FID',\r\n      target: 100,\r\n      threshold: 300,\r\n      timeWindow: 300000,\r\n      alertOnBreach: true\r\n    });\r\n\r\n    this.sloTargets.set('CLS', {\r\n      metric: 'CLS',\r\n      target: 0.1,\r\n      threshold: 0.25,\r\n      timeWindow: 300000,\r\n      alertOnBreach: true\r\n    });\r\n\r\n    // Conversion SLOs\r\n    this.sloTargets.set('search_to_read_conversion', {\r\n      metric: 'search_to_read_conversion',\r\n      target: 15, // 15% conversion rate\r\n      threshold: 10, // Alert if < 10%\r\n      timeWindow: 3600000, // 1 hour\r\n      alertOnBreach: true\r\n    });\r\n\r\n    this.sloTargets.set('epub_load_time', {\r\n      metric: 'epub_load_time',\r\n      target: 2000,\r\n      threshold: 5000,\r\n      timeWindow: 300000,\r\n      alertOnBreach: true\r\n    });\r\n\r\n    console.log('ðŸŽ¯ SLO targets initialized:', this.sloTargets.size);\r\n  }\r\n\r\n  /**\r\n   * Initialize alert rules\r\n   */\r\n  private initializeAlertRules(): void {\r\n    this.alertRules.set('load_time_breach', {\r\n      id: 'load_time_breach',\r\n      name: 'Load Time SLO Breach',\r\n      condition: (value, target) => value > target,\r\n      severity: 'warning',\r\n      cooldown: 300000 // 5 minutes\r\n    });\r\n\r\n    this.alertRules.set('load_time_critical', {\r\n      id: 'load_time_critical',\r\n      name: 'Critical Load Time',\r\n      condition: (value, target) => value > target * 2,\r\n      severity: 'critical',\r\n      cooldown: 180000 // 3 minutes\r\n    });\r\n\r\n    this.alertRules.set('conversion_drop', {\r\n      id: 'conversion_drop',\r\n      name: 'Conversion Rate Drop',\r\n      condition: (value, target) => value < target * 0.7, // 30% drop\r\n      severity: 'warning',\r\n      cooldown: 1800000 // 30 minutes\r\n    });\r\n\r\n    this.alertRules.set('core_vitals_poor', {\r\n      id: 'core_vitals_poor',\r\n      name: 'Poor Core Web Vitals',\r\n      condition: (value, target) => value > target * 1.5,\r\n      severity: 'critical',\r\n      cooldown: 600000 // 10 minutes\r\n    });\r\n\r\n    console.log('ðŸš¨ Alert rules initialized:', this.alertRules.size);\r\n  }\r\n\r\n  /**\r\n   * Start monitoring\r\n   */\r\n  private startMonitoring(): void {\r\n    // Monitor every 30 seconds\r\n    this.monitoringIntervalId = cleanupManager.setInterval(() => {\r\n      this.checkSLOs();\r\n    }, 30000, 'SLOMonitoringService');\r\n\r\n    console.log('ðŸ“Š SLO monitoring started');\r\n  }\r\n\r\n  /**\r\n   * Check all SLOs\r\n   */\r\n  private checkSLOs(): void {\r\n    const webVitals = this.webVitalsTracker.getMetrics();\r\n    const conversionMetrics = this.conversionTracker.getConversionMetrics();\r\n\r\n    // Check performance SLOs\r\n    webVitals.forEach(metric => {\r\n      const slo = this.sloTargets.get(metric.name);\r\n      if (slo) {\r\n        this.evaluateMetric(metric.name, metric.value, slo);\r\n      }\r\n    });\r\n\r\n    // Check conversion SLOs\r\n    const searchToRead = conversionMetrics.conversionRates.searchToRead;\r\n    const searchToReadSLO = this.sloTargets.get('search_to_read_conversion');\r\n    if (searchToReadSLO && conversionMetrics.totalSearches > 0) {\r\n      this.evaluateMetric('search_to_read_conversion', searchToRead, searchToReadSLO);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Evaluate metric against SLO\r\n   */\r\n  private evaluateMetric(metricName: string, value: number, slo: SLOTarget): void {\r\n    const isBreached = value > slo.threshold || (metricName.includes('conversion') && value < slo.threshold);\r\n    \r\n    if (isBreached && slo.alertOnBreach) {\r\n      this.triggerAlert(metricName, value, slo);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Trigger alert\r\n   */\r\n  private triggerAlert(metric: string, value: number, slo: SLOTarget): void {\r\n    const severity = value > slo.threshold * 2 ? 'critical' : 'warning';\r\n    const ruleId = severity === 'critical' ? 'load_time_critical' : 'load_time_breach';\r\n    const rule = this.alertRules.get(ruleId);\r\n\r\n    if (!rule) return;\r\n\r\n    // Check cooldown\r\n    if (rule.lastTriggered && Date.now() - rule.lastTriggered < rule.cooldown) {\r\n      return;\r\n    }\r\n\r\n    const alert: MonitoringAlert = {\r\n      id: crypto.randomUUID(),\r\n      rule: rule.id,\r\n      metric,\r\n      value,\r\n      target: slo.target,\r\n      severity,\r\n      timestamp: Date.now(),\r\n      acknowledged: false\r\n    };\r\n\r\n    this.alerts.push(alert);\r\n    rule.lastTriggered = Date.now();\r\n\r\n    console.warn(`ðŸš¨ SLO Alert: ${metric} = ${value.toFixed(2)} (target: ${slo.target})`, alert);\r\n\r\n    // Trigger notification\r\n    this.notifyAlert(alert);\r\n  }\r\n\r\n  /**\r\n   * Handle performance alert from Web Vitals tracker\r\n   */\r\n  private handlePerformanceAlert(alert: any): void {\r\n    const monitoringAlert: MonitoringAlert = {\r\n      id: crypto.randomUUID(),\r\n      rule: 'web_vitals_alert',\r\n      metric: alert.metric,\r\n      value: alert.value,\r\n      target: alert.threshold,\r\n      severity: alert.severity,\r\n      timestamp: alert.timestamp,\r\n      acknowledged: false\r\n    };\r\n\r\n    this.alerts.push(monitoringAlert);\r\n    this.notifyAlert(monitoringAlert);\r\n  }\r\n\r\n  /**\r\n   * Notify alert (can be extended to send to external systems)\r\n   */\r\n  private notifyAlert(alert: MonitoringAlert): void {\r\n    // Browser notification\r\n    if ('Notification' in window && Notification.permission === 'granted') {\r\n      new Notification(`Performance Alert: ${alert.metric}`, {\r\n        body: `${alert.metric} exceeded threshold: ${alert.value.toFixed(2)}`,\r\n        icon: '/favicon.ico'\r\n      });\r\n    }\r\n\r\n    // Console notification\r\n    const emoji = alert.severity === 'critical' ? 'ðŸ”´' : 'ðŸŸ¡';\r\n    console.warn(`${emoji} Alert: ${alert.metric} = ${alert.value.toFixed(2)} (target: ${alert.target})`);\r\n\r\n    // Custom event for UI components\r\n    window.dispatchEvent(new CustomEvent('slo-alert', { \r\n      detail: alert \r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Get SLO compliance status\r\n   */\r\n  getSLOStatus(): Record<string, { status: 'passing' | 'failing'; value: number; target: number }> {\r\n    const status: Record<string, { status: 'passing' | 'failing'; value: number; target: number }> = {};\r\n    const webVitals = this.webVitalsTracker.getMetrics();\r\n    const conversionMetrics = this.conversionTracker.getConversionMetrics();\r\n\r\n    // Check Web Vitals\r\n    webVitals.forEach(metric => {\r\n      const slo = this.sloTargets.get(metric.name);\r\n      if (slo) {\r\n        status[metric.name] = {\r\n          status: metric.value <= slo.threshold ? 'passing' : 'failing',\r\n          value: metric.value,\r\n          target: slo.target\r\n        };\r\n      }\r\n    });\r\n\r\n    // Check conversion rates\r\n    const searchToRead = conversionMetrics.conversionRates.searchToRead;\r\n    const conversionSLO = this.sloTargets.get('search_to_read_conversion');\r\n    if (conversionSLO) {\r\n      status['search_to_read_conversion'] = {\r\n        status: searchToRead >= conversionSLO.threshold ? 'passing' : 'failing',\r\n        value: searchToRead,\r\n        target: conversionSLO.target\r\n      };\r\n    }\r\n\r\n    return status;\r\n  }\r\n\r\n  /**\r\n   * Get recent alerts\r\n   */\r\n  getAlerts(limit = 10): MonitoringAlert[] {\r\n    return this.alerts.slice(-limit).reverse();\r\n  }\r\n\r\n  /**\r\n   * Acknowledge alert\r\n   */\r\n  acknowledgeAlert(alertId: string): void {\r\n    const alert = this.alerts.find(a => a.id === alertId);\r\n    if (alert) {\r\n      alert.acknowledged = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get monitoring dashboard data\r\n   */\r\n  getDashboardData() {\r\n    return {\r\n      sloStatus: this.getSLOStatus(),\r\n      alerts: this.getAlerts(),\r\n      webVitals: this.webVitalsTracker.getMetrics(),\r\n      conversionMetrics: this.conversionTracker.getConversionMetrics(),\r\n      funnelData: this.conversionTracker.getFunnelData()\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Stop monitoring\r\n   */\r\n  stopMonitoring(): void {\r\n    if (this.monitoringIntervalId) {\r\n      cleanupManager.cleanup(this.monitoringIntervalId);\r\n      this.monitoringIntervalId = undefined;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Request notification permission\r\n   */\r\n  async requestNotificationPermission(): Promise<boolean> {\r\n    if ('Notification' in window) {\r\n      const permission = await Notification.requestPermission();\r\n      return permission === 'granted';\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\n// Global monitoring instance\r\nexport const sloMonitoringService = new SLOMonitoringService();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\monitoring\\WebVitalsTracker.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2392,2395],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2392,2395],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2870,2873],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2870,2873],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":152,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4199,4202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4199,4202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Web Vitals Performance Tracking\r\n * Tracks Core Web Vitals and custom performance metrics\r\n */\r\n\r\ninterface WebVitalMetric {\r\n  name: string;\r\n  value: number;\r\n  rating: 'good' | 'needs-improvement' | 'poor';\r\n  delta: number;\r\n  id: string;\r\n  timestamp: number;\r\n}\r\n\r\ninterface PerformanceAlert {\r\n  metric: string;\r\n  value: number;\r\n  threshold: number;\r\n  severity: 'warning' | 'critical';\r\n  timestamp: number;\r\n}\r\n\r\nexport class WebVitalsTracker {\r\n  private metrics: Map<string, WebVitalMetric> = new Map();\r\n  private alerts: PerformanceAlert[] = [];\r\n  private observer: PerformanceObserver | null = null;\r\n  private alertCallback?: (alert: PerformanceAlert) => void;\r\n\r\n  // SLO thresholds\r\n  private readonly SLO_THRESHOLDS = {\r\n    LCP: 2500, // Largest Contentful Paint\r\n    FID: 100,  // First Input Delay\r\n    CLS: 0.1,  // Cumulative Layout Shift\r\n    TTFB: 800, // Time to First Byte\r\n    FCP: 1800, // First Contentful Paint\r\n    INP: 200   // Interaction to Next Paint\r\n  };\r\n\r\n  constructor(alertCallback?: (alert: PerformanceAlert) => void) {\r\n    this.alertCallback = alertCallback;\r\n    this.initializeTracking();\r\n  }\r\n\r\n  /**\r\n   * Initialize Web Vitals tracking\r\n   */\r\n  private initializeTracking(): void {\r\n    // Track Core Web Vitals using the web-vitals library pattern\r\n    this.trackLCP();\r\n    this.trackFID();\r\n    this.trackCLS();\r\n    this.trackTTFB();\r\n    this.trackFCP();\r\n    this.trackINP();\r\n\r\n    // Track custom performance metrics\r\n    this.trackResourceTiming();\r\n    this.trackNavigationTiming();\r\n\r\n    console.log('ðŸ” Web Vitals tracking initialized');\r\n  }\r\n\r\n  /**\r\n   * Track Largest Contentful Paint\r\n   */\r\n  private trackLCP(): void {\r\n    if (!('PerformanceObserver' in window)) return;\r\n\r\n    const observer = new PerformanceObserver((entryList) => {\r\n      const entries = entryList.getEntries();\r\n      const lastEntry = entries[entries.length - 1] as PerformanceEntry & { startTime: number };\r\n      \r\n      this.recordMetric('LCP', lastEntry.startTime);\r\n    });\r\n\r\n    observer.observe({ type: 'largest-contentful-paint', buffered: true });\r\n  }\r\n\r\n  /**\r\n   * Track First Input Delay\r\n   */\r\n  private trackFID(): void {\r\n    if (!('PerformanceObserver' in window)) return;\r\n\r\n    const observer = new PerformanceObserver((entryList) => {\r\n      const entries = entryList.getEntries();\r\n      entries.forEach((entry: any) => {\r\n        this.recordMetric('FID', entry.processingStart - entry.startTime);\r\n      });\r\n    });\r\n\r\n    observer.observe({ type: 'first-input', buffered: true });\r\n  }\r\n\r\n  /**\r\n   * Track Cumulative Layout Shift\r\n   */\r\n  private trackCLS(): void {\r\n    if (!('PerformanceObserver' in window)) return;\r\n\r\n    let clsValue = 0;\r\n    const observer = new PerformanceObserver((entryList) => {\r\n      const entries = entryList.getEntries();\r\n      entries.forEach((entry: any) => {\r\n        if (!entry.hadRecentInput) {\r\n          clsValue += entry.value;\r\n          this.recordMetric('CLS', clsValue);\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe({ type: 'layout-shift', buffered: true });\r\n  }\r\n\r\n  /**\r\n   * Track Time to First Byte\r\n   */\r\n  private trackTTFB(): void {\r\n    const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\r\n    if (navigation) {\r\n      const ttfb = navigation.responseStart - navigation.requestStart;\r\n      this.recordMetric('TTFB', ttfb);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Track First Contentful Paint\r\n   */\r\n  private trackFCP(): void {\r\n    if (!('PerformanceObserver' in window)) return;\r\n\r\n    const observer = new PerformanceObserver((entryList) => {\r\n      const entries = entryList.getEntries();\r\n      entries.forEach((entry) => {\r\n        if (entry.name === 'first-contentful-paint') {\r\n          this.recordMetric('FCP', entry.startTime);\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe({ type: 'paint', buffered: true });\r\n  }\r\n\r\n  /**\r\n   * Track Interaction to Next Paint\r\n   */\r\n  private trackINP(): void {\r\n    if (!('PerformanceObserver' in window)) return;\r\n\r\n    const observer = new PerformanceObserver((entryList) => {\r\n      const entries = entryList.getEntries();\r\n      entries.forEach((entry: any) => {\r\n        const inp = entry.processingEnd - entry.startTime;\r\n        this.recordMetric('INP', inp);\r\n      });\r\n    });\r\n\r\n    observer.observe({ type: 'event', buffered: true });\r\n  }\r\n\r\n  /**\r\n   * Track resource loading performance\r\n   */\r\n  private trackResourceTiming(): void {\r\n    if (!('PerformanceObserver' in window)) return;\r\n\r\n    const observer = new PerformanceObserver((entryList) => {\r\n      const entries = entryList.getEntries();\r\n      entries.forEach((entry: PerformanceResourceTiming) => {\r\n        // Track specific resource types\r\n        if (entry.name.includes('.epub') || entry.name.includes('.pdf')) {\r\n          const loadTime = entry.responseEnd - entry.startTime;\r\n          this.recordCustomMetric(`${entry.initiatorType}_load_time`, loadTime);\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe({ type: 'resource', buffered: true });\r\n  }\r\n\r\n  /**\r\n   * Track navigation timing\r\n   */\r\n  private trackNavigationTiming(): void {\r\n    const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\r\n    if (navigation) {\r\n      const domLoad = navigation.domContentLoadedEventEnd - navigation.fetchStart;\r\n      const windowLoad = navigation.loadEventEnd - navigation.fetchStart;\r\n      \r\n      this.recordCustomMetric('dom_load_time', domLoad);\r\n      this.recordCustomMetric('window_load_time', windowLoad);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Record a Web Vital metric\r\n   */\r\n  private recordMetric(name: string, value: number): void {\r\n    const rating = this.getRating(name, value);\r\n    const metric: WebVitalMetric = {\r\n      name,\r\n      value,\r\n      rating,\r\n      delta: value - (this.metrics.get(name)?.value || 0),\r\n      id: crypto.randomUUID(),\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    this.metrics.set(name, metric);\r\n    \r\n    // Check SLO and trigger alerts\r\n    this.checkSLOCompliance(name, value);\r\n    \r\n    console.log(`ðŸ“Š ${name}: ${value.toFixed(2)}ms (${rating})`);\r\n  }\r\n\r\n  /**\r\n   * Record custom performance metric\r\n   */\r\n  recordCustomMetric(name: string, value: number): void {\r\n    const metric: WebVitalMetric = {\r\n      name,\r\n      value,\r\n      rating: 'good', // Custom metrics don't have standard ratings\r\n      delta: 0,\r\n      id: crypto.randomUUID(),\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    this.metrics.set(name, metric);\r\n    console.log(`ðŸ“ˆ Custom metric ${name}: ${value.toFixed(2)}ms`);\r\n  }\r\n\r\n  /**\r\n   * Get performance rating for a metric\r\n   */\r\n  private getRating(name: string, value: number): 'good' | 'needs-improvement' | 'poor' {\r\n    const thresholds: Record<string, [number, number]> = {\r\n      LCP: [2500, 4000],\r\n      FID: [100, 300],\r\n      CLS: [0.1, 0.25],\r\n      TTFB: [800, 1800],\r\n      FCP: [1800, 3000],\r\n      INP: [200, 500]\r\n    };\r\n\r\n    const [good, poor] = thresholds[name] || [0, 0];\r\n    \r\n    if (value <= good) return 'good';\r\n    if (value <= poor) return 'needs-improvement';\r\n    return 'poor';\r\n  }\r\n\r\n  /**\r\n   * Check SLO compliance and trigger alerts\r\n   */\r\n  private checkSLOCompliance(metric: string, value: number): void {\r\n    const threshold = this.SLO_THRESHOLDS[metric as keyof typeof this.SLO_THRESHOLDS];\r\n    \r\n    if (threshold && value > threshold) {\r\n      const severity: 'warning' | 'critical' = value > threshold * 1.5 ? 'critical' : 'warning';\r\n      \r\n      const alert: PerformanceAlert = {\r\n        metric,\r\n        value,\r\n        threshold,\r\n        severity,\r\n        timestamp: Date.now()\r\n      };\r\n\r\n      this.alerts.push(alert);\r\n      \r\n      if (this.alertCallback) {\r\n        this.alertCallback(alert);\r\n      }\r\n\r\n      console.warn(`ðŸš¨ SLO Alert: ${metric} = ${value.toFixed(2)}ms (threshold: ${threshold}ms)`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current metrics\r\n   */\r\n  getMetrics(): WebVitalMetric[] {\r\n    return Array.from(this.metrics.values());\r\n  }\r\n\r\n  /**\r\n   * Get recent alerts\r\n   */\r\n  getAlerts(): PerformanceAlert[] {\r\n    return this.alerts.slice(-10); // Return last 10 alerts\r\n  }\r\n\r\n  /**\r\n   * Get SLO compliance report\r\n   */\r\n  getSLOReport(): Record<string, { compliant: boolean; value: number; threshold: number }> {\r\n    const report: Record<string, { compliant: boolean; value: number; threshold: number }> = {};\r\n    \r\n    Object.entries(this.SLO_THRESHOLDS).forEach(([metric, threshold]) => {\r\n      const current = this.metrics.get(metric);\r\n      report[metric] = {\r\n        compliant: current ? current.value <= threshold : true,\r\n        value: current?.value || 0,\r\n        threshold\r\n      };\r\n    });\r\n\r\n    return report;\r\n  }\r\n\r\n  /**\r\n   * Clear metrics and alerts\r\n   */\r\n  reset(): void {\r\n    this.metrics.clear();\r\n    this.alerts.length = 0;\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\museum\\CacheManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\museum\\FallbackData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\museum\\MetMuseumAPI.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[868,871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[868,871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { MuseumItem, APIConfig } from './types';\r\n\r\nexport class MetMuseumAPI {\r\n  private readonly BASE_URL = 'https://collectionapi.metmuseum.org/public/collection/v1';\r\n  private readonly config: APIConfig;\r\n\r\n  constructor(config: APIConfig) {\r\n    this.config = config;\r\n  }\r\n\r\n  private async fetchWithTimeout(url: string): Promise<Response> {\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), this.config.timeout);\r\n    \r\n    try {\r\n      const response = await fetch(url, {\r\n        signal: controller.signal,\r\n        mode: 'cors',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n        }\r\n      });\r\n      clearTimeout(timeoutId);\r\n      return response;\r\n    } catch (error) {\r\n      clearTimeout(timeoutId);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private generateDescription(metData: any): string {\r\n    const parts = [];\r\n    \r\n    if (metData.objectName) parts.push(metData.objectName);\r\n    if (metData.artistDisplayName) parts.push(`by ${metData.artistDisplayName}`);\r\n    if (metData.culture) parts.push(`from ${metData.culture}`);\r\n    if (metData.period) parts.push(`(${metData.period})`);\r\n    \r\n    const description = parts.length > 0 \r\n      ? parts.join(' ') + ' from the Metropolitan Museum of Art collection.'\r\n      : 'An artwork from the Metropolitan Museum of Art collection.';\r\n    \r\n    return description;\r\n  }\r\n\r\n  private validateImageUrl(imageUrl: string | null): boolean {\r\n    if (!imageUrl) return false;\r\n    \r\n    // Check if it's a valid museum image URL\r\n    const isValidMetImage = imageUrl.includes('collectionapi.metmuseum.org') || \r\n                           imageUrl.includes('metmuseum.org');\r\n    \r\n    if (!isValidMetImage) {\r\n      console.warn('ðŸ›ï¸ Met: Non-museum image URL detected:', imageUrl);\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }\r\n\r\n  async fetchItems(): Promise<MuseumItem[]> {\r\n    const searchUrl = `${this.BASE_URL}/search?hasImages=true&q=ancient OR classical OR sculpture OR pottery&departmentId=11`;\r\n    const searchResponse = await this.fetchWithTimeout(searchUrl);\r\n    \r\n    if (!searchResponse.ok) {\r\n      throw new Error(`Met search API error: ${searchResponse.status}`);\r\n    }\r\n\r\n    const searchData = await searchResponse.json();\r\n    const objectIDs = searchData.objectIDs || [];\r\n    \r\n    if (objectIDs.length === 0) {\r\n      throw new Error('No objects found in Met Museum search');\r\n    }\r\n\r\n    // Get random selection of 5 objects\r\n    const selectedIDs = [];\r\n    for (let i = 0; i < Math.min(5, objectIDs.length); i++) {\r\n      const randomIndex = Math.floor(Math.random() * objectIDs.length);\r\n      selectedIDs.push(objectIDs[randomIndex]);\r\n    }\r\n\r\n    const items: MuseumItem[] = [];\r\n    \r\n    for (const objectID of selectedIDs) {\r\n      try {\r\n        const objectUrl = `${this.BASE_URL}/objects/${objectID}`;\r\n        const objectResponse = await this.fetchWithTimeout(objectUrl);\r\n        \r\n        if (objectResponse.ok) {\r\n          const objectData = await objectResponse.json();\r\n          \r\n          // Prioritize primaryImage, fall back to primaryImageSmall\r\n          const imageUrl = objectData.primaryImage || objectData.primaryImageSmall;\r\n          \r\n          if (this.validateImageUrl(imageUrl)) {\r\n            console.log(`ðŸ›ï¸ Met: Object ${objectID} has valid image:`, imageUrl);\r\n            \r\n            items.push({\r\n              id: `met-${objectID}`,\r\n              title: objectData.title || 'Untitled Artwork',\r\n              description: this.generateDescription(objectData),\r\n              thumbnail: imageUrl,\r\n              source: 'met' as const,\r\n              isThreeD: false,\r\n              metadata: {\r\n                artist: objectData.artistDisplayName,\r\n                date: objectData.objectDate,\r\n                medium: objectData.medium,\r\n                culture: objectData.culture,\r\n                dimensions: objectData.dimensions\r\n              }\r\n            });\r\n          } else {\r\n            console.warn(`ðŸ›ï¸ Met: Object ${objectID} missing valid primaryImage`);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.warn(`ðŸ›ï¸ Met: Failed to fetch object ${objectID}:`, error);\r\n      }\r\n    }\r\n\r\n    console.log(`ðŸ›ï¸ Met: Retrieved ${items.length} valid items`);\r\n    return items;\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\museum\\SmithsonianAPI.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[902,905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[902,905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2102,2105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2102,2105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { MuseumItem, APIConfig } from './types';\r\n\r\nexport class SmithsonianAPI {\r\n  private readonly API_KEY = 'DEMO_KEY';\r\n  private readonly BASE_URL = 'https://api.si.edu/openaccess/api/v1.0';\r\n  private readonly config: APIConfig;\r\n\r\n  constructor(config: APIConfig) {\r\n    this.config = config;\r\n  }\r\n\r\n  private async fetchWithTimeout(url: string): Promise<Response> {\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), this.config.timeout);\r\n    \r\n    try {\r\n      const response = await fetch(url, {\r\n        signal: controller.signal,\r\n        mode: 'cors',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n        }\r\n      });\r\n      clearTimeout(timeoutId);\r\n      return response;\r\n    } catch (error) {\r\n      clearTimeout(timeoutId);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private generateDescription(smithsonianData: any): string {\r\n    const notes = smithsonianData.content?.freetext?.notes;\r\n    if (notes && notes.length > 0) {\r\n      return notes[0].content || 'A fascinating artifact from the Smithsonian collection.';\r\n    }\r\n    return 'A remarkable piece from the Smithsonian Institution collection.';\r\n  }\r\n\r\n  private validateImageUrl(imageUrl: string | null): boolean {\r\n    if (!imageUrl) return false;\r\n    \r\n    // Check if it's a valid Smithsonian image URL\r\n    const isValidSIImage = imageUrl.includes('si.edu') || \r\n                          imageUrl.includes('smithsonian');\r\n    \r\n    if (!isValidSIImage) {\r\n      console.warn('ðŸ›ï¸ Smithsonian: Non-museum image URL detected:', imageUrl);\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }\r\n\r\n  async fetchItems(): Promise<MuseumItem[]> {\r\n    const url = `${this.BASE_URL}/search?q=online_media_type:\"Images\"&rows=5&api_key=${this.API_KEY}`;\r\n    \r\n    const response = await this.fetchWithTimeout(url);\r\n    if (!response.ok) {\r\n      throw new Error(`Smithsonian API error: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    const items: MuseumItem[] = [];\r\n    \r\n    (data.response?.rows || []).forEach((item: any, index: number) => {\r\n      const media = item.content?.descriptiveNonRepeating?.online_media?.media;\r\n      const imageUrl = media?.[0]?.content || media?.[0]?.thumbnail;\r\n      \r\n      if (this.validateImageUrl(imageUrl)) {\r\n        console.log(`ðŸ›ï¸ Smithsonian: Item ${item.id} has valid image:`, imageUrl);\r\n        \r\n        items.push({\r\n          id: item.id || `smithsonian-${index}`,\r\n          title: item.title || 'Smithsonian Artifact',\r\n          description: this.generateDescription(item),\r\n          thumbnail: imageUrl,\r\n          embedUrl: media?.[0]?.content,\r\n          source: 'smithsonian' as const,\r\n          isThreeD: item.content?.descriptiveNonRepeating?.online_media?.mediaType === '3d model',\r\n          metadata: {\r\n            date: item.content?.indexedStructured?.date?.[0],\r\n            culture: item.content?.indexedStructured?.culture?.[0],\r\n            medium: item.content?.indexedStructured?.object_type?.[0]\r\n          }\r\n        });\r\n      } else {\r\n        console.warn(`ðŸ›ï¸ Smithsonian: Item ${item.id} missing valid image`);\r\n      }\r\n    });\r\n\r\n    console.log(`ðŸ›ï¸ Smithsonian: Retrieved ${items.length} valid items`);\r\n    return items;\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\museum\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\opdsService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\performance\\CacheConfigManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\performance\\ImageOptimizer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\performance\\PerformanceMetricsTracker.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\services\\performance\\PrefetchManager.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[205,208],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[205,208],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[254,257],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[254,257],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[362,365],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[362,365],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1825,1828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1825,1828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1839,1842],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1839,1842],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2957,2960],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2957,2960],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":121,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3889,3892],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3889,3892],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":140,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4374,4377],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4374,4377],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":157,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4832,4835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4832,4835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":196,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":196,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6044,6047],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6044,6047],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n/**\r\n * Prefetch Management for Books and Search Results\r\n */\r\n\r\nimport { indexedDBCache } from '../IndexedDBCacheService';\r\n\r\nexport class PrefetchManager {\r\n  private prefetchedBooks = new Map<string, any>();\r\n  private searchCache = new Map<string, any>();\r\n\r\n  /**\r\n   * Enhanced prefetch with streaming support\r\n   */\r\n  async prefetchPopularBooks(books: any[], popularBooksCount: number, streamingEnabled: boolean): Promise<number> {\r\n    const popularBooks = books.slice(0, popularBooksCount);\r\n    \r\n    console.log('ðŸš€ Enhanced prefetching with streaming for', popularBooks.length, 'books...');\r\n    \r\n    const prefetchPromises = popularBooks.map(async (book) => {\r\n      try {\r\n        // Enhanced prefetch with metadata priority\r\n        const prefetchData = {\r\n          ...book,\r\n          metadata: await this.prefetchBookMetadata(book),\r\n          coverCached: await this.prefetchBookCover(book),\r\n          streamingOptimized: streamingEnabled,\r\n          prefetchedAt: Date.now()\r\n        };\r\n        \r\n        this.prefetchedBooks.set(book.id, prefetchData);\r\n        \r\n        // Cache in IndexedDB for persistence\r\n        await indexedDBCache.set(`prefetch:${book.id}`, prefetchData, 'metadata');\r\n        \r\n        return prefetchData;\r\n      } catch (error) {\r\n        console.warn('Enhanced prefetch failed for book:', book.id, error);\r\n        return null;\r\n      }\r\n    });\r\n\r\n    const results = await Promise.allSettled(prefetchPromises);\r\n    const successCount = results.filter(r => r.status === 'fulfilled' && r.value).length;\r\n    \r\n    console.log(`âœ… Enhanced prefetch completed: ${successCount}/${popularBooks.length} books`);\r\n    return successCount / popularBooks.length;\r\n  }\r\n\r\n  /**\r\n   * Prefetch book metadata for faster loading\r\n   */\r\n  private async prefetchBookMetadata(book: any): Promise<any> {\r\n    try {\r\n      if (book.epub_url) {\r\n        // Quick metadata extraction without full download\r\n        const metadataUrl = `${book.epub_url}?metadata_only=true`;\r\n        \r\n        // Create AbortController for timeout\r\n        const controller = new AbortController();\r\n        const timeoutId = setTimeout(() => controller.abort(), 3000);\r\n        \r\n        const response = await fetch(metadataUrl, { \r\n          method: 'HEAD',\r\n          signal: controller.signal\r\n        });\r\n        \r\n        clearTimeout(timeoutId);\r\n        \r\n        if (response.ok) {\r\n          return {\r\n            contentLength: response.headers.get('content-length'),\r\n            lastModified: response.headers.get('last-modified'),\r\n            etag: response.headers.get('etag'),\r\n            supportsRanges: response.headers.get('accept-ranges') === 'bytes'\r\n          };\r\n        }\r\n      }\r\n      return null;\r\n    } catch (error) {\r\n      console.warn('Metadata prefetch failed:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Prefetch and cache book covers\r\n   */\r\n  private async prefetchBookCover(book: any): Promise<boolean> {\r\n    try {\r\n      if (book.cover_url) {\r\n        const cacheKey = `cover:${book.id}`;\r\n        \r\n        // Check if already cached\r\n        const cached = await indexedDBCache.get(cacheKey);\r\n        if (cached) return true;\r\n\r\n        // Prefetch cover\r\n        const response = await fetch(book.cover_url);\r\n        if (response.ok) {\r\n          const coverData = await response.arrayBuffer();\r\n          await indexedDBCache.set(cacheKey, {\r\n            data: coverData,\r\n            contentType: response.headers.get('content-type'),\r\n            cachedAt: Date.now()\r\n          }, 'cover');\r\n          \r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    } catch (error) {\r\n      console.warn('Cover prefetch failed:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get prefetched book data with IndexedDB fallback\r\n   */\r\n  async getPrefetchedBook(bookId: string): Promise<any | null> {\r\n    // Check memory cache first\r\n    let book = this.prefetchedBooks.get(bookId);\r\n    \r\n    if (!book) {\r\n      // Check IndexedDB cache\r\n      book = await indexedDBCache.get(`prefetch:${bookId}`);\r\n      if (book) {\r\n        // Restore to memory cache\r\n        this.prefetchedBooks.set(bookId, book);\r\n      }\r\n    }\r\n    \r\n    return book || null;\r\n  }\r\n\r\n  /**\r\n   * Enhanced search caching with IndexedDB\r\n   */\r\n  async cacheSearchResults(query: string, results: any[]): Promise<void> {\r\n    const cacheKey = `search:${query.toLowerCase()}`;\r\n    \r\n    // Cache in memory\r\n    this.searchCache.set(cacheKey, results);\r\n    \r\n    // Cache in IndexedDB for persistence\r\n    await indexedDBCache.set(cacheKey, {\r\n      query,\r\n      results,\r\n      cachedAt: Date.now()\r\n    }, 'metadata');\r\n  }\r\n\r\n  /**\r\n   * Get cached search results with IndexedDB fallback\r\n   */\r\n  async getCachedSearchResults(query: string): Promise<any | null> {\r\n    const cacheKey = `search:${query.toLowerCase()}`;\r\n    \r\n    // Check memory cache first\r\n    let results = this.searchCache.get(cacheKey);\r\n    \r\n    if (!results) {\r\n      // Check IndexedDB cache\r\n      const cached = await indexedDBCache.get(cacheKey);\r\n      if (cached && this.isSearchCacheFresh(cached)) {\r\n        results = cached.results;\r\n        // Restore to memory cache\r\n        this.searchCache.set(cacheKey, results);\r\n      }\r\n    }\r\n    \r\n    return results || null;\r\n  }\r\n\r\n  /**\r\n   * Prefetch search results for popular queries\r\n   */\r\n  async prefetchSearchResults(queries: string[]): Promise<void> {\r\n    console.log('ðŸ” Prefetching search results for popular queries...');\r\n    \r\n    for (const query of queries) {\r\n      try {\r\n        // Check if already cached\r\n        const cached = await this.getCachedSearchResults(query);\r\n        if (cached) continue;\r\n        \r\n        // This would typically make an API call to prefetch results\r\n        console.log(`ðŸ“ Would prefetch results for: \"${query}\"`);\r\n      } catch (error) {\r\n        console.warn(`Failed to prefetch search for \"${query}\":`, error);\r\n      }\r\n    }\r\n  }\r\n\r\n  private isSearchCacheFresh(cached: any): boolean {\r\n    const age = Date.now() - cached.cachedAt;\r\n    return age < 30 * 60 * 1000; // 30 minutes\r\n  }\r\n\r\n  getPrefetchStats() {\r\n    return {\r\n      prefetchedBooksCount: this.prefetchedBooks.size,\r\n      cachedSearchesCount: this.searchCache.size\r\n    };\r\n  }\r\n\r\n  clearCaches(): void {\r\n    this.prefetchedBooks.clear();\r\n    this.searchCache.clear();\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\ai-coach.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\analytics-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\challenges.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\cmi12.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\cmi2004.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\common-interfaces.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[452,455],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[452,455],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[617,620],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[617,620],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[631,634],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[631,634],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[654,657],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[654,657],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Common TypeScript interfaces to replace 'any' types\r\n */\r\n\r\nexport interface TrackingData {\r\n  event: string;\r\n  timestamp: Date;\r\n  userId?: string;\r\n  sessionId?: string;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface InteractionEvent {\r\n  type: string;\r\n  data: Record<string, unknown>;\r\n  timestamp: Date;\r\n}\r\n\r\nexport interface NavigationItem {\r\n  id?: string;\r\n  title: string;\r\n  href?: string;\r\n  url?: string;\r\n  icon?: any;\r\n  badge?: string | number;\r\n  children?: NavigationItem[];\r\n  isExternal?: boolean;\r\n}\r\n\r\nexport interface FileUploadPayload {\r\n  eventType?: string;\r\n  new?: any;\r\n  old?: any;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface ChatMessage {\r\n  id: string;\r\n  role: 'user' | 'assistant' | 'system';\r\n  content: string;\r\n  timestamp: Date;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface QuizResults {\r\n  score: number;\r\n  totalQuestions: number;\r\n  correctAnswers: number;\r\n  timeSpent: number;\r\n  questionResults: QuestionResult[];\r\n}\r\n\r\nexport interface QuestionResult {\r\n  questionId: string;\r\n  correct: boolean;\r\n  userAnswer: string | string[];\r\n  correctAnswer: string | string[];\r\n  timeSpent?: number;\r\n}\r\n\r\nexport interface ChallengeCard {\r\n  id: string;\r\n  question: string;\r\n  options?: string[];\r\n  correctAnswer: string | number;\r\n  explanation?: string;\r\n  difficulty?: 'easy' | 'medium' | 'hard';\r\n  category?: string;\r\n}\r\n\r\nexport interface UserPerformanceMetric {\r\n  userId: string;\r\n  metric: string;\r\n  value: number;\r\n  timestamp: Date;\r\n  category?: string;\r\n}\r\n\r\nexport interface BookData {\r\n  id: string;\r\n  title: string;\r\n  author: string;\r\n  isbn?: string;\r\n  publicDomain: boolean;\r\n  coverUrl?: string;\r\n  fileUrl?: string;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface SelectChangeHandler {\r\n  (value: string): void;\r\n}\r\n\r\nexport interface FormInputChangeHandler {\r\n  (field: string, value: string | number | boolean): void;\r\n}\r\n\r\nexport interface ThresholdConfig {\r\n  id: string;\r\n  metricName: string;\r\n  warningThreshold: number;\r\n  criticalThreshold: number;\r\n  enabled: boolean;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport interface SystemHealthMetric {\r\n  name: string;\r\n  value: number;\r\n  threshold: number;\r\n  status: 'healthy' | 'warning' | 'critical';\r\n  lastUpdated: Date;\r\n}\r\n\r\nexport interface ContentSection {\r\n  id: string;\r\n  title: string;\r\n  content: string;\r\n  type: 'text' | 'list' | 'media';\r\n  items?: ContentItem[];\r\n}\r\n\r\nexport interface ContentItem {\r\n  id: string;\r\n  title: string;\r\n  description?: string;\r\n  url?: string;\r\n  type: 'link' | 'document' | 'video' | 'image';\r\n}\r\n\r\nexport interface GuideContent {\r\n  sections: ContentSection[];\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface RubricCriterion {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  weight: number;\r\n  levels: RubricLevel[];\r\n}\r\n\r\nexport interface RubricLevel {\r\n  score: number;\r\n  description: string;\r\n  indicators?: string[];\r\n}\r\n\r\nexport interface RubricContent {\r\n  rubrics: Rubric[];\r\n}\r\n\r\nexport interface Rubric {\r\n  id: string;\r\n  title: string;\r\n  description?: string;\r\n  criteria: RubricCriterion[];\r\n  totalPoints: number;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\common.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1064,1067],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1064,1067],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1423,1426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1423,1426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Common interface definitions used across the application\r\n * Consolidated to reduce duplication and ensure consistency\r\n */\r\n\r\nimport { ReactNode, ErrorInfo } from 'react';\r\n\r\n// Error Boundary Props - Consolidated interface\r\nexport interface ErrorBoundaryProps {\r\n  children: ReactNode;\r\n  fallback?: ReactNode;\r\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\r\n  showDetails?: boolean;\r\n  resetOnPropsChange?: boolean;\r\n}\r\n\r\n// Generic component props patterns\r\nexport interface BaseComponentProps {\r\n  className?: string;\r\n  children?: ReactNode;\r\n}\r\n\r\n// Common loading and error states\r\nexport interface AsyncState {\r\n  loading: boolean;\r\n  error: string | null;\r\n}\r\n\r\n// API response wrapper\r\nexport interface ApiResponse<T> {\r\n  data: T;\r\n  success: boolean;\r\n  error?: string;\r\n  timestamp?: string;\r\n}\r\n\r\n// Pagination interface\r\nexport interface PaginationParams {\r\n  page: number;\r\n  limit: number;\r\n  total?: number;\r\n}\r\n\r\n// Search and filter interfaces\r\nexport interface SearchParams {\r\n  query: string;\r\n  filters?: Record<string, any>;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\n// File upload related\r\nexport interface FileUploadProgress {\r\n  progress: number;\r\n  status: 'pending' | 'uploading' | 'completed' | 'failed';\r\n  error?: string;\r\n}\r\n\r\n// User activity tracking\r\nexport interface UserActivity {\r\n  action: string;\r\n  timestamp: Date;\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\n// Admin and feedback interfaces\r\nexport interface FeedbackData {\r\n  id: string;\r\n  name: string;\r\n  email: string;\r\n  category: string;\r\n  message: string;\r\n  status: string; // Allow any status string from database\r\n  created_at: string;\r\n  updated_at?: string;\r\n  user_id?: string;\r\n  company?: string;\r\n}\r\n\r\nexport interface UserFilters {\r\n  role?: string[];\r\n  status?: string[];\r\n  search?: string; // Add search property\r\n  dateRange?: {\r\n    start: Date;\r\n    end: Date;\r\n  };\r\n  searchQuery?: string;\r\n}\r\n\r\nexport interface ModuleData {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  content: string;\r\n  type: 'lesson' | 'quiz' | 'assessment';\r\n  status: 'draft' | 'published' | 'archived';\r\n  created_at: string;\r\n  updated_at?: string;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface TestResult {\r\n  id: string;\r\n  name?: string;\r\n  test?: string;\r\n  status: 'pass' | 'fail' | 'pending' | 'passed' | 'failed' | 'testing' | 'received';\r\n  message: string;\r\n  duration?: number;\r\n  timestamp: Date;\r\n  category?: string;\r\n  details?: Record<string, unknown>;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\course.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\errors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\goals.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\interfaces.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[998,1001],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[998,1001],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1210,1213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1210,1213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1766,1769],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1766,1769],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Standardized interface definitions for component props\r\n * This file consolidates commonly used prop interfaces to reduce duplication\r\n */\r\n\r\nimport { ReactNode } from 'react';\r\n\r\n// Base interfaces for consistent prop patterns\r\nexport interface BaseProps {\r\n  className?: string;\r\n  children?: ReactNode;\r\n}\r\n\r\nexport interface TriggerProps {\r\n  trigger?: ReactNode;\r\n}\r\n\r\nexport interface LoadingProps {\r\n  loading?: boolean;\r\n}\r\n\r\nexport interface ErrorProps {\r\n  error?: string | null;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\n// Provider component props\r\nexport interface ProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\n// Modal and dialog props\r\nexport interface ModalProps extends BaseProps {\r\n  open?: boolean;\r\n  onOpenChange?: (open: boolean) => void;\r\n  title?: string;\r\n}\r\n\r\n// Card component props\r\nexport interface CardProps extends BaseProps {\r\n  title?: string;\r\n  description?: string;\r\n  action?: ReactNode;\r\n}\r\n\r\n// Table component props\r\nexport interface TableProps<T = any> extends BaseProps {\r\n  data: T[];\r\n  loading?: boolean;\r\n  error?: string | null;\r\n  onRefresh?: () => void;\r\n}\r\n\r\n// Form component props\r\nexport interface FormProps extends BaseProps {\r\n  onSubmit: (data: any) => void | Promise<void>;\r\n  loading?: boolean;\r\n  disabled?: boolean;\r\n}\r\n\r\n// Button-like component props\r\nexport interface ActionProps {\r\n  onClick?: () => void | Promise<void>;\r\n  disabled?: boolean;\r\n  loading?: boolean;\r\n}\r\n\r\n// Chat and messaging props\r\nexport interface ChatProps extends BaseProps {\r\n  sessionId?: string;\r\n  userId?: string;\r\n  onMessageSent?: (message: string) => void;\r\n}\r\n\r\n// Analytics and monitoring props\r\nexport interface AnalyticsProps {\r\n  trackingId?: string;\r\n  eventCategory?: string;\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\n// File upload props\r\nexport interface UploadProps extends BaseProps {\r\n  onUpload: (files: File[]) => void | Promise<void>;\r\n  accept?: string;\r\n  multiple?: boolean;\r\n  maxSize?: number;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\library.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\organization.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1633,1636],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1633,1636],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2353,2356],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2353,2356],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2790,2793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2790,2793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export type OrgSubscriptionTier = 'basic' | 'standard' | 'premium' | 'beta';\r\nexport type NoteVisibilityScope = 'student-only' | 'instructor-visible' | 'org-public';\r\nexport type InvitationStatus = 'pending' | 'accepted' | 'declined' | 'expired';\r\nexport type MemberRole = 'owner' | 'instructor' | 'student';\r\nexport type MemberStatus = 'active' | 'paused' | 'blocked' | 'removed';\r\n\r\nexport interface Organization {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  owner_id: string;\r\n  plan: OrgSubscriptionTier;\r\n  seat_cap: number;\r\n  seats_used: number;\r\n  instructors_used: number;\r\n  instructor_limit: number;\r\n  brand_primary?: string;\r\n  brand_accent?: string;\r\n  logo_url?: string;\r\n  slug: string;\r\n  is_suspended?: boolean;\r\n  suspended_at?: string;\r\n  suspended_by?: string;\r\n  suspended_reason?: string;\r\n  status: 'active' | 'suspended' | 'deleted';\r\n  created_by: string;\r\n  created_at: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport interface OrgMember {\r\n  id: string;\r\n  org_id: string;\r\n  user_id: string;\r\n  role: MemberRole;\r\n  status: MemberStatus;\r\n  invited_by?: string;\r\n  joined_at?: string;\r\n  access_revoked_at?: string;\r\n  access_revoked_reason?: string;\r\n  invitation_link?: string;\r\n  created_at: string;\r\n  // Join data\r\n  profiles?: {\r\n    full_name?: string;\r\n    display_name?: string;\r\n  };\r\n}\r\n\r\nexport interface OrgInvitation {\r\n  id: string;\r\n  org_id: string;\r\n  created_by: string;\r\n  email?: string;\r\n  code?: string;\r\n  token?: string;\r\n  status: InvitationStatus;\r\n  expires_at: string;\r\n  max_uses: number;\r\n  uses_count: number;\r\n  role: MemberRole;\r\n  metadata: Record<string, any>;\r\n  created_at: string;\r\n  organizations?: {\r\n    id: string;\r\n    name: string;\r\n    slug: string;\r\n  };\r\n}\r\n\r\nexport interface OrgCourseAssignment {\r\n  id: string;\r\n  org_id: string;\r\n  course_id: string;\r\n  assigned_by: string;\r\n  student_ids: string[];\r\n  due_date?: string;\r\n  instructions?: string;\r\n  created_at: string;\r\n}\r\n\r\nexport interface OrgGoal {\r\n  id: string;\r\n  org_id: string;\r\n  created_by: string;\r\n  student_id: string;\r\n  title: string;\r\n  description?: string;\r\n  category?: string;\r\n  folder_path: string;\r\n  target_date?: string;\r\n  status: 'active' | 'completed' | 'paused' | 'cancelled';\r\n  priority: 'low' | 'medium' | 'high';\r\n  progress_percentage: number;\r\n  metadata: Record<string, any>;\r\n  created_at: string;\r\n  // Join data\r\n  student_profile?: {\r\n    full_name?: string;\r\n    display_name?: string;\r\n  };\r\n}\r\n\r\nexport interface OrgNote {\r\n  id: string;\r\n  org_id: string;\r\n  created_by: string;\r\n  student_id: string;\r\n  title: string;\r\n  content: string;\r\n  category?: string;\r\n  folder_path: string;\r\n  visibility_scope: NoteVisibilityScope;\r\n  is_private: boolean;\r\n  tags: string[];\r\n  metadata: Record<string, any>;\r\n  created_at: string;\r\n  // Join data\r\n  student_profile?: {\r\n    full_name?: string;\r\n    display_name?: string;\r\n  };\r\n}\r\n\r\nexport const SUBSCRIPTION_TIERS = {\r\n  basic: {\r\n    name: 'Basic',\r\n    seats: 3,\r\n    instructors: 1,\r\n    price: 29,\r\n    features: ['Up to 3 students', '1 instructor', 'Basic analytics', 'Goal tracking', 'Note management']\r\n  },\r\n  standard: {\r\n    name: 'Standard',\r\n    seats: 10,\r\n    instructors: 3,\r\n    price: 79,\r\n    features: ['Up to 10 students', '3 instructors', 'Advanced analytics', 'Course assignments', 'Bulk operations']\r\n  },\r\n  premium: {\r\n    name: 'Premium',\r\n    seats: 25,\r\n    instructors: 10,\r\n    price: 149,\r\n    features: ['Up to 25+ students', '10 instructors', 'Full analytics suite', 'Custom reporting', 'Priority support']\r\n  },\r\n  beta: {\r\n    name: 'Beta (Free)',\r\n    seats: 50,\r\n    instructors: 20,\r\n    price: 0,\r\n    isBeta: true,\r\n    features: ['Up to 50+ students (Beta)', '20 instructors (Beta)', 'Full analytics suite', 'Custom reporting', 'Priority support', 'Early access features', 'Free during beta period']\r\n  }\r\n} as const;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\publicDomainBooks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\quizlet.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\types\\user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\algebraContentParser.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\analyticsDataSync.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\analyticsTracking.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\cleanupManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\courseTextExtractor.ts","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\-.","line":101,"column":18,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":101,"endColumn":19,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2860,2861],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2860,2860],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Utility functions for extracting readable text from course content\r\n */\r\n\r\nexport interface ReadableSection {\r\n  id: string;\r\n  title: string;\r\n  content: string;\r\n  type: 'heading' | 'paragraph' | 'list' | 'example';\r\n}\r\n\r\n/**\r\n * Extracts readable text from a DOM element, focusing on educational content\r\n */\r\nexport const extractReadableText = (element: HTMLElement): string => {\r\n  if (!element) return '';\r\n  \r\n  const clone = element.cloneNode(true) as HTMLElement;\r\n  \r\n  // Remove non-content elements\r\n  const elementsToRemove = [\r\n    'button',\r\n    '.lucide',\r\n    '[data-tts-ignore]',\r\n    '.text-muted-foreground.text-xs', // Small helper text\r\n    '.badge'\r\n  ];\r\n  \r\n  elementsToRemove.forEach(selector => {\r\n    const elements = clone.querySelectorAll(selector);\r\n    elements.forEach(el => el.remove());\r\n  });\r\n  \r\n  // Get text content and clean it up\r\n  let text = clone.textContent || '';\r\n  \r\n  // Clean up whitespace and formatting\r\n  text = text\r\n    .replace(/\\s+/g, ' ')\r\n    .replace(/â€¢/g, '') // Remove bullet points\r\n    .replace(/\\n\\s*\\n/g, '. ') // Replace double newlines with periods\r\n    .trim();\r\n  \r\n  // Add natural pauses for better TTS\r\n  text = text\r\n    .replace(/([.!?])\\s*([A-Z])/g, '$1 $2') // Ensure space after sentences\r\n    .replace(/:\\s*([A-Z])/g, ': $1') // Pause after colons\r\n    .replace(/;\\s*([A-Z])/g, '; $1'); // Pause after semicolons\r\n  \r\n  return text;\r\n};\r\n\r\n/**\r\n * Extracts structured readable sections from course content\r\n */\r\nexport const extractCourseContent = (element: HTMLElement): ReadableSection[] => {\r\n  if (!element) return [];\r\n  \r\n  const sections: ReadableSection[] = [];\r\n  \r\n  // Extract main headings\r\n  const headings = element.querySelectorAll('h1, h2, h3, h4');\r\n  headings.forEach((heading, index) => {\r\n    const title = heading.textContent?.trim() || '';\r\n    if (title && !title.includes('Lesson') && !title.includes('Coming Up')) {\r\n      sections.push({\r\n        id: `heading-${index}`,\r\n        title,\r\n        content: title,\r\n        type: 'heading'\r\n      });\r\n    }\r\n  });\r\n  \r\n  // Extract content sections\r\n  const contentSections = element.querySelectorAll('.space-y-4, .space-y-6');\r\n  contentSections.forEach((section, index) => {\r\n    const heading = section.querySelector('h3, h4');\r\n    const title = heading?.textContent?.trim() || `Section ${index + 1}`;\r\n    \r\n    const content = extractReadableText(section as HTMLElement);\r\n    if (content && content.length > 20) {\r\n      sections.push({\r\n        id: `section-${index}`,\r\n        title,\r\n        content,\r\n        type: 'paragraph'\r\n      });\r\n    }\r\n  });\r\n  \r\n  return sections;\r\n};\r\n\r\n/**\r\n * Converts mathematical expressions to readable text for TTS\r\n */\r\nexport const convertMathToSpeech = (text: string): string => {\r\n  return text\r\n    .replace(/\\bx\\+/g, 'x plus ')\r\n    .replace(/\\bx\\-/g, 'x minus ')\r\n    .replace(/\\bx\\*/g, 'x times ')\r\n    .replace(/\\bx\\//g, 'x divided by ')\r\n    .replace(/\\b(\\d+)x/g, '$1 times x')\r\n    .replace(/\\bx\\^(\\d+)/g, 'x to the power of $1')\r\n    .replace(/\\bsin\\(/g, 'sine of ')\r\n    .replace(/\\bcos\\(/g, 'cosine of ')\r\n    .replace(/\\btan\\(/g, 'tangent of ')\r\n    .replace(/\\bÏ€/g, 'pi')\r\n    .replace(/\\bÂ°/g, ' degrees')\r\n    .replace(/\\bâˆš/g, 'square root of ')\r\n    .replace(/\\b=\\s*/g, ' equals ')\r\n    .replace(/\\bâ‰ \\s*/g, ' does not equal ')\r\n    .replace(/\\bâ‰¤\\s*/g, ' is less than or equal to ')\r\n    .replace(/\\bâ‰¥\\s*/g, ' is greater than or equal to ')\r\n    .replace(/\\b<\\s*/g, ' is less than ')\r\n    .replace(/\\b>\\s*/g, ' is greater than ');\r\n};\r\n\r\n/**\r\n * Generates introduction text for lessons\r\n */\r\nexport const generateIntroText = (lessonTitle: string, lessonNumber: number, totalLessons: number): string => {\r\n  return `Welcome to lesson ${lessonNumber} of ${totalLessons}: ${lessonTitle}. Let's begin learning about this topic.`;\r\n};\r\n\r\n/**\r\n * Generates summary text for lessons\r\n */\r\nexport const generateOutroText = (lessonTitle: string): string => {\r\n  return `This completes the lesson on ${lessonTitle}. Great job on your learning progress!`;\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\enhancedPdfUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\enhancedPdfWorkerConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\flashcardTopicAnalyzer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\ga4Setup.ts","messages":[{"ruleId":"prefer-rest-params","severity":2,"message":"Use the rest parameters instead of 'arguments'.","line":31,"column":31,"nodeType":"Identifier","messageId":"preferRestParams","endLine":31,"endColumn":40}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Google Analytics 4 Setup for FPK University Platform\r\n * Initialize GA4 with custom dimensions and events for course analytics\r\n */\r\n\r\n// Global types handled in analytics.ts\r\n\r\nexport class GA4Setup {\r\n  private measurementId: string;\r\n  private isInitialized = false;\r\n\r\n  constructor(measurementId: string = 'G-DISABLED') { // Analytics disabled until configured\r\n    this.measurementId = measurementId;\r\n  }\r\n\r\n  /**\r\n   * Initialize Google Analytics 4\r\n   */\r\n  public initialize(): void {\r\n    // Skip initialization if analytics is disabled\r\n    if (this.measurementId === 'G-DISABLED' || this.isInitialized || typeof window === 'undefined') {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Initialize dataLayer\r\n      window.dataLayer = window.dataLayer || [];\r\n\r\n      // Define gtag function\r\n      window.gtag = function() {\r\n        window.dataLayer.push(arguments);\r\n      };\r\n\r\n      // Set initial timestamp\r\n      window.gtag('js', new Date());\r\n\r\n      // Configure GA4 with custom dimensions\r\n      window.gtag('config', this.measurementId, {\r\n        // Custom dimensions for course analytics\r\n        custom_map: {\r\n          'dimension1': 'course_id',\r\n          'dimension2': 'module_id', \r\n          'dimension3': 'user_id',\r\n          'dimension4': 'content_type',\r\n          'dimension5': 'engagement_level'\r\n        },\r\n        \r\n        // Enhanced ecommerce for course enrollment tracking\r\n        send_page_view: true,\r\n        \r\n        // Privacy settings\r\n        anonymize_ip: true,\r\n        respect_dnt: true,\r\n        \r\n        // Course-specific settings\r\n        content_group1: 'Course Content',\r\n        content_group2: 'Learning Platform'\r\n      });\r\n\r\n      // Load GA4 script\r\n      this.loadScript();\r\n      this.isInitialized = true;\r\n\r\n      console.log('ðŸ“Š GA4 initialized with measurement ID:', this.measurementId);\r\n    } catch (error) {\r\n      console.error('Error initializing GA4:', error);\r\n    }\r\n  }\r\n\r\n  private loadScript(): void {\r\n    const script = document.createElement('script');\r\n    script.async = true;\r\n    script.src = `https://www.googletagmanager.com/gtag/js?id=${this.measurementId}`;\r\n    document.head.appendChild(script);\r\n  }\r\n\r\n  /**\r\n   * Track course enrollment\r\n   */\r\n  public trackCourseEnrollment(courseId: string, courseName: string, userId?: string): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    window.gtag('event', 'course_enrollment', {\r\n      course_id: courseId,\r\n      course_name: courseName,\r\n      user_id: userId,\r\n      event_category: 'Course',\r\n      event_label: courseName,\r\n      value: 1\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Track module completion\r\n   */\r\n  public trackModuleCompletion(\r\n    moduleId: string, \r\n    courseId: string, \r\n    timeSpent: number,\r\n    userId?: string\r\n  ): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    window.gtag('event', 'module_completion', {\r\n      module_id: moduleId,\r\n      course_id: courseId,\r\n      user_id: userId,\r\n      time_spent: timeSpent,\r\n      event_category: 'Learning',\r\n      event_label: `${courseId}-${moduleId}`,\r\n      value: timeSpent\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Track video/audio engagement\r\n   */\r\n  public trackMediaEngagement(\r\n    action: 'play' | 'pause' | 'complete',\r\n    mediaType: 'video' | 'audio',\r\n    moduleId: string,\r\n    courseId: string,\r\n    progress: number,\r\n    userId?: string\r\n  ): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    window.gtag('event', `${mediaType}_${action}`, {\r\n      module_id: moduleId,\r\n      course_id: courseId,\r\n      user_id: userId,\r\n      progress_percentage: progress,\r\n      content_type: mediaType,\r\n      event_category: 'Media Engagement',\r\n      event_label: `${courseId}-${moduleId}`,\r\n      value: Math.round(progress)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Track quiz/assessment results\r\n   */\r\n  public trackAssessmentResult(\r\n    assessmentId: string,\r\n    courseId: string,\r\n    score: number,\r\n    maxScore: number,\r\n    userId?: string\r\n  ): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    const percentage = (score / maxScore) * 100;\r\n\r\n    window.gtag('event', 'assessment_completed', {\r\n      assessment_id: assessmentId,\r\n      course_id: courseId,\r\n      user_id: userId,\r\n      score: score,\r\n      max_score: maxScore,\r\n      percentage: Math.round(percentage),\r\n      event_category: 'Assessment',\r\n      event_label: `${courseId}-${assessmentId}`,\r\n      value: Math.round(percentage)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Track user study streaks\r\n   */\r\n  public trackStudyStreak(streakDays: number, userId?: string): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    window.gtag('event', 'study_streak', {\r\n      user_id: userId,\r\n      streak_days: streakDays,\r\n      event_category: 'User Engagement',\r\n      event_label: `${streakDays} days`,\r\n      value: streakDays\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Track custom learning events\r\n   */\r\n  public trackCustomEvent(\r\n    eventName: string,\r\n    parameters: Record<string, any>\r\n  ): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    window.gtag('event', eventName, {\r\n      event_category: 'Custom Learning Event',\r\n      ...parameters\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set user properties for better analytics\r\n   */\r\n  public setUserProperties(userId: string, properties: Record<string, any>): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    window.gtag('config', this.measurementId, {\r\n      user_id: userId,\r\n      user_properties: properties\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Track page views with course context\r\n   */\r\n  public trackPageView(\r\n    pagePath: string,\r\n    pageTitle: string,\r\n    courseId?: string,\r\n    moduleId?: string\r\n  ): void {\r\n    if (!this.isInitialized) return;\r\n\r\n    window.gtag('event', 'page_view', {\r\n      page_path: pagePath,\r\n      page_title: pageTitle,\r\n      course_id: courseId,\r\n      module_id: moduleId,\r\n      event_category: 'Navigation'\r\n    });\r\n  }\r\n}\r\n\r\n// Environment-specific setup\r\nconst getGA4MeasurementId = (): string => {\r\n  // In production, this should come from environment variables\r\n  if (typeof window !== 'undefined') {\r\n    const hostname = window.location.hostname;\r\n    \r\n    // Production environments - configure actual analytics when needed\r\n    if (hostname.includes('lovableproject.com') || hostname.includes('lovable.app')) {\r\n      return process.env.GA4_MEASUREMENT_ID || 'G-DISABLED'; // Disabled until configured\r\n    }\r\n    \r\n    // Development environment - disable analytics to avoid noise\r\n    if (hostname === 'localhost' || hostname === '127.0.0.1') {\r\n      return 'G-DISABLED'; // Disabled in development\r\n    }\r\n    \r\n    return 'G-DISABLED'; // Disabled by default until properly configured\r\n  }\r\n  \r\n  return 'G-DISABLED';\r\n};\r\n\r\n// Global GA4 instance\r\nexport const ga4 = new GA4Setup(getGA4MeasurementId());\r\n\r\n// Auto-initialize if in browser\r\nif (typeof window !== 'undefined') {\r\n  ga4.initialize();\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\goalCompletionValidator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\iframeAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\interactiveCourseAnalytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\lessonPerformanceOptimizer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\memoryManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\navigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\opdsProcessor.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\pdfUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\pdfWorkerConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\performanceMonitor.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\performanceOptimizer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\realtimeChannelRegistry.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\reliablePdfConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\safeStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\sentry.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\siteUrl.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\speechUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\studyDataUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\systemDiagnostics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\uploadCourseImages.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\uploadVectorImages.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\validators\\cmi12.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\utils\\validators\\cmi2004.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Jashon\\OneDrive\\Documents\\GitHub\\fpk-learner-v1\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]